      /TITLE  Vedlikehold av statuskoder  -  1 + 3
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RA001R                                              *
      * Beskrivelse . . : Vedlikehold av statuskoder  - 1 og 3                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
T5.00 * V5.00      110702 Tatt vekk feltet Antall pos. i kontonr.        HFL  *
T5.00 * V5.20      100104 Tatt vekk feltet Standard valuta               KOB  *
T5.00 * V5.40      230505 Lagt inn ny kode for strekkode på bilag        KOB  *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fraa1l1    if   e           k disk    rename(raa1pfr:raa1l1r)
     fraa1lu    uf a e           k disk    rename(raa1pfr:raa1lur)
     fraa3l1    if   e           k disk    rename(raa3pfr:raa3l1r)
     fraa3lu    uf a e           k disk    rename(raa3pfr:raa3lur)
     fra001d    cf   e             workstn
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_stat          s              1
     d w_firm          s                   like(ra1fir)
      *
      /eject
      *
     c     dummy         tag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * A2BLD  - Bilde for vedlikehold av statuskode 1
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A2BLD Behandle bilde for vedlikehold av statuskode              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Hent STATUSKODE 1
      *
     c     keya1         chain     raa1l1                             60
      *
     c                   if        *in60 = *on
     c                   move      12            a21ape
     c                   move      9999          a21hkt
     c                   move      599999        a21hrs
     c                   endif
      *
     c                   if        *in60 = *off
      *                                                                 .
     c                   move      ra1ape        a21ape
     c                   move      ra1per        a21per
     c                   move      ra1aar        a21aar
     c                   move      ra1hkt        a21hkt
     c                   move      ra1hrs        a21hrs
     c                   move      ra1ars        a21ars
     c                   move      ra1avs        a21avs
     c                   move      ra1bnr        a21bnr
     c                   move      ra1bun        a21bun
     c                   eval      a21usr = ra1usr
     c     *dmy          move      ra1dat        a21dat
     c                   move      ra1skd        a21skd
     c                   move      ra1pre        a21pre
      *
     c                   endif
      *
     c                   move      l_firm        ra3fir
      *
      * Hent STATUSKODE 3
      *
     c     keya3         chain     raa3l1                             61
      *
     c                   if        *in61 = *on
T5.00c                   move      'N'           a23bÆr
     c                   endif
      *
     c                   if        *in61 = *off
     c                   move      ra3stp        a23stp
     c                   move      ra3p01        a23p01
     c                   move      ra3p02        a23p02
     c                   move      ra3p03        a23p03
     c                   move      ra3p04        a23p04
     c                   move      ra3p05        a23p05
     c                   move      ra3p06        a23p06
     c                   move      ra3p07        a23p07
     c                   move      ra3p08        a23p08
     c                   move      ra3p09        a23p09
     c                   move      ra3p10        a23p10
     c                   move      ra3p11        a23p11
     c                   move      ra3p12        a23p12
     c                   move      ra3p13        a23p13
     c                   move      ra3bÆr        a23bÆr
      *                                                                 .
     c                   endif
      *
     c     a2taga        tag
      *
      * Bare data
      *
     c     a2tagb        tag
      *
     c                   exfmt     a2bld
      *
      * Gå ut
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      /eject
      *
      *  KONTROLL
      *
      *  Øvre grense hovedbok/kunder
      *
     c                   if        a21hrs <= a21hkt
     c                   move      *on           *in31
     c                   goto      a2taga
     c                   endif
      *
      *  Antall perioder
      *
     c                   if        a21ape < 01 or
     c                             a21ape > 13
     c                   move      *on           *in33
     c                   goto      a2taga
     c                   endif
      *
      *  Periodesperre - Periode
      *
     c                   if        a21per > a21ape
     c                   move      *on           *in34
     c                   goto      a2taga
     c                   endif
      *
      *  Periodesperre - År
      *
     c                   if        a21per > *zero
     c                   if        a21aar < 1980
     c                   move      *on           *in35
     c                   goto      a2taga
     c                   endif
     c                   endif
      *
      *  Avvikende regnskapsår
      *
     c                   if        a23stp > *zero
      *
     c                   if        a23stp > a21ape
     c                   move      *on           *in36
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p01 = *zero or
     c                             a23p01 > a21ape
     c                   move      *on           *in37
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p02 = *zero or
     c                             a23p02 > a21ape
     c                   move      *on           *in38
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p03 = *zero or
     c                             a23p03 > a21ape
     c                   move      *on           *in39
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p04 = *zero or
     c                             a23p04 > a21ape
     c                   move      *on           *in40
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p05 = *zero or
     c                             a23p05 > a21ape
     c                   move      *on           *in41
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p06 = *zero or
     c                             a23p06 > a21ape
     c                   move      *on           *in42
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p07 = *zero or
     c                             a23p07 > a21ape
     c                   move      *on           *in43
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p08 = *zero or
     c                             a23p08 > a21ape
     c                   move      *on           *in44
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p09 = *zero or
     c                             a23p09 > a21ape
     c                   move      *on           *in45
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p10 = *zero or
     c                             a23p10 > a21ape
     c                   move      *on           *in46
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p11 = *zero or
     c                             a23p11 > a21ape
     c                   move      *on           *in47
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p12 = *zero or
     c                             a23p12 > a21ape
     c                   move      *on           *in48
     c                   goto      a2taga
     c                   endif
      *                                                                 .
     c                   if        a23p13 > a21ape
     c                   move      *on           *in49
     c                   goto      a2taga
     c                   endif
      *
     c                   endif
      *
      /eject
      *
      * Oppdater statuskode 1
      *
     c     keya1         chain     raa1lu                             60
      *
     c                   move      a21ape        ra1ape
     c                   move      a21per        ra1per
     c                   move      a21aar        ra1aar
     c                   move      a21hkt        ra1hkt
     c                   move      a21hrs        ra1hrs
     c                   move      a21ars        ra1ars
     c                   move      a21avs        ra1avs
     c                   move      a21bnr        ra1bnr
     c                   move      a21bun        ra1bun
     c                   move      a21skd        ra1skd
     c                   move      a21pre        ra1pre
      *
     c                   time                    ra1dat
     c                   time                    ra1tim
     c                   eval      ra1usr = l_user
      *
     c                   if        *in60 = *off
     c                   update    raa1lur
     c                   else
     c                   write     raa1lur
     c                   endif
      *
      * Oppdater statuskode 3
      *
     c     keya3         chain     raa3lu                             61
      *
     c                   move      a23stp        ra3stp
     c                   move      a23p01        ra3p01
     c                   move      a23p02        ra3p02
     c                   move      a23p03        ra3p03
     c                   move      a23p04        ra3p04
     c                   move      a23p05        ra3p05
     c                   move      a23p06        ra3p06
     c                   move      a23p07        ra3p07
     c                   move      a23p08        ra3p08
     c                   move      a23p09        ra3p09
     c                   move      a23p10        ra3p10
     c                   move      a23p11        ra3p11
     c                   move      a23p12        ra3p12
     c                   move      a23p13        ra3p13
     c                   move      a23bÆr        ra3bÆr
      *
     c                   time                    ra3dat
     c                   time                    ra3tim
     c                   eval      ra3usr = l_user
      *
     c                   if        *in61 = *off
     c                   update    raa3lur
     c                   else
     c                   write     raa3lur
     c                   endif
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Legge inn firmanummer og navn fra LDA
      *
     c                   move      l_firm        w_firm
     c                   move      l_firm        ra1fir
      *
      * Key for statuskode 1
      *
     c     keya1         klist
     c                   kfld                    w_firm
      *
      * Key for statuskode 3
      *
     c     keya3         klist
     c                   kfld                    w_firm
      *
     c                   endsr
      /eject
