      /title  Oppdatering av akkumulerings-register, Sletting
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SCADER
      * Beskrivelse . . : Oppdatering av akkumulerings-register, Sletting
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fslnil1    if   e           k disk    rename(slnipfr:slnil1r)
     fslakl1    if   e           k disk    rename(slakpfr:slakl1r)
     fslaklu    uf a e           k disk    rename(slakpfr:slaklur)
      *
      * Definering av parameter (inn)
      *
     d                 ds
     d wkparm                       128
     d  wkfirm                        3  0 overlay(wkparm:01)
     d  wkhhaa                        4  0 overlay(wkparm:04)
     d  wkkode                       12    overlay(wkparm:08)
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(shfirm)
     d w_hhaa          s                   like(shhhaa)
     d w_kode          s                   like(shkode)
      *
     d slaklu_avde     s                   like(shavde)
     d slaklu_lage     s                   like(shlage)
     d slaklu_otyp     s                   like(shotyp)
     d slaklu_land     s                   like(shland)
     d slaklu_dist     s                   like(shdist)
     d slaklu_selg     s                   like(shselg)
     d slaklu_lkat     s                   like(shlkat)
     d slaklu_ldor     s                   like(shldor)
     d slaklu_ogrp     s                   like(shogrp)
     d slaklu_hgrp     s                   like(shhgrp)
     d slaklu_ugrp     s                   like(shugrp)
     d slaklu_vare     s                   like(shvare)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XINIT  Initisiering av utskriften                               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      *  Hopper til Multioppdateringsrutinen
      *
     c     wkkode        cabeq     *blank        xstart
      *
      * Sjekk, Skal denne typen oppdatere akk.register
      *
     c                   eval      w_kode = wkkode
     c     slnil1_key    chain     slnil1r                            10
      *
     c     *in10         cabeq     *on           xslutt
     c     smakkk        cabne     *blank        xslutt
      *
      *  Start oppdatering
      *
     c                   eval      w_kode = wkkode
     c                   exsr      oppakk
      *
     c                   goto      xslutt
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XSTART Henter alle budsjett-koder for oppdatering               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xstart        tag
      *
     c                   eval      w_kode = *blank
     c     slnil1_key    setll     slnil1
      *
     c     xneste        tag
     c                   read      slnil1                                 10
     c     *in10         cabeq     *on           xslutt
      *
      * Sjekk, Hopp ut dersom ikke riktig
      *
     c     smfirm        cabne     w_firm        xslutt
     c     smakkk        cabne     *blank        xneste
      *
      *  Start oppdatering
      *
     c                   eval      w_kode = smkode
     c                   exsr      oppakk
      *
      * Returner til nytt les
      *
     c                   goto      xneste
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
      *
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Oppdater akkumulerings-register                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     oppakk        begsr
      *
      * Sletter records i AKKUMULERINGS-REGISTER
      *
     c                   move      *zero         slaklu_avde
     c                   move      *zero         slaklu_lage
     c                   move      *blank        slaklu_otyp
     c                   move      *blank        slaklu_land
     c                   move      *zero         slaklu_dist
     c                   move      *zero         slaklu_selg
     c                   move      *zero         slaklu_lkat
     c                   move      *zero         slaklu_ldor
     c                   move      *zero         slaklu_ogrp
     c                   move      *zero         slaklu_hgrp
     c                   move      *zero         slaklu_ugrp
     c                   move      *blank        slaklu_vare
     c     slakl1_key    setll     slakl1r
      *
     c     tag02         tag
     c                   setoff                                           12
     c                   read      slakl1r                                12
      *
     c     *in12         ifeq      *off
     c     w_firm        ifeq      shfirm
     c     w_hhaa        ifeq      shhhaa
     c     w_kode        ifeq      shkode
      *
     c                   move      shavde        slaklu_avde
     c                   move      shlage        slaklu_lage
     c                   move      shotyp        slaklu_otyp
     c                   move      shland        slaklu_land
     c                   move      shdist        slaklu_dist
     c                   move      shselg        slaklu_selg
     c                   move      shlkat        slaklu_lkat
     c                   move      shldor        slaklu_ldor
     c                   move      shogrp        slaklu_ogrp
     c                   move      shhgrp        slaklu_hgrp
     c                   move      shugrp        slaklu_ugrp
     c                   move      shvare        slaklu_vare
      *
     c     slakl1_key    chain     slaklur                            14
     c     *in14         ifeq      *off
     c                   delete    slaklur
     c                   endif
      *
     c                   goto      tag02
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     csr   *inzsr        begsr
      *
      * Key for oppdatering av KUNDE-NIVÅ-REGISTER
      *
     c     slnil1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_kode
      *
      * Key for lesing      av LEVERANDØR-AKKUMULERINGS-REGISTER
      *
     c     slakl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_hhaa
     c                   kfld                    w_kode
     c                   kfld                    slaklu_avde
     c                   kfld                    slaklu_lage
     c                   kfld                    slaklu_otyp
     c                   kfld                    slaklu_land
     c                   kfld                    slaklu_dist
     c                   kfld                    slaklu_selg
     c                   kfld                    slaklu_lkat
     c                   kfld                    slaklu_ldor
     c                   kfld                    slaklu_ogrp
     c                   kfld                    slaklu_hgrp
     c                   kfld                    slaklu_ugrp
     c                   kfld                    slaklu_vare
      *
      * Key for oppdatering av LEVERANDØR-AKKUMULERINGS-REGISTER
      *
     c     slaklu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_hhaa
     c                   kfld                    w_kode
     c                   kfld                    slaklu_avde
     c                   kfld                    slaklu_lage
     c                   kfld                    slaklu_otyp
     c                   kfld                    slaklu_land
     c                   kfld                    slaklu_dist
     c                   kfld                    slaklu_selg
     c                   kfld                    slaklu_lkat
     c                   kfld                    slaklu_ldor
     c                   kfld                    slaklu_ogrp
     c                   kfld                    slaklu_hgrp
     c                   kfld                    slaklu_ugrp
     c                   kfld                    slaklu_vare
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tar inn parameter fra forrige program                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *entry        plist
     c                   parm                    dsparm          128
     c                   move      dsparm        wkparm
      *
     c                   eval      w_firm      = wkfirm
     c                   eval      w_hhaa      = wkhhaa
      *
     csr                 endsr
