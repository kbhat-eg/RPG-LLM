     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOFAK
      * Program . . . . : FW711R
      * Beskrivelse . . : Danning av leverandør vareregister,
      *                   ELFO standardformat
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       060699 HKO  Nytt program
      *       290200 HKO  Fjernet avrunding ved uttrekk av mva
      *       170204 HKO  Tilpasset nytt recordformat
      * 6.10  230609 BSA  Oppdatert med sporingsinformasjon
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fflvwpf    if   e           k disk
     fflvapf    o  a e             disk
      *
6.10  * Local data area
6.10  *
6.10 d                uds
6.10 d l_user                911    920
      *
      * Definering av datastruktur
      *
      *  Recordbeskrivelse - ELFO standardformat
      *
     d*                ds
     d*d_inpu                       264
     d* d_ldor                        4  0 overlay(d_inpu:1)                    Leverandørnr
     d* d_merk                        4  0 overlay(d_inpu:5)                    Merkenr
     d* d_type                       20    overlay(d_inpu:9)                    Typebetegnelse
     d* d_lope                        6    overlay(d_inpu:29)                   Løpenummer
     d* d_eann                       13  0 overlay(d_inpu:35)                   Ean-nummer
     d* d_vare                       13    overlay(d_inpu:48)                   Varenr
     d* d_vgrp                        4  0 overlay(d_inpu:61)                   Varegruppe
     d* d_gmnd                        2    overlay(d_inpu:65)                   Garantid i måneder
     d* d_tek1                       40    overlay(d_inpu:67)                   Varetekst-1
     d* d_tek2                       40    overlay(d_inpu:107)                  Varetekst-2
     d* d_bila                       30    overlay(d_inpu:147)                  Bilagsbetegnelse
     d* d_bapr                        9    overlay(d_inpu:177)                  Basispris
     d* d_nrka                        7    overlay(d_inpu:186)                  NRK avgift
     d* d_ggod                        7    overlay(d_inpu:193)                  Garantigodtgjørelse
     d* d_frak                        7    overlay(d_inpu:200)                  Frakt/assuranse
     d* d_inpr                        9    overlay(d_inpu:207)                  Innkjøpspris
     d* d_sapr                        9    overlay(d_inpu:216)                  Salgspris
     d* d_kalk                        7    overlay(d_inpu:225)                  Kalkyle
     d* d_rdat                        6  0 overlay(d_inpu:232)                  Dato registrert
     d* d_dato                        6  0 overlay(d_inpu:238)                  Dato sist endret
     d* d_kutm                        1    overlay(d_inpu:244)                  Kode utmeldt
     d* d_lsts                        1    overlay(d_inpu:245)                  Lagerstatus
     d* d_ldat                        6    overlay(d_inpu:246)                  Dato lagerstatus
     d* d_adat                        6    overlay(d_inpu:252)                  Ankomstdato
      *
     d                 ds
     d d_inpu                       513
     d  d_ldor                        4  0 overlay(d_inpu:1)                    Leverandørnr
     d  d_vare                       20    overlay(d_inpu:5)                    Leverandørnr
     d  d_ldo2                        4  0 overlay(d_inpu:25)                   Leverandørnr
     d  d_var2                       20    overlay(d_inpu:29)                   Leverandørnr
     d  d_eann                       13  0 overlay(d_inpu:49)                   Ean-nummer
     d  d_vkod                        1    overlay(d_inpu:62)                   Ean-nummer
     d  d_merk                        5  0 overlay(d_inpu:63)                   Ean-nummer
     d  d_type                       40    overlay(d_inpu:68)                   Ean-nummer
     d  d_vgrp                        5  0 overlay(d_inpu:108)                  Ean-nummer
     d  d_tek1                       40    overlay(d_inpu:113)                  Ean-nummer
     d  d_tek2                       40    overlay(d_inpu:153)                  Ean-nummer
     d  d_enhe                       10    overlay(d_inpu:193)                  Ean-nummer
     d  d_farg                       10    overlay(d_inpu:203)                  Ean-nummer
     d  d_lbhd                       10    overlay(d_inpu:213)                  Ean-nummer
     d  d_leng                        9    overlay(d_inpu:223)                  Ean-nummer
     d  d_bred                        9    overlay(d_inpu:232)                  Ean-nummer
     d  d_hoyd                        9    overlay(d_inpu:241)                  Ean-nummer
     d  d_dybd                        9    overlay(d_inpu:250)                  Ean-nummer
     d  d_venh                       10    overlay(d_inpu:259)                  Ean-nummer
     d  d_vekt                        9    overlay(d_inpu:269)                  Ean-nummer
     d  d_bpri                        9    overlay(d_inpu:278)                  Ean-nummer
     d  d_saer                        7    overlay(d_inpu:287)                  Ean-nummer
     d  d_ggod                        7    overlay(d_inpu:294)                  Ean-nummer
     d  d_frak                        7    overlay(d_inpu:301)                  Ean-nummer
     d  d_inpr                        9    overlay(d_inpu:308)                  Ean-nummer
     d  d_sapr                        9    overlay(d_inpu:317)                  Ean-nummer
     d  d_kkod                        4    overlay(d_inpu:326)                  Ean-nummer
     d  d_kdfi                        8  0 overlay(d_inpu:330)                  Ean-nummer
     d  d_kdti                        8  0 overlay(d_inpu:338)                  Ean-nummer
     d  d_kdfu                        8  0 overlay(d_inpu:346)                  Ean-nummer
     d  d_kdtu                        8  0 overlay(d_inpu:354)                  Ean-nummer
     d  d_dato                        8  0 overlay(d_inpu:362)                  Ean-nummer
     d  d_dutg                        8  0 overlay(d_inpu:370)                  Ean-nummer
     d  d_lsta                        1    overlay(d_inpu:378)                  Ean-nummer
     d  d_lsda                        8  0 overlay(d_inpu:379)                  Ean-nummer
     d  d_anda                        8  0 overlay(d_inpu:387)                  Ean-nummer
     d  d_ldag                        3  0 overlay(d_inpu:395)                  Ean-nummer
     d  d_gtid                        2    overlay(d_inpu:398)                  Ean-nummer
     d  d_vgre                        6  0 overlay(d_inpu:400)                  Ean-nummer
     d  d_vtet                        1  0 overlay(d_inpu:406)                  Ean-nummer
     d  d_kkal                       15    overlay(d_inpu:407)                  Ean-nummer
     d  d_eti1                       12    overlay(d_inpu:422)                  Ean-nummer
     d  d_eti2                       12    overlay(d_inpu:434)                  Ean-nummer
     d  d_skod                        1  0 overlay(d_inpu:446)                  Ean-nummer
     d  d_matr                        3    overlay(d_inpu:447)                  Ean-nummer
     d  d_finh                        3    overlay(d_inpu:450)                  Ean-nummer
     d  d_ovfl                        3    overlay(d_inpu:453)                  Ean-nummer
     d  d_bmat                        3    overlay(d_inpu:456)                  Ean-nummer
     d  d_fin2                        3    overlay(d_inpu:459)                  Ean-nummer
     d  d_dian                        2  0 overlay(d_inpu:462)                  Ean-nummer
     d  d_disl                        2    overlay(d_inpu:464)                  Ean-nummer
     d  d_dvkt                        5    overlay(d_inpu:466)                  Ean-nummer
     d  d_dfar                        3    overlay(d_inpu:471)                  Ean-nummer
     d  d_dkla                        3    overlay(d_inpu:474)                  Ean-nummer
     d  d_aste                        4    overlay(d_inpu:476)                  Ean-nummer
     d  d_fapr                        9    overlay(d_inpu:480)                  Ean-nummer
     d  d_gvby                        5    overlay(d_inpu:489)                  Ean-nummer
     d  d_mkro                        9    overlay(d_inpu:494)                  Ean-nummer
     d  d_mkla                       10    overlay(d_inpu:503)                  Ean-nummer
      *
      * Definering av parametre
      *
     d p_firm          s              3  0
     d p_ldor          s              6  0
      *
      * Definering av variable
      *
     d w_firm          s              3  0
     d w_udat          s               d   datfmt(*iso)
     d w_mvap          s              6  2
     d w_mvat          s              5  4
     d w_mvaf          s             10  9
     d w_inpr          s              9
     d w_sapr          s              9
      *
      * Definering av konstanter
      *
     d Lo              c                   'abcdefghijklmnopqrstuvwxyzæøåäö'
     d Up              c                   'ABCDEFGHIJKLMNOPQRSTUVWXYZÆØÅÄÖ'
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Leser input-fil, og legger data ut på leverandør vareregister
      *
     c                   read      flvwpf                                 90
     c                   dow       *in90 = *off
      *
     c                   eval      d_inpu = fwirad
      *
      * Skriver til leverandør vareregister
      *
     c                   eval      fwfirm = p_firm
     c                   eval      fwldor = p_ldor
     c                   eval      fwekod = *blank
     c                   eval      fwtek1 = *blank
     c                   eval      fwtek2 = *blank
     c                   eval      fwlvar = d_vare
     c                   eval      fweann = d_eann
     c                   eval      fwnobb = 0
     c                   eval      fwdato = *loval
     c                   eval      fwenhe = 'PAK'
     c                   eval      fwinpr = 0
     c                   eval      fwsapr = 0
     c                   eval      fwbmen = 0
     c                   eval      fwhkod = 1
      *
     c     Lo:Up         xlate     d_tek1        d_tek1
     c                   eval      fwtek1 = %trim(d_tek1)
      *
     c                   if        d_tek2 <> *blank
     c     Lo:Up         xlate     d_tek2        d_tek2
     c                   eval      fwtek2 = %trim(d_tek2)
     c                   endif
      *
     c                   if        d_dato <> 0
     c     *ymd          move      d_dato        fwdato
     c                   endif
      *
     c     ' ':'0'       xlate     d_inpr        d_inpr
     c                   eval      w_inpr = %trim('0' +
     c                                            %subst(d_inpr:1:6) +
     c                                            %subst(d_inpr:8:2))
     c                   move      w_inpr        fwinpr
      *
     c     ' ':'0'       xlate     d_sapr        d_sapr
     c                   eval      w_sapr = %trim('0' +
     c                                            %subst(d_sapr:1:6) +
     c                                            %subst(d_sapr:8:2))
     c                   move      w_sapr        fwsapr
     c                   eval      fwsapr = fwsapr * w_mvaf
      *
     c                   eval      fwline = fwline + 1
      *
6.10 c                   time                    fwodat
6.10 c                   time                    fwotim
6.10 c                   eval      fwousr = l_user
6.10 c                   time                    fwedat
6.10 c                   time                    fwetim
6.10 c                   eval      fweusr = l_user
     c                   write     flvapfr
      *
     c                   read      flvwpf                                 90
     c                   enddo
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_ldor
      *
      *
      * Henter firma fra parameter
      *
     c                   eval      w_firm = p_firm
      *
      * Henter dagens dato
      *
     c                   time                    w_udat
      *
      * Henter mva-faktor
      *
     c                   call      'FÅ705R'
     c                   parm                    w_firm
     c                   parm                    w_udat
     c                   parm                    w_mvap
     c                   parm                    w_mvat
     c                   parm                    w_mvaf
      *
     c                   endsr
