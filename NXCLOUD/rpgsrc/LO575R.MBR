      /title  ASOFAK Kundeprosjekt, vise kunde/kundeprosjekt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASLAGR
      * Program . . . . : LO575
      * Beskrivelse . . : Leverandør, vise leverandør
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       010914 BKV  Nytt program
7.00  * 6.30  021019 bkv  Utvidet skjerm
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     frlevl1    if   e           k disk    rename(rlevpfr:rlevl1r)
     fapospf    if   e           k disk    rename(apospfr:apospfr)
     fmppalr    if   e           k disk    rename(mppapfr:mppalrr)
     flldilr    if   e           k disk    rename(lldipfr:lldilrr)

      *
     flo575d    cf   e             workstn
      *
      * Definering av parametre
      *
     d p_firm          s                   like(rlfirm)
     d p_levr          s                   like(rllevr)
     d p_lage          s                   like(mplage)
      *
      * Definering av Local data area
      *
     d                uds
     d l_fnav                951    980
      *
      * Definering av variabler i nøkler
      *
     d rlevl1_levr     s                   like(rllevr)
     d apospf_ponr     s                   like(apponr)
     d mppalr_ldor     s                   like(mpldor)
     d mppalr_lnum     s                   like(mplnum)
     d lldilr_ldor     s                   like(lpldor)
     d lldilr_lage     s                   like(lplage)
      *
      * Definering av variable
      *
     d w_firm          s                   like(rlfirm)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B1 Behandle bildet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Initierer skjermbildet

      *
      * Hent leverandør
      *
     c                   move      p_levr        rlevl1_levr
     c     rlevl1_key    chain     rlevl1                             90
     c                   if        *in90 = *on
     c                   goto      b1taga
     c                   endif
      *
     c                   move      rllevr        b1levr
      *
     c                   move      rlnavn        b1navn
     c                   move      rlgate        b1gate
     c                   move      rladr2        b1adr2
     c                   move      rlsted        b1sted
     c                   move      rlponr        b1ponr
     c                   move      rlbetb        b1betb
     c                   move      rlkatg        b1katg
     c                   move      rltlfn        b1tlfn
     c                   move      rlmobn        b1mobn
     c                   move      rltlfx        b1tlfx
     c                   move      rlkunr        b1kunr
     c                   move      rlvalk        b1valk
     c                   move      rllbet        b1lbet
     c                   move      rlemal        b1emal
      *
     c                   move      rlsald        b1sald
     c                   move      rlsaif        b1saif
     c                   move      rlkjØp        b1kjØp
     c                   move      rlkjØf        b1kjØf
      *
      * slår opp mot parameter og henter vekt og beløpsgrense
      *
     c                   eval      b1gvek = 0
     c                   eval      b1gbel = 0
     c                   eval      mppalr_ldor = b1levr
     c     mppalr_key    setll     mppalr
     c     mppalr_key    reade     mppalr
     c                   dow       not %eof
     c                   if        mplage = p_lage
     c                   eval      b1gvek = mpgvek
     c                   eval      b1gbel = mpgbel
      * fant lager og er fornøyd med det
     c                   leave
     c                   endif
     c     mppalr_key    reade     mppalr
     c                   enddo
      *
      * Sjekk om ordretypen er intern, dvs at den ligger inne på leverandøren
      *
     c                   eval      b1fedi = 'Nei'
     c                   eval      lldilr_ldor = b1levr
     c                   eval      lldilr_lage = ''
     c     lldilr_key    chain     lldilr
     c                   if        %found
     c                   if        lpform <> *blank and
     c                             lpform = 'EDI'
     c                   eval      b1fedi = 'Ja'
     c                   endif
     c                   endif
      *
      * Viser bildet
      *
     c     b1taga        tag
     c                   exfmt     b1bld
      *
      * Behandling av standard funksjonstaster
      *
     c                   select
     c                   when      *inkc or *inkl
     c                   goto      avslutt
     c                   endsl
      *
      * F15=Vis bonusavtale for kunde
      *
     c*                  if        *inkp = *on
     c*                  call      'EK501R'
     c*                  parm                    w_firm
     c*                  parm                    p_kund
     c*                  goto      b1taga
     c*                  endif
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_levr
     c                   parm                    p_lage
      *
      * Key for leverandørregisteret via leverandørnummer
      *
     c     rlevl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevl1_levr
      *
      *  Key for les av bestillingsparameter
      *
     c     mppalr_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mppalr_ldor
      *
      * Key for oppslag på leverandør distribusjon
      *
     c     lldilr_key    klist
     c                   kfld                    w_firm
     c                   kfld                    lldilr_ldor
     c                   kfld                    lldilr_lage
      *
      *
      * Henter firma parameter
      *
     c                   eval      w_firm = p_firm
      *
     c                   endsr
