     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASLAGR
      * Program . . . . : LO584R
      * Beskrivelse . . : Liste/ hull i ordrenummerserie
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       150811 NHO  Nytt program
6.nu  *       230614 bof  Utvidet mtp. nummerutvidelse
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *       *in20 = Owerflow
      *       *in31 = Nummer finnes ikke i FOHEPF
      *       *in32 = Nummer finnes ikke i FDELPF
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fsohel3    if   e           k disk    rename(sohepfr:sohel3r)
     ffoheld    if   e           k disk    rename(fohepfr:foheldr)
     ffdell1    if   e           k disk    rename(fdelpfr:fdell1r)
      *
     flo584p    o    e             printer
     f                                     usropn
      *
      * Definering av parametre
     d p_aarr          s              4  0
6.nu d p_a1fr          s              8  0
6.nu d p_a1ti          s              8  0
     d p_pf03          s              1  0
      *
      * Dato
23086d                 ds
23086d w_dato                  1     10
     d  w_aarr                 1      4
     d  bind1                  5      5    inz('-')
     d  w_mnd                  6      7    inz('01')
     d  bind2                  8      8    inz('-')
     d  w_dag                  9     10    inz('01')
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      *
      * Definering av variabler i nøkler
      *
     d sohel3_firm     s                   like(sofirm)
     d sohel3_aarr     s                   like(soaarr)
     d sohel3_numm     s                   like(sonumm)
     d sohel3_suff     s                   like(sosuff)
      *
     d foheld_firm     s                   like(fofirm)
     d foheld_bdat     s                   like(fobdat)
     d foheld_numm     s                   like(fonumm)
     d foheld_suff     s                   like(fosuff)
      *
     d fdell1_firm     s                   like(fyfirm)
     d fdell1_aarr     s                   like(fyaarr)
     d fdell1_numm     s                   like(fynumm)
     d fdell1_suff     s                   like(fysuff)
      *
      *
      *
      * Les poster
     c     nestles       tag
      *
     c                   exsr      lesfak
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Leser fakturapost SOHEL3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     lesfak        begsr
      *
     c                   open      lo584p
      * Skriv heading
     c                   write     a1hdr
      *
      *
      * Finner faktura- hode
     c                   eval      sohel3_aarr = p_aarr
     c                   eval      sohel3_firm = l_firm
     c                   eval      sohel3_numm = p_a1fr
      *
     c     sohel3_key    setll     sohel3
      *
      **********************************************************************
     c     lesnyf        tag
      *
     c                   read      sohel3                                 60
      *
      * Eof
     c*                  if        *in60 = *on
     c*                  goto      avslutt
     c*                  endif
      *
      *
      * Avslutter dersom nummer > enn valgt til nummer
     c                   if        sonumm > p_a1ti
     c                   eval      *in30 = '1'
     c                   goto      slufak
     c                   endif
      *
      *
     c     fØrste        ifeq      0
     c                   add       1             sohel3_numm
     c                   add       1             fØrste            1 0
     c                   endif
      *
      * Teller til ordrenummer hver gang etter første les
     c*    fØrste        ifeq      0
     c*                  add       1             fØrste            1 0
     c*                  endif
      *
      * Sjekker om post som leses er større enn fra, legger til 1 og leser
      * neste
     c     neste         tag
      *
     c                   if        sonumm > sohel3_numm
      * Sjekk neste fil FOHELD
     c                   exsr      lesord
      *
     c                   if        *in90 = '1'
      * Sjekk neste fil FDELL1
     c***                exsr      lessle
     c                   else
     c                   goto      lesnyf
     c                   endif
     c***                endif
      *
     c                   if        *in90 = '1'
     c                   eval      a1numm = sohel3_numm
     c                   write     d1det                                20
     c     *in20         ifeq      *on
     c                   write     a1hdr
     c                   endif
     c                   endif
      *
     c                   add       1             sohel3_numm
     c                   goto      neste
     c                   endif
      *
     c                   if        sonumm = sohel3_numm
     c                   goto      lesnyf
     c                   endif
      *
     c     slufak        tag
      *
     c                   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Ser om post finnes i FOHELD
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     lesord        begsr
      *
     c                   eval      foheld_firm = l_firm
     c                   eval      foheld_bdat = sobdat
     c                   eval      foheld_numm = sonumm
     c                   eval      foheld_suff = sosuff
      *
     c     foheld_key    chain     foheld                             90
      *
     c                   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_aarr
     c                   parm                    p_a1fr
     c                   parm                    p_a1ti
     c                   parm                    p_pf03
      *
      *
      * Key for oppslag på ordre-hode-register
      *
     c     sohel3_key    klist
     c                   kfld                    sohel3_firm
     c                   kfld                    sohel3_aarr
     c                   kfld                    sohel3_numm
      *
     c     foheld_key    klist
     c                   kfld                    foheld_firm
     c                   kfld                    foheld_bdat
     c                   kfld                    foheld_numm
     c                   kfld                    foheld_suff
      *
     c     fdell1_key    klist
     c                   kfld                    fdell1_firm
     c                   kfld                    fdell1_aarr
     c                   kfld                    fdell1_numm
      *
      *
     c                   endsr
