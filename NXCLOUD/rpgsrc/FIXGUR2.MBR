      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * System. . . . . : ASOKON                                        *     *
      * Program . . . . : FIXGUR2                                       *
      * Beskrivelse . . : Konvertering
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     fgur2l1    uf   e           k disk    rename(gur2pfr:gur2pfr1)
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      *
     d w_firm          s                   like(gdofir)
     d w_gdofor        s                   like(gdofor)
     d xdofor          s                   like(gdofor)
      *
     c                   eval      w_firm = l_firm
     c                   eval      w_gdofor = 0
      *
     c     key01         setll     gur2l1
     c                   read      gur2l1                                 15
      *
      * Ingen poster i filen
     c                   if        *in15 = '1'
     c                   eval      *inlr = '1'
     c                   goto      slutt
     c                   endif
      *
     c                   if        gdofir = l_firm and
     c                             gdofor = 0
      * Finn fÃ¸rste med forfall
     c     nyles         tag
     c                   read      gur2l1                                 15
     c                   if        *in15 = '1'
     c                   eval      *inlr = '1'
     c                   goto      slutt
     c                   endif
     c                   if        gdofor > 0
     c                   eval      xdofor = gdofor
     c                   goto      nyles1
     c                   else
     c                   goto      nyles
     c                   endif
     c                   endif
      *
      * Retter de som har 0 i forfall
     c     nyles1        tag
     c                   eval      w_firm = l_firm
     c                   eval      w_gdofor = 0
      *
     c     key01         setll     gur2l1
     c     nyles2        tag
     c                   read      gur2l1                                 15
     c                   if        *in15 = '1'
     c                   eval      *inlr = '1'
     c                   goto      slutt
     c                   endif
     c                   if        gdofir = l_firm and
     c                             gdofor = 0
     c                   eval      gdofor = xdofor
     c                   update    gur2pfr1
     c                   goto      nyles2
     c                   else
     c                   eval      *inlr = '1'
     c                   goto      slutt
     c                   endif
      *
      *
     c     slutt         tag
      *
      *
     c     key01         klist
     c                   kfld                    w_firm
     c                   kfld                    w_gdofor
      *
