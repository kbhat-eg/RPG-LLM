     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . :
      * Program . . . . : JP991R
      * Beskrivelse . . : Danner BETING (teller) i ANUMPF
      *                   Danner switch i sktist
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       250821 bof  Nytt program
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fanuml1    if   e           k disk    rename(anumpfr:anumlrr)
     fanumlu    uf a e           k disk    rename(anumpfr:anumlur)
      *
      * Definering av variable i nÃ¸kler
     d w_firm          s                   like(anfirm)
     d anuml1_fell     s                   like(anfell)
     d anuml1_type     s                   like(antype)
     d anuml1_fast     s                   like(anfast)
     d anumlu_fell     s                   like(anfell)
     d anumlu_type     s                   like(antype)
     d anumlu_fast     s                   like(anfast)
     d w_teller        s              6  0
     d p_filg          s              3
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      *
     C/Exec SQL
     C+  Set Option DatFmt=*ISO, commit=*none, DlyPrp=*YES
     C+  , SRTSEQ=*LANGIDSHR, LANGID=NOR
     C/End-Exec
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * danner BETING teller
     c                   eval      anuml1_fell = 'BETING'
     c                   eval      anuml1_type = *blank
     c                   eval      anuml1_fast = *blank
     c     anuml1_key    chain     anuml1
     c                   if        not %found(anuml1)
     c                   clear                   anumlur
     c                   eval      anfirm =  w_firm
     c                   eval      anfell =  anuml1_fell
     c                   eval      antype =  anuml1_type
     c                   eval      anfast =  anuml1_fast
     c                   eval      antxt1 = 'Teller for nobb betingelse'
     c                   eval      anwrap = '1'
     c                   eval      anauto = 'A'
     c                   eval      anleng = 1
     c                   eval      annfom = 1
     c                   eval      anntom = 99999999
     c                   eval      ansist = 1
     c                   write     anumlur
     c                   endif
     c
      * danner switch i sktist
     c/exec sql
     c+ select count(*)
     c+ into  :w_teller
     c+ from sktist
     c+ where aktfgp = :p_filg and
     c+  aktfir = :w_firm and
     c+  aktlag = 0   and
     c+  aktnok = 'NOBB_KONTR_XML'
     c/end-exec
      *
     c                   if        w_teller > 1
     c                   goto      avslutt
     c                   endif
     c/exec sql
     C+ INSERT INTO sktist
     c+ (filgruppe,firma,lager,nokkel,verdi1,verdi2,kjede
     c+ ,system,modul,pris,beskrivelse,opprettetav
     c+ ,opprettetkl,opprettetdato,endretdato,endretkl,endretav)
     c+ values (
     c+ :p_filg,:w_firm, 0 ,'NOBB_KONTR_XML','1','','','','',
     c+ 'X KR', 'Nobb innlesing skal skje via XML fra nobb.no',
     c+ :l_user,current_time, current_date, current_Date, current_time,:l_user
     c+ )
     c/end-exec
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      *
     c     *entry        plist
     c                   parm                    p_filg
      *  Key for oppdat anum
      *
     c     anumlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    anumlu_fell
     c                   kfld                    anumlu_type
     c                   kfld                    anumlu_fast
      *
      *  Key for oppdat anum
      *
     c     anuml1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    anuml1_fell
     c                   kfld                    anuml1_type
     c                   kfld                    anuml1_fast
     c
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
