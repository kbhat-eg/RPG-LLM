# Program Overview

This RPG program, named `JO700R`, is an interactive display file program designed for a workstation. The program appears to relate to "matching" and updating from something called "EVR," using parameters. It also supports deleting expired items ("varer") and is tailored for some business logic, possibly for a Norwegian audience (judging by the comments and variable names).

## Header and Setup

```rpgle
h option(*nodebugio) datedit(*dmy)
```
- `option(*nodebugio)` disables debug I/O for faster processing.
- `datedit(*dmy)` specifies date format as day-month-year.

## File Definition

```rpgle
fjo700d    cf   e             workstn
```
- Declares `jo700d` as a display file (workstation), indicating this is an interactive program.

## Data Structures and Variables

### Local Data Area (LDA)

```rpgle
d                uds
d l_firm                944    946  0
```
- The special keyword `uds` references the "User Data Space" (LDA).
- `l_firm` maps to positions 944-946 in the LDA, presumably storing a firm (company) number.

### Standalone Variables

```rpgle
d b_feil          s              1    inz(*off)
d w_firm          s              3  0
```
- `b_feil`: 1-character indicator for "error", initialized to *off.
- `w_firm`: 3-digit company number.

## Main Logic

### Opening Screen Processing

- The label `b1tag` marks the main interactive screen section.

```rpgle
c     b1tag         tag
c                   exfmt     b1bld
```
- Displays and processes the main screen format named `b1bld`.

#### Function Key Handling

```rpgle
c                   if        *inkc = *on or
c                             *inkl = *on
c                   goto      avslutt
c                   endif
```
- Checks if function keys KC (F3/Exit) or KL (F12/Cancel) are pressed. If so, transfers control to `avslutt` (exit).

#### Input Validation

```rpgle
c                   exsr      sjekk_input
c                   if        b_feil = *on
c                   goto      b1tag
c                   endif
```
- Calls the `sjekk_input` subroutine to validate input fields.
- If an error is detected (`b_feil = *on`), redisplay the screen.

#### Call Update Program

```rpgle
c                   call      'JO701R'
c                   parm                    w_firm
```
- Calls external program `JO701R`, passing `w_firm` as parameter.

#### Optional Delete Processing

```rpgle
c                   if        b1slet = 1
c                   call      'JO702R'
c                   parm                    w_firm
c                   endif
```
- If "delete" option (`b1slet`) is selected, calls `JO702R` with the firm number.

### Program Exit

```rpgle
c     avslutt       tag
c                   eval      *inlr = *on
c                   return
```
- Marks program for last record (`*inlr = *on`) and exits.

## Subroutines

### sjekk_input (Check Input Fields)

```rpgle
c     sjekk_input   begsr
c                   eval      b_feil = *off
c     end_sjekk     endsr
```
- Resets the error indicator (`b_feil = *off`). Currently contains no validation logic, but designed to be extended.

### *inzsr (Program Initialization)

```rpgle
c     *inzsr        begsr
c                   eval      w_firm = l_firm
c                   eval      b1slet = 1
c                   endsr
```
- On program start, assigns the company number from LDA to `w_firm`.
- Initializes screen field `b1slet` to 1 (so delete is pre-selected?).

## Business Logic Summary

- The program displays a screen, gets user input, validates it, and then calls an update program (`JO701R`) with the current firm.
- Optionally, if delete is selected, it calls a delete program (`JO702R`).
- Program flow is controlled using RPG's cycle and tags for sections and subroutines.

## Key Variables Used (likely from display fields)

- `b1slet` – not defined in this snippet, but likely a display/indicator variable for "delete" selection.
- `b1bld` – the display format being used for the main screen.

---

## Onboarding Notes

- **Display File Fields:** Ensure `jo700d` (the display file) defines fields like `b1slet`, `b1bld`, and any others referenced here.
- **External Programs:** `JO701R` and `JO702R` should accept parameters as shown (the firm number).
- **LDA Use:** Validate that the correct company number is stored in the LDA at positions 944-946.
- **Input Validation:** Extend the `sjekk_input` subroutine to add necessary business rules.

This program is a good example of classic RPG III/400 interactive programming style, with program flow controlled by tags and subroutines rather than modern structured code.