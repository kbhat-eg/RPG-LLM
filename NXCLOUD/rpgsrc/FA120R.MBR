     H/TITLE  ASOFAK: Jobb-register status, Vedlikehold
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FA120R
      * Beskrivelse . . : Jobb-register status, Vedlikehold
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * 6.10  230609 BSA  Oppdatert med sporingsinformasjon
6.30  * 6.30  150616 BSA  Setter av sperre ved EDI innlesing. (A1JB07)
6.31  * 6.31  120617 sst  Setter av sperre ved compello ovf Navision
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      *
     ffjobl1    if   e           k disk    rename(fjobpfr:fjobl1r)
     ffjoblu    uf a e           k disk    rename(fjobpfr:fjoblur)
     fausrl1    if   e           k disk    rename(ausrpfr:ausrl1r)
     ffa120d    cf   e             workstn
      *
      * Definering av variabler i nøkler
      *
     d ausrl1_user     s                   like(abuser)
      *
      * Definering av variable
      *
     d w_firm          s                   like(fajfir)
     d w_bnav          s                   like(abnavn)
      *
     d                uds
6.10 d l_user                911    920
     d  l_firm               944    946  0
     d  l_fnav               951    980
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * A1BLD Behandle bildet for valg
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     a1taga        tag
      *
      * Hent opplysninger fra jobb-register
      *
     C     fjobl1_key    chain     fjobl1                             90
     C                   if        *in90  = *off
     C                   eval      a1jb01 = fajb01
     C                   eval      a1jb02 = fajb02
     C                   eval      a1jb03 = fajb03
     C                   eval      a1jb04 = fajb04
     C                   eval      a1jb05 = fajb05
     C                   eval      a1jb06 = fajb06
     C                   eval      a1jb07 = fajb07
     C                   eval      a1jb08 = fajb08
     C                   eval      a1jb09 = fajb09
     C                   eval      a1jb10 = fajb10
     C                   else
     C                   eval      a1jb01 = 0
     C                   eval      a1jb02 = 0
     C                   eval      a1jb03 = 0
     C                   eval      a1jb04 = 0
     C                   eval      a1jb05 = 0
     C                   eval      a1jb06 = 0
     C                   eval      a1jb07 = 0
     C                   eval      a1jb08 = 0
     C                   eval      a1jb09 = 0
     C                   eval      a1jb10 = 0
     C                   endif
      *
      * Vis bilde
      *
     C                   exfmt     a1bld
      *
      * F3=Avslutt
      *
     C                   if        *inkc  = *on
     C                   goto      xslutt
     C                   endif
      *
      * F1=Spørring på hvem som har
      *    startet jobben.
      *
     c                   if        *inka  = *on
     c                   if        w_arcd = 'A1BLD'
      *
      * Finn ut hvilket felt det
      * skal søkes på.
      *
     c                   if        w_afld = 'A1JB01'
     c                   eval      ausrl1_user = faus01
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus01
     c                   eval      a2wsid = faws01
     c                   if        fada01 <> *loval
     c     *dmy          move      fada01        a2date
     c                   endif
     c                   if        fati01 <> *loval
     c     *hms          move      fati01        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB02'
     c                   eval      ausrl1_user = faus02
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus02
     c                   eval      a2wsid = faws02
     c                   if        fada02 <> *loval
     c     *dmy          move      fada02        a2date
     c                   endif
     c                   if        fati02 <> *loval
     c     *hms          move      fati02        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB03'
     c                   eval      ausrl1_user = faus03
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus03
     c                   eval      a2wsid = faws03
     c                   if        fada03 <> *loval
     c     *dmy          move      fada03        a2date
     c                   endif
     c                   if        fati03 <> *loval
     c     *hms          move      fati03        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB04'
     c                   eval      ausrl1_user = faus04
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus04
     c                   eval      a2wsid = faws04
     c                   if        fada04 <> *loval
     c     *dmy          move      fada04        a2date
     c                   endif
     c                   if        fati04 <> *loval
     c     *hms          move      fati04        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB05'
     c                   eval      ausrl1_user = faus05
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus05
     c                   eval      a2wsid = faws05
     c                   if        fada05 <> *loval
     c     *dmy          move      fada05        a2date
     c                   endif
     c                   if        fati05 <> *loval
     c     *hms          move      fati05        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB06'
     c                   eval      ausrl1_user = faus06
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus06
     c                   eval      a2wsid = faws06
     c                   if        fada06 <> *loval
     c     *dmy          move      fada06        a2date
     c                   endif
     c                   if        fati06 <> *loval
     c     *hms          move      fati06        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB07'
     c                   eval      ausrl1_user = faus07
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus07
     c                   eval      a2wsid = faws07
     c                   if        fada07 <> *loval
     c     *dmy          move      fada07        a2date
     c                   endif
     c                   if        fati07 <> *loval
     c     *hms          move      fati07        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB08'
     c                   eval      ausrl1_user = faus08
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus08
     c                   eval      a2wsid = faws08
     c                   if        fada08 <> *loval
     c     *dmy          move      fada08        a2date
     c                   endif
     c                   if        fati08 <> *loval
     c     *hms          move      fati08        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB09'
     c                   eval      ausrl1_user = faus09
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus09
     c                   eval      a2wsid = faws09
     c                   if        fada09 <> *loval
     c     *dmy          move      fada09        a2date
     c                   endif
     c                   if        fati09 <> *loval
     c     *hms          move      fati09        a2time
     c                   endif
     c                   endif
      *
     c                   if        w_afld = 'A1JB10'
     c                   eval      ausrl1_user = faus10
     C                   exsr      x_user
     c                   eval      a2bnav = w_bnav
     c                   eval      a2user = faus10
     c                   eval      a2wsid = faws10
     c                   if        fada10 <> *loval
     c     *dmy          move      fada10        a2date
     c                   endif
     c                   if        fati10 <> *loval
     c     *hms          move      fati10        a2time
     c                   endif
     c                   endif
      *
     C                   exfmt     a2bld
     C                   goto      a1taga
      *
     c                   endif
     c                   endif
      *
      * Oppdater Jobb-register
      *
     c     fjoblu_key    chain     fjoblur                            90
      *
     c                   eval      fajb01 = a1jb01
     c                   eval      fajb02 = a1jb02
     c                   eval      fajb03 = a1jb03
     c                   eval      fajb04 = a1jb04
     c                   eval      fajb05 = a1jb05
     c                   eval      fajb06 = a1jb06
     c                   eval      fajb07 = a1jb07
     c                   eval      fajb08 = a1jb08
     c                   eval      fajb09 = a1jb09
     c                   eval      fajb10 = a1jb10
      *
     c                   if        *in90  = *off
6.10 c                   time                    fajeda
6.10 c                   time                    fajeti
6.10 c                   eval      fajeus = l_user
     c                   update    fjoblur
     c                   else
     c                   eval      fajfir = l_firm
6.10 c                   time                    fajoda
6.10 c                   time                    fajoti
6.10 c                   eval      fajous = l_user
6.10 c                   time                    fajeda
6.10 c                   time                    fajeti
6.10 c                   eval      fajeus = l_user
     c                   write     fjoblur
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for oppslag mot bruker-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     x_user        begsr
      *
      * Slå opp bruker-register
      *
     c                   eval      w_bnav = *blank
     C     ausrl1_key    chain     ausrl1                             91
     c                   if        *in91  = *off
     c                   eval      w_bnav = abnavn
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *inzsr        begsr
      *
      * Key for file : Jobb-register read
      *
     c     fjobl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for file : Jobb-register update
      *
     c     fjoblu_key    klist
     c                   kfld                    w_firm
      *
      * Key for brukerregister
      *
     c     ausrl1_key    klist
     c                   kfld                    ausrl1_user
      *
      * Legger inn firmanummer i nøkkel
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
