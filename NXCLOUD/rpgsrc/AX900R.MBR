     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  System. . . . . :
      *  Program . . . . : AX900R
      *  Beskrivelse . . : Endring av øæå ØÆÅ + svenske, tyske etc
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Spesialversjon. :
      *  Tilpasset for . :
      *
Versj *Uts   Dato Usr Referanse Beskrivelse
      *____________________________________________________________________________________________
      *K00-200420               START FOR VERSJON K00
7.00  *K00 200420 SST NXS-4426  Utrulling av SAFT-Rapporter til alle kundene
      *
      *
      *
      *____________________________________________________________________________________________
      *
      *
     faxmlut    up   e             disk
     frxmml1    if   e           k disk        rename(rxmmpfr:rxmml1r)
      *
     fliste     o    f  132        printer
      *
     d w_alfa          s              3
     d w_xmlr          s            120
     d teller          s              6  0
      *
     d text            s            121
      *
     d i               s              9S 0
     d w_posi          s              2  0
     d w_posu          s              2  0
     d w_str_i         s            512
     d w_str_u         s            512
     d w_str_x         s              1
      *
     d c_apos          c                   x'7D'
      *
     d rxmml1_firm     s                       like(xmfirm)
      *
      *
     d                uds
     d l_firm                944    946  0
     d l_user                911    920
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Oppdater linjer med nye bokstaver
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      *  Henter subrutine utfra hvilken metode som skal benyttes
      *
     c                   move      *off          *in90
     c                   add       1             teller
      *
     c     w_alfa        ifeq      '1X1'
     c                   exsr      SUB1X1
     c                   endif
      *
     c     w_alfa        ifeq      'SPS'
     c                   exsr      SUBSPS
     c                   endif
      *
     c     *in90         ifeq      *on
     c                   movel     text          xmlrec
     c                   update    axmlutr
      *
     c**                 except    skriv
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     XSLUTT        TAG
      *
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  1X1 Subrutine for bytting av bokstav for bokstav
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Æ = E       æ = e
      *  Ø = O       Ø = o
      *  Å = A       Å = a
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     SUB1X1        begsr
      *
      *
     c                   movel     xmlrec        text
      *
      *
      *
     c     'Æ'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'E'           +
     c                             %subst(text:i+1:120-i)
     c     'Æ'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'Ø'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'O'           +
     c                             %subst(text:i+1:120-i)
     c     'Ø'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'Å'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'A'           +
     c                             %subst(text:i+1:120-i)
     c     'Å'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'æ'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'e'           +
     c                             %subst(text:i+1:120-i)
     c     'æ'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'ø'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'o'           +
     c                             %subst(text:i+1:120-i)
     c     'ø'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'å'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'a'           +
     c                             %subst(text:i+1:120-i)
     c     'å'           scan      text          i
     c                   enddo
      *
      *  Spesial-tegn
      *
     c     '&'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             ' '           +
     c                             %subst(text:i+1:120-i)
     c     '&'           scan      text          i
     c                   enddo
      *
      *  Svenske tegn
      *
     c     'ä'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'a'           +
     c                             %subst(text:i+1:120-i)
     c     'ä'           scan      text          i
     c                   enddo
      *
     c     'Ä'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'A'           +
     c                             %subst(text:i+1:120-i)
     c     'Ä'           scan      text          i
     c                   enddo
      *
     c     'À'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'A'           +
     c                             %subst(text:i+1:120-i)
     c     'À'           scan      text          i
     c                   enddo
      *
     c     'ö'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'o'           +
     c                             %subst(text:i+1:120-i)
     c     'ö'           scan      text          i
     c                   enddo
      *
     c     'Ö'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'O'           +
     c                             %subst(text:i+1:120-i)
     c     'Ö'           scan      text          i
     c                   enddo
      *
     c     'è'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'e'           +
     c                             %subst(text:i+1:120-i)
     c     'è'           scan      text          i
     c                   enddo
      *
     c     'é'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'e'           +
     c                             %subst(text:i+1:120-i)
     c     'é'           scan      text          i
     c                   enddo
      *
     c     'É'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'E'           +
     c                             %subst(text:i+1:120-i)
     c     'É'           scan      text          i
     c                   enddo
      *
     c     'È'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'E'           +
     c                             %subst(text:i+1:120-i)
     c     'È'           scan      text          i
     c                   enddo
      *
     c     'ô'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'o'           +
     c                             %subst(text:i+1:120-i)
     c     'ô'           scan      text          i
     c                   enddo
      *
     c     'ò'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'o'           +
     c                             %subst(text:i+1:120-i)
     c     'ò'           scan      text          i
     c                   enddo
      *
      * Tyske
      *
     c     'ü'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'u'           +
     c                             %subst(text:i+1:120-i)
     c     'ü'           scan      text          i
     c                   enddo
      *
     c     'Ô'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'O'           +
     c                             %subst(text:i+1:120-i)
     c     'Ô'           scan      text          i
     c                   enddo
      *
     c     'Ü'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             'U'           +
     c                             %subst(text:i+1:120-i)
     c     'Ü'           scan      text          i
     c                   enddo
      *
      *  Det er gjort endringer, sett på indikator
      *
     c     xmlrec        ifne      text
     c                   movel     text          w_xmlr
     c                   move      *on           *in90
     c                   endif
      *
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  SPS Subrutine for bytting av bokstav for bokstav
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Bytter til spesial-tegn
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     SUBSPS        begsr
      *
     c                   movel     xmlrec        text
      *
      *
      *
     c     'Æ'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'06' +
     c                             %subst(text:i+1:120-i)
     c     'Æ'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'Ø'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'38' +
     c                             %subst(text:i+1:120-i)
     c     'Ø'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'Å'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'15' +
     c                             %subst(text:i+1:120-i)
     c     'Å'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'æ'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'70' +
     c                             %subst(text:i+1:120-i)
     c     'æ'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'ø'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'9D' +
     c                             %subst(text:i+1:120-i)
     c     'ø'           scan      text          i
     c                   enddo
      *
      *
      *
     c     'å'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'B2' +
     c                             %subst(text:i+1:120-i)
     c     'å'           scan      text          i
     c                   enddo
      *
      *  Det er gjort endringer, sett på indikator
      *
     c     xmlrec        ifne      text
     c                   movel     text          w_xmlr
     c                   move      *on           *in90
     c                   endif
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *inzsr        begsr
      *
      *
     c     rxmml1_key    klist
     c                   kfld                    rxmml1_firm
      *
      *
     c                   move      l_firm        rxmml1_firm
     c     rxmml1_key    chain     rxmml1
     c                   move      '1X1'         w_alfa
     c                   if        %found(rxmml1)
     c                   movel     xmalfa        w_alfa
     c                   endif
      *
     c                   endsr
      *
     oliste     e            skriv          1
     o                       teller              06
     o                       w_xmlr             130
