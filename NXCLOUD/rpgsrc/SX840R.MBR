     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SX840R
      * Beskrivelse . . : Oppdatere statistikk m/alm.rab. fra bonglinjer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       240408 AMD  Nytt program
8.01  *PRG2   220622 BOF  Utvidet prisgruppe fra 1 til 2 posisjoner - COMP
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fsstalu    uf   e           k disk    rename(sstapfr:sstalur)
     fbodtlq    if   e           k disk    rename(bodtpfr:bodtlqr)
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av variabler i n√∏kler
      *
     d sstalu_paar     s                   like(sfpaar)
     d bodtlq_aarr     s                   like(bdaarr)
     d bodtlq_bong     s                   like(bdbong)
     d bodtlq_vare     s                   like(bdvare)
      *
      * Definering av variable
      *
     d w_firm          s                   like(sffirm)
     d w_aarr          s                   like(sfpaar)
     d w_totn          s                   like(sfsumb)
     d w_tot1          s                   like(sfsumb)
     d w_tot2          s                   like(sfsumb)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      sstalu_paar = w_aarr
     c     sstalu_key    setll     sstalu
     c     sstalu_key    reade     sstalu
     c                   dow       not %eof
      *
      * Sjekk om dette er en bong fra
      * kasse - systemet
      *
     c                   if        sfbong = *blank
     c                   unlock    sstalu
     c                   goto      neste
     c                   endif
      *
     c                   exsr      behandle
      *
     c     neste         tag
      *
     c     sstalu_key    reade     sstalu                                 61
     c                   enddo
      *
     c                   goto      avslutt
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Oppdatere statistikk
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandle      begsr
      *
     c                   eval      bodtlq_aarr = sfpaar
     c                   eval      bodtlq_bong = sfbong
     c                   eval      bodtlq_vare = sfvare
      *
     c     bodtlq_key    chain     bodtlqr
     c                   if        not %found
     c                   unlock    sstalu
     c                   goto      end_sr
     c                   endif
      *
     c                   if        bdbrr1 = 0 and
     c                             bdbrr2 = 0
     c                   unlock    sstalu
     c                   goto      end_sr
     c                   endif
      *
      * Oppdater statistikk-register
      *
5.60 c                   eval      w_totn = sfsumb - sfrab1 - sfrab2
5.60 c                   eval      w_tot1 = 0
5.60 c                   eval      w_tot2 = 0
5.60  *
5.60 c                   if        bdbrr1 <> 0
5.60 c                   eval      w_tot1 = w_totn * bdbrr1 / 100
5.60 c                   eval      w_totn = w_totn - w_tot1
5.60 c                   endif
5.60  *
5.60 c                   if        bdbrr2 <> 0
5.60 c                   eval      w_tot2 = w_totn * bdbrr2 / 100
5.60 c                   eval      w_totn = w_totn - w_tot2
5.60 c                   endif
5.60  *
5.60 c                   eval      sfbrk1 = w_tot1
5.60 c                   eval      sfbrk2 = w_tot2
      *
     c                   update    sstalur
      *
     c     end_sr        endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for oppdatering av statistikk
      *
     c     sstalu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    sstalu_paar
      *
      * Key for les av bong-linje-register
      *
     c     bodtlq_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bodtlq_aarr
     c                   kfld                    bodtlq_bong
     c                   kfld                    bodtlq_vare
      *
      * Henter firmakode fra local
      *
     c***                eval      w_firm = l_firm
     c                   eval      w_firm = 200
     c                   eval      w_aarr = *year
      *
     c                   endsr
