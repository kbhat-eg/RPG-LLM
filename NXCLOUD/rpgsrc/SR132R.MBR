      /TITLE  ASSTAT Utvalg til parameterfil, fra/til leverandør
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SR132R
      * Beskrivelse . . : Utvalg til parameterfil, fra/til leverandør
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
5.20  * R5.20 211003 AMD  Ved spørring på leverandør var det referert til
5.20  *                   et feil program.  Endringer er ikke merket på
5.20  *                   linjenivå i programmet. Parameterlister måtte
5.20  *                   også endres.
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fSR132d    cf   e             workstn
      *
     fslpml1    if   e           k disk    rename(slpmpfr:slpml1r)
     fslpmlu    uf a e           k disk    rename(slpmpfr:slpmlur)
      *
      *---------------------------------------------------------------------
      *
     d wptype          s                   like(srtype)
     d wptext          s             30
     d wpfirm          s                   like(srfirm)
     d wpkund          s              6  0
     d wpnavn          s             30
     d wptek1          s                   like(wptext)
      *
     d wwfirm          s                   like(srfirm)
     d wwtype          s                   like(srtype)
     d wwkode          s                   like(srkode)
      *
     dwwrest           ds           330
     d wwtext                  1     30
     d wwflen                         6  0 dim(10)
     d wwtlen                         6  0 dim(10)
      *
     d wwvalg          ds
     d  wwfyll                 1     15
      *
     dww_sjekk_array   ds           120
     d ww_sjekk_flen                  6  0 dim(10)
     d ww_sjekk_tlen                  6  0 dim(10)
      *
     d                uds
     d dsuser                911    920
     d dsfirm                944    946  0
     d l_fnav                951    980
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     b2tagb        tag
      *
      * slå opp
      * i filen
      *
     c     key01         chain     slpml1                             60
      *
      * post finnes
      * fra før
      *
     c                   if        *in60 = *off                                          .....
     c                   movel     srrest        wwrest                                      .
     c                   movel     wwflen(1)     b2fle1                                      .
     c                   movel     wwflen(2)     b2fle2                                      .
     c                   movel     wwflen(3)     b2fle3                                      .
     c                   movel     wwflen(4)     b2fle4                                      .
     c                   movel     wwflen(5)     b2fle5                                      .
     c                   movel     wwflen(6)     b2fle6                                      .
     c                   movel     wwflen(7)     b2fle7                                      .
     c                   movel     wwflen(8)     b2fle8                                      .
     c                   movel     wwflen(9)     b2fle9                                      .
     c                   movel     wwflen(10)    b2fle10                                     .
      *
     c                   movel     wwtlen(1)     b2tle1                                      .
     c                   movel     wwtlen(2)     b2tle2                                      .
     c                   movel     wwtlen(3)     b2tle3                                      .
     c                   movel     wwtlen(4)     b2tle4                                      .
     c                   movel     wwtlen(5)     b2tle5                                      .
     c                   movel     wwtlen(6)     b2tle6                                      .
     c                   movel     wwtlen(7)     b2tle7                                      .
     c                   movel     wwtlen(8)     b2tle8                                      .
     c                   movel     wwtlen(9)     b2tle9                                      .
     c                   movel     wwtlen(10)    b2tle10                                     .
      *                                                                                      .
     c                   endif                                                           .....
      *
      * post finnes
      * ikke
      *
     c                   if        *in60 = *on                                           .....
     c                   eval      b2fle1 = *zeros                                           .
     c                   eval      b2fle2 = *zeros                                           .
     c                   eval      b2fle3 = *zeros                                           .
     c                   eval      b2fle4 = *zeros                                           .
     c                   eval      b2fle5 = *zeros                                           .
     c                   eval      b2fle6 = *zeros                                           .
     c                   eval      b2fle7 = *zeros                                           .
     c                   eval      b2fle8 = *zeros                                           .
     c                   eval      b2fle9 = *zeros                                           .
     c                   eval      b2fle10 = *zeros                                          .
     c                   eval      b2tle1 = *zeros                                           .
     c                   eval      b2tle2 = *zeros                                           .
     c                   eval      b2tle3 = *zeros                                           .
     c                   eval      b2tle4 = *zeros                                           .
     c                   eval      b2tle5 = *zeros                                           .
     c                   eval      b2tle6 = *zeros                                           .
     c                   eval      b2tle7 = *zeros                                           .
     c                   eval      b2tle8 = *zeros                                           .
     c                   eval      b2tle9 = *zeros                                           .
     c                   eval      b2tle10 = *zeros                                          .
     c                   endif                                                           .....
      *
     c     b2taga        tag
      *
     c                   exfmt     b2bld
      *
      * avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * Spørring
      *
     c     *inkd         ifeq      *on
     c                   exsr      xspstr
     c                   if        *in80 = *on
     c                   goto      b2taga
     c                   endif
     c                   endif
      *
      * Sjekk om fra er større enn til
      *
     c                   if        b2fle1 > b2tle1
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle2 > b2tle2
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle3 > b2tle3
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle4 > b2tle4
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle5 > b2tle5
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle6 > b2tle6
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle7 > b2tle7
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle8 > b2tle8
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle9 > b2tle9
     c                   goto      b2taga
     c                   endif
     c                   if        b2fle10 > b2tle10
     c                   goto      b2taga
     c                   endif
      *
     c     key01         chain     slpmlu                             60
      *
     c                   movel     b2fle1        wwflen(1)                                   .
     c                   movel     b2fle2        wwflen(2)                                   .
     c                   movel     b2fle3        wwflen(3)                                   .
     c                   movel     b2fle4        wwflen(4)                                   .
     c                   movel     b2fle5        wwflen(5)                                   .
     c                   movel     b2fle6        wwflen(6)                                   .
     c                   movel     b2fle7        wwflen(7)                                   .
     c                   movel     b2fle8        wwflen(8)                                   .
     c                   movel     b2fle9        wwflen(9)                                   .
     c                   movel     b2fle10       wwflen(10)                                  .
     c                   movel     b2tle1        wwtlen(1)                                   .
     c                   movel     b2tle2        wwtlen(2)                                   .
     c                   movel     b2tle3        wwtlen(3)                                   .
     c                   movel     b2tle4        wwtlen(4)                                   .
     c                   movel     b2tle5        wwtlen(5)                                   .
     c                   movel     b2tle6        wwtlen(6)                                   .
     c                   movel     b2tle7        wwtlen(7)                                   .
     c                   movel     b2tle8        wwtlen(8)                                   .
     c                   movel     b2tle9        wwtlen(9)                                   .
     c                   movel     b2tle10       wwtlen(10)                                  .
     c                   eval      wwtext = 'Kundenummer fra/til'
     c                   eval      srrest = wwrest
     c                   eval      srsyst = 'L'
      *
     c                   movea     wwflen        ww_sjekk_flen
     c                   movea     wwtlen        ww_sjekk_tlen
      *
      * posten finnes
      * fra før
      *
     c                   if        *in60 = *off                                          .....
     c                   if        b2fle1 = 0 and b2tle1 = 0
     c                   delete    slpmlur
     c                   else
     c                   update    slpmlur                                                   .
     c                   endif
     c                   endif
      *
      * posten finnes
      * ikke fra før
      *
     c                   if        *in60 = *on                                           .....
     c                             and ww_sjekk_array <> *blanks
     c                   if        b2tle1 <> 0
     c                   eval      srtype = wwtype
     c                   eval      srkode = wwkode
     c                   eval      srfirm = wwfirm
     c                   write     slpmlur                                                   .
     c                   endif
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for søking                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xspstr        begsr
      *
     c                   eval      *in80 = *off
     c                   eval      wpkund= 0
     c
      *
      * call program for leverandørspørring
      *
     c     wactfe        ifeq      'B2FLE1'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle1
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE2'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle2
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE3'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle3
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE4'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle4
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE5'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle5
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE6'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle6
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE7'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle7
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE8'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle8
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE9'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle9
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FLE10'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fle10
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE1'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle1
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE2'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle2
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE3'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle3
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE4'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle4
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE5'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle5
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE6'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle6
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE7'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle7
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE8'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle8
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE9'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle9
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TLE10'
     c                   call      'RL500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tle10
     c                   goto      xspend
     c                   endif
      *
     c     xspend        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
      * Key for file nummerisk
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwtype
     c                   kfld                    wwkode
     c                   kfld                    wwvalg
      *
      * Tar inn parameter fra forrige program
      *
     c     *entry        plist
     c                   parm                    wptype
     c                   parm                    wptext
      *
     c                   eval      wwfirm = dsfirm
     c                   eval      wwtype = wptype
     c                   eval      wwkode = 32
     c                   eval      wwvalg = *blank
      *
     c                   eval      srfirm = dsfirm
      *
     c                   eval      b2type = wptype
     c                   eval      b2text = wptext
      *
     c                   endsr
