     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : VP685R
      * Beskrivelse . . : Prisfil til kunder
      *                   (Format: Flatfil for konv. til EDIFACT PRICAT)
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       111202 GRO  Nytt program - utg.pkt VP682R
      *       161203 HKO  Endret parameter ved kall til VP900R
      *       120804 HKO  Endret parameter ved kall til VP900R
      *       041104 HKO  Endret parameter ved kall til VP900R
      *       020805 HKO  Endret les mot vare-enhet for å finne prisbok-
      *                   enheter og salgsenheter
      *       040805 HKO  Henter vekt og voluminformasjon fra vare-enhet
      *       260606 HKO  Henter pris på bakgrunn av valgt leveringstype
5.70  * PRGR  311008 bof  Utvidet med prisgruppe
      * 6.10  230609 BSA  Oppdatert med sporingsinformasjon
6.11  * 6.10  290609 bof  Utivdet eannr til 14 og brukt std. oppslag
6.20  * 6.20  030411 bof  Utivdet vvprpf med prisgiver
6.21  * 6.20  190511 bø   Utvidet vl710r med div. info
6.nu  *       160614 bof  Endret ihht. nummerutvidelse
6.30  * 6.30  180515 bkv  Endret LVAR pga økt fra 15 til 20 tegn
6.31  * 6.30  170918 bkv  Utvidet med trelast sortiment
      *
8.01  *PRG2   150622 bsa  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffstsl1    if   e           k disk    rename(fstspfr:fstsl1r)
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     ffkprl1    if   e           k disk    rename(fkprpfr:fkprl1r)
     fvvarl9    if   e           k disk    rename(vvarpfr:vvarl9r)
     fvvenl3    if   e           k disk    rename(vvenpfr:vvenl3r)
     fvvenl2    if   e           k disk    rename(vvenpfr:vvenl2r)
     fvvenl1    if   e           k disk    rename(vvenpfr:vvenl1r)
     fvvprl1    if   e           k disk    rename(vvprpfr:vvprl1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     fvpkol1    if   e           k disk    rename(vpkopfr:vpkol1r)
     frlevl1    if   e           k disk    rename(rlevpfr:rlevl1r)
     fafirl1    if   e           k disk    rename(afirpfr:afirl1r)
     fraa8l1    if   e           k disk    rename(raa8pfr:raa8l1r)
     ffkdilu    uf   e           k disk    rename(fkdipfr:fkdilur)
6.31 fvvlel1    if   e           k disk    rename(vvlepfr:vvlel1r)
     fvvawpf    if   e           k disk
      *
     ffiprpf    uf a e           k disk
      *
      * Definering av datastrukturer
      *
      *  Datastruktur - parametre inn til VP900R
      *
     d                 ds
     d hirec                        120
     d  hifirm                        3  0 overlay(hirec)
     d  hirkat                        3  0 overlay(hirec:4)
     d  hikund                        6  0 overlay(hirec:7)
     d  hikpro                        6  0 overlay(hirec:13)
     d  hivare                       15    overlay(hirec:19)
     d  hilety                        1  0 overlay(hirec:34)
     d  hienhe                        3    overlay(hirec:35)
     d  hidato                         d   overlay(hirec:38) datfmt(*iso)
     d  hitime                         t   overlay(hirec:48) timfmt(*iso)
6.nu d  hinumm                        8  0 overlay(hirec:56)
6.nu d  hikode                        1    overlay(hirec:64)
6.nu d  hidekn                        5  2 overlay(hirec:65)
6.nu d  hiavgf                        1  0 overlay(hirec:70)
6.nu d  hipriv                        1  0 overlay(hirec:71)
6.nu d  hitilb                        1    overlay(hirec:72)
6.nu d  hiskaf                        1    overlay(hirec:73)
6.nu d  hildor                        6  0 overlay(hirec:74)
6.nu d  hisapr                        9  2 overlay(hirec:80)
6.nu d  hikopr                        9  2 overlay(hirec:89)
8.01 d  hiprgr                        2    overlay(hirec:98)
     d  hiinlr                        1    overlay(hirec:120)
      *
      *  Datastruktur - parametre ut fra VP900R
      *
     d                 ds
     d horec                         80
     d  hokpri                        1    overlay(horec:2)
     d  hooppr                        9  2 overlay(horec:3)
     d  hosapr                        9  2 overlay(horec:12)
     d  horab1                        5  2 overlay(horec:30)
     d  horab2                        5  2 overlay(horec:35)
8.01 d  hoprgr                        2    overlay(horec:71)
      *
      *  Recordstrukturer EDIFACT PRICAT D.93A.
      *
      *  Posttype FMS - Start forsendelse
     d                 ds
     d  d_pfms                       35
     d   d_pfms_type                  3    overlay(d_pfms:  1) inz('FMS')
     d   d_pfms_fill                  2    overlay(d_pfms:  4)
     d   d_pfms_avid                 12    overlay(d_pfms:  6)
     d   d_pfms_beha                 12    overlay(d_pfms: 18)
     d   d_pfms_meld                  6    overlay(d_pfms: 30) inz('PRICAT')
      *
      *  Posttype 00F - Start melding
     d                 ds
     d  d_p00F                       58
     d   d_p00F_type                  3    overlay(d_p00F:  1) inz('00F')
     d   d_p00F_fsep                  1    overlay(d_p00F:  4)
     d   d_p00F_avse                 13  0 overlay(d_p00F:  5)
     d   d_p00F_mott                 13  0 overlay(d_p00F: 18)
     d   d_p00F_dato                  8  0 overlay(d_p00F: 31)
     d   d_p00F_time                  4  0 overlay(d_p00F: 39)
     d   d_p00F_fonr                 14    overlay(d_p00F: 43)
     d   d_p00F_kind                  1    overlay(d_p00F: 57)
     d   d_p00F_tind                  1    overlay(d_p00F: 58)
      *
      *  Posttype 020 - Varekatalog Hode Del 1
     d                 ds
     d  d_p020                      257
     d   d_p020_type                  3    overlay(d_p020:  1) inz('020')
     d   d_p020_vnum                  5    overlay(d_p020:  4) inz('PRI06')
     d   d_p020_mvar                  3    overlay(d_p020:  9) inz('9  ')
     d   d_p020_pknr                 17    overlay(d_p020: 12)
     d   d_p020_mfun                  3    overlay(d_p020: 29)
     d   d_p020_mdat                 12    overlay(d_p020: 32)
     d   d_p020_pfra                 12    overlay(d_p020: 44)
     d   d_p020_ptil                 12    overlay(d_p020: 56)
     d   d_p020_rver                  5    overlay(d_p020: 68) inz('6.0  ')
     d   d_p020_vdat                  8    overlay(d_p020: 73)
     d   d_p020_kref                 17    overlay(d_p020: 81)
     d   d_p020_kdat                  8    overlay(d_p020: 98)
     d   d_p020_pref                 17    overlay(d_p020:106)
     d   d_p020_pdat                  8    overlay(d_p020:123)
     d   d_p020_kjop                 13    overlay(d_p020:131)
     d   d_p020_levr                 13    overlay(d_p020:144)
     d   d_p020_mvap                  3    overlay(d_p020:157)
     d   d_p020_orst                 35    overlay(d_p020:160)
     d   d_p020_kinf                 35    overlay(d_p020:195)
     d   d_p020_knum                 25    overlay(d_p020:230)
     d   d_p020_ktyp                  3    overlay(d_p020:255)
      *
      *  Posttype 030 - Varekatalog Hode Del 2
     d                 ds
     d  d_p030                       40
     d   d_p030_type                  3    overlay(d_p030:  1) inz('030')
     d   d_p030_valt                  3    overlay(d_p030:  4)
     d   d_p030_vbet                  3    overlay(d_p030:  7)
     d   d_p030_vkur                 12  3 overlay(d_p030: 10)
     d   d_p030_kdat                  8    overlay(d_p030: 22)
     d   d_p030_bbet                  3  0 overlay(d_p030: 30)
     d   d_p030_rabs                  8  2 overlay(d_p030: 33)
      *
      *  Posttype 036 - Varekatalog Gruppedel
     d                 ds
     d  d_p036                       19
     d   d_p036_type                  3    overlay(d_p036:  1) inz('036')
     d   d_p036_lbet                  3    overlay(d_p036:  4) inz('EXW')
     d   d_p036_hste                 13    overlay(d_p036:  7)
      *
      *  Posttype 038 - Varekatalog Hovedlinje Leverandørinfo.
     d                 ds
     d  d_p038                       89
     d   d_p038_type                  3    overlay(d_p038:  1) inz('038')
     d   d_p038_pgrp                  3    overlay(d_p038:  4)
     d   d_p038_levn                 13    overlay(d_p038:  7)
     d   d_p038_lnav                 35    overlay(d_p038: 20)
     d   d_p038_epdn                 35    overlay(d_p038: 55)
      *
      *  Posttype 040 - Varekatalog Hovedlinje Del 1
     d                 ds
     d  d_p040                      265
     d   d_p040_type                  3    overlay(d_p040:  1) inz('040')
     d   d_p040_resv                  3    overlay(d_p040:  4)
     d   d_p040_lnum                  6  0 overlay(d_p040:  7)
     d   d_p040_fkod                  3    overlay(d_p040: 13) inz('3  ')
     d   d_p040_psta                  3    overlay(d_p040: 16)
     d   d_p040_eann                 14    overlay(d_p040: 19)
     d   d_p040_vnrt                  3    overlay(d_p040: 33)
     d   d_p040_lvnr                 17    overlay(d_p040: 36)
     d   d_p040_epdn                 17    overlay(d_p040: 53)
     d   d_p040_vgrp                  6    overlay(d_p040: 70)
     d   d_p040_vgdv                  6    overlay(d_p040: 76)
     d   d_p040_vmnr                  6    overlay(d_p040: 82)
     d   d_p040_pvar                 17    overlay(d_p040: 88)
     d   d_p040_skod                  2    overlay(d_p040:105)
     d   d_p040_erid                 14    overlay(d_p040:107)
     d   d_p040_vntp                  3    overlay(d_p040:121)
     d   d_p040_nvid                 14    overlay(d_p040:124)
     d   d_p040_vnt2                  3    overlay(d_p040:138)
     d   d_p040_erst                 14    overlay(d_p040:141)
     d   d_p040_vnt3                  3    overlay(d_p040:155)
     d   d_p040_vtxt                 35    overlay(d_p040:158)
     d   d_p040_sthh                  3    overlay(d_p040:193)
     d   d_p040_htxt                 35    overlay(d_p040:196)
     d   d_p040_btxt                 35    overlay(d_p040:231)
      *
      *  Posttype 045 - Varekatalog Hovedlinje Del 2
     d                 ds
     d  d_p045                      208
     d   d_p045_type                  3    overlay(d_p045:  1) inz('045')
     d   d_p045_lnum                  6  0 overlay(d_p045:  4)
     d   d_p045_eann                 14    overlay(d_p045: 10)
     d   d_p045_uenh                  3    overlay(d_p045: 24)
     d   d_p045_mmrk                  3    overlay(d_p045: 27)
     d   d_p045_gmod                  3    overlay(d_p045: 30)
     d   d_p045_okol                  3    overlay(d_p045: 33)
     d   d_p045_dmmy                 23    overlay(d_p045: 36)
     d   d_p045_vmrk                 35    overlay(d_p045: 59)
     d   d_p045_sflt                 10    overlay(d_p045: 94)
     d   d_p045_enht                  7    overlay(d_p045:104)
     d   d_p045_ibba                  7    overlay(d_p045:111)
     d   d_p045_ptyp                  7    overlay(d_p045:118)
     d   d_p045_remb                  7    overlay(d_p045:125)
     d   d_p045_mixp                  7    overlay(d_p045:132)
     d   d_p045_peg1                 35    overlay(d_p045:139)
     d   d_p045_peg2                 35    overlay(d_p045:174)
      *
      *  Posttype 050 - Varekatalog Hovedlinje Del 3
     d                 ds
     d  d_p050                      214
     d   d_p050_type                  3    overlay(d_p050:  1) inz('050')
     d   d_p050_lnum                  6  0 overlay(d_p050:  4)
     d   d_p050_eann                 14    overlay(d_p050: 10)
     d   d_p050_tmin                  9  4 overlay(d_p050: 24)
     d   d_p050_tmax                  9  4 overlay(d_p050: 33)
     d   d_p050_tnoy                  3    overlay(d_p050: 42)
     d   d_p050_ptyp                  3    overlay(d_p050: 45)
     d   d_p050_lene                  3    overlay(d_p050: 48)
     d   d_p050_vole                  3    overlay(d_p050: 51)
     d   d_p050_veke                  3    overlay(d_p050: 54)
     d   d_p050_nvca                  9  3 overlay(d_p050: 57)
     d   d_p050_nvfr                  9  3 overlay(d_p050: 66)
     d   d_p050_nvti                  9  3 overlay(d_p050: 75)
     d   d_p050_nvek                  9  3 overlay(d_p050: 84)
     d   d_p050_nvol                  9  4 overlay(d_p050: 93)
     d   d_p050_aprl                  6  0 overlay(d_p050:102)
     d   d_p050_lprp                  6  0 overlay(d_p050:108)
     d   d_p050_levs                  9  2 overlay(d_p050:114)
     d   d_p050_mibk                  9  2 overlay(d_p050:123)
     d   d_p050_mfan                  9  2 overlay(d_p050:132)
     d   d_p050_vupb                  9  2 overlay(d_p050:141)
     d   d_p050_tkva                  9  2 overlay(d_p050:150)
     d   d_p050_afpk                  9  2 overlay(d_p050:159)
     d   d_p050_adpk                  9  2 overlay(d_p050:168)
     d   d_p050_bonb                  3    overlay(d_p050:177)
     d   d_p050_kfak                 10  4 overlay(d_p050:180)
     d   d_p050_besk                  3    overlay(d_p050:190)
     d   d_p050_noy1                  3    overlay(d_p050:193)
     d   d_p050_men1                  3    overlay(d_p050:196)
     d   d_p050_pstr                 10  4 overlay(d_p050:199)
     d   d_p050_men2                  3    overlay(d_p050:209)
     d   d_p050_noy2                  3    overlay(d_p050:212)
      *
      *  Posttype 052 - Varekatalog Hovedlinje Del 3A
     d                 ds
     d  d_p052                       40
     d   d_p052_type                  3    overlay(d_p052:  1) inz('052')
     d   d_p052_lnum                  6  0 overlay(d_p052:  4)
     d   d_p052_eann                 14    overlay(d_p052: 10)
     d   d_p052_ninn                  8  2 overlay(d_p052: 24)
     d   d_p052_besk                  3    overlay(d_p052: 32)
     d   d_p052_noya                  3    overlay(d_p052: 35)
     d   d_p052_menh                  3    overlay(d_p052: 38)
      *
      *  Posttype 055 - Varekatalog Hovedlinje Del 4
     d                 ds
     d  d_p055                      100
     d   d_p055_type                  3    overlay(d_p055:  1) inz('055')
     d   d_p055_lnum                  6  0 overlay(d_p055:  4)
     d   d_p055_eann                 14    overlay(d_p055: 10)
     d   d_p055_hkod                  3    overlay(d_p055: 24)
     d   d_p055_inst                 70    overlay(d_p055: 27)
     d   d_p055_fgod                  4    overlay(d_p055: 97)
      *
      *  Posttype 060 - Varekatalog Hovedlinje Del 5
     d                 ds
     d  d_p060                      181
     d   d_p060_type                  3    overlay(d_p060:  1) inz('060')
     d   d_p060_lnum                  6  0 overlay(d_p060:  4)
     d   d_p060_eann                 14    overlay(d_p060: 10)
     d   d_p060_gjef                 12    overlay(d_p060: 24)
     d   d_p060_gjff                  3    overlay(d_p060: 36)
     d   d_p060_gjet                 12    overlay(d_p060: 39)
     d   d_p060_gjft                  3    overlay(d_p060: 51)
     d   d_p060_tilf                 12    overlay(d_p060: 54)
     d   d_p060_tidf                  3    overlay(d_p060: 66)
     d   d_p060_tilt                 12    overlay(d_p060: 69)
     d   d_p060_tidt                  3    overlay(d_p060: 81)
     d   d_p060_tlbf                 12    overlay(d_p060: 84)
     d   d_p060_tldf                  3    overlay(d_p060: 96)
     d   d_p060_tlbt                 12    overlay(d_p060: 99)
     d   d_p060_tldt                  3    overlay(d_p060:111)
     d   d_p060_hbtd                  8    overlay(d_p060:114)
     d   d_p060_hben                  3    overlay(d_p060:122)
     d   d_p060_fdat                  8    overlay(d_p060:125)
     d   d_p060_fddf                  3    overlay(d_p060:133)
     d   d_p060_sdat                  8    overlay(d_p060:136)
     d   d_p060_sddf                  3    overlay(d_p060:144)
     d   d_p060_flev                  8    overlay(d_p060:147)
     d   d_p060_fldf                  3    overlay(d_p060:155)
     d   d_p060_slev                  8    overlay(d_p060:158)
     d   d_p060_sldf                  3    overlay(d_p060:166)
     d   d_p060_phen                 13    overlay(d_p060:169)
      *
      *  Posttype 062 - Varekatalog Hovedlinje Del 5A
     d                 ds
     d  d_p062                      373
     d   d_p062_type                  3    overlay(d_p062:  1) inz('062')
     d   d_p062_lnum                  6  0 overlay(d_p062:  4)
     d   d_p062_eann                 14    overlay(d_p062: 10)
     d   d_p062_vdk1                 70    overlay(d_p062: 24)
     d   d_p062_vdk2                 70    overlay(d_p062: 94)
     d   d_p062_vdk3                 70    overlay(d_p062:164)
     d   d_p062_vdk4                 70    overlay(d_p062:234)
     d   d_p062_vdk5                 70    overlay(d_p062:304)
      *
      *  Posttype 065 - Varekatalog Hovedlinje Del 5b
     d                 ds
     d  d_p065                      266
     d   d_p065_type                  3    overlay(d_p065:  1) inz('065')
     d   d_p065_lnum                  6  0 overlay(d_p065:  4)
     d   d_p065_eann                 14    overlay(d_p065: 10)
     d   d_p065_mvas                  4  2 overlay(d_p065: 24)
     d   d_p065_mvak                  3    overlay(d_p065: 28)
     d   d_p065_skd1                  3    overlay(d_p065: 31)
     d   d_p065_skt1                 35    overlay(d_p065: 34)
     d   d_p065_avg1                  9  3 overlay(d_p065: 69)
     d   d_p065_grl1                  3    overlay(d_p065: 78)
     d   d_p065_skd2                  3    overlay(d_p065: 81)
     d   d_p065_skt2                 35    overlay(d_p065: 84)
     d   d_p065_avg2                  9  3 overlay(d_p065:119)
     d   d_p065_grl2                  3    overlay(d_p065:128)
     d   d_p065_skd3                  3    overlay(d_p065:131)
     d   d_p065_skt3                 35    overlay(d_p065:134)
     d   d_p065_avg3                  9  3 overlay(d_p065:169)
     d   d_p065_grl3                  3    overlay(d_p065:178)
     d   d_p065_skd4                  3    overlay(d_p065:181)
     d   d_p065_skt4                 35    overlay(d_p065:184)
     d   d_p065_avg4                  9  3 overlay(d_p065:219)
     d   d_p065_grl4                  3    overlay(d_p065:228)
     d   d_p065_bpri                  8  2 overlay(d_p065:231)
     d   d_p065_npri                  8  2 overlay(d_p065:239)
     d   d_p065_epri                  9  3 overlay(d_p065:247)
     d   d_p065_penh                  3    overlay(d_p065:256)
     d   d_p065_upri                  8  2 overlay(d_p065:259)
      *
      *  Posttype 070 - Varekatalog Hovedlinje Del 6, Rabatt
     d                 ds
     d  d_p070                       80
     d   d_p070_type                  3    overlay(d_p070:  1) inz('070')
     d   d_p070_lnum                  6  0 overlay(d_p070:  4)
     d   d_p070_eann                 14    overlay(d_p070: 10)
     d   d_p070_rab1                  3    overlay(d_p070: 24)
     d   d_p070_ragn                  6    overlay(d_p070: 27)
     d   d_p070_rakd                  6    overlay(d_p070: 33)
     d   d_p070_ksek                  3    overlay(d_p070: 36)
     d   d_p070_ratp                  3    overlay(d_p070: 39)
     d   d_p070_kvrb                  8  2 overlay(d_p070: 42)
     d   d_p070_kvf1                  3    overlay(d_p070: 50)
     d   d_p070_rapr                  5  2 overlay(d_p070: 53)
     d   d_p070_kvf2                  3    overlay(d_p070: 58)
     d   d_p070_rab2                  8  2 overlay(d_p070: 61)
     d   d_p070_kvfr                  6    overlay(d_p070: 69)
     d   d_p070_kvti                  6    overlay(d_p070: 75)
      *
      *  Posttype 080 - Varekatalog Hovedlinje Del 7
     d                 ds
     d  d_p080                      183
     d   d_p080_type                  3    overlay(d_p080:  1) inz('080')
     d   d_p080_lnum                  6  0 overlay(d_p080:  4)
     d   d_p080_eann                 14    overlay(d_p080: 10)
     d   d_p080_mean                  3    overlay(d_p080: 24)
     d   d_p080_e128                  3    overlay(d_p080: 27)
     d   d_p080_mpri                  3    overlay(d_p080: 30)
     d   d_p080_minn                  3    overlay(d_p080: 33)
     d   d_p080_tpak                  7    overlay(d_p080: 36)
     d   d_p080_remb                  3    overlay(d_p080: 43)
     d   d_p080_lenh                  3    overlay(d_p080: 46)
     d   d_p080_voen                  3    overlay(d_p080: 49)
     d   d_p080_veen                  3    overlay(d_p080: 52)
     d   d_p080_leng                  9  3 overlay(d_p080: 55)
     d   d_p080_mno1                  3    overlay(d_p080: 64)
     d   d_p080_bred                  9  3 overlay(d_p080: 67)
     d   d_p080_mno2                  3    overlay(d_p080: 76)
     d   d_p080_hoyd                  9  3 overlay(d_p080: 79)
     d   d_p080_mno3                  3    overlay(d_p080: 88)
     d   d_p080_bvkt                  9  3 overlay(d_p080: 91)
     d   d_p080_bvfr                  9  3 overlay(d_p080:100)
     d   d_p080_bvti                  9  3 overlay(d_p080:109)
     d   d_p080_bvtt                  9  3 overlay(d_p080:118)
     d   d_p080_mno4                  3    overlay(d_p080:127)
     d   d_p080_bvol                 12  4 overlay(d_p080:130)
     d   d_p080_mno5                  3    overlay(d_p080:142)
     d   d_p080_fbre                  6  0 overlay(d_p080:145)
     d   d_p080_fdyb                  6  0 overlay(d_p080:151)
     d   d_p080_fhoy                  6  0 overlay(d_p080:157)
     d   d_p080_mno6                  3    overlay(d_p080:163)
     d   d_p080_enhf                  3    overlay(d_p080:166)
     d   d_p080_mxvk                  9  3 overlay(d_p080:169)
     d   d_p080_enmx                  3    overlay(d_p080:178)
     d   d_p080_mno7                  3    overlay(d_p080:181)
      *
      *  Posttype 090 - Vare Underlinje inkl. innhold mixpalle
     d                 ds
     d  d_p090                       55
     d   d_p090_type                  3    overlay(d_p090:  1) inz('090')
     d   d_p090_lnum                  6  0 overlay(d_p090:  4)
     d   d_p090_eann                 14    overlay(d_p090: 10)
     d   d_p090_ulnr                  6  0 overlay(d_p090: 24)
     d   d_p090_fkod                  3    overlay(d_p090: 30)
     d   d_p090_eanu                 14    overlay(d_p090: 33)
     d   d_p090_vtpn                  3    overlay(d_p090: 47)
     d   d_p090_pakn                  6  0 overlay(d_p090: 50)
      *
      *  Posttype 900 - Varekatalog Hale
     d                 ds
     d  d_p900                       19
     d   d_p900_type                  3    overlay(d_p900:  1) inz('900')
     d   d_p900_alin                  8  0 overlay(d_p900:  4)
     d   d_p900_arec                  8  0 overlay(d_p900: 12)
      *
      *  Posttype 999 - Slutt Forsendelse
     d                 ds
     d  d_p999                       19
     d   d_p999_type                  3    overlay(d_p999:  1) inz('999')
     d   d_p999_amld                  8  0 overlay(d_p999:  4)
     d   d_p999_atot                  8  0 overlay(d_p999: 12)
      *
      * Definering av parametre
      *
     d p_vsor          s             10
     d p_sval          s              1  0
     d p_tval          s              1  0
     d p_2val          s              1  0
     d p_bval          s              1  0
      *
     d p_firm          s                   like(vvfirm)
     d p_kund          s                   like(rkkund)
     d p_kpro          s                   like(flkpro)
     d p_ogrp          s                   like(vvogrp)
     d p_hgrp          s                   like(vvhgrp)
     d p_ugrp          s                   like(vvugrp)
     d p_ldor          s                   like(vvldor)
     d p_rfmt          s                   like(fhrfmt)
     d p_endr          s                   like(fhendr)
     d p_dat2          s                   like(fhdato)
     d p_lety          s                   like(fhlety)
     d p_dato          s                   like(fhdato)
     d p_ftis          s                   like(fhftis)
      *
     d p_stat          s              1
     d p_ekod          s              1
     d p_etxt          s             30
     d p_mvad          s               d   datfmt(*iso)
     d p_mvap          s              6  2
     d p_mvat          s              5  4
     d p_mvaf          s             10  9
      *
      * Definering av variabler i nøkler
      *
     d rkunl1_kund     s                   like(rkkund)
     d fkprl1_kund     s                   like(flkund)
     d fkprl1_kpro     s                   like(flkpro)
     d vvarl9_ogrp     s                   like(vvogrp)
     d vvarl9_hgrp     s                   like(vvhgrp)
     d vvarl9_ugrp     s                   like(vvugrp)
     d vvarl9_ldor     s                   like(vvldor)
     d vvenl3_vare     s                   like(vevare)
     d vvenl3_pben     s                   like(vepben)
     d vvenl2_vare     s                   like(vevare)
     d vvenl2_saen     s                   like(vesaen)
     d vvenl1_vare     s                   like(vevare)
     d vvenl1_enhe     s                   like(veenhe)
     d vugrl1_uogr     s                   like(vguogr)
     d vugrl1_uhgr     s                   like(vguhgr)
     d vugrl1_uugr     s                   like(vguugr)
     d vpkol1_pkod     s                   like(vapkod)
     d rlevl1_levr     s                   like(rllevr)
     d fkdilu_kund     s                   like(fhkund)
     d fkdilu_kpro     s                   like(fhkpro)
      *
      * Definering av variable
      *
     d b_svgr          s              1
     d b_sldo          s              1
     d b_stek          s              1
     d b_init          s              1    inz(*off)
6.21 d b_inlr          s              1    inz(*off)
      *
     d w_dato_ymd      s              6  0
     d w_dato_iso0     s              8  0
     d w_dato_alf      s              8
     d w_belo_alf      s              9
     d w_mdat_iso      s               d   datfmt(*iso)
     d w_mdat_alf      s              8
     d w_mtim          s              6  0
     d w_mtim_alf      s              6
     d w_raba_alf      s              5
     d w_omre_alf      s             12
     d w_ogrp_alf      s              2
     d w_hgrp_alf      s              2
     d w_ugrp_alf      s              3
     d w_raba          s              5  2
     d w_vare_1        s              1
6.11 d w_eanx          s             14
     d x               s              1  0
     d w_lnum          s              6  0
     d w_alin          s              8  0
     d w_arec          s              8  0
     d w_amld          s              8  0
     d w_atot          s              8  0
     d w_ix            s              1  0
     d w_ix_m          s              1  0
     d w_unum          s              6  0
6.11 d w_east          s              1
6.11 d w_eann          s             14  0
      *
     d w_firm          s                   like(vvfirm)
     d w_enh1          s                   like(veenhe)
     d w_enh2          s                   like(veenhe)
     d w_enh3          s                   like(veenhe)
     d w_enhe          s                   like(veenhe)
     d w_omr1          s                   like(veomre)
     d w_omr2          s                   like(veomre)
     d w_omr3          s                   like(veomre)
     d w_gvar          s                   like(vvvare)
     d w_ptxt          s                   like(vaptxt)
     d w_fnav          s                   like(aafnav)
     d w_tek1          s                   like(aafnav)
     d w_tek2          s                   like(aafnav)
     d w_utxt          s                   like(vgutxt)
     d w_ogrp_gml      s                   like(vvogrp)
     d w_hgrp_gml      s                   like(vvhgrp)
     d w_ugrp_gml      s                   like(vvugrp)
     d w_vare_gml      s                   like(vvvare)
     d w_sapr          s                   like(vpsapr)
     d w_s1pr          s                   like(vpsapr)
     d w_ntpr          s                   like(vpsapr)
     d w_n1pr          s                   like(vpsapr)
     d w_n2pr          s                   like(vpsapr)
     d w_n3pr          s                   like(vpsapr)
8.01 d w_prgr          s              2
5.70 d w_lage          s              2  0
6.21 d w_vtyp          s                   like(vvvtyp)
6.21 d w_ldor          s                   like(vvldor)
6.21 d w_udat          s                   like(vvudat)
6.31 d w_lv_nobb       s                   like(vvlnob)
6.31 d w_lv_modn       s                   like(vvlmod)
6.31 d w_lv_lldo       s                   like(vvlnle)
6.31 d w_lv_llva       s                   like(vvllva)
      *
5.70 d                uds
6.19 d l_user                911    920
5.70 d l_lage               1001   1002  0
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Henter firmaopplysninger
      *
     c     afirl1_key    chain     afirl1r                            90
      *
      * Oppretter variabel med firmanavn hvor Ææ, Øø og Åå er oversatt til
      * ANSI-verdier
      *
     c                   eval      w_fnav = aafnav
      *
     c     'Æ':X'46'     xlate     w_fnav        w_fnav
     c     'æ':X'A0'     xlate     w_fnav        w_fnav
     c     'Ø':X'77'     xlate     w_fnav        w_fnav
     c     'ø':X'90'     xlate     w_fnav        w_fnav
     c     'Å':X'2A'     xlate     w_fnav        w_fnav
     c     'å':X'EF'     xlate     w_fnav        w_fnav
      *
      * Henter OFAK informasjon
      *
     c     fstsl1_key    chain     fstsl1                             90
      *
     c     raa8l1_key    chain     raa8l1                             90
      *
      * Henter kundeinformasjon
      *
     c                   eval      rkunl1_kund = p_kund
     c     rkunl1_key    chain     rkunl1                             90
      *
      * Behandling avhengig av vareutplukk utplukksvalg
      *
     c                   select
     c                   when      p_ogrp <> 0
     c                   exsr      behandl_vgrp
     c                   when      p_ldor <> 0
     c                   exsr      behandl_ldor
     c                   when      p_vsor <> *blank
     c                   exsr      behandl_vsor
     c                   other
     c                   exsr      behandl_tot
     c                   endsl
      *
      * Posttype 900 - Varekatalog Hale - slutt melding
      *
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      d_p900_alin = w_alin
     c                   eval      d_p900_arec = w_arec
     c                   eval      pr_rad = d_p900
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
      *
      * Posttype 999 - Slutt forsendelse
      *
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      d_p999_amld = w_amld
     c                   eval      d_p999_atot = w_atot
     c                   eval      pr_rad = d_p999
     c                   write     fiprpfr
      *
      * Oppdaterer kunde distribusjonsliste med prisdato siste forsendelse
      * og unik nøkkel (timestamp) for forsendelsen.
      *
     c                   eval      fkdilu_kund = p_kund
     c                   eval      fkdilu_kpro = p_kpro
     c     fkdilu_key    chain     fkdilur                            92
     c                   if        *in92 = *off
     c                   eval      fhdato = p_dato
     c                   eval      fhftis = p_ftis
6.10 c                   time                    fhedat
6.10 c                   time                    fhetim
6.10 c                   eval      fheusr = l_user
     c                   update    fkdilur
     c                   endif
      *
      * Avslutt
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av utplukk på varegruppe og leverandør
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandl_vgrp  begsr
      *
      * Posisjonerer og leser i vareregister i.h.t. utplukk
      *
     c                   eval      vvarl9_ogrp = p_ogrp
     c                   eval      vvarl9_hgrp = p_hgrp
     c                   eval      vvarl9_ugrp = p_ugrp
     c                   eval      vvarl9_ldor = p_ldor
      *
     c                   select
     c                   when      p_ldor <> 0
     c     vvarl9_key1   setll     vvarl9
     c     vvarl9_key1   reade     vvarl9                                 90
     c                   when      p_ugrp <> 0
     c     vvarl9_key2   setll     vvarl9
     c     vvarl9_key2   reade     vvarl9                                 90
     c                   when      p_hgrp <> 0
     c     vvarl9_key3   setll     vvarl9
     c     vvarl9_key3   reade     vvarl9                                 90
     c                   other
     c     vvarl9_key4   setll     vvarl9
     c     vvarl9_key4   reade     vvarl9                                 90
     c                   endsl
      *
     c                   dow       *in90 = *off
      *
     c                   exsr      behandling
      *
     c                   select
     c                   when      p_ldor <> 0
     c     vvarl9_key1   reade     vvarl9                                 90
     c                   when      p_ugrp <> 0
     c     vvarl9_key2   reade     vvarl9                                 90
     c                   when      p_hgrp <> 0
     c     vvarl9_key3   reade     vvarl9                                 90
     c                   other
     c     vvarl9_key4   reade     vvarl9                                 90
     c                   endsl
      *
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av utplukk på leverandør
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandl_ldor  begsr
      *
      * Leser hele vareregisteret, og plukker varer tilhørende leverandør
      *
     c     vvarl9_key5   setll     vvarl9
     c     vvarl9_key5   reade     vvarl9                                 90
      *
     c                   dow       *in90 = *off
      *
     c                   if        vvldor <> p_ldor
     c                   goto      les_neste
     c                   endif
      *
     c                   exsr      behandling
      *
     c     les_neste     tag
      *
     c     vvarl9_key5   reade     vvarl9                                 90
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av utplukk på varesortiment
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandl_vsor  begsr
      *
      * Kaller utplukksprogram
      *
     c                   eval      b_svgr = *on
     c                   eval      b_sldo = *off
     c                   eval      b_stek = *on
      *
     c                   call      'VD700R'
     c                   parm                    w_firm
     c                   parm                    p_vsor
     c                   parm                    b_svgr
     c                   parm                    b_sldo
     c                   parm                    b_stek
      *
      * Leser utplukksfil som inneholder alle varer i sortimentet
      *
     c                   eval      w_vare_gml = *blank
      *
     c                   read      vvawpf                                 90
     c                   dow       *in90 = *off
      *
     c                   if        vvvare <> w_vare_gml
     c                   exsr      behandling
     c                   endif
      *
     c                   eval      w_vare_gml = vvvare
      *
     c                   read      vvawpf                                 90
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av utplukk på hele vareregisteret
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandl_tot   begsr
      *
     c     vvarl9_key5   setll     vvarl9
     c     vvarl9_key5   reade     vvarl9                                 90
      *
     c                   dow       *in90 = *off
      *
     c                   exsr      behandling
      *
     c     vvarl9_key5   reade     vvarl9                                 90
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for utskrift av vareinformasjon til prisfil
      * Rutinen styrer utskrift til forskjellige pris-recordformat
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandling    begsr
      *
      * Siling av varer.
      * Diversevarer utelates
      * Skaffevarer skal kun være med dersom dette er valgt.
      * Varer som er merket 'ikke prisdistribusjon' skal alltid utelates.
      *
5.70 c                   call      'VL710R'
5.70 c                   parm                    w_firm
5.70 c                   parm                    vvvare
5.70 c                   parm                    w_lage
6.21 c                   parm                    w_vtyp
6.21 c                   parm                    w_udat
6.21 c                   parm                    w_ldor
6.21 c                   parm                    b_inlr
6.31 c                   parm                    w_lv_nobb
6.31 c                   parm                    w_lv_modn
6.31 c                   parm                    w_lv_lldo
6.31 c                   parm                    w_lv_llva
      *
6.21 c                   if        w_vtyp = 'D'
     c                   goto      end_behandl
     c                   endif
      *
     c                   if        p_sval = 0 and
6.21 c                             w_vtyp = 'S'
     c                   goto      end_behandl
     c                   endif
      *
     c                   if        vvkpdi = 1
     c                   goto      end_behandl
     c                   endif
      *
      * Behandling dersom 'kun endringer' er valgt
      * Behandler kun varer hvor prisendringsdato er >= dato for forrige
      * kjøring.
      *
     c***                if        p_endr = 1 and
     c***                          p_dat2 <> *loval
     c***                if        vvspda < p_dat2
     c***                goto      end_behandl
     c***                endif
     c***                endif
      *
      * Henter enheter fra vare
      *
     c                   exsr      enheter
      *
      * Henter informasjon fra basisenhet
      *
     c                   eval      vvenl1_vare = vvvare
     c                   eval      vvenl1_enhe = vvenhe
     c     vvenl1_key    chain     vvenl1
      *
      * Henter undergruppetekst ved brudd på hovedgruppe/undergruppe
      *
     c                   if        vvogrp <> w_ogrp_gml or
     c                             vvhgrp <> w_hgrp_gml or
     c                             vvugrp <> w_ugrp_gml
      *
     c                   eval      w_utxt = *blank
      *
     c                   eval      vugrl1_uogr = vvogrp
     c                   eval      vugrl1_uhgr = vvhgrp
     c                   eval      vugrl1_uugr = vvugrp
     c     vugrl1_key    chain     vugrl1                             92
     c                   if        *in92 = *off
     c                   eval      w_utxt = vgutxt
     c                   endif
      *
     c                   eval      w_ogrp_gml = vvogrp
     c                   eval      w_hgrp_gml = vvhgrp
     c                   eval      w_ugrp_gml = vvugrp
      *
     c                   endif
      *
      * Initiering av param til prisberegningsprogram
      *
     c                   eval      hifirm = p_firm
     c                   eval      hirkat = 0
     c                   eval      hikund = p_kund
     c                   eval      hikpro = p_kpro
     c                   eval      hivare = vvvare
     c                   eval      hilety = p_lety
     c                   eval      hienhe = *blank
     c                   eval      hidato = p_dato
     c                   eval      hitime = *loval
5.70 c                   eval      hiprgr = w_prgr
     c                   eval      hinumm = 0
     c                   eval      hikode = *blank
     c                   eval      hidekn = 0
     c                   eval      hitilb = *off
     c                   eval      hiavgf = 0
     c                   eval      hipriv = 0
     c                   eval      hiskaf = *off
     c                   eval      hildor = 0
     c                   eval      hisapr = 0
     c                   eval      hikopr = 0
     c                   eval      hiinlr = *on
      *
     c                   if        p_tval = 0
     c                   eval      hitilb = *on
     c                   endif
      *
      * Skriver til prisfil i EDIFACT PRICAT-format
      *
     c                   if        b_init = *off
     c                   exsr      skriv_init
     c                   else
     c                   eval      d_p038_pgrp = '2  '
     c                   eval      d_p038_levn = ''
     c                   eval      d_p038_lnav = ''
     c                   eval      d_p038_epdn = ''
     c                   eval      pr_rad = d_p038
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
     c                   endif
      *
     c                   eval      w_tek1 = vvtek1
     c     'Æ':X'46'     xlate     w_tek1        w_tek1
     c     'æ':X'A0'     xlate     w_tek1        w_tek1
     c     'Ø':X'77'     xlate     w_tek1        w_tek1
     c     'ø':X'90'     xlate     w_tek1        w_tek1
     c     'Å':X'2A'     xlate     w_tek1        w_tek1
     c     'å':X'EF'     xlate     w_tek1        w_tek1
      *
     c                   eval      w_tek2 = vvtek2
     c     'Æ':X'46'     xlate     w_tek2        w_tek2
     c     'æ':X'A0'     xlate     w_tek2        w_tek2
     c     'Ø':X'77'     xlate     w_tek2        w_tek2
     c     'ø':X'90'     xlate     w_tek2        w_tek2
     c     'Å':X'2A'     xlate     w_tek2        w_tek2
     c     'å':X'EF'     xlate     w_tek2        w_tek2
      *
      * Posttype 040 - Varekatalog Hovedlinje Del 1
      *
     c                   eval      w_lnum = w_lnum + 1
     c                   eval      d_p040_lnum = w_lnum
     c                   eval      d_p040_psta = ''
6.11  *
6.11  * Kaller program for henting av ean-nr
6.11  *
6.11 c                   call      'VE711R'
6.11 c                   parm                    w_firm
6.11 c                   parm                    vvvare
6.11 c                   parm                    vvenhe
6.11 c                   parm                    w_eann
6.11 c                   parm                    w_east
     c                   move      w_eann        w_eanx
     c                   if        w_east = '1'
     c                   eval      d_p040_eann = w_eanx
     c                   eval      d_p040_vnrt = 'EN '
     c                   else
     c                   eval      d_p040_eann = ''
     c                   eval      d_p040_vnrt = ''
     c                   endif
      *
     c*                 eval      d_p040_lvnr = vvlvar
6.31 c                   if        w_lv_nobb > 0
6.31 c                   movel     w_lv_llva     d_p040_lvnr
6.31 c                   else
     c                   movel     vvlvar        d_p040_lvnr
6.31 c                   endif
     c                   eval      d_p040_epdn = ''
     c                   eval      d_p040_vgrp = ''
     c                   eval      d_p040_vgdv = ''
     c                   eval      d_p040_vmnr = ''
     c                   eval      d_p040_pvar = ''
     c                   eval      d_p040_skod = ''
     c                   eval      d_p040_erid = ''
     c                   eval      d_p040_vntp = ''
     c                   eval      d_p040_nvid = ''
     c                   eval      d_p040_vnt2 = ''
     c                   eval      d_p040_erst = ''
     c                   eval      d_p040_vnt3 = ''
     c                   eval      d_p040_vtxt = w_tek1
     c                   eval      d_p040_sthh = ''
     c                   eval      d_p040_htxt = w_tek1
     c                   eval      d_p040_btxt = w_tek1
      *
     c                   eval      pr_rad = d_p040
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 045 - Varekatalog Hovedlinje Del 2
      *
     c                   eval      d_p045_lnum = d_p040_lnum
     c                   eval      d_p045_eann = d_p040_eann
      *
     c                   eval      d_p045_uenh = ''
     c                   eval      d_p045_mmrk = ''
     c                   eval      d_p045_gmod = ''
     c                   eval      d_p045_okol = ''
     c                   eval      d_p045_dmmy = ''
     c                   eval      d_p045_vmrk = ''
     c                   eval      d_p045_sflt = ''
     c                   eval      d_p045_enht = 'TU'
     c                   eval      d_p045_ibba = ''
     c                   eval      d_p045_ptyp = ''
     c                   eval      d_p045_remb = ''
     c                   eval      d_p045_mixp = ''
     c                   eval      d_p045_peg1 = ''
     c                   eval      d_p045_peg2 = ''
      *
     c                   eval      pr_rad = d_p045
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 050 - Varekatalog Hovedlinje Del 3
      *
     c                   eval      d_p050_lnum = d_p040_lnum
     c                   eval      d_p050_eann = d_p040_eann
      *
     c                   eval      d_p050_tmin = 0
     c                   eval      d_p050_tmax = 0
     c                   eval      d_p050_tnoy = ''
     c                   eval      d_p050_ptyp = ''
     c                   eval      d_p050_lene = ''
     c                   eval      d_p050_vole = ''
     c                   eval      d_p050_veke = vvenhe
     c                   eval      d_p050_nvca = 0
     c                   eval      d_p050_nvfr = 0
     c                   eval      d_p050_nvti = 0
     c                   eval      d_p050_nvek = 0
     c                   eval      d_p050_nvol = 0
     c                   eval      d_p050_aprl = 0
     c                   eval      d_p050_lprp = 0
     c                   eval      d_p050_levs = 0
     c                   eval      d_p050_mibk = 0
     c                   eval      d_p050_mfan = 0
     c                   eval      d_p050_vupb = 0
     c                   eval      d_p050_tkva = 0
     c                   eval      d_p050_afpk = 0
     c                   eval      d_p050_adpk = 0
     c                   eval      d_p050_bonb = ''
     c                   eval      d_p050_kfak = 0
     c                   eval      d_p050_besk = ''
     c                   eval      d_p050_noy1 = ''
     c                   eval      d_p050_men1 = ''
     c                   eval      d_p050_pstr = 0
     c                   eval      d_p050_men2 = ''
     c                   eval      d_p050_noy2 = ''
      *
     c                   eval      pr_rad = d_p050
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 052 - Varekatalog Hovedlinje Del 3A
      *
     c                   eval      d_p052_lnum = d_p040_lnum
     c                   eval      d_p052_eann = d_p040_eann
      *
     c                   eval      d_p052_ninn = 0
     c                   eval      d_p052_besk = ''
     c                   eval      d_p052_noya = ''
     c                   eval      d_p052_menh = ''
      *
     c                   eval      pr_rad = d_p052
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 055 - Varekatalog Hovedlinje Del 4
      *
      * Index (w_ix) og maks repetisjoner (w_ix_m) - maks 5 iflg beskrivelse
      * - kjører kun en rep.initielt; sett w_ix_m ihht ønsket antall records
      *
     c                   eval      w_ix = 0
     c                   eval      w_ix_m = 1
      *
     c                   dow       w_ix < w_ix_m
     c                   eval      d_p055_lnum = d_p040_lnum
     c                   eval      d_p055_eann = d_p040_eann
      *
     c                   eval      d_p055_hkod = ''
     c                   eval      d_p055_inst = ''
     c                   eval      d_p055_fgod = ''
      *
     c                   eval      pr_rad = d_p055
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_ix = w_ix + 1
     c                   eval      w_alin  = w_alin  + 1
     c                   enddo
      *
      * Posttype 060 - Varekatalog Hovedlinje Del 5
      *
     c                   eval      d_p060_lnum = d_p040_lnum
     c                   eval      d_p060_eann = d_p040_eann
      *
     c                   eval      d_p060_gjef = d_p020_pfra
     c                   eval      d_p060_gjff = '203'
     c                   eval      d_p060_gjet = ''
     c                   eval      d_p060_gjft = ''
      *
     c                   eval      d_p060_tilf = d_p020_pfra
     c                   eval      d_p060_tidf = '203'
     c                   eval      d_p060_tilt = ''
     c                   eval      d_p060_tidt = ''
      *
     c                   eval      d_p060_tlbf = ''
     c                   eval      d_p060_tldf = ''
     c                   eval      d_p060_tlbt = ''
     c                   eval      d_p060_tldt = ''
      *
     c                   eval      d_p060_hbtd = ''
     c                   eval      d_p060_hben = ''
     c                   eval      d_p060_fdat = w_dato_alf
     c                   eval      d_p060_fddf = '102'
     c                   eval      d_p060_sdat = ''
     c                   eval      d_p060_sddf = ''
      *
     c                   eval      d_p060_flev = w_dato_alf
     c                   eval      d_p060_fldf = '102'
     c                   eval      d_p060_slev = ''
     c                   eval      d_p060_sldf = ''
     c                   eval      d_p060_phen = ''
      *
     c                   eval      pr_rad = d_p060
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 062 - Varekatalog Hovedlinje Del 5A
      *
     c                   eval      d_p062_lnum = d_p040_lnum
     c                   eval      d_p062_eann = d_p040_eann
      *
     c                   eval      d_p062_vdk1 = w_tek1 + w_tek2
     c                   eval      d_p062_vdk2 = ''
     c                   eval      d_p062_vdk3 = ''
     c                   eval      d_p062_vdk4 = ''
     c                   eval      d_p062_vdk5 = ''
      *
     c                   eval      pr_rad = d_p062
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 065 - Varekatalog Hovedlinje Del 5B
      *
     c                   eval      d_p065_lnum = d_p040_lnum
     c                   eval      d_p065_eann = d_p040_eann
      *
      * Kaller program i økonomisystemet / MVA-oppslag
      *
     c                   select
     c                   when      vvkmva = 1
     c                   eval      p_ekod = '4'
     c                   when      vvkmva = 2
     c                   eval      p_ekod = 'H'
     c                   other
     c                   eval      p_ekod = '3'
     c                   endsl
      *
     c                   eval      p_mvad = p_dato
      *
     c                   call      'RS755R'
     c                   parm                    p_stat
     c                   parm                    p_ekod
     c                   parm                    p_etxt
     c                   parm                    p_dato
     c                   parm                    p_mvap
     c                   parm                    p_mvat
     c                   parm                    p_mvaf
      *
     c                   eval      d_p065_mvas = p_mvap
     c                   if        p_mvap <> *zero
     c                   eval      d_p065_mvak = 'S'
     c                   else
     c                   eval      d_p065_mvak = 'E'
     c                   endif
      *
     c                   eval      d_p065_skd1 = ''
     c                   eval      d_p065_skt1 = ''
     c                   eval      d_p065_avg1 = 0
     c                   eval      d_p065_grl1 = ''
      *
     c                   eval      d_p065_skd2 = ''
     c                   eval      d_p065_skt2 = ''
     c                   eval      d_p065_avg2 = 0
     c                   eval      d_p065_grl2 = ''
      *
     c                   eval      d_p065_skd3 = ''
     c                   eval      d_p065_skt3 = ''
     c                   eval      d_p065_avg3 = 0
     c                   eval      d_p065_grl3 = ''
      *
     c                   eval      d_p065_skd4 = ''
     c                   eval      d_p065_skt4 = ''
     c                   eval      d_p065_avg4 = 0
     c                   eval      d_p065_grl4 = ''
      *
     c                   eval      hienhe = w_enh1
      *
     c                   call      'VP900R'
     c                   parm                    hirec
     c                   parm                    horec
      *
     c                   eval      d_p065_bpri = hosapr
      *
     c                   eval      w_ntpr = hosapr
     c                   if        horab1 > 0
     c                   eval(h)   w_ntpr = w_ntpr - (w_ntpr * horab1 / 100)
     c                   endif
     c                   if        horab2 > 0
     c                   eval(h)   w_ntpr = w_ntpr - (w_ntpr * horab2 / 100)
     c                   endif
     c*                  eval      d_p065_npri = w_ntpr
     c                   eval      d_p065_npri = 0
     c                   eval      d_p065_epri = 0
      *
     c                   eval      d_p065_penh  = w_enh1
     c                   eval      d_p065_upri = 0
      *
     c                   eval      pr_rad = d_p065
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 070 - Varekatalog Hovedlinje Del 6, Rabatt (ikke i bruk)
      *
     c                   eval      d_p070_lnum = d_p040_lnum
     c                   eval      d_p070_eann = d_p040_eann
      *
     c                   eval      d_p070_rab1 = ''
     c                   eval      d_p070_ragn = ''
     c                   eval      d_p070_rakd = ''
     c                   eval      d_p070_ksek = ''
     c                   eval      d_p070_ratp = ''
     c                   eval      d_p070_kvrb = 0
     c                   eval      d_p070_kvf1 = ''
     c                   eval      d_p070_kvf2 = ''
     c                   eval      d_p070_rab2 = 0
     c                   eval      d_p070_kvfr = ''
     c                   eval      d_p070_kvti = ''
      *
     c                   eval      pr_rad = d_p070
     c*                  write     fiprpfr
     c*                  eval      w_atot  = w_atot  + 1
     c*                  eval      w_arec  = w_arec  + 1
     c*                  eval      w_alin  = w_alin  + 1
      *
      * Posttype 080 - Varekatalog Hovedlinje Del 7
      *
     c                   eval      d_p080_lnum = d_p040_lnum
     c                   eval      d_p080_eann = d_p040_eann
      *
     c                   eval      d_p080_mean = ''
     c                   eval      d_p080_e128 = ''
     c                   eval      d_p080_mpri = ''
     c                   eval      d_p080_minn = ''
     c                   eval      d_p080_tpak = ''
     c                   eval      d_p080_remb = ''
     c                   eval      d_p080_lenh = ''
     c                   eval      d_p080_voen = ''
     c                   eval      d_p080_veen = ''
     c                   eval      d_p080_leng = veleng
     c                   eval      d_p080_mno1 = ''
     c                   eval      d_p080_bred = vebred
     c                   eval      d_p080_mno2 = ''
     c                   eval      d_p080_hoyd = vehoyd
     c                   eval      d_p080_mno3 = ''
     c                   eval      d_p080_bvkt = vevekt
     c                   eval      d_p080_bvfr = 0
     c                   eval      d_p080_bvti = 0
     c                   eval      d_p080_bvtt = 0
     c                   eval      d_p080_mno4 = ''
     c                   eval      d_p080_bvol = 0
     c                   eval      d_p080_mno5 = ''
     c                   eval      d_p080_fbre = 0
     c                   eval      d_p080_fdyb = 0
     c                   eval      d_p080_fhoy = 0
     c                   eval      d_p080_mno6 = ''
     c                   eval      d_p080_enhf = ''
     c                   eval      d_p080_mxvk = 0
     c                   eval      d_p080_enmx = ''
     c                   eval      d_p080_mno7 = ''
      *
     c                   eval      pr_rad = d_p080
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
      * Posttype 090 - Vare Underlinje
      *
      * Index (w_ix) og maks repetisjoner (w_ix_m) - maks ? (ikke besk)
      * - kjører ingen forekomster; sett w_ix_m ihht ønsket antall records
      *
     c                   eval      w_ix = 0
     c                   eval      w_ix_m = 0
     c                   eval      w_unum = 0
      *
     c                   dow       w_ix < w_ix_m
     c                   eval      w_unum = w_unum + 1
     c                   eval      d_p090_lnum = d_p040_lnum
     c                   eval      d_p090_eann = d_p040_eann
     c                   eval      d_p090_ulnr = w_unum
      *
     c                   eval      d_p090_fkod = ''
     c                   eval      d_p090_eanu = ''
     c                   eval      d_p090_vtpn = ''
     c                   eval      d_p090_pakn = 0
      *
     c                   eval      pr_rad = d_p090
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_ix = w_ix + 1
     c                   enddo
      *
     c     end_behandl   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for henting av enheter
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     enheter       begsr
      *
     c                   eval      w_enh1 = *blank
     c                   eval      w_enh2 = *blank
     c                   eval      w_enh3 = *blank
     c                   eval      w_omr1 = 0
     c                   eval      w_omr2 = 0
     c                   eval      w_omr3 = 0
      *
      * Leser prisbok-enheter på vare, og henter prisinformasjon
      *
     c                   eval      x = 0
      *
     c                   eval      vvenl3_vare = vvvare
     c                   eval      vvenl3_pben = 1
     c     vvenl3_key    setll     vvenl3
     c     vvenl3_key2   reade     vvenl3                                 92
     c                   dow       *in92 = *off and
     c                             x < 3
      *
     c                   eval      x = x + 1
      *
     c                   select
     c                   when      x = 1
     c                   eval      w_enh1 = veenhe
     c                   eval      w_omr1 = veomre
     c                   when      x = 2
     c                   eval      w_enh2 = veenhe
     c                   eval      w_omr2 = veomre
     c                   when      x = 3
     c                   eval      w_enh3 = veenhe
     c                   eval      w_omr3 = veomre
     c                   endsl
      *
     c     vvenl3_key2   reade     vvenl3                                 92
     c                   enddo
      *
      * Dersom prisbokenheter ikke ble funnet, eller dersom priser ikke
      * ble funnet på prisbokenheter, hentes priser på salgsenheter
      *
     c                   if        x = 0
      *
     c                   eval      vvenl2_vare = vvvare
     c                   eval      vvenl2_saen = 1
     c     vvenl2_key    setll     vvenl2
     c     vvenl2_key2   reade     vvenl2                                 92
     c                   dow       *in92 = *off and
     c                             x < 3
      *
     c                   eval      x = x + 1
      *
     c                   select
     c                   when      x = 1
     c                   eval      w_enh1 = veenhe
     c                   eval      w_omr1 = veomre
     c                   when      x = 2
     c                   eval      w_enh2 = veenhe
     c                   eval      w_omr2 = veomre
     c                   when      x = 3
     c                   eval      w_enh3 = veenhe
     c                   eval      w_omr3 = veomre
     c                   endsl
      *
     c     vvenl2_key2   reade     vvenl2                                 92
     c                   enddo
      *
     c                   endif
      *
      * Finner omregningsfaktorer
      *
     c                   if        w_omr1 <> 0
     c                   eval      w_omr2 = w_omr2 / w_omr1
     c                   eval      w_omr3 = w_omr3 / w_omr1
     c                   endif
      *
     c     enhienheter   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for skriving av initielle posttyper
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     skriv_init    begsr
      *
      * Posttype FMS - Start forsendelse
      *
     c                   eval      d_pfms_avid = ''
     c                   eval      d_pfms_beha = ''
      *
     c                   eval      pr_rad = d_pfms
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
      *
      * Posttype 00F - Start melding
      *
     c                   eval      d_p00F_avse = ra8ean
     c                   eval      d_p00F_mott = rkeank
     c                   eval      d_p00F_dato = 0
     c                   eval      d_p00F_time = 0
     c                   eval      d_p00F_fonr = ''
     c                   eval      d_p00F_kind = ''
     c                   eval      d_p00F_tind = ''
      *
     c                   eval      pr_rad = d_p00F
     c                   write     fiprpfr
     c                   eval      w_amld  = w_amld  + 1
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
      *
      * Posttype 020 - Varekatalog Hode Del 1
      *
     c                   eval      d_p020_pknr = p_vsor
     c                   eval      d_p020_mfun = ''
      *
     c                   time                    w_mdat_iso
     c     *iso0         move      w_mdat_iso    w_mdat_alf
     c                   time                    w_mtim
     c                   move      w_mtim        w_mtim_alf
     c                   eval      d_p020_mdat = w_mdat_alf +
     c                                           %subst(w_mtim_alf:1:4)
     c                   eval      d_p020_pfra = w_dato_alf + '0000'
     c                   eval      d_p020_ptil = ''
     c                   eval      d_p020_vdat = ''
     c                   eval      d_p020_kref = ''
     c                   eval      d_p020_kdat = ''
     c                   eval      d_p020_pref = ''
     c                   eval      d_p020_pdat = ''
     c                   eval      d_p020_kjop = ''
     c                   move      ra8ean        d_p020_levr
      *
     c                   if        aamvap <> 0
     c                   eval      d_p020_mvap = 'VA'
     c                   else
     c                   eval      d_p020_mvap = 'GN'
     c                   endif
      *
     c                   eval      d_p020_orst = ''
     c                   eval      d_p020_kinf = ''
     c                   eval      d_p020_knum = ''
     c                   eval      d_p020_ktyp = ''
      *
     c                   eval      pr_rad = d_p020
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
      *
      * Posttype 030 - Varekatalog Hode Del 2 (p.t. ikke i bruk)
      *
     c*                  eval      d_p030_valt = ''
     c*                  eval      d_p030_vbet = ''
     c*                  eval      d_p030_vkur = 0
     c*                  eval      d_p030_kdat = ''
     c*                  eval      d_p030_bbet = 0
     c*                  eval      d_p030_rabs = 0
      *
     c*                  eval      pr_rad = d_p030
     c*                  write     fiprpfr
     c*                  eval      w_atot  = w_atot  + 1
     c*                  eval      w_arec  = w_arec  + 1
      *
      * Posttype 036 - Varekatalog Gruppedel
      *
     c                   eval      d_p036_lbet = 'EXW'
     c                   eval      d_p036_hste = ''
      *
     c                   eval      pr_rad = d_p036
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
      *
      * Posttype 038 - Varekatalog Hovedlinje (lev.info - spes. 1.linje)
      *
     c                   eval      d_p038_pgrp = '5  '
6.11 c                   move      rkeank        w_eanx
6.11 c                   eval      d_p038_levn = w_eanx
     c                   eval      d_p038_lnav = w_fnav
     c                   eval      d_p038_epdn = ''
      *
     c                   eval      pr_rad = d_p038
     c                   write     fiprpfr
     c                   eval      w_atot  = w_atot  + 1
     c                   eval      w_arec  = w_arec  + 1
     c                   eval      w_alin  = w_alin  + 1
      *
     c                   eval      b_init = *on
     c                   eval      w_lnum = *zero
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_kund
     c                   parm                    p_kpro
     c                   parm                    p_vsor
     c                   parm                    p_ogrp
     c                   parm                    p_hgrp
     c                   parm                    p_ugrp
     c                   parm                    p_ldor
     c                   parm                    p_rfmt
     c                   parm                    p_endr
     c                   parm                    p_dat2
     c                   parm                    p_sval
     c                   parm                    p_tval
     c                   parm                    p_2val
     c                   parm                    p_bval
     c                   parm                    p_lety
     c                   parm                    p_dato
     c                   parm                    p_ftis
      *
      * Key for oppslag på ofak-koderegister (statuskoder)
      *
     c     fstsl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for oppslag på kunderegister
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Key for oppslag på kundeprosjekt
      *
     c     fkprl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fkprl1_kund
     c                   kfld                    fkprl1_kpro
      *
      * Key for les på vareregister
      *
     c     vvarl9_key1   klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl9_ogrp
     c                   kfld                    vvarl9_hgrp
     c                   kfld                    vvarl9_ugrp
     c                   kfld                    vvarl9_ldor
      *
     c     vvarl9_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl9_ogrp
     c                   kfld                    vvarl9_hgrp
     c                   kfld                    vvarl9_ugrp
      *
     c     vvarl9_key3   klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl9_ogrp
     c                   kfld                    vvarl9_hgrp
      *
     c     vvarl9_key4   klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl9_ogrp
      *
     c     vvarl9_key5   klist
     c                   kfld                    w_firm
      *
      * Key for oppslag på vare-enhet
      *
     c     vvenl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl1_vare
     c                   kfld                    vvenl1_enhe
      *
      * Key for les på vare-enhet-register m/prisbok-enhet
      *
     c     vvenl3_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl3_vare
     c                   kfld                    vvenl3_pben
      *
     c     vvenl3_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl3_vare
      *
      * Key for les på vare-enhet-register m/salgsenhet
      *
     c     vvenl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl2_vare
     c                   kfld                    vvenl2_saen
      *
     c     vvenl2_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl2_vare
      *
      * Key for oppslag på undergruppe-register
      *
     c     vugrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vugrl1_uogr
     c                   kfld                    vugrl1_uhgr
     c                   kfld                    vugrl1_uugr
      *
      * Key for oppslag på priskode-register
      *
     c     vpkol1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vpkol1_pkod
      *
      * Key for oppslag på leverandør-register
      *
     c     rlevl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevl1_levr
      *
      * Key for oppdatering av kunde-distribusjonsliste
      *
     c     fkdilu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fkdilu_kund
     c                   kfld                    fkdilu_kpro
      *
      * Key for oppslag på firmaregister
      *
     c     afirl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for les på firma
      *
     c     raa8l1_key    klist
     c                   kfld                    w_firm
      *
      *
      * Splitter datastruktur i variable
      *
     c                   eval      w_firm = p_firm
      *
     c     *ymd          move      p_dato        w_dato_ymd
     c     *iso0         move      p_dato        w_dato_alf
     c                   move      w_dato_alf    w_dato_iso0
5.70  *
5.70  * Henter prisgruppe
5.70  *
5.70 c                   call      'VL711R   '
5.70 c                   parm                    w_prgr
5.70  *
5.70 c                   eval      w_lage = l_lage
      *
     c                   endsr
