     H datedit(*dmy.) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON
      * Program . . . . : RL974R
      * Beskrivelse . . : Oppdaterer passive
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       311202 KOB  Nytt program
      * V540  220805 KOB  Korrigert test nydato
6.10  * V6.10 230909 BSA  Lagt inn sporingsfelter
6.11  * V6.10 070510 BSA  Endret i sporingsfelter
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     frlevlu    uf   e           k disk    rename(rlevpfr:rlevlur)
      *
      * Definering av Local data area
      *
     d                uds
     d rpfirm                300    310  0
     d rprdat                          d   datfmt(*iso)
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_dato                          d   datfmt(*iso)
     d w_ndat                          d   datfmt(*iso)
      *
      * Definering av variable
      *
     d w_firm          s                   like(rlfirm)
      *
      * Les kunderegister
      *
     c     rlevlu_key    setll     rlevlu                                 90
     c     rlevlu_key    reade     rlevlu                                 90
     c                   dow       *in90 = *off
      *
      * Kontroll om saldo <> 0
      *
     c                   if        rlsald <> 0
     c                   goto      neste
     c                   endif
      *
      * Kontroll mot: Siste trans.dato og ny dato
      *
     c                   if        rprdat > rltdat and
     c                             w_ndat > rlndat
     c                   eval      rlpass = 'J'
6.10 c*                  time                    rledat
6.10 c*                  time                    rletim
6.10 c*                  eval      rlesig = l_user
6.11 c                   time                    rl2dpt
6.11 c                   eval      rlepgm = 'RL975R    '
     c                   update    rlevlur
     c                   endif
      *
     c     neste         tag
      *
     c     rlevlu_key    reade     rlevlu                                 90
     c                   enddo
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c                   eval      w_firm = l_firm
      *
      * Beregn dato for kontroll mot nydato
      *
     c                   time                    w_dato
     C     w_dato        subdur    1 : *y        w_ndat
      *
     c     rlevlu_key    klist
     c                   kfld                    w_firm
      *
     c                   endsr
