     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FV101R
      * Beskrivelse . . : Vedlikehold av status-koder, Generelle
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * R3.31 020301 AMD  Programmet er skrevet om til standard ILE.
      * R3.31 020301 AMD  Lagt inn mulighet til selv å styre hvilken kode
      *                   som skal slås av/på ved valg 98 (Info-koden)
3.32  * R3.32 020301 AMD  Lagt inn mulighet for å droppe firmaopplysn. de
      *                   i fakturahode eller på bankgiro.
      *       281105 HKO  Lagt inn valg av antall dager for oppfølging av
      *                   tilbud, og antall dager før et tilbud utgår
      *       010206 AMD  Lagt inn kode for kjørekontor-løsning
      * 6.10  250609 BSA  Oppdatert med sporingsinformasjon
6.20  * 6.20  040112 bof  Utvidet med for å splitte ordre på lager
6.31  * 6.30  191017 bof  Utvidet med kode for om tilbud skal vises ordrereg.
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     ffv101d    cf   e             workstn
3.31 fvinfl1    if   e           k disk    rename(vinfpfr:vinfl1r)
     ffstsl1    if   e           k disk    rename(fstspfr:fstsl1r)
     ffstslu    uf a e           k disk    rename(fstspfr:fstslur)
      *
3.31  * Definering av local data area
3.31  *
     d                uds
6.10 d l_user                911    920
     d l_sfir                944    946  0
     d l_fnav                951    980
3.31  *
3.31  * Definering av variabler i nøkler
3.31  *
3.31 d w_firm          s                   like(faafir)
3.31 d vinfl1_ityp     s                   like(vaityp)
3.31  *
3.31  * Definering av variable
3.31  *
3.31 d w_itxt          s                   like(vaitxt)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  A1BLD Behandle bildet for valg
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     a1taga        tag
      *
      *  Hent opplysninger fra OFAK-KODE-REGISTER
      *
     c     stskey        chain     fstsl1                             90
     c                   if        *in90 = *off
     c                   eval      a1aork = faaork
     c                   eval      a1afak = faafak
     c                   eval      a1adel = faadel
     c                   eval      a1alsm = faalsm
     c                   eval      a1akhv = faakhv
     c                   eval      a1aoty = faaoty
     c                   eval      a1alty = faalty
     c                   eval      a1atty = faatty
     c                   eval      a1akun = faakun
     c                   eval      a1aknr = faaknr
     c                   eval      a1avnr = faavnr
     c                   eval      a1abil = faabil
     c                   eval      a1agrn = faagrn
     c                   eval      a1anod = faanod
     c                   eval      a1akjk = faakjk
6.20 c                   eval      a1ak02 = faak02
3.31 c                   eval      a1ak98 = faak98
3.32 c                   eval      a1aprt = faaprt
3.32 c                   eval      a1aopf = faaopf
3.32 c                   eval      a1autg = faautg
6.31 c                   eval      a1ak05 = faak05
     c                   else
     c                   eval      a1aork = *blank
     c                   eval      a1afak = *blank
     c                   eval      a1adel = *blank
     c                   eval      a1alsm = *blank
     c                   eval      a1akhv = *blank
     c                   eval      a1aoty = *blank
     c                   eval      a1alty = *blank
     c                   eval      a1atty = *blank
     c                   eval      a1akun = *zero
     c                   eval      a1aknr = *zero
     c                   eval      a1avnr = *blank
     c                   eval      a1abil = *zero
     c                   eval      a1agrn = *zero
     c                   eval      a1anod = *zero
3.31 c                   eval      a1ak98 = *blank
3.32 c                   eval      a1aprt = *zero
3.32 c                   eval      a1aopf = 0
3.32 c                   eval      a1autg = 0
6.31 c                   eval      a1ak05 = 0
     c                   endif
      *
      *  Vis bilde
      *
3.31 c     a1tagb        tag
3.31  *
     c                   exfmt     a1bld
      *
      *  F3=Avslutt
      *
     c     *inkc         cabeq     *on           xslutt
3.31  *
3.31  * F4=Spørring på ordre-info-type
3.31  *
3.31 c                   if        *inkd  = *on
3.31 c                   if        w_afld = 'A1AK98'
3.31 c                   call      'VA540R'
3.31 c                   parm                    w_firm
3.31 c                   parm                    a1ak98
3.31 c                   parm                    w_itxt
3.31 c                   goto      a1tagb
3.31 c                   endif
3.31 c                   endif
3.31  *
3.31  *  Sjekk,  Finnes ordre-info-kode i inforegister
3.31  *
3.31 c                   if        a1ak98 <> *blank
3.31 c                   eval      vinfl1_ityp = a1ak98
3.31 c     vinfl1_key    chain     vinfl1r                            91
3.31 c                   if        *in91  = *on
3.31 c                   eval      *in31  = *on
3.31 c                   goto      a1tagb
3.31 c                   endif
3.31 c                   endif
      *
      *  Oppdater OFAK-KODE-REGISTER
      *
     c     stskey        chain     fstslur                            90
      *
     c                   eval      faaork = a1aork
     c                   eval      faafak = a1afak
     c                   eval      faadel = a1adel
     c                   eval      faalsm = a1alsm
     c                   eval      faakhv = a1akhv
     c                   eval      faaoty = a1aoty
     c                   eval      faalty = a1alty
     c                   eval      faatty = a1atty
     c                   eval      faakun = a1akun
     c                   eval      faaknr = a1aknr
     c                   eval      faavnr = a1avnr
     c                   eval      faabil = a1abil
     c                   eval      faagrn = a1agrn
     c                   eval      faanod = a1anod
     c                   eval      faakjk = a1akjk
6.20 c                   eval      faak02 = a1ak02
3.32 c                   eval      faaprt = a1aprt
3.32 c                   eval      faaopf = a1aopf
3.32 c                   eval      faautg = a1autg
3.31 c                   eval      faak98 = a1ak98
6.31 c                   eval      faak05 = a1ak05
3.31  *
3.31 c                   if        faak98 = *blank
3.31 c                   eval      faak98 = '*H'
3.31 c                   endif
      *
     c                   if        *in90 = *off
6.10 c                   time                    faaeda
6.10 c                   time                    faaeti
6.10 c                   eval      faaeus = l_user
     c                   update    fstslur
     c                   else
     c                   eval      faafir = l_sfir
6.10 c                   time                    faaoda
6.10 c                   time                    faaoti
6.10 c                   eval      faaous = l_user
6.10 c                   time                    faaeda
6.10 c                   time                    faaeti
6.10 c                   eval      faaeus = l_user
     c                   write     fstslur
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *inzsr        begsr
      *
      *  Key for file : OFAK-KODE-REGISTER
      *
     c     stskey        klist
     c                   kfld                    w_firm
3.31  *
3.31  * Key for oppslag på ordre-info-type
3.31  *
3.31 c     vinfl1_key    klist
3.31 c                   kfld                    w_firm
3.31 c                   kfld                    vinfl1_ityp
      *
      *  Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = l_sfir
      *
     c                   endsr
