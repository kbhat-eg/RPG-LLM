     h/title  ASOFAK: Jobb-register status, Oppdatering av koder
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FA720R
      * Beskrivelse . . : Jobb-register status, Oppdatering av koder
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * 6.10  230609 BSA  Oppdatert med sporingsinformasjon
6.20  * 6.20  190313 AMD  Ved opprettelse av ny post ble ikke firmanr
6.20  *                   med og det ble duplicate rec. på firma 000
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffjoblu    uf a e           k disk    rename(fjobpfr:fjoblur)
      *
      * Definering av parametre
      *
     d p_kode          s              2  0
     d p_onof          s              1  0
      *
      * Definering av variable
      *
     d w_firm          s                   like(fajfir)
     d w_date          s                   like(fada01)
     d w_time          s                   like(fati01)
      *
     d                uds
     d  l_wsid               901    910
     d  l_user               911    920
     d  l_firm               944    946  0
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Oppdaterer status for igangsatt/avsluttet jobb
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      *  Dersom Jobb-status-register er tomt,
      *  må aktuell record opprettes først
      *
     c     fjoblu_key    chain     fjoblur                            90
      *
     c                   if        *in90  = *on
6.20 c                   eval      fajfir = w_firm
6.10 c                   time                    fajoda
6.10 c                   time                    fajoti
6.10 c                   eval      fajous = l_user
6.10 c                   time                    fajeda
6.10 c                   time                    fajeti
6.10 c                   eval      fajeus = l_user
     c                   write     fjoblur
     c                   end
      *
      *  Henter inn dagens dato og
      *  klokkeslett
      *
     c                   time                    w_date
     c                   time                    w_time
      *
      *  Oppdater Jobb-status-register
      *
     c     fjoblu_key    chain     fjoblur                            90
     c                   if        *in90  = *off
      *
     c                   if        p_kode = 01
     c                   eval      fajb01 = p_onof
     c                   eval      faws01 = l_wsid
     c                   eval      faus01 = l_user
     c                   eval      fada01 = w_date
     c                   eval      fati01 = w_time
     c                   end
      *
     c                   if        p_kode = 02
     c                   eval      fajb02 = p_onof
     c                   eval      faws02 = l_wsid
     c                   eval      faus02 = l_user
     c                   eval      fada02 = w_date
     c                   eval      fati02 = w_time
     c                   end
      *
     c                   if        p_kode = 03
     c                   eval      fajb03 = p_onof
     c                   eval      faws03 = l_wsid
     c                   eval      faus03 = l_user
     c                   eval      fada03 = w_date
     c                   eval      fati03 = w_time
     c                   end
      *
     c                   if        p_kode = 04
     c                   eval      fajb04 = p_onof
     c                   eval      faws04 = l_wsid
     c                   eval      faus04 = l_user
     c                   eval      fada04 = w_date
     c                   eval      fati04 = w_time
     c                   end
      *
     c                   if        p_kode = 05
     c                   eval      fajb05 = p_onof
     c                   eval      faws05 = l_wsid
     c                   eval      faus05 = l_user
     c                   eval      fada05 = w_date
     c                   eval      fati05 = w_time
     c                   end
      *
     c                   if        p_kode = 06
     c                   eval      fajb06 = p_onof
     c                   eval      faws06 = l_wsid
     c                   eval      faus06 = l_user
     c                   eval      fada06 = w_date
     c                   eval      fati06 = w_time
     c                   end
      *
     c                   if        p_kode = 07
     c                   eval      fajb07 = p_onof
     c                   eval      faws07 = l_wsid
     c                   eval      faus07 = l_user
     c                   eval      fada07 = w_date
     c                   eval      fati07 = w_time
     c                   end
      *
     c                   if        p_kode = 08
     c                   eval      fajb08 = p_onof
     c                   eval      faws08 = l_wsid
     c                   eval      faus08 = l_user
     c                   eval      fada08 = w_date
     c                   eval      fati08 = w_time
     c                   end
      *
     c                   if        p_kode = 09
     c                   eval      fajb09 = p_onof
     c                   eval      faws09 = l_wsid
     c                   eval      faus09 = l_user
     c                   eval      fada09 = w_date
     c                   eval      fati09 = w_time
     c                   end
      *
     c                   if        p_kode = 10
     c                   eval      fajb10 = p_onof
     c                   eval      faws10 = l_wsid
     c                   eval      faus10 = l_user
     c                   eval      fada10 = w_date
     c                   eval      fati10 = w_time
     c                   end
      *
      * Nullstille dersom kode er 0
      *
     c                   if        p_onof = 0
      *
     c                   if        p_kode = 01
     c                   eval      faws01 = *blank
     c                   eval      faus01 = *blank
     c                   eval      fada01 = *loval
     c                   eval      fati01 = *loval
     c                   end
      *
     c                   if        p_kode = 02
     c                   eval      faws02 = *blank
     c                   eval      faus02 = *blank
     c                   eval      fada02 = *loval
     c                   eval      fati02 = *loval
     c                   end
      *
     c                   if        p_kode = 03
     c                   eval      faws03 = *blank
     c                   eval      faus03 = *blank
     c                   eval      fada03 = *loval
     c                   eval      fati03 = *loval
     c                   end
      *
     c                   if        p_kode = 04
     c                   eval      faws04 = *blank
     c                   eval      faus04 = *blank
     c                   eval      fada04 = *loval
     c                   eval      fati04 = *loval
     c                   end
      *
     c                   if        p_kode = 05
     c                   eval      faws05 = *blank
     c                   eval      faus05 = *blank
     c                   eval      fada05 = *loval
     c                   eval      fati05 = *loval
     c                   end
      *
     c                   if        p_kode = 06
     c                   eval      faws06 = *blank
     c                   eval      faus06 = *blank
     c                   eval      fada06 = *loval
     c                   eval      fati06 = *loval
     c                   end
      *
     c                   if        p_kode = 07
     c                   eval      faws07 = *blank
     c                   eval      faus07 = *blank
     c                   eval      fada07 = *loval
     c                   eval      fati07 = *loval
     c                   end
      *
     c                   if        p_kode = 08
     c                   eval      faws08 = *blank
     c                   eval      faus08 = *blank
     c                   eval      fada08 = *loval
     c                   eval      fati08 = *loval
     c                   end
      *
     c                   if        p_kode = 09
     c                   eval      faws09 = *blank
     c                   eval      faus09 = *blank
     c                   eval      fada09 = *loval
     c                   eval      fati09 = *loval
     c                   end
      *
     c                   if        p_kode = 10
     c                   eval      faws10 = *blank
     c                   eval      faus10 = *blank
     c                   eval      fada10 = *loval
     c                   eval      fati10 = *loval
     c                   end
     c*
     c                   end
     c*
6.10 c                   time                    fajeda
6.10 c                   time                    fajeti
6.10 c                   eval      fajeus = l_user
     c                   update    fjoblur
     c                   end
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Avslutt program                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr  = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Subrutine for initiering av program                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *  Tar inn parameter fra forrige program
      *
     c     *entry        plist
     c                   parm                    p_kode
     c                   parm                    p_onof
      *
      * Key for file : Jobb-register
      *
     c     fjoblu_key    klist
     c                   kfld                    w_firm
      *
      * Legger inn firma i nøkkler
      *
     c                   eval      w_firm = l_firm
      *
     csr                 endsr
