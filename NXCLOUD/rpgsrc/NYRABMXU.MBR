     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Inputrecord:
      *(Firma)    Kundenr.  Kortnr.   Kundenavn Adresse   Adresse2  Postnr
      * Poststed  Bet.Bet   Bet.måte  Samlefakt FaktType  PrisPakk  Kr.Grens
      * Kr.sperr  Kr.Type   RabKat    Kundekat  Orgnr     Kont.Pers KontPMail
      * Telefon   Mobil     Passiv    FaktSekv  SpesAvt   SpesAvttxtePostadr
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
8.00  *K00  170323 sst Endret antall siffer i Dekningsgrad etter at Optimera trengte 100%
8.xx  *K00  020424 bsa Utvidet prisgruppe
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffrabl1    ip   e           k disk    rename(frabpfr:frablur)
     fxlfrab    o    f 1024        disk
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_fgr                 931    933
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av variabler i nøkler
      *
      *
     d w_dato          s             10
     d rabrec          s           1024
      *
      * Definering av variable
      *
     d i               s              3  0
     d vare            s             15
     d d_firm          s              3
8.xx d d_prgr          s              2
     d d_rkat          s              3
     d d_kkat          s              4
     d d_kund          s              6
     d d_kpro          s              6
     d d_ogrp          s              2
     d d_hgrp          s              2
     d d_ugrp          s              3
     d d_ldor          s              6
     d d_modn          s              8
     d d_vare          s             15
     d d_enhe          s              3
     d d_lety          s              1
     d d_nota          s              5
     d d_pslm          s             10
     d d_rab1          s             10
     d d_ra1d          s             10
     d d_ra1f          s             10
     d d_ra1t          s             10
     d d_rab2          s             10
     d d_ra2d          s             10
     d d_ra2f          s             10
     d d_ra2t          s             10
     d d_rabn          s             10
     d d_rand          s             10
     d d_ranf          s             10
     d d_rant          s             10
     d d_rabb          s             10
     d d_rabd          s             10
     d d_rbuf          s             10
     d d_rbut          s             10
     d d_rabt          s             10
     d d_ratd          s             10
     d d_ratf          s             10
     d d_ratt          s             10
     d d_dekn          s             10
     d d_dekd          s             10
     d d_dekf          s             10
     d d_dekt          s             10
     d d_slet          s             10
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     c                   if        frrkat = 42
     c                             and frogrp = 4
     c                             and frhgrp = 4
     c                   eval      frrab1 = frrab1
     c                   endif
     c                   if        frrkat = 42
     c                             and frogrp = 4
     c                             and frhgrp = 6
     c                   eval      frrab1 = frrab1
     c                   endif
     c                   eval      rabrec = %char(frfirm) + ';' +
     c                             %trim(frprgr) + ';' +
      *
     c                             %char(frrkat) + ';' +
     c                             %char(frkkat) + ';' +
     c                             %char(frkund) + ';' +
     c                             %char(frkpro) + ';' +
     c                             %char(frogrp) + ';' +
     c                             %char(frhgrp) + ';' +
     c                             %char(frugrp) + ';' +
     c                             %char(frldor) + ';' +
     c                             %char(frmodn) + ';' +
     c                             %trim(frvare) + ';' +
     c                             %trim(frenhe) + ';' +
     c                             %char(frlety) + ';' +
     c                             %trim(frnota) + ';' +
     c                             %char(frpslm) + ';' +
     c                             %char(frrab1) + ';' +
     c                             %char(frra1d) + ';' +
     c                             %char(frra1f : *iso) + ';' +
     c                             %char(frra1t : *iso) + ';' +
     c                             %char(frrab2) + ';' +
     c                             %char(frra2d) + ';' +
     c                             %char(frra2f : *iso) + ';' +
     c                             %char(frra2t : *iso) + ';' +
     c                             %char(frrabn) + ';' +
     c                             %char(frrand) + ';' +
     c                             %char(frranf : *iso) + ';' +
     c                             %char(frrant : *iso) + ';' +
     c                             %char(frrabb) + ';' +
     c                             %char(frrabd) + ';' +
     c                             %char(frrbuf : *iso) + ';' +
     c                             %char(frrbut : *iso) + ';' +
     c                             %char(frrabt) + ';' +
     c                             %char(frratd) + ';' +
     c                             %char(frratf : *iso) + ';' +
     c                             %char(frratt : *iso) + ';' +
8.00 c                             %char(frdekn) + ';' +
8.00 c                             %char(frdekd) + ';' +
     c                             %char(frdekf : *iso) + ';' +
     c                             %char(frdekt : *iso) + ';'
     c     '.':','       xlate     rabrec        rabrec
      *
     c                   except    xlfrabut
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c                   eval      rabrec = 'Rabattmatrise'
     c                   except    xlfrabut
      *
      *
     c                   eval      rabrec = 'FRFIRM; FRPRGR; FRRKAT; FRKKAT; +
     c                                       FRKUND; +
     c                                       FRKPRO; FROGRP; FRHGRP; FRUGRP; +
     c                                       FRLDOR; FRMODN; FRVARE; FRENHE; +
     c                                       FRLETY; FRNOTA; FRPSLM; FRRAB1; +
     c                                       FRFA1D; FRRA1F; FRRA1T; FRRAB2; +
     c                                       FRFA2D; FRRA2F; FRRA2T; FRRABN; +
     c                                       FRRAND; FRRANF; FRRANT; FRRABB; +
     c                                       FRFABD; FRRABF; FRRABT; FRRABT; +
     c                                       FRFATD; FRRATF; FRRATT; FRDEKN; +
     c                                       FRDEKD; FRDEKF; FRDEKT;'
     c
     c                   except    xlfrabut
      *
     c                   eval      rabrec = 'Firmanr;Pris gruppe;Rabatt kategor+
     c                                       i;Kunde kategori;+
     c                                       Kunde;Kundeprosjekt;Overgruppe;+
     c                                       Hovedgruppe;Undergruppe;Leverandør+
     c                                       ;Modul;varenr;Enhet;Lev.type;+
     c                                       Notat;Ikke i bruk STD;Rab-1;+
     c                                       Rab-1 datostyrt;Rab-1 fra dato;+
     c                                       Rab-1 til dato;Rab-2;Rab-2 datosty+
     c                                       rt;Rab-2 fra dato;Rab-2 til dato;+
     c                                       Rab-N;Rab-N datostyrt;Rab-N fra da+
     c                                       to;Rab-N til dato;Rab-B;Rab-B dato+
     c                                       styrt;Rab-B fra dato;Rab-B til dat+
     c                                       o;Rab-T;Rab-T datostyrt;Rab-T fra +
     c                                       dato;Rab-T til dato;DG;DG datostyr+
     c                                       t;DG fra dato;DG til dato;'
     c                   except    xlfrabut
      *
     c                   eval      rabrec = 'x:3.0;1;3.0;4.0;6.0;6.0;2.0;2.0;3.+
     c                                       0;6;8.0;15;3;1;5;4,2;4,2;4,2;+
     c                                       åååå-mm-dd;åååå-mm-dd;4,2;4,2;+
     c                                       åååå-mm-dd;åååå-mm-dd;4,2;4,2;+
     c                                       åååå-mm-dd;åååå-mm-dd;4,2;4,2;+
     c                                       åååå-mm-dd;åååå-mm-dd;4,2;4,2;+
     c                                       åååå-mm-dd;åååå-mm-dd;4,2;4,2;+
     c                                       åååå-mm-dd;åååå-mm-dd;'
     c
     c                   except    xlfrabut
      *
     c                   endsr
      *
     oxlfrab    E            xlfrabut
     o                       rabrec
