      /TITLE  Utvalg av statistikktransaksjoner
     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SF600R
      * Beskrivelse . . : Utvalg av statistikktransaksjoner
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * V5.30 140304 KOB  Utplukk på periode fra - til på tvers av år
      *                   fungerte ikke
      * V5.30 200304 KOB  Lagt inn beregning av aktuell og nominell m3
      * V5.30 260604 KOB  Endret hgr.kundekategori til 2 pos
      * V5.30 161204 KOB  Lagt inn beregning av m3 direkte i programmet
      * V5.30 161204 KOB  Lagt inn at programmet starter les "fra periode"
      * V5.41 240805 AMD  Utvidet distrikt fra 2.0 til 4.0
      * V5.50 301006 KOB  Lagt inn selger kasse
6.NU  * R6.30 230614 nho  Endringer grunnet nummerutvidelser
8.01  *PRG2   220622 BOF  Utvidet prisgruppe fra 1 til 2 posisjoner - COMP
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     Fskpwpf    if   f  512    25aidisk    keyloc(1)
     Fsstal1    if   e           k disk    rename(sstapfr:sstal1r)
      *
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     Fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvvenl1    if   e           k disk    rename(vvenpfr:vvenl1r)
      *
     Fskwwpf    o  a e           k disk
     Fsf600p    o    e             printer
     F
      *
      /eject
      *
      * Definering av variable i nøkler
      *
     d vvenl1_vare     s                   like(vevare)
     d vvarl1_vare     s                   like(vvvare)
     d rkunl1_kund     s                   like(rkkund)
     d sstal1_paar     s                   like(sfpaar)
      *
      * Definering av variable
      *
     d w_firm          s                   like(vefirm)
     d w_omr1          s                   like(veomre)
     d w_omr2          s                   like(veomre)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tabeller                                                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     D rpt             s             25    dim(60) ctdata perrcd(1)
     D utv             s              1    dim(60)
     D hhgr            s              2    dim(999)
     D uhgr            s              2    dim(999)
     D uugr            s              3    dim(999)
     D rgr             s              7    dim(999)
     D oogp            s              2    dim(999)
     D hogp            s              2    dim(999)
     D hhgp            s              2    dim(999)
     D uogp            s              2    dim(999)
     D uhgp            s              2    dim(999)
     D uugp            s              3    dim(999)
     D kka             s              4    dim(999)
     D rka             s              3    dim(999)
     D dis             s              4    dim(999)
     D sel             s              4    dim(999)
     D lan             s              3    dim(999)
     D sek             s              4    dim(999)
     D spfvar          s             15    dim(10)
     D sptvar          s             15    dim(10)
     D spfkun          s              6    dim(10)
     D sptkun          s              6    dim(10)
     D spflad          s              6    dim(10)
     D sptlad          s              6    dim(10)
     D oty             s              2    dim(999)
     D avd             s              4    dim(999)
     D lag             s              2    dim(999)
     D pra             s              5    dim(999)
     D lty             s              1    dim(9)
     D lev             s              6    dim(999)
     D w_sfperi        s              6  0
     D wwbida          s              8  0
      *
     D                 ds
     D umtid                         12  0
     D  umtime                        6  0 overlay(umtid)
     D  umdato                        6  0 overlay(umtid:7)
      *
     D                 ds
     D wwahug                         5  0
     D  sfahgr                             overlay(wwahug:1)
     D  sfaugr                             overlay(wwahug:3)
      *
     D                 ds
     D wwohug                         7
     D  wwogrp                        2    overlay(wwohug:1)
     D  wwhgrp                        2    overlay(wwohug:3)
     D  wwugrp                        3    overlay(wwohug:5)
      *
     D                 ds
     D w_peri                         6  0
     D  sfpaar                             overlay(w_peri:1)
     D  sfpmnd                             overlay(w_peri:5)
      *
     D                 ds
     D ww_peri                        6  0
     d w_aaaa          s              4  0
     d w_mnd1          s              2  0
     d w_mnd2          s              2  0
      *
     D                uds
     D l_wsid                901    910
     D l_user                        10
     D l_firm                944    946  0
     D l_navn                951    980
      *
     D alf2x           s              2
     D alf1            s              1
     D alf2            s              2
     D alf3            s              3
     D alf4            s              4
     D alf5            s              5
     D alf6            s              6
     D alf7            s              7
      *
     D n               s              3  0
     D rpt01           s             25
     D rpt02           s             25
     D rpt03           s             25
      *
     D styp            s              2  0
     D swsrt1          s             15
     D swsrt2          s             15
     D swsrt3          s             15
      *
     D tid             s              6  0
     D ty00            s              1
     D v               s              2  0
     D whkk            s              2  0
      *
     D wknr            s              6
     D wkpro           s              6
     d w_timestamp     s             12  0
      *
     d wtimeblank      s             13
     d wtimeneste      s              5
     d wtimehour       s              2  0
      *
     d wr1             s                   like(r1)
     d wr2             s                   like(r2)
     d wr3             s                   like(r3)
     d wpsp1           s                   like(psp1)
     d wpsp2           s                   like(psp2)
     d wpsp3           s                   like(psp3)
     d wpsp4           s                   like(psp4)
     d wpsp5           s                   like(psp5)
     d wpnytt          s                   like(psnytt)
      *
     d                 ds
     d skpwpf_key                    25
     d w_spfirm                       3  0 overlay(skpwpf_key:1)
     d w_sptype                      10    overlay(skpwpf_key:4)
     d w_spkode                       2  0 overlay(skpwpf_key:14)
     d w_spvalg                      10    overlay(skpwpf_key:16)
      *
      * Definering av parametre
      *
     d p_firm          s                   like(vvfirm)
     d p_vare          s                   like(vvvare)
     d p_enh1          s                   like(vvenhe)
     d p_enh2          s                   like(vvenhe)
     d p_ant1          s             11  3
     d p_ant2          s             11  3
     d p_ant3          s             11  3
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Input                                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     Iskpwpf    ns  01   14 c0   15 c0
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61   62 0r1
     I                                 63   64 0r2
     I                                 65   66 0r3
     I                                 67   67  psp1
     I                                 68   68  psp2
     I                                 69   69  psp3
     I                                 70   70  psp4
     I                                 71   71  psp5
     I                                 86   86  psnytt
      *                                                    Alt. Hovedgruppe
     I          ns  01   14 c1   15 c1
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17 0spahgr
     I                                 31   60  sptext
      *                                                    Alt. Undergruppe
     I          ns  01   14 c1   15 c2
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17 0spahgr
     I                                 18   20 0spaugr
     I                                 31   60  sptext
      *                                                    Rabattgruppe
     I          ns  01   14 c1   15 c3
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   22 0sprgrp
     I                                 31   60  sptext
      *                                                    Hovedgruppe  (Nobb)
     I          ns  01   14 c1   15 c4
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17 0spogrp
     I                                 31   60  sptext
      *                                                    Hovedgruppe (Nobb)
     I          ns  01   14 c1   15 c5
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17 0spogrp
     I                                 18   19 0sphgrp
     I                                 31   60  sptext
      *                                                    Undergruppe (Nobb)
     I          ns  01   14 c1   15 c6
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17 0spogrp
     I                                 18   19 0sphgrp
     I                                 20   22 0spugrp
     I                                 31   60  sptext
      *                                                    Kundekategori
     I          ns  01   14 c2   15 c1
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   19 0spkkat
     I                                 31   60  sptext
      *                                                    Rabattkategori
     I          ns  01   14 c2   15 c2
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   18 0sprkat
     I                                 31   60  sptext
      *                                                    Distrikt
     I          ns  01   14 c2   15 c3
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   19 0spdist
     I                                 31   60  sptext
      *                                                    Selger ordre
     I          ns  01   14 c2   15 c4
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   19 0spselg
     I                                 31   60  sptext
      *                                                    Land
     I          ns  01   14 c2   15 c5
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   18 0spland
     I                                 31   60  sptext
      *                                                    Selger kasse
     I          ns  01   14 c2   15 c7
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   19 0spksel
     I                                 31   60  sptext
      *                                                    Varenummer
     I          ns  01   14 c3   15 c1
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61  210  spfvar
     I                                211  360  sptvar
      *                                                    Kundenummer
     I          ns  01   14 c3   15 c2
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61  120  spfkun
     I                                121  180  sptkun
      *                                                    Kundeprosjekt
     I          ns  01   14 c3   15 c3
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61  120  spflad
     I                                121  180  sptlad
      *                                                    Periode
     I          ns  01   14 c4   15 c1
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61   66 0spfper
     I                                 67   72 0sptper
      *                                                    Fakturanummer
     I          ns  01   14 c4   15 c2
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
6.nu I                                 61   68 0spffak
6.nu I                                 69   76 0sptfak
6.nu I                                 77   84 0spfkre
6.nu I                                 85   92 0sptkre
      *                                                    Fakturadato
     I          ns  01   14 c4   15 c3
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61   68 0spffda
     I                                 69   76 0spftda
      *                                                    Kampanje
     I          ns  01   14 c4   15 c4
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61   65  spkamp
      *                                                    Ordretype
     I          ns  01   14 c5   15 c1
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17  spotyp
     I                                 31   60  sptext
      *                                                    Avdeling
     I          ns  01   14 c5   15 c2
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   19 0spavde
     I                                 31   60  sptext
      *                                                    Lager
     I          ns  01   14 c5   15 c3
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   17 0splage
     I                                 31   60  sptext
      *                                                    Produktansvarlig
     I          ns  01   14 c5   15 c4
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   19  sppran
     I                                 31   60  sptext
      *                                                    Leveringstype
     I          ns  01   14 c5   15 c5
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   16 0splety
     I                                 31   60  sptext
      *                                                    Leverandør
     I          ns  01   14 c5   15 c6
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 16   2100splevr
     I                                 31   60  sptext
     I          ns  02
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XTRANS Behandle detaljlinjer                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c                   movel     spfper        sstal1_paar
     c     sstal1_key    setll     sstal1                                 lr
      *
     c     xtrans        tag
      *
      * Les fra Salgsstatistikkregister
      *
     c                   read      sstal1                                 lr
     c                   if        *inlr = *on
     c                   goto      endprg
     c                   endif
      *
      * Sjekk utvalg FIRMA
      *
     c                   if        l_firm <> sffirm
     c                   goto      xtrans
     c                   endif
      *
     c                   eval      w_lest = w_lest + 1
      *
      * Beregn aktuell og nominell m3
      *
     c                   exsr      subkub
      *
      * Skal opplysninger hentes på nytt
      *
     c                   if        wpnytt = 'N'
      *
      * Hent opplysninger fra KUNDE-REGISTER
      *
     c                   move      sfvkun        rkunl1_kund
     c     rkunl1_key    chain     rkunl1                             10
     c                   if        *in10 = *off
     c                   move      rkkatg        sfkkat
     c                   move      rkrabk        sfrkat
     c                   move      rkdist        sfdist
     c                   move      rkslgr        sfselg
     c                   move      rkland        sfland
     c                   endif
      *
      * Hent opplysninger fra VARE-REGISTER
      *
     c                   move      sfvare        vvarl1_vare
     c     vvarl1_key    chain     vvarl1                             50
     c                   if        *in50 = *off
     c                   move      vvogrp        sfogrp
     c                   move      vvhgrp        sfhgrp
     c                   move      vvugrp        sfugrp
     c                   endif
      *
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Start behandling av utvalg etc                                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C                   if        utv(11) = 'J'
     C                   exsr      subhgr
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(12) = 'J'
     C                   exsr      subugr
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(13) = 'J'
     C                   exsr      subrgr
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(14) = 'J' or
     C                             utv(15) = 'J' or
     C                             utv(16) = 'J'
     C                   exsr      subgrp
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(21) = 'J'
     C                   exsr      subkka
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(22) = 'J'
     C                   exsr      subrka
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(23) = 'J'
     C                   exsr      subdis
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(24) = 'J'
     C                   exsr      subsel
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(25) = 'J'
     C                   exsr      sublan
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(27) = 'J'
     C                   exsr      subsek
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(31) = 'J'
     C                   exsr      subvnr
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(32) = 'J'
     C                   exsr      subknr
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(33) = 'J'
     C                   exsr      sublad
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(41) = 'J'
     C                   exsr      subper
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     c                   if        utv(42) = 'J'
     c                   exsr      subfnr
     c                   if        *in98 = *on
     c                   goto      xtrans
     c                   endif
     c                   endif
      *
     C                   if        utv(43) = 'J'
     C                   exsr      subfda
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(44) = 'J'
     C                   exsr      subkam
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(51) = 'J'
     C                   exsr      suboty
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(52) = 'J'
     C                   exsr      subavd
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(53) = 'J'
     C                   exsr      sublag
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(54) = 'J'
     C                   exsr      subpra
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(55) = 'J'
     C                   exsr      sublty
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
     C                   if        utv(56) = 'J'
     C                   exsr      sublev
     C                   if        *in98 = *on
     C                   goto      xtrans
     C                   endif
     C                   endif
      *
      /eject
      *
      * Varelinjer som har kommet gjennom nåløyet
      *
      * Bygg opp sorteringsbegrep 1
      *
     C                   if        *in11 = *on
     C                   movel     sfahgr        swsrt1
     C                   endif
      *
     C                   if        *in12 = *on
     C                   movel     wwahug        swsrt1
     C                   endif
      *
     C                   if        *in13 = *on
     C                   movel     sfrgrp        swsrt1
     C                   endif
      *
     C                   if        *in60 = *on
     C                   move      sfogrp        wwogrp
     C                   move      *blank        wwhgrp
     C                   move      *blank        wwugrp
     C                   movel     wwohug        swsrt1
     C                   endif
      *
     C                   if        *in61 = *on
     C                   move      sfogrp        wwogrp
     C                   move      sfhgrp        wwhgrp
     C                   move      *blank        wwugrp
     C                   movel     wwohug        swsrt1
     C                   endif
      *
     C                   if        *in62 = *on
     C                   move      sfogrp        wwogrp
     C                   move      sfhgrp        wwhgrp
     C                   move      sfugrp        wwugrp
     C                   movel     wwohug        swsrt1
     C                   endif
      *
     C                   if        *in14 = *on
     C                   movel     sfkkat        swsrt1
     C                   endif
      *
     C                   if        *in15 = *on
     C                   movel     sfrkat        swsrt1
     C                   endif
      *
     C                   if        *in16 = *on
     C                   movel     sfdist        swsrt1
     C                   endif
      *
     C                   if        *in17 = *on
     C                   movel     sfselg        swsrt1
     C                   endif
      *
     C                   if        *in18 = *on
     C                   movel     sfland        swsrt1
     C                   endif
      *
     C                   if        *in35 = *on
     C                   movel     sfksel        swsrt1
     C                   endif
      *
     C                   if        *in19 = *on
     C                   movel     sfvare        swsrt1
     C                   endif
      *
     C                   if        *in20 = *on
     C                   if        sfvkun = *zeros
     C                   movel     sffkun        swsrt1
     C                   else
     C                   movel     sfvkun        swsrt1
     C                   endif
     C                   endif
      *
     C                   if        *in21 = *on
     C                   movel     sfpaar        w_sfperi
     C                   move      sfpmnd        w_sfperi
     C                   movel     w_sfperi      swsrt1
     C                   endif
      *
     C                   if        *in22 = *on
     C                   movel     sfbinr        swsrt1
     C                   endif
      *
     C                   if        *in23 = *on
     c                   movel     sfbida        swsrt1
      *
     C                   endif
      *
     C                   if        *in24 = *on
     C                   movel     sfotyp        swsrt1
     C                   endif
      *
     C                   if        *in25 = *on
     C                   movel     sfsavd        swsrt1
     C                   endif
      *
     C                   if        *in26 = *on
     C                   movel     sflage        swsrt1
     C                   endif
      *
     C                   if        *in27 = *on
     C                   movel     sfkkat        whkk
     C                   movel     whkk          swsrt1
     C                   endif
      *
     C                   if        *in28 = *on
     C                   movel     sfpran        swsrt1
     C                   endif
      *
     C                   if        *in29 = *on
     C                   movel     sfkpro        swsrt1
     C                   endif
      *
     C                   if        *in31 = *on
     C                   movel     sflety        swsrt1
     C                   endif
      *
     C                   if        *in32 = *on
     C                   movel     sfldor        swsrt1
     C                   endif
      *
     C                   if        *in33 = *on
     C     *iso          movel     sftime        swsrt1
     C                   move      wtimeblank    swsrt1
     C                   movel     swsrt1        wtimehour
     C                   add       1             wtimehour
     C                   move      wtimehour     wtimeneste
     C                   movel     ' -'          wtimeneste
     C                   movel     wtimeneste    wtimeblank
     C                   move      wtimeblank    swsrt1
     C                   endif
      *
      * Bygg opp sorteringsbegrep 2
      *
     C                   if        *in41 = *on
     C                   movel     sfahgr        swsrt2
     C                   endif
      *
     C                   if        *in42 = *on
     C                   movel     wwahug        swsrt2
     C                   endif
      *
     C                   if        *in43 = *on
     C                   movel     sfrgrp        swsrt2
     C                   endif
      *
     C                   if        *in63 = *on
     C                   move      sfogrp        wwogrp
     C                   move      *blank        wwhgrp
     C                   move      *blank        wwugrp
     C                   movel     wwohug        swsrt2
     C                   endif
      *
     C                   if        *in64 = *on
     C                   move      sfogrp        wwogrp
     C                   move      sfhgrp        wwhgrp
     C                   move      *blank        wwugrp
     C                   movel     wwohug        swsrt2
     C                   endif
      *
     C                   if        *in65 = *on
     C                   move      sfogrp        wwogrp
     C                   move      sfhgrp        wwhgrp
     C                   move      sfugrp        wwugrp
     C                   movel     wwohug        swsrt2
     C                   endif
      *
     C                   if        *in44 = *on
     C                   movel     sfkkat        swsrt2
     C                   endif
      *
     C                   if        *in45 = *on
     C                   movel     sfrkat        swsrt2
     C                   endif
      *
     C                   if        *in46 = *on
     C                   movel     sfdist        swsrt2
     C                   endif
      *
     C                   if        *in47 = *on
     C                   movel     sfselg        swsrt2
     C                   endif
      *
     C                   if        *in48 = *on
     C                   movel     sfland        swsrt2
     C                   endif
      *
     C                   if        *in36 = *on
     C                   movel     sfksel        swsrt2
     C                   endif
      *
     C                   if        *in49 = *on
     C                   movel     sfvare        swsrt2
     C                   endif
      *
     C                   if        *in50 = *on
     C                   if        sfvkun = *zeros
     C                   movel     sffkun        swsrt2
     C                   else
     C                   movel     sfvkun        swsrt2
     C                   endif
     C                   endif
      *
     C                   if        *in51 = *on
     C                   movel     sfpaar        w_sfperi
     C                   move      sfpmnd        w_sfperi
     C                   movel     w_sfperi      swsrt2
     C                   endif
      *
     C                   if        *in52 = *on
     C                   movel     sfbinr        swsrt2
     C                   endif
      *
     C                   if        *in53 = *on
     C                   movel     sfbida        swsrt2
      *
     C                   endif
      *
     C                   if        *in54 = *on
     C                   movel     sfotyp        swsrt2
     C                   endif
      *
     C                   if        *in55 = *on
     C                   movel     sfsavd        swsrt2
     C                   endif
      *
     C                   if        *in56 = *on
     C                   movel     sflage        swsrt2
     C                   endif
      *
     C                   if        *in57 = *on
     C                   movel     sfkkat        whkk
     C                   movel     whkk          swsrt2
     C                   endif
      *
     C                   if        *in58 = *on
     C                   movel     sfpran        swsrt2
     C                   endif
      *
     C                   if        *in59 = *on
     C                   movel     sfkpro        swsrt2
     C                   endif
      *
     C                   if        *in69 = *on
     C                   movel     sflety        swsrt2
     C                   endif
      *
     C                   if        *in70 = *on
     C                   movel     sfldor        swsrt2
     C                   endif
      *
     C                   if        *in34 = *on
     C     *iso          movel     sftime        swsrt2
     C                   move      wtimeblank    swsrt2
     C                   movel     swsrt2        wtimehour
     C                   add       1             wtimehour
     C                   move      wtimehour     wtimeneste
     C                   movel     ' -'          wtimeneste
     C                   movel     wtimeneste    wtimeblank
     C                   move      wtimeblank    swsrt2
     C                   endif
      *
      * Bygg opp sorteringsbegrep 3
      *
     C                   if        *in71 = *on
     C                   movel     sfahgr        swsrt3
     C                   endif
      *
     C                   if        *in72 = *on
     C                   movel     wwahug        swsrt3
     C                   endif
      *
     C                   if        *in73 = *on
     C                   movel     sfrgrp        swsrt3
     C                   endif
      *
     C                   if        *in66 = *on
     C                   move      sfogrp        wwogrp
     C                   move      *blank        wwhgrp
     C                   move      *blank        wwugrp
     C                   movel     wwohug        swsrt3
     C                   endif
      *
     C                   if        *in67 = *on
     C                   move      sfogrp        wwogrp
     C                   move      sfhgrp        wwhgrp
     C                   move      *blank        wwugrp
     C                   movel     wwohug        swsrt3
     C                   endif
      *
     C                   if        *in68 = *on
     C                   move      sfogrp        wwogrp
     C                   move      sfhgrp        wwhgrp
     C                   move      sfugrp        wwugrp
     C                   movel     wwohug        swsrt3
     C                   endif
      *
     C                   if        *in74 = *on
     C                   movel     sfkkat        swsrt3
     C                   endif
      *
     C                   if        *in75 = *on
     C                   movel     sfrkat        swsrt3
     C                   endif
      *
     C                   if        *in76 = *on
     C                   movel     sfdist        swsrt3
     C                   endif
      *
     C                   if        *in77 = *on
     C                   movel     sfselg        swsrt3
     C                   endif
      *
     C                   if        *in78 = *on
     C                   movel     sfland        swsrt3
     C                   endif
      *
     C                   if        *in37 = *on
     C                   movel     sfksel        swsrt3
     C                   endif
      *
     C                   if        *in79 = *on
     C                   movel     sfvare        swsrt3
     C                   endif
      *
     C                   if        *in80 = *on
     C                   if        sfvkun = *zeros
     C                   movel     sffkun        swsrt3
     C                   else
     C                   movel     sfvkun        swsrt3
     C                   endif
     C                   endif
      *
     C                   if        *in81 = *on
     C                   movel     sfpaar        w_sfperi
     C                   move      sfpmnd        w_sfperi
     C                   movel     w_sfperi      swsrt3
     C                   endif
      *
     C                   if        *in82 = *on
     C                   movel     sfbinr        swsrt3
     C                   endif
      *
     C                   if        *in83 = *on
     C                   movel     sfbida        swsrt3
      *
     C                   endif
      *
     C                   if        *in84 = *on
     C                   movel     sfotyp        swsrt3
     C                   endif
      *
     C                   if        *in85 = *on
     C                   movel     sfsavd        swsrt3
     C                   endif
      *
     C                   if        *in86 = *on
     C                   movel     sflage        swsrt3
     C                   endif
      *
     C                   if        *in87 = *on
     C                   movel     sfkkat        whkk
     C                   movel     whkk          swsrt3
     C                   endif
      *
     C                   if        *in88 = *on
     C                   movel     sfpran        swsrt3
     C                   endif
      *
     C                   if        *in89 = *on
     C                   movel     sfkpro        swsrt3
     C                   endif
      *
     C                   if        *in90 = *on
     C                   movel     sflety        swsrt3
     C                   endif
      *
     C                   if        *in91 = *on
     C                   movel     sfldor        swsrt3
     C                   endif
      *
     C                   if        *in92 = *on
     C     *iso          movel     sftime        swsrt3
     C                   move      wtimeblank    swsrt3
     C                   movel     swsrt3        wtimehour
     C                   add       1             wtimehour
     C                   move      wtimehour     wtimeneste
     C                   movel     ' -'          wtimeneste
     C                   movel     wtimeneste    wtimeblank
     C                   move      wtimeblank    swsrt3
     C                   endif
      *
     C                   eval      w_valgt = w_valgt + 1
      *
     C                   write     skwwpfr
      *
      * Returner til nytt les
      *
     C                   goto      xtrans
      *
     C     endprg        tag
      *
     C                   write     sm01                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      /eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Omregning fra enhet 1 til enhet 2
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     C     subkub        begsr
      *
      * Initierer ny verdi for antall
      *
     c                   eval      sfakm3 = 0
     c                   eval      sfnom3 = 0
      *
      * Omregner antall til valgt enhet
      *
     c                   eval      vvenl1_vare = sfvare
     c     vvenl1_key    setll     vvenl1
     c     vvenl1_key    reade     vvenl1
     c                   dow       not %eof
      *
     c                   if        veenhe = sfenhe
     c                   eval      w_omr1 = veomre
     c                   endif
      *
     c                   if        veenhe = 'M3 '
     c                   eval      w_omr2 = veomre
     c                   endif
      *
     c     vvenl1_key    reade     vvenl1
     c                   enddo
      *
     c                   if        w_omr2 <> 0
     c                   eval(h)   sfakm3 = sfanta * w_omr1 / w_omr2
     c                   endif
      *
      * Omregner antall til nominell m3
      *
     c                   eval      vvarl1_vare = sfvare
     c     vvarl1_key    chain     vvarl1
     c                   if        %found
     c                   eval(h)   sfnom3 = sfakm3 * vvomrn
     c                   endif
      *
     C     endkub        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for Alt. hovedgruppe
      * ------------------------------------------
      *
     C     subhgr        begsr
     C                   eval      *in98 = *on
     C                   move      sfahgr        alf2
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        hhgr(n) = *blank
     C                   goto      endhgr
     C                   endif
      *                                                                  .
     C                   if        hhgr(n) = alf2
     C                   eval      *in98 = *off
     C                   goto      endhgr
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endhgr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for Alt. undergruppe
      * ------------------------------------------
      *
     C     subugr        begsr
     C                   eval      *in98 = *on
     C                   move      sfahgr        alf2
     C                   move      sfaugr        alf3
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        uugr(n) = *blank
     C                   goto      endugr
     C                   endif
      *                                                                  .
     C                   if        uhgr(n) = *blank
     C                   goto      endugr
     C                   endif
      *                                                                  .
     C                   if        uhgr(n) = alf2
     C                   if        uugr(n) = alf3
     C                   eval      *in98 = *off
     C                   goto      endugr
     C                   endif
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endugr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for rabattgruppe
      * ------------------------------------------
      *
     C     subrgr        begsr
     C                   eval      *in98 = *on
     C                   move      sfrgrp        alf7
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        rgr(n) = *blank
     C                   goto      endrgr
     C                   endif
      *                                                                  .
     C                   if        rgr(n) = alf7
     C                   eval      *in98 = *off
     C                   goto      endrgr
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endrgr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for varegruppe  (Nobb)
      * ------------------------------------------
      *
     C     subgrp        begsr
     C                   eval      *in98 = *on
     C                   move      sfogrp        alf2x
     C                   move      sfhgrp        alf2
     C                   move      sfugrp        alf3
      *
     C     1             do        999           n
      *
     C                   if        oogp(n) = *blank
     C                   goto      endogp
     C                   endif
      *
     C                   if        oogp(n) = alf2x
     C                   eval      *in98 = *off
     C                   goto      endgrp
     C                   endif
      *
     C                   enddo
      *
     C     endogp        tag
      *
     C     1             do        999           n
      *
     C                   if        hogp(n) = *blank
     C                             or hhgp(n) = *blank
     C                   goto      endhgp
     C                   endif
      *
     C                   if        hogp(n) = alf2x
     C                             and hhgp(n) = alf2
     C                   eval      *in98 = *off
     C                   goto      endgrp
     C                   endif
     *
     C                   enddo
     *
     C     endhgp        tag
     *
     C                   eval      *in98 = *on
     *
     C     1             do        999           n
     *
     C                   if        uugp(n) = *blank
     C                             or uhgp(n) = *blank
     C                             or uogp(n) = *blank
     C                   goto      endugp
     C                   endif
     *
     C                   if        uogp(n) = alf2x
     C                             and uhgp(n) = alf2
     C                             and uugp(n) = alf3
     C                   eval      *in98 = *off
     C                   goto      endgrp
     C                   endif
      *
     C                   enddo
      *
     C     endugp        tag
      *
     C     endgrp        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for Kundekategori
      * ------------------------------------------
      *
     C     subkka        begsr
     C                   eval      *in98 = *on
     C                   move      sfkkat        alf4
      *
     C     1             do        999           n
      *
     C                   if        kka(n) = *blank
     C                   goto      endkka
     C                   endif
      *
     C                   if        kka(n) = alf4
     C                   eval      *in98 = *off
     C                   goto      endkka
     C                   endif
      *
     C                   enddo
      *
     C     endkka        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for rabattkategori
      * ------------------------------------------
      *
     C     subrka        begsr
     C                   eval      *in98 = *on
     C                   move      sfrkat        alf3
      *
     C     1             do        999           n
      *
     C                   if        rka(n) = *blank
     C                   goto      endrka
     C                   endif
      *
     C                   if        rka(n) = alf3
     C                   eval      *in98 = *off
     C                   goto      endrka
     C                   endif
      *
     C                   enddo
      *
     C     endrka        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for distrikt
      * ------------------------------------------
      *
     C     subdis        begsr
     C                   eval      *in98 = *on
     C                   move      sfdist        alf4
      *
     C     1             do        999           n
      *
     C                   if        dis(n) = *blank
     C                   goto      enddis
     C                   endif
      *
     C                   if        dis(n) = alf4
     C                   eval      *in98 = *off
     C                   goto      enddis
     C                   endif
      *
     C                   enddo
      *
     C     enddis        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for selger ordre
      * ------------------------------------------
      *
     C     subsel        begsr
     C                   eval      *in98 = *on
     C                   move      sfselg        alf4
      *
     C     1             do        999           n
      *
     C                   if        sel(n) = *blank
     C                   goto      endsel
     C                   endif
      *
     C                   if        sel(n) = alf4
     C                   eval      *in98 = *off
     C                   goto      endsel
     C                   endif
      *
     C                   enddo
      *
     C     endsel        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for land
      * ------------------------------------------
      *
     C     sublan        begsr
     C                   eval      *in98 = *on
     C                   move      sfland        alf3
      *
     C     1             do        999           n
      *
     C                   if        lan(n) = *blank
     C                   goto      endlan
     C                   endif
      *
     C                   if        lan(n) = alf3
     C                   eval      *in98 = *off
     C                   goto      endlan
     C                   endif
      *
     C                   enddo
      *
     C     endlan        endsr
      /space 2
      *
      * ------------------------------------------
      * Subrutine for selger kasse
      * ------------------------------------------
      *
     C     subsek        begsr
     C                   eval      *in98 = *on
     C                   move      sfksel        alf4
      *
     C     1             do        999           n
      *
     C                   if        sek(n) = *blank
     C                   goto      endsek
     C                   endif
      *
     C                   if        sek(n) = alf4
     C                   eval      *in98 = *off
     C                   goto      endsek
     C                   endif
      *
     C                   enddo
      *
     C     endsek        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for varenummer fra / til
      * ------------------------------------------
      *
     C     subvnr        begsr
     C                   eval      *in98 = *on
      *
     C     1             do        10            n
      *
     C                   if        spfvar(n) = *blank
     C                   goto      endvnr
     C                   endif
      *
     C                   if        spfvar(n) <= sfvare
     C                   if        sptvar(n) >= sfvare
     C                   eval      *in98 = *off
     C                   goto      endvnr
     C                   endif
     C                   endif
      *
     C                   enddo
      *
     C     endvnr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for kundenummer fra / til
      * ------------------------------------------
      *
     C     subknr        begsr
     C                   eval      *in98 = *on
      *
     C                   if        sfvkun = *zeros
      *                  movel     sfkund        wknr
     C                   movel     sffkun        wknr
     C                   else
     C                   movel     sfvkun        wknr
     C                   endif
      *
     C     1             do        10            n
      *
     C                   if        spfkun(n) = *blank
     C                   goto      endknr
     C                   endif
      *
     C                   if        spfkun(n) <= wknr
     C                   if        sptkun(n) >= wknr
     C                   eval      *in98 = *off
     C                   goto      endknr
     C                   endif
     C                   endif
      *
     C                   enddo
      *
     C     endknr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for Kundeprosjekt fra / til
      * ------------------------------------------
     *
     C     sublad        begsr
     C                   eval      *in98 = *on
     *
     C                   movel     sfkpro        wkpro
     *
     C     1             do        10            n
     *
     C                   if        spflad(n) = *zeros
     C                   goto      endlad
     C                   endif
     *
     C                   if        spflad(n) <= wkpro
     C                   if        sptlad(n) >= wkpro
     C                   eval      *in98 = *off
     C                   goto      endlad
     C                   endif
     C                   endif
      *
     C                   enddo
      *
     C     endlad        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for periode fra / til
      * ------------------------------------------
      *
     C     subper        begsr
      *
     C                   eval      *in98 = *on
      *
     C                   if        spfper <= w_peri
     C                   if        sptper >= w_peri
     C                   eval      *in98 = *off
     C                   endif
     C                   endif
      *
     C                   endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for fakturanr/kreditnotanr
      * ------------------------------------------
      *
     c     subfnr        begsr
     c                   eval      *in98 = *on
      *
     c                   if        spffak <= sfbinr
     c                   if        sptfak >= sfbinr
     c                   eval      *in98 = *off
     c                   endif
     c                   endif
      *
     c                   if        spfkre <= sfbinr
     c                   if        sptkre >= sfbinr
     c                   eval      *in98 = *off
     c                   endif
     c                   endif
      *
     c                   endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for fakturadato  fra / til
      * ------------------------------------------
      *
     C     subfda        begsr
     C                   eval      *in98 = *on
     C                   move      sfbida        wwbida
     C                   if        spffda <= wwbida
     C                   if        spftda >= wwbida
     C                   eval      *in98 = *off
     C                   endif
     C                   endif
      *
     C                   endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for ordretype
      * ------------------------------------------
      *
     C     suboty        begsr
     C                   eval      *in98 = *on
     C                   move      sfotyp        alf2
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        oty(n) = *blank
     C                   goto      endoty
     C                   endif
      *                                                                  .
     C                   if        oty(n) = alf2
     C                   eval      *in98 = *off
     C                   goto      endoty
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endoty        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for avdeling
      * ------------------------------------------
      *
     C     subavd        begsr
     C                   eval      *in98 = *on
     C                   move      sfsavd        alf4
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        avd(n) = *blank
     C                   goto      endavd
     C                   endif
      *                                                                  .
     C                   if        avd(n) = alf4
     C                   eval      *in98 = *off
     C                   goto      endavd
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endavd        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for lager
      * ------------------------------------------
      *
     C     sublag        begsr
     C                   eval      *in98 = *on
     C                   move      sflage        alf2
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        lag(n) = *blank
     C                   goto      endlag
     C                   endif
      *                                                                  .
     C                   if        lag(n) = alf2
     C                   eval      *in98 = *off
     C                   goto      endlag
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endlag        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for produktansvarlig
      * ------------------------------------------
      *
     C     subpra        begsr
     C                   eval      *in98 = *on
     C                   move      sfpran        alf5
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        pra(n) = *blank
     C                   goto      endpra
     C                   endif
      *                                                                  .
     C                   if        pra(n) = alf5
     C                   eval      *in98 = *off
     C                   goto      endpra
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endpra        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for kampanje
      * ------------------------------------------
      *
     C     subkam        begsr
     C                   eval      *in98 = *on
      *
     C                   if        spkamp = sfkamp
     C                   eval      *in98 = *off
     C                   goto      endkam
     C                   endif
      *
     C     endkam        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for leveringstype
      * ------------------------------------------
      *
     C     sublty        begsr
     C                   eval      *in98 = *on
     C                   move      sflety        alf1
      *
     C     1             do        9             n
      *                                                                  .
     C                   if        lty(n) = *blank
     C                   goto      endlty
     C                   endif
      *                                                                  .
     C                   if        lty(n) = alf1
     C                   eval      *in98 = *off
     C                   goto      endlty
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endlty        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for leverandør
      * ------------------------------------------
      *
     C     sublev        begsr
     C                   eval      *in98 = *on
     C                   move      sfldor        alf6
      *
     C     1             do        999           n
      *                                                                  .
     C                   if        lev(n) = *blank
     C                   goto      endlev
     C                   endif
      *                                                                  .
     C                   if        lev(n) = alf6
     C                   eval      *in98 = *off
     C                   goto      endlev
     C                   endif
      *                                                                  .
     C                   enddo
      *
     C     endlev        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     *inzsr        begsr
      *
      * Key for lesing av statistikk
      *
     c     sstal1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    sstal1_paar
      *
      * Key for oppslag på vare-enhet
      *
     c     vvenl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl1_vare
      *
      * Key for oppslag på vareregister
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for kunderegister
      *
     C     rkunl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    rkunl1_kund
      *
     C     *entry        plist
     C                   parm                    dstype           10
     C                   parm                    dskode            1
     *
     C                   eval      ty00 = *blank
     C                   eval      wknr = *blank
     C                   eval      alf2 = *blank
     C                   eval      alf3 = *blank
     C                   eval      alf4 = *blank
     C                   eval      swsrt1 = *blank
     C                   eval      swsrt2 = *blank
     C                   eval      swsrt3 = *blank
     C                   eval      rpt01 = *blank
     C                   eval      rpt02 = *blank
     C                   eval      rpt03 = *blank
     C                   eval      styp = *zero
     C                   eval      n = *zero
     C                   eval      v = *zero
     C                   eval      whkk = *zero
     C                   eval      w_lest = *zero
     C                   eval      w_valgt = *zero
      *
     c                   eval      w_firm = l_firm
     c                   eval      w_spfirm = l_firm
     c                   eval      w_sptype = dstype
     c                   eval      wwohug = *zeros
      *
     C                   time                    umtid
     C                   move      umtime        tid
      *
      /eject
      *
      * -------------------------
      * Hent inn parameterposter
      * -------------------------
      *
     C                   eval      w_spfirm = l_firm
     C                   eval      w_sptype = dstype
     c                   eval      w_spkode = *zeros
     c                   eval      w_spvalg = *blank
     c***  skpwpf_key    setll     skpwpf
      *
     C     nyles         tag
      *
     C                   eval      styp = spkode
     C                   read      skpwpf                                 10
     C                   if        *in10 = *on
     C                   goto      pslut
     C                   endif
      *
      * Sjekk riktig firma
      *
     C                   if        spfirm  > l_firm
     C                   goto      pslut
     C                   endif
      *
      * Sjekk riktig kode
      *
     C                   if        sptype  > dstype
     C                   goto      pslut
     C                   endif
      *
     C                   if        styp <> spkode
     C                   eval      n = 0
     C                   endif
      *
     C                   eval      n = n + 1
      *
      * TYPE 00
      * -------
      *
     C                   if        spkode = 00
     C                   move      'J'           ty00
      *
      * Skriv heading på
      * kvitteringsliste
      *
     c                   write     hd1a                                 30
      *
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
      * Test om etiketter skal skrives
      *
     c                   if        dskode = 'E'
     C                   eval      r1 = 32
     C                   eval      r2 = 0
     C                   eval      r3 = 0
     c                   endif
      *
      * Test sorteringsbegrep
      *
     C                   eval      *in11 = r1 = 11
     C                   eval      *in12 = r1 = 12
     C                   eval      *in13 = r1 = 13
     C                   eval      *in60 = r1 = 14
     C                   eval      *in61 = r1 = 15
     C                   eval      *in62 = r1 = 16
     C                   eval      *in14 = r1 = 21
     C                   eval      *in15 = r1 = 22
     C                   eval      *in16 = r1 = 23
     C                   eval      *in17 = r1 = 24
     C                   eval      *in18 = r1 = 25
     C                   eval      *in35 = r1 = 27
     C                   eval      *in19 = r1 = 31
     C                   eval      *in20 = r1 = 32
     C                   eval      *in21 = r1 = 41
     C                   eval      *in22 = r1 = 42
     C                   eval      *in23 = r1 = 43
     C                   eval      *in24 = r1 = 51
     C                   eval      *in25 = r1 = 52
     C                   eval      *in26 = r1 = 53
     C                   eval      *in27 = r1 = 26
     C                   eval      *in28 = r1 = 54
     C                   eval      *in29 = r1 = 33
     C                   eval      *in31 = r1 = 55
     C                   eval      *in32 = r1 = 56
     C                   eval      *in33 = r1 = 57
      *
     C                   eval      *in41 = r2 = 11
     C                   eval      *in42 = r2 = 12
     C                   eval      *in43 = r2 = 13
     C                   eval      *in63 = r2 = 14
     C                   eval      *in64 = r2 = 15
     C                   eval      *in65 = r2 = 16
     C                   eval      *in44 = r2 = 21
     C                   eval      *in45 = r2 = 22
     C                   eval      *in46 = r2 = 23
     C                   eval      *in47 = r2 = 24
     C                   eval      *in48 = r2 = 25
     C                   eval      *in36 = r2 = 27
     C                   eval      *in49 = r2 = 31
     C                   eval      *in50 = r2 = 32
     C                   eval      *in51 = r2 = 41
     C                   eval      *in52 = r2 = 42
     C                   eval      *in53 = r2 = 43
     C                   eval      *in54 = r2 = 51
     C                   eval      *in55 = r2 = 52
     C                   eval      *in56 = r2 = 53
     C                   eval      *in57 = r2 = 26
     C                   eval      *in58 = r2 = 54
     C                   eval      *in59 = r2 = 33
     C                   eval      *in69 = r2 = 55
     C                   eval      *in70 = r2 = 56
     C                   eval      *in34 = r2 = 57
      *
     C                   eval      *in71 = r3 = 11
     C                   eval      *in72 = r3 = 12
     C                   eval      *in73 = r3 = 13
     C                   eval      *in66 = r3 = 14
     C                   eval      *in67 = r3 = 15
     C                   eval      *in68 = r3 = 16
     C                   eval      *in74 = r3 = 21
     C                   eval      *in75 = r3 = 22
     C                   eval      *in76 = r3 = 23
     C                   eval      *in77 = r3 = 24
     C                   eval      *in78 = r3 = 25
     C                   eval      *in37 = r3 = 27
     C                   eval      *in79 = r3 = 31
     C                   eval      *in80 = r3 = 32
     C                   eval      *in81 = r3 = 41
     C                   eval      *in82 = r3 = 42
     C                   eval      *in83 = r3 = 43
     C                   eval      *in84 = r3 = 51
     C                   eval      *in85 = r3 = 52
     C                   eval      *in86 = r3 = 53
     C                   eval      *in87 = r3 = 26
     C                   eval      *in88 = r3 = 54
     C                   eval      *in89 = r3 = 33
     C                   eval      *in90 = r3 = 55
     C                   eval      *in91 = r3 = 56
     C                   eval      *in92 = r3 = 57
      *
      * Ta vare på felt for utskrift
      *
     C                   eval      wr1 = r1
     C                   eval      wr2 = r2
     C                   eval      wr3 = r3
     C                   eval      wpsp1 = psp1
     C                   eval      wpsp2 = psp2
     C                   eval      wpsp3 = psp3
     C                   eval      wpsp4 = psp4
     C                   eval      wpsp5 = psp5
     C                   eval      wpnytt = psnytt
      *
     C                   endif
      *
      /eject
      *
      * TYPE 11 - Hovedgruppe
      * -------
      *
     C                   if        spkode = 11
     C                   move      11            v
     C                   move      spahgr        hhgr(n)
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr11                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 12 - Undergruppe
      * -------
      *
     C                   if        spkode = 12
     C                   move      12            v
     C                   move      spahgr        uhgr(n)
     C                   move      spaugr        uugr(n)
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr12                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 13 - Rabattgruppe
      * -------
      *
     C                   if        spkode= 13
     C                   move      13            v
     C                   move      'J'           utv(v)
     C                   move      sprgrp        rgr(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr13                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 14 - Overgruppe  (Nobb)
      * -------
      *
     C                   if        spkode = 14
     C                   move      14            v
     C                   move      spogrp        oogp(n)
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr14                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 15 - Hovedgruppe
      * -------
      *
     C                   if        spkode = 15
     C                   move      15            v
     C                   move      spogrp        hogp(n)
     C                   move      sphgrp        hhgp(n)
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr15                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 16 - Undergruppe
      * -------
      *
     C                   if        spkode = 16
     C                   move      16            v
     C                   move      spogrp        uogp(n)
     C                   move      sphgrp        uhgp(n)
     C                   move      spugrp        uugp(n)
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr16                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 21 - Kundekategori
      * -------
      *
     C                   if        spkode = 21
     C                   move      21            v
     C                   move      'J'           utv(v)
     C                   move      spkkat        kka(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr21                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 22 - Rabattkategori
      * -------
      *
     C                   if        spkode = 22
     C                   move      22            v
     C                   move      'J'           utv(v)
     C                   move      sprkat        rka(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr22                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
4    C                   goto      nyles
     C                   endif
      *
      * TYPE 23 - Distrikt
      * -------
      *
     C                   if        spkode = 23
     C                   move      23            v
     C                   move      'J'           utv(v)
     C                   move      spdist        dis(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr23                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 24 - Selger ordre
      * -------
      *
     C                   if        spkode = 24
     C                   move      24            v
     C                   move      'J'           utv(v)
     C                   move      spselg        sel(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr24                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 25 - Land
      * -------
      *
     C                   if        spkode = 25
     C                   move      25            v
     C                   move      'J'           utv(v)
     C                   move      spland        lan(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr25                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 27 - Selger kasse
      * -------
      *
     C                   if        spkode = 27
     C                   move      27            v
     C                   move      'J'           utv(v)
     C                   move      spksel        sek(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr27                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPER 31-32-33-41-42-43-44 INNEHOLDER KUN EN RECORD
      * OG KOMMER AUTOMATISK MED VED READ AV PARAM.
      * ---------------------------------------------
      *
      * TYPE 31 - Varenummer
      * -------
      *
     C                   if        spkode = 31
     C                   move      31            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   eval      wwfva1 = spfvar(1)
     C                   eval      wwfva2 = spfvar(2)
     C                   eval      wwfva3 = spfvar(3)
     C                   eval      wwfva4 = spfvar(4)
     C                   eval      wwfva5 = spfvar(5)
     C                   eval      wwfva6 = spfvar(6)
     C                   eval      wwfva7 = spfvar(7)
     C                   eval      wwfva8 = spfvar(8)
     C                   eval      wwfva9 = spfvar(9)
     C                   eval      wwfva0 = spfvar(10)
     C                   eval      wwtva1 = sptvar(1)
     C                   eval      wwtva2 = sptvar(2)
     C                   eval      wwtva3 = sptvar(3)
     C                   eval      wwtva4 = sptvar(4)
     C                   eval      wwtva5 = sptvar(5)
     C                   eval      wwtva6 = sptvar(6)
     C                   eval      wwtva7 = sptvar(7)
     C                   eval      wwtva8 = sptvar(8)
     C                   eval      wwtva9 = sptvar(9)
     C                   eval      wwtva0 = sptvar(10)
     C                   write     pr31a                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   write     pr31b                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   write     pr31c                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   write     pr31d                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 32 - Kundenummer
      * -------
      *
     C                   if        spkode = 32
     C                   move      32            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   eval      wwfku1 = spfkun(1)
     C                   eval      wwfku2 = spfkun(2)
     C                   eval      wwfku3 = spfkun(3)
     C                   eval      wwfku4 = spfkun(4)
     C                   eval      wwfku5 = spfkun(5)
     C                   eval      wwfku6 = spfkun(6)
     C                   eval      wwfku7 = spfkun(7)
     C                   eval      wwfku8 = spfkun(8)
     C                   eval      wwfku9 = spfkun(9)
     C                   eval      wwfku0 = spfkun(10)
     C                   eval      wwtku1 = sptkun(1)
     C                   eval      wwtku2 = sptkun(2)
     C                   eval      wwtku3 = sptkun(3)
     C                   eval      wwtku4 = sptkun(4)
     C                   eval      wwtku5 = sptkun(5)
     C                   eval      wwtku6 = sptkun(6)
     C                   eval      wwtku7 = sptkun(7)
     C                   eval      wwtku8 = sptkun(8)
     C                   eval      wwtku9 = sptkun(9)
     C                   eval      wwtku0 = sptkun(10)
     C                   write     pr32a                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   write     pr32b                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 33 - Kundeprosjekt
      * -------
      *
     C                   if        spkode = 33
     C                   move      33            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
      *
     C                   eval      wwfla1 = spflad(1)
     C                   eval      wwfla2 = spflad(2)
     C                   eval      wwfla3 = spflad(3)
     C                   eval      wwfla4 = spflad(4)
     C                   eval      wwfla5 = spflad(5)
     C                   eval      wwfla6 = spflad(6)
     C                   eval      wwfla7 = spflad(7)
     C                   eval      wwfla8 = spflad(8)
     C                   eval      wwfla9 = spflad(9)
     C                   eval      wwfla0 = spflad(10)
     C                   eval      wwtla1 = sptlad(1)
     C                   eval      wwtla2 = sptlad(2)
     C                   eval      wwtla3 = sptlad(3)
     C                   eval      wwtla4 = sptlad(4)
     C                   eval      wwtla5 = sptlad(5)
     C                   eval      wwtla6 = sptlad(6)
     C                   eval      wwtla7 = sptlad(7)
     C                   eval      wwtla8 = sptlad(8)
     C                   eval      wwtla9 = sptlad(9)
     C                   eval      wwtla0 = sptlad(10)
     C                   write     pr33a                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   write     pr33b                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 41 - Periode
      * -------
      *
     C                   if        spkode = 41
     C                   move      41            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr41                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 42 - Fakturanummer
      * -------
      *
     C                   if        spkode = 42
     C                   move      42            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr42                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 43 - Fakturadato
      * -------
      *
     C                   if        spkode = 43
     C                   move      43            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr43                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 44 - Kampanje
      * -------
      *
     C                   if        spkode = 44
     C                   move      44            v
     C                   move      'J'           utv(v)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr44                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 51 - Ordretype
      * -------
      *
     C                   if        spkode = 51
     C                   move      51            v
     C                   move      'J'           utv(v)
     C                   move      spotyp        oty(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr51                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 52 - Avdeling
      * -------
      *
     C                   if        spkode = 52
     C                   move      52            v
     C                   move      'J'           utv(v)
     C                   move      spavde        avd(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr52                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 53 - Lager
      * -------
      *
     C                   if        spkode = 53
     C                   move      53            v
     C                   move      'J'           utv(v)
     C                   move      splage        lag(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr53                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
4    C                   goto      nyles
     C                   endif
      *
      * TYPE 54 - Produktansvarlig
      * -------
      *
     C                   if        spkode = 54
     C                   move      54            v
     C                   move      'J'           utv(v)
     C                   move      sppran        pra(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr54                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 55 - Leveringstype
      * -------
      *
     C                   if        spkode = 55
     C                   move      55            v
     C                   move      'J'           utv(v)
     C                   move      splety        lty(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr55                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 56 - Leverandør
      * -------
      *
     C                   if        spkode = 56
     C                   move      56            v
     C                   move      'J'           utv(v)
     C                   move      splevr        lev(n)
     C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
     C                   endif
     C                   write     pr56                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
     C                   goto      nyles
      *
      /eject
      *
     C     pslut         tag
      *
     C                   if        ty00 <> 'J'
     C                   goto      xtrans
     C                   endif
      *
      * Skriv kvittering for sumnivåer
      *
     C                   write     pr00                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
     C                   if        wpsp1 = *blank
     C                   if        wr1 <> *zero
     C                   move      rpt(wr1)      rpt01
     C                   endif
     C                   write     pr01                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   endif
      *
     C                   if        wpsp2 = *blank
     C                   if        wr2 <> *zero
     C                   move      rpt(wr2)      rpt02
     C                   endif
     C                   write     pr02                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   endif
      *
     C                   if        wpsp3 = *blank
     C                   if        wr3 <> *zero
     C                   move      rpt(wr3)      rpt03
     C                   endif
     C                   write     pr03                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   endif
      *
     C                   if        wpsp4 = *blank
     C                   write     pr04                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   endif
      *
     C                   if        wpsp5 = *blank
     C                   write     pr05                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   endif
      *
     C                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * ERROR-rutine                                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     heading       begsr
      *
     C                   write     HD2A                                 30
      *
     C                   if        *in30 = *on
     C                   exsr      overflow
     C                   endif
      *
     C                   endsr
      *
     c/space 3
      *
     C     overflow      BEGSR
      *
      * Skriv heading på
      * kvitteringsliste
      *
     C                   write     HD1A
      *
     C                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tar inn parameter fra forrige program                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
**       GRUPPER SOM KAN SELEKTERES
 Ledig                      01
 Ledig                      02
 Ledig                      03
 Ledig                      04
 Ledig                      05
 Ledig                      06
 Ledig                      07
 Ledig                      08
 Ledig                      09
 Ledig                      10
 Alt. hovedgruppe           11
 Alt. undergruppe           12
 Rabattgrp.                 13
 Overgruppe                 14
 Hovedgruppe                15
 Undergruppe                16
 Ledig                      17
 Ledig                      18
 Ledig                      19
 Ledig                      20
 Kundekategori              21
 Rabattkateg.               22
 Distrikt                   23
 Selger ordre               24
 Land                       25
 Hovedgr.-kundekategori     26
 Selger kasse               27
 Ledig                      28
 Ledig                      29
 Ledig                      30
 Varenummer                 31
 Kund                       32
 Kundeprosjekt              33
 Ledig                      34
 Ledig                      35
 Ledig                      36
 Ledig                      37
 Ledig                      38
 Ledig                      39
 Ledig                      40
 Periode                    41
 Faktnr/Krednr              42
 Fakturadato                43
 Kampanje                   44
 Ledig                      45
 Ledig                      46
 Ledig                      47
 Ledig                      48
 Ledig                      49
 Ledig                      50
 Ordretype                  51
 Avdeling                   52
 Lager                      53
 Produktansvarlig           54
 Leveringstype              55
 Leverandør                 56
 Time                       57
 Ledig                      58
 Ledig                      59
 Ledig                      60
