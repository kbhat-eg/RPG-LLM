     /TITLE       Utskrift av etiketter fra radioterminal
     H DATEDIT(*DMY) OPTION(*NODEBUGIO)
     * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
     *                                                                       *
     * System. . . . . : ASOFAK                                              *
     * Program . . . . : FP250R                                              *
     * Beskrivelse . . : Utskrift av etiketter, parameter                    *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                       *
     * Spesialversjon. :                                                     *
     * Tilpasset for . :                                                     *
     *                                                                       *
     * Ref.   Dato  Sign Endringsbeskrivelse                               n *
     * ----- ------ ---- ------------------------------------------------- --*
     * V5.40 080306 KOB  Lagt inn priskode i skjermbildet                    *
     * V5.60 210109 KOB  Oppdatert info om printer og etikettyper            *
6.20 *  6.20 300715 bsa  Lagt inn mulighet for valg av tilbudspris           *
     *                   Lagt inn på nytt av ASK på ver. 6.30                *
     *                                                                       *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * *
     *
     Ffp250d    cf   e             workstn
     Fvfaspf    if   e           k disk
     Fparam     o  a f  128        disk
     *
     *
     *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *               :  LOCAL DATA AREA                                 +
     *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     *
     D                uds
     D l_etyp                111    111  0
     D l_etpr                112    112  0
     D l_ken1                113    113  0
     D l_ken2                114    114  0
     D l_dato                115    120  0
     D l_sort                121    121  0
     *
     D l_ruti                800    809
     D l_user                911    920
     D l_firm                944    946  0
     D l_fnav                951    980
      *
      * Definering av variable
      *
     D wpin03          s              1
     D w_firm          s              3  0
     d w_dato          s               d   datfmt(*iso)
     D w_anta          s              1  0 inz(1)
     D p_vare          s             15
     *
     *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *          C   A   L   C   U   L   A   T   I   O   N               +
     *
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *  A1BLD, Rutinen behandler utvalggstype                          +
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     C     a1tag         tag
     *
     C                   except    add001
     *
     C     b1tag         tag
     *
     *  Blanker felt som benyttes
     *
     C                   eval      b1etyp = vnetyp
     *
     C     b1taga        tag
     *
     C                   exfmt     b1bld
     *
B001 C                   if        *inkc = *on
 001 C                   move      '1'           wpin03
 001 C                   goto      slutt
E001 C                   endif
     *
     * Sjekk om riktig etikett-type
     *
B001 C                   if        b1etyp <> 0 and
 001 C                             b1etyp <> 1 and
 001 C                             b1etyp <> 2 and
 001 C                             b1etyp <> 3 and
 001 C                             b1etyp <> 4 and
 001 C                             b1etyp <> 5 and
 001 C                             b1etyp <> 6 and
 001 C                             b1etyp <> 7 and
 001 C                             b1etyp <> 8
 001 C                   goto      b1taga
E001 C                   endif
     *
     * Sjekk om riktig priskode
     *
B001 C                   if        b1etpr <> 1 and
6.20 C                             b1etpr <> 2 and
6.20 c                             b1etpr <> 3
 001 C                   goto      b1taga
E001 C                   endif
     *
     * Oppdater local
     *
     C                   eval      l_etyp = b1etyp
     C                   eval      l_etpr = b1etpr
     C                   eval      l_sort = vnsort
     C                   eval      l_ken1 = 1
     C                   eval      l_ken2 = 2
     C     *dmy          move      w_dato        l_dato
     *
     * Sjekker hvilket utskriftsprogram som skal benyttes
     *
 001 C                   move      *blanks       l_ruti
     *
     * Prisetikett
     *
B001 C                   if        l_etyp = 1
 001 C                   movel     'FP213 '      l_ruti
E001 C                   endif
     *
     * Hylle-etikett   75x28 mm
     *
B001 C                   if        l_etyp = 2
 001 C                   movel     'FP214 '      l_ruti
E001 C                   endif
     *
     *  Hylle-etikett  100x28 mM
     *
B001 C                   if        l_etyp = 3
 001 C                   movel     'FP215 '      l_ruti
E001 C                   endif
     *
     * Reol-etikett  202x60 mm
     *
B001 C                   if        l_etyp = 4
 001 C                   movel     'FP216 '      l_ruti
E001 C                   endif
     *
     * Hylle-etikett   76x39 mm
     *
B001 C                   if        l_etyp = 5
 001 C                   movel     'FP217 '      l_ruti
E001 C                   endif
     *
     * Hylle-etikett   48x38 mm
     *
B001 C                   if        l_etyp = 6
 001 C                   movel     'FP218 '      l_ruti
E001 C                   endif
     *
     * Hylle-etikett  100x38 mm
     *
B001 C                   if        l_etyp = 7
 001 C                   movel     'FP219 '      l_ruti
E001 C                   endif
     *
     * Reol-etikett   210x60 mm
     *
B001 C                   if        l_etyp = 8
 001 C                   movel     'FP220 '      l_ruti
E001 C                   endif
     *
     * Hylle-etikett   76x39 mm  Laser/Interform
     *
B001 C                   if        l_etyp = 9
 001 C                   movel     'FP221 '      l_ruti
E001 C                   endif
     *
B001 C                   if        *inkd = *on
 001 C                   eval      *inu2 = *on
E001 C                   endif
     *
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *  END OF JOB                                                     +
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     C     slutt         tag
     *
     C                   eval      *inlr = *on
     *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for initiering av program                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     *inzsr        begsr
     *
     C                   time                    w_dato
     *
     C                   move      l_firm        w_firm
     *
     * Parameterliste
     *
     C     *entry        plist
     C                   parm                    wpin03
     C                   parm                    p_vare
     *
     C                   move      0             wpin03
     *
     * Hent etikettinformasjon
     *
     C     vfaspf_key    chain     vfaspf                             60
B001 C                   if        *in60 = *on
 001 C                   move      1             b1etyp
X001 C                   else
 001 C                   move      vnetyp        b1etyp
E001 C                   endif
     *
 001 C                   eval      b1etpr = 2
     *
     * Key for faste data etiketter
     *
     C     vfaspf_key    klist
     C                   kfld                    w_firm
     *
     C                   endsr
     *
     Oparam     eadd         add001
     O                                            1 'A'
     O                       w_firm               4
     O                       p_vare              19
     O                       w_anta              20
