# Program Overview  
This RPG ILE program (`jl110R`) runs on AS/400 (V7.00+) and provides a GUI-based maintenance screen for supplier contact persons. It presents a subfile listing, lets the user create, view, update, copy or delete contact‐person records.

---

## Files & Data Structures  
- **Files**  
  - `JLEVL1`, `JLKPL1`, `JLKPLR`, `JLKPLU`  
    • Supplier-level files keyed by supplier (`JL Ldor`) and telephone number (`JK Ptel`).  
  - `FJL110D` (workstn, subfile B1SFL/B2CTL, feedback DS `dspfbk`)  

- **Data Areas**  
  - UDS (`l_user`, `l_firm`, `l_fnav`): holds user/LDA values  
  - DS `dspfbk.d_fcrn`: receives relative record number from display  
  - Working vars for subfile paging (e.g. `w_fcrn`, `w_spge`, `w_srrn`, `w_ssrn`)  
  - Flags/indicators (`b_oppr`, `b_forn`, `b_anul`, etc.)  

- **Indicators** (brief)  
  - LR: end program  
  - 10/11: roll up/down  
  - 12–15: subfile display/control/clear/end  
  - 21: Home key  
  - 22: cursor positioning  
  - 30–99: field protection, error/work indicators  

---

## Main Processing Loop (B2CTL)  
1. **Initial Display (`b2taga`)**  
   - Write B2CMD record  
2. **Bare‐data refresh (`b2tagb`)**  
   - Calls `dsp_subfile` to load and show the subfile  
3. **Function‐key Handling**  
   - F3 (Exit): go to `avslutt` → set *INLR  
   - F5 (Refresh): call `forny` → reload subfile  
   - F10/F11: page up/down via `crt_subfile` / `bck_subfile`  
   - F21: set cursor positioning indicator  
4. **Cursor Positioning**  
   - If user enters RRN (B2PTEL ≠ 0), call `posisjoner`  
5. **Subfile Actions**  
   - Otherwise, handle subfile entries via `subfile` subroutine  

---

## Subroutine Summaries  

### 1. `forny` – Refresh subfile  
- Rechains to the record at `w_fcrn` if set  
- Clears and rebuilds subfile  

### 2. `posisjoner` – Direct positioning  
- Uses B2PTEL to set key for `JLKPL1`  
- Clears and recreates subfile, then resets B2PTEL  

### 3. `subfile` – Process each displayed row  
- Toggles indicator 22 (cursor blink)  
- Loops through displayed records (`READC B1SFL`)  
  • For each, checks `b1valg`:  
    – 2: Change → call `xc2bld`  
    – 3: Copy → call `xk1win`  
    – 4: Delete → call `xd1win`  
    – 5: View  → call `xc2bld` (read‐only)  
- After loop, if a refresh flag (`b_forn`) is on, calls `forny`  

### 4. `xc1bld` – New‐record key screen (C1BLD)  
- Captures new telephone (`C1PTEL`)  
- If exists (`JLKPLR` chain finds), show message screen (`xc1msg`)  
- Otherwise jump to `xc2bld` to enter full details  

### 5. `xc1msg` – Duplicate‐record warning (C1MSG)  
- Displays message asking to cancel or continue  
- Sets `b_anul` on Cancel  

### 6. `xc2bld` – Create/Change/View screen (C2BLD)  
- Loads existing values into C2 fields if found  
- For Copy (`b1valg=3`) retains original key in C1PTEL  
- For View (`p_valg=5`) sets **protected** indicators  
- Exformats screen, validates mandatory fields  
- On OK, chains `JLKPLUR` (update area), and either `UPDATE` or `WRITE`  
- Updates the subfile row display fields and flags refresh  

### 7. `xd1win` – Delete confirmation (D1WIN)  
- Chains record, shows D1WIN  
- On enter, deletes `JLKPLUR` record, sets `b_forn` to refresh  

### 8. `xk1win` – Copy record screen (K1WIN)  
- Presents a simple screen to input new telephone  
- Validates new key does not exist  
- On OK, calls `xc2bld` to edit full details using original via `s_ptel`  

### 9. `clr_subfile` – Clear subfile (B2CTL)  
- Writes control record with IN14 on  
- Resets subfile row counters (w_srrn, w_ssrn, w_spge)  

### 10. `crt_subfile` – Build next page of subfile  
- Reads `JLKPL1` sequentially until page size (`c_sfil=13`)  
- For each record matching current supplier (`w_ldor`), writes a B1SFL row  
- Updates w_ssrn, w_sfrn, w_virn for paging  

### 11. `bck_subfile` – Page backward  
- Positions set greater than last if needed, then backs up one page of keys  
- Calls clear & create to refresh display  

### 12. `dsp_subfile` – Display the subfile  
- Turns on indicators 12 (SFLDSP) / 13 (SFLDSPCTL) as needed  
- EXFMT B2CTL to show the screen, reads relative record number into w_fcrn  

### 13. `*INZSR` – Initialization  
- Entry parameters: `p_ldor` (supplier key), `p_valg` (mode)  
- Chains `JLEVL1` to fetch supplier name/key into B2CTL fields  
- Sets up `JLKPL1` setll and calls `crt_subfile` to populate first page  

---

This modular design cleanly separates screen logic, subfile paging, and CRUD operations via clearly named subroutines.