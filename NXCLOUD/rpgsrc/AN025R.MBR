     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Program . . . . : AN025R
      * Beskrivelse . . : Leser filegrupper for backup
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
5.31  * R5.31 270804 AMD  I gammel løsning lå filen for databibliotek
      *                   i biblioteket ADB.  I forbindelse med bruk
      *                   av miljø, ligger det en tilsvarende fil for
      *                   hvert miljø.  Det er derfor foretatt endringer
      *                   for å hente inn hvilke databibliotek som skal
      *                   være med på backup fra hvert miljø.
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
5.31 famill1    if   e           k disk    rename(amilpfr:amill1r)
      *                                                                     -
      * Definering av parametere
      *                                                                     -
     d p_savf          s              1
      *                                                                     -
      * Definering av variable i nøkler
      *                                                                     -
5.31 d amill1_milj     s                   like(armilj)
      *                                                                     -
      * Definering av variable
      *                                                                     -
     d w_alf6          s              6
5.31 d w_bibl          s             10
      *
      * ---------------------------------------------------------------
      * Filen som inneholder file-grupper leses fra start til slutt.
      * Inn til programmet kommer en parameter som forteller om det
      * skal benyttes savefiler eller ikke.  Verdien i variabelen er:
      *
      *      p_savf = 0  Savefile skal ikke benyttes
      *      p_savf = 1  Savefile skal benyttes
      *
      * For hver record som leses, sjekkes det om denne skal droppes
      * fra backup.  Dersom den skal være med kalles et Cl-program
      * med to parametere.  p_savf og w_bibl.
      *
      * CL- programmet bygger savefilen, dersom det skal gjøres,
      * eller biblioteket saves direkte, dersom det skal gjøres.
      * Kontrollen går så tilbake til dette programmet som leser neste
      * post i filen, helt til end of file.
      * ---------------------------------------------------------------
      *
      * Save av biblioteket ADB
      *
     c                   eval      w_bibl = *blank
     c                   movel     'ADB'         w_bibl
     c                   call      'AN025C'
     c                   parm                    p_savf
     c                   parm                    w_bibl
      *
      * Save av biblioteket QS36F
      *
     c                   eval      w_bibl = *blank
     c                   movel     'QS36F'       w_bibl
     c                   call      'AN025C'
     c                   parm                    p_savf
     c                   parm                    w_bibl
      *
      * Save av bibliotek fra filen for filegrupper
      *
5.31  ***                eval      w_bibl = *blank
5.31  ***                eval      afill1_fgrp = *blank
5.31  ***  afill1_key    setll     afill1
5.31  ***                read      afill1                                 62
5.31  *
5.31  ***                dow       *in62 = *off
5.31  ***                if        agback = *blank
5.31  ***                movel     'ADB'         w_alf6
5.31  ***                eval      %subst(w_alf6:4:3) = agfgrp
5.31  ***                movel     w_alf6        w_bibl
5.31  ***                call      'AN025C'
5.31  ***                parm                    p_savf
5.31  ***                parm                    w_bibl
5.31  ***                endif
5.31  ***                read      afill1                                 62
5.31  ***                enddo
5.31  *
5.31  * Henter opp et og et miljø for å finne hvilke
5.31  * databaser som skal være med på backup
5.31  *
5.31 c                   eval      amill1_milj = *blank
5.31 c     amill1_key    setll     amill1
5.31 c                   read      amill1
5.31  *
5.31 c                   dow       not %eof
5.31 c                   if        armilj <> *blank
5.31 c                   call      'AN027C'
5.31 c                   parm                    p_savf
5.31 c                   parm                    armilj
5.31 c                   endif
5.31 c                   read      amill1                                 62
5.31 c                   enddo
      *
      * Avslutt program
      *
     c                   eval      *inlr = *on
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      *
     c                   eval      w_alf6 = *blank
      *
      * Key for bibliotekslister
      *
5.31 c     amill1_key    klist
5.31 c                   kfld                    amill1_milj
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_savf
      *
     c                   endsr
      *
