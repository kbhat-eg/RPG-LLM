      /title  ASPGPL Fellesprogram for splitting av søkestring
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASPGPL
      * Program . . . . : AX720R
      * Beskrivelse . . : Sjekker om du kan ta F3 fra denne menyen.
      *
      *                   Parametre :
      *                   - Menynavn
      *                   - Statusindikator (0=F3 OK, 1=F3 ikke lov)
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       081113 bsa  Nytt program
6.20  *       241114 bsa  Utvider sjekk av startmany
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *       10 = Rollup
      *       11 = Rolldown
      *       12 = Sfldsp
      *       13 = Sfldspctl
      *       14 = Sflclr
      *       15 = Sflend
      *       21 = Home-key
      *       22 = Plassering av cursor
      *       30 = Protect av felter ved vise
      *    31-79 = Varsle m/feilmeldinger/skjermindikatorer
      *    80-99 = Arbeidsindikatorer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fausrl1    if   e           k disk    rename(ausrpfr:ausrl1r)
      *
      * Definering av parametre
      *
     d p_meny          s             10
     d p_stat          s              1
      *
      * Definering av variabler i nøkler
      *
     d ausrl1_user     s                   like(abuser)
      *
      * Definering av variable
      *
     d w_firm          s              3  0
     d w_srrn          s              4  0
     d w_meld          s             50
      *
      * Definering av local data area
      *
     d                uds
     d l_user                911    920
     d l_sfir                944    946  0
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogam
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      ausrl1_user = l_user
     c     ausrl1_key    chain     ausrl1
     c                   if        %found
6.20  * Hvis FSTART osv, endres reel menynavn
6.20 c                   if        %trim(abmeny) = 'FSTART'
6.20 c                   eval      abmeny = 'FM00     '
7.00 c                   elseif    %trim(abmeny) = 'FSTARTALL'
7.00 c                   eval      abmeny = 'FM00     '
7.00 c                   elseif    ((%trim(abmeny) = 'AM00C36') or
7.00 c                               (%trim(abmeny) = 'AM00SGR') or
7.00 c                               (%trim(abmeny) = 'AM00XLB') or
7.00 c                               (%trim(abmeny) = 'AM00H0M') or
7.00 c                               (%trim(abmeny) = 'AM00MGR')
7.00 c                               )
7.00 c                   eval      abmeny = 'FM00     '
6.20 c                   elseif    %trim(abmeny) = 'LSTART'
6.20 c                   eval      abmeny = 'LM00     '
6.20 c                   elseif    %trim(abmeny) = 'BSTART'
6.20 c                   eval      abmeny = 'BM00     '
6.20 c                   elseif    %trim(abmeny) = 'RSTART'
6.20 c                   eval      abmeny = 'RM00     '
6.20 c                   elseif    %trim(abmeny) = 'SSTART'
6.20 c                   eval      abmeny = 'SM00     '
6.20 c                   elseif    %trim(abmeny) = 'JSTART'
6.20 c                   eval      abmeny = 'JM00     '
6.20 c                   endif
      *
     c                   if        %trim(abmeny)<>*blank and
     c                             %trim(abmeny)=%trim(p_meny)
     c                   eval      p_stat = '1'
     c                   eval      w_meld = 'Dette er din første meny. ' +
     c                                      'F3 fungerer ikke   '
     c                   call      'AA005R'
     c                   parm                    w_meld
     c                   else
     c                   eval      p_stat = '0'
     c                   endif
     c                   else
     c                   eval      p_stat = '0'
     c                   endif
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_meny
     c                   parm                    p_stat
      *
      * Key for posisjonering på modul
      *
     c     ausrl1_key    klist
     c                   kfld                    ausrl1_user
      *
      * Initierer variable
      *
     c                   eval      p_stat = '0'
      *
     c                   endsr
