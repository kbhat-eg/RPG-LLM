     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : EK760R
      * Beskrivelse . . : Kunde bonus, kalkulerer bonus på vare
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       271005 HKO  Nytt program
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fekboi1    if   e           k disk    rename(ekbost:ekboi1r)
     fekboid    if   e           k disk    rename(ekbost:ekboidr)
     fekbei2    if   e           k disk    rename(ekbest:ekbei2r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvvasl1    if   e           k disk    rename(vvaspfr:vvasl1r)
     fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
      *
      * Definering av parametre
      *
     d p_firm          s                   like(ekfirm)
     d p_bkun          s                   like(ekbkun)
     d p_kund          s                   like(ekkund)
     d p_kpro          s                   like(ekkpro)
     d p_rkat          s                   like(ekrkat)
     d p_dato          s               d   datfmt(*iso)
     d p_vare          s                   like(ekvare)
     d p_enhe          s                   like(ekenhe)
     d p_lety          s                   like(eklety)
     d p_ldor          s                   like(ekldor)
     d p_sapr          s             11  2
     d p_bobe          s             11  2
      *
      * Definering av array
      *
     d a_boty          s              2    dim(99)
      *
      * Definering av variable i nøkler
      *
     d ekboi1_bkun     s                   like(ekbkun)
     d ekboi1_rkat     s                   like(ekrkat)
     d ekboi1_kund     s                   like(ekkund)
     d ekboi1_kpro     s                   like(ekkpro)
     d ekboi1_ogrp     s                   like(ekogrp)
     d ekboi1_hgrp     s                   like(ekhgrp)
     d ekboi1_ugrp     s                   like(ekugrp)
     d ekboi1_ldor     s                   like(ekldor)
     d ekboi1_modn     s                   like(ekmodn)
     d ekboi1_vare     s                   like(ekvare)
     d ekboi1_enhe     s                   like(ekenhe)
     d ekboi1_lety     s                   like(eklety)
     d ekboid_kund     s                   like(ekkund)
     d ekbei2_ebku     s                   like(ekebku)
     d ekbei2_erka     s                   like(ekerka)
     d ekbei2_ekun     s                   like(ekekun)
     d ekbei2_ekpr     s                   like(ekekpr)
     d ekbei2_eogr     s                   like(ekeogr)
     d ekbei2_ehgr     s                   like(ekehgr)
     d ekbei2_eugr     s                   like(ekeugr)
     d ekbei2_eldo     s                   like(ekeldo)
     d ekbei2_emod     s                   like(ekemod)
     d ekbei2_evar     s                   like(ekevar)
     d ekbei2_eenh     s                   like(ekeenh)
     d ekbei2_elet     s                   like(ekelet)
     d ekbei2_ebot     s                   like(ekebot)
     d ekbei2_efda     s                   like(ekefda)
     d ekbei2_etda     s                   like(eketda)
     d vvarl1_vare     s                   like(vvvare)
     d vvasl1_vare     s                   like(vvvare)
     d jvarl1_vare     s                   like(jvvare)
      *
      * Definering av variable
      *
     d b_bonu          s              1    inz(*off)
      *
     d w_paar          s              4  0
     d w_dato          s               d   datfmt(*iso)
     d w_dato_8        s              8
     d w_arnr          s              2  0
      *
     d w_firm          s                   like(ekfirm)
     d w_kund          s                   like(ekkund)
      *
     d s_bkun          s                   like(ekbkun)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Initierer output-parameter
      *
     c                   eval      p_bobe = 0
      *
      * Avbryter dersom det ikke mottas nok informasjon
      *
     c                   if        p_bkun = 0 or
     c                             p_vare = *blank or
     c                             p_sapr = 0
     c                   goto      avslutt
     c                   endif
      *
      * Henter vareinformasjon
      * Avbryter dersom vare er merket med at den ikke skal bonusberegnes,
      * eller dersom vare ikke finnes
      *
     c                   eval      vvkbon = 0
      *
     c                   eval      vvarl1_vare = p_vare
     c     vvarl1_key    chain     vvarl1
     c                   if        not %found
     c                   eval      vvasl1_vare = p_vare
     c     vvasl1_key    chain     vvasl1
     c                   if        not %found
     c                   eval      jvarl1_vare = p_vare
     c     jvarl1_key    chain     jvarl1
     c                   if        not %found
     c                   goto      avslutt
     c                   else
     c                   eval      vvvare = jvvare
     c                   eval      vvogrp = jvogrp
     c                   eval      vvhgrp = jvhgrp
     c                   eval      vvugrp = jvugrp
     c                   eval      vvnmod = jvmodn
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        vvkbon = 1
     c                   goto      avslutt
     c                   endif
      *
      * Utleder kunde
      *
     c                   if        p_kund <> 0
     c                   eval      w_kund = p_kund
     c                   else
     c                   eval      w_kund = p_bkun
     c                   endif
      *
      * Utleder år og dato fra input-dato
      *
     c                   if        p_dato <> *loval
     c                   eval      w_dato = p_dato
     c                   else
     c                   time                    w_dato
     c                   endif
      *
     c     *iso0         move      w_dato        w_dato_8
     c                   movel     w_dato_8      w_paar
      *
      * Finner og behandler bonusavtale
      * Leter først etter bonusavtale mot bonuskunde for så å lete etter
      * bonusavtale mot kunde/kundeprosjekt
      *
     c                   eval      ekboi1_bkun = p_bkun
     c     ekboi1_key2   chain     ekboi1
     c                   if        %found
     c                   exsr      kalk_bonus
     c                   goto      avslutt
     c                   endif
      *
     c                   eval      ekboid_kund = w_kund
     c     ekboid_key    setll     ekboid
     c     ekboid_key    reade     ekboid
     c                   dow       not %eof
     c                   if        ekbkun <> s_bkun
     c                   exsr      kalk_bonus
     c                   endif
     c                   eval      s_bkun = ekbkun
     c     ekboid_key    reade     ekboid
     c                   enddo
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Kalkulerer bonus for vare
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     kalk_bonus    begsr
      *
      * En vare kan ha bonus mot flere bonustyper og hver vare må derfor
      * behandles pr. nivå/bonustype
      * Takler ikke overlappende datointervall
      *
     c                   eval      w_arnr = 0
     c                   eval      a_boty(*) = *blank
      *
     c                   dou       b_bonu = *off
      *
     c                   eval      ekboi1_bkun = ekbkun
      *
     c                   exsr      bonusnivÅ
      *
     c                   if        b_bonu = *off
     c                   leavesr
     c                   endif
      *
     c                   eval      w_arnr = w_arnr + 1
     c                   eval      a_boty(w_arnr) = ekboty
     c                   eval      ekbei2_ebku = ekbkun
     c                   eval      ekbei2_erka = ekrkat
     c                   eval      ekbei2_ekun = ekkund
     c                   eval      ekbei2_ekpr = ekkpro
     c                   eval      ekbei2_eogr = ekogrp
     c                   eval      ekbei2_ehgr = ekhgrp
     c                   eval      ekbei2_eugr = ekugrp
     c                   eval      ekbei2_eldo = ekldor
     c                   eval      ekbei2_emod = ekmodn
     c                   eval      ekbei2_evar = ekvare
     c                   eval      ekbei2_eenh = ekenhe
     c                   eval      ekbei2_elet = eklety
     c                   eval      ekbei2_ebot = ekboty
     c                   eval      ekbei2_efda = ekfdat
     c                   eval      ekbei2_etda = ektdat
     c     ekbei2_key    chain     ekbei2
     c                   if        %found
     c                   eval(h)   p_bobe = p_bobe + (p_sapr * ekebpr / 100)
     c                   endif
      *
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å finne bonusnivå for vare
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bonusnivÅ     begsr
      *
     c                   eval      b_bonu = *off
      *
      * Dersom kunde/kundeprosjekt er funnet som et bonusnivå mot annen
      * kunde avbrytes bonusnivå-letingen etter at kunde/kundeprosjekt er
      * behandlet
      *
      * Nivårekkefølge:
      *
      *  Rabattkategori
      *    Kunde
      *      Kundeprosjekt
      *        Overgruppe
      *          Hovedgruppe
      *            Undergruppe
      *              Leverandør
      *                Modul
      *                  Vare
      *                    Enhet
      *                      Leveringstype
      *  _____________________
      *  - x x - - - - - x x x    1. Kunde,prosj,vare,enh,lt
      *  - x x - - - - - x - x    2. Kunde,prosj,vare,lt
      *  - x x - - - - - x x 0    3. Kunde,prosj,vare,enh,lt=0
      *  - x x - - - - - x - 0    4. Kunde,prosj,vare,lt=0
      *  - x x - - - - x - x x    5. Kunde,prosj,modul,enh,lt
      *  - x x - - - - x - - x    6. Kunde,prosj,modul,lt
      *  - x x - - - - x - x 0    7. Kunde,prosj,modul,enh,lt=0
      *  - x x - - - - x - - 0    8. Kunde,prosj,modul,lt=0
      *  - x x x x x x - - x x    9. Kunde,prosj,ogr,hgr,ugr,lev,enh,lt
      *  - x x x x x x - - - x   10. Kunde,prosj,ogr,hgr,ugr,lev,lt
      *  - x x x x x x - - x 0   11. Kunde,prosj,ogr,hgr,ugr,lev,enh,lt=0
      *  - x x x x x x - - - 0   12. Kunde,prosj,ogr,hgr,ugr,lev,lt=0
      *  - x x x x - x - - x x   13. Kunde,prosj,ogr,hgr,lev,enh,lt
      *  - x x x x - x - - - x   14. Kunde,prosj,ogr,hgr,lev,lt
      *  - x x x x - x - - x 0   15. Kunde,prosj,ogr,hgr,lev,enh,lt=0
      *  - x x x x - x - - - 0   16. Kunde,prosj,ogr,hgr,lev,lt=0
      *  - x x x - - x - - x x   17. Kunde,prosj,ogr,lev,enh,lt
      *  - x x x - - x - - - x   18. Kunde,prosj,ogr,lev,lt
      *  - x x x - - x - - x 0   19. Kunde,prosj,ogr,lev,enh,lt=0
      *  - x x x - - x - - - 0   20. Kunde,prosj,ogr,lev,lt=0
      *  - x x - - - x - - x x   21. Kunde,prosj,lev,enh,lt
      *  - x x - - - x - - - x   22. Kunde,prosj,lev,lt
      *  - x x - - - x - - x 0   23. Kunde,prosj,lev,enh,lt=0
      *  - x x - - - x - - - 0   24. Kunde,prosj,lev,lt=0
      *  - x x x x x - - - x x   25. Kunde,prosj,ogr,hgr,ugr,enh,lt
      *  - x x x x x - - - - x   26. Kunde,prosj,ogr,hgr,ugr,lt
      *  - x x x x x - - - x 0   27. Kunde,prosj,ogr,hgr,ugr,enh,lt=0
      *  - x x x x x - - - - 0   28. Kunde,prosj,ogr,hgr,ugr,lt=0
      *  - x x x x - - - - x x   29. Kunde,prosj,ogr,hgr,enh,lt
      *  - x x x x - - - - - x   30. Kunde,prosj,ogr,hgr,lt
      *  - x x x x - - - - x 0   31. Kunde,prosj,ogr,hgr,enh,lt=0
      *  - x x x x - - - - - 0   32. Kunde,prosj,ogr,hgr,lt=0
      *  - x x x - - - - - x x   33. Kunde,prosj,ogr,enh,lt
      *  - x x x - - - - - - x   34. Kunde,prosj,ogr,lt
      *  - x x x - - - - - x 0   35. Kunde,prosj,ogr,enh,lt=0
      *  - x x x - - - - - - 0   36. Kunde,prosj,ogr,lt=0
      *  - x x - - - - - - x x   37. Kunde,prosj,enh,lt
      *  - x x - - - - - - - x   38. Kunde,prosj,lt
      *  - x x - - - - - - x 0   39. Kunde,prosj,enh,lt=0
      *  - x x - - - - - - - 0   40. Kunde,prosj,lt=0

      *  - x - - - - - - x x x   41. Kunde,vare,enh,lt
      *  - x - - - - - - x - x   42. Kunde,vare,lt
      *  - x - - - - - - x x 0   43. Kunde,vare,enh,lt=0
      *  - x - - - - - - x - 0   44. Kunde,vare,lt=0
      *  - x - - - - - x - x x   45. Kunde,modul,enh,lt
      *  - x - - - - - x - - x   46. Kunde,modul,lt
      *  - x - - - - - x - x 0   47. Kunde,modul,enh,lt=0
      *  - x - - - - - x - - 0   48. Kunde,modul,lt=0
      *  - x - x x x x - - x x   49. Kunde,ogr,hgr,ugr,lev,enh,lt
      *  - x - x x x x - - - x   50. Kunde,ogr,hgr,ugr,lev,lt
      *  - x - x x x x - - x 0   51. Kunde,ogr,hgr,ugr,lev,enh,lt=0
      *  - x - x x x x - - - 0   52. Kunde,ogr,hgr,ugr,lev,lt=0
      *  - x - x x - x - - x x   53. Kunde,ogr,hgr,lev,enh,lt
      *  - x - x x - x - - - x   54. Kunde,ogr,hgr,lev,lt
      *  - x - x x - x - - x 0   55. Kunde,ogr,hgr,lev,enh,lt=0
      *  - x - x x - x - - - 0   56. Kunde,ogr,hgr,lev,lt=0
      *  - x - x - - x - - x x   57. Kunde,ogr,lev,enh,lt
      *  - x - x - - x - - - x   58. Kunde,ogr,lev,lt
      *  - x - x - - x - - x 0   59. Kunde,ogr,lev,enh,lt=0
      *  - x - x - - x - - - 0   60. Kunde,ogr,lev,lt=0
      *  - x - - - - x - - x x   61. Kunde,lev,enh,lt
      *  - x - - - - x - - - x   62. Kunde,lev,lt
      *  - x - - - - x - - x 0   63. Kunde,lev,enh,lt=0
      *  - x - - - - x - - - 0   64. Kunde,lev,lt=0
      *  - x - x x x - - - x x   65. Kunde,ogr,hgr,ugr,enh,lt
      *  - x - x x x - - - - x   66. Kunde,ogr,hgr,ugr,lt
      *  - x - x x x - - - x 0   67. Kunde,ogr,hgr,ugr,enh,lt=0
      *  - x - x x x - - - - 0   68. Kunde,ogr,hgr,ugr,lt=0
      *  - x - x x - - - - x x   69. Kunde,ogr,hgr,enh,lt
      *  - x - x x - - - - - x   70. Kunde,ogr,hgr,lt
      *  - x - x x - - - - x 0   71. Kunde,ogr,hgr,enh,lt=0
      *  - x - x x - - - - - 0   72. Kunde,ogr,hgr,lt=0
      *  - x - x - - - - - x x   73. Kunde,ogr,enh,lt
      *  - x - x - - - - - - x   74. Kunde,ogr,lt
      *  - x - x - - - - - x 0   75. Kunde,ogr,enh,lt=0
      *  - x - x - - - - - - 0   76. Kunde,ogr,lt=0
      *  - x - - - - - - - x x   77. Kunde,enh,lt
      *  - x - - - - - - - - x   78. Kunde,lt
      *  - x - - - - - - - x 0   79. Kunde,enh,lt=0
      *  - x - - - - - - - - 0   80. Kunde,lt=0

      *  x - - - - - - - x x x   81. Rab.kat,vare,enh,lt
      *  x - - - - - - - x - x   82. Rab.kat,vare,lt
      *  x - - - - - - - x x 0   83. Rab.kat,vare,enh,lt=0
      *  x - - - - - - - x - 0   84. Rab.kat,vare,lt=0
      *  x - - - - - - x - x x   85. Rab.kat,modul,enh,lt
      *  x - - - - - - x - - x   86. Rab.kat,modul,lt
      *  x - - - - - - x - x 0   87. Rab.kat,modul,enh,lt=0
      *  x - - - - - - x - - 0   88. Rab.kat,modul,lt=0
      *  x - - x x x x - - x x   89. Rab.kat,ogr,hgr,ugr,lev,enh,lt
      *  x - - x x x x - - - x   90. Rab.kat,ogr,hgr,ugr,lev,lt
      *  x - - x x x x - - x 0   91. Rab.kat,ogr,hgr,ugr,lev,enh,lt=0
      *  x - - x x x x - - - 0   92. Rab.kat,ogr,hgr,ugr,lev,lt=0
      *  x - - x x - x - - x x   93. Rab.kat,ogr,hgr,lev,enh,lt
      *  x - - x x - x - - - x   94. Rab.kat,ogr,hgr,lev,lt
      *  x - - x x - x - - x 0   95. Rab.kat,ogr,hgr,lev,enh,lt=0
      *  x - - x x - x - - - 0   96. Rab.kat,ogr,hgr,lev,lt=0
      *  x - - x - - x - - x x   97. Rab.kat,ogr,lev,enh,lt
      *  x - - x - - x - - - x   98. Rab.kat,ogr,lev,lt
      *  x - - x - - x - - x 0   99. Rab.kat,ogr,lev,enh,lt=0
      *  x - - x - - x - - - 0  100. Rab.kat,ogr,lev,lt=0
      *  x - - - - - x - - x x  101. Rab.kat,lev,enh,lt
      *  x - - - - - x - - - x  102. Rab.kat,lev,lt
      *  x - - - - - x - - x 0  103. Rab.kat,lev,enh,lt=0
      *  x - - - - - x - - - 0  104. Rab.kat,lev,lt=0
      *  x - - x x x - - - x x  105. Rab.kat,ogr,hgr,ugr,enh,lt
      *  x - - x x x - - - - x  106. Rab.kat,ogr,hgr,ugr,lt
      *  x - - x x x - - - x 0  107. Rab.kat,ogr,hgr,ugr,enh,lt=0
      *  x - - x x x - - - - 0  108. Rab.kat,ogr,hgr,ugr,lt=0
      *  x - - x x - - - - x x  109. Rab.kat,ogr,hgr,enh,lt
      *  x - - x x - - - - - x  110. Rab.kat,ogr,hgr,lt
      *  x - - x x - - - - x 0  111. Rab.kat,ogr,hgr,enh,lt=0
      *  x - - x x - - - - - 0  112. Rab.kat,ogr,hgr,lt=0
      *  x - - x - - - - - x x  113. Rab.kat,ogr,enh,lt
      *  x - - x - - - - - - x  114. Rab.kat,ogr,lt
      *  x - - x - - - - - x 0  115. Rab.kat,ogr,enh,lt=0
      *  x - - x - - - - - - 0  116. Rab.kat,ogr,lt=0
      *  x - - - - - - - - x x  117. Rab.kat,enh,lt
      *  x - - - - - - - - - x  118. Rab.kat,lt
      *  x - - - - - - - - x 0  119. Rab.kat,enh,lt=0
      *  x - - - - - - - - - 0  120. Rab.kat,lt=0
      *
      *  - - - - - - - - x x x  121. Vare,enh,lt
      *  - - - - - - - - x - x  122. Vare,lt
      *  - - - - - - - - x x 0  123. Vare,enh,lt=0
      *  - - - - - - - - x - 0  124. Vare,lt=0
      *  - - - - - - - x - x x  125. Modul,enh,lt
      *  - - - - - - - x - - x  126. Modul,lt
      *  - - - - - - - x - x 0  127. Modul,enh,lt=0
      *  - - - - - - - x - - 0  128. Modul,lt=0
      *  - - - x x x x - - x x  129. Ogr,hgr,ugr,lev,enh,lt
      *  - - - x x x x - - - x  130. Ogr,hgr,ugr,lev,lt
      *  - - - x x x x - - x 0  131. Ogr,hgr,ugr,lev,enh,lt=0
      *  - - - x x x x - - - 0  132. Ogr,hgr,ugr,lev,lt=0
      *  - - - x x - x - - x x  133. Ogr,hgr,lev,enh,lt
      *  - - - x x - x - - - x  134. Ogr,hgr,lev,lt
      *  - - - x x - x - - x 0  135. Ogr,hgr,lev,enh,lt=0
      *  - - - x x - x - - - 0  136. Ogr,hgr,lev,lt=0
      *  - - - x - - x - - x x  137. Ogr,lev,enh,lt
      *  - - - x - - x - - - x  138. Ogr,lev,lt
      *  - - - x - - x - - x 0  139. Ogr,lev,enh,lt=0
      *  - - - x - - x - - - 0  140. Ogr,lev,lt=0
      *  - - - - - - x - - x x  141. Lev,enh,lt
      *  - - - - - - x - - - x  142. Lev,lt
      *  - - - - - - x - - x 0  143. Lev,enh,lt=0
      *  - - - - - - x - - - 0  144. Lev,lt=0
      *  - - - x x x - - - x x  145. Ogr,hgr,ugr,enh,lt
      *  - - - x x x - - - - x  146. Ogr,hgr,ugr,lt
      *  - - - x x x - - - x 0  147. Ogr,hgr,ugr,enh,lt=0
      *  - - - x x x - - - - 0  148. Ogr,hgr,ugr,lt=0
      *  - - - x x - - - - x x  149. Ogr,hgr,enh,lt
      *  - - - x x - - - - - x  150. Ogr,hgr,lt
      *  - - - x x - - - - x 0  151. Ogr,hgr,enh,lt=0
      *  - - - x x - - - - - 0  152. Ogr,hgr,lt=0
      *  - - - x - - - - - x x  153. Ogr,enh,lt
      *  - - - x - - - - - - x  154. Ogr,lt
      *  - - - x - - - - - x 0  155. Ogr,enh,lt=0
      *  - - - x - - - - - - 0  156. Ogr,lt=0
      *  - - - - - - - - - x x  157. Enh,lt
      *  - - - - - - - - - - x  158. Lt
      *  - - - - - - - - - x 0  159. Enh,lt=0
      *  - - - - - - - - - - 0  160. Lt=0
      *
      * Kunde/kundeprosjekt...
      *
     c                   if        w_kund <> 0 and
     c                             p_kpro <> 0
      *
      * 1.-4.
      *
     c                   eval      ekboi1_rkat = 0
     c                   eval      ekboi1_kund = w_kund
     c                   eval      ekboi1_kpro = p_kpro
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = vvvare
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 5.-8.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      ekboi1_modn = vvnmod
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 9.-12.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 13.-16.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 17.-20.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 21.-24.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 25.-28.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 29.-32.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 33.-36.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 37.-40.
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * Kunde...
      *
     c                   if        w_kund <> 0
      *
      * 41.-44.
      *
     c                   eval      ekboi1_rkat = 0
     c                   eval      ekboi1_kund = w_kund
     c                   eval      ekboi1_kpro = 0
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = vvvare
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 45.-48.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      ekboi1_modn = vvnmod
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 49.-52.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 53.-56.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 57.-60.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 61.-64.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 65.-68.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 69.-72.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 73.-76.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 77.-80.
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * Avbryter derson kunde/kundeprosjekt er funnet som et bonusnivå på
      * en annen kunde
      *
     c                   if        ekboi1_bkun <> p_bkun
     c                   leavesr
     c                   endif
      *
      * Rabattkategori...
      *
     c                   if        p_rkat <> 0
      *
      * 81.-84.
      *
     c                   eval      ekboi1_rkat = p_rkat
     c                   eval      ekboi1_kund = 0
     c                   eval      ekboi1_kpro = 0
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = vvvare
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 85.-88.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      ekboi1_modn = vvnmod
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 89.-92.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 93.-96.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 97.-100.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 101.-104.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 105.-108.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 109.-112.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 113.-116.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 117.-120.
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * Generell...
      *
      * 121.-124.
      *
     c                   eval      ekboi1_rkat = 0
     c                   eval      ekboi1_kund = 0
     c                   eval      ekboi1_kpro = 0
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = vvvare
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 125.-128.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      ekboi1_modn = vvnmod
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 129.-132.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 133.-136.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 137.-140.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 141.-144.
      *
     c                   if        p_ldor <> 0
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = p_ldor
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 145.-148.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = vvugrp
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 149.-152.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = vvhgrp
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 153.-156.
      *
     c                   eval      ekboi1_ogrp = vvogrp
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
      * 157.-160.
      *
     c                   eval      ekboi1_ogrp = 0
     c                   eval      ekboi1_hgrp = 0
     c                   eval      ekboi1_ugrp = 0
     c                   eval      ekboi1_ldor = 0
     c                   eval      ekboi1_modn = 0
     c                   eval      ekboi1_vare = *blank
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = p_lety
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   if        p_lety <> 0
      *
     c                   eval      ekboi1_enhe = p_enhe
     c                   eval      ekboi1_lety = 0
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   eval      ekboi1_enhe = *blank
     c     ekboi1_key    setll     ekboi1
     c     ekboi1_key    reade     ekboi1
     c                   dow       not %eof
     c                   if        ekfdat = *loval and
     c                             ektdat = *loval or
     c                             w_dato >= ekfdat and
     c                             w_dato <= ektdat
     c                   if        %lookup(ekboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     ekboi1_key    reade     ekboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_bkun
     c                   parm                    p_kund
     c                   parm                    p_kpro
     c                   parm                    p_rkat
     c                   parm                    p_dato
     c                   parm                    p_vare
     c                   parm                    p_enhe
     c                   parm                    p_lety
     c                   parm                    p_ldor
     c                   parm                    p_sapr
     c                   parm                    p_bobe
      *
      * Key for les på kundebonus
      *
     c     ekboi1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ekboi1_bkun
     c                   kfld                    ekboi1_rkat
     c                   kfld                    ekboi1_kund
     c                   kfld                    ekboi1_kpro
     c                   kfld                    ekboi1_ogrp
     c                   kfld                    ekboi1_hgrp
     c                   kfld                    ekboi1_ugrp
     c                   kfld                    ekboi1_ldor
     c                   kfld                    ekboi1_modn
     c                   kfld                    ekboi1_vare
     c                   kfld                    ekboi1_enhe
     c                   kfld                    ekboi1_lety
      *
     c     ekboi1_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    ekboi1_bkun
      *
     c     ekboid_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ekboid_kund
      *
      * Key for oppslag på kundebonus-element
      *
     c     ekbei2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ekbei2_ebku
     c                   kfld                    ekbei2_erka
     c                   kfld                    ekbei2_ekun
     c                   kfld                    ekbei2_ekpr
     c                   kfld                    ekbei2_eogr
     c                   kfld                    ekbei2_ehgr
     c                   kfld                    ekbei2_eugr
     c                   kfld                    ekbei2_eldo
     c                   kfld                    ekbei2_emod
     c                   kfld                    ekbei2_evar
     c                   kfld                    ekbei2_eenh
     c                   kfld                    ekbei2_elet
     c                   kfld                    ekbei2_ebot
     c                   kfld                    ekbei2_efda
     c                   kfld                    ekbei2_etda
      *
      * Key for oppslag på vare
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for oppslag på vare-slettet
      *
     c     vvasl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvasl1_vare
      *
      * Key for oppslag på vare (VA)
      *
     c     jvarl1_key    klist
     c                   kfld                    jvarl1_vare
      *
      *
      * Henter firma fra parameter
      *
     c                   eval      w_firm = p_firm
      *
     c                   endsr
