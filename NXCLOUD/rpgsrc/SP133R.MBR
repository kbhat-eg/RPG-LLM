      /TITLE  ASSTAT Utvalg til parameterfil, fra/til lev.adresse
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SP133R
      * Beskrivelse . . : Utvalg til parameterfil, fra/til lev.adresse
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
7.xx  * 7.00  031016 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fsp133d    cf   e             workstn
      *
     fskpml1    if   e           k disk    rename(skpmpfr:skpml1r)
     fskpmlu    uf a e           k disk    rename(skpmpfr:skpmlur)
      *
      *---------------------------------------------------------------------
      *
     d wwtype          s                   like(sptype)
     d wptext          s             30
     d wpfirm          s                   like(spfirm)
     d wpladr          s              6  0
     d wpnumm          s              6  0
     d wpsuff          s              2  0
     d wpspkr          s              1
     d wptek1          s                   like(wptext)
      *
     d wwfirm          s                   like(spfirm)
     d wwkode          s                   like(spkode)
     d wptype          s                   like(sptype)
      *
     dwwrest           ds           330
     d wwtext                  1     30
     d wwflad                         6  0 dim(10)
     d wwtlad                         6  0 dim(10)
      *
     d wwvalg          ds
     d  wwfyl1                 1     15
      *
     dww_sjekk_array   ds           120
     d ww_sjekk_flad                  6  0 dim(10)
     d ww_sjekk_tlad                  6  0 dim(10)
      *
     d                uds
     d dsuser                911    920
     d dsfirm                944    946  0
     d l_fnav                951    980
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     b2tagb        tag
      *
      * slå opp
      * i filen
      *
     c     key01         chain     skpml1                             60
      *
      * post finnes
      * fra før
      *
     c                   if        *in60 = *off                                          .....
     c                   movel     sprest        wwrest                                      .
     c                   movel     wwflad(1)     b2fla1                                      .
     c                   movel     wwflad(2)     b2fla2                                      .
     c                   movel     wwflad(3)     b2fla3                                      .
     c                   movel     wwflad(4)     b2fla4                                      .
     c                   movel     wwflad(5)     b2fla5                                      .
     c                   movel     wwflad(6)     b2fla6                                      .
     c                   movel     wwflad(7)     b2fla7                                      .
     c                   movel     wwflad(8)     b2fla8                                      .
     c                   movel     wwflad(9)     b2fla9                                      .
     c                   movel     wwflad(10)    b2fla10                                     .
      *
     c                   movel     wwtlad(1)     b2tla1                                      .
     c                   movel     wwtlad(2)     b2tla2                                      .
     c                   movel     wwtlad(3)     b2tla3                                      .
     c                   movel     wwtlad(4)     b2tla4                                      .
     c                   movel     wwtlad(5)     b2tla5                                      .
     c                   movel     wwtlad(6)     b2tla6                                      .
     c                   movel     wwtlad(7)     b2tla7                                      .
     c                   movel     wwtlad(8)     b2tla8                                      .
     c                   movel     wwtlad(9)     b2tla9                                      .
     c                   movel     wwtlad(10)    b2tla10                                     .
      *                                                                                      .
     c                   endif                                                           .....
      *
      * post finnes
      * ikke
      *
     c                   if        *in60 = *on                                           .....
     c                   eval      b2fla1 = *zeros                                           .
     c                   eval      b2fla2 = *zeros                                           .
     c                   eval      b2fla3 = *zeros                                           .
     c                   eval      b2fla4 = *zeros                                           .
     c                   eval      b2fla5 = *zeros                                           .
     c                   eval      b2fla6 = *zeros                                           .
     c                   eval      b2fla7 = *zeros                                           .
     c                   eval      b2fla8 = *zeros                                           .
     c                   eval      b2fla9 = *zeros                                           .
     c                   eval      b2fla10 = *zeros                                          .
     c                   eval      b2tla1 = *zeros                                           .
     c                   eval      b2tla2 = *zeros                                           .
     c                   eval      b2tla3 = *zeros                                           .
     c                   eval      b2tla4 = *zeros                                           .
     c                   eval      b2tla5 = *zeros                                           .
     c                   eval      b2tla6 = *zeros                                           .
     c                   eval      b2tla7 = *zeros                                           .
     c                   eval      b2tla8 = *zeros                                           .
     c                   eval      b2tla9 = *zeros                                           .
     c                   eval      b2tla10 = *zeros                                          .
     c                   endif                                                           .....
      *
     c     b2taga        tag
      *
     c                   exfmt     b2bld
      *
      * avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * Spørring
      *
     c     *inkd         ifeq      *on
     c                   exsr      xspstr
     c                   if        *in80 = *on
     c                   goto      b2taga
     c                   endif
     c                   endif
      *
      * Sjekk om fra er større enn til
      *
     c                   if        b2fla1 > b2tla1
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla2 > b2tla2
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla3 > b2tla3
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla4 > b2tla4
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla5 > b2tla5
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla6 > b2tla6
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla7 > b2tla7
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla8 > b2tla8
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla9 > b2tla9
     c                   goto      b2taga
     c                   endif
     c                   if        b2fla10 > b2tla10
     c                   goto      b2taga
     c                   endif
      *
     c     key01         chain     skpmlu                             60
      *
     c                   movel     b2fla1        wwflad(1)                                   .
     c                   movel     b2fla2        wwflad(2)                                   .
     c                   movel     b2fla3        wwflad(3)                                   .
     c                   movel     b2fla4        wwflad(4)                                   .
     c                   movel     b2fla5        wwflad(5)                                   .
     c                   movel     b2fla6        wwflad(6)                                   .
     c                   movel     b2fla7        wwflad(7)                                   .
     c                   movel     b2fla8        wwflad(8)                                   .
     c                   movel     b2fla9        wwflad(9)                                   .
     c                   movel     b2fla10       wwflad(10)                                  .
     c                   movel     b2tla1        wwtlad(1)                                   .
     c                   movel     b2tla2        wwtlad(2)                                   .
     c                   movel     b2tla3        wwtlad(3)                                   .
     c                   movel     b2tla4        wwtlad(4)                                   .
     c                   movel     b2tla5        wwtlad(5)                                   .
     c                   movel     b2tla6        wwtlad(6)                                   .
     c                   movel     b2tla7        wwtlad(7)                                   .
     c                   movel     b2tla8        wwtlad(8)                                   .
     c                   movel     b2tla9        wwtlad(9)                                   .
     c                   movel     b2tla10       wwtlad(10)                                  .
     c                   eval      wwtext = 'Lev.adresse fra/til'
     c                   eval      sprest = wwrest
     c                   eval      spsyst = 'K'
      *
     c                   movea     wwflad        ww_sjekk_flad
     c                   movea     wwtlad        ww_sjekk_tlad
      *
      * posten finnes
      * fra før
      *
     c                   if        *in60 = *off                                          .....
     c                   if        b2fla1 = 0 and b2tla1 = 0
     c                   delete    skpmlur
     c                   else
     c                   update    skpmlur                                                   .
     c                   endif
     c                   endif
      *
      * posten finnes
      * ikke fra før
      *
     c                   if        *in60 = *on                                           .....
     c                             and ww_sjekk_array <> *blanks
     c                   if        b2tla1 <> 0
     c                   eval      sptype = wwtype
     c                   eval      spkode = wwkode
     c                   eval      spfirm = wwfirm
     c                   write     skpmlur                                                   .
     c                   endif
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for søking
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xspstr        begsr
      *
     c                   eval      *in80 = *off
      *
     c     xspend        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
      * key for file nummerisk
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwtype
     c                   kfld                    wwkode
     c                   kfld                    wwvalg
      *
      * Tar inn parameter fra forrige program
      *
     c     *entry        plist
     c                   parm                    wptype
     c                   parm                    wptext
      *
     c                   eval      wwfirm = dsfirm
     c                   eval      wwtype = wptype
     c                   eval      wwkode = 33
     c                   eval      wwvalg = *blank
      *
     c                   eval      spfirm = dsfirm
      *
     c                   eval      b2type = wptype
     c                   eval      b2text = wptext
      *
     c                   endsr
