## Overview

This RPG program (RK699R) is designed to "nullify" (set to zero) the field `rnsamf` within certain records on the file `rktrlu` (renamed as `rktrlur`) — effectively deleting the "generalnota" (general note/statement) for a specified firm and year, over a selected range of generalnota numbers.

The program reads from a disk file, updates qualifying records, and produces a print report summarizing what was done.

---

## File Declarations

```rpg
frktrlu    uf   e           k disk    rename(rktrpfr:rktrlur)
fliste     o    f  132        printer oflind(*inof)
```
- `rktrlu` (renamed as `rktrlur`) — update-capable keyed disk file, used to read and update customer transactions.
- `liste` — print output file, 132 chars wide.

---

## Data Definitions

```rpg
d                uds
6.NU d psafr                 300    307  0
6.NU d psati                          8  0
d psaar                          4  0

d l_user                911    920
d l_firm                944    946  0
d l_fnav                951    980

d antnul          s              7  0
```
- `psafr`, `psati` — from input parameter area, represent range of generalnota numbers.
- `psaar` — year parameter.
- `l_user`, `l_firm`, `l_fnav` — user, firm, and firm name info from input, via UDS.
- `antnul` — counter: how many records have been nullified (set to zero).

---

## Main Logic

### Initialization Subroutine (`*inzsr`)

- Builds a key list (`rnkey`) for the `rktrlu` file and positions to the correct place.
- Sets initial values (zeroes, lowest value date, etc.).
- This is standard RPG initialization logic.

```rpg
c     *inzsr        begsr
...
c                   endsr
```

### Main Processing Loop

```rpg
c     nyles         tag

c                   read      rktrlu                                 91
c                   if        *in91 = *on
c                   goto      slutt
c                   endif
```
- Loop tag `nyles`: reads the next record from `rktrlu`
- If EOF, jump to `slutt` (end).

**Criteria to Nullify:**
- Only update transactions for:
    - The right firm (`rnfirm` = input `l_firm`)
    - The right year (`rnraar` = input `psaar`)
    - Where `rnsamf` (generalnota nr.) is between `psafr` and `psati` (inclusive)

For records that qualify:
- Set `rnsamf = 0` (nullify generalnota number)
- Increment `antnul`
- Set tracing fields: date, time, user (`rnedat`, `rnetim`, `rneusr`)
- Update the record

Process continues for all records.

### End of Processing (`slutt`)

- Sets `*inlr = *on` to end the program (activates RPG LR indicator).

---

## Print Output

After the update, the program writes a report:
- Lists the affected firm and firm name.
- Shows the range of generalnota numbers that were nullified.
- Reminder to manually update other master files if needed.
- Prints the total number of records nullified.

---

## Indicators

Special use of indicators is documented in the header:
- F1/F3 for user interaction (not shown in this program; may be used in a calling CL or display).
- 30: field protect on display
- 31-59: error/warning messages
- 60-69: file indicators
- 70-99: working indicators

---

## Trace Fields (Version 6.10)

With version 6.10, tracing fields are updated (`rnedat`, `rnetim`, `rneusr`) when records are changed, for auditability.

---

## Summary of Process

1. **Initialization**: Prepare environment and set start values.
2. **Process Loop**: For each record in `rktrlu` within the input selection:
    - If record matches firm/year and generalnota range, set `rnsamf` (generalnota) to zero, update tracing fields, and count.
3. **Print**: Summarize the operation in a report.
4. **End**: End program processing.

---

This program is maintenance-oriented, and deliberately blank out certain "general note numbers" on customer records within a certain year and firm, for an operation such as reversing or removing an accounting batch. The printout serves as audit/reporting of the action taken.