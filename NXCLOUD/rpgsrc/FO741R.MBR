     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FO741R
      * Beskrivelse . . : Automatisk generering av bestillinger fra ordre
      *                   Vise bestilling pr. leverandør
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       050206 ASK  Nytt program
5.60  * R5.60 030108 bof  Danne summer til bestillingshode
5.62  * R5.62 060309 AMD  Gjort om logikk for hvordan kostpriser og
5.62  *                   innkjøpspriser legges fra ordre til bestilling
5.62  *                   (se logg for 06.03.09)
5.70  * PRGR  231008 sst  Prisgruppe
      * 6.10  180609 BSA  Oppdatert med sporingsinformasjon
      * 6.10  220909 ASK  Nye parametre til VL001R
6.11  * 6.10  110610 bof  Justert i utvidelse av parm VL001R
6.15  * 6.10  060612 bof  Lagt på momskode fra leverandør
6.16  * 6.10  020812 bof  Lagt på en clear før skriv til best.head/line
6.20  * 6.20  221110 NHO  Proj er nå alfa
6.21  * R6.20 220310 bof  Utvidet at man man danne best.forslag eller bestilling
6.22  * R6.20 190511 bof  Utvidet vl710r med utg.dato og lev.nr
6.23  * R6.20 110113 bof  Best.forslag - skal ha dagens dato i best.dato
6.24  * R6.20 170113 bof  Lagt på en clear
6.25  *  6.20 151113 bsa  Bruker innkjøpspris og ikke kostpris ved ut-
6.25  *                   legg av verdi på bestillingsforslag.
6.26  *  6.20  020914 bof  LOLENA skal tas fra RLALFA
6.27  *  6.20  260914 bof  test om best.f. innkj.pris skal være kostpris
6.NU  * R6.30 260514 bsa  Programmet gjennomgått mtp nummerutvidelser.
6.30  * 6.30  040615 bkv  Ordre økt fra 6 til 8      *
6.31  * 6.30  170918 bkv  Utvidet med trelast sortiment
      *
8.01  *800    271022 bsa  Legg også ut referanse på tilleggsregister.
8.01  *800                Brukes ved utsendelse av EDI bestilling fra
8.01  *800                ny EDI modul (NGN).
8.02  *PRG2   090622 BOF  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffodtl2    if   e           k disk    rename(fodtpfr:fodtl2r)
     ffodtlu    uf   e           k disk    rename(fodtpfr:fodtlur)
     ffohel1    if   e           k disk    rename(fohepfr:fohel1r)
3.17 flohel1    if   e           k disk    rename(lohepfr:lohel1r)
3.17 flohelu    uf a e           k disk    rename(lohepfr:lohelur)
     flodtl1    if   e           k disk    rename(lodtpfr:lodtl1r)
     flodtlu    uf a e           k disk    rename(lodtpfr:lodtlur)
5.60 flodtlr    if   e           k disk    rename(lodtpfr:lodtlrr)
     frlevl1    if   e           k disk    rename(rlevpfr:rlevl1r)
5.32 frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvotyl1    if   e           k disk    rename(votypfr:votyl1r)
6.21 fvvenl1    if   e           k disk    rename(vvenpfr:vvenl1r)
     ffstsl1    if   e           k disk    rename(fstspfr:fstsl1r)
     flstsl1    if   e           k disk    rename(lstspfr:lstsl1r)
6.21 flfhelu    uf a e           k disk    rename(lfhepfr:lfhelur)
6.21 flfdtlu    uf a e           k disk    rename(lfdtpfr:lfdtlur)
6.31 fvvlel1    if   e           k disk    rename(vvlepfr:vvlel1r)
8.01 flotii2    uf a e           k disk    rename(lotist:lotii2r)
      *
     ffo741d    cf   e             workstn sfile(b1sfl:w_srrn)
     f                                     infds(dspfbk)
      *
      * Definering av LDA
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av Information Data Structure - display feedback
      *
     d dspfbk          ds
     d  d_fcrn               378    379I 0
      *
      * Datastruktur for lageroppdatering
      *
     d                 ds
6.nu d hlrec                        128
     d  hlvare                       15    overlay(hlrec)
     d  hllage                        2  0 overlay(hlrec:16)
     d  hldato                         d   overlay(hlrec:18) datfmt(*iso)
     d  hltime                         t   overlay(hlrec:28) timfmt(*iso)
     d  hlotyp                        2    overlay(hlrec:36)
     d  hlltyp                        2    overlay(hlrec:38)
     d  hlanta                       11  3 overlay(hlrec:40)
     d  hlkopr                        9  2 overlay(hlrec:51)
     d  hlrefr                       20    overlay(hlrec:60)
     d  hlsyst                        1    overlay(hlrec:80)
     d  hlaltk                        2    overlay(hlrec:81)
     d  hlrest                        1    overlay(hlrec:83)
     d  hltype                        1    overlay(hlrec:84)
     d  hlenhe                        3    overlay(hlrec:85)
     d  hlinlr                        1    overlay(hlrec:88)
     d  hllety                        1    overlay(hlrec:89)
6.nu d  hlonum                        8  0 overlay(hlrec:90)
6.nu d  hlolin                        4  0 overlay(hlrec:98)
      *
      * Definering av parametere
      *
     d p_firm          s              3  0
6.NU d p_numm          s                   like(fdnumm)
     d p_suff          s                   like(fdsuff)
6.NU d p_best          s                   like(fdbenr)
     d p_ldor          s                   like(fdldor)
5.70 d w_vtyp          s                   like(vvvtyp)
      *
      * Definering av variabler i nøkler
      *
     d fohel1_numm     s                   like(fonumm)
     d fohel1_suff     s                   like(fosuff)
     d fodtl2_numm     s                   like(fdnumm)
     d fodtl2_suff     s                   like(fdsuff)
     d fodtl2_ldor     s                   like(fdldor)
     d fodtlu_numm     s                   like(fdnumm)
     d fodtlu_suff     s                   like(fdsuff)
     d fodtlu_line     s                   like(fdline)
3.17 d lohel1_numm     s                   like(lonumm)
3.17 d lohel1_suff     s                   like(losuff)
3.17 d lohelu_numm     s                   like(lonumm)
3.17 d lohelu_suff     s                   like(losuff)
3.17 d lodtl1_numm     s                   like(ldnumm)
3.17 d lodtl1_suff     s                   like(ldsuff)
3.17 d lodtl1_line     s                   like(ldline)
3.17 d lodtlu_numm     s                   like(ldnumm)
3.17 d lodtlu_suff     s                   like(ldsuff)
3.17 d lodtlu_line     s                   like(ldline)
3.17 d lodtlr_numm     s                   like(ldnumm)
3.17 d lodtlr_suff     s                   like(ldsuff)
     d rlevl1_levr     s                   like(rllevr)
5.32 d rkunl1_kund     s                   like(rkkund)
     d vvarl1_vare     s                   like(fdvare)
     d votyl1_otyp     s                   like(vaotyp)
6.21 d vvenl1_vare     s                   like(vevare)
6.21 d vvenl1_enhe     s                   like(veenhe)
6.21 d lfhelu_numm     s                   like(lhnumm)
      *
      * Definering av variable
      *
     d w_fcrn          s              4  0
     d w_spge          s              4  0
     d w_srrn          s              4  0
     d w_srrn_w        s              4  0
     d w_sfrn          s                   like(w_srrn)
     d w_ssrn          s                   like(w_srrn)
     d w_stel          s              1  0
      *
     d w_firm          s                   like(fofirm)
6.NU d w_numm          s                   like(fonumm)
6.NU d w_best          s                   like(lonumm)
     d w_suff          s                   like(fosuff)
     d w_ldor          s                   like(fdldor)
     d w_otyp          s                   like(footyp)
     d w_valg          s              2  0
     d w_fast          s             10
     d w_fell          s              6
     d w_type          s              2
     d w_kode          s              1
     d w_lety          s              1  0
     d w_date          s               d   datfmt(*iso)
     d w_time          s               t   timfmt(*iso)
6.nu d w_lrec          s            128
     d w_stat          s              1
     d w_text          s             20
     d w_adrs          s             30
     d w_ponr          s              4  0
     d w_pste          s             30
     d w_avde          s              4  0
     d w_feil          s              1
     d w_pnra          s              4
     d w_skaf          s              1
     d w_eann          s             13  0
     d w_sted          s                   like(lonavn)
     d w_adr1          s                   like(loadr1)
     d w_adr2          s                   like(loadr2)
5.60 d w_totk          s             11  2
5.60 d w_toti          s             11  2
5.60 d w_totr          s             11  2
6.30 d w_numa          s              8
5.02 d w_lina          s              4
6.21 d w_tbel          s                   like(lhtbel)
6.21 d w_tvkt          s             11  3
6.21 d w_bestf         s                   like(lfnumm)
6.nu d w_bestf8        s              8  0
6.22 d w_bldo          s                   like(fdldor)
6.22 d w_udat          s               d   datfmt(*iso)
6.22 d b_inlr          s              1    inz(*off)
6.31 d w_lv_nobb       s                   like(vvlnob)
6.31 d w_lv_modn       s                   like(vvlmod)
6.31 d w_lv_lldo       s                   like(vvlnle)
6.31 d w_lv_llva       s                   like(vvllva)
      *
     d b_alle          s              1    inz(*off)
     d b_line          s              1    inz(*off)
6.21 d b_bfor          s              1    inz(*off)
      *
      * Definering av konstanter
      *
     d c_sfil          s              2  0 inz(11)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Behandle åpningsopplysninger
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Hent opplysninger fra ordre
      *
     c                   exsr      hent_ordre
      *
     c     fodtl2_key    setll     fodtl2
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * D1 Behandle åpningsbildet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     d1taga        tag
      *
      * Send Alt
      *
     c     b2taga        tag
      *
     c                   eval      *in22 = *on
      *
     c                   write     b2cmd
      *
      * Bare data
      *
     c     b2tagb        tag
      *
     c                   exsr      dsp_subfile
      *
     c                   eval      *in22 = *off
      *
      * Behandling av funksjonstaster
      *
     c                   select
     c                   when      *in10
     c                   exsr      crt_subfile
     c                   goto      b2tagb
     c                   when      *in11
     c                   exsr      bck_subfile
     c                   goto      b2tagb
     c                   when      *in21
     c                   eval      *in22 = *on
     c                   goto      b2taga
     c                   endsl
      *
      * F3=avslutt
      *
     c                   if        *inkc = *on
     c                   goto      avslutt
     c                   endif
      *
      * F7=Vis alle
      *
     c                   if        *inkg = *on
     c                   if        b_alle = *off
     c                   eval      b_alle = *on
     c                   else
     c                   eval      b_alle = *off
     c                   endif
     c                   exsr      forny
     c                   goto      b2tagb
     c                   endif
      *
      * F9=Bestill
      *
     c                   if        *inki = *on
6.21 c                   if        b_bfor = *on
6.21 c                   exsr      lag_best_for
6.21 c                   else
     c                   exsr      lag_best
6.21 c                   endif
     c                   exsr      hent_ordre
     c                   exsr      forny
     c                   goto      b2tagb
     c                   endif
      *
      * Behandling av subfile
      *
     c                   exsr      subfile
      *
     c                   goto      d1taga
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for fornying av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     forny         begsr
      *
     c     fodtl2_key    setll     fodtl2
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
     c     end_forny     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     subfile       begsr
      *
     c                   eval      w_virn = w_fcrn
      *
      * Leser og behandler subfile
      *
     c                   do        w_ssrn
     c                   readc     b1sfl
      *
     c                   if        %eof
     c                   leave
     c                   endif
      *
     c                   eval      w_virn = w_srrn
      *
      * Endre bestilling
      *
     c                   if        b1valg = 2
     c                   exsr      endre_linje
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Slett bestilling
      *
     c                   if        b1valg = 4
     c                   exsr      slett_linje
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
     c                   enddo
      *
     c     end_subfile   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å endre bestillingslinje
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     endre_linje   begsr
      *
      *
     c     end_endre     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for sletting av bestillingslinje
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     slett_linje   begsr
      *
     c     end_slett     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for tømming av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     clr_subfile   begsr
      *
     c                   eval      *in14 = *on
     c                   write     b2ctl
     c                   eval      *in14 = *off
      *
     c                   eval      *in15 = *off
     c                   eval      w_srrn = 0
     c                   eval      w_sfrn = 0
     c                   eval      w_ssrn = 0
     c                   eval      w_spge = 0
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å fylle opp subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     crt_subfile   begsr
      *
     c                   eval      w_spge = w_spge + c_sfil
     c                   eval      w_srrn = w_ssrn
      *
     c                   dou       w_srrn = w_spge
      *
     c     fodtl2_key    reade     fodtl2
      *
     c                   if        %eof or
     c                             fdfirm <> w_firm or
     c                             fdnumm <> w_numm or
     c                             fdsuff <> w_suff
     c                   eval      *in15 = *on
     c                   leave
     c                   endif
      *
      * Skal linje vises?
      *
     c                   if        b_alle = *off
5.70  *
5.70  * Kaller program for henting av prisgruppe
5.70  *
5.70 c                   call      'VL710R'
5.70 c                   parm                    w_firm
5.70 c                   parm                    fdvare
5.70 c                   parm                    fdlage
5.70 c                   parm                    w_vtyp
6.22 c                   parm                    w_udat
6.22 c                   parm                    w_bldo
6.22 c                   parm                    b_inlr
6.31 c                   parm                    w_lv_nobb
6.31 c                   parm                    w_lv_modn
6.31 c                   parm                    w_lv_lldo
6.31 c                   parm                    w_lv_llva
5.70 c                   if        w_vtyp <> 'S' and
     c                             fdlety <> 1 and
     c                             fdlvre <> 1 and
     c                             fdbenr = 0
     c                   iter
     c                   endif
     c                   endif
      *
     c                   eval      w_srrn = w_srrn + 1
      *
     c                   eval      b1valg = 0
     c                   eval      b1vare = fdvare
     c                   eval      b1tek1 = fdtek1
5.70 c                   eval      b1vtyp = w_vtyp
     c                   eval      b1ltyp = fdlety
     c                   eval      b1lvar = fdlvre
     c                   eval      b1anto = fdanta
     c                   eval      b1enhe = fdenh1
     c                   eval      b1olin = fdline
      *
      * Hent bestillingsinfo
      *
     c                   eval      lodtl1_line = fdblin
     c     lodtl1_key    chain     lodtl1r
     c                   eval      b1antb = ldanta
      *
     c                   write     b1sfl
      *
     c                   enddo
      *
     c                   if        w_srrn > w_ssrn
     c                   eval      w_sfrn = w_ssrn + 1
     c                   endif
      *
     c                   eval      w_ssrn = w_srrn
     c                   eval      w_virn = w_sfrn
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å bla tilbake en side i subfilen
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bck_subfile   begsr
      *
     c                   if        *in15
     c     fodtl2_key    setgt     fodtl2
     c                   readp     fodtl2
     c                   endif
      *
      * Leser tilbake en side
      *
     c                   eval      w_stel = 0
      *
     c                   dou       w_stel = w_ssrn + c_sfil
      *
     c                   readp     fodtl2
      *
     c                   if        %eof or
     c                             fdfirm <> w_firm or
     c                             fdnumm <> w_numm or
     c                             fdsuff <> w_suff
     c                   leave
     c                   endif
      *
     c                   eval      w_stel = w_stel + 1
      *
     c                   enddo
      *
     c*                  if        %eof
     c*                  eval      fodtl1_line = fdline
     c*    fodtl1_key    setll     fodtl1
     c*                  endif
      *
      * Blanker og fyller opp subfile
      *
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for display av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     dsp_subfile   begsr
      *
     c                   if        w_srrn <> 0
     c                   eval      *in12 = *on
     c                   else
     c                   write     b2cmd
     c                   endif
      *
     c                   eval      *in13 = *on
     c                   exfmt     b2ctl
      *
     c                   eval      *in12 = *off
     c                   eval      *in13 = *off
      *
     c                   eval      w_fcrn = d_fcrn
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hent opplysninger om ordren
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_ordre    begsr
      *
      * Hent opplysninger fra ordre-hode
      *
     c     fohel1_key    chain     fohel1r
      *
     c                   eval      b2onum = fonumm
     c                   eval      b2otyp = footyp
     c                   eval      b2kund = fokund
      *
      * Hent opplysninger fra kunde
      *
     c                   eval      b2knav = *blank
      *
     c                   eval      rkunl1_kund = fokund
     c     rkunl1_key    chain     rkunl1
     c                   if        %found
     c                   eval      b2knav = rknavn
     c                   endif
6.21  *
6.21  * Hent opplysninger fra ordretype-register
6.21  *
6.21 c                   eval      votyl1_otyp = footyp
6.21 c     votyl1_key    chain     votyl1r
6.21  *
6.21 c                   if        faabfs = 1
6.21 c                   eval      b_bfor = *on
6.21 c                   if        vaoska = 1
6.21 c                   eval      b_bfor = *off
6.21 c                   endif
6.21 c                   else
6.21 c                   eval      b_bfor = *off
6.21 c                   endif
      *
      * Hent opplysninger fra bestillingshode
      *
     c     lohel1_key    chain     lohel1r
     c                   eval      b2bnum = lonumm
     c                   eval      b2btyp = lootyp
     c                   eval      b2levr = loldor
      *
      * Hent opplysninger fra leverandør
      *
     c                   eval      b2lnav = *blank
     c                   eval      b2ltlf = *blank
     c                   eval      b2lfax = *blank
      *
     c                   eval      rlevl1_levr = loldor
     c     rlevl1_key    chain     rlevl1
     c                   if        %found
     c                   eval      b2lnav = rlnavn
     c                   eval      b2ltlf = rltlfn
     c                   eval      b2lfax = rltlfx
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Lag bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     lag_best      begsr
      *
      * Allerede bestilt?
      *
     c                   if        w_best <> 0
     c                   goto      end_best
     c                   endif
      *
      * Leverandør ikke valgt eller ugyldig leverandør?
      *
     c                   eval      rlevl1_levr = w_ldor
     c     rlevl1_key    chain     rlevl1
     c                   if        not %found
     c                   eval      w_ldor = 0
     c                   endif
      *
     c                   if        w_ldor = 0
     c     b9taga        tag
     c                   exfmt     b9win
     c                   if        *inkd = *on
      *
     c                   call      'RL500R'
     c                   parm                    w_firm
     c                   parm                    b9levr
     c                   parm                    b9lnav
     c                   goto      b9taga
     c                   endif
      *
     c                   if        b9levr <> 0
     c                   eval      w_ldor = b9levr
     c                   else
     c                   goto      end_best
     c                   endif
     c                   endif
      *
      * Hent opplysninger fra ordretype-register
      *
     c                   eval      votyl1_otyp = footyp
     c     votyl1_key    chain     votyl1r
      *
5.40 c                   if        vaomot <> *blank
5.40 c                   eval      w_otyp = vaomot
5.40 c                   else
5.40 c                   eval      w_otyp = faaot7
5.40 c                   endif
      *
      * Hent neste bestillingsnummer
      *
     c                   exsr      hntnum
      *
     c                   eval      lohel1_numm = w_best
     c                   eval      lohel1_suff = 0
      *
     c                   eval      lohelu_numm = w_best
     c                   eval      lohelu_suff = 0
      *
     c                   eval      lodtl1_numm = w_best
     c                   eval      lodtl1_suff = 0
      *
     c                   eval      lodtlu_numm = w_best
     c                   eval      lodtlu_suff = 0
      *
     c                   eval      lodtlr_numm = w_best
     c                   eval      lodtlr_suff = 0
      *
      * Legg ut bestillingslinjer og hode
      *
     c                   exsr      bes_lin
      *
     c                   if        b_line = *on
     c                   exsr      bes_hode
     c                   else
     c                   eval      w_best = 0
     c                   endif
      *
     c     end_best      endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Legger ut ordre-linjer til Bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bes_lin       begsr
      *
      * Leser inn poster fra Ordre-linje-register
      *
     c     fodtl2_ke2    setll     fodtl2r
     c     fodtl2_ke2    reade     fodtl2r
      *
     c                   dow       not %eof
      *
      * Skal linje bestilles?
      *
     c                   if        b_alle = *off
5.70  *
5.70  * Kaller program for henting av prisgruppe
5.70  *
5.70 c                   call      'VL710R'
5.70 c                   parm                    w_firm
5.70 c                   parm                    fdvare
5.70 c                   parm                    folage
5.70 c                   parm                    w_vtyp
6.22 c                   parm                    w_udat
6.22 c                   parm                    w_bldo
6.22 c                   parm                    b_inlr
6.31 c                   parm                    w_lv_nobb
6.31 c                   parm                    w_lv_modn
6.31 c                   parm                    w_lv_lldo
6.31 c                   parm                    w_lv_llva
5.70 c                   if        w_vtyp <> 'S' and
     c                             fdlety <> 1 and
     c                             fdlvre <> 1 and
     c                             fdbenr = 0
     c                   goto      lin_les
     c                   endif
     c                   endif
      *
      *
      * Antall ikke oppgitt ?
      *
     c                   if        fdvare <> *blank
     c                   if        fdanta =  0
     c                   goto      lin_les
     c                   endif
     c                   endif
      *
      * Tekstlinje hvor antall ikke er oppgitt og det
      *
     c                   if        fdvare = *blank
     c                   if        fdanta = *zero
     c                   goto      lin_les
     c                   endif
     c                   endif
      *
      * Linje er allerede bestilt
      *
     c                   if        fdantb <> 0
     c                   goto      lin_les
     c                   endif
      *
      * Ny record til Bestilling-linje-register
      *
6.16 c                   clear                   lodtlur
     c                   eval      lodtlu_line = fdline
     c     lodtlu_key    chain     lodtlur
     c                   if        not %found
      *
     c                   eval      ldfirm = w_firm
     c                   eval      ldnumm = w_best
     c                   eval      ldsuff = 0
     c                   eval      ldline = fdline
      *
     c                   eval      ldltyp = fdltyp
3.16 c                   eval      ldlety = fdlety
     c                   eval      ldvare = fdvare
     c                   eval      ldenh1 = fdenh1
     c                   eval      ldlage = fdlage
     c                   eval      ldldor = w_ldor
     c                   eval      ldldat = *loval
     c                   eval      ldavde = 0
     c                   eval      ldkont = 0
     c                   eval      ldspes = 0
6.20 c**                 eval      ldproj = 0
6.20 c                   eval      ldproj = *blank
     c                   eval      ldakti = *blank
     c                   eval      ldlvar = fdlvar
3.18 c                   eval      ldnobb = fdnobb
     c                   eval      ldtek1 = fdtek1
     c                   eval      ldtek2 = fdtek2
     c                   eval      ldogrp = fdogrp
     c                   eval      ldhgrp = fdhgrp
     c                   eval      ldugrp = fdugrp
     c                   eval      ldlvre = fdlvre
     c                   eval      ldipny = 0
     c                   eval      ldkpny = 0
     c                   eval      ldrab1 = 0
     c                   eval      ldrab2 = 0
      *
     c                   eval      ldornu = fdnumm
     c                   eval      ldorsu = fdsuff
     c                   eval      ldorli = fdline
      *
     c                   eval      ldotyp = w_otyp
      *
     c                   eval      ldanta = fdanta
      *
5.62  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.62  * Etterfølgende logikk er fjernet fra programmet
5.62  * og erstattet med en ny og enklere logikk
5.62  * (Koden er slettet i denne source men finnes i std. V5.60)
5.62  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.62  * Ny logikk er lagt inn
5.62  *
5.62 c                   eval      ldkpny = fdkopr
6.27 c                   if        laaenl = 1
5.27 c                   eval      ldipny = ldkpny
6.27 c                   else
5.62 c                   eval      ldipny = fdinpr
6.27 c                   endif
5.62  *
5.62 c                   if        ldipny = *zero
5.62 c                   eval      ldipny = ldkpny
5.62 c                   endif
5.62  *
5.62 c                   if        laaenl = 1
5.62 c                   eval      ldipny = ldkpny
5.62 c                   endif
5.62  *
5.62  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
5.60 c                   eval      ldsumk = ldkpny * ldanta
5.60 c                   eval      ldsumi = ldipny * ldanta
      *
      *
      *
      * Kaller opp subrutine for oppdatering av lager
      * Trekker ut antall for vedlikeholdt linje
      *
     c                   if        laalag <> *zero
     c                   exsr      opplag
     c                   endif
      *
6.10 c                   time                    ldodat
6.10 c                   time                    ldotim
6.10 c                   eval      ldousr = l_user
6.10 c                   time                    ldedat
6.10 c                   time                    ldetim
6.10 c                   eval      ldeusr = l_user
     c                   write     lodtlur
      *
     c                   eval      b_line = *on
     c                   endif
      *
      * Oppdaterer ordre-linje-register med nytt antall bestilt
      *
     c                   eval      fodtlu_line = fdline
     c     fodtlu_key    chain     fodtlur
     c                   if        %found
     c                   eval      fdantb = ldanta
     c                   eval      fdbenr = w_best
     c                   eval      fdldor = w_ldor
     c                   eval      fdblin = ldline
      *
6.10 c                   time                    fdedat
6.10 c                   time                    fdetim
6.10 c                   eval      fdeusr = l_user
     c                   update    fodtlur
     c                   endif
      *
      * Les neste post
      *
     c     lin_les       tag
     c     fodtl2_ke2    reade     fodtl2r
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Legger ut bestillings hode
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bes_hode      begsr
5.60  *
5.60  * Henter ny bestillings-total
5.60  *
5.60 c                   exsr      hent_total
      *
6.16 c                   clear                   lohelur
6.16  *
     c     lohelu_key    chain     lohelur
      *
     c                   if        not %found
     c                   eval      loline = 0
     c                   eval      lolage = folage
5.01 c                   eval      loavde = foavde
     c                   eval      loinnk = foselg
     c                   eval      lobinr = 0
     c                   eval      lokref = 0
     c                   eval      lobdat = w_date
     c                   eval      loldat = foldat
     c                   eval      lofkda = *loval
     c                   eval      loffda = *loval
      *
     c                   eval      lootyp = w_otyp
     c                   eval      loldor = w_ldor
6.26 c                   movel     rlalfa        lolena
     c                   eval      lovref = fovref
     c                   eval      lodref = *blank
     c                   eval      lorekv = *blank
6.15 c                   eval      lomkod = rlmkod
      *
     c                   eval      loornr = p_numm
     c                   eval      loorsu = p_suff
5.60 c                   eval      lototi = w_toti
5.60 c                   eval      lototr = w_totr
5.60 c                   eval      lototk = w_totk
      *
     c                   eval      lowsid = l_wsid
     c                   eval      louser = l_user
     c                   eval      lodate = w_date
     c                   eval      lotime = w_time
      *
     c                   if        folety = 0
     c                   exsr      hntltx
     c                   else
5.32 c                   if        fonavn <> *blank
     c                   movel     fonavn        lonavn
     c                   move      foadr1        loadr1
     c                   move      foadr2        loadr2
     c                   move      fosted        losted
5.32 c                   else
5.32 c                   movel     rknavn        lonavn
5.32 c                   move      rkgate        loadr1
5.32 c                   move      rkadr2        loadr2
5.32 c                   move      rksted        losted
     c                   endif
5.32 c                   endif
      *
     c                   eval      lofirm = w_firm
     c                   eval      lonumm = w_best
     c                   eval      losuff = 0
     c                   eval      lokode = 0
6.10 c                   time                    lodate
6.10 c                   time                    lotime
6.10 c                   eval      louser = l_user
6.10 c                   time                    loedat
6.10 c                   time                    loetim
6.10 c                   eval      loeusr = l_user
     c                   write     lohelur
8.01  *
8.01  * Legg ut post på tilleggsregister
8.01  *
8.01 c     lohelu_key    chain     lotii2r
8.01 c                   if        not %found
8.01  *
8.01 c                   if        folety = 1
8.01 c                   eval      lotko2 = 'B'
8.01 c                   else
8.01 c                   eval      lotko2 = 'L'
8.01 c                   endif
8.01  *
8.01 c                   eval      lotfir = w_firm
8.01 c                   eval      lotnum = lohelu_numm
8.01 c                   eval      lotsuf = lohelu_suff
8.01  *
8.01 c                   time                    loteda
8.01 c                   time                    loteti
8.01 c                   eval      loteus = l_user
8.01  *
8.01 c                   write     lotii2r
8.01 c                   endif
     c                   endif
      *
     c                   endsr
6.21  *
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  * Lag bestillingsforslag
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  *
6.21 c     lag_best_for  begsr
6.21  *
6.21  * Allerede bestilt?
6.21  *
6.21 c                   if        w_best <> 0
6.21 c                   goto      end_best_for
6.21 c                   endif
6.21  *
6.21  * Leverandør ikke valgt eller ugyldig leverandør?
6.21  *
6.21 c                   eval      rlevl1_levr = w_ldor
6.21 c     rlevl1_key    chain     rlevl1
6.21 c                   if        not %found
6.21 c                   eval      w_ldor = 0
6.21 c                   endif
6.21  *
6.21 c                   if        w_ldor = 0
6.21 c     b9tagaf       tag
6.21 c                   exfmt     b9win
6.21 c                   if        *inkd = *on
6.21  *
6.21 c                   call      'RL500R'
6.21 c                   parm                    w_firm
6.21 c                   parm                    b9levr
6.21 c                   parm                    b9lnav
6.21 c                   goto      b9tagaf
6.21 c                   endif
6.21  *
6.21 c                   if        b9levr <> 0
6.21 c                   eval      w_ldor = b9levr
6.21 c                   else
6.21 c                   goto      end_best_for
6.21 c                   endif
6.21 c                   endif
6.21  *
6.21  * Hent opplysninger fra ordretype-register
6.21  *
6.21 c                   eval      votyl1_otyp = footyp
6.21 c     votyl1_key    chain     votyl1r
6.21  *
6.21 c                   if        vaomot <> *blank
6.21 c                   eval      w_otyp = vaomot
6.21 c                   else
6.21 c                   eval      w_otyp = faaot7
6.21 c                   endif
6.21  *
6.21  * Henter neste bestillingsforslag-nummer
6.21  *
6.21 c                   eval      w_kode = '0'
6.21 c                   eval      w_fell = laafor
6.21 c                   eval      w_type = *blank
6.21 c                   eval      w_fast = *blank
6.21  *
6.21 c                   call      'AS100R'
6.21 c                   parm                    w_kode
6.21 c                   parm                    w_firm
6.21 c                   parm                    w_fell
6.21 c                   parm                    w_type
6.21 c                   parm                    w_fast
6.nu c                   parm                    w_bestf8
6.nu  *
6.nu c                   eval      w_bestf = w_bestf8
6.21  *
6.21  * Legg ut bestillingslinjer og hode
6.21  *
6.21 c                   exsr      bes_lin_for
6.21  *
6.21 c                   if        b_line = *on
6.21 c                   exsr      bes_hode_for
6.21 c                   else
6.21 c                   eval      w_best = 0
6.21 c                   endif
6.21  *
6.21 c     end_best_for  endsr
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  * Legger ut ordre-linjer til Bestillingsforsllag
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  *
6.21 c     bes_lin_for   begsr
6.21  *
6.21  * Leser inn poster fra Ordre-linje-register
6.21  *
6.21 c     fodtl2_ke2    setll     fodtl2r
6.21 c     fodtl2_ke2    reade     fodtl2r
6.21  *
6.21 c                   dow       not %eof
6.21  *
6.21  * Skal linje bestilles?
6.21  *
6.21 c                   eval      vvarl1_vare = fdvare
6.21 c     vvarl1_key    chain     vvarl1r
6.21  *
6.21 c                   if        b_alle = *off
6.22  *
6.22  * Kaller program for henting av prisgruppe
6.22  *
6.22 c                   call      'VL710R'
6.22 c                   parm                    w_firm
6.22 c                   parm                    fdvare
6.22 c                   parm                    fdlage
6.22 c                   parm                    w_vtyp
6.22 c                   parm                    w_udat
6.22 c                   parm                    w_bldo
6.22 c                   parm                    b_inlr
6.31 c                   parm                    w_lv_nobb
6.31 c                   parm                    w_lv_modn
6.31 c                   parm                    w_lv_lldo
6.31 c                   parm                    w_lv_llva
6.22  *
6.21 c                   if        w_vtyp <> 'S' and
6.21 c                             fdlety <> 1 and
6.21 c                             fdlvre <> 1 and
6.21 c                             fdbenr = 0
6.21 c                   goto      lin_les_for
6.21 c                   endif
6.21 c                   endif
6.21 c                   eval      vvenl1_vare = fdvare
6.21 c                   eval      vvenl1_enhe = fdenh1
6.21 c     vvenl1_key    chain     vvenl1r
6.21  *
6.21  * Antall ikke oppgitt ?
6.21  *
6.21 c                   if        fdvare <> *blank
6.21 c                   if        fdanta =  0
6.21 c                   goto      lin_les_for
6.21 c                   endif
6.21 c                   endif
6.21  *
6.21  * Tekstlinje hvor antall ikke er oppgitt og det
6.21  *
6.21 c                   if        fdvare = *blank
6.21 c                   if        fdanta = *zero
6.21 c                   goto      lin_les_for
6.21 c                   endif
6.21 c                   endif
6.21  *
6.21  * Linje er allerede bestilt
6.21  *
6.21 c                   if        fdantb <> 0
6.21 c                   goto      lin_les_for
6.21 c                   endif
6.21  *
6.21  * Ny record til Bestilling-linje-register
6.21  *
6.23 c                   clear                   lfdtlur
6.23  *
6.21 c                   eval      lffirm = w_firm
6.21 c                   eval      lfnumm = w_bestf
6.21 c                   eval      lfline = fdline
6.21  *
6.21 c                   eval      lfltyp = *blank
6.21 c                   eval      lfldor = w_ldor
6.21 c                   eval      lflage = fdlage
6.21 c                   eval      lfogrp = vvogrp
6.21 c                   eval      lfhgrp = vvhgrp
6.21 c                   eval      lfugrp = vvugrp
6.21 c                   eval      lflvar = *blank
6.21 c                   eval      lfvare = fdvare
6.21 c                   eval      lfenh1 = fdenh1
6.21 c                   eval      lftek1 = vvtek1
6.21 c                   eval      lftek2 = vvtek2
6.21 c                   eval      lfvekt = vevekt
6.21  *
6.21 c                   eval      lfornr = fdnumm
6.21 c                   eval      lforsu = fdsuff
6.21 c                   eval      lforli = fdline
6.21 c                   eval      lflety = fdlety
6.21 c                   eval      lfldat = fdldat
6.21  *
6.21 c                   eval      lfanta = fdanta
6.25  * Bruker innkjøpspris hvis finnes.
6.25 c**                 eval      lflbel = fdkopr
6.25 c                   eval      lflbel = fdinpr
6.25 c                   if        lflbel = 0
6.25 c                   eval      lflbel = fdkopr
6.25 c                   endif
6.21  *
6.21 c                   write     lfdtlur
6.21  *
6.21 c                   eval      b_line = *on
6.21  *
6.21  * Oppdaterer ordre-linje-register med nytt antall bestilt
6.21  * dette gjøres på et senere tidspkt. når det danne en bestilling
6.21  *
6.21 c*                  eval      fodtlu_line = fdline
6.21 c*    fodtlu_key    chain     fodtlur
6.21 c*                  if        %found
6.21 c*                  eval      fdantb = lfanta
6.21 c*                  eval      fdbenr = w_bestf
6.21 c*                  eval      fdldor = w_ldor
6.21 c*                  eval      fdblin = lfline
6.21  *
6.21 c*                  update    fodtlur
6.21 c*                  endif
6.21  *
6.21  * Les neste post
6.21  *
6.21 c     lin_les_for   tag
6.21 c     fodtl2_ke2    reade     fodtl2r
6.21 c                   enddo
6.21  *
6.21 c                   endsr
6.21  *
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  * Legger ut bestillings hode forslag
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  *
6.21 c     bes_hode_for  begsr
6.21  *
6.21 c                   clear                   lfhelur
6.21  *
6.21 c     lfhelu_key    chain     lfhelur
6.21  *
6.21 c                   if        not %found
6.21 c                   eval      lhfirm = w_firm
6.21 c                   eval      lhnumm = w_bestF
6.21 c                   eval      lhotyp = w_otyp
6.21 c                   eval      lhlage = folage
6.21 c                   eval      lhavde = foavde
6.21 c                   eval      lhselg = foselg
6.23 c                   time                    lhbdat
6.21 c                   eval      lhldat = foldat
6.21 c                   eval      lhwsid = l_wsid
6.21 c                   eval      lhuser = l_user
6.21 c                   eval      lhoppr = 'O'
6.21 c                   eval      lhldor = w_ldor
6.21 c                   eval      lhldat = foldat
6.21 c                   movel     rlalfa        lhlsor
6.21  *
6.21 c                   time                    lhdate
6.21 c                   time                    lhtime
6.21  *
6.21 c                   if        lhbdat = *loval
6.21 c                   time                    lhbdat
6.21 c                   endif
6.21 c                   eval      lhornr = p_numm
6.21 c                   eval      lhorsu = p_suff
6.21 c                   eval      w_tbel = 0
6.21 c                   eval      w_tvkt = 0
6.21 c                   eval      w_stat = *blank
6.21 c                   call      'LH714R '
6.21 c                   parm                    w_bestf
6.21 c                   parm                    w_stat
6.21 c                   parm                    w_tbel
6.21 c                   parm                    w_tvkt
6.21 c                   eval      lhvekt = w_tvkt
6.21 c                   eval      lhtbel = w_tbel
6.21 c                   eval      lhstat = w_stat
6.21  *
6.21 c                   write     lfhelur
6.21 c                   endif
6.21  *
6.21 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekk/Hent tekst for lager                        RS710R
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hntltx        begsr
      *
     c                   call      'FÅ720R'
     c                   parm                    w_firm
     c                   parm                    fdlage
     c                   parm                    w_text
     c                   parm                    w_adrs
     c                   parm                    w_ponr
     c                   parm                    w_pste
     c                   parm                    w_avde
     c                   parm                    w_feil
      *
     c                   movel     w_text        lonavn
     c                   move      w_adrs        loadr1
     c                   move      *blank        loadr2
     c                   move      w_ponr        w_pnra
     c                   eval      losted = %trim(w_pnra + ' ' + w_pste)
      *
      * Sjekk om logistikkpunkt er registrert
      *
     c                   exsr      hent_logp
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Henter logistikkpunkt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_logp     begsr
      *
     c                   eval      w_skaf = 'S'
      *
     c     les_log       tag
     c                   call      'MJ500R'
     c                   parm                    w_stat
     c                   parm                    fdlage
     c                   parm                    loavde
     c                   parm                    w_skaf
     c                   parm                    w_eann
     c                   parm                    w_sted
     c                   parm                    w_adr1
     c                   parm                    w_adr2
     c                   parm                    w_pste
      *
     c                   if        w_stat = *blank
     c                   eval      lonavn = w_sted
     c                   eval      loadr1 = w_adr1
     c                   eval      loadr2 = w_adr2
     c                   eval      losted = w_pste
     c                   endif
      *
     c     end_log       endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Oppdatering av Lager
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     opplag        begsr
      *
      * Legger over verdier i overførings-felter
      *
     c                   eval      hlvare = ldvare
5.31 c                   eval      hllage = ldlage
     c                   eval      hlenhe = ldenh1
     c                   eval      hldato = *loval
     c                   eval      hltime = *loval
     c                   eval      hlotyp = w_otyp
     c                   eval      hlltyp = ldltyp
      *
     c                   eval      hlanta = ldanta
     c                   eval      hlkopr = ldkpny
      *
     c                   eval      hlrefr = *blank
     c                   eval      hlsyst = 'L'
     c                   eval      hlaltk = *blank
     c                   eval      hlrest = *blank
     c                   move      fdnumm        w_numa
     c                   move      fdline        w_lina
     c                   eval      hlrefr = 'O:' + w_numa +
     c                                      ' L:' + w_lina
     c                   eval      hlonum = fdnumm
     c                   eval      hlolin = fdline
3.16 c                   move      fdlety        hllety
      *
      * Kaller opp lageroppdaterings-program
      *
     c                   eval      w_lrec = hlrec
      *
     c                   call      'VL001R'
     c                   parm                    w_stat
     c                   parm                    w_lrec
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Henter/Oppdatering av Nummer-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hntnum        begsr
      *
     c                   eval      w_kode = '0'
     c                   eval      w_fell = laabrk
     c                   eval      w_type = w_otyp
     c                   eval      w_fast = l_wsid
     c                   eval      w_best = 0
      *
      * Kaller opp subprogram for henting av nummer fra Nummer-register
      *
     c                   call      'AS100R'
     c                   parm                    w_kode
     c                   parm                    w_firm
     c                   parm                    w_fell
     c                   parm                    w_type
     c                   parm                    w_fast
     c                   parm                    w_best
      *
     c                   endsr
      *
5.60  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.60  * Subrutine for henting av bestillingstotal
5.60  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.60  *
5.60 c     hent_total    begsr
5.60  *
5.60 c                   eval      w_totk = 0
5.60 c                   eval      w_toti = 0
5.60 c                   eval      w_totr = 0
5.60  *
5.60 c     lodtlr_key    setll     lodtlr
5.60 c     lodtlr_key    reade     lodtlr
5.60 c                   dow       not %eof
5.60 c                   eval      w_totk = w_totk + ldsumk
5.60 c                   eval      w_toti = w_toti + ldsumi
5.60 c                   eval      w_totr = w_totr + ldsumr
5.60 c     lodtlr_key    reade     lodtlr
5.60 c                   enddo
5.60  *
5.60 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for les av Ordre-linje-register
      *
     c     fodtl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtl2_numm
     c                   kfld                    fodtl2_suff
     c                   kfld                    fodtl2_ldor
      *
      * Key for les av Ordre-linje-register  key2
      *
     c     fodtl2_ke2    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtl2_numm
     c                   kfld                    fodtl2_suff
     c                   kfld                    fodtl2_ldor
      *
      * Key for oppdatering av Ordre-linje-register
      *
     c     fodtlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtlu_numm
     c                   kfld                    fodtlu_suff
     c                   kfld                    fodtlu_line
      *
      * Key for les av Ordre-hode-register
      *
     c     fohel1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fohel1_numm
     c                   kfld                    fohel1_suff
3.17  *
3.17  * Key for les av Ordre-hode-register, for bestilling
3.17  *
3.17 c     lohel1_key    klist
3.17 c                   kfld                    w_firm
3.17 c                   kfld                    lohel1_numm
3.17 c                   kfld                    lohel1_suff
3.17  *
3.17  * Key for oppdatering av Ordre-hode-register, for bestilling
3.17  *
3.17 c     lohelu_key    klist
3.17 c                   kfld                    w_firm
3.17 c                   kfld                    lohelu_numm
3.17 c                   kfld                    lohelu_suff
3.17  *
3.17  * Key for les av Ordre-linje-register, for bestilling
3.17  *
3.17 c     lodtl1_key    klist
3.17 c                   kfld                    w_firm
3.17 c                   kfld                    lodtl1_numm
3.17 c                   kfld                    lodtl1_suff
3.17 c                   kfld                    lodtl1_line
3.17  *
3.17  * Key for oppdatering av Ordre-linje-register, for bestilling
3.17  *
3.17 c     lodtlu_key    klist
3.17 c                   kfld                    w_firm
3.17 c                   kfld                    lodtlu_numm
3.17 c                   kfld                    lodtlu_suff
3.17 c                   kfld                    lodtlu_line
5.60  *
5.60 c     lodtlr_key    klist
5.60 c                   kfld                    w_firm
5.60 c                   kfld                    lodtlr_numm
5.60 c                   kfld                    lodtlr_suff
      *
      * Key for file : Leverandør-register
      *
     c     rlevl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevl1_levr
      *
5.32  * Key for file : KUNDE-REGISTER
5.32  *
5.32 c     rkunl1_key    klist
5.32 c                   kfld                    w_firm
5.32 c                   kfld                    rkunl1_kund
      *
      * Key for file : Vare-register
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for file : Ordre-type-register
      *
     c     votyl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    votyl1_otyp
6.21  *
6.21  * Key for file : Vare-enhet register
6.21  *
6.21 c     vvenl1_key    klist
6.21 c                   kfld                    w_firm
6.21 c                   kfld                    vvenl1_vare
6.21 c                   kfld                    vvenl1_enhe
6.21  *
6.21  *  Key for oppdatering av FORSLAG-HODE
6.21  *
6.21 c     lfhelu_key    klist
6.21 c                   kfld                    w_firm
6.21 c                   kfld                    lfhelu_numm
      *
      * Key for file : Status-koder Ofak
      *
     c     fstsl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for file : Status-koder Lager
      *
     c     lstsl1_key    klist
     c                   kfld                    w_firm
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_firm
6.NU c                   parm                    p_numm
     c                   parm                    p_suff
6.NU c                   parm                    p_best
     c                   parm                    p_ldor
      *
      * Legger inn firmanummer
      *
     c                   eval      w_firm = p_firm
     c                   eval      w_numm = p_numm
     c                   eval      w_suff = p_suff
     c                   eval      w_best = p_best
     c                   eval      w_ldor = p_ldor
      *
      * Legger inn ordrenummer og suffix i nøklene
      *
     c                   eval      fohel1_numm = p_numm
     c                   eval      fohel1_suff = p_suff
      *
     c                   eval      fodtl2_numm = p_numm
     c                   eval      fodtl2_suff = p_suff
     c                   eval      fodtl2_ldor = p_ldor
      *
     c                   eval      fodtlu_numm = p_numm
     c                   eval      fodtlu_suff = p_suff
     c                   eval      fodtlu_line = 0
      *
     c                   eval      lohel1_numm = p_best
     c                   eval      lohel1_suff = 0
      *
     c                   eval      lodtl1_numm = p_best
     c                   eval      lodtl1_suff = 0
      *
      * Henter opplysninger fra Ofak-status-register
      *
     c     fstsl1_key    chain     fstsl1r
      *
6.21  *
6.21  * Henter opplysninger fra Ofak-status-register
6.21  *
6.21 c     fstsl1_key    chain     fstsl1r
      *
      * Henter opplysninger fra Lager-status-register
      *
     c     lstsl1_key    chain     lstsl1r
      *
     c                   time                    w_date
     c                   time                    w_time
      *
     c                   endsr
