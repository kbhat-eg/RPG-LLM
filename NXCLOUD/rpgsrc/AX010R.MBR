      /title  Vedlikehold av faste opplysinger for ALTINN
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  System. . . . . :
      *  Program . . . . : AX010R
      *  Beskrivelse . . : Vedlikehold av faste opplysinger for ALTINN
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Spesialversjon. :
      *  Tilpasset for . :
      *
Versj *Uts   Dato Usr Referanse Beskrivelse
      *____________________________________________________________________________________________
      *K00-200420               START FOR VERSJON K00
7.00  *K00 200420 SST NXS-4426  Utrulling av SAFT-Rapporter til alle kundene
      *
      *
      *
      *____________________________________________________________________________________________
      *
     fax010d    cf   e             workstn
     fafirl1    if   e           k disk
      *
     frxmmlu    uf a e           k disk     rename(rxmmpfr:rxmmlur)
      *
      *
      * Definering av n√∏kler
      *
     d w_firm          s                       like(xmfirm)
      *
      *
      * Definering av local data area
      *
     d                uds
     d l_fper                  1      6
     d l_tper                  7     12
     d l_kom1                 13     30
     d l_kom2                 31     62
     d l_head                 63     63
     d l_ktop                 64     64
     d l_kund                 65     65
     d l_levr                 66     66
     d l_moms                 67     67
     d l_kodr                 68     68
     d l_hbok                 69     69
      *
     d l_wsid                901    910
     d l_user                911    920
     d l_filg                931    933
     d l_firm                944    946  0
     d l_avde                947    950  0
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedlogikk
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     rxmmlu_key    chain     rxmmlu
     c                   if        not %found(rxmmlu)
     c                   eval      xmvena = 'NEXSTEP'
     c                   eval      xmvenr = '7.00'
     c                   eval      xmalfa = '1X1'
     c                   eval      xmregi = *blank
     c                   eval      xmfnav = *blank
     c                   eval      xmenav = *blank
     c                   eval      xmtele = *blank
     c                   eval      xmmobi = *blank
     c                   eval      xmemal = *blank
     c                   endif
     c                   eval      p_vena = xmvena
     c                   eval      p_venr = xmvenr
     c                   eval      p_alfa = xmalfa
     c                   eval      p_regi = xmregi
     c                   eval      p_fnav = xmfnav
     c                   eval      p_enav = xmenav
     c                   eval      p_tele = xmtele
     c                   eval      p_mobi = xmmobi
     c                   movel     xmemal        p_ema1
     c                   move      xmemal        p_ema2
      *
     c     a2taga        tag
      *
      * Sender opp skjermbildet
      *
     c                   exfmt     a1win
      *
      * Annullere registrering.
      *
     c                   if        *inkc = *on
     c                   goto      xslutt
     c                   endif
      *
      * Sjekk om noen valg er foretatt
      *
     c                   if        p_vena = *blank  or
     c                             p_venr = *blank  or
     c                             p_alfa = *blank  or
     c                             p_regi = *blank  or
     c                             p_fnav = *blank  or
     c                             p_fnav = *blank  or
     c                             p_tele = *blank  or
     c                             p_mobi = *blank  or
     c                             p_ema1 = *blank
     c                   goto      a2taga
     c                   endif
      *
      *  Parameter er ok og vi kan avslutte
      *
     c                   eval      xmvena = p_vena
     c                   eval      xmvenr = p_venr
     c                   eval      xmalfa = p_alfa
     c                   eval      xmregi = p_regi
     c                   eval      xmfnav = p_fnav
     c                   eval      xmenav = p_enav
     c                   eval      xmtele = p_tele
     c                   eval      xmmobi = p_mobi
     c                   movel     p_ema1        xmemal
     c                   move      p_ema2        xmemal
      *
     c                   if        %found(rxmmlu)
     c                   update    rxmmlur
     c                   else
     c                   move      l_firm        xmfirm
     c                   write     rxmmlur
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *   Slutt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *inzsr        begsr
      *
     c     rxmmlu_key    klist
     c                   kfld                    w_firm
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *                           Legger inn verdier i felter
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c                   eval      w_alin = 3
     c                   eval      w_apos = 5
     c                   write     s1win
      *
     c                   move      l_firm        w_firm
      *
     c                   endsr
