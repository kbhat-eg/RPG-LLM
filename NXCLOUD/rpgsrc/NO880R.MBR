     h option(*nodebugio) datedit(*dmy)
      *
      * System  . . . . : ASOFAK
      * Program . . . . : NO8080R
      * Beskrivelse . . : innlesning fra Winner temporær fil
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       050219 ASK  Nytt program
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fwimpi1    if   e           k disk    rename(wimpst:wimpi1r)
     fnowhiu    uf a e           k disk    rename(nowhst:nowhiur)
     fnowliu    uf a e           k disk    rename(nowlst:nowliur)
      *fwimpiu    uf   e           k disk    rename(wimpst:wimpiur)
      *
      * Definering av parametre
      *
     d p_firm          s              3  0
     d p_eksk          s             30
     d p_date          s              8  0
     d p_time          s              6  0
     d p_lage          s              2
     d p_avde          s              4  0
     d p_stat          s              1  0
      *
      * Datastruktur for lesing av temporær fil
      *
     d d_trec          ds
     d  d_recty                       3
     d  d_fill                        1
     d  d_line                      496
      *
      * Definering av variabler i nøkler
      *
     d nowhiu_date     s                   like(nwhdat)
     d nowhiu_time     s                   like(nwhtim)
     d nowliu_date     s                   like(nwldat)
     d nowliu_time     s                   like(nwltim)
     d wimpi1_ekst     s                   like(nwikey)
     d wimpiu_ekst     s                   like(nwikey)
      *
      * Definering av variable
      *
     d w_firm          s                   like(p_firm)
     d w_date          s               d   datfmt(*iso)
     d w_time          s               t   timfmt(*iso)
     d w_pb            s              3  0
     d w_ps            s              3  0
     d w_lg            s              3  0
     d w_data          s             10
     d w_datn          s              8  0
     d w_ltyp          s              1
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedrutine - leser import Winner fil og behandler aktuelle recordtyper
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     wimpi1_key    setll     wimpi1
     c     wimpi1_key    reade     wimpi1
     c                   dow       not %eof
     c                   eval      d_trec = nwirec
      *
      * Sjekk om start record
      *
     c                   if        %subst(d_recty:1:2) = '0;'
     c                   goto      les_neste
     c                   endif
      *
      * Sjekk om hode eller linjedata
      *
     c                   if        d_recty < '500'
     c                   exsr      oppr_hode
     c                   else
     c                   exsr      oppr_linje
     c                   endif
      *
     c     les_neste     tag
     c     wimpi1_key    reade     wimpi1
     c                   enddo
      *
      * Logger status oppdatert
      *
     c                   exsr      log_oppd
      *
      * Skriver inn i eksternordresystemet
      *
     c                   eval      p_date = %dec(w_date:*iso)
     c                   eval      p_time = %dec(w_time:*iso)
      *
     c                   call      'NO881R'
     c                   parm                    w_firm
     c                   parm                    p_lage
     c                   parm                    p_avde
     c                   parm                    p_date
     c                   parm                    p_time
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Behandling av hodelinjer
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     oppr_hode     begsr
      *
      * Finner foretaksnummer på bestiller
      *
     c                   if        d_recty = '100'
     c                   eval      nwhreg = %subst(d_line:1:11)
     c                   endif
      *
      * Finner prosjekt informasjon
      *
      * 1 Prj.nummer
     c                   if        d_recty = '200'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhpnu = %dec(%subst(d_line:w_pb:w_lg):9:0)
      * 2 Prj.navn
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhpna = %subst(d_line:w_pb:w_lg)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 8 Prj.kunde
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhkun = %dec(%subst(d_line:w_pb:w_lg):6:0)
      * 9
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 10
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 11
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 12
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 13
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 14
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 15
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 16
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 17
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 18
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 19
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 20
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 21
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 22 Kundens ref
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhkrf = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner kundeinformasjon
      *
      * 1 Kundenavn
     c                   if        d_recty = '211'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhkna = %subst(d_line:w_pb:w_lg)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3 Kundeadrese
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhkad = %subst(d_line:w_pb:w_lg)
      * 4 Postnr
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhkpn = %subst(d_line:w_pb:w_lg)
      * 5 Poststed
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhkpa = %subst(d_line:w_pb:w_lg)
      * 6 Telefon
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhktl = %subst(d_line:w_pb:w_lg)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 8 Mobil
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhmob = %subst(d_line:w_pb:w_lg)
      * 9
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 10 Mail
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhmai = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner leveringsinformasjon
      *
      * 1 Leveringssted
     c                   if        d_recty = '212'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhlna = %subst(d_line:w_pb:w_lg)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3 Lev.adresse
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhlad = %subst(d_line:w_pb:w_lg)
      * 4 Lev.pnr
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhlpn = %subst(d_line:w_pb:w_lg)
      * 5 Lev.sted
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhlpa = %subst(d_line:w_pb:w_lg)
      * 6 Lev.tlf
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhltl = %subst(d_line:w_pb:w_lg)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 8 Lev. mob
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhlob = %subst(d_line:w_pb:w_lg)
      * 9
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 10 Lev. mail
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhlai = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner fakturainformasjon
      *
      * 1 Fakturamottaker
     c                   if        d_recty = '213'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhfna = %subst(d_line:w_pb:w_lg)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3 Fak.adresse
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhfad = %subst(d_line:w_pb:w_lg)
      * 4 Fak.pnr
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhfpn = %subst(d_line:w_pb:w_lg)
      * 5 Fak.sted
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhfpa = %subst(d_line:w_pb:w_lg)
      * 6 Fak.tlf
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhftl = %subst(d_line:w_pb:w_lg)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 8 Fak. mob
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhfob = %subst(d_line:w_pb:w_lg)
      * 9
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 10 Fak. mail
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhfai = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner dato informasjon
      *
      * 1
     c                   if        d_recty = '300'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4 Tilb.dato
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   eval      w_data = %scanrpl('/':'':w_data)
     c                   eval      w_data = %subst(w_data:5:4) +
     c                                      %subst(w_data:3:2) +
     c                                      %subst(w_data:1:2)
     c                   if        w_data <> *blank
     c                   eval      w_datn = %dec(w_data:8:0)
     c                   eval      nwhtda = %date(w_datn:*ISO)
     c                   endif
      * 5 Gyldig til
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   eval      w_data = %scanrpl('/':'':w_data)
     c                   eval      w_data = %subst(w_data:5:4) +
     c                                      %subst(w_data:3:2) +
     c                                      %subst(w_data:1:2)
     c                   if        w_data <> *blank
     c                   eval      w_datn = %dec(w_data:8:0)
     c                   eval      nwhgda = %date(w_datn:*ISO)
     c                   endif
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7 Lev.dato alt1
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   eval      w_data = %scanrpl('/':'':w_data)
     c                   eval      w_data = %subst(w_data:5:4) +
     c                                      %subst(w_data:3:2) +
     c                                      %subst(w_data:1:2)
     c                   if        w_data <> *blank
     c                   eval      w_datn = %dec(w_data:8:0)
     c                   eval      nwhlda = %date(w_datn:*ISO)
     c                   endif
      * 8 Lev.dato alt2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   eval      w_data = %scanrpl('/':'':w_data)
     c                   eval      w_data = %subst(w_data:5:4) +
     c                                      %subst(w_data:3:2) +
     c                                      %subst(w_data:1:2)
     c                   if        w_data <> *blank
     c                   eval      w_datn = %dec(w_data:8:0)
     c                   eval      nwhlda = %date(w_datn:*ISO)
     c                   endif
      *
     c                   endif
      *
      * Finner fraktkost
      *
      * 1
     c                   if        d_recty = '302'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4 Frakt
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwhfrk = 0
     c                   else
     c                   eval      nwhfrk = %dec(w_data:9:2)
     c                   endif
      *
     c                   endif
      *
      * Finner referanseinfo
      *
      * 1 Selger
     c                   if        d_recty = '303'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhsna = %subst(d_line:w_pb:w_lg)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7 Selger mail
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwhsma = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner referanseinfo
      *
      * 1
     c                   if        d_recty = '401'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      *
     c                   endif
      *
      * Finner referanseinfo
      *
      * 1
     c                   if        d_recty = '406'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      *
     c                   exsr      Skriv_hode
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Skriver hodelinje
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     skriv_hode    begsr
      *
     c                   eval      nwhstf = 'Overf.'
     c                   eval      nwhstd = w_date
     c                   eval      nwhstt = w_time
     c                   eval      nwhdat = w_date
     c                   eval      nwhtim = w_time
     c                   write     nowhiur
     c                   clear                   nowhiur
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Behandling av varelinjer
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     oppr_linje    begsr
      *
      *
      * Finner varelinje informasjon
      *
      * 1 varelinjenr
     c                   if        d_recty = '500'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwlvli = %dec(%subst(d_line:w_pb:w_lg):4:0)
      * 2 Tekstlinjenr
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwltli = %dec(%subst(d_line:w_pb:w_lg):4:0)
      * 3 Lev.vnr
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwllvn = %subst(d_line:w_pb:w_lg)
      * 4
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 8 Varetekst
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwltek = %subst(d_line:w_pb:w_lg)
      * 9 Antall
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwlant = 0
     c                   else
     c                   eval      nwlant = %dec(w_data:9:3)
     c                   endif
      * 10 Enhet
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwlenh = %subst(d_line:w_pb:w_lg)
      * 11
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 12
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 13 Katalogpris
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwlspr = 0
     c                   else
     c                   eval      nwlspr = %dec(w_data:9:2)
     c                   endif
      * 14 Kostpris
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwlkpr = 0
     c                   else
     c                   eval      nwlkpr = %dec(w_data:9:2)
     c                   endif
      * 15
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 16
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 17 Rab1
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwlra1 = 0
     c                   else
     c                   eval      nwlra1 = %dec(w_data:5:2)
     c                   endif
      * 18 Rab2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwlra2 = 0
     c                   else
     c                   eval      nwlra2 = %dec(w_data:5:2)
     c                   endif
      * 19 Rab3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
     c                   if        w_data = *blank
     c                   eval      nwlra3 = 0
     c                   else
     c                   eval      nwlra3 = %dec(w_data:5:2)
     c                   endif
      *
     c                   endif
      *
      * Finner varegruppe informasjon
      *
      * 1
     c                   if        d_recty = '505'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 7 Prod.grpnr
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwlgnr =%dec(%subst(d_line:w_pb:w_lg):3:0)
      * 8 Prod.grptek
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwlgna = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner hengsling
      *
      * 1
     c                   if        d_recty = '513'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_ltyp = %subst(d_line:w_pb:w_lg)
     c                   if        w_ltyp <> '1'
     c                   goto      forbi_513
     c                   endif
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 3
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 4 Hengsling?
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      w_data = %subst(d_line:w_pb:w_lg)
      * 5
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
      * 6 Hengsling kode
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   if        w_data = 'Hengsling'
     c                   eval      nwlhng =%dec(%subst(d_line:w_pb:w_lg):1:0)
     c                   endif
      *
     c     forbi_513     tag
     c                   endif
      *
      * Finner leverandørinfo
      *
      * 1 Kat.lev
     c                   if        d_recty = '520'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwllev = %subst(d_line:w_pb:w_lg)
      * 2
     c                   eval      w_pb = w_ps + 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwlkat = %subst(d_line:w_pb:w_lg)
      *
     c                   endif
      *
      * Finner Modell kode
      *
      * 1 Mod.kod
     c                   if        d_recty = '524'
     c                   eval      w_pb = 1
     c                   eval      w_ps = %scan(';' : d_line : w_pb)
     c                   eval      w_lg = w_ps - w_pb
     c                   eval      nwlmod = %subst(d_line:w_pb:w_lg)
      *
     c                   exsr      Skriv_linje
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Skriver varelinje
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     skriv_linje   begsr
      *
     c                   eval      nwldat = w_date
     c                   eval      nwltim = w_time
     c                   write     nowliur
     c                   clear                   nowliur
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Logg oppdaterong
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     log_oppd      begsr
      *
     c*    wimpiu_key    setll     wimpiu
     c*    wimpiu_key    reade     wimpiu
     c*                  dow       not %eof
     c*                  eval      nwistf = 'Oppd.'
     c*                  eval      nwistd = w_date
     c*                  eval      nwistt = w_time
     c*                  update    wimpiur
     c*    wimpiu_key    reade     wimpiu
     c*                  enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for feilhåndtering - setter status = 9
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *pssr         begsr
      *
     c                   eval      p_stat= 9
     c                   goto      avslutt
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_eksk
     c                   parm                    p_lage
     c                   parm                    p_avde
     c                   parm                    p_stat
      *
      * Key for Winner importfil
      *
     c     wimpi1_key    klist
     c                   kfld                    wimpi1_ekst
      *
      * Key for Winner oppdatering av importfil
      *
     c     wimpiu_key    klist
     c                   kfld                    wimpiu_ekst
      *
      * Key for Winner ordrehode
      *
     c     nowhiu_key    klist
     c                   kfld                    nowhiu_date
     c                   kfld                    nowhiu_time
      *
      * Key for Winner ordrelinjer
      *
     c     nowliu_key    klist
     c                   kfld                    nowliu_date
     c                   kfld                    nowliu_time
      *
     c                   eval      w_firm = p_firm
     c                   eval      wimpi1_ekst = p_eksk
     c                   eval      wimpiu_ekst = p_eksk
     c                   time                    w_date
     c                   time                    w_time
      *
     c                   endsr
