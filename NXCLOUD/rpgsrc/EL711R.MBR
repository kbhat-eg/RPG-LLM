     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : EL711R
      * Beskrivelse . . : Leverandør bonus, beregner og oppdaterer bonus
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       281005 HKO  Nytt program
      *       071105 HKO  Håndterer bonusbeløp og enhet knyttet mot element
      * 6.10  220609 BSA  Oppdatert med sporingsinformasjon
      *
8.01  *K0000  180124 BSA  Hvis grunnlag er 0, feiler programmet.
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     felboi1    if   e           k disk    rename(elbost:elboi1r)
     felboiu    uf   e           k disk    rename(elbost:elboiur)
     felbeiu    uf   e           k disk    rename(elbest:elbeiur)
     felbei2    uf   e           k disk    rename(elbest:elbei2r)
     fsistl6    if   e           k disk    rename(sistpfr:sistl6r)
     fsistlu    uf   e           k disk    rename(sistpfr:sistlur)
     f                                     prefix(su:2)
      *
      * Definering av parametre
      *
     d p_firm          s              3
     d p_blev          s              6
     d p_paar          s              4
      *
      * Definering av array
      *
     d a_boty          s              2    dim(99)
      *
      * Definering av variable i nøkler
      *
     d elboi1_ldor     s                   like(elldor)
     d elboi1_ogrp     s                   like(elogrp)
     d elboi1_hgrp     s                   like(elhgrp)
     d elboi1_ugrp     s                   like(elugrp)
     d elboi1_modn     s                   like(elmodn)
     d elboi1_vare     s                   like(elvare)
     d elboi1_enhe     s                   like(elenhe)
     d elboi1_lety     s                   like(ellety)
     d elbei2_eldo     s                   like(eleldo)
     d elbei2_eogr     s                   like(eleogr)
     d elbei2_ehgr     s                   like(elehgr)
     d elbei2_eugr     s                   like(eleugr)
     d elbei2_emod     s                   like(elemod)
     d elbei2_evar     s                   like(elevar)
     d elbei2_eenh     s                   like(eleenh)
     d elbei2_elet     s                   like(elelet)
     d elbei2_ebot     s                   like(elebot)
     d elbei2_efda     s                   like(elefda)
     d elbei2_etda     s                   like(eletda)
     d elboiu_ldor     s                   like(elldor)
     d elboiu_ogrp     s                   like(elogrp)
     d elboiu_hgrp     s                   like(elhgrp)
     d elboiu_ugrp     s                   like(elugrp)
     d elboiu_modn     s                   like(elmodn)
     d elboiu_vare     s                   like(elvare)
     d elboiu_enhe     s                   like(elenhe)
     d elboiu_lety     s                   like(ellety)
     d elboiu_boty     s                   like(elboty)
     d elboiu_fdat     s                   like(elfdat)
     d elboiu_tdat     s                   like(eltdat)
     d sistlu_ornr     s                   like(siornr)
     d sistlu_orsu     s                   like(siorsu)
     d sistlu_orli     s                   like(siorli)
      *
      * Definering av Local data area
      *
6.10 d                uds
6.10 d l_user                911    920
      *
      * Definering av variable
      *
     d b_hele          s              1    inz(*off)
     d b_bonu          s              1    inz(*off)
      *
     d w_arnr          s              2  0
      *
     d w_firm          s                   like(elfirm)
     d w_blev          s                   like(elblev)
     d w_paar          s                   like(sipaar)
     d w_sumn          s                   like(sisumb)
     d w_tbel          s                   like(elebgt)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Nullstiller bonusgrunnlag og kalkulet bonus for alle nivåer for
      * bonusleverandør
      * Dersom det er lagt inn bonus mot leverandør settes flagg for å
      * markere at hele innkjøpsstatistikken må leses
      *
     c     elboiu_key2   setll     elboiu
     c     elboiu_key2   reade     elboiur
     c                   dow       not %eof
     c                   if        elldor <> 0 and
     c                             elldor <> w_blev
     c                   eval      b_hele = *on
     c                   endif
     c                   eval      elbgru = 0
     c                   eval      elsbon = 0
     c                   eval      elbdat = *loval
     c                   eval      elbtim = *loval
      *
     c                   time                    eletim
     c                   time                    eledat
     c                   eval      eleusr = l_user
     c                   update    elboiur
     c     elboiu_key2   reade     elboiur
     c                   enddo
      *
     c     elbeiu_key2   setll     elbeiu
     c     elbeiu_key2   reade     elbeiur
     c                   dow       not %eof
     c                   eval      elesbo = 0
     c                   eval      elebda = *loval
     c                   eval      elebti = *loval
6.10 c                   time                    eleeda
6.10 c                   time                    eleeti
6.10 c                   eval      eleeus = l_user
     c                   update    elbeiur
     c     elbeiu_key2   reade     elbeiur
     c                   enddo
      *
      * Summerer og lagrer bonusgrunnlag innenfor hvert nivå
      *
     c                   exsr      bonusgrunnlag
      *
      * Kalkulerer bonus for hvert bonuselement
      *
     c                   exsr      bonus
      *
      * Oppdaterer statistikk med andel av kalkulert bonus
      *
     c                   exsr      statistikk
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Summerer og lagrer bonusgrunnlag innenfor hvert nivå
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bonusgrunnlag begsr
      *
      * Leser og behandler innkjøpsstatistikk for valg år
      * En vare kan ha bonus mot flere bonustyper og hver vare må derfor
      * summeres inn i bonusgrunnlaget pr. nivå/bonustype
      * Takler ikke overlappende datointervall
      *
     c                   if        b_hele = *on
     c     sistl6_key2   setll     sistl6
     c     sistl6_key2   reade     sistl6
     c                   else
     c     sistl6_key    setll     sistl6
     c     sistl6_key    reade     sistl6
     c                   endif
     c                   dow       not %eof
      *
     c                   eval      w_arnr = 0
     c                   eval      a_boty(*) = *blank
      *
     c                   dou       b_bonu = *off
      *
     c                   exsr      bonusnivÅ
      *
     c                   if        b_bonu = *on
     c                   eval      w_arnr = w_arnr + 1
     c                   eval      a_boty(w_arnr) = elboty
     c                   eval      elboiu_ldor = elldor
     c                   eval      elboiu_ogrp = elogrp
     c                   eval      elboiu_hgrp = elhgrp
     c                   eval      elboiu_ugrp = elugrp
     c                   eval      elboiu_modn = elmodn
     c                   eval      elboiu_vare = elvare
     c                   eval      elboiu_enhe = elenhe
     c                   eval      elboiu_lety = ellety
     c                   eval      elboiu_boty = elboty
     c                   eval      elboiu_fdat = elfdat
     c                   eval      elboiu_tdat = eltdat
     c     elboiu_key    chain     elboiur
     c                   eval(h)   w_sumn = sisumb - sirab1 - sirab2 -
     c                                      sirabo
     c                   eval(h)   elbgru = elbgru + w_sumn
     c                   time                    elbdat
     c                   time                    elbtim
6.10 c                   time                    eletim
6.10 c                   time                    eledat
6.10 c                   eval      eleusr = l_user
     c                   update    elboiur
     c                   endif
      *
     c                   enddo
      *
     c                   if        b_hele = *on
     c     sistl6_key2   reade     sistl6
     c                   else
     c     sistl6_key    reade     sistl6
     c                   endif
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Kalkulerer bonus for hvert bonuselement
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bonus         begsr
      *
      * Kalkulerer bonusandel pr. bonusleverandør-element og lagrer denne
      * Takler ikke overlappende beløpsgrenser
      *
     c     elboiu_key2   setll     elboiu
     c     elboiu_key2   reade     elboiur
     c                   dow       not %eof
      *
     c                   if        elbgru <> 0
      *
     c                   eval      elbei2_eldo = elldor
     c                   eval      elbei2_eogr = elogrp
     c                   eval      elbei2_ehgr = elhgrp
     c                   eval      elbei2_eugr = elugrp
     c                   eval      elbei2_emod = elmodn
     c                   eval      elbei2_evar = elvare
     c                   eval      elbei2_eenh = elenhe
     c                   eval      elbei2_elet = ellety
     c                   eval      elbei2_ebot = elboty
     c                   eval      elbei2_efda = elfdat
     c                   eval      elbei2_etda = eltdat
     c     elbei2_key    setll     elbei2
     c     elbei2_key    reade     elbei2r
     c                   dow       not %eof
      *
     c                   if        elebgf <= elbgru
      *
     c                   time                    elebda
     c                   time                    elebti
      *
     c                   if        elebgf = 0 and
     c                             elebgt = 0
     c                   eval(h)   elesbo = elbgru * elebpr / 100
6.10 c                   time                    eleeda
6.10 c                   time                    eleeti
6.10 c                   eval      eleeus = l_user
     c                   update    elbei2r
     c                   eval      elsbon = elsbon + elesbo
     c                   leave
     c                   endif
      *
     c                   if        elebgt < elbgru
     c                   eval      w_tbel = elebgt
     c                   else
     c                   eval      w_tbel = elbgru
     c                   endif
      *
     c                   if        elektb = 1
     c                   eval(h)   elesbo = w_tbel * elebpr / 100
6.10 c                   time                    eleeda
6.10 c                   time                    eleeti
6.10 c                   eval      eleeus = l_user
     c                   update    elbei2r
     c                   eval      elsbon = elsbon + elesbo
     c                   leave
     c                   endif
      *
     c                   eval(h)   elesbo = (w_tbel - elebgf) * elebpr / 100
      *
6.10 c                   time                    eleeda
6.10 c                   time                    eleeti
6.10 c                   eval      eleeus = l_user
     c                   update    elbei2r
      *
     c                   eval      elsbon = elsbon + elesbo
      *
     c                   endif
      *
     c     elbei2_key    reade     elbei2r
     c                   enddo
      *
     c                   endif
      *
6.10 c                   time                    eletim
6.10 c                   time                    eledat
6.10 c                   eval      eleusr = l_user
     c                   update    elboiur
      *
     c     elboiu_key2   reade     elboiur
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Oppdaterer innkjøpsstatistkken med andel av bonus pr. salg
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     statistikk    begsr
      *
     c                   if        b_hele = *on
     c     sistl6_key2   setll     sistl6
     c     sistl6_key2   reade     sistl6
     c                   else
     c     sistl6_key    setll     sistl6
     c     sistl6_key    reade     sistl6
     c                   endif
     c                   dow       not %eof
      *
     c                   eval      silebo = 0
     c                   eval      w_arnr = 0
     c                   eval      a_boty(*) = *blank
      *
     c                   dou       b_bonu = *off
      *
     c                   exsr      bonusnivÅ
      *
8.01 c                   if        elbgru = 0
8.01 c                   eval      elbgru = 1
8.01 c                   endif
      *
     c                   if        b_bonu = *on
     c                   eval      w_arnr = w_arnr + 1
     c                   eval      a_boty(w_arnr) = elboty
     c                   eval(h)   w_sumn = sisumb - sirab1 - sirab2 -
     c                                      sirabo
     c                   eval(h)   silebo = silebo +
     c                                      elsbon * (w_sumn / elbgru)
     c                   eval      sistlu_ornr = siornr
     c                   eval      sistlu_orsu = siorsu
     c                   eval      sistlu_orli = siorli
     c     sistlu_key    chain     sistlur
     c                   eval      sulebo = silebo
     c                   update    sistlur
     c                   endif
      *
     c                   enddo
      *
     c                   if        b_hele = *on
     c     sistl6_key2   reade     sistl6
     c                   else
     c     sistl6_key    reade     sistl6
     c                   endif
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å finne bonusnivå for vare
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bonusnivÅ     begsr
      *
     c                   eval      b_bonu = *off
      *
      * Avbryter dersom vareleverandør ikke er utfylt i statistikken
      *
     c                   if        sivaln = 0
     c                   leavesr
     c                   endif
      *
      * Nivårekkefølge:
      *
      *  Leverandør
      *    Overgruppe
      *      Hovedgruppe
      *        Undergruppe
      *          Modul
      *            Vare
      *              Enhet
      *                Leveringstype
      *  _______________
      *  x - - - - x x x   1. Lev,vare,enh,lt
      *  x - - - - x - x   2. Lev,vare,lt
      *  x - - - - x x 0   3. Lev,vare,enh,lt=0
      *  x - - - - x - 0   4. Lev,vare,lt=0
      *  x - - - x - x x   5. Lev,modul,enh,lt
      *  x - - - x - - x   6. Lev,modul,lt
      *  x - - - x - x 0   7. Lev,modul,enh,lt=0
      *  x - - - x - - 0   8. Lev,modul,lt=0
      *  x x x x - - x x   9. Lev,ogr,hgr,ugr,enh,lt
      *  x x x x - - - x  10. Lev,ogr,hgr,ugr,lt
      *  x x x x - - x 0  11. Lev,ogr,hgr,ugr,enh,lt=0
      *  x x x x - - - 0  12. Lev,ogr,hgr,ugr,lt=0
      *  x x x - - - x x  13. Lev,ogr,hgr,enh,lt
      *  x x x - - - - x  14. Lev,ogr,hgr,lt
      *  x x x - - - x 0  15. Lev,ogr,hgr,enh,lt=0
      *  x x x - - - - 0  16. Lev,ogr,hgr,lt=0
      *  x x - - - - x x  17. Lev,ogr,enh,lt
      *  x x - - - - - x  18. Lev,ogr,lt
      *  x x - - - - x 0  19. Lev,ogr,enh,lt=0
      *  x x - - - - - 0  20. Lev,ogr,lt=0
      *  x - - - - - x x  21. Lev,enh,lt
      *  x - - - - - - x  22. Lev,lt
      *  x - - - - - x 0  23. Lev,enh,lt=0
      *  x - - - - - - 0  24. Lev,lt=0
      *
      *  - - - - - x x x  25. Vare,enh,lt
      *  - - - - - x - x  26. Vare,lt
      *  - - - - - x x 0  27. Vare,enh,lt=0
      *  - - - - - x - 0  28. Vare,lt=0
      *  - - - - x - x x  29. Modul,enh,lt
      *  - - - - x - - x  30. Modul,lt
      *  - - - - x - x 0  31. Modul,enh,lt=0
      *  - - - - x - - 0  32. Modul,lt=0
      *  - x x x - - x x  33. Ogr,hgr,ugr,enh,lt
      *  - x x x - - - x  34. Ogr,hgr,ugr,lt
      *  - x x x - - x 0  35. Ogr,hgr,ugr,enh,lt=0
      *  - x x x - - - 0  36. Ogr,hgr,ugr,lt=0
      *  - x x - - - x x  37. Ogr,hgr,enh,lt
      *  - x x - - - - x  38. Ogr,hgr,lt
      *  - x x - - - x 0  39. Ogr,hgr,enh,lt=0
      *  - x x - - - - 0  40. Ogr,hgr,lt=0
      *  - x - - - - x x  41. Ogr,enh,lt
      *  - x - - - - - x  42. Ogr,lt
      *  - x - - - - x 0  43. Ogr,enh,lt=0
      *  - x - - - - - 0  44. Ogr,lt=0
      *  - - - - - - x x  45. Enh,lt
      *  - - - - - - - x  46. Lt
      *  - - - - - - x 0  47. Enh,lt=0
      *  - - - - - - - 0  48. Lt=0
      *
      * Leverandør
      *
      * 1.-4.
      *
     c                   eval      elboi1_ldor = sivaln
     c                   eval      elboi1_ogrp = 0
     c                   eval      elboi1_hgrp = 0
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = sivare
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 5.-8.
      *
     c                   if        simodn <> 0
      *
     c                   eval      elboi1_modn = simodn
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 9.-12.
      *
     c                   eval      elboi1_ogrp = siogrp
     c                   eval      elboi1_hgrp = sihgrp
     c                   eval      elboi1_ugrp = siugrp
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 13.-16.
      *
     c                   eval      elboi1_ogrp = siogrp
     c                   eval      elboi1_hgrp = sihgrp
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 17.-20.
      *
     c                   eval      elboi1_ogrp = siogrp
     c                   eval      elboi1_hgrp = 0
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 21.-24.
      *
     c                   eval      elboi1_ogrp = 0
     c                   eval      elboi1_hgrp = 0
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * Generell...
      * Behandler kun kjøp mot bonusleverandør som vareleverandør
      *
     c                   if        sivaln <> w_blev
     c                   leavesr
     c                   endif
      *
      * 25.-28.
      *
     c                   eval      elboi1_ldor = 0
     c                   eval      elboi1_ogrp = 0
     c                   eval      elboi1_hgrp = 0
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = sivare
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 29.-32.
      *
     c                   if        simodn <> 0
      *
     c                   eval      elboi1_modn = simodn
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endif
      *
      * 33.-36.
      *
     c                   eval      elboi1_ogrp = siogrp
     c                   eval      elboi1_hgrp = sihgrp
     c                   eval      elboi1_ugrp = siugrp
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 37.-40.
      *
     c                   eval      elboi1_ogrp = siogrp
     c                   eval      elboi1_hgrp = sihgrp
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 41.-44.
      *
     c                   eval      elboi1_ogrp = siogrp
     c                   eval      elboi1_hgrp = 0
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
      * 45.-48.
      *
     c                   eval      elboi1_ogrp = 0
     c                   eval      elboi1_hgrp = 0
     c                   eval      elboi1_ugrp = 0
     c                   eval      elboi1_modn = 0
     c                   eval      elboi1_vare = *blank
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = silety
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   if        silety <> 0
      *
     c                   eval      elboi1_enhe = sioenh
     c                   eval      elboi1_lety = 0
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   eval      elboi1_enhe = *blank
     c     elboi1_key    setll     elboi1
     c     elboi1_key    reade     elboi1
     c                   dow       not %eof
     c                   if        elfdat = *loval and
     c                             eltdat = *loval or
     c                             sibida >= elfdat and
     c                             sibida <= eltdat
     c                   if        %lookup(elboty:a_boty) = 0
     c                   eval      b_bonu = *on
     c                   leavesr
     c                   endif
     c                   endif
     c     elboi1_key    reade     elboi1
     c                   enddo
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_blev
     c                   parm                    p_paar
      *
      * Key for les på kundebonus
      *
     c     elboi1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_blev
     c                   kfld                    elboi1_ldor
     c                   kfld                    elboi1_ogrp
     c                   kfld                    elboi1_hgrp
     c                   kfld                    elboi1_ugrp
     c                   kfld                    elboi1_modn
     c                   kfld                    elboi1_vare
     c                   kfld                    elboi1_enhe
     c                   kfld                    elboi1_lety
      *
     c     elboi1_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    w_blev
      *
      * Key for oppdatering av kundebonus
      *
     c     elboiu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_blev
     c                   kfld                    elboiu_ldor
     c                   kfld                    elboiu_ogrp
     c                   kfld                    elboiu_hgrp
     c                   kfld                    elboiu_ugrp
     c                   kfld                    elboiu_modn
     c                   kfld                    elboiu_vare
     c                   kfld                    elboiu_enhe
     c                   kfld                    elboiu_lety
     c                   kfld                    elboiu_boty
     c                   kfld                    elboiu_fdat
     c                   kfld                    elboiu_tdat
      *
     c     elboiu_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    w_blev
      *
      * Key for oppdatering av kundebonus-element
      *
     c     elbei2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_blev
     c                   kfld                    elbei2_eldo
     c                   kfld                    elbei2_eogr
     c                   kfld                    elbei2_ehgr
     c                   kfld                    elbei2_eugr
     c                   kfld                    elbei2_emod
     c                   kfld                    elbei2_evar
     c                   kfld                    elbei2_eenh
     c                   kfld                    elbei2_elet
     c                   kfld                    elbei2_ebot
     c                   kfld                    elbei2_efda
     c                   kfld                    elbei2_etda
      *
     c     elbeiu_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    w_blev
      *
      * Key for les på innkjøpsstatistikk
      *
     c     sistl6_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_paar
     c                   kfld                    w_blev
      *
     c     sistl6_key2   klist
     c                   kfld                    w_firm
     c                   kfld                    w_paar
      *
      * Key for oppdatering av innkjøpsstatistikk
      *
     c     sistlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_paar
     c                   kfld                    sistlu_ornr
     c                   kfld                    sistlu_orsu
     c                   kfld                    sistlu_orli
      *
      *
      * Henter parameter
      *
     c                   move      p_firm        w_firm
     c                   move      p_blev        w_blev
     c                   move      p_paar        w_paar
      *
     c                   endsr
