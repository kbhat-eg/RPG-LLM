     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASVADM
      * Program . . . . : JV752R (Tatt utgangspunkt i JV750R på versjon 6.10
      * Beskrivelse . . : Vare, henter påslagsfaktor på innkjøpspris
      *
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       250110 BSA  Nytt program
6.30  *       050414 bof  Utvidet nøkkel i vare-pris med leverandør
5.30  *                   Fjernet JVPPPF
6.3x  * 6.30  310515 bof  Utvidet med prisgruppe
8.01  *PRG2   150622 bof  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
     fjvprl1    if   e           k disk    rename(jvprpfr:jvprl1r)
     fjvpkl1    if   e           k disk    rename(jvpkpfr:jvpkl1r)
     fjvpglr    if   e           k disk    rename(jvpgpfr:jvpglrr)
     fjforl5    if   e           k disk    rename(jforpfr:jforl5r)
     fjforl1    if   e           k disk    rename(jforpfr:jforl1r)
     fjbetlb    if   e           k disk    rename(jbetpfr:jbetlbr)
     fjbetlc    if   e           k disk    rename(jbetpfr:jbetlcr)
     fjbetl1    if   e           k disk    rename(jbetpfr:jbetl1r)
     fjrael1    if   e           k disk    rename(jraepfr:jrael1r)
     fjrael4    if   e           k disk    rename(jraepfr:jrael4r)
     fjpfala    if   e           k disk    rename(jpfapfr:jpfalar)
     fjpfalb    if   e           k disk    rename(jpfapfr:jpfalbr)
     fjpfal1    if   e           k disk    rename(jpfapfr:jpfal1r)
     fjwprl1    if   e           k disk    rename(jwprpfr:jwprl1r)
     fjlevl1    if   e           k disk    rename(jlevpfr:jlevl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvvenl1    if   e           k disk    rename(vvenpfr:vvenl1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
      *
      * Definering av parametre
      *
     d p_pkod          s              1
     d p_skod          s              1  0
6.10 d p_osts          s              1
     d p_ntpr          s              9  2
     d p_ifak          s              8  6
     d p_midl          s              1  0
     d p_inpr          s              9  2
     d p_kopr          s              9  2
     d p_s1pr          s              9  2
     d p_s1im          s              9  2
     d p_s2pr          s              9  2
     d p_s2im          s              9  2
     d p_s3pr          s              9  2
     d p_s3im          s              9  2
     d p_dekn          s              5  2
     d p_eldo          s              6  0
     d p_ofp1          s             12  6
     d p_ofp2          s             12  6
     d p_ofp3          s             12  6
     d p_ofv2          s             12  6
     d p_ofv3          s             12  6
     d p_ofi1          s             12  6
     d p_ofi2          s             12  6
     d p_ofi3          s             12  6
      *
     d p_firm          s              3  0
     d p_vare          s                   like(jvvare)
     d p_pgiv          s                   like(jxldor)
     d p_lety          s                   like(jclety)
5.70 d p_prgr          s                   like(jcprgr)
     d p_gprk          s              1  0
     d p_ldor          s                   like(jxldor)
     d p_lvar          s                   like(jvlvar)
     d p_nopr          s                   like(jxpris)
     d p_gdat          s                   like(jxgdat)
     d p_enhe          s                   like(jwenhe)
     d p_enh1          s                   like(jzenh1)
     d p_enh2          s                   like(jzenh2)
     d p_enh3          s                   like(jzenh3)
     d p_eni1          s                   like(jzeni1)
     d p_eni2          s                   like(jzeni2)
     d p_eni3          s                   like(jzeni3)
     d p_enp1          s                   like(jzenp1)
     d p_enp2          s                   like(jzenp2)
     d p_enp3          s                   like(jzenp3)
     d p_bldo          s                   like(jpldor)
     d p_bogr          s                   like(jpogrp)
     d p_bhgr          s                   like(jphgrp)
     d p_bugr          s                   like(jpugrp)
     d p_bmod          s                   like(jpmodn)
     d p_bvar          s                   like(jpvare)
     d p_bvty          s                   like(jpvtyp)
     d p_blet          s                   like(jplety)
     d p_bbet          s                   like(jpbeti)
     d p_pogr          s                   like(jcogrp)
     d p_phgr          s                   like(jchgrp)
     d p_pugr          s                   like(jcugrp)
     d p_pldo          s                   like(jcldor)
     d p_pmod          s                   like(jcmodn)
     d p_pvar          s                   like(jcvare)
     d p_ppko          s                   like(jckpri)
     d p_pvty          s                   like(jcvtyp)
     d p_plet          s                   like(jclety)
     d p_kfak          s                   like(jckofa)
     d p_kbel          s                   like(jckobe)
     d p_sfak          s                   like(jcsafa)
5.70 d p_prut          s                   like(jcprgr)
      *
      * Definering av variabler i nøkler
      *
     d jvarl1_vare     s                   like(jvvare)
     d jvprl1_vare     s                   like(jxvare)
     d jvprl1_ldor     s                   like(jxldor)
     d jvpkl1_vare     s                   like(jwvare)
     d jvpkl1_ldor     s                   like(jwldor)
     d jvpglr_vare     s                   like(jwgvar)
     d jforl5_vare     s                   like(jzvare)
     d jforl1_ogrp     s                   like(jzogrp)
     d jforl1_hgrp     s                   like(jzhgrp)
     d jforl1_ugrp     s                   like(jzugrp)
     d jforl1_ldor     s                   like(jzldor)
     d jforl1_modn     s                   like(jzmodn)
     d jforl1_vare     s                   like(jzvare)
     d jbetlb_ldor     s                   like(jpldor)
     d jbetlb_vare     s                   like(jpvare)
6.3x d jbetlb_prgr     s                   like(jpprgr)
     d jbetlb_vtyp     s                   like(jpvtyp)
     d jbetlb_lety     s                   like(jplety)
     d jbetlc_ldor     s                   like(jpldor)
     d jbetlc_modn     s                   like(jpmodn)
     d jbetlc_vare     s                   like(jpvare)
6.3x d jbetlc_prgr     s                   like(jpprgr)
     d jbetlc_vtyp     s                   like(jpvtyp)
     d jbetlc_lety     s                   like(jplety)
     d jbetl1_ldor     s                   like(jpldor)
6.3x d jbetl1_prgr     s                   like(jpprgr)
     d jbetl1_ogrp     s                   like(jpogrp)
     d jbetl1_hgrp     s                   like(jphgrp)
     d jbetl1_ugrp     s                   like(jpugrp)
     d jbetl1_modn     s                   like(jpmodn)
     d jbetl1_vare     s                   like(jpvare)
     d jbetl1_vtyp     s                   like(jpvtyp)
     d jbetl1_lety     s                   like(jplety)
     d jrael1_eldo     s                   like(jpeldo)
6.3x d jrael1_eprg     s                   like(jpeprg)
     d jrael1_eogr     s                   like(jpeogr)
     d jrael1_ehgr     s                   like(jpehgr)
     d jrael1_eugr     s                   like(jpeugr)
     d jrael1_emod     s                   like(jpemod)
     d jrael1_evar     s                   like(jpevar)
     d jrael1_evty     s                   like(jpevty)
     d jrael1_elet     s                   like(jpelet)
     d jrael1_ebrs     s                   like(jpebrs)
     d jrael1_ebli     s                   like(jpebli)
     d jrael4_eldo     s                   like(jpeldo)
     d jrael4_eprg     s                   like(jpeprg)
     d jrael4_eogr     s                   like(jpeogr)
     d jrael4_ehgr     s                   like(jpehgr)
     d jrael4_eugr     s                   like(jpeugr)
     d jrael4_emod     s                   like(jpemod)
     d jrael4_evar     s                   like(jpevar)
     d jrael4_evty     s                   like(jpevty)
     d jrael4_elet     s                   like(jpelet)
     d jrael4_ebrs     s                   like(jpebrs)
     d jrael4_ebli     s                   like(jpebli)
     d jrael4_eakt     s                   like(jpeakt)
     d jpfala_vare     s                   like(jcvare)
5.70 d jpfala_prgr     s                   like(jcprgr)
     d jpfala_ldor     s                   like(jcldor)
     d jpfala_kpri     s                   like(jckpri)
     d jpfala_vtyp     s                   like(jcvtyp)
     d jpfala_lety     s                   like(jclety)
     d jpfalb_modn     s                   like(jcmodn)
     d jpfalb_ldor     s                   like(jcldor)
     d jpfalb_vare     s                   like(jcvare)
5.70 d jpfalb_prgr     s                   like(jcprgr)
     d jpfalb_kpri     s                   like(jckpri)
     d jpfalb_vtyp     s                   like(jcvtyp)
     d jpfalb_lety     s                   like(jclety)
5.70 d jpfal1_prgr     s                   like(jcprgr)
     d jpfal1_ogrp     s                   like(jcogrp)
     d jpfal1_hgrp     s                   like(jchgrp)
     d jpfal1_ugrp     s                   like(jcugrp)
     d jpfal1_ldor     s                   like(jcldor)
     d jpfal1_modn     s                   like(jcmodn)
     d jpfal1_vare     s                   like(jcvare)
     d jpfal1_kpri     s                   like(jckpri)
     d jpfal1_vtyp     s                   like(jcvtyp)
     d jpfal1_lety     s                   like(jclety)
     d jwprl1_vare     s                   like(jbvare)
     d jlevl1_ldor     s                   like(jlldor)
     d vvarl1_vare     s                   like(vvvare)
     d vvenl1_vare     s                   like(vevare)
     d vugrl1_uogr     s                   like(vguogr)
     d vugrl1_uhgr     s                   like(vguhgr)
     d vugrl1_uugr     s                   like(vguugr)
      *
      * Definering av variable
      *
     d b_akti          s              1    inz(*off)
5.70 d b_pasl          s              1    inz(*off)
      *
     d w_firm          s              3  0
     d w_mva           s              2  0
     d w_kode          s              1  0
     d w_tell          s              3  0
     d w_vtyp          s              1
6.12 d w_gvar          s                   like(jvvare)
6.12 d w_genh          s                   like(jvpenh)
6.12 d w_gsta          s              1
      *
     d w_ofp1          s                   like(jwofap)
     d w_ofp2          s                   like(jwofap)
     d w_ofp3          s                   like(jwofap)
     d w_ofv1          s                   like(jwofak)
     d w_ofv2          s                   like(jwofak)
     d w_ofv3          s                   like(jwofak)
     d w_ofi1          s                   like(jwofak)
     d w_ofi2          s                   like(jwofak)
     d w_ofi3          s                   like(jwofak)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      jvarl1_vare = p_vare
     c     jvarl1_key    chain     jvarl1
      *
      * Vare ble ikke funnet
      *
     c                   if        not %found
6.10 c                   eval      p_osts = '9'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekker varegruppe
      *
     c                   if        jvogrp = 0 or
     c                             jvhgrp = 0 or
     c                             jvugrp = 0
6.10 c                   eval      p_osts = '1'
     c                   goto      avslutt
     c                   endif
      *
     c                   eval      vugrl1_uogr = jvogrp
     c                   eval      vugrl1_uhgr = jvhgrp
     c                   eval      vugrl1_uugr = jvugrp
     c     vugrl1_key    chain     vugrl1
     c                   if        not %found
6.10 c                   eval      p_osts = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Henter påslagsfaktorer
      *
     c                   exsr      hent_pasl
      *
      * Henter enhet
      *
     c**                 exsr      hent_enhet
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente påslagsfaktorer - bruker først funnet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_pasl     begsr
      *
      * Leter etter påslag etter følgende rekkefølge:
      *
      * Overgruppe
      * | Hovedgruppe
      * | | Undergruppe
      * | | | Leverandør
      * | | | | Modul
      * | | | | | Vare
      * | | | | | | Priskode
      * | | | | | | | Varetype
      * | | | | | | | | Leveringstype
      * | | | | | | | | |
      * _________________
      * - - - x - x x x x    1. lev,vare,pk,vt,lt
      * - - - x - x x x 0    2. lev,vare,pk,vt,lt=0
      * - - - x - x x - x    3. lev,vare,pk,lt
      * - - - x - x x - 0    4. lev,vare,pk,lt=0
      * - - - x - x - x x    5. lev,vare,vt,lt
      * - - - x - x - x 0    6. lev,vare,vt,lt=0
      * - - - x - x - - x    7. lev,vare,lt
      * - - - x - x - - 0    8. lev,vare,lt=0
      * - - - - - x x x x    9. vare,pk,vt,lt
      * - - - - - x x x 0   10. vare,pk,vt,lt=0
      * - - - - - x x - x   11. vare,pk,lt
      * - - - - - x x - 0   12. vare,pk,lt=0
      * - - - - - x - x x   13. vare,vt,lt
      * - - - - - x - x 0   14. vare,vt,lt=0
      * - - - - - x - - x   15. vare,lt
      * - - - - - x - - 0   16. vare,lt=0
      * - - - x x - x x x   17. lev,modul,pk,vt,lt
      * - - - x x - x x 0   18. lev,modul,pk,vt,lt=0
      * - - - x x - x - x   19. lev,modul,pk,lt
      * - - - x x - x - 0   20. lev,modul,pk,lt=0
      * - - - x x - - x x   21. lev,modul,vt,lt
      * - - - x x - - x 0   22. lev,modul,vt,lt=0
      * - - - x x - - - x   23. lev,modul,lt
      * - - - x x - - - 0   24. lev,modul,lt=0
      * - - - - x - x x x   25. modul,pk,vt,lt
      * - - - - x - x x 0   26. modul,pk,vt,lt=0
      * - - - - x - x - x   27. modul,pk,lt
      * - - - - x - x - 0   28. modul,pk,lt=0
      * - - - - x - - x x   29. modul,vt,lt
      * - - - - x - - x 0   30. modul,vt,lt=0
      * - - - - x - - - x   31. modul,lt
      * - - - - x - - - 0   32. modul,lt=0
      * x x x x - - x x x   33. ogr,hgr,ugr,lev,pk,vt,lt
      * x x x x - - x x 0   34. ogr,hgr,ugr,lev,pk,vt,lt=0
      * x x x x - - x - x   35. ogr,hgr,ugr,lev,pk,lt
      * x x x x - - x - 0   36. ogr,hgr,ugr,lev,pk,lt=0
      * x x x x - - - x x   37. ogr,hgr,ugr,lev,vt,lt
      * x x x x - - - x 0   38. ogr,hgr,ugr,lev,vt,lt=0
      * x x x x - - - - x   39. ogr,hgr,ugr,lev,lt
      * x x x x - - - - 0   40. ogr,hgr,ugr,lev,lt=0
      * x x - x - - x x x   41. ogr,hgr,lev,pk,vt,lt
      * x x - x - - x x 0   42. ogr,hgr,lev,pk,vt,lt=0
      * x x - x - - x - x   43. ogr,hgr,lev,pk,lt
      * x x - x - - x - 0   44. ogr,hgr,lev,pk,lt=0
      * x x - x - - - x x   45. ogr,hgr,lev,vt,lt
      * x x - x - - - x 0   46. ogr,hgr,lev,vt,lt=0
      * x x - x - - - - x   47. ogr,hgr,lev,lt
      * x x - x - - - - 0   48. ogr,hgr,lev,lt=0
      * x - - x - - x x x   49. ogr,lev,pk,vt,lt
      * x - - x - - x x 0   50. ogr,lev,pk,vt,lt=0
      * x - - x - - x - x   51. ogr,lev,pk,lt
      * x - - x - - x - 0   52. ogr,lev,pk,lt=0
      * x - - x - - - x x   53. ogr,lev,vt,lt
      * x - - x - - - x 0   54. ogr,lev,vt,lt=0
      * x - - x - - - - x   55. ogr,lev,lt
      * x - - x - - - - 0   56. ogr,lev,lt=0
      * - - - x - - x x x   57. lev,pk,vt,lt
      * - - - x - - x x 0   58. lev,pk,vt,lt=0
      * - - - x - - x - x   59. lev,pk,lt
      * - - - x - - x - 0   60. lev,pk,lt=0
      * - - - x - - - x x   61. lev,vt,lt
      * - - - x - - - x 0   62. lev,vt,lt=0
      * - - - x - - - - x   63. lev,lt
      * - - - x - - - - 0   64. lev,lt=0
      * x x x - - - x x x   65. ogr,hgr,ugr,pk,vt,lt
      * x x x - - - x x 0   66. ogr,hgr,ugr,pk,vt,lt=0
      * x x x - - - x - x   67. ogr,hgr,ugr,pk,lt
      * x x x - - - x - 0   68. ogr,hgr,ugr,pk,lt=0
      * x x x - - - - x x   69. ogr,hgr,ugr,vt,lt
      * x x x - - - - x 0   70. ogr,hgr,ugr,vt,lt=0
      * x x x - - - - - x   71. ogr,hgr,ugr,lt
      * x x x - - - - - 0   72. ogr,hgr,ugr,lt=0
      * x x - - - - x x x   73. ogr,hgr,pk,vt,lt
      * x x - - - - x x 0   74. ogr,hgr,pk,vt,lt=0
      * x x - - - - x - x   75. ogr,hgr,pk,lt
      * x x - - - - x - 0   76. ogr,hgr,pk,lt=0
      * x x - - - - - x x   77. ogr,hgr,vt,lt
      * x x - - - - - x 0   78. ogr,hgr,vt,lt=0
      * x x - - - - - - x   79. ogr,hgr,lt
      * x x - - - - - - 0   80. ogr,hgr,lt=0
      * x - - - - - x x x   81. ogr,pk,vt,lt
      * x - - - - - x x 0   82. ogr,pk,vt,lt=0
      * x - - - - - x - x   83. ogr,pk,lt
      * x - - - - - x - 0   84. ogr,pk,lt=0
      * x - - - - - - x x   85. ogr,vt,lt
      * x - - - - - - x 0   86. ogr,vt,lt=0
      * x - - - - - - - x   87. ogr,lt
      * x - - - - - - - 0   88. ogr,lt=0
      * - - - - - - x x x   89. pk,vt,lt
      * - - - - - - x x 0   90. pk,vt,lt=0
      * - - - - - - x - x   91. pk,lt
      * - - - - - - x - 0   92. pk,lt=0
      * - - - - - - - x x   93. vt,lt
      * - - - - - - - x 0   94. vt,lt=0
      * - - - - - - - - x   95. lt
      * - - - - - - - - 0   96. lt=0
      *
     c                   eval      jpfala_vare = p_vare
     c                   eval      jpfala_ldor = p_ldor
     c                   eval      jpfala_kpri = *blank
     c                   eval      jpfala_vtyp = *blank
     c                   eval      jpfala_lety = p_lety
      *
     c                   eval      jpfalb_modn = jvmodn
     c                   eval      jpfalb_ldor = p_ldor
     c                   eval      jpfalb_vare = *blank
     c                   eval      jpfalb_kpri = *blank
     c                   eval      jpfalb_vtyp = *blank
     c                   eval      jpfalb_lety = p_lety
      *
     c                   eval      jpfal1_ogrp = jvogrp
     c                   eval      jpfal1_hgrp = jvhgrp
     c                   eval      jpfal1_ugrp = jvugrp
     c                   eval      jpfal1_ldor = p_ldor
     c                   eval      jpfal1_modn = 0
     c                   eval      jpfal1_vare = *blank
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
      *
      * Leverandør/vare
      *
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_vtyp = *blank
     c                   eval      jpfala_lety = p_lety
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_kpri = *blank
     c                   eval      jpfala_vtyp = w_vtyp
     c                   eval      jpfala_lety = p_lety
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_vtyp = *blank
     c                   eval      jpfala_lety = p_lety
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfala)
     c                   goto      end_paslag
     c                   endif
      *
      * Vare
      *
     c                   eval      jpfala_ldor = 0
     c                   eval      jpfala_kpri = p_pkod
     c                   eval      jpfala_vtyp = w_vtyp
     c                   eval      jpfala_lety = p_lety
      *
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_vtyp = *blank
     c                   eval      jpfala_lety = p_lety
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_kpri = *blank
     c                   eval      jpfala_vtyp = w_vtyp
     c                   eval      jpfala_lety = p_lety
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_vtyp = *blank
     c                   eval      jpfala_lety = p_lety
     c     jpfala_key    chain     jpfala
     c                   if        not %found
     c                   eval      jpfala_lety = 0
     c     jpfala_key    chain     jpfala
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfala)
     c                   goto      end_paslag
     c                   endif
      *
      * Leverandør/modul
      *
     c                   if        jvmodn <> 0
      *
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_vtyp = *blank
     c                   eval      jpfalb_lety = p_lety
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_kpri = *blank
     c                   eval      jpfalb_vtyp = w_vtyp
     c                   eval      jpfalb_lety = p_lety
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_vtyp = *blank
     c                   eval      jpfalb_lety = p_lety
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfalb)
     c                   goto      end_paslag
     c                   endif
      *
      * Modul
      *
     c                   eval      jpfalb_ldor = 0
     c                   eval      jpfalb_kpri = p_pkod
     c                   eval      jpfalb_vtyp = w_vtyp
     c                   eval      jpfalb_lety = p_lety
      *
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_vtyp = *blank
     c                   eval      jpfalb_lety = p_lety
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_kpri = *blank
     c                   eval      jpfalb_vtyp = w_vtyp
     c                   eval      jpfalb_lety = p_lety
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_vtyp = *blank
     c                   eval      jpfalb_lety = p_lety
     c     jpfalb_key    chain     jpfalb
     c                   if        not %found
     c                   eval      jpfalb_lety = 0
     c     jpfalb_key    chain     jpfalb
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfalb)
     c                   goto      end_paslag
     c                   endif
      *
     c                   endif
      *
      * Overgruppe/hovedgruppe/undergruppe/leverandør
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Overgruppe/hovedgruppe/leverandør
      *
     c                   eval      jpfal1_ugrp = 0
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Overgruppe/leverandør
      *
     c                   eval      jpfal1_hgrp = 0
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Leverandør
      *
     c                   eval      jpfal1_ogrp = 0
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Overgruppe/hovedgruppe/undergruppe
      *
     c                   eval      jpfal1_ogrp = jvogrp
     c                   eval      jpfal1_hgrp = jvhgrp
     c                   eval      jpfal1_ugrp = jvugrp
     c                   eval      jpfal1_ldor = 0
     c                   eval      jpfal1_modn = 0
     c                   eval      jpfal1_vare = *blank
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Overgruppe/hovedgruppe
      *
     c                   eval      jpfal1_ugrp = 0
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Overgruppe
      *
     c                   eval      jpfal1_hgrp = 0
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Generell
      *
     c                   eval      jpfal1_ogrp = 0
     c                   eval      jpfal1_kpri = p_pkod
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
      *
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_kpri = *blank
     c                   eval      jpfal1_vtyp = w_vtyp
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_vtyp = *blank
     c                   eval      jpfal1_lety = p_lety
     c     jpfal1_key    chain     jpfal1
     c                   if        not %found
     c                   eval      jpfal1_lety = 0
     c     jpfal1_key    chain     jpfal1
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        %found(jpfal1)
     c                   goto      end_paslag
     c                   endif
      *
      * Ingen gyldige påslagsfaktorer funnet.
      * Status settes til 6, dersom status for betingelse ikke allerede er
      * satt. Kostprisfaktor og salgprisfaktor defaultes til 1.
      *
6.10 c                   if        p_osts <> '5'
6.10 c                   eval      p_osts = '6'
     c                   endif
      *
     c                   eval      p_kfak = 1
     c                   eval      p_sfak = 1
     c                   leavesr
      *
      * Tar vare på påslagsfaktor data.
      *
     c     end_paslag    tag
      *
     c                   eval      p_pogr = jcogrp
     c                   eval      p_phgr = jchgrp
     c                   eval      p_pugr = jcugrp
     c                   eval      p_pldo = jcldor
     c                   eval      p_pmod = jcmodn
     c                   eval      p_pvar = jcvare
     c                   eval      p_ppko = jckpri
     c                   eval      p_pvty = jcvtyp
     c                   eval      p_plet = jclety
     c                   eval      p_kfak = jckofa
     c                   eval      p_kbel = jckobe
     c                   eval      p_sfak = jcsafa
      *
5.70 c                   eval      b_pasl = *on
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * ERROR-rutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *pssr         begsr
      *
6.10 c                   eval      p_osts = '9'
     c                   goto      avslutt
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_vare
     c                   parm                    p_ldor
     c                   parm                    p_lety
     c                   parm                    p_enh1
     c                   parm                    p_kfak
     c                   parm                    p_osts
      *
      * Key for oppslag på vare
      *
     c     jvarl1_key    klist
     c                   kfld                    jvarl1_vare
      *
      * Key for oppslag på vare-pris
      *
     c     jvprl1_key    klist
     c                   kfld                    jvprl1_vare
     c                   kfld                    jvprl1_ldor
      *
      * Key for oppslag på vare-pakning
      *
     c     jvpkl1_key    klist
     c                   kfld                    jvpkl1_vare
6.30 c                   kfld                    jvpkl1_ldor
      *
      * Key for oppslag på vare-pakning - gammel
      *
     c     jvpglr_key    klist
     c                   kfld                    jvpglr_vare
      *
      * Key for oppslag på forpakning m/varenummer
      *
     c     jforl5_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jforl5_vare
      *
      * Key for oppslag på forpakning
      *
     c     jforl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jforl1_ogrp
     c                   kfld                    jforl1_hgrp
     c                   kfld                    jforl1_ugrp
     c                   kfld                    jforl1_ldor
     c                   kfld                    jforl1_modn
     c                   kfld                    jforl1_vare
      *
      * Key for oppslag på betingelse
      *
     c     jbetlb_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jbetlb_ldor
     c                   kfld                    jbetlb_vare
6.3x c                   kfld                    jbetlb_prgr
     c                   kfld                    jbetlb_vtyp
     c                   kfld                    jbetlb_lety
      *
     c     jbetlc_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jbetlc_ldor
     c                   kfld                    jbetlc_modn
     c                   kfld                    jbetlc_vare
6.3x c                   kfld                    jbetlc_prgr
     c                   kfld                    jbetlc_vtyp
     c                   kfld                    jbetlc_lety
      *
     c     jbetl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jbetl1_ldor
6,3x c                   kfld                    jbetl1_prgr
     c                   kfld                    jbetl1_ogrp
     c                   kfld                    jbetl1_hgrp
     c                   kfld                    jbetl1_ugrp
     c                   kfld                    jbetl1_modn
     c                   kfld                    jbetl1_vare
     c                   kfld                    jbetl1_vtyp
     c                   kfld                    jbetl1_lety
      *
      * Key for les på rabattelement
      *
     c     jrael1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jrael1_eldo
6.3x c                   kfld                    jrael1_eprg
     c                   kfld                    jrael1_eogr
     c                   kfld                    jrael1_ehgr
     c                   kfld                    jrael1_eugr
     c                   kfld                    jrael1_emod
     c                   kfld                    jrael1_evar
     c                   kfld                    jrael1_evty
     c                   kfld                    jrael1_elet
     c                   kfld                    jrael1_ebrs
     c                   kfld                    jrael1_ebli
      *
     c     jrael4_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jrael4_eldo
6.3x c                   kfld                    jrael4_eprg
     c                   kfld                    jrael4_eogr
     c                   kfld                    jrael4_ehgr
     c                   kfld                    jrael4_eugr
     c                   kfld                    jrael4_emod
     c                   kfld                    jrael4_evar
     c                   kfld                    jrael4_evty
     c                   kfld                    jrael4_elet
     c                   kfld                    jrael4_ebrs
     c                   kfld                    jrael4_ebli
     c                   kfld                    jrael4_eakt
      *
      * Key for oppslag på påslagsfaktor
      *
     c     jpfala_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jpfala_vare
5.70 c                   kfld                    jpfala_prgr
     c                   kfld                    jpfala_ldor
     c                   kfld                    jpfala_kpri
     c                   kfld                    jpfala_vtyp
     c                   kfld                    jpfala_lety
      *
     c     jpfalb_key    klist
     c                   kfld                    w_firm
5.70 c                   kfld                    jpfalb_prgr
     c                   kfld                    jpfalb_modn
     c                   kfld                    jpfalb_ldor
     c                   kfld                    jpfalb_vare
     c                   kfld                    jpfalb_kpri
     c                   kfld                    jpfalb_vtyp
     c                   kfld                    jpfalb_lety
      *
     c     jpfal1_key    klist
     c                   kfld                    w_firm
5.70 c                   kfld                    jpfal1_prgr
     c                   kfld                    jpfal1_ogrp
     c                   kfld                    jpfal1_hgrp
     c                   kfld                    jpfal1_ugrp
     c                   kfld                    jpfal1_ldor
     c                   kfld                    jpfal1_modn
     c                   kfld                    jpfal1_vare
     c                   kfld                    jpfal1_kpri
     c                   kfld                    jpfal1_vtyp
     c                   kfld                    jpfal1_lety
      *
      * Key for oppslag på midlertidig pris
      *
     c     jwprl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jwprl1_vare
      *
      * Key for oppslag på leverandør
      *
     c     jlevl1_key    klist
     c                   kfld                    jlevl1_ldor
      *
      * Key for oppslag på EVR-vare
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for oppslag på EVR-vare-enhet
      *
     c     vvenl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvenl1_vare
      *
      * Key for oppslag på undergruppe
      *
     c     vugrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vugrl1_uogr
     c                   kfld                    vugrl1_uhgr
     c                   kfld                    vugrl1_uugr
      *
      *
      * Henter firma fra parameter
      *
     c                   eval      w_firm = p_firm
      *
      * Nullstiller resultatparametre før behandling.
      *
     c                   eval      p_kfak = 0
      *
     c                   endsr
