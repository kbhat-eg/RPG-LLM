      /title  ASSTAT Vedlikehold av budsjett-nivå-register
     h datedit(*dmy.) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SB200R
      * Beskrivelse . . : Vedlikehold av budsjett-nivå-register
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * V5.50 301006 KOB  Kode 13 endret fra ordre- til leveringstype
      * V5.50 040306 KOB  Lagt inn startverdi for år i skjermbildet
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     fSB200d    cf   e             workstn sfile(b1sfl:srrn01)
      *
     fsknil1    if   e           k disk    rename(sknipfr:sknil1r)
     fsknilu    uf a e           k disk    rename(sknipfr:sknilur)
      *
     d mld             s             11    dim(4) ctdata perrcd(1)
     d rpt             s             15    dim(60) ctdata perrcd(1)
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_kode          ds            12
     d w_kode_11                      1  0
     d w_kode_12                      1  0
     d w_kode_13                      1  0
     d w_kode_21                      1  0
     d w_kode_22                      1  0
     d w_kode_23                      1  0
     d w_kode_24                      1  0
     d w_kode_25                      1  0
     d w_kode_31                      1  0
     d w_kode_32                      1  0
     d w_kode_33                      1  0
     d w_kode_34                      1  0
      *
     d spge01          s              3  0
     d srrn01          s              4  0
     d sfrn01          s                   like(srrn01)
     d ssrn01          s                   like(srrn01)
      *
     d w_firm          s                   like(snfirm)
      *
     d r1              s              2  0
     d r2              s                   like(r1)
     d r3              s                   like(r1)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Send Alt
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * Bare data
      *
     c     b2tagb        tag
      *
     c                   exsr      xdsp01
      *
      * Avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
      *
      * Forny
      *
     c                   if        *inke = *on
     c                   if        sfrn01 <> *zero
     c     sfrn01        chain     b1sfl                              60
     c                   endif
      *
     c                   move      b1kode        w_kode
     c     key01         setll     sknil1r
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
      * Roll
      *
     c                   if        *in10 = *on
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
      * Home
      *
     c                   if        *in21
     c                   eval      *in22 = *on
     c                   goto      b2taga
     c                   endif
      *
      * Posisjoner
      * startverdi
      *
     c                   if        b2kode <> *zero
     c                   move      b2kode        w_kode
     c     key01         setll     sknil1r
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   eval      b2kode = *zero
     c                   goto      b2tagb
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Behandling av subfile                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Sjekk om valg er foretatt i subfile
      *
     c                   do        ssrn01
     c                   readc     b1sfl                                  16
     c                   if        *in16 = *on
     c                   leave
     c                   endif
      *
      * Vise
      *
     c                   if        b1valg = ' 5'
     c                             or b1valg = '5 '
     c                   move      b1kode        f0kode
     c                   move      b1kode        w_kode
     c                   exsr      xf0win
     c                   iter
     c                   endif
      *
     c                   enddo
      *
     c                   goto      b2taga
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * F0WIN Behandle bilde for budsjettering                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xf0win        begsr
      *
      * Hent informasjon fra BUDSJETT-NIVÅ-REGISTER
      *
     c     key01         chain     sknil1r                            60
      *
      * Legg inn faste startverdier
      *
     c                   move      'O '          f0vers
     c                   move      'B'           f0aabb
     c                   move      *year         f0hhaa
      *
     c                   write     s1win
      *
     c                   exfmt     f0win
      *
     c     *inkc         cabeq     *on           f0tag1
     c     *inkl         cabeq     *on           f0tag1
      *
     c                   call      'SB210R'
     c                   parm                    f0hhaa
     c                   parm                    f0vers
     c                   parm                    f0kode
     c                   parm                    f0aabb
      *
     c     f0tag1        tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 5'
     c                             or b1valg = '5 '
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   endsr
      *
      /EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Tøm subfile                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xclr01        begsr
      *
     c                   move      *on           *in14
     c                   write     b2ctl
     c                   move      *off          *in14
      *
     c                   move      *off          *in15
     c                   eval      srrn01 = 0
     c                   eval      sfrn01 = 0
     c                   eval      ssrn01 = 0
     c                   eval      spge01 = 0
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Fyll opp subfile                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xcrt01        begsr
      *
     c                   eval      spge01 = spge01 + 10
     c                   eval      srrn01 = ssrn01
      *
     c                   dou       srrn01 = spge01
      *
     c     les01         tag
      *
     c                   read      sknil1r                                15
      *
     c     *in15         cabeq     *on           xend01
      *
     c                   eval      srrn01 = srrn01 + 1
     c                   move      snkode        b1kode
      *
      * Hent tekster fra tabell
      *
     c                   move      snendr        b1endr
     c                   move      *blank        b1vis1
     c                   move      *blank        b1vis2
     c                   move      *blank        b1vis3
      *
     c                   move      snkode        w_kode
     c                   exsr      hntarr
      *
     c                   if        r1 > *zeros
     c                   movel     rpt(r1)       b1vis1
     c                   endif
      *
     c                   if        r2 > *zeros
     c                   movel     rpt(r2)       b1vis2
     c                   endif
      *
     c                   if        r3 > *zeros
     c                   movel     rpt(r3)       b1vis3
     c                   endif
      *
     c                   write     b1sfl
     c                   enddo
      *
     c     xend01        tag
      *
     c                   if        srrn01 > ssrn01
     c                   eval      sfrn01 = ssrn01 + 1
     c                   endif
      *
     c                   eval      ssrn01 = srrn01
     c                   eval      svrn01 = sfrn01
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Display subfile                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xdsp01        begsr
      *
     c                   if        srrn01 <> 0
     c                   move      *on           *in12
     c                   endif
      *
     c                   move      *on           *in13
     c                   exfmt     b2ctl
     c                   move      *off          *in12
     c                   move      *off          *in13
     c                   move      *off          *in22
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Henter nummer verdier fra array                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     hntarr        begsr
      *
     c                   move      *zero         r1
     c                   move      *zero         r2
     c                   move      *zero         r3
      *
      * (11)
      *
     c     w_kode_11     ifeq      1
     c                   move      11            r1
     c                   endif
     c     w_kode_11     ifeq      2
     c                   move      11            r2
     c                   endif
     c     w_kode_11     ifeq      3
     c                   move      11            r3
     c                   endif
      *
      * (12)
      *
     c     w_kode_12     ifeq      1
     c                   move      12            r1
     c                   endif
     c     w_kode_12     ifeq      2
     c                   move      12            r2
     c                   endif
     c     w_kode_12     ifeq      3
     c                   move      12            r3
     c                   endif
      *
      * (13)
      *
     c     w_kode_13     ifeq      1
     c                   move      13            r1
     c                   endif
     c     w_kode_13     ifeq      2
     c                   move      13            r2
     c                   endif
     c     w_kode_13     ifeq      3
     c                   move      13            r3
     c                   endif
      *
      * (21)
      *
     c     w_kode_21     ifeq      1
     c                   move      21            r1
     c                   endif
     c     w_kode_21     ifeq      2
     c                   move      21            r2
     c                   endif
     c     w_kode_21     ifeq      3
     c                   move      21            r3
     c                   endif
      *
      * (22)
      *
     c     w_kode_22     ifeq      1
     c                   move      22            r1
     c                   endif
     c     w_kode_22     ifeq      2
     c                   move      22            r2
     c                   endif
     c     w_kode_22     ifeq      3
     c                   move      22            r3
     c                   endif
      *
      * (23)
      *
     c     w_kode_23     ifeq      1
     c                   move      23            r1
     c                   endif
     c     w_kode_23     ifeq      2
     c                   move      23            r2
     c                   endif
     c     w_kode_23     ifeq      3
     c                   move      23            r3
     c                   endif
      *
      * (24)
      *
     c     w_kode_24     ifeq      1
     c                   move      24            r1
     c                   endif
     c     w_kode_24     ifeq      2
     c                   move      24            r2
     c                   endif
     c     w_kode_24     ifeq      3
     c                   move      24            r3
     c                   endif
      *
      * (25)
      *
     c     w_kode_25     ifeq      1
     c                   move      25            r1
     c                   endif
     c     w_kode_25     ifeq      2
     c                   move      25            r2
     c                   endif
     c     w_kode_25     ifeq      3
     c                   move      25            r3
     c                   endif
      *
      * (31)
      *
     c     w_kode_31     ifeq      1
     c                   move      31            r1
     c                   endif
     c     w_kode_31     ifeq      2
     c                   move      31            r2
     c                   endif
     c     w_kode_31     ifeq      3
     c                   move      31            r3
     c                   endif
      *
      * (32)
      *
     c     w_kode_32     ifeq      1
     c                   move      32            r1
     c                   endif
     c     w_kode_32     ifeq      2
     c                   move      32            r2
     c                   endif
     c     w_kode_32     ifeq      3
     c                   move      32            r3
     c                   endif
      *
      * (33)
      *
     c     w_kode_33     ifeq      1
     c                   move      33            r1
     c                   endif
     c     w_kode_33     ifeq      2
     c                   move      33            r2
     c                   endif
     c     w_kode_33     ifeq      3
     c                   move      33            r3
     c                   endif
      *
      * (34)
      *
     c     w_kode_34     ifeq      1
     c                   move      34            r1
     c                   endif
     c     w_kode_34     ifeq      2
     c                   move      34            r2
     c                   endif
     c     w_kode_34     ifeq      3
     c                   move      34            r3
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
      * Key for file nummerisk
      *
     c     key01         klist
     c                   kfld                    w_firm
     c                   kfld                    w_kode
      *
      * Key for sleting
      *
     c     key02         klist
     c                   kfld                    w_firm
     c                   kfld                    w_kode
      *
     c                   eval      w_firm =  l_firm
     c                   eval      w_kode = *zero
     c                   eval      l_fnav = l_fnav
      *
     c                   eval      *in21 = *on
     c                   eval      *in22 = *on
      *
     c     key01         setll     sknil1r
      *
     c                   exsr      xcrt01
      *
     c                   endsr
      *
      **********************  T A B E L L E R  ***************************
**
  Ny post                  001
  Endring                  002
  Vise                     003
* Slettet *                004
**  SORTERINGSREKKEFØLGE
Ledig                      01
Ledig                      02
Ledig                      03
Ledig                      04
Ledig                      05
Ledig                      06
Ledig                      07
Ledig                      08
Ledig                      09
Ledig                      10
Avdeling                   11
Lager                      12
Leveringstype              13
Ledig                      14
Ledig                      15
Ledig                      16
Ledig                      17
Ledig                      18
Ledig                      19
Ledig                      20
Land                       21
Distrikt                   22
Selger                     23
Kundekategori              24
Kundenummer                25
Ledig                      26
Ledig                      27
Ledig                      28
Ledig                      29
Ledig                      30
Overgruppe                 31
Hovedgruppe                32
Undergruppe                33
Varenummer                 34
Ledig                      35
Ledig                      36
Ledig                      37
Ledig                      38
Ledig                      39
Ledig                      40
Ledig                      41
Ledig                      42
Ledig                      43
Ledig                      44
Ledig                      45
Ledig                      46
Ledig                      47
Ledig                      48
Ledig                      49
Ledig                      50
Ledig                      51
Ledig                      52
Ledig                      53
Ledig                      54
Ledig                      55
Ledig                      56
Ledig                      57
Ledig                      58
Ledig                      59
Ledig                      60
