      /TITLE  ASOFAK: Vedlikehold av brukerregister, Ordre/fakturering
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FB100R
      * Beskrivelse . . : Vedlikehold av brukerregister  OFAK
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       060301 AMD  Hele programmet skrevet om til std. ILE
5.01  * 5.01  300402 AMD  Skjermbildet er splittet i to bilder pga.
5.01  *                   behov for mere plass. Lagt inn ny kode som styrer
5.01  *                   om bruker har lov til gjenutskrift av pakkseddel.
5.02  * 5.02  011002 AMD  Lagt inn ny kode for nett-butikk-bruker
5.03  * 5.03  140502 AMD  Lagt inn ny kode for overføring til regnskap
5.20  * 5.20  291003 AMD  Lagt inn ny kode for oppdatering av kunder
5.20  *                   ifra ordresystemet (F6-Kunder)
5.20  * 5.70  050509 bof  Utvidet med ko13-lov til bruke alle prisgr.varevedl.
      * 6.10  250609 BSA  Oppdatert med sporingsinformasjon
6.20  * 6.20  251110 bof  Se innkjøpspris ved registrering. FBKO14
6.21  * 6.20  270410 bof  Ny kode opprett /endre av best.  FBKO15
6.22  * 6.20  041111 bof  Fjernet FBKO14 - ikke tatt ibruk
6.30  * 6.30  050214 bof  Tatt i bruk RBKO16, ant.dager for tilbudsoppfølging
6.32  * 6.30  100914 bkv  Tatt i bruk RBKO17, flere koder på kundeprosjekt
      *
7.xx  * 7.00  040419 bsa  Mulighet for bredere skjerm
7.fb  * 7.10  040419 bof  Tatt i bruk RBKO18, tillatt å reg. manuelt depositum
7.fb  *                   "Forskuddsbetaling løsning".
      *
8.01  * 800   101221 ask  Bare kompilering for skjermbilde endring
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     ffb100d    cf   e             workstn
     ffusrl1    if   e           k disk    rename(fusrpfr:fusrl1r)
     ffusrlu    uf a e           k disk    rename(fusrpfr:fusrlur)
     fvotyl1    if   e           k disk    rename(votypfr:votyl1r)
3.31 fvinfl1    if   e           k disk    rename(vinfpfr:vinfl1r)
      *
      * Definering av local data area
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
      *
      * Definering av parametere
      *
     d p_firm          s                   like(fbfirm)
     d p_user          s                   like(fbuser)
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(fbfirm)
     d votyl1_otyp     s                   like(vaotyp)
3.31 d vinfl1_ityp     s                   like(vaityp)
     d fusrl1_user     s                   like(fbuser)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  I1BLD  Behandle bilde for vedlikehold av brukeropplysninger
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     fusrl1_key    chain     fusrl1                             90
      *
     c                   if        *in90  = *off
     c                   eval      i1vref = fbvref
     c                   eval      i1selg = fbselg
     c                   eval      i1bind = fbbind
     c                   eval      i1otyp = fbotyp
     c                   eval      i1ko98 = fbko98
     c                   eval      i1cord = fbcord
     c                   eval      i1vise = fbvise
     c                   eval      i1ko01 = fbko01
     c                   eval      i1ko02 = fbko02
     c                   eval      i1ko03 = fbko03
     c                   eval      i1ko04 = fbko04
     c                   eval      i1ko05 = fbko05
     c                   eval      i1ko06 = fbko06
     c                   eval      i1ko07 = fbko07
     c                   eval      i1ko08 = fbko08
5.01 c                   eval      i1ko09 = fbko09
5.02 c                   eval      i1ko10 = fbko10
5.03 c                   eval      i1ko11 = fbko11
5.20 c                   eval      i1ko12 = fbko12
5.70 c                   eval      i1ko13 = fbko13
6.21 c                   eval      i1ko15 = fbko15
6.30 c                   eval      i1ko16 = fbko16
6.32 c                   eval      i1ko17 = fbko17
7.fb c                   eval      i1ko18 = fbko18
     c                   else
     c                   eval      i1vref = *blank
     c                   eval      i1selg = *zero
     c                   eval      i1bind = *blank
     c                   eval      i1otyp = *blank
     c                   eval      i1ko98 = *blank
     c                   eval      i1cord = *zero
     c                   eval      i1vise = *zero
     c                   eval      i1ko01 = *zero
     c                   eval      i1ko02 = *zero
     c                   eval      i1ko03 = *zero
     c                   eval      i1ko04 = *zero
     c                   eval      i1ko05 = *zero
     c                   eval      i1ko06 = *zero
     c                   eval      i1ko07 = *zero
     c                   eval      i1ko08 = *zero
5.01 c                   eval      i1ko09 = *zero
5.02 c                   eval      i1ko10 = *zero
5.03 c                   eval      i1ko11 = *zero
5.20 c                   eval      i1ko12 = *zero
5.70 c                   eval      i1ko13 = *zero
6.20 c                   eval      fbko14 = 0
6.21 c                   eval      fbko15 = 0
6.30 c                   eval      fbko16 = 0
6.32 c                   eval      fbko17 = 0
7.fb c                   eval      fbko18 = 0
     c                   endif
      *
     c     i1tagb        tag
     c                   exfmt     i1bld
      *
      *  F3=Avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
      *
      *  Sjekk,  Finnes ordretype i ORDRETYPE-REGISTER
      *
     c                   if        i1otyp <> *blank
     c                   eval      votyl1_otyp = i1otyp
     c     votyl1_key    chain     votyl1r                            90
     c                   if        *in90 = *on
     c                   eval      *in31 = *on
     c                   goto      i1tagb
     c                   endif
     c                   endif
3.31  *
3.31  *  Sjekk,  Finnes ordre-info-kode i inforegister
3.31  *
3.31 c                   if        i1ko98 <> *blank
3.31 c                   eval      vinfl1_ityp = i1ko98
3.31 c     vinfl1_key    chain     vinfl1r                            91
3.31 c                   if        *in91  = *on
3.31 c                   eval      *in31  = *on
3.31 c                   goto      i1tagb
3.31 c                   endif
3.31 c                   endif
5.01  *
5.01 c     i2tagb        tag
5.01 c                   exfmt     i2bld
      *
      *  Oppdater OFAK-BRUKER-REGISTER med nye opplysninger
      *
     c     fusrl1_key    chain     fusrlur                            90
      *
     c                   eval      fbvref = i1vref
     c                   eval      fbselg = i1selg
     c                   eval      fbbind = i1bind
     c                   eval      fbotyp = i1otyp
     c                   eval      fbko98 = i1ko98
     c                   eval      fbcord = i1cord
     c                   eval      fbvise = i1vise
     c                   eval      fbko01 = i1ko01
     c                   eval      fbko02 = i1ko02
     c                   eval      fbko03 = i1ko03
     c                   eval      fbko04 = i1ko04
     c                   eval      fbko05 = i1ko05
     c                   eval      fbko06 = i1ko06
     c                   eval      fbko07 = i1ko07
     c                   eval      fbko08 = i1ko08
5.01 c                   eval      fbko09 = i1ko09
5.02 c                   eval      fbko10 = i1ko10
5.03 c                   eval      fbko11 = i1ko11
5.20 c                   eval      fbko12 = i1ko12
5.70 c                   eval      fbko13 = i1ko13
6.21 c                   eval      fbko15 = i1ko15
6.30 c                   eval      fbko16 = i1ko16
6.32 c                   eval      fbko17 = i1ko17
7.fb c                   eval      fbko18 = i1ko18
      *
     c                   if        *in90 = *off
6.10 c                   time                    fbedat
6.10 c                   time                    fbetim
6.10 c                   eval      fbeusr = l_user
     c                   update    fusrlur
     c                   else
     c                   eval      fbfirm = w_firm
     c                   eval      fbuser = fusrl1_user
6.10 c                   time                    fbodat
6.10 c                   time                    fbotim
6.10 c                   eval      fbousr = l_user
6.10 c                   time                    fbedat
6.10 c                   time                    fbetim
6.10 c                   eval      fbeusr = l_user
     c                   write     fusrlur
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      *  Key for file : BRUKER-REGISER OFAK
      *
     c     fusrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fusrl1_user
      *
      *  Key for file : ORDRE-TYPE-REGISTER
      *
     c     votyl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    votyl1_otyp
3.31  *
3.31  * Key for oppslag på ordre-info-type
3.31  *
3.31 c     vinfl1_key    klist
3.31 c                   kfld                    w_firm
3.31 c                   kfld                    vinfl1_ityp
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_user
      *
      *  Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = p_firm
     c                   eval      w_firm = p_firm
      *
      *  Legger inn bruker i nøkklene
      *
     c                   eval      fusrl1_user = p_user
      *
     c                   endsr
