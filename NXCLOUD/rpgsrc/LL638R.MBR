      /TITLE  Utskrift av historisk lagerbok
     h datedit(*dmy.) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Program . . . . : LL638R
      * Beskrivelse . . : Utskrift av historisk lagerbok
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.
      * --------- ------  --------------------------------------------------
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     flwa3l1    ip   e           k disk    rename(lwa3pfr:lwa3l1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
      *
     fll638p    o    e             printer
      *
     d                uds
     d l_fvar                300    314
     d l_tvar                        15
     d l_flag                         2  0
     d l_tlag                         2  0
     d l_fogr                         2  0
     d l_togr                         2  0
     d l_fhgr                         2  0
     d l_thgr                         2  0
     d l_fugr                         3  0
     d l_tugr                         3  0
     d l_fdat                        10d   datfmt(*iso)
     d l_tdat                        10d   datfmt(*iso)
     d l_syst                         1
     d l_type                         2
     d l_inut                         1
     d l_srt1                         1  0
     d l_srt2                         1  0
     d l_srt3                         1  0
     d l_srt4                         1  0
      *
     d l_wsid                901    910
     d l_user                        10
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_anta          s              5  0
     d w_dato          s               d   datfmt(*iso)
     d w_time          s               t   timfmt(*iso)
     d w_behl          s                   like(mhbehl)
     d w_firm          s                   like(vvfirm)
     d w_vare          s                   like(vvvare)
      *
      *
     c                   if        mhfirm > l_firm
     c                   eval      *inlr = *on
     c                   goto      slutt
     c                   endif
      *
      * Sl√•r opp varenummer
      *
     c                   movel     mhvare        w_vare
     c     varkey        chain     vvarl1                             80
      *
     c                   eval      d1vare = mhvare
     c                   eval      d1tek1 = vvtek1
     c                   eval      d1enhl = vvenhl
     c                   eval      d1lage = mhlage
     c                   eval      d1syst = mhsyst
     c                   eval      d1kode = mhkode
     c                   eval      d1type = mhtype
     c                   eval      d1refr = mhrefr
     c                   eval      d1user = mhuser
      *
      * Dato
      *
     c                   if        mhdato <> *loval
     c     *dmy          move      mhdato        d1dato
     c                   endif
      *
     c                   move      mhtime        d1time
      *
     c                   eval      d1anta = mhanta
     c                   eval      d1ette = mhbehl
      *
     c                   if        mhtype = 'I'
     c                   eval      d1behl = d1ette - d1anta
     c                   else
     c                   eval      d1behl = d1ette + d1anta
     c                   endif
      *
     c                   eval      w_anta = w_anta + 1
      *
     c                   write     d1det                                30
      *
      * Skriv heading
      *
     c                   if        *in30 = *on
     c                   write     a1hdr
     c                   endif
      *
     c     slutt         tag
      *
     c                   if        *inlr = *on
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Legge inn firmanummer
      *
     c                   move      l_firm        w_firm
      *
     c                   eval      w_anta = *zeros
      *
      * Key for vareregister
      *
     c     varkey        klist
     c                   kfld                    w_firm
     c                   kfld                    w_vare
      *
     c                   time                    w_dato
     c                   time                    w_time
     c                   eval      w_firm = l_firm
      *
      * Redigere heading
      *
     c     *dmy          move      w_dato        a1date
     c     *hms          move      w_time        a1time
      *
     c                   eval      a1user = l_user
     c                   eval      a1wsid = l_wsid
     c                   eval      a1firm = l_firm
     c                   eval      a1fnav = l_fnav
      *
     c                   write     a1hdr
      *
     c                   endsr
      *
