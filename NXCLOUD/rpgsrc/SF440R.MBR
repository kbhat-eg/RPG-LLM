     /TITLE  Utskrift av matcher/mangler - parameter
     H datedit(*dmy)
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                 *
     * Program . . . . : SF440R                                        *
     * Beskrivelse . . : Utskrift av matcher/mangler - parameter       *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                 *
     * Spesialversjon. :                                               *
     * Tilpasset for . :                                               *
     *                                                                 *
     * Referanse  Dato   Endringsbeskrivelse                      Sign.*
     * --------- ------  ----------------------------------------------*
     *                   Nytt program oktober 97                   KOB *
     *                                                                 *
     *                                                                 *
     *                                                                 *
     *                                                                 *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                 *
     *  BRUK AV INDIKATORER                                            *
     *                                                                 *
     *       KA = F1  = Valg av firma                                  *
     *       KC = F3  = Exit                                           *
     *                                                                 *
     *       LR = Avslutt program                                      *
     *       30 = Protect av felter ved vise                           *
     *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
     *    60-69 = Fileindikatorer chain etc.                           *
     *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
     *    80-89 = Arbeidsindikatorer ordinære                          *
     *    90-99 = Benyttes ved std. sub-rutiner                        *
     *                                                                 *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     Fausrl1    if   e           k disk
     F                                     rename(ausrpfr:ausrl1r)
     FSF440d    cf   e             workstn
     *
     * Felt  i local
     *
     D                uds
     D pakode                300    301
     D paofra                302    307  0
     D paotil                308    313  0
     D patype                314    321
     D patyp1                314    315
     D patyp2                316    317
     D patyp3                318    319
     D patyp4                320    321
     D papaar                322    325
     *
     D lcuser                911    920
     D lcfirm                944    946  0
     D lcnavn                951    980
     *
     * Interne arbeidsfelt
     *
     D wpin03          s              1  0
     D wwfirm          s                   like(lcfirm)
     D wwuser          s                   like(lcuser)
     *
     * Key for bruker-file
     *
     D                 ds
     D key03                         10
     *
     /EJECT
     C     dummy         tag
     *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Definering av felter                                            *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     * Benyttede skjermbilder.
     * - - - - - - - - - - - - - - - - -
     *
     * A2BLD  - A2 Bilde for valg av parametre
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * A2BLD Behandle bilde for valg av utskriftskriteria              *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     a2taga        tag
     *
     C                   exfmt     a2bld
     *
     C                   eval      *in31 = *off
     C                   eval      *in32 = *off
     *
     * Valg av firma
     *
B001 C                   if        *inka = *on                                           .....
B002 C                   if        abbfir = *blank                                    .....  .
 002 C                   call      'AA002R'                                               .  .
 002 C                   parm                    wwuser                                   .  .
 002 C     key03         chain     ausrl1                             60                  .  .
 002 C                   move      abfnav        a2fnav                                   .  .
 002 C                   move      absfir        a2firm                                   .  .
 002 C                   move      absfir        wwfirm                                   .  .
 002 *                                                              .  .
 002 C                   goto      a2taga                                                 .  .
E002 C                   endif                                                        .....  .
E001 C                   endif                                                           .....
     *
     * Gå ut
     *
B001 C                   if        *inkc = *on                                  .....
 001 C                   move      1             wpin03                             .
 001 C                   goto      xslutt                                           .
E001 C                   endif                                                  .....
     *
     *  Kontroll av felt fra skjermbilde
     *
B001 C                   if        a2kode <> 'O '                                        .....
B001 C                   if        a2kode <> 'OM'                                        .....
B001 C                   if        a2kode <> 'F '                                        .....
B001 C                   if        a2kode <> 'FM'                                        .....
 001 C                   move      *on           *in31                          Pos.cur.     .
 001 C                   goto      a2taga                                                    .
E001 C                   endif                                                           .....
E001 C                   endif                                                           .....
E001 C                   endif                                                           .....
E001 C                   endif                                                           .....
     *
B001 C                   if        a2ofra > a2otil                                       .....
 001 C                   move      *on           *in32                          Pos.cur.     .
 001 C                   goto      a2taga                                                    .
E001 C                   endif                                                           .....
     *
     * Skriv parameter til local
     *
     C                   move      a2kode        pakode
     C                   move      a2ofra        paofra
     C                   move      a2otil        paotil
     C                   move      a2typ1        patyp1
     C                   move      a2typ2        patyp2
     C                   move      a2typ3        patyp3
     C                   move      a2typ4        patyp4
     C                   move      a2paar        papaar
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Avslutt program                                                 *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     xslutt        tag
     C                   eval      *inlr = *on
     C                   return
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for initiering av program                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     *inzsr        begsr
     *
     * Nullstill felt i skjermbilde
     *
     C                   eval      a2kode = *blank
     C                   eval      a2ofra = *zeros
     C                   eval      a2otil = *zeros
     C                   eval      a2typ1 = *blank
     C                   eval      a2typ2 = *blank
     C                   eval      a2typ3 = *blank
     C                   eval      a2typ4 = *blank
     C                   eval      wpin03 = *zero
     C                   eval      a2paar = *year
     *
     *
     * Legge inn firma-
     * nummer og navn
     * fra parameter
     *
     *
     C                   move      lcuser        wwuser
     C                   move      lcfirm        wwfirm
     C                   move      lcfirm        a2firm
     C                   move      lcnavn        a2fnav
     *
     * Hent bruker-record
     *
     C     key03         chain     ausrl1                             63
     *
     * Parameterliste
     *
     C     *entry        plist
     C                   parm                    wpin03
     *
     c                   eval      l_fnav = lcnavn
      *
     C                   endsr
     /EJECT
