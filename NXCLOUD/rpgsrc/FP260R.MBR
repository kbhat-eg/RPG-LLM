     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * System. . . . . : ASOFAK                                        *
      * Program . . . . : FP260R                                        *
      * Beskrivelse . . : Elektroniske etiketter - parameter            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       180108 bof  Nytt program
7.xx  * 7.00  280119 bkv  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
7.01  *K000   310820 bsa  Parameter for fullt uttrekk
      *                                                                 *
8.00  *K000   050521 bsa  Utvidet med å bruke parameterfil fra ADB
8.00  *K000               til å vedlikeholde etiketter.
8.01  *K000   050521 bsa  Utvidet med leverandør Delfi
8.02  *K000   260822 bsa  Ved bytte av lager, må også etikettypen tas   *
8.02  *K000               med.                                          *
      *                                                                 *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
8.00 faelhl1    if   e           k disk    rename(aelhpfr:aelhl1r)
8.00 faelhlr    if   e           k disk    rename(aelhpfr:aelhlrr)
     ffp260d    cf   e             workstn
      *
     d                uds
      *
     d l_user                911    920
8.00 d l_filg                931    933
     d l_firm                944    946  0
     d l_fnav                951    980
     d l_lage               1001   1002  0
      *
8.00 d aelhl1_filg     s                   like(aefilg)
8.00 d aelhl1_firm     s                   like(aefirm)
8.00 d aelhl1_lage     s                   like(aelage)
8.00 d aelhlr_filg     s                   like(aefilg)
8.00 d aelhlr_firm     s                   like(aefirm)
      *
     d p_in03          s              1
     d p_stat          s              1
     d p_jkod          s                   like(a2lage)
     d p_jtxt          s             20
     d p_lage          s                   like(a2lage)
     d p_alle          s                   like(a2alle)
8.00 d p_mapp          s                   like(aempty)
8.00 d p_fide          s                   like(aefide)
8.00 d p_etik          s                   like(aeetik)
8.00 d p_ovfa          s                   like(aeovfa)
8.00 d p_filg          s                   like(aefilg)
8.00 d p_firm          s                   like(aefirm)
8.00 d p_mpty          s                   like(aempty)
7.01 d p_full          s              1  0
      *
     d w_firm          s              3  0
     d w_lage          s              2  0
     d w_ltek          s             20
     d w_user          s                   like(l_user)
     d w_navn          s                   like(l_fnav)
      *
      /eject
     c     dummy         tag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * A2BLD  - A2 Bilde for valg av parametre
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A2BLD Behandle bilde for valg av utskriftskriteria              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a2taga        tag
      *
      * Bare data
      *
     c     a2tagb        tag
      *
8.00 c**                 eval      a2mapp = 'FTP'
     c                   exfmt     a2bld
      *
      * Gå ut
      *
     c                   if        *inkc = *on
     c                   move      '1'           p_in03
     c                   goto      xslutt
     c                   endif
      *
      * Lagerspørring
      *
     c                   if        *inkd = *on
     c                   eval      w_lage = 0
     c                   call      'RA510R'
     c                   parm                    w_firm
     c                   parm                    w_lage
     c                   parm                    w_ltek
     c                   eval      a2lage = w_lage
     c                   eval      a2ltek = w_ltek
8.02  *
8.02  * Hent info fra parameterfila
8.02  *
8.02 c                   move      a2lage        aelhl1_lage
8.02 c     aelhl1_key    chain     aelhl1
8.02 c                   if        %found
8.02 c                   eval      a2type = aeetik
8.02 c                   endif
      *
     c                   goto      a2tagb
     c                   endif
      *
      * Sjekk lager
      *
     c                   if        a2lage <> 0
     c                   move      a2lage        p_jkod
     c                   call      'RS710R'
     c                   parm                    p_stat
     c                   parm                    p_jkod
     c                   parm                    p_jtxt
      *
     c                   if        p_stat = 'N'
     c                   eval      *in30 = *on
     c                   goto      a2tagb
     c                   endif
     c                   endif
      *
      * Sjekk mappe
      *
8.00 c**                 if        a2mapp <> 'FTP' and
8.00 c**                           a2mapp <> 'IFS' and
8.00 c**                           a2mapp <> 'TST'
8.00 c**                 eval      *in32 = *on
8.00 c**                 goto      a2tagb
8.00 c**                 endif
8.00  *
8.00  * Hent info fra parameterfila
8.00  *
8.00 c                   move      a2lage        aelhl1_lage
8.00 c     aelhl1_key    chain     aelhl1
8.00 c                   if        not %found
8.00 c                   eval      *in34 = *on
8.00 c                   goto      a2tagb
8.00 c                   endif
      *
8.00 c                   if        %trim(a2alle) = *blanks
8.00 c                   eval      a2alle = 'L'
8.00 c                   endif
      *
      * Skriv parameter
      *
     c                   move      a2lage        p_lage
     c                   move      a2alle        p_alle
8.01 c**                 move      a2mapp        p_mapp
7.01 c                   eval      p_full = a2full
8.00 c                   eval      p_mapp = aempty
8.00 c                   eval      p_fide = %trim(aefide)
8.00 c                   eval      p_etik = aeetik
8.00 c                   eval      p_ovfa = aeovfa
8.00 c                   eval      p_filg = aefilg
8.00 c                   eval      p_firm = aefirm
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      w_firm = l_firm
     c                   eval      p_in03 = ' '
     c                   eval      a2lage = l_lage
     c                   eval      a2alle = ' '
8.00 c**                 eval      a2mapp = '       '
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_in03
8.00 c                   parm                    p_etik
8.00 c                   parm                    p_fide
8.00 c                   parm                    p_ovfa
8.00 c                   parm                    p_filg
8.00 c                   parm                    p_firm
     c                   parm                    p_lage
     c                   parm                    p_alle
     c                   parm                    p_mapp
7.01 c                   parm                    p_full
8.00  *
8.00  * Key for les på elektroniske hylleforkanter
8.00  *
8.00 c     aelhl1_key    klist
8.00 c                   kfld                    aelhl1_filg
8.00 c                   kfld                    aelhl1_firm
8.00 c                   kfld                    aelhl1_lage
8.00  *
8.00  * Key for les på elektroniske hylleforkanter
8.00  *
8.00 c     aelhlr_key    klist
8.00 c                   kfld                    aelhlr_filg
8.00 c                   kfld                    aelhlr_firm
8.00  * Hent info fra parameterfila
8.00  *
8.00 c                   eval      aelhlr_filg = l_filg
8.00 c                   eval      aelhlr_firm = l_firm
8.00 c                   eval      aelhl1_filg = l_filg
8.00 c                   eval      aelhl1_firm = l_firm
8.00  *
8.00 c     aelhlr_key    chain     aelhlr
8.00 c                   if        not %found
8.00 c                   eval      *in34 = *on
8.00 c                   else
8.00 c                   eval      a2type = aeetik
8.00 c                   eval      a2lage = aelage
8.00 c                   endif
      *
     c                   endsr
