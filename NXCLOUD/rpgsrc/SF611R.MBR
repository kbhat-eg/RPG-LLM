      /title  Utskrift av statistikk
     H datedit(*dmy.) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  System. . . . . : ASSTAT                                       *
      *  Program . . . . : SF611R                                       *
      *  Beskrivelse . . : Utskrift av statistikk                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  Spesialversjon. :                                              *
      *  Tilpasset for . :                                              *
      *                                                                 *
      *  Referanse  Dato   Endringsbeskrivelse                     Sign.*
      *  --------- ------  ---------------------------------------------*
      *  V3.20     150900  Lagt inn utvalg på leverandør                *
      *  V3.20     150900  Slått sammen rabattfelt til ett              *
      *  V5.30     060404  Endret lengde på rapporttype            KOB  *
      *  V5.30     070404  Kundeprosjekttekst ble ikke hentet      KOB  *
      *  V5.30     200904  Fjernet rabattgruppe                    KOB  *
      *  V5.40     240305  Lagt ut enhet på rapporten              KOB  *
      *  V5.50     301006  Lagt inn selger i kasse                 KOB  *
      *  V5.50     190307  Korrigert feil vedr. tekst rabattkat.   KOB  *
6.20  *  V5.50     230113  Utvidet RAB71 med 1 posisjon            BOF  *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     Fskwwpf    ip   e           k disk
     Fskpwpf    if   f  512    15aidisk    keyloc(1)
     Frkunl1    if   e           k disk
     Frlevl1    if   e           k disk
     Fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     Fvvasl1    if   e           k disk    rename(vvaspfr:vvasl1r)
     Fvahgl1    if   e           k disk
     Fvaugl1    if   e           k disk
     Fvogrl1    if   e           k disk    rename(vogrpfr:vogrl1r)
     Fvhgrl1    if   e           k disk    rename(vhgrpfr:vhgrl1r)
     Fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     Fvotyl1    if   e           k disk
     Fra06pf    if   e           k disk
     Fra07pf    if   e           k disk
     Fra08pf    if   e           k disk
     Fra09l1    if   e           k disk    rename(ra09pfr:ra09l1r)
     Fra10pf    if   e           k disk
     Fra11pf    if   e           k disk
     Fra12pf    if   e           k disk
      *
     Ffkprl1    if   e           k disk
     Fvltpl1    if   e           k disk
     Fsf611p    o    e             printer oflind(*in30)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tabeller                                                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     D rt              s             25    dim(60) ctdata perrcd(1)              RAPPORT TEKSTER
      *
     D w_uhgrp         s              5
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Data Strukturer                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     D                 ds
     D skpwpf_key                    15
     D  w1firm                        3  0 overlay(skpwpf_key:1)
     D  w_type                       10    overlay(skpwpf_key:4)
     D  w_kode                        2    overlay(skpwpf_key:14)
      *
     D                 ds
     D beg                           15
     D  begnum                       15  0 overlay(beg)
     D   k6                           6  0 overlay(begnum)
      *
     D                 ds
     D w_xgrp                         7  0
     D  w_xogr                        2  0 overlay(w_xgrp:1)
     D  w_xhgr                        2  0 overlay(w_xgrp:3)
     D  w_xugr                        3  0 overlay(w_xgrp:5)
      *
     D                uds
     D l_wsid                901    910
     D l_user                911    920
     D l_firm                944    946  0
     D l_navn                951    980
      *
     D ant4            s                   like(ant7)
     D ant4u           s              8  0
     D ant5            s                   like(ant7)
     D ant5u           s                   like(ant4u)
     D ant6            s                   like(ant7)
     D ant6u           s                   like(ant4u)
     D ant7            s             10  2
     D ant7u           s                   like(ant4u)
     D begtek          s             35
     D begenh          s              3
     D brtt2           s             35
     D brtt3           s             35
     D enht2           s              3
     D enht3           s              3
     D bru2            s             11  2
     D bru4            s                   like(bru7)
     D bru5            s                   like(bru7)
     D bru6            s                   like(bru7)
     D bru7            s              9  0
     D dek4            s              9  0
     D dek5            s                   like(dek4)
     D dek6            s                   like(dek4)
     D dek7            s                   like(dek4)
     D kst2            s             11  2
     D kst4            s                   like(kst7)
     D kst5            s                   like(kst7)
     D kst6            s                   like(kst7)
     D kst7            s              9  0
     D net4            s              9  0
     D net5            s                   like(net4)
     D net6            s                   like(net4)
     D net7            s                   like(net4)
     D pde4            s              7  2
     D pde5            s                   like(pde4)
     D pde6            s                   like(pde4)
     D pde7            s                   like(pde4)
     D pra4            s              7  2
     D pra5            s                   like(pra4)
     D pra6            s                   like(pra4)
     D pra7            s                   like(pra4)
     D rap             s              2  0
      *
     D rab21           s             11  2
     D rab41           s              8  0
     D rab51           s                   like(rab41)
     D rab61           s                   like(rab41)
6.20 D rab71           s              9  0
      *
     D rptek           s             30
     D rpenh           s              3
     D utime           s              6  0
     D w_fkod          s                   like(rafkod)
     D w_gkod          s                   like(ragkod)
     D w_hkod          s                   like(rahkod)
     D w_ikod          s                   like(raikod)
     D w_jkod          s                   like(rajkod)
     D w_kkod          s                   like(rakkod)
     D w_kund          s                   like(rkkund)
     D w_levr          s                   like(rllevr)
     D w_lkod          s                   like(ralkod)
     D w_otyp          s                   like(vaotyp)
     D w_oogr          s                   like(vgoogr)
     D w_hogr          s                   like(vghogr)
     D w_hhgr          s                   like(vghhgr)
     D w_uogr          s                   like(vguogr)
     D w_uhgr          s                   like(vguhgr)
     D w_uugr          s                   like(vguugr)
     D w_vare          s                   like(vvvare)
     D w_firm          s                   like(spfirm)
     D w_kpro          s                   like(flkpro)
     D w_lety          s                   like(vylety)
     D w_timestamp     s             12  0
     D w_date          s              6  0
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Input                                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     Iskwwpfr       01
     I                                          sffirm        l7
     I                                          swsrt1        l6
     I                                          swsrt2        l5
     I                                          swsrt3        l4
      *
     Iskpwpf    ns  01   14 c0   15 c0
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61   62 0rp1
     I                                 63   64 0rp2
     I                                 65   66 0rp3
     I                                 67   67  spes1
     I                                 68   68  spes2
     I                                 69   69  spes3
     I                                 70   70  spes4
     I                                 71   71  spes5
     I                                 73   74 0spmnd
     I                                 75   78 0spaar
     I                                 79   79  spsmli
     I                                 80   80  spsps7
     I                                 81   81  spsss1
     I                                 82   82  spsss2
     I                                 83   83  spsss3
     I                                 84   84  spslet
      *
     I          ns  01   14 c4   15 c1
     I                                  1    3 0spfirm
     I                                  4   13  sptype
     I                                 14   15 0spkode
     I                                 31   60  sptext
     I                                 61   64 0spfaar
     I                                 65   66 0spfmnd
     I                                 67   70 0sptaar
     I                                 71   72 0sptmnd
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Calculation                                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
B001 C     dummy         tag
      *
B001 C   l6              do
 001 C                   eval      ant6 = 0
 001 C                   eval      bru6 = 0
 001 C                   eval      rab61 = 0
 001 C                   eval      kst6 = 0
 001  *
 001 C                   move      swsrt1        beg
 001 C                   eval      rap = rp1
 001 C                   exsr      raprut                                                     .
 001 C                   movel     rptek         begtek                                       .
 001 C                   movel     rpenh         begenh                                       .
 001  *                                                                  .
E001 C                   enddo                                                            .....
      *
B001 C   l5              do                                                               .....
 001 C                   eval      ant5 = 0                                                   .
 001 C                   eval      bru5 = 0                                                   .
 001 C                   eval      rab51 = 0                                                  .
      *
      *
 001 C                   eval      kst5 = 0                                                   .
 001 C                   eval      brtt2 = *blank                                             .
 001 C                   eval      enht2 = *blank                                             .
 001  *                                                                  .
B002 C                   if        rp2 <> *zero                                         ..... .
 002 C                   move      swsrt2        beg                                        . .
 002 C                   eval      rap = rp2                                                . .
 002 C                   exsr      raprut                                                   . .
 002 C                   movel     rptek         brtt2                                      . .
 002 C                   movel     rpenh         enht2                                      . .
E002 C                   endif                                                          ..... .
 001  *                                                                  .
E001 C                   enddo                                                            .....
      *
B001 C   l4              do                                                               .....
 001 C                   eval      ant4 = 0                                                   .
 001 C                   eval      bru4 = 0                                                   .
 001 C                   eval      rab41 = 0                                                  .
 001  *                                                                  .
 001  *                                                                  .
 001 C                   eval      kst4 = 0                                                   .
 001  *                                                                  .
 001 C                   eval      bru2 = 0                                                   .
 001 C                   eval      rab21 = 0                                                  .
 001  *                                                                  .
 001  *                                                                  .
 001 C                   eval      kst2 = 0                                                   .
 001  *                                                                  .
 001 C                   eval      brtt3 = *blank                                             .
 001 C                   eval      enht3 = *blank                                             .
 001  *                                                                  .
B002 C                   if        rp3 <> *zero                                         ..... .
 002 C                   move      swsrt3        beg                                        . .
 002 C                   eval      rap = rp3                                                . .
 002 C                   exsr      raprut                                                   . .
 002 C                   movel     rptek         brtt3                                      . .
 002 C                   movel     rpenh         enht3                                      . .
E002 C                   endif                                                          ..... .
 001  *                                                                  .
E001 C                   enddo                                                            .....
      /eject
      *
     c                   eval      rptek = *blank
     c                   eval      rpenh = *blank
      *
      * Summering av enkeltposter
      *
     C                   eval      ant4 = ant4 + sfanta
     C                   eval      bru2 = bru2 + sfsumb
     C                   eval      rab21 = rab21 + sfrab1 + sfrab2 + sfrabo
      *
      *
     C                   eval      kst2 = kst2 + sfsumk
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     xslutt        tag
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Brudd                                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Brudd på l4 (SRT3)
      *
     Cl4                 exsr      brdl4
     Cl4                 if        swsrt3 <> *blank
     C                             and spes3 = ' '
     Cl4                 write     TOl41                                30
     Cl4 73              move      *on           *in30
     Cl4                 exsr      overflow
     Cl4                 endif
      *
      * BRUDD PÅ l5  (SRT2)
      *
     Cl5                 exsr      brdl5
     Cl5                 if        swsrt2 <> *blank
     C                             and spes2 = ' '
     Cl5                 write     TOl51                                30
     Cl5 72              move      *on           *in30
     Cl5                 exsr      overflow
     Cl5                 endif
      *
      * BRUDD PÅ l6  (SRT1)
      *
     Cl6                 exsr      brdl6
      *
     Cl6                 if        swsrt1 <> *blank
     C                             and swsrt2 <> *blank and spes1 = ' '
     Cl6                 write     TOl62A                               30
     Cl6 71              move      *on           *in30
     Cl6                 exsr      overflow
     Cl6                 else
     Cl6                 write     TOl62b                               30
     Cl6 71              move      *on           *in30
     Cl6                 exsr      overflow
     Cl6                 endif
      *
      * BRUDD PÅ l7  (FIRMA)
      *
     Cl7                 if        *in64 = *off
     Cl7                 exsr      brdl7
     Cl7                 write     TOl71                                30
     Cl7                 endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for behandling av rapport                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     raprut        begsr
      *
     C                   eval      rptek = *blank
      *
      * -----------------
      * Alt. hovedgruppe
      * -----------------
      *
B001 C                   if        rap = 11                                               .....
 001 C                   movel     beg           w_hhgr                                       .
 001 C     hgrkey        chain     vahgl1                             50                      .
B002 C                   if        *in50 = *off
 002 C                   movel     vfhtxt        rptek                                        .
E002 C                   endif
 001 C                   goto      endrut                                                     .
E001 C                   endif                                                            .....
      *
      * -----------------
      * Alt. undergruppe
      * -----------------
      *
B001 C                   if        rap = 12                                               .....
     C                   movel     beg           w_uhgrp
 001 C                   movel     w_uhgrp       w_uhgr
 001 C                   move      w_uhgrp       w_uugr
 001 C     ugrkey        chain     vaugl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vfutxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ------------------
      * Overgruppe
      * ------------------
      *
B001 C                   if        rap = 14                                               .....
 001 C                   movel     beg           w_xgrp                                       .
 001 C                   eval      w_oogr = w_xogr                                            .
 001 C     vogrl1_key    chain     vogrl1                             50                      .
B002 C                   if        *in50 = *off
 002 C                   movel     vgotxt        rptek                                        .
E002 C                   endif
 001 C                   goto      endrut                                                     .
E001 C                   endif                                                            .....
      *
      * ------------------
      * Hovedgruppe
      * ------------------
      *
B001 C                   if        rap = 15                                               .....
 001 C                   movel     beg           w_xgrp                                       .
 001 C                   eval      w_hogr = w_xogr                                            .
 001 C                   eval      w_hhgr = w_xhgr                                            .
 001 C     vhgrl1_key    chain     vhgrl1                             50                      .
B002 C                   if        *in50 = *off
 002 C                   movel     vghtxt        rptek                                        .
E002 C                   endif
 001 C                   goto      endrut                                                     .
E001 C                   endif                                                            .....
      *
      * ------------------
      * Undergruppe
      * ------------------
      *
B001 C                   if        rap = 16                                               .....
 001 C                   movel     beg           w_xgrp                                       .
 001 C                   eval      w_uogr = w_xogr                                            .
 001 C                   eval      w_uhgr = w_xhgr                                            .
 001 C                   eval      w_uugr = w_xugr                                            .
 001 C     vugrl1_key    chain     vugrl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vgutxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Kundekategori
      * ---------------
      *
B001 C                   if        rap = 21                                               .....
 001 C                   movel     beg           w_kkod
 001 C     ra11pf_key    chain     ra11pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raktxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Rabattkategori
      * ---------------
      *
B001 C                   if        rap = 22                                               .....
 001 C                   movel     beg           w_fkod
 001 C     ra06pf_key    chain     ra06pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raftxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Distrikt
      * ---------------
      *
B001 C                   if        rap = 23                                               .....
 001 C                   movel     beg           w_hkod
 001 C     ra08pf_key    chain     ra08pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rahtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Selger
      * ---------------
      *
B001 C                   if        rap = 24                                               .....
 001 C                   movel     beg           w_ikod
 001 C     ra09l1_key    chain     ra09l1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raitxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Land
      * ---------------
      *
B001 C                   if        rap = 25                                               .....
 001 C                   move      beg           w_lkod
 001 C     ra12pf_key    chain     ra12pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raltxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Selger kasse
      * ---------------
      *
B001 C                   if        rap = 27                                               .....
 001 C                   movel     beg           w_ikod
 001 C     ra09l1_key    chain     ra09l1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raitxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * 2 første siffer
      * kundekategori
      * ---------------
      *
B001 C                   if        rap = 26                                               .....
 001 C                   movel     rt(26)        rptek
 001 C                   movel     beg           w_kkod
 001 C     ra11pf_key    chain     ra11pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raktxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Varenummer
      * ---------------
      *
B001 C                   if        rap = 31                                               .....
 001 C                   movel     beg           w_vare
 001 C     vvarl1_key    chain     vvarl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vvtek1        rptek
     C                   move      vvenhs        rpenh
E002 C                   endif
B002 C                   if        *in50 = *on
 001 C     vvarl1_key    chain     vvasl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vvtek1        rptek
     C                   move      vvenhs        rpenh
E002 C                   else
 002 C                   movel     sftek1        rptek
     C                   move      sfenhe        rpenh
E002 C                   endif
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Kundenummer
      * ---------------
      *
B001 C                   if        rap = 32                                               .....
 001 C                   movel     k6            w_kund
 001 C     rkunl1_key    chain     rkunl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rknavn        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Kundeprosjekt
      * ---------------
      *
B001 C                   if        rap = 33                                               .....
 001 C                   movel     k6            w_kpro
B001 C                   if        w_kpro <> *zeros                                       .....
 001 C                   move      sfvkun        w_kund
 001 C     fkprl1_key    chain     fkprl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     flnavn        rptek
E002 C                   endif
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Periode
      * ---------------
      *
B001 C                   if        rap = 41                                               .....
 001 C                   movel     rt(41)        rptek
E001 C                   endif                                                            .....
      *
      * ---------------
      * Fakturanr/
      * Kreditnotanr.
      * ---------------
      *
B001 C                   if        rap = 42                                               .....
 001 C                   movel     rt(42)        rptek
E001 C                   endif                                                            .....
      *
      * ---------------
      * Fakturadato
      * ---------------
      *
B001 C                   if        rap = 43                                               .....
 001 C                   movel     rt(43)        rptek
E001 C                   endif                                                            .....
      *
      * ---------------
      * Ordretype
      * ---------------
      *
B001 C                   if        rap = 51                                               .....
 001 C                   movel     beg           w_otyp
 001 C     votyl1_key    chain     votyl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vaotxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Avdeling
      * ---------------
      *
B001 C                   if        rap = 52                                               .....
 001 C                   movel     beg           w_gkod
 001 C     ra07pf_key    chain     ra07pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     ragtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Lager
      * ---------------
      *
B001 C                   if        rap = 53                                               .....
 001 C                   movel     beg           w_jkod
 001 C     ra10pf_key    chain     ra10pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rajtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Leveringstype
      * ---------------
      *
B001 C                   if        rap = 55                                               .....
 001 C                   movel     rt(55)        rptek
 001 C                   movel     beg           w_lety
 001 C     vltpl1_key    chain     vltpl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vybesk        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Leverandørnummer
      * ---------------
      *
B001 C                   if        rap = 56                                               .....
 001 C                   movel     k6            w_levr
 001 C     rlevl1_key    chain     rlevl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rlnavn        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
      * ---------------
      * Time
      * ---------------
      *
B001 C                   if        rap = 57                                               .....
 002 C                   movel     *blank        rptek
 001 C                   goto      endrut
E001 C                   endif                                                            .....
      *
     C     endrut        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for brudd på l4 (SRT3)                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     brdl4         begsr
      *
     C                   eval(h)   bru4 = bru2
     C                   eval(h)   rab41 = rab21
      *
      *
     C                   eval(h)   kst4 = kst2
      *
     C                   eval      net4 = bru4 - rab41
     C                   eval      dek4 = net4 - kst4
      *
B001 C                   if        net4 <> *zero                                          .....
     C                   select
 001 C                   when      (dek4 / net4 * 100) < -999,99
     C                   eval      pde4 = -999,99
 001 C                   when      (dek4 / net4 * 100) >  99,99
     C                   eval      pde4 = 100
     C                   other
 001 C                   eval(h)   pde4 = dek4 / net4 * 100                                   .
     C                   endsl
E001 C                   endif                                                            .....
      *
B001 C                   if        bru4 <> *zero                                          .....
     C                   select
 001 C                   when      (rab41 / bru4 * 100) < -99,99
     C                   eval      pra4 = -100
 001 C                   when      (rab41 / bru4 * 100) >  99,99
     C                   eval      pra4 = 100
     C                   other
 001 C                   eval(h)   pra4 = rab41 / bru4 * 100                                  .
     C                   endsl
E001 C                   endif                                                            .....
      *
     C                   eval      ant5 = ant5 + ant4
     C                   eval      bru5 = bru5 + bru4
     C                   eval      rab51 = rab51 + rab41
      *
      *
     C                   eval      kst5 = kst5 + kst4
 001 C                   eval      ant4u = ant4
      *
     C                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for brudd på l5 (SRT2)                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     brdl5         begsr
      *
     C                   eval      net5 = bru5 - rab51
     C                   eval      dek5 = net5 - kst5
      *
B001 C                   if        net5 <> *zero                                          .....
     C                   select
 001 C                   when      (dek5 / net5 * 100) < -999,99
     C                   eval      pde5 = -999,99
 001 C                   when      (dek5 / net5 * 100) >  99,99
     C                   eval      pde5 = 100
     C                   other
 001 C                   eval(h)   pde5 = dek5 / net5 * 100                                   .
     C                   endsl
E001 C                   endif                                                            .....
      *
B001 C                   if        bru5 <> *zero                                          .....
     C                   select
 001 C                   when      (rab51 / bru5 * 100) < -99,99
     C                   eval      pra5 = -100
 001 C                   when      (rab51 / bru5 * 100) >  99,99
     C                   eval      pra5 = 100
     C                   other
 001 C                   eval(h)   pra5 = rab51 / bru5 * 100                                  .
     C                   endsl
E001 C                   endif                                                            .....
      *
     C                   eval      ant6 = ant6 + ant5
     C                   eval      bru6 = bru6 + bru5
     C                   eval      rab61 = rab61 + rab51
      *
      *
     C                   eval      kst6 = kst6 + kst5
 001 C                   eval      ant5u = ant5
      *
     C                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for brudd på l6 (SRT1)                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     brdl6         begsr
      *
     C                   eval      net6 = bru6 - rab61
     C                   eval      dek6 = net6 - kst6
      *
B001 C                   if        net6 <> *zero                                          .....
     C                   select
 001 C                   when      (dek6 / net6 * 100) < -999,99
     C                   eval      pde6 = -999,99
 001 C                   when      (dek6 / net6 * 100) >  99,99
     C                   eval      pde6 = 100
     C                   other
 001 C                   eval(h)   pde6 = dek6 / net6 * 100                                   .
     C                   endsl
E001 C                   endif                                                            .....
      *
B001 C                   if        bru6 <> *zero                                          .....
 001 C                   eval      *in36 = bru6 <> 0                                          .
     C                   select
 001 C                   when      (rab61 / bru6 * 100) < -99,99
     C                   eval      pra6 = -100
 001 C                   when      (rab61 / bru6 * 100) >  99,99
     C                   eval      pra6 = 100
     C                   other
 001 C                   eval(h)   pra6 = rab61 / bru6 * 100                                  .
     C                   endsl
E001 C                   endif                                                            .....
      *
     C                   eval      ant7 = ant7 + ant6
     C                   eval      bru7 = bru7 + bru6
     C                   eval      rab71 = rab71 + rab61
      *
      *
     C                   eval      kst7 = kst7 + kst6
     C                   eval      ant6u = ant6
      *
     C                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for brudd på l7 (Firma)                               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     brdl7         begsr
      *
     C                   eval      net7 = bru7 - rab71
     C                   eval      dek7 = net7 - kst7
      *
B001 C                   if        net7 <> *zero                                          .....
     C                   select
 001 C                   when      (dek7 / net7 * 100) < -999,99
     C                   eval      pde7 = -999,99
 001 C                   when      (dek7 / net7 * 100) >  99,99
     C                   eval      pde7 = 100
     C                   other
 001 C                   eval(h)   pde7 = dek7 / net7 * 100                                   .
     C                   endsl
E001 C                   endif                                                            .....
      *
B001 C                   if        bru7 <> *zero                                          .....
     C                   select
 001 C                   when      (rab71 / bru7 * 100) < -99,99
     C                   eval      pra7 = -100
 001 C                   when      (rab71 / bru7 * 100) >  99,99
     C                   eval      pra7 = 100
     C                   other
 001 C                   eval(h)   pra7 = rab71 / bru7 * 100                                  .
     C                   endsl
E001 C                   endif                                                            .....
      *
     C                   eval      ant7u = ant7
      *
     C                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for behandling av overflow                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     overflow      begsr
      *
     C                   if        *in30 = *on
     C                   if        rp1 > 0
     C                   eval      h1srt1 = rt(rp1)
     C                   endif
     C                   if        rp2 > 0
     C                   eval      h1srt2 = rt(rp2)
     C                   endif
     C                   if        rp3 > 0
     C                   eval      h1srt3 = rt(rp3)
     C                   endif
 001 C                   write     HD1A
     C                   endif
     C                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     *inzsr        begsr
      *
     C                   eval      begtek = *blank
     C                   eval      rptek = *blank
     C                   eval      brtt2 = *blank
     C                   eval      brtt3 = *blank
     C                   eval      rap = *zero
      *
     C                   eval      net4 = 0
     C                   eval      dek4 = 0
     C                   eval      rab41 = 0
      *
      *
     C                   eval      pde4 = 0
     C                   eval      pra4 = 0
     C                   eval      ant4u = 0
      *
     C                   eval      bru2 = 0
     C                   eval      rab21 = 0
      *
      *
     C                   eval      kst2 = 0
      *
     C                   eval      ant7 = 0
     C                   eval      bru7 = 0
     C                   eval      rab71 = 0
      *
      *
     C                   eval      kst7 = 0
      *
     C                   eval      *in20 = *off
     C                   eval      *in96 = *off
      *
      * Behandle kriterier for valg
      *
     C     *entry        plist
     C                   parm                    dstype           10
      *
     C                   time                    w_timestamp
     C                   move      w_timestamp   w_date
      *
     C                   eval      skpwpf_key = *blank
      *
     C                   move      l_firm        w1firm
     C                   move      l_firm        w_firm
     C                   movel     dstype        w_type
     C                   move      '00'          w_kode
     C     skpwpf_key    chain     skpwpf                             50
      *
     C                   eval      *in61 = spes1 <> ' '                          BEGREP 1
     C                   eval      *in62 = spes2 <> ' '                          BEGREP 2
     C                   eval      *in63 = spes3 <> ' '                          BEGREP 3
     C                   eval      *in64 = spes4 <> ' '                          FIRMA
     C                   eval      *in65 = spes5 <> ' '                          TOTALT
      *
     C                   eval      *in57 = rp2 <> 0
     C                   eval      *in58 = rp3 <> 0
      *
     C                   eval      *in70 = spsps7 <> ' '                         BEGREP 1
     C                   eval      *in71 = spsss1 <> ' '                         BEGREP 1
     C                   eval      *in72 = spsss2 <> ' '                         BEGREP 1
     C                   eval      *in73 = spsss3 <> ' '                         BEGREP 1
      *
     C                   time                    utime
      *
     C                   if        rp1 > 0
     C                   eval      h1srt1 = rt(rp1)
     C                   endif
      *
     C                   if        rp2 > 0
     C                   eval      h1srt2 = rt(rp2)
     C                   endif
      *
     C                   if        rp3 > 0
     C                   eval      h1srt3 = rt(rp3)
     C                   endif
      *
     C                   eval      h1type = sptype
     C                   eval      h1text = sptext
      *
      * Hent periode fra - til
      *
     C                   move      '41'          w_kode
     C     skpwpf_key    chain     skpwpf                             50
      *
     C                   eval      h1fmnd = spfmnd
     C                   eval      h1faar = spfaar
     C                   eval      h1tmnd = sptmnd
     C                   eval      h1taar = sptaar
      *
 001 C                   write     HD1A
      *
      * Key for vareregister
      *
     C     vvarl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_vare
      *
      * Key for kunderegister
      *
     C     rkunl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_kund
      *
      * Key for leverandørregister
      *
     C     rlevl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_levr
      *
      *
      * Key for kundeprosjekt
      *
     C     fkprl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_kund
     C                   kfld                    w_kpro
      *
      * Key for alt. hovedgruppe
      *
     C     hgrkey        klist
     C                   kfld                    w_firm
     C                   kfld                    w_hhgr
      *
      * Key for alt. undergruppe
      *
     C     ugrkey        klist
     C                   kfld                    w_firm
     C                   kfld                    w_uhgr
     C                   kfld                    w_uugr
      *
      * Key for overgruppe
      *
     C     vogrl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_oogr
      *
      * Key for hovedgruppe
      *
     C     vhgrl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_hogr
     C                   kfld                    w_hhgr
      *
      * Key for undergruppe
      *
     C     vugrl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_uogr
     C                   kfld                    w_uhgr
     C                   kfld                    w_uugr
      *
      * Key for ordretype
      *
     C     votyl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_otyp
      *
      * Key for rabattkategori
      *
     C     ra06pf_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_fkod
      *
      * Key for AVDELING
      *
     C     ra07pf_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_gkod
      *
      * Key for DISTRIKT
      *
     C     ra08pf_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_hkod
      *
      * Key for SELGER
      *
     C     ra09l1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_ikod
      *
      * Key for LAGER
      *
     C     ra10pf_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_jkod
      *
      * Key for KUNDEKATEGORI
      *
     C     ra11pf_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_kkod
      *
      * Key for LAND
      *
     C     ra12pf_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_lkod
      *
      * Key for leveringstype
      *
     C     vltpl1_key    klist
     C                   kfld                    w_firm
     C                   kfld                    w_lety
      *
     C                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Tabeller                                                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
**       RAPPORT  TEKSTER
 Ledig                      01
 Ledig                      02
 Ledig                      03
 Ledig                      04
 Ledig                      05
 Ledig                      06
 Ledig                      07
 Ledig                      08
 Ledig                      09
 Ledig                      10
 Alt. hovedgruppe           11
 Alt. undergruppe           12
 Rabattgruppe               13
 Overgruppe                 14
 Hovedgruppe                15
 Undergruppe                16
 Ledig                      17
 Ledig                      18
 Ledig                      19
 Ledig                      20
 Kundekategori              21
 Rabattkategori             22
 Distrikt                   23
 Selger ordre               24
 Land                       25
 Hgr.-kundekat.             26
 Selger kasse               27
 Ledig                      28
 Ledig                      29
 Ledig                      30
 Varenummer                 31
 Kunde                      32
 Kundeprosjekt              33
 Ledig                      34
 Ledig                      35
 Ledig                      36
 Ledig                      37
 Ledig                      38
 Ledig                      39
 Ledig                      40
 Periode                    41
 Faktnr/Krednr              42
 Fakturadato                43
 Ledig                      44
 Ledig                      45
 Ledig                      46
 Ledig                      47
 Ledig                      48
 Ledig                      49
 Ledig                      50
 Ordretype                  51
 Avdeling                   52
 Lager                      53
 Produktansvarlig           54
 Leveringstype              55
 Leverandør                 56
 Time                       57
 Ledig                      58
 Ledig                      59
 Ledig                      60
