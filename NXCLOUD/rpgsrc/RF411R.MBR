     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOKON
      * Program . . . . : RF411R
      * Beskrivelse . . : Koder, kopiering av statuskoder
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *           200104  Nytt program                                   KOB  *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fafirl1    if   e           k disk    rename(afirpfr:afirl1r)
     fraa1l1    if   e           k disk    rename(raa1pfr:raa1l1r)
     fraa2l1    if   e           k disk    rename(raa2pfr:raa2l1r)
     fraa3l1    if   e           k disk    rename(raa3pfr:raa3l1r)
     fraa4l1    if   e           k disk    rename(raa4pfr:raa4l1r)
     fraa5l1    if   e           k disk    rename(raa5pfr:raa5l1r)
     fraa6l1    if   e           k disk    rename(raa6pfr:raa6l1r)
     fraa7l1    if   e           k disk    rename(raa7pfr:raa7l1r)
     fraa1lu    uf a e           k disk    rename(raa1pfr:raa1lur)
     fraa2lu    uf a e           k disk    rename(raa2pfr:raa2lur)
     fraa3lu    uf a e           k disk    rename(raa3pfr:raa3lur)
     fraa4lu    uf a e           k disk    rename(raa4pfr:raa4lur)
     fraa5lu    uf a e           k disk    rename(raa5pfr:raa5lur)
     fraa6lu    uf a e           k disk    rename(raa6pfr:raa6lur)
     fraa7lu    uf a e           k disk    rename(raa7pfr:raa7lur)
     frf411d    cf   e             workstn
      *
     d                uds
     d l_user                911    920
     d l_sbib                934    943
     d l_firm                944    946  0
     d l_navn                951    980
      *                                                                     -
     d w_tfir          s              3  0
     d w_in03          s              1  0
     d w_ffir          s              3  0
     d w_user          s                   like(l_user)
      *
     c     dummy         tag
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A1BLD Behandle bilde for valg av vedlikehold/kopiering          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a1taga        tag
      *
      * Bare data
      *
     c     a1tagb        tag
      *
     c                   exfmt     a1bld
      *
      * Gå ut
      *
     c                   if        *inkc = *on or                               .....
     c                             *inkl = *on                                  .....
     c                   eval      w_in03 = 1                                       .
     c                   goto      slutt                                            .
     c                   endif                                                  .....
      *
      *  Kopier valgte koder
      *
     c                   if        a1ko01 = '1'
     c                   exsr      subaa1
     c                   endif
      *
     c                   if        a1ko02 = '1'
     c                   exsr      subaa2
     c                   endif
      *
     c                   if        a1ko03 = '1'
     c                   exsr      subaa3
     c                   endif
      *
     c                   if        a1ko04 = '1'
     c                   exsr      subaa4
     c                   endif
      *
     c                   if        a1ko05 = '1'
     c                   exsr      subaa5
     c                   endif
      *
     c                   if        a1ko06 = '1'
     c                   exsr      subaa6
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     slutt         tag
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for kopiering av regnskapskoder                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     subaa1        begsr
      *
     c     raa1l1_key    setll     raa1l1                                 60
     c     raa1l1_key    reade     raa1l1                                 60
      *
     c                   dow       *in60 = *off
     c                   eval      ra1fir = w_tfir
     c                   write     raa1lur
     c     raa1l1_key    reade     raa1l1                                 60
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for kopiering av OCR-koder                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     subaa2        begsr
      *
     c     raa2l1_key    setll     raa2l1                                 60
     c     raa2l1_key    reade     raa2l1                                 60
      *
     c                   dow       *in60 = *off
     c                   eval      ra2fir = w_tfir
     c                   write     raa2lur
     c     raa2l1_key    reade     raa2l1                                 60
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for kopiering av reskontrokoder                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     subaa3        begsr
      *
     c     raa3l1_key    setll     raa3l1                                 60
     c     raa3l1_key    reade     raa3l1                                 60
      *
     c                   dow       *in60 = *off
     c                   eval      ra3fir = w_tfir
     c                   write     raa3lur
     c     raa3l1_key    reade     raa3l1                                 60
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for kopiering av sist brukte nummer                   *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     subaa4        begsr
      *
     c                   eval      ra4aar = *zero
     c     raa4l1_key    setll     raa4l1                                 60
     c     raa4l1_key    reade     raa4l1                                 60
      *
     c                   dow       *in60 = *off
     c                   eval      ra4fir = w_tfir
     c                   write     raa4lur
     c     raa4l1_key    reade     raa4l1                                 60
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for kopiering av Rentenota/Purring                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     subaa5        begsr
      *
     c     raa5l1_key    setll     raa5l1                                 60
     c     raa5l1_key    reade     raa5l1                                 60
      *
     c                   dow       *in60 = *off
     c                   eval      ra5fir = w_tfir
     c                   write     raa5lur
     c     raa5l1_key    reade     raa5l1                                 60
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for kopiering av redigeringsvalg                      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     subaa6        begsr
      *
     c     raa6l1_key    setll     raa6l1                                 60
     c     raa6l1_key    reade     raa6l1                                 60
      *
     c                   dow       *in60 = *off
     c                   eval      ra6fir = w_tfir
     c                   write     raa6lur
     c     raa6l1_key    reade     raa6l1                                 60
     c                   enddo
      *
     c                   endsr
      *
      /eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Legge inn firmanummer og navn fra parameter
      *
     c                   eval      w_user = l_user
     c                   move      l_firm        w_ffir
     c                   move      l_firm        a1ffir
     c                   move      l_navn        a1fnav
      *
     c                   move      '1'           a1ko01
     c                   move      '1'           a1ko02
     c                   move      '1'           a1ko03
     c                   move      '1'           a1ko04
     c                   move      '1'           a1ko05
     c                   move      '1'           a1ko06
      *
     c                   eval      w_in03 = *zero
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    w_in03
     c                   parm                    w_tfir
      *
      * Henter til firma
      *
     c                   eval      aaffir = w_tfir
     c     afirl1_key    chain     afirl1
      *
     c                   eval      a1tfir = w_tfir
     c                   if        %found
     c                   move      aafnav        a1tnav
     c                   endif
      *
     c                   eval      w_ffir = l_firm
      *
      * Key for FIRMA
      *
     c     afirl1_key    klist
     c                   kfld                    w_tfir
      *
      * Key for KODER
      *
     c     raa1l1_key    klist
     c                   kfld                    w_ffir
      *
     c     raa2l1_key    klist
     c                   kfld                    w_ffir
      *
     c     raa3l1_key    klist
     c                   kfld                    w_ffir
      *
     c     raa4l1_key    klist
     c                   kfld                    w_ffir
     c                   kfld                    ra4aar
      *
     c     raa5l1_key    klist
     c                   kfld                    w_ffir
      *
     c     raa6l1_key    klist
     c                   kfld                    w_ffir
      *
     c     raa7l1_key    klist
     c                   kfld                    w_ffir
      *
     c                   endsr
