     H/TITLE    Trekker sammen poster på generalnota til en post
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON
      * Program . . . . : RK661BR
      * Beskrivelse . . : Trekker sammen poster på generalnota til en post
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Spesialversjon. :
      * Tilpasset for . : Mestergruppen
      *
      * Referanse  Dato   Endringsbeskrivelse                            Sig
      * --------- ------  ---------------------------------------------- ---
      * v5.40     010208  Nytt program                                   HFL
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frkwbl3    if   e           k disk    rename(rkwbpfr:rkwbl3r)
     f                                     prefix('Z')
     frkwdpf    uf a e           k disk
      *
     d w_firm          s                   like(rnfirm)
     d s_kund          s                   like(rnkund)
     d s_bdat          s                   like(rnbdat)
     d s_raar          s                   like(rnraar)
     d s_samf          s                   like(rnsamf)
     d s_rfda          s                   like(rwrfda)
     d s_rtda          s                   like(rwrtda)
     d w_belØ          s                   like(rnbelØ)
     d w_rest          s                   like(rnrest)
     d w_rent          s                   like(rwrent)
     d w_rgrl          s                   like(rwrgrl)
      *
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * local data
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d                uds
     d  l_user               911    920
     d  l_firm               944    946  0
     d  l_fnav               951    980
      *
     c     rkwbl3_key    setll     rkwbl3
     c     rkwbl3_key    reade     rkwbl3                                 60
      *
     c     *in60         doweq     *off
      *
      * Poster som ikke er på generalnota tas med som de er
      *
     c                   if        zrnsamf = *zero
     c                   exsr      felt
     c                   write     rkwdpfr
     c                   goto      neste
     c                   else
      *
      * Poster som er på generalnota trekkes sammen til 1 post pr år/samf
      *
     c                   if        s_samf  <> *zero
     c                   if        zrnraar <> s_raar or
     c                             zrnsamf <> s_samf
     c                   exsr      trekk
     c                   write     rkwdpfr
     c                   endif
     c                   endif
      *
     c                   exsr      felt
     c                   eval      w_belØ = w_belØ + rnbelØ
     c                   eval      w_rest = w_rest + rnrest
     c                   eval      w_rent = w_rent + rwrent
     c                   eval      w_rgrl = w_rgrl + rwrgrl
     c                   eval      s_kund = rnkund
     c                   eval      s_bdat = rnbdat
     c                   eval      s_raar = rnraar
     c                   eval      s_samf = rnsamf
     c                   eval      s_rfda = rwrfda
     c                   eval      s_rtda = rwrtda
     c                   endif
      *
     c     neste         tag
     c     rkwbl3_key    reade     rkwbl3                                 60
     c                   enddo
      *
     c     slutt         tag
      *
     c                   if        w_rest  <> *zero
     c                   exsr      trekk
     c                   write     rkwdpfr
     c                   endif
      *
     c                   seton                                        lr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for sammentrekking til 1 post (generalnota)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     c     trekk         begsr
      *
     c                   eval      rnbelØ = w_belØ
     c                   eval      rnrest = w_rest
     c                   eval      rwrent = w_rent
     c                   eval      rwrgrl = w_rgrl
     c                   eval      rnkund = s_kund
     c                   eval      rnbdat = s_bdat
     c                   eval      rnbiln = s_samf
     c                   eval      rwrfda = s_rfda
     c                   eval      rwrtda = s_rtda
     c                   eval      rntext = 'GENERALNOTA'
     c                   eval      w_belØ = *zero
     c                   eval      w_rest = *zero
     c                   eval      w_rent = *zero
     c                   eval      w_rgrl = *zero
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for flytting av felt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     c     felt          begsr
      *
     c                   eval      rnfirm = zrnfirm
     c                   eval      rnkund = zrnkund
     c                   eval      rnbdat = zrnbdat
     c                   eval      rnbiln = zrnbiln
     c                   eval      rnfdat = zrnfdat
     c                   eval      rnbelØ = zrnbelØ
     c                   eval      rnrest = zrnrest
     c                   eval      rntext = zrntext
     c                   eval      rnraar = zrnraar
     c                   eval      rnrper = zrnrper
     c                   eval      rnbilk = zrnbilk
     c                   eval      rnvalk = zrnvalk
     c                   eval      rnvalb = zrnvalb
     c                   eval      rnvalr = zrnvalr
     c                   eval      rnjour = zrnjour
     c                   eval      rnsamf = zrnsamf
     c                   eval      rnstat = zrnstat
     c                   eval      rnrefn = zrnrefn
     c                   eval      rnvirk = zrnvirk
     c                   eval      rnavde = zrnavde
     c                   eval      rnkont = zrnkont
     c                   eval      rnspes = zrnspes
     c                   eval      rnslgr = zrnslgr
     c                   eval      rnrekl = zrnrekl
     c                   eval      rnrenk = zrnrenk
     c                   eval      rnrdat = zrnrdat
     c                   eval      rnantp = zrnantp
     c                   eval      rnpdat = zrnpdat
     c                   eval      rnauto = zrnauto
     c                   eval      rnadat = zrnadat
     c                   eval      rnfack = zrnfack
     c                   eval      rnfada = zrnfada
     c                   eval      rntist = zrntist
     c                   eval      rwkalf = zrwkalf
     c                   eval      rwrent = zrwrent
     c                   eval      rwrgrl = zrwrgrl
     c                   eval      rwdagr = zrwdagr
     c                   eval      rwrfda = zrwrfda
     c                   eval      rwrtda = zrwrtda
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c     rkwbl3_key    klist
     c                   kfld                    w_firm
      *
     c                   move      l_firm        w_firm
      *
     c                   endsr
