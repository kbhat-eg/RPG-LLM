      /TITLE  ASSTAT Utvalg til parameterfil, fra/til varenummer
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SR131R
      * Beskrivelse . . : Utvalg til parameterfil, fra/til varenummer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fSR131d    cf   e             workstn
      *
     fslpml1    if   e           k disk    rename(slpmpfr:slpml1r)
     fslpmlu    uf a e           k disk    rename(slpmpfr:slpmlur)
      *
      *---------------------------------------------------------------------
      *
     d wptype          s                   like(srtype)
     d wptext          s             30
     d wpfirm          s                   like(srfirm)
     d wpvare          s             15
     d wptek1          s             35
      *
     d wwfirm          s                   like(srfirm)
     d wwtype          s                   like(srtype)
     d wwkode          s                   like(srkode)
      *
     dwwrest           ds           330
     d wwtext                  1     30
     d wwfvar                        15    dim(10)
     d wwtvar                        15    dim(10)
      *
     d wwvalg          ds
     d  wwfyll                 1     15
      *
     d                uds
     d dsuser                911    920
     d dsfirm                944    946  0
     d l_fnav                951    980
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     b2tagb        tag
      *
      * slå opp
      * i filen
      *
     c     key01         chain     slpml1                             60
      *
      * post finnes
      * fra før
      *
     c                   if        *in60 = *off
     c                   movel     srrest        wwrest
     c                   movel     wwfvar(1)     b2fva1
     c                   movel     wwfvar(2)     b2fva2
     c                   movel     wwfvar(3)     b2fva3
     c                   movel     wwfvar(4)     b2fva4
     c                   movel     wwfvar(5)     b2fva5
     c                   movel     wwfvar(6)     b2fva6
     c                   movel     wwfvar(7)     b2fva7
     c                   movel     wwfvar(8)     b2fva8
     c                   movel     wwfvar(9)     b2fva9
     c                   movel     wwfvar(10)    b2fva10
      *
     c                   movel     wwtvar(1)     b2tva1
     c                   movel     wwtvar(2)     b2tva2
     c                   movel     wwtvar(3)     b2tva3
     c                   movel     wwtvar(4)     b2tva4
     c                   movel     wwtvar(5)     b2tva5
     c                   movel     wwtvar(6)     b2tva6
     c                   movel     wwtvar(7)     b2tva7
     c                   movel     wwtvar(8)     b2tva8
     c                   movel     wwtvar(9)     b2tva9
     c                   movel     wwtvar(10)    b2tva10
      *
     c                   endif
      *
      * post finnes
      * ikke
      *
     c                   if        *in60 = *on
     c                   eval      b2fva1 = *zero
     c                   eval      b2fva2 = *zero
     c                   eval      b2fva3 = *zero
     c                   eval      b2fva4 = *zero
     c                   eval      b2fva5 = *zero
     c                   eval      b2fva6 = *zero
     c                   eval      b2fva7 = *zero
     c                   eval      b2fva8 = *zero
     c                   eval      b2fva9 = *zero
     c                   eval      b2fva10 = *zero
     c                   eval      b2tva1 = *zero
     c                   eval      b2tva2 = *zero
     c                   eval      b2tva3 = *zero
     c                   eval      b2tva4 = *zero
     c                   eval      b2tva5 = *zero
     c                   eval      b2tva6 = *zero
     c                   eval      b2tva7 = *zero
     c                   eval      b2tva8 = *zero
     c                   eval      b2tva9 = *zero
     c                   eval      b2tva10 = *zero
     c                   endif
      *
     c     b2taga        tag
      *
     c                   exfmt     b2bld
      *
      * Avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * Spørring
      *
     c     *inkd         ifeq      *on
     c                   exsr      xspstr
     c                   if        *in80 = '1'
     c                   goto      b2taga
     c                   endif
     c                   endif
      *
      * Sjekk om fra er større enn til
      *
     c                   if        b2fva1 > b2tva1
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva2 > b2tva2
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva3 > b2tva3
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva4 > b2tva4
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva5 > b2tva5
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva6 > b2tva6
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva7 > b2tva7
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva8 > b2tva8
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva9 > b2tva9
     c                   goto      b2taga
     c                   endif
     c                   if        b2fva10 > b2tva10
     c                   goto      b2taga
     c                   endif
      *
     c     key01         chain     slpmlu                             60
      *
     c                   movel     b2fva1        wwfvar(1)
     c                   movel     b2fva2        wwfvar(2)
     c                   movel     b2fva3        wwfvar(3)
     c                   movel     b2fva4        wwfvar(4)
     c                   movel     b2fva5        wwfvar(5)
     c                   movel     b2fva6        wwfvar(6)
     c                   movel     b2fva7        wwfvar(7)
     c                   movel     b2fva8        wwfvar(8)
     c                   movel     b2fva9        wwfvar(9)
     c                   movel     b2fva10       wwfvar(10)
     c                   movel     b2tva1        wwtvar(1)
     c                   movel     b2tva2        wwtvar(2)
     c                   movel     b2tva3        wwtvar(3)
     c                   movel     b2tva4        wwtvar(4)
     c                   movel     b2tva5        wwtvar(5)
     c                   movel     b2tva6        wwtvar(6)
     c                   movel     b2tva7        wwtvar(7)
     c                   movel     b2tva8        wwtvar(8)
     c                   movel     b2tva9        wwtvar(9)
     c                   movel     b2tva10       wwtvar(10)
     c                   eval      wwtext = 'Varenummer fra/til'
     c                   eval      srrest = wwrest
     c                   eval      srsyst = 'L'
      *
      * posten finnes
      * fra før
      *
     c                   if        *in60 = *off
     c                   if        b2fva1 = 0 and b2tva1 = 0
     c                   delete    slpmlur
     c                   else
     c                   update    slpmlur
     c                   endif
     c                   endif
      *
      * posten finnes
      * ikke fra før
      *
     c                   if        *in60 = *on
     c                   if        b2tva1 <> 0
     c                   eval      srfirm = wwfirm
     c                   eval      srtype = wwtype
     c                   eval      srkode = wwkode
     c                   eval      srvalg = wwvalg
     c                   write     slpmlur
     c                   endif
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for søking                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xspstr        begsr
      *
     c                   eval      *in80 = '0'
     c
      *
      * Call program for varespørring
      *
     c     wactfe        ifeq      'B2FVA1'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva1
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA2'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva2
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA3'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva3
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA4'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva4
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA5'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva5
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA6'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva6
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA7'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva7
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA8'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva8
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA9'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva9
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FVA10'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2fva10
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA1'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva1
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA2'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva2
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA3'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva3
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA4'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva4
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA5'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva5
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA6'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva6
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA7'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva7
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA8'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva8
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA9'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva9
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TVA10'
     c                   call      'VV500R'
     c                   parm                    wpfirm
     c                   parm                    wpvare
     c                   parm                    wptek1
      *
     c                   eval      *in80 = '1'
     c                   movel     wpvare        b2tva10
     c                   goto      xspend
     c                   endif
      *
     c     xspend        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
      * Key for file
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwtype
     c                   kfld                    wwkode
     c                   kfld                    wwvalg
      *
      * Tar inn parameter fra forrige program
      *
     c     *entry        plist
     c                   parm                    wptype
     c                   parm                    wptext
      *
      * Legger inn verdier i feltene
      *
     c                   eval      wwfirm = dsfirm
     c                   eval      wwtype = wptype
     c                   eval      wwkode = 31
     c                   eval      wwvalg = *blank
      *
     c                   eval      srfirm = wwfirm
      *
     c                   eval      b2type = wptype
     c                   eval      b2text = wptext
      *
     c                   endsr
