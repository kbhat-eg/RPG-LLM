     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASLAGR
      * Program . . . . : MP713R
      * Beskrivelse . . : Danner bestillingsforslag - parameter
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       010411 bsa  Nytt program
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *       10 = Rollup
      *       11 = Rolldown
      *       12 = Sfldsp
      *       13 = Sfldspctl
      *       14 = Sflclr
      *       15 = Sflend
      *       21 = Home-key
      *       22 = Plassering av cursor
      *       30 = Protect av felter ved vise
      *    31-79 = Varsle m/feilmeldinger/skjermindikatorer
      *    80-99 = Arbeidsindikatorer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fmppalr    if   e           k disk    rename(mppapfr:mppalrr)
      *
      *
      * Definering av parametre
      *
     d p_ldor          s                   like(mpldor)
     d p_lnum          s                   like(mplnum)
     d p_ndat          s               d   datfmt(*iso)
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      *
     d mppalr_ldor     s                   like(mpldor)
     d mppalr_lnum     s                   like(mplnum)
      *
      * Definering av variable
      *
     d w_firm          s                   like(mpfirm)
     d w_dato          s               d   datfmt(*iso)
     d w_dagens        s               d   datfmt(*iso)
     d w_dager         s              4  0
     d w_xnum          s              6
     d w_xlev          s              6
     d w_til           s             50
     d w_fra           s             50
     d w_numm          s              6  0
     d w_subj          s            250
     d w_retk          s              1
     d w_levr          s                   like(mpldor)
     d w_navn          s             30
      *
      *
      *  Definering av datastrukturer
      *
      * Parameter-inn
     d                 ds
     d d_prec                       256
     d  d_flev                        6  0 overlay(d_prec)
     d  d_tlev                        6  0 overlay(d_prec:7)
     d  d_fogr                        2  0 overlay(d_prec:13)
     d  d_fhgr                        2  0 overlay(d_prec:15)
     d  d_fugr                        3  0 overlay(d_prec:17)
     d  d_fvar                       15    overlay(d_prec:20)
     d  d_togr                        2  0 overlay(d_prec:35)
     d  d_thgr                        2  0 overlay(d_prec:37)
     d  d_tugr                        3  0 overlay(d_prec:39)
     d  d_tvar                       15    overlay(d_prec:42)
     d  d_sakb                        4    overlay(d_prec:57)
     d  d_lage                        2  0 overlay(d_prec:61)
     d  d_vval                        1  0 overlay(d_prec:63)
     d  d_sats                        3  0 overlay(d_prec:64)
     d  d_aval                        1  0 overlay(d_prec:67)
     d  d_tdat                        6  0 overlay(d_prec:68)
     d  d_selg                        4  0 overlay(d_prec:74)
     d  d_gvek                       11  3 overlay(d_prec:78)
     d  d_gbel                       11  2 overlay(d_prec:89)
     d  d_numm                        6  0 overlay(d_prec:100)
     d  d_lnum                        3  0 overlay(d_prec:106)
     d  d_kora                        1    overlay(d_prec:109)
     d  d_ndat                       10    overlay(d_prec:245)
     d  d_bgen                        1    overlay(d_prec:256)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c                   eval      mppalr_ldor = p_ldor
     c                   eval      mppalr_lnum = p_lnum
     c     mppalr_key    chain     mppalr
     c                   if        %found
      *
     c                   if        mpthor > 0
     c                   eval      w_dager = mpthor * 7
     c                   time                    w_dagens
     c                   eval      w_dato  = w_Dagens + %days(w_dager)
     c     *dmy          move      w_dato        d_tdat
     c                   else
     c                   eval      d_tdat = 0
     c                   endif
      *
     c                   eval      d_flev  = mpldor
     c                   eval      d_tlev  = mpldor
     c                   eval      d_fogr  = mpogrf
     c                   eval      d_fhgr  = mphgrf
     c                   eval      d_fugr  = mpugrf
     c                   eval      d_fvar  = mpvarf
     c                   eval      d_togr  = mpogrt
     c                   eval      d_thgr  = mphgrt
     c                   eval      d_tugr  = mpugrt
     c                   eval      d_tvar  = mpvart
     c                   eval      d_sakb  = mppran
     c                   eval      d_lage  = mplage
     c                   eval      d_vval  = mpvval
     c                   eval      d_sats  = mpsats
     c                   eval      d_aval  = mpaval
     c                   eval      d_selg  = mpselg
     c                   eval      d_gvek  = mpgvek
     c                   eval      d_gbel  = mpgbel
     c                   eval      d_lnum  = mplnum
     c                   eval      d_kora  = mpkora
     c                   eval      d_numm  = 0
     c                   else
     c                   goto      avslutt
     c                   endif
      *
      * Sende mail
      *
     c                   eval      w_til  = *blank
     c                   eval      w_fra  = *blank
     c                   eval      w_subj = *blank
     c                   eval      d_bgen = '1'
     c                   eval      d_ndat = %char(p_ndat)
     c                   call      'MP711C'
     c                   parm                    d_prec
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_ldor
     c                   parm                    p_lnum
     c                   parm                    p_ndat
      *
      * Key for les p√• parameter pr. lev.
      *
     c     mppalr_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mppalr_ldor
     c                   kfld                    mppalr_lnum
      *
      * Henter verdier fra LDA, og initierer skjermbildet
      *
     c                   eval      w_firm = l_firm
      *
      *
     c                   endsr
