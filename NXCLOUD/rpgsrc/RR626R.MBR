     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RR626R                                              *
      * Beskrivelse . . : Utskrift av konti som ikke er med på rapport        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
5.50  * V5.50     230508  Skrev konti som var definert                   HFL  *
6.30  * V6.30     040719  utvidet saldofelter                            bsa  *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frhsal1    if   e           k disk    rename(rhsapfr:rhsal1r)
     frrf8l1    if   e           k disk    rename(rrf8pfr:rrf8l1r)
     frr626p    o    e             printer oflind(*in30)
      *
6.30 d isa             s             15  2 dim(14)                               SALDOMATRISE
      *
     d                 ds
     d nybrd                         11  0                                      Bruddb
     d  nykto                         5  0 overlay(nybrd)                       Konto
     d  nysps                         2  0 overlay(nybrd:6)                     Spesif
     d  nyavd                         4  0 overlay(nybrd:8)                     Avdeli
      *
     d                 ds
     d gmbrd                         11  0                                      Bruddb
     d  gmkto                         5  0 overlay(gmbrd)                       Konto
     d  gmsps                         2  0 overlay(gmbrd:6)                     Spesif
     d  gmavd                         4  0 overlay(gmbrd:8)                     Avdeli
      *
     d                uds
     d rhprap                300    301  0
     d rh0txt                        40
     d rhprÅr                         4  0
     d rhpper                         2  0
     d l_user                911    920
      *
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d p_stat          s              1
     d p_firm          s                   like(rifirm)
     d p_kont          s                   like(rikont)
     d p_spes          s                   like(rispes)
     d p_avde          s                   like(riavde)
     d p_text          s             30
      *
     d m               s              2  0
     d n               s              2  0
     d w_dper          s             11  2
     d w_firm          s                   like(l_firm)
     d w_hitt          s             11  2
     d w_text          s             30
     d w_8fav          s                   like(rr8fav)
     d w_8fkt          s                   like(rr8fkt)
     d w_8fsp          s                   like(rr8fsp)
     d w_8rap          s                   like(rr8rap)
     d w_8tkt          s                   like(rr8tkt)
      *
      * Redefinering til array's
      *
     irhsal1r
     i              risa01                      isa(1)
     i              risa02                      isa(2)
     i              risa03                      isa(3)
     i              risa04                      isa(4)
     i              risa05                      isa(5)
     i              risa06                      isa(6)
     i              risa07                      isa(7)
     i              risa08                      isa(8)
     i              risa09                      isa(9)
     i              risa10                      isa(10)
     i              risa11                      isa(11)
     i              risa12                      isa(12)
     i              risa13                      isa(13)
     i              risa00                      isa(14)
      *
     c     les           tag
      *
     c                   read      rhsal1r                                10
      *
     c  n10              if        rifirm > l_firm                                       .....
     c                   eval      *in10 = *on                                               .
     c                   endif                                                           .....
      *
     c   10              do                                                              .....
     c                   eval      *inlr = *on                                               .
     c                   goto      slutt                                                     .
     c                   enddo                                                           .....
      *
      * Sjekk om brudd i kontrollbegrepet
      *
     c     test          tag
      *
      * Sjekk regnskapsår
      *
     c                   if        riraar <> rhprÅr                                      .....
     c                   goto      les                                                       .
     c                   endif                                                           .....
      *
      * Sjekk kontonr. fra/til
      *
     c                   if        rikont < w_8fkt                                       .....
      *                                                                 .
      * Hent tekstrecord fra kontoplan-register                         .
      *                                                                 .
     c                   eval      p_firm = l_firm                                           .
     c                   eval      p_kont = rikont                                           .
     c                   eval      p_spes = rispes                                           .
     c                   eval      p_avde = riavde                                           .
      *                                                                 .
     c                   call      'RS740R'                                      kontoplan-  .
     c                   parm                    p_stat
     c                   parm                    p_kont
     c                   parm                    p_spes
     c                   parm                    p_avde
     c                   parm                    p_text
      *                                                                 .
     c                   eval      w_text = p_text                                           .
      *                                                                 .
     c                   if        *in30 = *on                                         ..... .
     c                   exsr      skriv                                                   . .
     c                   eval      *in30 = *off                                            . .
     c                   endif                                                         ..... .
      *                                                               . .
     c                   exsr      xlsum                                                   . .
      *                                                                 .
     c                   write     skriv1                                                    .
      *                                                                 .
     c                   goto      les                                                       .
      *                                                                 .
     c                   endif                                                           .....
      *
TEST c                   if        rikont > 2999                                         .....
TEST c                   add       1             tell              6 0                   .....
TEST c                   endif                                                           .....
      *                                                                 .
      * Sjekk kontonr. fra/til
      *
     c                   if        rikont > w_8tkt                                       .....
      *                                                                 .
     c     les8t         tag                                                                 .
      *                                                                 .
     c                   if        *in11 = *off
     c                   read      rrf8l1                                 11                 .
     c                   endif
      *
     c  n11              if        rr8fir > l_firm                                       .....
     c                   eval      *in11 = *on                                               .
     c                   endif                                                           .....
      *                                                                 .
     c   11              do                                                            ..... .
     c                   goto      les                                                     . .
     c                   enddo                                                         ..... .
      *                                                                 .
S5.50c*                  if        rr8klf <> 'K'                                       ..... .
T5.50c                   if        rr8fkt =  *zero                                     ..... .
     c                   goto      les8t                                                   . .
     c                   endif                                                         ..... .
      *                                                                 .
     c                   if        rr8rap <> rhprap                                    ..... .
     c                   eval      *inlr = *on                                             . .
     c                   goto      slutt                                                   . .
     c                   endif                                                         ..... .
      *                                                                 .
     c                   move      rr8fkt        w_8fkt                                      .
     c                   move      rr8tkt        w_8tkt                                      .
      *                                                                 .
     c                   goto      test                                                      .
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   goto      les
      *
      /space 3
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
      /eject
      *
      ****************************************************************
      *   Subrutine for å skrive heading                             *
      ****************************************************************
      *
     c     skriv         begsr
      *
     c                   write     head1
     c                   write     head3
      *
     c                   endsr
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Summer opp saldo                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xlsum         begsr
      *
     c                   eval      w_dper = *zeros                                           .
     c                   eval      w_hitt = *zeros                                           .
      *
     c                   if        rhpper = *zero                                        .....
     c                   eval      w_hitt = w_hitt + isa(14)                                 .
      *                                                                 .
     c                   else                                                                .
      *                                                                 .
     c                   eval      m = rhpper                                                .
      *                                                                 .
     c                   eval      w_dper = w_dper + isa(m)                                  .
      *                                                                 .
     c                   eval      w_hitt = w_hitt + isa(14)                                 .
      *                                                                 .
     c     1             do        rhpper        n                                     ..... .
     c                   eval      w_hitt = w_hitt + isa(n)                                . .
     c                   enddo                                                         ..... .
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   endsr
      *
      /eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *
      * Sett startverdier
      *
     c                   eval      n = *zeros
     c                   eval      m = *zeros
     c                   move      l_firm        w_firm
     c                   move      rhprap        w_8rap
      *
     c     rhsal1_key    setll     rhsal1r                                                   .
      *
     c     rrf8l1_key    setll     rrf8l1
      *
     c     les8s         tag
      *
     c                   if        *in11 = *off
     c                   read      rrf8l1                                 11
     c                   endif
      *
     c   11              do                                                              .....
     c                   goto      test                                                      .
     c                   enddo                                                           .....
      *                                                                 .
S5.50c*                  if        rr8klf <> 'K'                                         .....
T5.50c                   if        rr8fkt =  *zero                                       .....
     c                   goto      les8s                                                     .
     c                   endif                                                           .....
      *
     c                   move      rr8fkt        w_8fkt
     c                   move      rr8tkt        w_8tkt
      *                                                                 .
      *
      * Skriv heading på første side
      *
     c                   write     head1
     c                   write     head3
      *
      * Key for konto/linje register
      *
     c     rrf8l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_8rap
     c                   kfld                    w_8fkt
     c                   kfld                    w_8fsp
     c                   kfld                    w_8fav
      *
      * Key for SALDOREGISTER
      *
     c     rhsal1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rikont
     c                   kfld                    rispes
     c                   kfld                    riavde
     c                   kfld                    riraar
     c                   kfld                    ritype
      *
     c                   endsr
