      /TITLE  ASSTAT Utvalg til parameterfil, fra/til kundenummer
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SP132R
      * Beskrivelse . . : Utvalg til parameterfil, fra/til kundenummer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
5.20  * R5.20 211003 AMD  Ved spørring på kunder var det referert til
5.20  *                   et feil program.  Endringer er ikke merket på
5.20  *                   linjenivå i programmet. Parameterlister måtte
5.20  *                   også endres.
7.xx  * 7.00  031016 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fsp132d    cf   e             workstn
      *
     fskpml1    if   e           k disk    rename(skpmpfr:skpml1r)
     fskpmlu    uf a e           k disk    rename(skpmpfr:skpmlur)
      *
      *---------------------------------------------------------------------
      *
     d wptype          s                   like(sptype)
     d wptext          s             30
     d wpfirm          s                   like(spfirm)
     d wpkund          s              6  0
     d wpnavn          s             30
     d wptek1          s                   like(wptext)
      *
     d wwfirm          s                   like(spfirm)
     d wwtype          s                   like(sptype)
     d wwkode          s                   like(spkode)
      *
     dwwrest           ds           330
     d wwtext                  1     30
     d wwfkun                         6  0 dim(10)
     d wwtkun                         6  0 dim(10)
      *
     d wwvalg          ds
     d  wwfyll                 1     15
      *
     dww_sjekk_array   ds           120
     d ww_sjekk_fkun                  6  0 dim(10)
     d ww_sjekk_tkun                  6  0 dim(10)
      *
     d                uds
     d dsuser                911    920
     d dsfirm                944    946  0
     d l_fnav                951    980
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     b2tagb        tag
      *
      * slå opp
      * i filen
      *
     c     key01         chain     skpml1                             60
      *
      * post finnes
      * fra før
      *
     c                   if        *in60 = *off                                          .....
     c                   movel     sprest        wwrest                                      .
     c                   movel     wwfkun(1)     b2fku1                                      .
     c                   movel     wwfkun(2)     b2fku2                                      .
     c                   movel     wwfkun(3)     b2fku3                                      .
     c                   movel     wwfkun(4)     b2fku4                                      .
     c                   movel     wwfkun(5)     b2fku5                                      .
     c                   movel     wwfkun(6)     b2fku6                                      .
     c                   movel     wwfkun(7)     b2fku7                                      .
     c                   movel     wwfkun(8)     b2fku8                                      .
     c                   movel     wwfkun(9)     b2fku9                                      .
     c                   movel     wwfkun(10)    b2fku10                                     .
      *
     c                   movel     wwtkun(1)     b2tku1                                      .
     c                   movel     wwtkun(2)     b2tku2                                      .
     c                   movel     wwtkun(3)     b2tku3                                      .
     c                   movel     wwtkun(4)     b2tku4                                      .
     c                   movel     wwtkun(5)     b2tku5                                      .
     c                   movel     wwtkun(6)     b2tku6                                      .
     c                   movel     wwtkun(7)     b2tku7                                      .
     c                   movel     wwtkun(8)     b2tku8                                      .
     c                   movel     wwtkun(9)     b2tku9                                      .
     c                   movel     wwtkun(10)    b2tku10                                     .
      *                                                                                      .
     c                   endif                                                           .....
      *
      * post finnes
      * ikke
      *
     c                   if        *in60 = *on                                           .....
     c                   eval      b2fku1 = *zeros                                           .
     c                   eval      b2fku2 = *zeros                                           .
     c                   eval      b2fku3 = *zeros                                           .
     c                   eval      b2fku4 = *zeros                                           .
     c                   eval      b2fku5 = *zeros                                           .
     c                   eval      b2fku6 = *zeros                                           .
     c                   eval      b2fku7 = *zeros                                           .
     c                   eval      b2fku8 = *zeros                                           .
     c                   eval      b2fku9 = *zeros                                           .
     c                   eval      b2fku10 = *zeros                                          .
     c                   eval      b2tku1 = *zeros                                           .
     c                   eval      b2tku2 = *zeros                                           .
     c                   eval      b2tku3 = *zeros                                           .
     c                   eval      b2tku4 = *zeros                                           .
     c                   eval      b2tku5 = *zeros                                           .
     c                   eval      b2tku6 = *zeros                                           .
     c                   eval      b2tku7 = *zeros                                           .
     c                   eval      b2tku8 = *zeros                                           .
     c                   eval      b2tku9 = *zeros                                           .
     c                   eval      b2tku10 = *zeros                                          .
     c                   endif                                                           .....
      *
     c     b2taga        tag
      *
     c                   exfmt     b2bld
      *
      * avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * Spørring
      *
     c     *inkd         ifeq      *on
     c                   exsr      xspstr
     c                   if        *in80 = *on
     c                   goto      b2taga
     c                   endif
     c                   endif
      *
      * Sjekk om fra er større enn til
      *
     c                   if        b2fku1 > b2tku1
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku2 > b2tku2
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku3 > b2tku3
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku4 > b2tku4
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku5 > b2tku5
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku6 > b2tku6
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku7 > b2tku7
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku8 > b2tku8
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku9 > b2tku9
     c                   goto      b2taga
     c                   endif
     c                   if        b2fku10 > b2tku10
     c                   goto      b2taga
     c                   endif
      *
     c     key01         chain     skpmlu                             60
      *
     c                   movel     b2fku1        wwfkun(1)                                   .
     c                   movel     b2fku2        wwfkun(2)                                   .
     c                   movel     b2fku3        wwfkun(3)                                   .
     c                   movel     b2fku4        wwfkun(4)                                   .
     c                   movel     b2fku5        wwfkun(5)                                   .
     c                   movel     b2fku6        wwfkun(6)                                   .
     c                   movel     b2fku7        wwfkun(7)                                   .
     c                   movel     b2fku8        wwfkun(8)                                   .
     c                   movel     b2fku9        wwfkun(9)                                   .
     c                   movel     b2fku10       wwfkun(10)                                  .
     c                   movel     b2tku1        wwtkun(1)                                   .
     c                   movel     b2tku2        wwtkun(2)                                   .
     c                   movel     b2tku3        wwtkun(3)                                   .
     c                   movel     b2tku4        wwtkun(4)                                   .
     c                   movel     b2tku5        wwtkun(5)                                   .
     c                   movel     b2tku6        wwtkun(6)                                   .
     c                   movel     b2tku7        wwtkun(7)                                   .
     c                   movel     b2tku8        wwtkun(8)                                   .
     c                   movel     b2tku9        wwtkun(9)                                   .
     c                   movel     b2tku10       wwtkun(10)                                  .
     c                   eval      wwtext = 'Kundenummer fra/til'
     c                   eval      sprest = wwrest
     c                   eval      spsyst = 'K'
      *
     c                   movea     wwfkun        ww_sjekk_fkun
     c                   movea     wwtkun        ww_sjekk_tkun
      *
      * posten finnes
      * fra før
      *
     c                   if        *in60 = *off                                          .....
     c                   if        b2fku1 = 0 and b2tku1 = 0
     c                   delete    skpmlur
     c                   else
     c                   update    skpmlur                                                   .
     c                   endif
     c                   endif
      *
      * posten finnes
      * ikke fra før
      *
     c                   if        *in60 = *on                                           .....
     c                             and ww_sjekk_array <> *blanks
     c                   if        b2tku1 <> 0
     c                   eval      sptype = wwtype
     c                   eval      spkode = wwkode
     c                   eval      spfirm = wwfirm
     c                   write     skpmlur                                                   .
     c                   endif
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for søking                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xspstr        begsr
      *
     c                   eval      *in80 = *off
     c                   eval      wpkund= 0
     c
      *
      * call program for kundespørring
      *
     c     wactfe        ifeq      'B2FKU1'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku1
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU2'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku2
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU3'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku3
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU4'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku4
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU5'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku5
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU6'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku6
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU7'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku7
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU8'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku8
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU9'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku9
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2FKU10'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2fku10
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU1'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku1
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU2'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku2
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU3'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku3
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU4'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku4
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU5'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku5
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU6'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku6
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU7'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku7
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU8'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku8
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU9'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku9
     c                   goto      xspend
     c                   endif
      *
     c     wactfe        ifeq      'B2TKU10'
     c                   call      'RK500R'
     c                   parm                    WPFIRM
     c                   parm                    WPKUND
     c                   parm                    WPNAVN
      *
     c                   eval      *in80 = *on
     c                   movel     wpkund        b2tku10
     c                   goto      xspend
     c                   endif
      *
     c     xspend        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
      * Key for file nummerisk
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwtype
     c                   kfld                    wwkode
     c                   kfld                    wwvalg
      *
      * Tar inn parameter fra forrige program
      *
     c     *entry        plist
     c                   parm                    wptype
     c                   parm                    wptext
      *
     c                   eval      wwfirm = dsfirm
     c                   eval      wwtype = wptype
     c                   eval      wwkode = 32
     c                   eval      wwvalg = *blank
      *
     c                   eval      spfirm = dsfirm
      *
     c                   eval      b2type = wptype
     c                   eval      b2text = wptext
      *
     c                   endsr
