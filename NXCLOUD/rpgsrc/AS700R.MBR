      /title  ASPGPL Fellesprogram for splitting av søkestring
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASPGPL
      * Program . . . . : AS700R
      * Beskrivelse . . : Fellesprogram for splitting av søkestring
      *
      *                   Splitter søkestring i opptil 5 søketekster
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       070499 HKO  Nytt program
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Definering av parametre
      *
     d p_stek          s             35
     d p_ste1          s             35
     d p_ste2          s             35
     d p_ste3          s             35
     d p_ste4          s             35
     d p_ste5          s             35
      *
      * Definering av variable
      *
     d w_l             s              2  0
     d w_l1            s              2  0
     d w_l2            s              2  0
     d w_l3            s              2  0
     d w_l4            s              2  0
     d w_l5            s              2  0
      *
     d w_stek          s             35
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogam
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Utleder søketekster ut av søkestring
      *
     c                   eval      w_stek = %triml(p_stek)
      *
     c                   eval      w_l1   = %scan(' ':w_stek) - 1
     c                   eval      p_ste1 = %subst(w_stek:1:w_l1)
      *
     c                   eval      w_stek = %subst(w_stek:w_l1+1:35-w_l1-1)
     c                   eval      w_stek = %triml(w_stek)
      *
     c                   eval      w_l2   = %scan(' ':w_stek) - 1
     c                   if        w_l2 > 0
     c                   eval      p_ste2 = %subst(w_stek:1:w_l2)
     c                   else
     c                   eval      p_ste2 = *blank
     c                   endif
      *
     c                   eval      w_stek = %subst(w_stek:w_l2+1:35-w_l2-1)
     c                   eval      w_stek = %triml(w_stek)
      *
     c                   eval      w_l3   = %scan(' ':w_stek) - 1
     c                   if        w_l3 > 0
     c                   eval      p_ste3 = %subst(w_stek:1:w_l3)
     c                   else
     c                   eval      p_ste3 = *blank
     c                   endif
      *
     c                   eval      w_stek = %subst(w_stek:w_l3+1:35-w_l3-1)
     c                   eval      w_stek = %triml(w_stek)
      *
     c                   eval      w_l4   = %scan(' ':w_stek) - 1
     c                   if        w_l4 > 0
     c                   eval      p_ste4 = %subst(w_stek:1:w_l4)
     c                   else
     c                   eval      p_ste4 = *blank
     c                   endif
      *
     c                   eval      w_stek = %subst(w_stek:w_l4+1:35-w_l4-1)
     c                   eval      w_stek = %triml(w_stek)
      *
     c                   eval      w_l5   = %scan(' ':w_stek) - 1
     c                   if        w_l5 > 0
     c                   eval      p_ste5 = %subst(w_stek:1:w_l5)
     c                   else
     c                   eval      p_ste5 = *blank
     c                   endif
      *
      * Den lengste søketeksten legges som søketekst-1
      *
     c                   if        w_l4 < w_l5
     c                   eval      w_l    = w_l4
     c                   eval      w_l4   = w_l5
     c                   eval      w_l5   = w_l
     c                   eval      w_stek = p_ste4
     c                   eval      p_ste4 = p_ste5
     c                   eval      p_ste5 = w_stek
     c                   endif
      *
     c                   if        w_l3 < w_l4
     c                   eval      w_l    = w_l3
     c                   eval      w_l3   = w_l4
     c                   eval      w_l4   = w_l
     c                   eval      w_stek = p_ste3
     c                   eval      p_ste3 = p_ste4
     c                   eval      p_ste4 = w_stek
     c                   endif
      *
     c                   if        w_l2 < w_l3
     c                   eval      w_l    = w_l2
     c                   eval      w_l2   = w_l3
     c                   eval      w_l3   = w_l
     c                   eval      w_stek = p_ste2
     c                   eval      p_ste2 = p_ste3
     c                   eval      p_ste3 = w_stek
     c                   endif
      *
     c                   if        w_l1 < w_l2
     c                   eval      w_l    = w_l1
     c                   eval      w_l1   = w_l2
     c                   eval      w_l2   = w_l
     c                   eval      w_stek = p_ste1
     c                   eval      p_ste1 = p_ste2
     c                   eval      p_ste2 = w_stek
     c                   endif
      *
     c                   eval      p_ste1 = '%' + %trim(p_ste1) +
     c                                      '%%%%%%%%%%%%%%%%%%%%%%%%%%%%' +
     c                                      '%%%%%%'
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_stek
     c                   parm                    p_ste1
     c                   parm                    p_ste2
     c                   parm                    p_ste3
     c                   parm                    p_ste4
     c                   parm                    p_ste5
      *
      * Initierer variable
      *
     c                   eval      p_ste1 = *blank
     c                   eval      p_ste2 = *blank
     c                   eval      p_ste3 = *blank
     c                   eval      p_ste4 = *blank
     c                   eval      p_ste5 = *blank
      *
     c                   endsr
