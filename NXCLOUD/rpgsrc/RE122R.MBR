     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
      *                                                                       *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RE122R                                              *
      * Beskrivelse . . : Tilrettelegger trans fra Rubicon                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      * V5.00     141103  Timstampfeil rettet, firma kundefil rettet.    HFL  *
      * V5.40     270906  Feil i felt 15 - beløp er rettet.              HFL  *
6.20  *  6.20     011210  Prosjekt er alfa                               NHO  *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     fre0ipf    ip  ae           k disk
     fafirl1    if   e           k disk    rename(afirpfr:afirl1r)
     fraa3l1    if   e           k disk    rename(raa3pfr:raa3l1r)
     fraa4l1    if   e           k disk    rename(raa4pfr:raa4l1r)
     fre0tpf    o    e           k disk
     fre0kpf    o    e           k disk
      *
     d wrec            s              1    dim(768)
     d wflt            s              1    dim(768)
     d per             s              2  0 dim(13)
     d txt             s             20    dim(5) ctdata perrcd(1)
      *
      * LOCAL DATA
      *
     d                uds
     d pfirm                 300    302  0
     d pnavn                         30
     d puser                         10
     d pdato                          6  0
     d praar                          4  0
     d pperf                          2  0
     d ppert                          2  0
     d psyst                 471    472  0
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_navn                951    980
      *
     d pdatx           s              8  0
     d rktlfn          s             11
     d rktlfx          s             11
     d wbelØp          s             14
     d wfelt           s                   like(rpcin1)
T5.00d wfelt6          s              6  0
     d w_raar          s                   like(wkp)
     d wkfakr          s              4
     d wkore           s              2  0
     d wkp             s              2  0
     d wkper           s              8  0
     d wkrone          s             11  0
     d wkron9          s              8  0
     d wlinje          s              8  0
6.NU d wnota           s              8  0
     d wnxbun          s                   like(rtbunt)
     d wtbdat          s              6  0
     d wtpre           s             10  2
     d xxxx11          s              2
     d xxxx12          s              3
     d xxxx13          s             11
     d xxxx14          s             14
     d xxxx16          s              6
     d xxxx18          s             10
     d xxxx19          s             11
     d xxxx20          s             25
     d xxxx22          s              6
     d xxxx26          s              6
     d xxxx28          s             30
     d xxxx32          s             15
     d xxxx33          s             15
     d xxxx34          s             11
     d xxxx35          s             30
     d xxxx36          s             30
     d xxxx37          s             30
     d xxxx38          s              6
     d xxxx39          s             25
     d xxxx40          s              3
     d xxxx41          s              4
     d xxxx42          s              4
     d xxxx43          s              2
     d xxxx44          s              3
     d xxxx45          s              2
     d xxxx46          s              2
     d x               s              3  0
     d y               s              3  0
     d w_firm          s                   like(l_firm)
     d raa4l1_4aar     s                   like(ra4aar)
      *
      *  Statusopplysninger - avvikende perioder?!?
      *
     iraa3l1r
     i              ra3p01                      per(01)
     i              ra3p02                      per(02)
     i              ra3p03                      per(03)
     i              ra3p04                      per(04)
     i              ra3p05                      per(05)
     i              ra3p06                      per(06)
     i              ra3p07                      per(07)
     i              ra3p08                      per(08)
     i              ra3p09                      per(09)
     i              ra3p10                      per(10)
     i              ra3p11                      per(11)
     i              ra3p12                      per(12)
     i              ra3p13                      per(13)
      *
B001 c                   if        *in15 = *off
 001 c                   eval      rtraar = praar
 001 c                   eval      rtrper = ppert
 001 c                   move      *on           *in15
E001 c                   endif
      *
     c     start         tag
      *
      * Flytt inputfelt
      *
     c                   z-add     257           x
     c                   movea     rpcin1        wrec(1)
     c                   movea     rpcin2        wrec(x)
     c                   z-add     513           x
     c                   movea     rpcin3        wrec(x)
 001  *
      * Felt 01 - (97)
 001  *
     c                   z-add     1             x
     c                   z-add     1             y
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
 001  *
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
B002 c                   if        x > 10
 002 c                   goto      slutt
E002 c                   endif
E001 c                   enddo
 001  *
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rtbilk
 001  *
B001 c                   if        rtbilk <> 97
 001 c                             and rtbilk <> 98
 001 c                   goto      slutt
E001 c                   endif
 001  *
      * Felt 02 - (Dato)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         wtbdat
 001  *
      * Felt 03 - Bilag-nr.(Faktura)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rtbiln
 001  *
      * Felt 04 - (Dato)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
E5.00c                   movel     wfelt         wfelt6
T5.00c     *dmy          move      wfelt6        rtbdat
 001  *
      * Felt 05 - Kode (Faktura/Kreditnota)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         wkfakr
 001  *
      * Felt 06 - Fritekst for overstyring av bilagstekst
 001  *
     c                   z-add     1             y
     c                   add       2             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
 001  *
      * Bilagskode
 001  *
B001 c                   if        wkfakr = '9300'
 001 c                   eval      rtbilk = 01
E001 c                   endif
 001  *
B001 c                   if        wkfakr = '9301'
 001 c                   eval      rtbilk = 03
E001 c                   endif
 001  *
B001 c                   if        wkfakr = '    '
 001 c                   eval      rtbilk = 01
 001 c                   move      txt(4)        rttext
E001 c                   endif
 001  *
B001 c                   if        wkfakr = '    '
 001 c                   eval      rtbilk = 01
 001 c                   move      txt(5)        rttext
E001 c                   endif
 001  *
B001 c                   if        wkfakr = '9375'
 001 c                   eval      rtbilk = 03
 001 c                   move      txt(3)        rttext
E001 c                   endif
 001  *
B001 c                   if        wkfakr = '9075'
 001 c                   eval      rtbilk = 10
E001 c                   endif
 001  *
      * Felt 07 - Avdeling
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rtdavd
 001  *
      * Felt 08 - (5 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rtcavd
 001  *
      * Felt 09 - Konto
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rtdkto
 001  *
      * Felt 10 - Konto
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rtckto
 001  *
      * Felt 11 - (2 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx11
 001  *
B001 c                   if        xxxx11 <> *zeros
 001 c                   eval      rtdmva = '3'
 001 c                   eval      rtcmva = '3'
X001 c                   else
 001 c                   eval      rtdmva = '0'
 001 c                   eval      rtcmva = '0'
E001 c                   endif
 001  *
      * Felt 12 - (3 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx12
 001  *
      * Felt 13 - (11 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx13
 001  *
      * Felt 14 - (14 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx14
 001  *
      * Felt 15 - Beløp
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         wbelØp
     c                   movel     wbelØp        wkrone
     c                   move      wbelØp        wkore
     c                   z-add     wkrone        wkron9
E5.40c                   z-add     wkron9        rtbelØ
E5.40c                   add       wkore         rtbelØ
 001  *
      * Felt 16 - Konto
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx16
 001  *
      * Felt 17 - Forfallsdato
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
E5.00c                   movel     wfelt         wfelt6
T5.00c                   if        wfelt6 = *zeros
T5.00c                   eval      rtfdat = *loval
T5.00c                   else
T5.00c     *dmy          move      wfelt6        rtfdat
T5.00c                   endif
 001  *
      * Felt 18 - (10 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx18
 001  *
      * Felt 19 - (10 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx19
 001  *
      * Felt 20 - Kundeidentifikasjon
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx20
 001  *
      * Felt 21 - Kunde
 001  *
     c                   z-add     1             y
     c                   add       2             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rkkund
 001  *
      * Felt 22 - (6 pos.)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx22
 001  *
      * Felt 23 - Kundenavn
 001  *
     c                   z-add     1             y
     c                   add       2             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rknavn
 001  *
      * Felt 24 - Postboksadresse
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rkgate
 001  *
      * Felt 25 - Gate
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rkadr2
 001  *
      * Felt 26 - Postnummer
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx26
     c                   movel     xxxx26        rkponr
 001  *
      * Felt 27 - Poststed
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rksted
 001  *
      * Felt 28 - (30 pos.)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx28
 001  *
      * Felt 29 - Telefon
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rktlfn
 001  *
      * Felt 30 - Telefax
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rktlfx
 001  *
      * Felt 31 - ALFA (5 POS)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         rkalfa
 001  *
      * Felt 32 - (15 pos)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx32
 001  *
      * Felt 33 - (15 pos)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx33
 001  *
      * Felt 34 - (11 pos)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx34
 001  *
      * Felt 35 - (30 pos)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx35
 001  *
      * Felt 36 - (30 pos)
 001  *
     c                   z-add     1             y
     c                   add       5             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx36
 001  *
      * Felt 37 - (30 pos)
 001  *
     c                   z-add     1             y
     c                   add       5             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx37
 001  *
      * Felt 38 - (6 pos)
 001  *
     c                   z-add     1             y
     c                   add       5             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx38
 001  *
      * Felt 39 - (25 pos)
 001  *
     c                   z-add     1             y
     c                   add       5             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = '"'
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx39
 001  *
      * Felt 40 - (3 pos)
 001  *
     c                   z-add     1             y
     c                   add       3             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx40
 001  *
      * Felt 41 - (4 pos)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx41
 001  *
      * Felt 42 - (4 pos)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx42
 001  *
      * Felt 43 - (2 pos)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx43
 001  *
      * Felt 44 - (3 pos)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx44
 001  *
      * Felt 45 - (2 pos)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ','
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx45
 001  *
      * Felt 46 - (2 pos)
 001  *
     c                   z-add     1             y
     c                   add       1             x
     c                   eval      wflt = *blank
     c                   eval      wfelt = *blank
B001 c                   dou       wrec(x) = ' '
 001 c                   move      wrec(x)       wflt(y)
 001 c                   add       1             y
 001 c                   add       1             x
E001 c                   enddo
     c                   movea     wflt          wfelt
     c                   movel     wfelt         xxxx46
      *
      * Bygg trans til økonomi
 001  *
     c                   add       rtbelØ        wtpre
     c                   add       1             wlinje
     c                   eval      rtreid = 'T'
     c                   eval      rtfirm = l_firm
     c                   eval      rtbunt = wnxbun
     c                   eval      rtlinj = wlinje
     c                   eval      rtstat = *blank
     c                   eval      rtdsps = *zero
     c                   eval      rtcsps = *zero
6.20 c**                 eval      rtpros = *zero
6.20 c                   eval      rtpros = *blank
     c                   eval      rtrefn = *zero
     c                   eval      rtkrab = *zero
     c                   eval      rtvalk = *blank
     c                   eval      rtvalb = *zero
     c                   eval      rtakti = *blank
     c                   eval      rtmngd = *zero
     c                   eval      rtmngk = *zero
     c                   eval      rtresn = *zero
     c                   eval      rtvirk = *blank
     c                   eval      rtatte = *zero
     c                   eval      rtautx = *blank
     c                   eval      rtkrys = *blank
     c                   eval      rtkidi = *blank
     c                   eval      rtbetb = *zero
     c                   eval      rtbref = *blank
      *
     c                   write     re0tpfr
      *
     c                   eval      rttext = *blank
      *
T5.00c                   eval      rkfirm = l_firm
B001 c                   if        rkkund <> *zeros
 001 c                   write     re0kpfr
E001 c                   endif
      *
     c     slutt         tag
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     c     *inzsr        begsr
      *
     c                   eval      wtpre = *zeros
     c                   eval      wkp = *zeros
     c                   eval      x = 0
      *
     c                   z-add     1             wnxbun
     c     uyear         sub       1             w_raar
      *
     c                   eval      w_firm = l_firm
     c     afirl1_key    chain     afirl1                             10
      *
     c                   eval      ra3fir = rtfirm
     c     raa3l1_key    chain     raa3l1                             10
      *
     c                   eval      raa4l1_4aar = *year
     c     raa4l1_key    chain     raa4l1                             10
      *
B001 c                   if        %found
 001 c                   z-add     ra4sgb        wnota
E001 c                   else
 001 c                   z-add     0             wnota
E001 c                   endif
      *
     c     afirl1_key    klist
     c                   kfld                    w_firm
      *
     c     raa3l1_key    klist
     c                   kfld                    w_firm
      *
     c     raa4l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    raa4l1_4aar
      *
     c                   endsr
      * ----------------------------------------
**   Bilagstekster
Faktura
Kreditnota
Øreavrunding
Gebyr
Utg. MVA
