     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSHOP
      * Program . . . . : BB100R
      * Beskrivelse . . : ButikkBruker, vedlikehold
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       020604 HKO  Nytt program
      *       100205 HKO  Fjernet test på at selgernr må være utfylt
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fbusri1    if   e           k disk    rename(busrst:busri1r)
     fbusriu    uf a e           k disk    rename(busrst:busriur)
      *
     fra09l1    if   e           k disk    rename(ra09pfr:ra09l1r)
      *
     fbb100d    cf   e             workstn
      *
      * Definering av parametre
      *
     d p_firm          s                   like(bbfirm)
     d p_user          s                   like(bbuser)
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
      *
      * Definering av variable i nøkler
      *
     d ra09l1_ikod     s                   like(raikod)
      *
      * Definering av variable
      *
     d w_firm          s                   like(bbfirm)
     d w_user          s                   like(bbuser)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      w_arow = 0
     c                   eval      w_acol = 0
      *
     c     busri1_key    chain     busri1
      *
     c                   if        %found
     c                   eval      b1vref = bbvref
     c                   eval      b1selg = bbselg
     c                   eval      b1kret = bbkret
     c                   eval      b1kopg = bbkopg
     c                   eval      b1kkpr = bbkkpr
     c                   eval      b1kspr = bbkspr
     c                   eval      b1krab = bbkrab
     c                   eval      b1kvtx = bbkvtx
     c                   eval      b1klag = bbklag
     c                   eval      b1kavd = bbkavd
     c                   eval      b1kkgr = bbkkgr
     c                   eval      b1kkup = bbkkup
     c                   eval      b1kkop = bbkkop
     c                   eval      b1kvad = bbkvad
     c                   eval      b1ktas = bbktas
     c                   eval      b1kcan = bbkcan
     c                   eval      b1kbse = bbkbse
     c                   eval      b1eksh = bbeksh
     c                   eval      b1hhor = bbhhor
     c                   eval      b1eusr = bbeusr
     c     *dmy          move      bbodat        b1odat
     c     *dmy          move      bbedat        b1edat
     c                   else
     c                   eval      b1vref = *blank
     c                   eval      b1selg = 0
     c                   eval      b1kret = 0
     c                   eval      b1kopg = 0
     c                   eval      b1kkpr = 0
     c                   eval      b1kspr = 0
     c                   eval      b1krab = 0
     c                   eval      b1kvtx = 0
     c                   eval      b1klag = 0
     c                   eval      b1kavd = 0
     c                   eval      b1kkgr = 0
     c                   eval      b1kkup = 0
     c                   eval      b1kkop = 2
     c                   eval      b1kvad = 2
     c                   eval      b1ktas = 2
     c                   eval      b1kcan = 2
     c                   eval      b1kbse = 2
     c                   eval      b1eksh = 2
     c                   eval      b1hhor = 2
     c                   eval      b1eusr = *blank
     c                   eval      b1odat = 0
     c                   eval      b1edat = 0
     c                   endif
      *
     c     b1taga        tag
      *
     c                   exfmt     b1win
      *
     c                   if        *inkc or *inkl
     c                   goto      avslutt
     c                   endif
      *
      * Validering av input
      *
     c                   if        b1vref = *blank
     c                   eval      *in31 = *on
     c                   goto      b1taga
     c                   endif
      *
     c***                if        b1selg = 0
     c***                eval      *in32 = *on
     c***                goto      b1taga
     c***                endif
      *
     c                   if        b1selg <> 0
     c                   eval      ra09l1_ikod = b1selg
     c     ra09l1_key    chain     ra09l1
     c                   if        not %found
     c                   eval      *in33 = *on
     c                   goto      b1taga
     c                   endif
     c                   endif
      *
     c**                 if        b1kret = 0
     c**                 eval      *in31 = *on
     c**                 goto      b1taga
     c**                 endif
      *
      * Oppdatering
      *
     c                   clear                   busriur
      *
     c     busriu_key    chain     busriur
      *
     c                   eval      bbvref = b1vref
     c                   eval      bbselg = b1selg
     c                   eval      bbkret = b1kret
     c                   eval      bbkopg = b1kopg
     c                   eval      bbkkpr = b1kkpr
     c                   eval      bbkspr = b1kspr
     c                   eval      bbkrab = b1krab
     c                   eval      bbkvtx = b1kvtx
     c                   eval      bbklag = b1klag
     c                   eval      bbkavd = b1kavd
     c                   eval      bbkkgr = b1kkgr
     c                   eval      bbkkup = b1kkup
     c                   eval      bbkkop = b1kkop
     c                   eval      bbkvad = b1kvad
     c                   eval      bbktas = b1ktas
     c                   eval      bbkcan = b1kcan
     c                   eval      bbkbse = b1kbse
     c                   eval      bbeksh = b1eksh
     c                   eval      bbhhor = b1hhor
     c                   eval      bbeusr = l_user
      *
     c                   time                    bbedat
     c                   time                    bbetim
      *
     c                   if        %found
     c                   update    busriur
     c                   else
     c                   eval      bbfirm = w_firm
     c                   eval      bbuser = w_user
     c                   time                    bbodat
     c                   write     busriur
     c                   endif
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_user
      *
      * Key for oppslag på ButikkBruker
      *
     c     busri1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_user
      *
      * Key for oppslag på Selger
      *
     c     ra09l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra09l1_ikod
      *
      * Key for oppdatering av ButikkBruker
      *
     c     busriu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_user
      *
      *
      * Henter firma og bruker fra parameter
      *
     c                   eval      w_firm = p_firm
     c                   eval      w_user = p_user
      *
     c                   endsr
