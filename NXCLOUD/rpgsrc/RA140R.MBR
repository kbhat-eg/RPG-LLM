     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RA140R                                              *
      * Beskrivelse . . : Vedlikehold av formulartekster                      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      * V5.30     251004  Feil nøkkel ved nyregistrering                 KOB  *
7.xx  * 7.xx      120618  Endringer reltart til ny GUI. NB Kan kun gjelde BKV
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     fra140d    cf   e             workstn
     fra70l1    uf a e           k disk    rename(ra70pfr:ra70l1r)
      *
     d fm              s             14    dim(5)
     d lin             s             79    dim(15)
      *
     d err             s             14    dim(4) ctdata perrcd(1)
     d btab            s             79    dim(16) ctdata perrcd(1)             BETALINGSVARSEL
     d ktab            s             79    dim(10) ctdata perrcd(1)             KONTOUTDRAG KUNDE
     d ltab            s             79    dim(10) ctdata perrcd(1)             KONTOUTDRAG LEVRD
     d rtab            s             79    dim(10) ctdata perrcd(1)             RENTENOTA
      *
     d key4            s              4
     d key5            s              5
     d ra70l1_kod      s                   like(r70kod)
     d ra70l1_spr      s                   like(r70spr)
     d ra70l1_lin      s                   like(r70lin)
     d w_firm          s                   like(l_firm)
     d l               s              2  0
     d n               s              1  0
     d tekst           s             79
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     c     a1tag         tag
      *
     c                   exfmt     a1bld
      *
     c                   eval      n = 0
      *
     c                   if        *inkc = *on or
     c                             *inkl = *on
     c                   eval      *inlr = *on
     c                   goto      slutt
     c                   endif
      *
      * Sjekk om gyldig rapportnummer
      *
     c                   if        a1rapp <> 70 and                             BETALINGSVARSEL
     c                             a1rapp <> 71 and                             UTDRAG KUNDER
     c                             a1rapp <> 72 and                             UTDRAG LEVERAND
     c                             a1rapp <> 73                                  RENTENOTA
     c                   eval      n = n + 1
     c                   move      err(2)        fm(n)
     c                   goto      a1tag
     c                   endif
      *
      * Sjekk om gyldig språkkode
      *
     c                   if        a1sprk <= 0 or
     c                             a1sprk > 5
     c                   eval      n = n + 1
     c                   move      err(3)        fm(n)
     c                   goto      a1tag
     c                   endif
      *
      * Les formularregister og fyll opp tabell
      *
     c                   eval      r70kod = a1rapp
     c                   eval      r70spr = a1sprk
     c                   eval      r70lin = *zeros
     c                   eval      l = 0
      *
     c                   exsr      subles
      *
     c                   select
     c                   when      a1rapp = 70
     c                   exsr      xb1bld
     c                   exsr      xe1bld
      *
     c                   when      a1rapp = 71
     c                   exsr      xc1bld
      *
     c                   when      a1rapp = 72
     c                   exsr      xd1bld
      *
     c                   when      a1rapp = 73
     c                   exsr      xf1bld
      *
     c                   endsl
      *
     c                   goto      a1tag
      *
     c/space 3
      *
     c     slutt         tag
      *
     c                   seton                                        lr
      *
     c/eject
      *
      * Betalingsvarsel - del 1
      *
     c     xb1bld        begsr
      *
     c                   move      lin(1)        l1
     c                   move      lin(2)        l2
     c                   move      lin(3)        l3
     c                   move      lin(4)        l4
     c                   move      lin(5)        l5
      *
     c                   exfmt     b170a
      *
     c                   move      l1            lin(1)
     c                   move      l2            lin(2)
     c                   move      l3            lin(3)
     c                   move      l4            lin(4)
     c                   move      l5            lin(5)
      *
     c                   endsr
      *
     c/eject
      *
      * Betalingsvarsel - del 2
      *
     c     xe1bld        begsr
      *
     c                   move      lin(6)        l6
     c                   move      lin(7)        l7
     c                   move      lin(8)        l8
     c                   move      lin(9)        l9
     c                   move      lin(10)       l10
     c                   move      lin(11)       l11
     c                   move      lin(12)       l12
     c                   move      lin(13)       l13
     c                   move      lin(14)       l14
     c                   move      lin(15)       l15
      *
     c                   exfmt     b170b
      *
     c                   move      l6            lin(6)
     c                   move      l7            lin(7)
     c                   move      l8            lin(8)
     c                   move      l9            lin(9)
     c                   move      l10           lin(10)
     c                   move      l11           lin(11)
     c                   move      l12           lin(12)
     c                   move      l13           lin(13)
     c                   move      l14           lin(14)
     c                   move      l15           lin(15)
      *
      * Oppdater formularregisteret
      *
     c                   eval      l = 0
      *
     c                   exsr      subskr
      *
     c                   endsr
      *
     c/eject
      *
      * Kontoutdrag kunder
      *
     c     xc1bld        begsr
      *
     c                   move      lin(1)        l1
     c                   move      lin(2)        l2
     c                   move      lin(3)        l3
     c                   move      lin(4)        l4
     c                   move      lin(5)        l5
     c                   move      lin(6)        l6
     c                   move      lin(7)        l7
     c                   move      lin(8)        l8
     c                   move      lin(9)        l9
     c                   move      lin(10)       l10
      *
     c                   exfmt     c171a
      *
      * Flytt linjenummer til tabell
      *
     c                   move      l1            lin(1)
     c                   move      l2            lin(2)
     c                   move      l3            lin(3)
     c                   move      l4            lin(4)
     c                   move      l5            lin(5)
     c                   move      l6            lin(6)
     c                   move      l7            lin(7)
     c                   move      l8            lin(8)
     c                   move      l9            lin(9)
     c                   move      l10           lin(10)
      *
      * Oppdater formularregisteret
      *
     c                   eval      l = 0
      *
     c                   exsr      subskr
      *
     c                   endsr
      *
     c/eject
      *
      * Kontoutdrag leverandører
      *
     c     xd1bld        begsr
      *
     c                   move      lin(1)        l1
     c                   move      lin(2)        l2
     c                   move      lin(3)        l3
     c                   move      lin(4)        l4
     c                   move      lin(5)        l5
     c                   move      lin(6)        l6
     c                   move      lin(7)        l7
     c                   move      lin(8)        l8
     c                   move      lin(9)        l9
     c                   move      lin(10)       l10
      *
     c                   exfmt     d172a
      *
     c                   move      l1            lin(1)
     c                   move      l2            lin(2)
     c                   move      l3            lin(3)
     c                   move      l4            lin(4)
     c                   move      l5            lin(5)
     c                   move      l6            lin(6)
     c                   move      l7            lin(7)
     c                   move      l8            lin(8)
     c                   move      l9            lin(9)
     c                   move      l10           lin(10)
      *
      * Oppdater formularregisteret
      *
     c                   eval      l = 0
      *
     c                   exsr      subskr
      *
     c                   endsr
      *
     c/eject
      *
      * Rentenota
      *
     c     xf1bld        begsr
      *
     c                   move      lin(1)        l1
     c                   move      lin(2)        l2
     c                   move      lin(3)        l3
     c                   move      lin(4)        l4
     c                   move      lin(5)        l5
     c                   move      lin(6)        l6
     c                   move      lin(7)        l7
     c                   move      lin(8)        l8
     c                   move      lin(9)        l9
     c                   move      lin(10)       l10
      *
     c                   exfmt     e173a
      *
     c                   move      l1            lin(1)
     c                   move      l2            lin(2)
     c                   move      l3            lin(3)
     c                   move      l4            lin(4)
     c                   move      l5            lin(5)
     c                   move      l6            lin(6)
     c                   move      l7            lin(7)
     c                   move      l8            lin(8)
     c                   move      l9            lin(9)
     c                   move      l10           lin(10)
      *
      * Oppdater formularregiseret
      *
     c                   eval      l = 0
      *
     c                   exsr      subskr
      *
     c                   endsr
      *
      *
      /eject
      *
      * Les formularregisteret
      *
     c     subles        begsr
      *
     c     lstart        tag
      *
     c                   eval      l = l + 1
      *
     c                   if        a1rapp = 70 and
     c                             l > 15
     c                   goto      lslutt
     c                   endif
      *
     c                   if        a1rapp = 71 or
     c                             a1rapp = 72 or
     c                             a1rapp = 73
     c                   if        l > 10
     c                   goto      lslutt
     c                   endif
     c                   endif
      *
     c                   eval      ra70l1_kod = a1rapp
     c                   eval      ra70l1_spr = a1sprk
     c                   eval      ra70l1_lin = l
     c     ra70l1_key    chain     ra70l1                             91
      *
     c                   if        *in91 = *off
     c                   move      r70ltx        lin(l)
     c                   else
      *
     c                   select
     c                   when      r70kod = 70
     c                   move      btab(l)       lin(l)
      *
     c                   when      r70kod = 71
     c                   move      ktab(l)       lin(l)
      *
     c                   when      r70kod = 72
     c                   move      ltab(l)       lin(l)
      *
     c                   when      r70kod = 73
     c                   move      rtab(l)       lin(l)
     c                   endsl
      *
     c                   endif
      *
     c                   goto      lstart
      *
     c     lslutt        tag
      *
     c                   endsr
      *
      /eject
      *
      * Oppdater formularregisteret
      *
     c     subskr        begsr
      *
     c     sstart        tag
      *
     c                   eval      l = l + 1
      *
     c                   if        a1rapp = 70 and
     c                             l > 15
     c                   goto      sslutt
     c                   endif
      *
     c                   if        a1rapp = 71 or
     c                             a1rapp = 72 or
     c                             a1rapp = 73
     c                   if        l > 10
     c                   goto      sslutt
     c                   endif
     c                   endif
      *
     c                   eval      r70lin = l
      *
     c                   eval      ra70l1_kod = a1rapp
     c                   eval      ra70l1_spr = a1sprk
     c                   eval      ra70l1_lin = l
     c     ra70l1_key    chain     ra70l1                             91
      *
     c                   move      lin(l)        r70ltx
      *
     c                   if        *in91 = *off
     c                   update    ra70l1r
     c                   else
     c                   eval      r70fir = w_firm
     c                   eval      r70kod = a1rapp
     c                   eval      r70spr = a1sprk
     c                   eval      r70lin = l
     c                   write     ra70l1r
     c                   endif
      *
     c                   goto      sstart
      *
     c     sslutt        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Legge inn firmanummer
      *
     c                   move      l_firm        w_firm
      *
      * Key for formularregister
      *
     c     ra70l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra70l1_kod
     c                   kfld                    ra70l1_spr
     c                   kfld                    ra70l1_lin
      *
     c                   endsr
**
FIRMA
RAPPORTNR.
SPRÅK
BLANKE LINJER
**
     Bankgiro                         Kundenr        Dato       Side nr.
                        B E T A L I N G S V A R S E L
         I følge våre regnskaper viser Deres konto pr.   .  .
         at følgende poster er forfalt til betaling:
Bil.nr   Dato   T e k s t            Forfall        Beløp       Restbeløp  Purr
Sum forfalte poster i vår favør
Vi har belastet Deres konto med et purregebyr på
Vi har beregnet        % renter av forfalt saldo
Forfalt saldo inkl. gebyr/renter er etter dette
Dette betalingsvarsel gjelder også som nota.
Etter lov om inkasso, varsles De herved om at vårt tilgodehavende må
være innbetalt innen 14 dager. I motsatt fall vil kravet bli sendt til
inkasso uten ytterligere varsel.                Inkassodato:   .  .
Med hilsen
Oppgi KID-nummer ved betaling

**
     Bankgiro                           Kundenr        Dato       Side nr
                                                  K O N T O U T D R A G
                                                             Utkjørt

            Bilags  Sfakt                                   B  E  L  Ø  P
    Bilag   dato    nr.   T E K S T                      Debet         Kredit
                          SALDO PR.
                          SALDO I VÅR FAVØR
                          SALDO I DERES FAVØR
                          FAKTURERT HITTIL I ÅR
**
     Bankgiro                           Lev.nr         Dato       Side nr
                                                  K O N T O U T D R A G
                                                             Utkjørt

            Bilags  Sfakt                                   B  E  L  Ø  P
    Bilag   dato    nr.   T E K S T                      Debet         Kredit
                          SALDO PR.
                          SALDO I VÅR FAVØR
                          SALDO I DERES FAVØR
                          KJØP HITTIL I ÅR
**
     Bankgiro                         Kundenr        Dato       Side nr.
                        R E N T E N O T A    NR.     Forfall
         I henhold til våre salgsbetingelser er rentebelastning
         foretatt for følgende poster t.o.m. DD.MM.ÅÅ
         Rentebelastning er foretatt med 12,00 % p.a.
Faktura  Dato   T e k s t          B e l ø p     Fra      Til   Dager    Renter
   Rentebelastning iflg. rentenota  (avrundet ned)
                Beløpet er belastet deres konto


