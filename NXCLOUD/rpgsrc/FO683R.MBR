      /TITLE  ASOFAK: Inntasting av parametre uttrekk fakt./purchasing
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FO683R
      * Beskrivelse . . : Inntasting av parametre uttrekk fakt./purchasing
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       110804 GRO  Nytt program
6.nu  * R6.30 280514 bsa  Programmet gjennomgått mtp nummerutvidelser.
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     ffo683d    cf   e             workstn
      *
      *
     d                 ds
6.nu d dsparm                        32
     d  dsaarr                        4  0 overlay(dsparm)
     d  dsotyp                        2    overlay(dsparm:5)
6.nu d  dsfbin                        8  0 overlay(dsparm:7)
6.nu d  dstbin                        8  0 overlay(dsparm:15)
6.nu d  dsprog                       10    overlay(dsparm:23)
      *
      * - - - - - - - - - - - - - -
      * Henter inn data fra LDA
      * - - - - - - - - - - - - - -
      *
     d                uds
     d dsruti                800    809
     d dssfir                944    946  0
      *
     d w_udat          s               d   datfmt(*iso)
     d w_wdat          s             10
     d w_utim          s               t   timfmt(*iso)
     d w_wtim          s              8
      *                                                                     -
     d wpparm          s             28
     d wpmapi          s             25
     d wpfiln          s             25
     d wppf03          s              1  0
     d wretur          s              1
      *----------------------------------------------------------------------
      * Stand Alone Fields - BOTTOM
      *----------------------------------------------------------------------
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  A1 Behandler valg for utskrift av FAKTURA/KREDITNOTA-kopier    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a1tag         tag
      *
      *  Nullstiller felter som benyttes
      *
     c                   move      uyear         a1aarr
     c                   eval      a1fbin = *zero
     c                   eval      a1tbin = *zero
      *
     c                   eval      w_udat = %date
     c                   move      w_udat        w_wdat
     c                   eval      w_utim = %time
     c                   move      w_utim        w_wtim
     c                   eval      a1filn = 'F' +
     c                                       %subst(w_wdat:1:4) +
     c                                       %subst(w_wdat:6:2) +
     c                                       %subst(w_wdat:9:2) + '_' +
     c                                       %subst(w_wtim:1:2) +
     c                                       %subst(w_wtim:4:2) + '.txt'
     c                   eval      a1mapi = 'purchasing'
      *
     c                   if        a1aarr > 80
     c                   add       1900          a1aarr
     c                   else
     c                   add       2000          a1aarr
     c                   endif
      *
     c     a1taga        tag
     c                   exfmt     a1bld
      *
      *  F3=Avslutt
      *
     c                   if        *inkc = *on
     c                   z-add     1             wppf03
     c                   goto      xslutt
     c                   endif
      *
      *  Kontroll om fra
      *  er større enn til
      *  dersom til er oppgitt
      *
     c                   if        a1tbin <> *zero
     c                   if        a1fbin > a1tbin
     c                   eval      *in33 = *on
     c                   goto      a1taga
     c                   endif
     c                   endif
      *
      *  Dersom til ikke er
      *  oppgitt, legges fra
      *  ut i til
      *
     c                   if        a1tbin = *zero
     c                   z-add     a1fbin        a1tbin
     c                   endif
      *
     c                   eval      dsaarr = a1aarr
     c                   eval      dsfbin = a1fbin
     c                   eval      dstbin = a1tbin
     c                   eval      wpmapi = a1mapi
     c                   eval      wpfiln = a1filn
     c                   eval      wpparm = dsparm
      *
     c                   eval      %subst(dsruti:6:5) = 'FO674'
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Avslutt program                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Subrutine for initiering av program                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *  Nullstilling av felter som ikke kan redefineres
      *
     c                   eval      wretur = *blank
      *
      *  Parameterliste
      *
     c     *entry        plist
     c                   parm                    wpparm
     c                   parm                    wpmapi
     c                   parm                    wpfiln
     c                   parm                    wppf03
      *
     c                   endsr
