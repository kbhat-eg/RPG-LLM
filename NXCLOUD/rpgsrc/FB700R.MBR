     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FB700R
      * Beskrivelse . . : Kontroll av tilganger for bruker
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       140503 AMD  Nytt program
      *
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     ffusrl1    if   e           k disk    rename(fusrpfr:fusrl1r)
      *
      * Definering av local data area
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
     d l_firm                944    946  0
      *
      * Definering av parametere
      *
     d p_kode          s              2  0
     d p_onof          s                   like(fbko01)
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(fbfirm)
     d fusrl1_user     s                   like(fbuser)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Forklaring på programmet :
      * --------------------------
      * Dette programmet benyttes som et generelt program for å finne
      * ut om en bruker har tilgang til en funksjon.
      * Det er oppslag mot brukerregister FUSRL1.
      * Programmet som kaller dette sender med en parameter som sier
      * hvilken tilgangskode som skal sjekkes (Idag fra 1 - 20)
      * Programmet svarer tilbake med en parameter som inneholder
      * verdien til den ønskede koden d.v.s.  0 eller 1
      *
      *
     c                   eval      p_onof = 0
      *
      * Slå opp bruker
      *
     c     fusrl1_key    chain     fusrl1
      *
     c                   if        %found
      *
     c                   if        p_kode = 01
     c                   eval      p_onof = fbko01
     c                   endif
      *
     c                   if        p_kode = 02
     c                   eval      p_onof = fbko02
     c                   endif
      *
     c                   if        p_kode = 03
     c                   eval      p_onof = fbko03
     c                   endif
      *
     c                   if        p_kode = 04
     c                   eval      p_onof = fbko04
     c                   endif
      *
     c                   if        p_kode = 05
     c                   eval      p_onof = fbko05
     c                   endif
      *
     c                   if        p_kode = 06
     c                   eval      p_onof = fbko06
     c                   endif
      *
     c                   if        p_kode = 07
     c                   eval      p_onof = fbko07
     c                   endif
      *
     c                   if        p_kode = 08
     c                   eval      p_onof = fbko08
     c                   endif
      *
     c                   if        p_kode = 09
     c                   eval      p_onof = fbko09
     c                   endif
      *
     c                   if        p_kode = 10
     c                   eval      p_onof = fbko10
     c                   endif
      *
     c                   if        p_kode = 11
     c                   eval      p_onof = fbko11
     c                   endif
      *
     c                   if        p_kode = 12
     c                   eval      p_onof = fbko12
     c                   endif
      *
     c                   if        p_kode = 13
     c                   eval      p_onof = fbko13
     c                   endif
      *
     c                   if        p_kode = 14
     c                   eval      p_onof = fbko14
     c                   endif
      *
     c                   if        p_kode = 15
     c                   eval      p_onof = fbko15
     c                   endif
      *
     c                   if        p_kode = 16
     c                   eval      p_onof = fbko16
     c                   endif
      *
     c                   if        p_kode = 17
     c                   eval      p_onof = fbko17
     c                   endif
      *
     c                   if        p_kode = 18
     c                   eval      p_onof = fbko18
     c                   endif
      *
     c                   if        p_kode = 19
     c                   eval      p_onof = fbko19
     c                   endif
      *
     c                   if        p_kode = 20
     c                   eval      p_onof = fbko20
     c                   endif
      *
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      *  Key for file : BRUKER-REGISTER OFAK
      *
     c     fusrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fusrl1_user
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_kode
     c                   parm                    p_onof
      *
      *  Legger inn firmanummer og bruker i nøkkel
      *
     c                   eval      w_firm = l_firm
     c                   eval      fusrl1_user = l_user
      *
     c                   endsr
