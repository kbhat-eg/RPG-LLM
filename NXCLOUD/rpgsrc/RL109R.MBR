     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON
      * Program . . . . : RL109R
      * Beskrivelse . . : Sjekk om nytt leverandørnr allerede finnes
      *                   Kun tabeller med leverandør i unik nøkkel sjekkes.
      *
      *                   Dette programmet må utvides med flere tabeller
      *                   hvis leverandør kommer i nøkkel i nye tabeller
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       120517 bof  Nytt program
8.xx  *PRGR   290424 bsa  Utvidet prisgruppe fra 1 til 2 posisjoner.
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffrabl8    if   e           k disk    rename(frabpfr:frabl8r)
     fflvalu    if   e           k disk    rename(flvapfr:flvalur)
     fvsdtl1    if   e           k disk    rename(vsdtpfr:vsdtl1r)
     fvvprl3    if   e           k disk    rename(vvprpfr:vvprl3r)
     fvvepl1    if   e           k disk    rename(vveppfr:vvepl1r)
     fvvgkl4    if   e           k disk    rename(vvgkpfr:vvgkl4r)
     fflval1    if   e           k disk    rename(flvapfr:flval1r)
     flldil1    if   e           k disk    rename(lldipfr:lldil1r)
     fmltil3    if   e           k disk    rename(mltipfr:mltil3r)
     fmmatl4    if   e           k disk    rename(mmatpfr:mmatl4r)
     fmppal1    if   e           k disk    rename(mppapfr:mppal1r)
      *
      * Local data area
      *
     d                uds
     d l_user                911    920
      *
      * Definering av parametre
      *
     d p_firm          s              3  0
     d p_gldo          s                   like(vpldor)
     d p_ldor          s                   like(vpldor)
     d p_stat          s              1
      *
      * Definering av variable i nøkler
      *
      *
      * Definering av variable
      *
     d w_firm          s              3  0
     d w_ldor          s                   like(vpldor)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      w_firm = p_firm
     c                   eval      w_ldor = p_ldor
      *
      *
      *  O R D R E    -  TABELLER
      *
      *
      * Sjekk til leverandør i vare pris
      *
     c     key01         chain     vvprl3
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i rabattmatrise
      *
     c     key01         chain     frabl8
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i leverandør - vare register
      *
     c     key01         chain     flval1
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i varegruppe knytning
      *
     c     key01         chain     vvgkl4
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i varesortiment
      *
     c     key00         setll     vsdtl1
     c     key00         reade     vsdtl1                                 90
     c                   dow       *in90 = *off
     c                   if        vdldor = p_ldor
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
     c     key00         reade     vsdtl1                                 90
     c                   enddo
      *
      * Sjekk til leverandør i vare-enhet prisgiver
      *
     c     key00         setll     vvepl1
     c     key00         reade     vvepl1                                 90
     c                   dow       *in90 = *off
     c                   if        vepldo = p_ldor
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
     c     key00         reade     vvepl1                                 90
     c                   enddo
      *
      *
      * Lager
      *
      * Sjekk til leverandør i leverandør distribusjon
      *
     c     key01         chain     lldil1
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i ledetid
      *
     c     key01         chain     mltil3
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i prognose
      *
     c     key01         chain     mmatl4
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * Sjekk til leverandør i best.forslag parameter
      *
     c     key01         chain     mppal1
     c                   if        %found
     c                   eval      p_stat = '1'
     c                   goto      avslutt
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_gldo
     c                   parm                    p_ldor
     c                   parm                    p_stat
      *
      * Key for oppslag/les på vare
      *
     c     key01         klist
     c                   kfld                    w_firm
     c                   kfld                    w_ldor
      *
      * Key for oppslag/les på vare
      *
     c     key00         klist
     c                   kfld                    w_firm
      *
     c                   eval      p_stat = '0'
      *
     c                   endsr
