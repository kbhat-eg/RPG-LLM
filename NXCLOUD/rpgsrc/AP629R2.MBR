      /TITLE  Oppslag mot rutine-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Program . . . . : AP629R2
      * Beskrivelse . . : Skriver til datakø
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- - - - - - - - - - - - - - - - - - - - - - - - - -
      *       230915 BSA  Nytt program
      *
8.01  *K000   141122 bsa  Sjekk hvilken PROA versjon som kjøres. Hvis
8.01  *K000               versjon 2, skal det ikke skrives til datakø.
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     d                uds
8.01 d l_filg                937    939
     d l_firm                944    946  0
     d l_avde                947    950  0
      *
      * Definering av parametre
      *
     d p_filg          s             10
     d p_xmlf          s            256
      *
8.01 d w_vers          s              5
      *
     d DataQ           s             10a   inz('PROADTAQ2')
     d Library         s             10a   inz('*libl')
     d Text            s            200a
     d Datalen         s              5  0 inz(200)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Hent inn post fra formularregister                              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
8.01 c                   if        %trim(w_vers) <> '2'
      *
     c                   eval      text = %trim(p_xmlf)
     c                   eval      Datalen = %len(%trim(text))
     c                   eval      Library = %trim(p_filg)
     c                   call      'QSNDDTAQ'
     c                   parm                    DataQ
     c                   parm                    Library
     c                   parm                    DataLen
     c                   parm                    text
      *
8.01 c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_filg
     c                   parm                    p_xmlf
      *
8.01  /Free
8.01  *
8.01  * Henter inn verdier for å bygge opp streng til json
8.01  *
8.01   exec sql
8.01    select afudss
8.01    into   :w_vers
8.01    from   afpspf
8.01    where  afufil = :l_filg and
8.01           afuide = 'PROA_VER';
8.01
8.01  /End-free
      *
     c                   endsr
      *
