     h datedit(*dmy) option(*nodebugio : *srcstmt)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Program . . . . : AP650R
      * Beskrivelse . . : Fellesprogram for sjekk av programstack
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.
      * --------- ------  --------------------------------------------------
      *           060815  Nytt program                             bsa
      *
6.30  * 120318    nho     Klarer ikke sjekk nok 'program' dersom
      *                   'stack' er for lang
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Local Data Area
      *
     d                uds
     d l_wsid                901    910
     d l_user                        10
     d l_filg                931    933
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Program information
      *
     d ProgStatus     sds
     d  Parms            *PARMS
     d  ProgName         *PROC
     d  ErrMsgID              40     46
     d  ErrMsg                91    169
     d  JobName              244    253
     d  Userid               254    263
     d  JobNumber            264    269
      *
      * Call stack
      *
     d FindCaller      PR                  Extpgm('QWVRCSTK')
6.30 d**                           2000a
6.30 d                             3000a
     d                               10I 0
     d                                8a   CONST
     d                               56a
     d                                8a   CONST
     d                               15a
      *
      *  Call Stack Data
      *
6.30 d*Var             DS          2000
6.30 d Var             DS          3000
     d  BytAvl                       10I 0
     d  BytRtn                       10I 0
     d  Entries                      10I 0
     d  Offset                       10I 0
     d  EntryCount                   10I 0
      *
      *  Call Stack Job Information
      *
     d JobIdInf        DS
     d  JIDQName                     26a   Inz('*')
     d  JIDIntID                     16a
     d  JIDRes3                       2a   Inz(*loval)
     d  JIDThreadInd                 10I 0 Inz(1)
     d  JIDThread                     8a   Inz(*loval)
      *
      * Call Stack Program names
      *
     d Entry           DS           256
     d  EntryLen                     10I 0
     d  ReqstLvl                     10I 0 Overlay(Entry:21)
     d  PgmNam                       10a   Overlay(Entry:25)
     d  PgmLib                       10a   Overlay(Entry:35)

     d VarLen          s             10I 0 Inz(%size(Var))
     d ApiErr          s             15a
     d Caller          s             50a
     d WhoCalled       s             10a
     d i               s             10I 0
      *
      * Definering av parametere
      *
     d p_prog          s             10a
     d p_stat          s              1a
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedbehandling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Sjekker om gyldig ordre hode
      *
      /free

         CallP     FindCaller(Var:VarLen:'CSTK0100':JobIdInf
                   :'JIDF0100':ApiErr);
         For i = 1 to EntryCount;
            Entry = %subst(Var:Offset + 1);
        //  Caller = %trim(PgmLib) + '/' + %trim(PgmNam);
            If PgmNam = p_prog;
               p_stat = '1';
            Endif;
            Offset = Offset + EntryLen;
         Endfor;

      /end-free
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     end_pgm       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_prog
     c                   parm                    p_stat
      *
     c                   endsr
