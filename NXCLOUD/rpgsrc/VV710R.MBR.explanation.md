```markdown
## Program Overview

This RPG source code is for a program named `VV710R`, operating on the IBM i (AS/400) platform in ILE RPG (also called RPG IV or RPGLE). The program's main purpose is to look up and return the **NOBB number** and the **supplier's item number** (lev.varenummer) for a given item number (varenummer). If the information is not found in the primary file, it tries a secondary source.

The file header contains extensive comments, including:

- **System:** ASOFAK
- **Function:** Returns NOBB and supplier item numbers
- **Logic:** Checks a main register (EVR). If not found, falls back to another register (VA).
- **Parameters:** Item number in; NOBB and supplier item numbers out.
- **Change Log:** Dates and authors of changes (including extension for "trelast-sortiment"—lumber/wood assortment).

---

## Key Components and Flow

### File Declarations

```rpg
fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
```
- `vvarl1` and `jvarl1` are disk files opened for keyed access.
- They are renamed from physical files for record-format referencing.

---

### Variables and Parameters

```rpg
d p_lvar          s                   like(vvlvar)
d p_nobb          s                   like(vvnobb)
d p_vare          s                   like(vvvare)
```
- **Parameters:**
  - `p_vare`: Input item number (varenummer)
  - `p_nobb`: Output NOBB number
  - `p_lvar`: Output supplier item number

Other variables are defined for internal keying and working storage, frequently using the `LIKE` keyword to ensure consistency with database field definitions.

---

### *INZSR – Initialization Subroutine

```rpg
c     *inzsr        begsr
c     *entry        plist
c                   parm                    p_vare
c                   parm                    p_nobb
c                   parm                    p_lvar
...
c                   eval      w_firm = l_firm
c                   endsr
```
- **Parameter list** is defined here for program entry: receives input and output pointers.
- **Key lists** (`klist`) defined for the primary (`vvarl1_key`) and secondary (`jvarl1_key`) item files.
- The current company/firm identifier (`w_firm`) is initialized from a data structure field `l_firm`.

---

### Main Logic

#### 1. **Parameter Initialization**

```rpg
c                   eval      p_nobb = *zeros
c                   eval      p_lvar = *blank
```
- Output parameters are initialized to "empty" values.

#### 2. **Input Validation**
```rpg
c                   if        p_vare = *blank
c                   goto      avslutt
c                   endif
```
- If no item number is provided, the program immediately exits.

#### 3. **Primary File Lookup (`vvarl1`)**

```rpg
c                   eval      vvarl1_vare = p_vare
c     vvarl1_key    chain     vvarl1
c                   if        %found
```
- The program tries to find the item in the main file `vvarl1` using a composite key (`w_firm`, `vvarl1_vare`).

##### a. **Special Case Handling with Embedded SQL**

For certain items (logistics items; as part of version 6.31 changes):

```rpg
c                   eval      w_lv_nobb = 0
c/exec sql
c+ select vvlnob, vvllva
c+   into :w_lv_nobb, :w_lv_lvar
c+   from vvlepf
c+   where vvlvnr = :vvvare and vvlldo = :vvldor
c+   fetch first 1 rows only
c/end-exec
c                   if        w_lv_nobb <> 0
c                   eval      p_nobb = w_lv_nobb
c                   eval      p_lvar = w_lv_lvar
```
- Uses SQL to check if the item is a "logistics item" in the `vvlepf` table.
- If found (`w_lv_nobb <> 0`), information from SQL is used.

##### b. **Normal Case**

```rpg
c                   else
c                   eval      p_nobb = vvnobb
c                   eval      p_lvar = vvlvar
c                   endif
c                   goto      avslutt
```
- If not a logistics item, simply takes values from the record just read in `vvarl1`.

#### 4. **Secondary File Lookup (`jvarl1`)**

If not found in the primary file:

```rpg
c                   eval      jvarl1_vare = p_vare
c     jvarl1_key    chain     jvarl1
c                   if        %found
c                   eval      p_nobb = jvnobb
c                   eval      p_lvar = jvlvar
c                   goto      avslutt
c                   endif
```
- Tries the secondary file. If found, outputs the corresponding fields.

#### 5. **End Processing (`avslutt` label)**

```rpg
c     avslutt       tag
c                   eval      *inlr = *on
c                   return
```
- End of program: set LR (last record) on to close files properly, then return.

---

## Additional Notes

- **Error Handling**: If the item number isn't found in either file, output parameters remain at their initialized values.
- **Date and User Fields**: Some fields, such as `l_user` and `l_firm`, may be loaded from job/user data or passed by the calling program.
- **SQL Date Option**: The SQL set option ensures the date format is `*ISO` for any SQL executed.
- **NodebugIO**: The `h` spec disables certain debug functions for input/output.

---

## Summary

- This program receives an item number and attempts to fetch and return the NOBB number and supplier's item number.
- Priority is given to the primary register with special handling for logistics items via embedded SQL.
- If not found, the program checks a secondary register.
- If the item number is missing or no match is found, blank/zero values are returned.
- The entry and parameter list are set up in the initialization subroutine.

---

**This is a well-structured lookup utility, easily adaptable for new item sources or extensions, and provides a useful programming pattern for RPG-based data retrieval routines.**
```