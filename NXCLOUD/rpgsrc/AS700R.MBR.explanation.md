```markdown
# RPG Program Explanation: AS700R (ASPGPL)

## Overview

This RPG program is a utility for splitting a search string (Norwegian: "søkestring") into up to 5 separate search terms (or substrings). Its main purpose is to parse an input string, break it into words separated by spaces, and assign each word to a separate variable. Additionally, it sorts these substrings so the longest substring is assigned to the first output variable, and then formats the first substring in a particular way for later processing.

---

## Structure

### 1. Parameter and Variable Definitions

**Parameters**
- `p_stek`: Input search string (35 characters)
- `p_ste1` to `p_ste5`: Output search terms (each 35 characters)

**Work Variables**
- `w_l1` to `w_l5`: Lengths of each extracted term
- `w_stek`: Working copy of the search string
- `w_l`: Temporary variable used in sorting

---

### 2. Entry Subroutine (`*inzsr`)

- **Parameter List Setup**: Binds input/output variables (`plist` and `parm` statements).
- **Initialization**: Blanks out all output variables (`p_ste1` to `p_ste5`).

---

### 3. Main Processing

#### **Step-by-Step Breakdown**

#### a) Extract Substrings

The logic repeats for up to 5 times to extract up to 5 substrings from the input:

1. **Trim leading blanks from the input string (`%triml`)**
2. **Find the position of the first space (`%scan(' ':w_stek)`)**
3. **Extract the substring before the space and assign it to the relevant output variable (`%subst`)**
4. **Shorten the working string for the next iteration**

This process is loop-unrolled: it does not use an explicit loop, but repeats similar code blocks for each of the 5 substrings.

For positions 2–5, if no word is found, the output is set to blanks.

#### b) Sort Substrings by Length

After extracting the substrings, a simple bubble-sort-like logic is applied (using a series of `if` and `eval` statements) to ensure that the longest substring is put into `p_ste1`, the second longest in `p_ste2`, etc. This is implemented by:

- Comparing the lengths (`w_l1` to `w_l5`)
- Swapping values as needed using a temporary variable (`w_l` and `w_stek`)

#### c) Format the First Substring

The first substring (`p_ste1`) is formatted by:
- Prefixing it with a percent sign `%`
- Appending a string of percent symbols (`%%%%%%%%%%%...`) to pad it

This possibly prepares the string for wildcard search operations.

---

### 4. Program End & Cleanup

- Sets the `*INLR` indicator on, which tells the RPG program to end and release its resources.
- Returns from the program.

---

## Key Techniques Used

- **String Trimming and Substring Extraction:** Using `%triml`, `%scan`, and `%subst`
- **Manual Substring Sorting:** To ensure the longest word comes first, a sequence of simple swaps is used.
- **Parameter Handling:** Old-style RPG handles input and output parameters via `plist` and `parm`.
- **Blank Handling:** Ensures outputs are blank if insufficient terms are found.

---

## Example

**Input:**
```
"  apple orange  banana   pear"
```

**Output:**
- `p_ste1`: `%banana%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%...`
- `p_ste2`: `"orange"`
- `p_ste3`: `"apple"`
- `p_ste4`: `"pear"`
- `p_ste5`: `""` (blank)

---

## Points of Note

- The code expects input shorter than or equal to 35 characters.
- If fewer than 5 words are found, output variables are blanked.
- The sorting only occurs after all words are extracted – longer substrings are preferred in earlier outputs.
- The formatting of `p_ste1` may be system- or application-specific, likely for matching/wildcard searching.

---

## Conclusion

This program is a classic RPG utility function for string splitting and sorting, designed with the language's fixed-format conventions and typical for older AS/400 and IBM i applications. It's modular, robust, and suitable for re-use in any application requiring search string decomposition.
```