     h/TITLE  Beregning av modulus10 nummer
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : ASMD10                                              *
      * Beskrivelse . . : Kontroll og utregning av MOD10-nummer               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     d m10             s              1  0 dim(24)                              Grunnlag for chksiff
     d u10             s              1  0 dim(12)
     d*
     d*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d*               :  DATASTRUKTURER                                  +
     d*+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d*
     d                 ds
     d  qdmd10                 1     25                                         Hele K
     d  q10                    1     24                                         Kontro
     d                                     dim(24)                              Grunnlag inn
     d  qdck10                25     25  0                                      Kontro
      *
     d fa10            s              1  0
     d ix              s              3  0
     d modr10          s              1  0
     d mods10          s              3  0
     d wplist          s             25
     d xx              s              2  0
     d yy              s              2  0
      *
      *        Start rutine for modulus-10 utregning.
      *
     c     *entry        plist
     c                   parm                    wplist
     c                   eval      qdmd10 = wplist
      *
     c                   z-add     1             xx
     c                   z-add     2             yy
     c                   z-add     2             fa10
     c                   z-add     0             mods10
     c                   z-add     0             modr10
     c                   z-add     0             qdck10
      *
      * Flytt innput(arrey) til grunnlag(arrey)
      *
     c                   z-add     1             ix                                            R2.06
B001 c                   dou       ix > 24
B002 c                   if        q10(ix) = *blank
 002 c                   move      *zero         m10(ix)
X002 c                   else
 002 c                   move      q10(ix)       m10(ix)
E002 c                   endif
 001 c                   add       1             ix
E001 c                   enddo
      *
     c     utr10         tag
      *
B001 c                   if        xx > 12
 001 c                   z-add     1             xx
 001 c                   z-add     1             yy
 001 c                   goto      add10
X001 c                   else
 001 c     m10(yy)       mult      fa10          u10(xx)
B002 c                   if        m10(yy) > 4
 002 c                   add       1             mods10
E002 c                   endif
 001 c                   add       1             xx
 001 c                   add       2             yy
 001 c                   goto      utr10
E001 c                   endif
      *
     c     add10         tag
      *
B001 c                   if        xx > 12
 001 c                   goto      sif10
E001 c                   endif
     c                   add       u10(xx)       mods10
     c                   add       m10(yy)       mods10
     c                   add       1             xx
     c                   add       2             yy
      *
     c                   goto      add10
      *
     c     sif10         tag
      *
     c                   move      mods10        modr10
     c     10            sub       modr10        qdck10
      *
     c     slutt         tag
      *
      *----------------------------------------------
      *        Slutt rutine for modulus-10 utregning.
      *----------------------------------------------
      *
     c                   eval      wplist = qdmd10
     c                   return
