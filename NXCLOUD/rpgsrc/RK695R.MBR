     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK695R                                        *
      * Beskrivelse . . : Utskrift kopi av generalnota - parameter      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * V5.50 080108 HFL  Nytt program                                  *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fausrl1    if   e           k disk
     frk695d    cf   e             workstn
      *
     d mld             s             50    dim(10) ctdata perrcd(1)              Meldinger
      *
     d                 ds
     d w6fdat                         6  0
     d  w6fdag                        2  0 overlay(w6fdat)
     d  w6fmnd                        2  0 overlay(w6fdat:3)
     d  w6faar                        2  0 overlay(w6fdat:5)
      *
     d                 ds
     d w_fdat                         8  0
     d  w_faar                        4  0 overlay(w_fdat)
     d  w_fmnd                        2  0 overlay(w_fdat:5)
     d  w_fdag                        2  0 overlay(w_fdat:7)
      *
     d                uds
     d pgenf                 300    305  0
     d pgent                          6  0
     d praar                          4  0
     d pudato                         8  0
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d waar            s              4  0
     d wmnd            s              2  0
     d wpakod          s              2  0
     d wpdat1          s              6  0
     d p_in03          s              1
     d wpokok          s              1
     d w_aar           s              2  0
     d w_firm          s              3  0
     d w_user          s                   like(l_user)
     d wsavli          s              2  0
     d wsavpo          s              3  0
     d w_ddat          s              8  0
      *
      /eject
     c     dummy         tag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * A2BLD  - A2 Bilde for valg av parametre
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A2BLD Behandle bilde for valg av utskriftskriteria              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a2taga        tag
      *
      * Bare data
      *
     c     a2tagb        tag
      *
     c                   exfmt     a2bld
      *
     c                   eval      *in40 = *off
     c                   eval      *in41 = *off
     c                   eval      *in42 = *off
     c                   eval      *in43 = *off
      *
      * Gå ut
      *
     c                   if        *inkc = *on                                  .....
     c                   move      '1'           p_in03                             .
     c                   goto      xslutt                                           .
     c                   endif                                                  .....
      *
      *  Kontroll av generalnotanr. fra - til
      *
     c                   if        a2pgnf = *zero                                        .....
     c                   eval      *in40 = *on
     c                   move      mld(1)        a2mld
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2pgnt = *zero                                        .....
     c                   eval      *in41 = *on
     c                   move      mld(2)        a2mld
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2pgnf > a2pgnt                                       .....
     c                   eval      *in40 = *on
     c                   move      mld(3)        a2mld
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
      *  Kontroll av regnskapsår
      *
     c                   if        a2prÅr = *zero                                        .....
     c                   eval      *in42 = *on
     c                   move      mld(4)        a2mld
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
      *  Varsel ved regnskapsår større enn *year
      *
     c                   if        a2prÅr > *year                                        .....
     c                   movel     mld(5)        m1mld1
     c                   movel     mld(6)        m1mld2
     c                   move      'N'           m1svar
     c                   exsr      xm1win
     c                   if        m1svar = 'N'
     c                   eval      *in42 = *on
     c                   move      mld(4)        a2mld
     c                   goto      a2taga                                                    .
     c                   endif
     c                   endif                                                           .....
      *
      *  Kontroll av utskriftsdato
      *
     c                   eval      w_fdat = *zero
     c                   if        a2pkda = *zero                                        .....
     c                   eval      *in43 = *on
     c                   move      mld(7)        a2mld
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
      * Snu utskriftsdato og utvid til 8 siffer
      *
     c                   move      a2pkda        w6fdat
     c                   move      w6faar        w_faar
      *
     c                   if        w6faar > 80
     c                   eval      w_faar = w_faar + 1900
     c                   else
     c                   eval      w_faar = w_faar + 2000
     c                   endif
     c                   move      w6fmnd        w_fmnd
     c                   move      w6fdag        w_fdag
      *
      * Skriv parameter
      *
     c                   move      w_fdat        pudato
     c                   move      a2pgnf        pgenf
     c                   move      a2pgnt        pgent
     c                   move      a2prÅr        praar
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * M1WIN Behandle bilde for melding med svar                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xm1win        begsr
      *
     c                   eval      wsavli = 6
     c                   eval      wsavpo = 22
     c                   eval      w_arow = wsavli
     c                   eval      w_acol = wsavpo
      *
     c                   exfmt     m1win
      *
     c                   if        *inkc = *on
     c                   move      'N'           m1svar
     c                   endif
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      wpakod = *zero
     c                   eval      wpdat1 = 0
     c                   eval      wpokok = *blank
      *
      *
      * Legge inn firmanummer og navn fra parameter
      *
     c                   move      l_user        w_user
     c                   move      l_firm        w_firm
      *
      * Foreslår år
      *
     c                   move      *year         waar
      *
     c                   eval      wmnd = umonth - 1
     c                   if        wmnd = *zero                                          .....
     c                   movel     12            wmnd                                        .
     c                   eval      waar = waar - 1                                           .
     c                   move      waar          a2prÅr                                      .
     c                   else                                                                .
     c                   move      waar          a2prÅr                                      .
     c                   endif                                                           .....
      *
     c                   eval      p_in03 = ' '
      *
      * Hent bruker-record
      *
     c     ausrl1_key    chain     ausrl1                             63
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_in03
      *
      * Key for bruker-file
      *
     c     ausrl1_key    klist
     c                   kfld                    w_user
      *
     c                   endsr
**
Generalnota nr. fra må oppgis                      01
Generalnota nr. til må oppgis                      02
Generalnota nr. fra er større enn til              03
Regnskapsår er ugyldig                             04
Valgt periode er neste år.                         05
Bekreft dersom dette er riktig.                    06
Utskriftsdato er ugyldig                           07
