     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
      *                                                                       *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RE110R                                              *
      * Beskrivelse . . : Oppdaterer konti fra Externe systemer               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Ref.  Dato   Sign Endringsbeskrivelse                                 *
      * --------- ------  --------------------------------------------------- *
6.10  * V6.10 210909 BSA  Lagt inn sporingsfelter                             *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     fre0hpf    ip  ae           k disk
     fraa1l1    if   e           k disk    rename(raa1pfr:raa1l1r)
     frhovlu    uf a e           k disk    rename(rhovpfr:rhovlur)
      *
     d lo              c                   'abcdefghijklmnopqrstuvwxyzæøåÆØÅ'
     d uh              c                   'ABCDEFGHIJKLMNOPQRSTUVWXYZ²ÔÖ²ÔÖ'
      *
      * LOCAL DATA
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_alfa          s                   like(rhalfa)
     d w_avde          s                   like(rhavde)
     d w_avdk          s                   like(rhavdk)
     d w_bnØk          s                   like(rhbnØk)
     d w_firm          s                   like(rhfirm)
     d w_kont          s                   like(rhkont)
     d w_mngd          s                   like(rhmngd)
     d w_mvag          s                   like(rhmvag)
     d w_mvak          s                   like(rhmvak)
     d w_mvao          s                   like(rhmvao)
     d w_nØkk          s                   like(rhnØkk)
     d w_proj          s                   like(rhproj)
     d w_spes          s                   like(rhspes)
     d w_sprk          s                   like(rhsprk)
     d w_text          s                   like(rhtext)
     d w_txt2          s                   like(rhtxt2)
     d w_valk          s                   like(rhvalk)
      *
     d rhovlu_kont     s                   like(rhkont)
     d rhovlu_spes     s                   like(rhspes)
     d rhovlu_avde     s                   like(rhavde)
      *
      * Sjekk firma og konto
      *
     c                   if        rhfirm <> l_firm or                          Innenfor grenser
     c                             rhkont > ra1hkt                              Innenfor grenser
     c                   goto      slutt                                         kontoplan
     c                   endif
      *
     c                   eval      rhfirm = l_firm                              Konto
     c                   eval      w_kont = rhkont                              Konto
     c                   eval      w_spes = rhspes                              Spesifikasjon
     c                   eval      w_avde = rhavde                              Avdeling
     c                   eval      w_text = rhtext                              Navn
     c                   eval      w_txt2 = rhtxt2                              Navn
     c                   eval      w_sprk = rhsprk                              Sperrekode
     c                   eval      w_mvak = rhmvak                              MVA-kode
     c                   eval      w_bnØk = rhbnØk                              Budsjett-nøkkel
     c                   eval      w_proj = rhproj                              Prosjektkode
     c                   eval      w_valk = rhvalk                              Valutakode
     c                   eval      w_mvao = rhmvao                              MVA-overstyring
     c                   eval      w_mvag = rhmvag                              Gyldige MVA-koder
     c                   eval      w_avdk = rhavdk                              Avdeling-kode
     c                   eval      w_mngd = rhmngd                              Mengde-kode
     c                   eval      w_nØkk = rhnØkk                              Nøkkeltall-kode
     c                   eval      w_alfa = rhalfa                              Alfa søkefelt
      *
     c                   eval      rhovlu_kont = rhkont
     c                   eval      rhovlu_spes = rhspes
     c                   eval      rhovlu_avde = rhavde
     c     rhovlu_key    chain     rhovlu
      *
     c                   if        %found                                       ....................
     c                   eval      rhtext = w_text                              Navn               .
     c                   eval      rhtxt2 = w_txt2                              Navn               .
      *
     c                   if        w_sprk <> *blank                                                .
     c                   eval      rhsprk = w_sprk                              Sperrekode         .
     c                   endif                                                                     .
      *
     c                   if        w_mvak <> *zero                                                 .
     c                   eval      rhmvak = w_mvak                              MVA-kode           .
     c                   endif                                                                     .
      *
     c                   if        w_bnØk <> *zero                                                 .
     c                   eval      rhbnØk = w_bnØk                              Budsjett-nøkkel    .
     c                   endif                                                                     .
      *
     c                   if        w_proj <> *blank                                                .
     c                   eval      rhproj = w_proj                              Prosjekt-kode      .
     c                   endif                                                                     .
      *
     c                   if        w_valk <> *blank                                                .
     c                   eval      rhvalk = w_valk                              Valutakode         .
     c                   endif                                                                     .
      *
     c                   if        w_mvao <> *zero                                                 .
     c                   eval      rhmvao = w_mvao                              MVA-overstyring    .
     c                   endif                                                                     .
      *
     c                   if        w_mvag <> *zero                                                 .
     c                   eval      rhmvag = w_mvag                              MVA-koder          .
     c                   endif                                                                     .
      *
     c                   if        w_avdk <> *blank                                                .
     c                   eval      w_avdk = rhavdk                              Avdeling-kode      .
     c                   endif                                                                     .
      *
     c                   if        w_mngd <> *zero                                                 .
     c                   eval      rhmngd = w_mngd                              Mengde-kode        .
     c                   endif                                                                     .
      *
     c                   if        w_nØkk <> *zero                                                 .
     c                   eval      rhnØkk = w_nØkk                              Nøkkeltall-kode    .
     c                   endif                                                                     .
      *
     c                   if        w_alfa <> *blank                                                .
     c                   eval      rhalfa = w_alfa                              Alfa søkefelt      .
     c                   endif                                                                     .
      *
      * Konvertere alfafelt til store bokstaver
      *
     c     lo:uh         xlate     rhalfa        rhalfa
      *
     c                   endif                                                  ....................
      *
     c                   time                    rhedat
     c                   time                    rhetim
     c                   eval      rheusr = l_user
      *
     c                   if        %found
     c                   update    rhovlur                                      Oppdater konto
     c                   else
6.10 c                   time                    rhodat
6.10 c                   time                    rhotim
6.10 c                   eval      rhousr = l_user
     c                   write     rhovlur                                      Skriv konto
     c                   endif
      *
     c     slutt         tag
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Legge inn firmanummer og navn fra LDA
      *
     c                   eval      w_firm = l_firm
      *
     c     raa1l1_key    chain     raa1l1                             60
      *
      * Key for statuskode 1
      *
     c     raa1l1_key    klist
     c                   kfld                    w_firm
      *
     c     rhovlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rhovlu_kont
     c                   kfld                    rhovlu_spes
     c                   kfld                    rhovlu_avde
      *
     c                   endsr
