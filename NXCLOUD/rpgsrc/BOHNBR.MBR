      /TITLE  ASSHOP: Henter inn fra bong-register til butikk-register
     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASSHOP
      * Program . . . . : BOHNBR
      * Beskrivelse . . : Henter inn fra bong-register til butikk
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       100101 AMD  Skrevet om til standard ILE-program
      *
3.31  * R3.31 100101 AMD  Statistikk ble ikke oppdatert med varegruppe
3.31  *                   på varer hentet fra LVR (ordre hentet til butikk)
3.32  * R3.32 200301 AMD  Dersom det skal skrives en kopi av bongen, skal
      *                   opprinnelig bongnummer være med tilbake.
      *                   Bilagsnummer må også være med.
3.33  * R3.33 230301 AMD  Det er åpnet mulighet for å hente inn bonger fra
      *                   andre skjermer/kasser enn den man jobber fra.
3.34  * R3.34 290301 AMD  Lagt inn mulighet for å styre om rabatter skal
      *                   vises med prosent, eller som bare et nettobeløp.
3.41  * R3.41 090103 AMD  Fikk ikke skrevet ut bonger fra fjor-året
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     fbohel1    if   e           k disk    rename(bohepfr:bohel1r)
     fbodtl1    if   e           k disk    rename(bodtpfr:bodtl1r)
     fbmhelu    uf a e           k disk    rename(bmhepfr:bmhelur)
     fbmdtlu    uf a e           k disk    rename(bmdtpfr:bmdtlur)
      *
      * Definering av Local data area
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
      *
      * Definering av parametere
      *
     d p_firm          s                   like(bofirm)
     d p_aarr          s                   like(boaarr)
     d p_retu          s                   like(w_alf1)
     d p_wsid          s                   like(bowsid)
     d p_aar2          s                   like(bnaarr)
5.30 d p_num2          s                   like(bmnumm)
     d p_wsd2          s                   like(bnwsid)
      *
      * Definering av variabler i nøkler
      *
     d w_firm          s                   like(bofirm)
     d bohel1_aarr     s                   like(boaarr)
5.30 d bohel1_numm     s                   like(bobong)
     d bohel1_wsid     s                   like(bowsid)
     d bodtl1_aarr     s                   like(bdaarr)
5.30 d bodtl1_numm     s                   like(bdbong)
     d bodtl1_line     s                   like(bdline)
     d bodtl1_wsid     s                   like(bdwsid)
     d bmhelu_aarr     s                   like(bnaarr)
     d bmhelu_numm     s                   like(bnnumm)
     d bmhelu_wsid     s                   like(bnwsid)
     d bmdtlu_aarr     s                   like(bmaarr)
     d bmdtlu_numm     s                   like(bmnumm)
     d bmdtlu_line     s                   like(bmline)
     d bmdtlu_wsid     s                   like(bmwsid)
      *
      * Definering av variable
      *
     d w_alf1          s              1
      *
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Henter inn linjer fra  BUTIKK-BONG-LINJE-REGISTER
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     bodtl1_key    setll     bodtl1r
      *
     c     startl        tag
     c                   eval      *in90 = *off
     c                   read      bodtl1r                                90
      *
     c                   if        *in90 = *off
     c                   if        bodtl1_aarr = bdaarr
     c                   if        bodtl1_wsid = bdwsid
5.30 c                   if        bodtl1_numm = bdbong
     c                   eval      bmdtlu_line = bdline
     c     bmdtlu_key    chain     bmdtlur                            92
     c                   if        *in92 = *on
     c                   eval      bmfirm = w_firm
     c                   eval      bmaarr = bmdtlu_aarr
     c                   eval      bmwsid = bmdtlu_wsid
     c                   eval      bmnumm = bmdtlu_numm
     c                   eval      bmline = bmdtlu_line
      *
      * Legger over opplysninger om den enkelte linjen
      *
     c                   eval      bmltyp = bdltyp
     c                   eval      bmvare = bdvare
     c                   eval      bmenh1 = bdenh1
     c                   eval      bmtek1 = bdtek1
     c                   eval      bmtek2 = bdtek2
     c                   eval      bmanta = bdanta
     c                   eval      bmkpri = bdkpri
     c                   eval      bmsapr = bdsapr
     c                   eval      bmkopr = bdkopr
     c                   eval      bmselk = bdselk
     c                   eval      bmrab1 = bdrab1
     c                   eval      bmrab2 = bdrab2
     c                   eval      bmsums = bdsums
3.31 c                   eval      bmogrp = bdogrp
3.31 c                   eval      bmhgrp = bdhgrp
3.31 c                   eval      bmugrp = bdugrp
3.31 c                   eval      bmlvre = bdlvre
      *
     c                   write     bmdtlur
     c                   endif
      *
     c                   goto      startl
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Henter inn fra         BUTIKK-BONG-HODE-REGISTER
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     bohel1_key    chain     bohel1r                            90
      *
      * Legger ut igjen bong til registeret
      *
     c     bmhelu_key    chain     bmhelur                            90
     c                   if        *in90 = *on
     c                   eval      bnfirm = w_firm
     c                   eval      bnaarr = bmhelu_aarr
     c                   eval      bnwsid = bmhelu_wsid
     c                   eval      bnnumm = bmhelu_numm
      *
      * Legger over opplysninger
      *
     c                   eval      bnotyp = bootyp
     c                   eval      bnlage = bolage
3.32 c                   eval      bnbinr = bobinr
     c                   eval      bnkref = bokref
     c                   eval      bnbdat = bobdat
     c                   eval      bnldat = boldat
     c                   eval      bnfkda = bofkda
     c                   eval      bnffda = boffda
     c                   eval      bnbetb = bobetb
     c                   eval      bnselg = boselg
     c                   eval      bndist = bodist
     c                   eval      bnlmat = bolmat
     c                   eval      bnlbet = bolbet
     c                   eval      bnvalk = bovalk
     c                   eval      bnrkat = borkat
     c                   eval      bnsped = bosped
     c                   eval      bnkjor = bokjor
     c                   eval      bnmkod = bomkod
     c                   eval      bnlkun = bolkun
     c                   eval      bnkund = bokund
     c                   eval      bnkuna = bokuna
     c                   eval      bnnavn = bonavn
     c                   eval      bnadr1 = boadr1
     c                   eval      bnadr2 = boadr2
     c                   eval      bnsted = bosted
     c                   eval      bnavde = boavde
     c                   eval      bnkont = bokont
     c                   eval      bnspes = bospes
     c                   eval      bnproj = boproj
     c                   eval      bnakti = boakti
     c                   eval      bnkgfa = bokgfa
     c                   eval      bnvref = bovref
     c                   eval      bndref = bodref
     c                   eval      bnrekv = borekv
     c                   eval      bnlmtx = bolmtx
     c                   eval      bnlbtx = bolbtx
     c                   eval      bnrabp = borabp
     c                   eval      bnornr = *zero
     c                   eval      bnorsu = *zero
     c                   eval      bnpord = bopord
     c                   eval      bnpsuf = bopsuf
     c                   eval      bnmott = *zero
     c                   eval      bntotx = bototx
     c                   eval      bntotb = bototb
     c                   eval      bntots = botots
     c                   eval      bndate = bodate
     c                   eval      bntime = botime
3.34 c                   eval      bnneto = boneto
      *
     c                   write     bmhelur
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
3.32  *
3.32  * Sett tilbake parameter,
3.32  * før avslutning av program
3.32  *
3.32 c                   if        p_retu = '6'
3.32 c                   eval      p_retu = ' '
3.32 c                   endif
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *inzsr        begsr
      *
     c                   eval      w_alf1 = *blank
      *
      * Key for file : BUTIKK-BONG-HODE-REGISTER
      *
     c     bohel1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bohel1_aarr
     c                   kfld                    bohel1_wsid
     c                   kfld                    bohel1_numm
      *
      * Key for file : BUTIKK-BONG-LINJE-REGISTER
      *
     c     bodtl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bodtl1_aarr
     c                   kfld                    bodtl1_wsid
     c                   kfld                    bodtl1_numm
     c                   kfld                    bodtl1_line
      *
      * Key for file : BONG-HODE-REGISTER
      *
     c     bmhelu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bmhelu_aarr
     c                   kfld                    bmhelu_wsid
     c                   kfld                    bmhelu_numm
      *
      * Key for file : BONG-LINJE-REGISTER
      *
     c     bmdtlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bmdtlu_aarr
     c                   kfld                    bmdtlu_wsid
     c                   kfld                    bmdtlu_numm
     c                   kfld                    bmdtlu_line
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     *entry        plist
     c                   parm                    p_retu
     c                   parm                    p_firm
     c                   parm                    p_aarr
     c                   parm                    p_wsid
     c                   parm                    p_aar2
     c                   parm                    p_wsd2
     c                   parm                    p_num2
      *
      * Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = p_firm
      *
      * Legger inn årstall og skjerm/kasse inn i nøkklene
      *
3.41 c                   eval      bohel1_aarr = p_aar2
3.33 c                   eval      bohel1_wsid = p_wsd2
5.30 c*                  eval      bohel1_numm = p_num2
5.30 c                   movel     p_num2        bohel1_numm
      *
3.41 c                   eval      bodtl1_aarr = p_aar2
3.33 c                   eval      bodtl1_wsid = p_wsd2
5.30 c*                  eval      bodtl1_numm = p_num2
5.30 c                   movel     p_num2        bodtl1_numm
     c                   eval      bodtl1_line = *zero
      *
3.41 c                   eval      bmhelu_aarr = p_aar2
     c                   eval      bmhelu_wsid = p_wsid
     c                   eval      bmhelu_numm = *zero
      *
3.41 c                   eval      bmdtlu_aarr = p_aar2
     c                   eval      bmdtlu_wsid = p_wsid
     c                   eval      bmdtlu_numm = *zero
     c                   eval      bmdtlu_line = *zero
3.32  *
3.32  * Dersom dette er innhenting pga uskrift,
3.32  * skal opprinnelig bongnummer være med tilbake
3.32  *
3.32 c                   if        p_retu = '6'
3.32 c                   eval      bmhelu_numm = p_num2
3.32 c                   eval      bmdtlu_numm = p_num2
3.32 c                   endif
3.32  *
     c                   endsr
