      /TITLE    Oppdatering av regnskap/reskontro
     h datedit(*dmy.) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RF110R                                              *
      * Beskrivelse . . : Oppdatering av regnskap/reskontro                   *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
T5.00 * R5.00     040803  Firma ble ikke lagt ut på nye poster i RPSAPF  HFL
T5.00 * R5.00     051103  RQTYPE = 5 for mengde.                         HFL
      * R5.20     100903  Lagt inn nytt felt RJLFAK - lev.fakturanr.     KOB  *
      * R5.20     171103  Rettet feil vedr mengde/mengdekode             KOB  *
      * R5.20     110204  Legger ut ny record for sist brukte nr. dersom KOB  *
      *                   den ikke finnes ved første journal på nytt år  KOB  *
      * R5.30     250804  Legger ut mengdekode i RHTRPF.                 HFL  *
      * R5.40     160306  Legger ut aktivitet i RHTRPF.                  HFL  *
      * R5.50     060307  Kid-info. legges uti RKTRPF.                   HFL  *
      * R5.60     050108  Endret fra raa4l1 til raa4lu                   KOB  *
      * R5.60     050108  Endret rutinen for sist brukte verdier nytt år KOB  *
6.11  * R6.10     280909  Lagt inn sporingsinformasjon                   BSA  *
6.12  * R6.10     060510  Endret sporingsinformasjon                     BSA  *
6.20  * R6.20     251110  Pros er nå alfa. legger ut underprosj. og arb  NHO  *
6.20  *                   ordre                                               *
6.21  * R6.21     280912  Justert feilmeling vedr klienten.              NHO  *
6.nu  * R6.20     280515  Utvidelse av kort kid  (Kompileres)            NHO  *
6.30  * R6.30     090117  Rettet oppdatering av opprettet/oppgjørsdato   SST  *
6.31  * R6.30     030719  Endret sal til 15 2                            SST  *
6.32  * R6.30     071019  rjpros kan være alfa                           bkv  *
7.01  *K00        060720  lagt på return + ab705r  + switchstyring       bof  *
      *
7.fb  * R7.00     260117  Hvis depositumsinnbetaling, så oppdat SDEPPF   bof  *
8.00  *K00        010322  Ikke sjekke depositum på transer fra compello  sst  *
8.01  *           010822  Hvis ikke NX Øksystem, så ikke akkumuler saldo bof  *
8.02  *           181022  Lagt inn tilsvarende som i 8.01 på kunder      ask  *
8.03  *           101122  8.02 er midlertidig fjernet intil funksjon avklart ask
      *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
610  frjoupf    uf   e           k disk
     frkunlr    if   e           k disk    rename(rkunpfr:rkunlrr)
     frkunlu    uf   e           k disk    rename(rkunpfr:rkunlur)
     frlevlr    if   e           k disk    rename(rlevpfr:rlevlrr)
     frlevlu    uf   e           k disk    rename(rlevpfr:rlevlur)
     frhovlr    if   e           k disk    rename(rhovpfr:rhovlrr)
6.20 f*rprol1    if   e           k disk    rename(rpropfr:rprol1r)
     fra01l1    if   e           k disk    rename(ra01pfr:ra01l1r)
     fraa1l1    if   e           k disk    rename(raa1pfr:raa1l1r)
8.01 ffstsl1    if   e           k disk    rename(fstspfr:fstsl1r)
     fraa4lu    uf a e           k disk    rename(raa4pfr:raa4lur)
     frhsalu    uf a e           k disk    rename(rhsapfr:rhsalur)
6.20 f*psalu    uf a e           k disk    rename(rpsapfr:rpsalur)
     frhtrlu    o    e           k disk    rename(rhtrpfr:rhtrlur)
6.20 f*rptrlu    o    e           k disk    rename(rptrpfr:rptrlur)
     frktrlu    o    e           k disk    rename(rktrpfr:rktrlur)
     frltrlu    o    e           k disk    rename(rltrpfr:rltrlur)
      *
6.31 d*sal             s             11  2 dim(14)
6.31 d sal             s             15  2 dim(14)
      *
      * Definering av local data area
      *
     d                uds
     d l_user                911    920
7.01 d l_filg                931    933
     d l_firm                944    946  0
      *
      * Definering av nøkkelfelt
      *
     d rkunlr_kund     s                   like(rkkund)
     d rkunlu_kund     s                   like(rkkund)
      *
     d rlevlr_levr     s                   like(rllevr)
     d rlevlu_levr     s                   like(rllevr)
      *
6.20 d*rpropf_pros     s                   like(rppros)
6.20 d*rpropf_akti     s                   like(rpakti)
6.20 d*rpropf_kont     s                   like(rpkont)
6.20 d*rpropf_spes     s                   like(rpspes)
      *
6.20 d*rprol1_pros     s                   like(rppros)
6.20 d*rprol1_akti     s                   like(rpakti)
6.20 d*rprol1_kont     s                   like(rpkont)
6.20 d*rprol1_spes     s                   like(rpspes)
      *
6.20 d*rpsapf_pros     s                   like(rqpros)
6.20 d*rpsapf_akti     s                   like(rqakti)
6.20 d*rpsapf_raar     s                   like(rqraar)
6.20 d*rpsapf_kont     s                   like(rqkont)
6.20 d*rpsapf_spes     s                   like(rqspes)
6.20 d*rpsapf_type     s                   like(rqtype)
      *
6.20 d*rpsalu_pros     s                   like(rqpros)
6.20 d*rpsalu_akti     s                   like(rqakti)
6.20 d*rpsalu_raar     s                   like(rqraar)
6.20 d*rpsalu_kont     s                   like(rqkont)
6.20 d*rpsalu_spes     s                   like(rqspes)
6.20 d*rpsalu_type     s                   like(rqtype)
      *
     d rhovlr_kont     s                   like(rhkont)
     d rhovlr_spes     s                   like(rhspes)
     d rhovlr_avde     s                   like(rhavde)
      *
     d rhsapf_kont     s                   like(rikont)
     d rhsapf_spes     s                   like(rispes)
     d rhsapf_avde     s                   like(riavde)
     d rhsapf_raar     s                   like(riraar)
     d rhsapf_type     s                   like(ritype)
      *
     d rhsalu_kont     s                   like(rikont)
     d rhsalu_spes     s                   like(rispes)
     d rhsalu_avde     s                   like(riavde)
     d rhsalu_raar     s                   like(riraar)
     d rhsalu_type     s                   like(ritype)
      *
     d ra01l1_akod     s                   like(raakod)
     d raa4lu_4aar     s                   like(ra4aar)
      *
     d iy              s              2  0
610  d w_nivo          s                   like(rjnivo)
610  d w_memb          s                   like(rjmemb)
610  d w_mem1          s                   like(rjmemb)
610  d w_rjfirm        s                   like(rjfirm)
610  d w_sort          s                   like(rjsort)
610  d w_rjraar        s                   like(rjraar)
6.20 d w_jkey          s             41
6.20 d w_jnav          s             15
6.20 d w_jsta          s              2  0
6.20 d w_jmld          s            200
6.20 d w_stat          s              1  0
6.20 d w_klient        s              1
7.fb d w_bilk          s                   like(rjbilk)
7.fb d w_text          s                   like(rjtext)
     d w_jour          s              5  0
     d tbelØr          s             11  2
     d tvalØr          s             11  2
     d w_kjØf          s             11  2
     d w_kjØp          s             11  2
     d w_saif          s             11  2
     d w_sald          s             11  2
      *
     d w_firm          s                   like(rjfirm)
     d w_kont          s              6  0
     d w_spes          s              2  0
     d w_avde          s              4  0
     d w_mvak          s              1
     d w_tdat          s               d   datfmt(*iso)
      *
      * Definering av variable for timestamp
      *
     d w_tmst          s               z
     d w_tmst_20       s             20
     d w_tell          s              6  0
     d w_tell_alf      s              6
      *
6.32 d c_numm          c                   '0123456789 '
      *
7.01   dcl-s co402_verdi1  char(1);
7.01   dcl-s co402_verdi2  char(2048);
7.01   DCL-PR CO402R EXTPGM('CO402R');
7.01     p_filgrp            char(3)     const;
7.01     p_firm              packed(3:0) const;
7.01     p_lager             packed(2:0) const;
7.01     p_nokkel            char(50)    const;
7.01     p_verdi1            char(1);
7.01     p_verdi2            char(2048);
7.01   END-PR;
7.01 d u_logg          s              1    inz(*off)                            logging ajltpf
      *
     c/eject
7.01 c                   if        u_logg = *on
7.01 c                   eval      w_jsta = 10
7.01 c                   eval      w_jmld = 'Start RF110R        '
7.01 c                   eval      w_jnav = 'OKON_RF110R-'
7.01 c                   call      'AB700R'
7.01 c                   parm                    w_jnav
7.01 c                   parm                    w_jkey
7.01 c                   parm                    w_jmld
7.01 c                   eval      w_jsta = 10
7.01 c                   eval      w_jmld = 'Start RF110R       '
7.01 c                   call      'AB705R'
7.01 c                   parm                    w_jkey
7.01 c                   parm                    w_jsta
7.01 c                   parm                    w_jmld
7.01 c                   endif
7.01  *
610  c                   move      *blank        w_nivo
610  c                   eval      w_memb = w_mem1
610  c     rjoupf_key    setll     rjoupf
610   *
      *
     c     dummy         tag
      *
610  c                   read      rjoupf                                 60
      *
610  c                   if        rjmemb <> w_mem1
7.01 c                   if        u_logg = *on
7.01 c                   eval      w_jsta = 10
7.01 c                   eval      w_jmld = 'Slutt RF110R før LR'
7.01 c                   call      'AB705R'
7.01 c                   parm                    w_jkey
7.01 c                   parm                    w_jsta
7.01 c                   parm                    w_jmld
7.01 c                   endif
7.01  *
610  c                   eval      *inlr = '1'
610  c                   goto      slutt1
610  c                   endif
610   *
610  c                   if        *in60 = '1'
7.01 c                   if        u_logg = *on
7.01 c                   eval      w_jmld = 'Slutt RF110R før LR'
7.01 c                   call      'AB705R'
7.01 c                   parm                    w_jkey
7.01 c                   parm                    w_jsta
7.01 c                   parm                    w_jmld
7.01 c                   endif
7.01  *
7.01 c                   eval      *inlr = '1'
610  c                   goto      slutt1
610  c                   endif
610  c                   if        w_rjfirm <> rjfirm
     c                   move      rjfirm        w_firm
610  c                   move      rjfirm        w_rjfirm
     c                   endif
      *
      * Brudd på regnskapsår
      *
610  c                   if        w_rjraar <> rjraar
     c                   exsr      brd_raar
610  c                   move      rjraar        w_rjraar
     c                   endif
      *
     c                   eval      iy = rjrper
      *
610   *
      * Nullstill felt
      *
     c                   eval      w_sald = 0
     c                   eval      w_saif = 0
     c                   eval      w_kjØp = 0
     c                   eval      w_kjØf = 0
      *
     c                   move      rjneto        tbelØr
     c                   move      rjvalb        tvalØr
      *
      * Hent opp bilagskode for oppdatering av kjøp iår/ifjor
      *
     c                   move      rjbilk        ra01l1_akod
     c     ra01l1_key    chain     ra01l1                             61
      *
     c                   move      rjfirm        w_firm
     c                   move      rjavde        w_avde
     c                   move      rjkont        w_kont
     c                   move      rjspes        w_spes
     c                   move      rjmvak        w_mvak
      *
      * Hovedrutine for oppdatering
      *
     c                   select
      *
     c                   when      rjreid = 'H'
     c                   exsr      opd_hovb
      *
     c                   when      rjreid = 'K'
     c                   exsr      opd_kund
      *
     c                   when      rjreid = 'L'
     c                   exsr      opd_levr
      *
     c                   endsl
      *
     c                   if        rjreid = 'H' and
6.20 c**                           rjpros <> *zeros
6.20 c                             rjpros <> *blank
     c                   exsr      opd_pro
     c                   endif
      *
     c                   if        rjopdt = 'K'
     c                   eval      tbelØr = rjrstb
     c                   eval      tvalØr = rjrstv
     c                   endif
      *
     c     slutt         tag
      *
     c/space 3
      *
      * Oppdater postering
      *
     c                   move      'U'           rjopdt
     c                   eval      rjjour = w_jour
610  c                   time                    rjedat
610  c                   time                    rjetim
     c                   update    rjoupfr
      *
610   *
610  c                   goto      dummy
     c/eject
     c     slutt1        tag
7.01 c                   if        u_logg = *on
7.01 c                   eval      w_jsta = 10
7.01 c                   eval      w_jmld = 'Slutt RF110R etter LR'
7.01 c                   call      'AB705R'
7.01 c                   parm                    w_jkey
7.01 c                   parm                    w_jsta
7.01 c                   parm                    w_jmld
7.01 c                   endif
7.01 c                   return
      *
      * Subrutine for oppdatering av hovedbok
      *
     c     opd_hovb      begsr
      *
      * Oppdater hovedbok (beløp)
      *
     c                   eval      sal = *zeros
      *
     c                   exsr      opd_hovb_bel
      *
      * Oppdater hovedbok (mengde)
      *
     c                   if        rjmngd > 0 and
     c                             rhmngd <> 0
     c                   move      rhmngd        rjmngd
     c                   eval      sal = *zeros
     c                   exsr      opd_hovb_mng
     c                   endif
      *
     c                   endsr
      /eject
      *
      *  Subrutine for oppdatering av kundereskontro
      *
     c     opd_kund      begsr
      *
      * Hent avdeling fra kunde hvis ikke utfylt
      *
     c                   eval      rkunlr_kund = w_kont
     c     rkunlr_key    chain     rkunlr                             73
      *
     c                   if        rjavde = *zeros
     c                   eval      rjavde = rkavde
     c                   endif
      *
      * Oppdater kundposteringer
      *
     c                   exsr      opd_kund_tra
      *
8.03 c*                  if        faak03 = 0
     c                   eval      w_sald = rksald
     c                   eval      w_saif = rksaif
     c                   eval      w_kjØp = rkkjØp
     c                   eval      w_kjØf = rkkjØf
8.03 c*                  endif
      *
      * Oppdater saldi/kjøp iår/ifjor
      *
     c                   eval      w_sald = w_sald + rjneto
      *
     c                   if        rjraar = *year
      *
     c                   if        raakjØ = '1'
     c                   eval      w_kjØp = w_kjØp + rjneto
     c                   endif
      *
     c                   else
      *
     c                   eval      w_saif = w_saif + rjneto
      *
     c                   if        raakjØ = '1'
     c                   eval      w_kjØf = w_kjØf + rjneto
     c                   endif
      *
     c                   endif
      *
      * Oppdater kunder
      *
     c                   eval      rkunlu_kund = rjkont
     c     rkunlu_key    chain     rkunlu                             73
      *
     c                   eval      rktdat = w_tdat
8.03 c*                  if        faak03 = 0
     c                   eval      rksald = w_sald
     c                   eval      rksaif = w_saif
     c                   eval      rkkjØp = w_kjØp
     c                   eval      rkkjØf = w_kjØf
8.03 c*                  endif
6.11 c*                  time                    rkedat
6.11 c*                  time                    rketim
6.11 c*                  eval      rkesig = l_user
6.12 c                   time                    rk2dpt
6.12 c                   eval      rkepgm = 'RF110R    '
     c                   update    rkunlur
      *
     c                   endsr
      *
      /eject
      *
      *  Subrutine for oppdatering av leverandørreskontro
      *
     c     opd_levr      begsr
      *
      * Hent avdeling fra leverandør hvis ikke utfylt
      *
     c                   eval      rlevlr_levr = w_kont
     c     rlevlr_key    chain     rlevlr                             73
      *
     c                   if        rjavde = *zeros
     c                   move      rlavde        rjavde
     c                   endif
      *
      * Oppdater leverandørposteringer
      *
     c                   exsr      opd_levr_tra
      *
     c                   eval      w_sald = rlsald
     c                   eval      w_saif = rlsaif
     c                   eval      w_kjØp = rlkjØp
     c                   eval      w_kjØf = rlkjØf
      *
      * Oppdater saldi/kjøp iår/ifjor
      *
8.03 c*                  if        faak03 = 0
     c                   eval      w_sald = w_sald + rjneto
8.03 c*                  endif
      *
     c                   if        rjraar = *year
      *
     c                   if        raakjØ = '1'
8.03 c*                  if        raakjØ = '1' and
8.03 c*                            faak03 = 0
     c                   eval      w_kjØp = w_kjØp + rjneto
     c                   endif
      *
     c                   else
      *
8.03 c*                  if        faak03 = 0
     c                   eval      w_saif = w_saif + rjneto
8.03 c*                  endif
      *
     c                   if        raakjØ = '1'
8.03 c*                  if        raakjØ = '1' and
8.03 c*                            faak03 = 0
     c                   eval      w_kjØf = w_kjØf + rjneto
     c                   endif
      *
     c                   endif
      *
      * Oppdater leverandørregister
      *
     c                   eval      rlevlu_levr = rjkont
     c     rlevlu_key    chain     rlevlu                             73
      *
     c                   eval      rltdat = w_tdat
8.03 c*                  if        faak03 = 0
     c                   eval      rlsald = w_sald
     c                   eval      rlsaif = w_saif
     c                   eval      rlkjØp = w_kjØp
     c                   eval      rlkjØf = w_kjØf
8.03 c*                  endif
6.10 c*                  time                    rledat
6.10 c*                  time                    rletim
6.10 c*                  eval      rlesig = l_user
6.12 c                   time                    rl2dpt
6.12 c                   eval      rlepgm = 'RF110R    '
     c                   update    rlevlur
      *
     c                   endsr
      *
     c/eject
      *
      * Subrutine for oppdatering av prosjekt
      *
     c     opd_pro       begsr
      *
     c                   move      rjfirm        w_firm
     c                   move      rjavde        w_avde
     c                   move      rjkont        w_kont
     c                   move      rjspes        w_spes
     c                   move      rjmvak        w_mvak
      *
6.20 c*                  move      rjfirm        rpfirm
6.20 c*                  move      rjpros        rppros
6.20 c*                  eval      rpakti = *blank
6.20 c*                  eval      rpkont = *zeros
6.20 c*                  eval      rpspes = *zeros
6.20  *
6.20 c*                  eval      rprol1_pros = rjpros
6.20 c*                  eval      rprol1_akti = rjakti
6.20 c*                  eval      rprol1_kont = rjkont
6.20 c*                  eval      rprol1_spes = rjspes
6.20 c*    rprol1_key    chain     rprol1                             73
6.20  *
6.20 c*                  if        *in73 = *off and
6.20 c*                            rprakt = 'N'
6.20 c*                  eval      rjakti = *blank
6.20 c*                  endif
      *
     c                   eval      sal = *zeros
      *
     c                   exsr      opdpro
      *
     c                   endsr
      *
      /eject
      *
      * Oppdaterer konto og hovtra
      *
     c     opd_hovb_bel  begsr
      *
     c                   eval      rhsalu_kont = rjkont
     c                   eval      rhsalu_spes = rjspes
     c                   eval      rhsalu_avde = rjavde
     c                   eval      rhsalu_raar = rjraar
     c                   eval      rhsalu_type = 1
     c     rhsalu_key    chain     rhsalu                             73
      *
     c                   if        *in73 = *off
     c                   eval      sal(1) = sal(1) + risa01
     c                   eval      sal(2) = sal(2) + risa02
     c                   eval      sal(3) = sal(3) + risa03
     c                   eval      sal(4) = sal(4) + risa04
     c                   eval      sal(5) = sal(5) + risa05
     c                   eval      sal(6) = sal(6) + risa06
     c                   eval      sal(7) = sal(7) + risa07
     c                   eval      sal(8) = sal(8) + risa08
     c                   eval      sal(9) = sal(9) + risa09
     c                   eval      sal(10) = sal(10) + risa10
     c                   eval      sal(11) = sal(11) + risa11
     c                   eval      sal(12) = sal(12) + risa12
     c                   eval      sal(13) = sal(13) + risa13
     c                   eval      sal(14) = sal(14) + risa00
     c                   endif
      *
     c                   if        rjbilk = 98
     c                   if        *in73 = *on
     c                   eval      sal(14) = rjneto
     c                   else
     c                   eval      sal(14) = sal(14) + rjneto
     c                   endif
     c                   endif
      *
     c                   if        rjbilk <> 98
     c                   if        *in73 = *on
     c                   eval      sal(iy) = rjneto
     c                   else
     c                   eval      sal(iy) = sal(iy) + rjneto
     c                   endif
     c                   endif
      *
     c                   eval      risa01 = sal(1)
     c                   eval      risa02 = sal(2)
     c                   eval      risa03 = sal(3)
     c                   eval      risa04 = sal(4)
     c                   eval      risa05 = sal(5)
     c                   eval      risa06 = sal(6)
     c                   eval      risa07 = sal(7)
     c                   eval      risa08 = sal(8)
     c                   eval      risa09 = sal(9)
     c                   eval      risa10 = sal(10)
     c                   eval      risa11 = sal(11)
     c                   eval      risa12 = sal(12)
     c                   eval      risa13 = sal(13)
     c                   eval      risa00 = sal(14)
      *
     c                   eval      rbraar = rjraar
     c                   eval      rbfirm = rjfirm
     c                   eval      rbkont = rjkont
     c                   eval      rbspes = rjspes
     c                   eval      rbavde = rjavde
      *
     c                   if        rjbilk = 98
     c                   eval      rbrper = *zeros
     c                   else
     c                   eval      rbrper = rjrper
     c                   endif
      *
     c                   eval      rbmvap = *zeros
     c                   eval      rbbiln = rjbiln
     c                   eval      rbbilk = rjbilk
     c                   eval      rbtext = rjtext
     c                   eval      rbneto = rjneto
     c                   eval      rbmvag = rjmvag
     c                   eval      rbmvab = rjmvab
     c                   eval      rbinvb = 0 - rjiavg
     c                   eval      rbrmrk = *blank
     c                   eval      rbmvak = rjmvak
     c                   eval      rbamva = rjamva
     c                   eval      rbpmva = rjpmva
     c                   eval      rbmvap = rjmvap
     c                   eval      rbmmrk = rjmmrk
     c                   eval      rbhmrk = *blank
     c                   move      rjtype        rbautk
     c                   eval      rbmvao = rjstar
     c                   eval      rbjour = w_jour
     c                   eval      rbbdat = rjbdat
     c                   eval      rbvalk = rjvalk
     c                   eval      rbvalb = rjvalb
     c                   eval      rbmngd = rjmngd
E5.30c                   eval      rbmngk = rjmngk
6.31 c                   if        %check(c_numm:rjpros) = 0
     c                   move      rjpros        rbpros
6.31 c                   else
6.31 c                   eval      rbpros = *zero
6.31 c                   endif
E5.40c                   eval      rbakti = rjakti
6.20 c                   eval      rbupro = rjupro
6.20 c                   eval      rbarbo = rjarbo
6.20 c                   eval      rbhpro = rjpros
     c                   eval      rbavst = *blank
     c                   move      rjbref        rbbref
T5.20c                   eval      rblfak = rjlfak
T5.20c                   eval      rbspor = rjspor
      *
      * Teller/Timestamp
      *
     c                   eval      w_tell = w_tell + 1
     c                   move      w_tell        w_tell_alf
     c                   time                    rntist
     c     *iso0         move      rntist        w_tmst_20
     c                   move      w_tell_alf    w_tmst_20
     c     *iso0         move      w_tmst_20     rbtist
      *
6.11 c                   time                    rbodat
6.11 c                   time                    rbotim
6.11 c                   eval      rbousr = l_user
6.11 c                   time                    rbedat
6.11 c                   time                    rbetim
6.11 c                   eval      rbeusr = l_user
     c                   write     rhtrlur
      *
6.11 c                   time                    riedat
6.11 c                   time                    rietim
6.11 c                   eval      rieusr = l_user
     c                   if        *in73 = *on
     c                   eval      rifirm = rjfirm
     c                   eval      rikont = rjkont
     c                   eval      rispes = rjspes
     c                   eval      riavde = rjavde
     c                   eval      riraar = rjraar
     c                   eval      ritype = 1
6.11 c                   time                    riodat
6.11 c                   time                    riotim
6.11 c                   eval      riousr = l_user
     c                   write     rhsalur
     c                   else
     c                   update    rhsalur
     c                   endif
      *
     c                   endsr
      /eject
      *
      * Oppdater kontoregister med mengde
      *
     c     opd_hovb_mng  begsr
      *
     c                   eval      rhsalu_kont = rjkont
     c                   eval      rhsalu_spes = rjspes
     c                   eval      rhsalu_avde = rjavde
     c                   eval      rhsalu_raar = rjraar
     c                   eval      rhsalu_type = 5
     c     rhsalu_key    chain     rhsalu                             73
      *
     c                   if        *in73 = *off
     c                   eval      sal(1) = sal(1) + risa01
     c                   eval      sal(2) = sal(2) + risa02
     c                   eval      sal(3) = sal(3) + risa03
     c                   eval      sal(4) = sal(4) + risa04
     c                   eval      sal(5) = sal(5) + risa05
     c                   eval      sal(6) = sal(6) + risa06
     c                   eval      sal(7) = sal(7) + risa07
     c                   eval      sal(8) = sal(8) + risa08
     c                   eval      sal(9) = sal(9) + risa09
     c                   eval      sal(10) = sal(10) + risa10
     c                   eval      sal(11) = sal(11) + risa11
     c                   eval      sal(12) = sal(12) + risa12
     c                   eval      sal(13) = sal(13) + risa13
     c                   eval      sal(14) = sal(14) + risa00
     c                   endif
      *
     c                   if        rjbilk = 98
     c                   if        *in73 = *on
     c                   eval      sal(14) = rjmngd
     c                   else
     c                   eval      sal(14) = sal(14) + rjmngd
     c                   endif
     c                   endif
      *
     c                   if        rjbilk <> 98
     c                   if        *in73 = *on
     c                   eval      sal(iy) = rjmngd
     c                   else
     c                   eval      sal(iy) = sal(iy) + rjmngd
     c                   endif
     c                   endif
      *
     c                   eval      risa01 = sal(1)
     c                   eval      risa02 = sal(2)
     c                   eval      risa03 = sal(3)
     c                   eval      risa04 = sal(4)
     c                   eval      risa05 = sal(5)
     c                   eval      risa06 = sal(6)
     c                   eval      risa07 = sal(7)
     c                   eval      risa08 = sal(8)
     c                   eval      risa09 = sal(9)
     c                   eval      risa10 = sal(10)
     c                   eval      risa11 = sal(11)
     c                   eval      risa12 = sal(12)
     c                   eval      risa13 = sal(13)
     c                   eval      risa00 = sal(14)
      *
6.11 c                   time                    riedat
6.11 c                   time                    rietim
6.11 c                   eval      rieusr = l_user
     c                   if        *in73 = *on
     c                   eval      rifirm = rjfirm
     c                   eval      rikont = rjkont
     c                   eval      rispes = rjspes
     c                   eval      riavde = rjavde
     c                   eval      riraar = rjraar
     c                   eval      ritype = 5
6.11 c                   time                    riodat
6.11 c                   time                    riotim
6.11 c                   eval      riousr = l_user
     c                   write     rhsalur
     c                   else
     c                   update    rhsalur
     c                   endif
      *
     c                   endsr
      /eject
      *
      * Oppdater prosjekt og protra
      *
     c     opdpro        begsr
      *
6.20 c*                  eval      rpsalu_pros = rjpros
6.20 c*                  eval      rpsalu_akti = rjakti
6.20 c*                  eval      rpsalu_raar = rjraar
6.20 c*                  eval      rpsalu_kont = rjkont
6.20 c*                  eval      rpsalu_spes = rjspes
6.20 c*                  eval      rpsalu_type = 1
6.20 c*    rpsalu_key    chain     rpsalu                             73
6.20  *
6.20 c*                  if        *in73 = *off
6.20 c*                  eval      sal(1) = sal(1) + rqsa01
6.20 c*                  eval      sal(2) = sal(2) + rqsa02
6.20 c*                  eval      sal(3) = sal(3) + rqsa03
6.20 c*                  eval      sal(4) = sal(4) + rqsa04
6.20 c*                  eval      sal(5) = sal(5) + rqsa05
6.20 c*                  eval      sal(6) = sal(6) + rqsa06
6.20 c*                  eval      sal(7) = sal(7) + rqsa07
6.20 c*                  eval      sal(8) = sal(8) + rqsa08
6.20 c*                  eval      sal(9) = sal(9) + rqsa09
6.20 c*                  eval      sal(10) = sal(10) + rqsa10
6.20 c*                  eval      sal(11) = sal(11) + rqsa11
6.20 c*                  eval      sal(12) = sal(12) + rqsa12
6.20 c*                  eval      sal(13) = sal(13) + rqsa13
6.20 c*                  eval      sal(14) = sal(14) + rqsa00
6.20 c*                  endif
6.20  *
6.20 c*                  if        *in73 = *on
6.20 c*                  eval      rqfirm = rjfirm
6.20 c*                  eval      rqpros = rjpros
6.20 c*                  eval      rqakti = rjakti
6.20 c*                  eval      rqraar = rjraar
6.20 c*                  eval      rqkont = rjkont
6.20 c*                  eval      rqspes = rjspes
6.20 c*                  eval      rqtype = 1
6.20 c*                  eval      rqsa14 = *zeros
6.20 c*                  eval      rqstdp = *zeros
6.20 c*                  endif
6.20  *
6.20 c*                  if        rjbilk = 98
6.20 c*                  if        *in73 = *on
6.20 c*                  eval      sal(14) = rjneto
6.20 c*                  else
6.20 c*                  eval      sal(14) = sal(14) + rjneto
6.20 c*                  endif
6.20 c*                  endif
6.20  *
6.20 c*                  if        rjbilk <> 98
6.20 c*                  if        *in73 = *on
6.20 c*                  eval      sal(iy) = rjneto
6.20 c*                  else
6.20 c*                  eval      sal(iy) = sal(iy) + rjneto
6.20 c*                  endif
6.20 c*                  endif
6.20  *
6.20 c*                  eval      rqsa01 = sal(1)
6.20 c*                  eval      rqsa02 = sal(2)
6.20 c*                  eval      rqsa03 = sal(3)
6.20 c*                  eval      rqsa04 = sal(4)
6.20 c*                  eval      rqsa05 = sal(5)
6.20 c*                  eval      rqsa06 = sal(6)
6.20 c*                  eval      rqsa07 = sal(7)
6.20 c*                  eval      rqsa08 = sal(8)
6.20 c*                  eval      rqsa09 = sal(9)
6.20 c*                  eval      rqsa10 = sal(10)
6.20 c*                  eval      rqsa11 = sal(11)
6.20 c*                  eval      rqsa12 = sal(12)
6.20 c*                  eval      rqsa13 = sal(13)
6.20 c*                  eval      rqsa00 = sal(14)
6.20  *
6.20  * PROTRA ....
6.20  *
6.20 c*                  eval      rdfirm = rjfirm
6.20 c*                  eval      rdpros = rjpros
6.20 c*                  eval      rdakti = rjakti
6.20 c*                  eval      rdraar = rjraar
6.20 c*                  eval      rdkont = rjkont
6.20 c*                  eval      rdspes = rjspes
6.20 c*                  eval      rdavde = rjavde
6.20 c*                  eval      rdbiln = rjbiln
6.20 c*                  eval      rdbilk = rjbilk
6.20 c*                  eval      rdtext = rjtext
6.20 c*                  eval      rdneto = rjneto
6.20  *
6.20 c*                  if        rjbilk = 98
6.20 c*                  eval      rbrper = *zeros
6.20 c*                  else
6.20 c*                  eval      rdrper = rjrper
6.20 c*                  endif
6.20  *
6.20 c*                  eval      rdjour = w_jour
6.20 c*                  eval      rdbdat = rjbdat
6.20 c*                  eval      rdresn = rjresn
6.20 c*                  eval      rdmngd = rjmngd
6.20 c*                  eval      rdmngk = rjmngk
6.20  *
6.20  * Teller/Timestamp
6.20  *
6.20 c*                  eval      w_tell = w_tell + 1
6.20 c*                  move      w_tell        w_tell_alf
6.20 c*                  time                    rntist
6.20 c*    *iso0         move      rntist        w_tmst_20
6.20 c*                  move      w_tell_alf    w_tmst_20
6.20 c*    *iso0         move      w_tmst_20     rdtist
6.20  *
6.20 c*                  time                    rdodat
6.20 c*                  time                    rdotim
6.20 c*                  eval      rdousr = l_user
6.20 c*                  time                    rdedat
6.20 c*                  time                    rdetim
6.20 c*                  eval      rdeusr = l_user
6.20 c*                  write     rptrlur
6.20  *
6.20 c*                  time                    rqedat
6.20 c*                  time                    rqetim
6.20 c*                  eval      rqeusr = l_user
6.20 c*                  if        *in73 = *on
6.20 c*                  time                    rqodat
6.20 c*                  time                    rqotim
6.20 c*                  eval      rqousr = l_user
6.20 c*                  write     rpsalur
6.20 c*                  else
6.20 c*                  update    rpsalur
6.20 c*                  endif
6.20  *
6.20 c*                  if        rjmngd = 0
6.20 c*                  goto      proput
6.20 c*                  endif
6.20  *
6.20  * Oppdater prosjektsaldo - mengde
6.20  *
6.20 c*                  eval      sal = *zeros
6.20  *
6.20 c*                  move      5             rqtype
6.200c*                  eval      rpsalu_type = 5
6.20 c*    rpsalu_key    chain     rpsalu                             73
6.20  *
6.20 c*                  if        *in73 = *off
6.20 c*                  eval      sal(1) = sal(1) + rqsa01
6.20 c*                  eval      sal(2) = sal(2) + rqsa02
6.20 c*                  eval      sal(3) = sal(3) + rqsa03
6.20 c*                  eval      sal(4) = sal(4) + rqsa04
6.20 c*                  eval      sal(5) = sal(5) + rqsa05
6.20 c*                  eval      sal(6) = sal(6) + rqsa06
6.20 c*                  eval      sal(7) = sal(7) + rqsa07
6.20 c*                  eval      sal(8) = sal(8) + rqsa08
6.20 c*                  eval      sal(9) = sal(9) + rqsa09
6.20 c*                  eval      sal(10) = sal(10) + rqsa10
6.20 c*                  eval      sal(11) = sal(11) + rqsa11
6.20 c*                  eval      sal(12) = sal(12) + rqsa12
6.20 c*                  eval      sal(13) = sal(13) + rqsa13
6.20 c*                  eval      sal(14) = sal(14) + rqsa00
6.20 c*                  endif
6.20  *
6.20 c*                  if        *in73 = *on
6.20 c*                  eval      rqsa14 = *zeros
6.20 c*                  eval      rqstdp = *zeros
6.20 c*                  endif
6.20  *
6.20 c*                  if        rjbilk = 98
6.20 c*                  if        *in73 = *on
6.20 c*                  eval      sal(14) = rjmngd
6.20 c*                  else
6.20 c*                  eval      sal(14) = sal(14) + rjmngd
6.20 c*                  endif
6.20 c*                  endif
6.20  *
6.20 c*                  if        rjbilk <> 98
6.20 c*                  if        *in73 = *on
6.20 c*                  eval      sal(iy) = rjmngd
6.20 c*                  else
6.20 c*                  eval      sal(iy) = sal(iy) + rjmngd
6.20 c*                  endif
6.20 c*                  endif
6.20  *
6.20 c*                  eval      rqsa01 = sal(1)
6.20 c*                  eval      rqsa02 = sal(2)
6.20 c*                  eval      rqsa03 = sal(3)
6.20 c*                  eval      rqsa04 = sal(4)
6.20 c*                  eval      rqsa05 = sal(5)
6.20 c*                  eval      rqsa06 = sal(6)
6.20 c*                  eval      rqsa07 = sal(7)
6.20 c*                  eval      rqsa08 = sal(8)
6.20 c*                  eval      rqsa09 = sal(9)
6.20 c*                  eval      rqsa10 = sal(10)
6.20 c*                  eval      rqsa11 = sal(11)
6.20 c*                  eval      rqsa12 = sal(12)
6.20 c*                  eval      rqsa13 = sal(13)
6.20 c*                  eval      rqsa00 = sal(14)
6.20  *
6.20 c*                  time                    rqedat
6.20 c*                  time                    rqetim
6.20 c*                  eval      rqeusr = l_user
6.20  *
6.20 c*                  if        *in73 = *on
6.200c*                  eval      rqfirm = rjfirm
6.20 c*                  eval      rqpros = rjpros
6.20 c*                  eval      rqakti = rjakti
6.20 c*                  eval      rqraar = rjraar
6.20 c*                  eval      rqkont = rjkont
6.20 c*                  eval      rqspes = rjspes
6.20 c*                  eval      rqtype = 5
6.20 c*                  eval      rqsa14 = *zeros
6.20 c*                  eval      rqstdp = *zeros
6.20 c*                  time                    rqodat
6.20 c*                  time                    rqotim
6.20 c*                  eval      rqousr = l_user
6.20 c*                  write     rpsalur
6.20 c*                  else
6.20 c*                  update    rpsalur
6.20 c*                  endif
      *
     c     proput        endsr
      *
      /eject
      *
      * Oppdater kundereskontro
      *
     c     opd_kund_tra  begsr
      *
7.fb c                   eval      w_bilk = rjbilk
7.fb c                   eval      w_text = rjtext
7.fb c                   if        %subst(rjkidi:8:1) = '4'
8.00 c                             and %subst(rjmemb:4:4) <> 'COMP'
7.fb c                   exsr      depositum
7.fb c                   endif
      *
     c                   eval      rnfirm = rjfirm
     c                   eval      rnkund = rjkont
     c                   eval      rnvalk = rjvalk
     c                   eval      rnantp = *zeros
7.fb c**                 eval      rnbilk = rjbilk
7.fb c                   eval      rnbilk = w_bilk
     c                   eval      rnbelØ = rjneto
     c                   eval      rnrest = rjrstb
     c                   eval      rnbiln = rjbiln
     c                   eval      rnvalb = rjvalb
     c                   eval      rnvalr = rjrstv
     c                   eval      rnraar = rjraar
     c                   eval      rnrper = rjrper
     c                   eval      rnbdat = rjbdat
     c                   eval      rnfdat = rjfdat
     c                   eval      rnjour = w_jour
     c                   eval      rnsamf = *zeros
      *
     c                   if        rjkrys = 'S'
     c                   eval      rnsamf = rjrefn
     c                   endif
      *
     c                   eval      rnrefn = rjrefn
7.fb c**                 eval      rntext = rjtext
7.fb c                   eval      rntext = w_text
     c                   eval      rnvirk = rjvirk
     c                   eval      rninko = *blank
     c                   eval      rnavde = rjavde
     c                   eval      rnslgr = rkslgr
     c                   eval      rnrekl = *blank
      *
T5.50c                   eval      rnkidi = rjkidi
T5.50c                   eval      rnkidr = rjkidr
T5.50c                   eval      rnksif = rjksif
T5.50c                   eval      rnkid2 = rjkid2
T5.50c                   eval      rnspor = rjspor
      *
      * Teller/Timestamp
      *
     c                   eval      w_tell = w_tell + 1
     c                   move      w_tell        w_tell_alf
     c                   time                    rntist
     c     *iso0         move      rntist        w_tmst_20
     c                   move      w_tell_alf    w_tmst_20
     c     *iso0         move      w_tmst_20     rntist
      *
6.30 c*                  time                    rnodat
6.30 c                   time                    rndate
6.11 c                   time                    rnotim
6.11 c                   eval      rnousr = l_user
6.11 c                   time                    rnedat
6.11 c                   time                    rnetim
6.11 c                   eval      rneusr = l_user
     c                   write     rktrlur
      *
     c                   endsr
      /eject
      *
      * Oppdater leverandørreskontro
      *
     c     opd_levr_tra  begsr
      *
     c                   eval      rofirm = rjfirm
     c                   eval      rolevr = rjkont
     c                   eval      rovalk = rjvalk
     c                   eval      roatts = rjatte
     c                   eval      robilk = rjbilk
     c                   eval      robelØ = rjneto
     c                   eval      rorest = rjrstb
     c                   eval      robiln = rjbiln
     c                   eval      rovalb = rjvalb
     c                   eval      rovalr = rjrstv
     c                   eval      robetk = *blank
     c                   eval      roraar = rjraar
     c                   eval      rorper = rjrper
     c                   eval      robdat = rjbdat
     c                   eval      rofdat = rjfdat
     c                   eval      rojour = w_jour
     c                   eval      rosamb = *zeros
      *
     c                   if        rjkrys = 'S'
     c                   eval      rosamb = rjrefn
     c                   endif
      *
     c                   eval      rorefn = rjrefn
     c                   eval      rotext = rjtext
     c                   eval      rovirk = rjvirk
     c                   eval      rofdat = rjfdat
     c                   eval      rorrf1 = *zeros
     c                   eval      rorrf2 = *zeros
     c                   eval      rodeck = rjdeck
     c                   eval      robfnr = *zeros
     c                   eval      robfli = *zeros
     c                   eval      rokidi = rjkidi
     c                   eval      roavde = rjavde
     c                   eval      rorekl = *blank
     c                   eval      rodelb = *zeros
     c                   eval      robetb = *zeros
     c                   eval      roress = *zeros
     c                   eval      roresa = *zeros
     c                   eval      roresm = *blank
T5.20c                   eval      rolfak = %trim(rjlfak)
T5.20c                   eval      rospor = rjspor
      *
     c                   if        rjblde = '5'
     c                   eval      roresn = rjresn
     c                   eval      roress = rjress
     c                   eval      roresa = rjresa
     c                   eval      roresm = rjresm
     c                   endif
      *
      * Teller/Timestamp
      *
     c                   eval      w_tell = w_tell + 1
     c                   move      w_tell        w_tell_alf
     c                   time                    rntist
     c     *iso0         move      rntist        w_tmst_20
     c                   move      w_tell_alf    w_tmst_20
     c     *iso0         move      w_tmst_20     rotist
      *
6.11 c                   time                    roodat
6.11 c                   time                    rootim
6.11 c                   eval      roousr = l_user
6.11 c                   time                    roedat
6.11 c                   time                    roetim
6.11 c                   eval      roeusr = l_user
     c                   write     rltrlur
      *
     c                   endsr
      *
     c/eject
      *
      * Subrutine ved brudd på regnskapsår
      *
     c     brd_raar      begsr
      *
      * Oppdater sist brukte journalnr.
      *
     c                   move      rjraar        raa4lu_4aar
     c     raa4lu_key    chain     raa4lu
      *
     c                   if        %found(raa4lu)
     c                   eval      w_jour = ra4sjÅ + 1
     c                   eval      ra4sjÅ = w_jour
     c                   eval      rjjour = w_jour
     c                   update    raa4lur
     c                   endif
      *
      * Hvis dette er først journal nytt år
      *
     c                   if        not%found(raa4lu)
     c                   clear                   raa4lur
     c                   eval      w_jour = 1
     c                   eval      rjjour = w_jour
R5.60c                   eval      ra4sjÅ = w_jour
     c                   eval      ra4fir = rjfirm
     c                   eval      ra4aar = rjraar
     c                   time                    ra4dat
     c                   time                    ra4tim
     c                   eval      ra4usr = l_user
     c                   write     raa4lur
     c                   endif
      *
     c     raa1l1_key    chain     raa1l1r                            53
      *
     c                   endsr
      *
     c/eject
      *
6.20  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.20  * ERROR-rutine
6.20  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.20  *
6.20 c     *pssr         begsr
6.20  *
6.20 c                   if        w_klient = 'J'
6.20 c                   eval      w_stat = 1
6.20 c                   eval      w_jsta = 40
6.20 c                   eval      w_jmld = 'Fatal feil i RF110R'
6.20 c                   call      'AB705R'
6.20 c                   parm                    w_jkey
6.20 c                   parm                    w_jsta
6.20 c                   parm                    w_jmld
6.20 c                   move      *on           *inlr
6.20 c                   goto      slutt1
6.20 c                   endif
6.20  *
6.20 c                   endsr
7.fb  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
7.fb  * Sender kid og sjekker om depositum, evt. oppdaterer
7.fb  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
7.fb c     depositum     begsr
7.fb c                   call      'RF780C '
7.fb c                   parm                    rjfirm
7.fb c                   parm                    rjkidi
7.fb c                   parm                    rjneto
7.fb c                   parm                    w_bilk
7.fb  *
7.fb c                   eval      w_text = 'Delbet.O/ ' +%subst(rjkidi:11:8)
7.fb  *
7.fb c                   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
610   * Parameterliste
610   *
610  c     *entry        plist
610  c                   parm                    w_mem1
6.20 c                   parm                    w_jkey
6.20 c                   parm                    w_stat
      *
     c                   eval      w_tell = *zeros
     c                   time                    w_tdat
6.20  *  7 i W_stat sier at dette kjøres fra klienten
6.20 c                   if        w_stat = 7
6.20 c                   eval      w_klient = 'J'
6.20 c                   else
6.20 c                   eval      w_klient = 'N'
6.20 c                   endif
      *
      * Key for kunder
      *
     c     rkunlr_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunlr_kund
      *
      * Key for kunder
      *
     c     rkunlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunlu_kund
      *
      * Key for leverandører
      *
     c     rlevlr_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevlr_levr
      *
      * Key for leverandører
      *
     c     rlevlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevlu_levr
      *
      * Key for prosjekt - prosjektoversikt
      *
6.20 c*    rpropf_key    klist
6.20 c*                  kfld                    w_firm
6.20 c*                  kfld                    rpropf_pros
6.20 c*                  kfld                    rpropf_akti
6.20 c*                  kfld                    rpropf_kont
6.20 c*                  kfld                    rpropf_spes
6.20  *
6.20  * Key for prosjekt - prosjektoversikt
6.20  *
6.20 c*    rprol1_key    klist
6.20 c*                  kfld                    w_firm
6.20 c*                  kfld                    rprol1_pros
6.20 c*                  kfld                    rprol1_akti
6.20 c*                  kfld                    rprol1_kont
6.20 c*                  kfld                    rprol1_spes
      *
      * Key for statusopplysninger - koderegister
      *
     c     raa1l1_key    klist
     c                   kfld                    w_firm
      *
      * Key for sist brukte nr. - koderegister
      *
     c     raa4lu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    raa4lu_4aar
      *
      * Key for bilagskoder
      *
     c     ra01l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra01l1_akod
      *
      * Key for saldomatrise - hovedbok
      *
     c     rhsapf_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rhsapf_kont
     c                   kfld                    rhsapf_spes
     c                   kfld                    rhsapf_avde
     c                   kfld                    rhsapf_raar
     c                   kfld                    rhsapf_type
      *
      * Key for saldomatrise - hovedbok
      *
     c     rhsalu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rhsalu_kont
     c                   kfld                    rhsalu_spes
     c                   kfld                    rhsalu_avde
     c                   kfld                    rhsalu_raar
     c                   kfld                    rhsalu_type
6.20  *
6.20  * Key for saldomatrise - prosjekt
6.20  *
6.20 c*    rpsapf_key    klist
6.20 c*                  kfld                    w_firm
6.20 c*                  kfld                    rpsapf_pros
6.20 c*                  kfld                    rpsapf_akti
6.20 c*                  kfld                    rpsapf_raar
6.20 c*                  kfld                    rpsapf_kont
6.20 c*                  kfld                    rpsapf_spes
6.20 c*                  kfld                    rpsapf_type
6.20  *
6.20 c*    rpsalu_key    klist
6.20 c*                  kfld                    w_firm
6.20 c*                  kfld                    rpsalu_pros
6.20 c*                  kfld                    rpsalu_akti
6.20 c*                  kfld                    rpsalu_raar
6.20 c*                  kfld                    rpsalu_kont
6.20 c*                  kfld                    rpsalu_spes
6.20 c*                  kfld                    rpsalu_type
6.20  *
610  c     rjoupf_key    klist
610  c                   kfld                    w_nivo
610  c                   kfld                    w_memb
610  c                   kfld                    w_sort
8.01  *
8.01  * Key for les på status ofak
8.01  *
8.01 c     fstsl1_key    klist
8.01 c                   kfld                    w_firm
      *
8.01 c                   eval      w_firm = l_firm
8.01  * Les statusregister
8.01  *
8.01 c     fstsl1_key    chain     fstsl1
      *
7.01  * Test om logging skal gjøres
7.01  *
7.01   CallP CO402R(l_filg:w_firm:0:'RF-PROG LOGGING':
7.01                    co402_verdi1:co402_verdi2);
7.01   if co402_verdi1 = '1';
7.01     u_logg = *on;
7.01   endif;
610   *
     c                   endsr
