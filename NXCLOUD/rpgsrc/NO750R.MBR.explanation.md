# NO750R Program Documentation

## Overview

**Program:** NO750R  
**System:** ASOFAK  
**Description:**  
This program acts as an interface for importing external order headers, specifically designed to retrieve Norgros WEB orders. It is invoked with a set of parameters, processes these parameters, and then delegates the actual order import logic to a companion CL program (`NO750C`). The RPG program’s main responsibilities are parameter handling, data preparation, and orchestration.

---

## Purpose and Context

NO750R is part of the order processing integration between the ASOFAK system and the Norgros WEB order platform. It is not concerned with the business logic of importing orders itself; rather, it prepares and transforms input parameters, constructs a file path, and calls the CL program that performs the actual import.

The program is typically called by other programs or batch jobs that need to trigger the import of customer orders from external (WEB) sources.

---

## Structure and Logic

### Parameters

The program expects the following parameters on entry (see the *inzsr subroutine):

- **p_firm (3,0):** Company number (numeric)
- **p_kund (6,0):** Customer number (numeric)
- **p_kpro (6,0):** Customer project number (numeric)
- **p_lety (1,0):** Delivery type (numeric)
- **p_link (50A):** Path or prefix for the file (character)
- **p_file (50A):** Filename (character)
- **p_feil (1A):** Error indicator (character, passed by reference)

These parameters are mapped directly from the caller and used throughout the program.

---

### Variable Definitions

- **w_firm_alf, w_kund_alf, w_kpro_alf, w_lety_alf:**  
  Character equivalents of the numeric parameters, needed because the downstream CL program expects character parameters.

- **w_link:**  
  A 100-character string that will hold the fully constructed file path (link + filename), which is also expected by the CL program.

---

### Main Processing Steps

1. **Parameter Conversion**  
   The numeric input parameters are converted to their alphanumeric equivalents using `movel`. This is a legacy technique to ensure proper formatting when passing data to programs that expect character input.

2. **File Path Construction**  
   The file path for the order file is constructed by concatenating the trimmed `p_link` and `p_file` parameters. This allows flexibility in specifying different directories or filenames.

3. **Delegation to CL Program**  
   The RPG program calls the CL program `NO750C`, passing all the prepared parameters. The CL program is responsible for the actual reading and importing of the customer order file. The error flag (`p_feil`) is passed by reference so that any errors encountered by the CL can be reported back to the caller.

4. **Program Termination**  
   The program sets on LR (`*inlr = *on`) and returns, ensuring proper cleanup.

---

### Subroutine: *inzsr (Initialization)

- The *inzsr subroutine is triggered at program start.
- It defines the program’s parameter list (`plist`) and maps each incoming parameter to the corresponding internal variable.
- No additional initialization logic is present.

---

## Design Decisions and Conventions

- **Separation of Concerns:**  
  The RPG program is intentionally kept simple, serving only as a parameter handler and delegator. All business logic is in the CL program. This modularity aids maintainability and allows the CL to be reused or replaced independently.

- **Parameter Passing:**  
  Numeric parameters are converted to alphanumeric to maintain compatibility with legacy CL programs, which cannot handle packed or zoned decimal parameters directly.

- **File Path Construction:**  
  The program expects the caller to provide both a path and a filename, which are concatenated. This allows for flexible file management and supports different environments or directories.

- **Error Handling:**  
  The error flag is passed by reference, enabling the downstream CL program to signal errors back to the original caller.

---

## External Interactions

- **CL Program `NO750C`:**  
  This is the main consumer of the prepared parameters. It is responsible for reading the specified order file and performing the import. Any changes to the parameter structure or expectations must be coordinated with the CL program.

- **Order File:**  
  The program does not access the order file directly; it merely constructs the path and passes it along.

---

## Business/Domain-Specific Notes

- The program is tailored for Norgros WEB orders, as indicated by the comments and naming conventions.
- The naming of parameters and variables follows established conventions for customer (KUND), company (FIRM), project (KPRO), and delivery type (LETY) within the ASOFAK system.
- The error flag (`p_feil`) is a single character, typically set to indicate success or failure of the import process.

---

## Summary

NO750R is a lightweight RPG interface program that prepares and passes order import parameters to a CL program for further processing. It is a glue layer in the order import workflow, ensuring data is correctly formatted and routed. Any enhancements or changes to the import logic should be made in the CL program, not here. This program is stable and unlikely to require frequent changes unless the interface to the CL program changes.