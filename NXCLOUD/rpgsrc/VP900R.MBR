     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : VP900R
      * Beskrivelse . . : Henter og beregner priser og rabatter for vare
      *
      * Kjøper kreves alltid for laveste pris på vare.
      * Salgsprisen som returneres er salgsprisen som er grunnlaget for
      * rabatten, d.v.s. pris før rabatt.
      *
      * Spesialversjon  :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       230499 HKO  Nytt program
      *       200300 HKO  Lagt inn leverandør som nivå i rabattmatrisen
      *                   Dersom leveringstype <> 0, hentes rabatter fra
      *                   leveringstype 0 kun i de tilfeller hvor prisen er
      *                   hentet på leveringstype 0.
      *       040400 HKO  Endret logikk ved overstyring på kundeprosjekt
      *       220500 HKO  Dersom 100 % DG settes salgspris til salgspris
      *                   uten rabatt (tar ikke hensyn til kostpris)
      *       240500 HKO  Rabatt hentes kun fra leveringstypen prisen er
      *                   hentet fra
      *       160600 HKO  Rettet feil ved oppslag i rabattmatrise med varer
      *                   hvor leverandør ikke var utfylt
      *       171000 HKO  Returnerer rabattgruppe fra vare
      *       200503 HKO  Lagt inn kundekategori som nivå i rabattmatrise
      *                   og spesialpriser
      *       110703 HKO  Tar hensyn til DG i rabattmatrisen selv om varen
      *                   har priskode 'B'
      *       161103 HKO  Erstattet rabattgruppe med varegruppe og modulnr
      *                   Kan kombinere varegruppe med leverandør
      *                   Lagt inn rabatt på bunnpris
      *       151203 HKO  Lagt inn behandling av bruksrett-rabatt
      *                   Endret parameterliste
      *       180104 HKO  Diversevarer og tjenester holdes utenfor
      *                   rabattmatrisen
      *                   Åpnet for 0%-rabatt
      *       180504 HKO  Behandler også varer fra VA
      *                   Leverandør som input-parameter
      *       291004 HKO  Returnerer alltid momskode (fra økonomisystemet)
      *       041104 HKO  Flagg for avgiftsfritt salg som input-parameter
      *       140605 HKO  Henter varetype og priskode på VA-vare
      *       300605 HKO  Åpnet for generell rabatt
      *       020905 HKO  Returnerer navn på kampanje uavhengig av om
      *                   tilbudsprisen benyttes eller ikke
5.70  * PRGR  221008 bof  Utvidet med prisgruppe
6.10  *       290909 ASK  Lagt inn ny logikk for momskode uthenting
6.20  *       220311 BOF  Utvidet med prisgiver på vare-pris
6.21  *       240411 BOF  Utvidet med tilbudspris med varegruppe og leverandør
6.22  * 6.20  190511 bø   Utvidet vl710r med div. info
6.23  * 6.20  190511 bof  Skal bruke lagerleverandør fra vare-pris som leverandør
6.24  * 6.20  290212 bof  Justering vedr. hente lagerleverandør for vare-pris
6.25  *       070312 BOF  Justering på hente tilbudspris vareruppe og leverandør
6.26  *       060613 BOF  Tillate prgr på tilbud,selv om ikke på varepris
6.27  * 6.20  100214 Bsa  Hvis tilbudspris, må prisgruppen hentes fra  -
6.27  *                   tilbudsregister.
6.28  *       170314 BKV  w_rab1 og 2 like frrab1, var fprab1 (4.2 -> 5.2)
6.nu  *       160614 bof  Endret ihht. nummerutvidelse
6.31  * 6.30  120914 BKV  Henter overstyrt info fra kundeprosjekt
6.32  *       171014 BKV  Fiks for tilbudpris prgr hentes fra tilbudsregister.
6.33  *       220515 bof  -rabatt med prisgr skal slå til selv om prgr ikke
6.33  *                    finnes på pris
6.33  *                   -pris med prisgr, hvis rabatt ikke finnes brukes
6.33  *                    rabatt med prisgruppe *blank
6.33  *                   -Spesialpris
6.33  *                   -Nettopriser
6.34  *       291116 bof  Utvidet med avgiftskode 2, utenl.eksport     ikke
6.35a *       150216 bof  Hvis prisgr. tilslag, så ta vare på dette.
6.35  *       090317 bof  Justering mva for skaffevarer
6.36  *       150317 bof  Feilrettn. hent bruksr.rab.
6.37  *       120417 bof  Hvis ikke prisgr. på varen,så sett HOPRGR=blank
6.38  *       250917 bof  Feilretting utl.mva når salgspris = 0
6.39  *       270218 bof  Feilretting utl.mva når salgspris = 0 II
6.3a  *       170718 bof  Feilrett. vedr. skaffevare og rabatt
6.3b  * 6.30  170918 bkv  Utvidet med trelast sortiment
6.3c  *       080318 bof  Utvidet med kundeklubb på tilbudspris.
6.3d  * 6.30  290119 bsa  Skal ikke ta med kampanjenavn hvis prisen ikke
6.3d  *                   benyttes.
6.3e  * 6.30  110619 bsa  Tilbudspris, hvis flere skal gjelde, bruk den beste.
6.3e  *                   NB. Det betyr at timetilbud nødvendigvis ikke slår
6.3e  *                   til, hvis det ikke er det beste.
6.3f  * 6.30  060819 bof  Feilretting hvis spes.pris med prgr.så sett hoprgr
      *
7.01  *K00  030620 BOF NXS-4138  Kunne kombinere rabattkat.og kundekat.i rab.matr.
7.02  *K000   141220 bsa  Hvis spesialfaktura og mva fritt, settes kode 0.
7.03  *K000   130121 bsa  Hvis sentrallager-vare, så finn hovedleverandør
7.04  *K000   010221 bsa  Switchstyrer om beste pris skal gjelde for tilbudspris
7.04  *K000               BM ønsker at det skal være "siste". Ref mail fra
7.04  *K000               Reidar Bjerkø, 29.01.21.
      *
8.02  *       071221 bof  hvis lager på kunde skal dette brukes, eller fra user
8.03  *       301122 bof  Hvis VA vare og vare ikke finnes i JVARPF, så sett mvakode =3
8.06  *       160922 bof  Denne er reservert for Mestergruppen som skal inn i std.
8.07  *PRG2   080622 bof  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     frmknl2    if   e           k disk    rename(rmknpfr:rmknl2r)
     ffkprl1    if   e           k disk    rename(fkprpfr:fkprl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvvprl1    if   e           k disk    rename(vvprpfr:vvprl1r)
     fvtill1    if   e           k disk    rename(vtilpfr:vtill1r)
6.3c fvklul1    if   e           k disk    rename(vklupfr:vklul1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     ffohel1    if   e           k disk    rename(fohepfr:fohel1r)
     ffodtlv    if   e           k disk    rename(fodtpfr:fodtlvr)
     ffpril1    if   e           k disk    rename(fpripfr:fpril1r)
     ffrabl1    if   e           k disk    rename(frabpfr:frabl1r)
     fvbrkl1    if   e           k disk    rename(vbrkpfr:vbrkl1r)
     fvbrkl5    if   e           k disk    rename(vbrkpfr:vbrkl5r)
     frmbtl1    if   e           k disk    rename(rmbtpfr:rmbtl1r)
     fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
     f                                     prefix(vv:2)
     fjvdtl1    if   e           k disk    rename(jvdtpfr:jvdtl1r)
6.10 fvmval1    if   e           k disk    rename(vmvapfr:vmval1r)
6.3b fvvlel1    if   e           k disk    rename(vvlepfr:vvlel1r)
7.03 fvsdtl7    if   e           k disk    rename(vsdtpfr:vsdtl7r)
7.03 fvshel1    if   e           k disk    rename(vshepfr:vshel1r)
      *
      * Definering parametre
      *
     d p_irec          s            120
     d p_orec          s             80
      *
      * Datastruktur parameterliste -inn
      *
     d                 ds
     d hirec                        120
     d  hifirm                        3  0 overlay(hirec)
     d  hirkat                        3  0 overlay(hirec:4)
     d  hikund                        6  0 overlay(hirec:7)
     d  hikpro                        6  0 overlay(hirec:13)
     d  hivare                       15    overlay(hirec:19)
     d  hilety                        1  0 overlay(hirec:34)
     d  hienhe                        3    overlay(hirec:35)
     d  hidato                         d   overlay(hirec:38) datfmt(*iso)
     d  hitime                         t   overlay(hirec:48) timfmt(*iso)
6.nu d  hinumm                        8  0 overlay(hirec:56)
6.nu d  hikode                        1    overlay(hirec:64)
6.nu d  hidekn                        5  2 overlay(hirec:65)
6.nu d  hiavgf                        1  0 overlay(hirec:70)
6.nu d  hipriv                        1  0 overlay(hirec:71)
6.nu d  hitilb                        1    overlay(hirec:72)
6.nu d  hiskaf                        1    overlay(hirec:73)
6.nu d  hildor                        6  0 overlay(hirec:74)
6.nu d  hisapr                        9  2 overlay(hirec:80)
6.nu d  hikopr                        9  2 overlay(hirec:89)
8.07 d  hiprgr                        2    overlay(hirec:98)
8.07 d  hiklub                        1    overlay(hirec:100)
     d  hiinlr                        1    overlay(hirec:120)
      *
      * Datastruktur parameterliste -ut
      *
     d                 ds
     d horec                         80
     d  holety                        1  0 overlay(horec)
     d  hokpri                        1    overlay(horec:2)
     d  hooppr                        9  2 overlay(horec:3)
     d  hosapr                        9  2 overlay(horec:12)
     d  hokopr                        9  2 overlay(horec:21)
     d  horab1                        5  2 overlay(horec:30)
     d  horab2                        5  2 overlay(horec:35)
     d  hodekn                        5  2 overlay(horec:40)
     d  hopros                        5  2 overlay(horec:45)
     d  hokamp                        5    overlay(horec:50)
     d  hoalme                        4  0 overlay(horec:55)
     d  hobrty                        1  0 overlay(horec:59)
     d  hobrr1                        5  2 overlay(horec:60)
     d  hobrr2                        5  2 overlay(horec:65)
     d  hoomva                        1    overlay(horec:70)
8.07 d  hoprgr                        2    overlay(horec:71)
8.07 d  hoklub                        1    overlay(horec:73)
      *
      * Definering av variabler i nøkler
      *
     d rkunl1_kund     s                   like(rkkund)
     d rmknl2_xknr     s                   like(rmxknr)
     d fkprl1_kund     s                   like(flkund)
     d fkprl1_kpro     s                   like(flkpro)
     d vvarl1_vare     s                   like(vvvare)
     d vvprl1_vare     s                   like(vpvare)
6.20 d vvprl1_ldor     s                   like(vpldor)
5.70 d vvprl1_prgr     s                   like(vpprgr)
     d vvprl1_enhe     s                   like(vpenhe)
     d vvprl1_lety     s                   like(vplety)
6.21 d vtill1_ogrp     s                   like(vtogrp)
6.21 d vtill1_hgrp     s                   like(vthgrp)
6.21 d vtill1_ugrp     s                   like(vtugrp)
6.21 d vtill1_ldor     s                   like(vtldor)
     d vtill1_vare     s                   like(vtvare)
5.70 d vtill1_prgr     s                   like(vtprgr)
     d vtill1_lety     s                   like(vtlety)
     d vugrl1_uogr     s                   like(vguogr)
     d vugrl1_uhgr     s                   like(vguhgr)
     d vugrl1_uugr     s                   like(vguugr)
     d fohel1_numm     s                   like(fonumm)
     d fohel1_suff     s                   like(fosuff)
     d fodtlv_vare     s                   like(fdvare)
     d fodtlv_numm     s                   like(fdnumm)
     d fodtlv_suff     s                   like(fdsuff)
     d fodtlv_enh1     s                   like(fdenh1)
5.70 d fpril1_prgr     s                   like(fpprgr)
     d fpril1_rkat     s                   like(fprkat)
     d fpril1_kkat     s                   like(fpkkat)
     d fpril1_kund     s                   like(fpkund)
     d fpril1_kpro     s                   like(fpkpro)
     d fpril1_vare     s                   like(fpvare)
     d fpril1_enhe     s                   like(fpenhe)
     d fpril1_lety     s                   like(fplety)
5.70 d frabl1_prgr     s                   like(frprgr)
     d frabl1_rkat     s                   like(frrkat)
     d frabl1_kkat     s                   like(frkkat)
     d frabl1_kund     s                   like(frkund)
     d frabl1_kpro     s                   like(frkpro)
     d frabl1_ogrp     s                   like(frogrp)
     d frabl1_hgrp     s                   like(frhgrp)
     d frabl1_ugrp     s                   like(frugrp)
     d frabl1_ldor     s                   like(frldor)
     d frabl1_modn     s                   like(frmodn)
     d frabl1_vare     s                   like(frvare)
     d frabl1_enhe     s                   like(frenhe)
     d frabl1_lety     s                   like(frlety)
     d vbrkl1_alme     s                   like(vbalme)
     d vbrkl1_ogrp     s                   like(vbogrp)
     d vbrkl1_hgrp     s                   like(vbhgrp)
     d vbrkl1_ugrp     s                   like(vbugrp)
     d vbrkl1_modn     s                   like(vbmodn)
     d vbrkl1_vare     s                   like(vbvare)
     d vbrkl5_alme     s                   like(vbalme)
     d vbrkl5_vare     s                   like(vbvare)
     d rmbtl1_talm     s                   like(rmtalm)
     d rmbtl1_tbrt     s                   like(rmtbrt)
     d jvarl1_vare     s                   like(vvvare)
     d jvdtl1_dvar     s                   like(jvdvar)
6.10 d vmval1_mkod     s                   like(vamkod)
6.3c d vklul1_ogrp     s                   like(vtkogr)
6.3c d vklul1_hgrp     s                   like(vtkhgr)
6.3c d vklul1_ugrp     s                   like(vtkugr)
6.3c d vklul1_ldor     s                   like(vtkldo)
6.3c d vklul1_vare     s                   like(vtkvar)
6.3c d vklul1_prgr     s                   like(vtkprg)
6.3c d vklul1_lety     s                   like(vtklet)
7.03 d vsdtl7_vare     s                   like(vdvare)
7.03 d vshel1_vsor     s                   like(vcvsor)
7.03 d vshel1_lage     s                   like(vclage)
      *
      * Definering av variable
      *
     d b_pris          s              1    inz(*off)
     d b_ordr          s              1    inz(*off)
     d b_spes          s              1    inz(*off)
     d b_raba          s              1    inz(*off)
6.35ad b_raba_1        s              1    inz(*off)
5.70 d b_prgr          s              1    inz(*off)
6.20 d b_inlr          s              1    inz(*off)
6.3c d b_ogrp          s              1    inz(*off)
6.3c d b_klub          s              1    inz(*off)
7.03 d b_sent          s              1    inz(*off)
      *
     d w_rabd          s              5  2
     d w_raba          s              9  2
     d w_pasl          s              5  2
      *
     d w_firm          s                   like(vvfirm)
5.70 d w_prgr          s                   like(frprgr)
     d w_rkat          s                   like(rkrabk)
     d w_kkat          s                   like(rkkatg)
     d w_kund          s                   like(rkkund)
     d w_kpro          s                   like(flkpro)
     d w_avgf          s                   like(rkmkod)
     d w_spfa          s                   like(rkspfa)
     d w_priv          s                   like(flpriv)
     d w_alme          s                   like(rmxalm)
     d w_bupr          s                   like(vpbupr)
     d w_tipr          s                   like(vttip1)
6.3c d w_klpr          s                   like(vttip1)
6.33 d s_tipr          s                   like(vttip1)
     d w_lety          s                   like(vtlety)
6.3c d w_letk          s                   like(vtlety)
     d w_sapr          s                   like(fpsapr)
     d w_kopr          s                   like(fpkopr)
6.3c d w_kopk          s                   like(fpkopr)
     d w_ldor          s                   like(frldor)
6.28 d w_rab1          s                   like(fprab1)
6.28 d w_rab2          s                   like(fprab2)
     d w_rabn          s                   like(frrabn)
     d w_rabb          s                   like(frrabb)
     d w_rabt          s                   like(frrabt)
     d w_dekn          s                   like(frdekn)
     d w_dgpr          s                   like(vpsapr)
     d w_ntpr          s                   like(vpsapr)
     d w_tipr_w        s                   like(vttip1)
     d w_sapr_w        s                   like(vpsapr)
5.70 d w_lage          s              2  0
5.70 d p_vtyp          s                   like(vvvtyp)
6.20 d w_lldo          s                   like(vvldor)
6.3b d w_lv_nobb       s                   like(vvlnob)
6.3b d w_lv_modn       s                   like(vvlmod)
6.3b d w_lv_lldo       s                   like(vvlnle)
6.3b d w_lv_llva       s                   like(vvllva)
6.21 d w_pldo          s                   like(vpldor)
6.22 d w_udat          s                   like(vvudat)
6.33 d w_niva          s              3  0
6.33 d w_niva_1        s              3  0
6.33 d w_niva_2        s              3  0
6.33 d w_rab1_1        s                   like(fprab1)
6.33 d w_rab2_1        s                   like(fprab2)
6.33 d w_rabn_1        s                   like(frrabn)
6.33 d w_rabb_1        s                   like(frrabb)
6.33 d w_rabt_1        s                   like(frrabt)
6.33 d w_dekn_1        s                   like(frdekn)
6.3c d w_kamk          s                   like(vtkamp)
      *
5.70 d                uds
7.03 d l_filg                931    933
5.70 d l_lage               1001   1002  0
      *
7.03 d u_703           s              1    inz(*off)
7.04 d u_704           s              1    inz(*off)
      *
7.03  *
7.03  * Eksternt program
7.03   dcl-s co402_verdi1  char(1);
7.03   dcl-s co402_verdi2  char(2048);
7.03   DCL-PR CO402R EXTPGM('CO402R');
7.03     p_filgrp            char(3)     const;
7.03     p_firm              packed(3:0) const;
7.03     p_lager             packed(2:0) const;
7.03     p_nokkel            char(50)    const;
7.03     p_verdi1            char(1);
7.03     p_verdi2            char(2048);
7.03   END-PR;
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Kaller intitierings-rutine
      *
     c                   exsr      init
      *
      * Hent opplysninger fra vare. Dersom vare ikke finnes avbrytes
      * programmet. Dersom VA-vare avbrytes også programmet dersom
      * salgspris ikke er oppgitt eller dersom kostpris ikke er oppgitt
      * når dekningsgrad er oppgitt.
      *
     c                   if        hiskaf = *off
     c                   eval      vvarl1_vare = hivare
     c     vvarl1_key    chain     vvarl1
     c                   if        not %found
     c                   goto      avslutt
     c                   endif
      *
5.70 c                   call      'VL710R'
5.70 c                   parm                    w_firm
5.70 c                   parm                    vvvare
5.70 c                   parm                    w_lage
5.70 c                   parm                    p_vtyp
6.22 c                   parm                    w_udat
6.22 c                   parm                    w_lldo
6.22 c                   parm                    b_inlr
6.3b c                   parm                    w_lv_nobb
6.3b c                   parm                    w_lv_modn
6.3b c                   parm                    w_lv_lldo
6.3b c                   parm                    w_lv_llva
6.3a  * skal ikke kalle VL710R vhis VA-vare **
6.3a c                   endif
      *
6 24  * hvis lagervare : hvis leverandør på lager og denne er
6.24  * overstyrt fra kallende program, så brukes denne
6.24 c                   if        hiskaf = *off and
6.24 c                             hildor <> 0
6.24 c                   eval      w_lldo = hildor
6.24 c                   endif
7.03  *
7 03  * Hvis sentral-lagervare, så velg hovedleverandør
7.03  *
7.03 c                   if        u_703 = *on
7.03 c                   eval      b_sent = *off
7.03 c                   exsr      sjekk_vsor
7.03 c                   if        b_sent = *on
7.03 c                   eval      w_lldo = vvldor
7.03 c                   endif
7.03 c                   endif
      *
     c                   if        hiskaf = *on
      *
     c                   eval      jvarl1_vare = hivare
     c     jvarl1_key    chain     jvarl1
     c                   if        not %found
8.03 c                   eval      hoomva = '3'
     c                   goto      avslutt
     c                   endif
      *
     c                   if        hisapr = 0 or
     c                             hikopr = 0 and
     c                             hidekn <> 0
6.35 c                   exsr      mva_beh_1
6.38 c                   goto      avsl01
     c                   endif
      *
     c                   eval      vvnmod = vvmodn
     c                   eval      vvkmva = 0
      *
     c                   eval      jvdtl1_dvar = hivare
     c     jvdtl1_key    chain     jvdtl1
     c                   if        %found
     c                   eval      vvkpri = jvdpko
     c                   if        jvdsko = 1
     c                   eval      p_vtyp = 'S'
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * Finner MVA-kode
      *
     c                   exsr      mva_kode
      *
      * Finner leverandør
      *
     c                   if        hiskaf = *off
6.23 c                   eval      w_ldor = w_lldo
     c                   else
     c                   eval      w_ldor = hildor
     c                   endif
      *
      * Henter standardpriser
      *
     c                   exsr      hent_standard
      *
      *
      * Henter pris fra ordre/tilbud
      *
     c                   if        hinumm <> 0
     c                   exsr      ordre
     c                   if        b_ordr = *on
     c                   goto      retur
     c                   endif
     c                   endif
      *
      * Beregner pris dersom dekning er utfylt
      *
     c                   if        hidekn <> 0
     c                   exsr      dekning
     c                   goto      retur
     c                   endif
5.70  *
5.70  * Hvis prisguppe, så prøver finner man spes.pris rabatt som gjelder for denne
5.70  * prisgruppen.
5.70  *
6.33 c*                  if        b_prgr = *on
6.37 c                   if        hiprgr <> *blank and
6.37 c                             b_prgr = *off
6.37 c                   eval      hoprgr = *blank
6.37 c                   else
6.37 c                   eval      hoprgr = hiprgr
6.37 c                   endif
6.35ac                   eval      b_raba_1 = *off
5.70 c                   eval      fpril1_prgr = hiprgr
5.70 c                   eval      frabl1_prgr = hiprgr
6.33 c                   eval      w_niva = 0
6.33  *
6.33 c                   exsr      hent_matrise
6.33 c                   if        b_spes = *on
6.33 c                   goto      beregn
6.33 c                   endif
6.33 c                   if        b_raba = *on
6.35ac                   eval      b_raba_1 = *on
6.33 c                   eval      w_niva_1 = w_niva
6.33  * tar vare på rabatt-innhold fra 1.runde
6.33 c                   eval      w_rab1_1 = w_rab1
6.33 c                   eval      w_rab2_1 = w_rab2
6.33 c                   eval      w_rabn_1 = w_rabn
6.33 c                   eval      w_rabb_1 = w_rabb
6.33 c                   eval      w_rabt_1 = w_rabt
6.33 c                   eval      w_dekn_1 = w_dekn
6.33  *
6.33 c                   eval      w_niva = 0
6.33 c                   eval      b_raba = *off
6.33 c                   eval      fpril1_prgr = *blank
6.33 c                   eval      frabl1_prgr = *blank
6.33 c                   exsr      hent_matrise
6.33 c                   if        b_spes = *on
6.33 c                   goto      beregn
6.33 c                   endif
6.33 c                   eval      w_niva_2 = w_niva
6.33 c                   if        b_raba = *off
6.33  * her har den kun funnet rabatt fra 1.runde, den brukes
6.35ac                   eval      b_raba   = b_raba_1
6.33 c                   eval      w_rab1   = w_rab1_1
6.33 c                   eval      w_rab2   = w_rab2_1
6.33 c                   eval      w_rabn   = w_rabn_1
6.33 c                   eval      w_rabb   = w_rabb_1
6.33 c                   eval      w_rabt   = w_rabt_1
6.33 c                   eval      w_dekn   = w_dekn_1
6.33 c                   else
6.33 c                   if        w_niva_1 <= w_niva_2
6.33  * her brukes det fra første runde
6.33 c                   eval      w_rab1   = w_rab1_1
6.33 c                   eval      w_rab2   = w_rab2_1
6.33 c                   eval      w_rabn   = w_rabn_1
6.33 c                   eval      w_rabb   = w_rabb_1
6.33 c                   eval      w_rabt   = w_rabt_1
6.33 c                   eval      w_dekn   = w_dekn_1
6.33 c                   endif
6.33 c                   endif
6.33  *
5.70 c                   goto      beregn
6.33 c                   endif
6.33 c*                  endif
      *
      * Hent spesialpris, rabatt eller DG fra spesialpris-matrise og
      * rabattmatrise
      *
5.70 c                   eval      fpril1_prgr = *blank
5.70 c                   eval      frabl1_prgr = *blank
     c                   exsr      hent_matrise
      *
      *
      * Beregner priser og rabatter
      *
5.70 c     beregn        tag
      * Hent brurksrett-rabatt
6.36 c                   exsr      hent_bruksrett
     c                   exsr      beregn_pris
      *
      * Finner priskode, og legger denne i output-felt. Dersom varen er på
      * tilbud, og det er denne prisen som er benyttet, settes priskode
      * til 'T'.
      *
     c                   if        hokpri = *blank
     c                   if        w_tipr <> 0 and
     c                             w_tipr = hosapr
     c                   eval      hokpri = 'T'
6.27 c**                 eval      hoprgr = hiprgr
     c                   else
     c                   eval      hokpri = vvkpri
     c                   endif
     c                   endif
      *
      * Returnerer verdier til kallende program
      *
     c     retur         tag
      *
      * Danner DG-faktor utfra DG på vare eller undergruppe, eller utfra
      * input DG dersom denne er oppgitt
      *
     c                   eval(h)   hopros = (100 - vvdekn) / 100
      *
     c                   if        hidekn <> 0
     c                   eval(h)   hopros = (100 - hidekn) / 100
     c                   endif
      *
     c                   if        hopros = 1
     c                   eval      hopros = 0
     c                   endif
      *
      * Nullstiller kostpris dersom salgspris er null
      *
     c                   if        hosapr = 0
     c                   eval      hokopr = 0
     c                   endif
      *
      * Kopierer output-datastruktur til output-parameter
      *
6.38 c     avsl01        tag
     c                   eval      p_orec = horec
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   if        hiinlr <> *on
     c                   eval      *inlr = *on
     c                   endif
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Finner MVA-kode
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     mva_kode      begsr
      *
      * Default mva-kode
      *
     c                   eval      hoomva = '3'
      *
      * Avgiftsfritt salg fir mva-kode '4'
      * Dersom kunde også skal ha spesialfaktura settes mva-kode til '0'
      *
     c                   if        w_avgf = 1
     c                   eval      hoomva = '4'
     c                   if        w_spfa = 1
     c                   eval      hoomva = '0'
     c                   endif
     c                   leavesr
     c                   endif
      *
      * Finner mva-kode på bakgrunn av momskode på varen
      * Sjekker om momskoder er lagt opp, bruker ellers gammel logikk
      *
     c                   eval      vmval1_mkod = vvkmva
     c     vmval1_key    chain     vmval1
     c                   if        %found
     c                   eval      hoomva = vamkof
6.34 c                   if        hiavgf = 2 and
6.34 c                             vamkuo <> *blank
6.34 c                   eval      hoomva = vamkuo
6.34 c                   endif
     c                   else
     c                   select
     c                   when      vvkmva = 1
     c                   eval      hoomva = '4'
     c                   when      vvkmva = 2
     c                   eval      hoomva = 'H'
     c                   endsl
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å finne standardpriser fra vare-pris-register og
      * tilbudspris fra tilbuds-pris-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_standard begsr
      *
     c                   eval      b_pris = *off
5.70 c                   eval      b_prgr = *off
      *
      * Dersom VA-vare benyttes mottatte priser og leveringstype
      *
     c                   if        hiskaf = *on
     c                   eval      b_pris = *on
     c                   eval      holety = hilety
     c                   eval      hooppr = hisapr
     c                   eval      hosapr = hisapr
     c                   eval      hokopr = hikopr
     c                   leavesr
     c                   endif
      *
      * Finner salgspris og kostpris avhengig av dato og leveringstype
      * Dersom pris ikke ble funnet, og leveringstype er forskjellig
      * fra 0, hentes pris fra leveringstype 0
      *
6.20  * 1. leverandør for lageret
6.20 c                   eval      vvprl1_ldor = w_lldo
6.20 c                   exsr      hent_pris
6.20 c                   if        b_pris = *off  and
6.20 c                             w_lldo <> vvldor
6.20  * 2. hovedleverandør
6.20 c                   eval      vvprl1_ldor = vvldor
6.20 c                   exsr      hent_pris
6.20 c                   if        b_pris = *off
6.20  * siste mulighet...
6.20 c                   eval      vvprl1_ldor = 0
6.20 c                   exsr      hent_pris
6.20 c                   endif
6.20 c                   endif
      *
6.3e c                   eval      s_tipr = *hival
      *
      * Behandling avhengig av om tilbud er valgt tatt med
      * Finner eventuell tilbudspris avhengig av tidspunkt og leveringstype
      * Dersom tilbud ikke ble funnet, og leveringstype er forskjellig
      * fra 0, hentes tilbud fra leveringstype 0
      *
      *
     c                   if        hitilb <> *on
      *
6.21 c                   eval      vtill1_ogrp = 0
6.21 c                   eval      vtill1_hgrp = 0
6.21 c                   eval      vtill1_ugrp = 0
6.21 c                   eval      vtill1_ldor = 0
     c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = hiprgr
     c                   eval      vtill1_lety = hilety
     c     vtill1_key    setll     vtill1
     c     vtill1_key    reade     vtill1
     c                   dow       not %eof
     c                   if        hidato >= vtfdat and
     c                             hidato <= vttdat
     c                   if        hidato <> vtfdat or
     c                             hidato = vtfdat and
     c                             hitime >= vtftim
     c                   if        hidato <> vttdat or
     c                             hidato = vttdat and
     c                             hitime <= vtttim
      *
6.3d c**                 eval      hokamp = vtkamp
      *
     c                   select
     c                   when      hienhe = vtenh1
     c                   eval      w_lety = vtlety
6.3e c                   if        vttip1 < s_tipr
     c                   eval      w_tipr = vttip1
6.3e c                   eval      s_tipr = vttip1
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
     c                   if        vtkop1 <> 0
     c                   eval      hokopr = vtkop1
     c                   endif
     c                   when      hienhe = vtenh2
     c                   eval      w_lety = vtlety
6.3e c                   if        vttip2 < s_tipr
     c                   eval      w_tipr = vttip2
6.3e c                   eval      s_tipr = vttip2
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
     c                   if        vtkop2 <> 0
     c                   eval      hokopr = vtkop2
     c                   endif
     c                   when      hienhe = vtenh3
     c                   eval      w_lety = vtlety
6.3e c                   if        vttip3 < s_tipr
     c                   eval      w_tipr = vttip3
6.3e c                   eval      s_tipr = vttip3
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
     c                   if        vtkop3 <> 0
     c                   eval      hokopr = vtkop3
     c                   endif
     c                   endsl
      *
6.3e c***                leave
7.04 c                   if        u_704 = *on
7.04 c                   leave
7.04 c                   endif
      *
     c                   endif
     c                   endif
     c                   endif
     c     vtill1_key    reade     vtill1
     c                   enddo
      *
     c                   if        w_tipr = 0 and
     c                             hilety <> 0
     c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = hiprgr
     c                   eval      vtill1_lety = 0
     c     vtill1_key    setll     vtill1
     c     vtill1_key    reade     vtill1
     c                   dow       not %eof
     c                   if        hidato >= vtfdat and
     c                             hidato <= vttdat
     c                   if        hidato <> vtfdat or
     c                             hidato = vtfdat and
     c                             hitime >= vtftim
     c                   if        hidato <> vttdat or
     c                             hidato = vttdat and
     c                             hitime <= vtttim
      *
6.3d c**                 eval      hokamp = vtkamp
      *
     c                   select
     c                   when      hienhe = vtenh1
     c                   eval      w_lety = vtlety
6.3e c                   if        vttip1 < s_tipr
     c                   eval      w_tipr = vttip1
6.3e c                   eval      s_tipr = vttip1
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
     c                   if        vtkop1 <> 0
     c                   eval      hokopr = vtkop1
     c                   endif
     c                   when      hienhe = vtenh2
     c                   eval      w_lety = vtlety
6.3e c                   if        vttip2 < s_tipr
     c                   eval      w_tipr = vttip2
6.3e c                   eval      s_tipr = vttip2
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
     c                   if        vtkop2 <> 0
     c                   eval      hokopr = vtkop2
     c                   endif
     c                   when      hienhe = vtenh3
     c                   eval      w_lety = vtlety
6.3e c                   if        vttip3 < s_tipr
     c                   eval      w_tipr = vttip3
6.3e c                   eval      s_tipr = vttip3
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
     c                   if        vtkop3 <> 0
     c                   eval      hokopr = vtkop3
     c                   endif
     c                   endsl
      *
6.3e c**                 leave
7.04 c                   if        u_704 = *on
7.04 c                   leave
7.04 c                   endif
      *
     c                   endif
     c                   endif
     c                   endif
     c     vtill1_key    reade     vtill1
     c                   enddo
     c                   endif
5.70  *
5.70  * Dersom pris ikke finnes for oppgitt prisgruppe, hentes pris fra
5.70  * prisgruppe blank
5.70  *
5.70 c                   if        w_tipr = 0 and
5.70 c                             hiprgr <> *blank
5.70 c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = *blank
5.70 c                   eval      vtill1_lety = hilety
5.70 c     vtill1_key    setll     vtill1
5.70 c     vtill1_key    reade     vtill1
5.70 c                   dow       not %eof
5.70 c                   if        hidato >= vtfdat and
5.70 c                             hidato <= vttdat
5.70 c                   if        hidato <> vtfdat or
5.70 c                             hidato = vtfdat and
5.70 c                             hitime >= vtftim
5.70 c                   if        hidato <> vttdat or
5.70 c                             hidato = vttdat and
5.70 c                             hitime <= vtttim
5.70  *
6.3d c**                 eval      hokamp = vtkamp
6.27 c                   eval      hoprgr = vtprgr
5.70  *
5.70 c                   select
5.70 c                   when      hienhe = vtenh1
5.70 c                   eval      w_lety = vtlety
6.3e c                   if        vttip1 < s_tipr
5.70 c                   eval      w_tipr = vttip1
6.3e c                   eval      s_tipr = vttip1
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
5.70 c                   if        vtkop1 <> 0
5.70 c                   eval      hokopr = vtkop1
5.70 c                   endif
5.70 c                   when      hienhe = vtenh2
5.70 c                   eval      w_lety = vtlety
6.3e c                   if        vttip2 < s_tipr
5.70 c                   eval      w_tipr = vttip2
6.3e c                   eval      s_tipr = vttip2
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
5.70 c                   if        vtkop2 <> 0
5.70 c                   eval      hokopr = vtkop2
5.70 c                   endif
5.70 c                   when      hienhe = vtenh3
5.70 c                   eval      w_lety = vtlety
6.3e c                   if        vttip3 < s_tipr
5.70 c                   eval      w_tipr = vttip3
6.3e c                   eval      s_tipr = vttip3
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
5.70 c                   if        vtkop3 <> 0
5.70 c                   eval      hokopr = vtkop3
5.70 c                   endif
5.70 c                   endsl
5.70  *
6.3e c**                 leave
7.04 c                   if        u_704 = *on
7.04 c                   leave
7.04 c                   endif
5.70  *
5.70 c                   endif
5.70 c                   endif
5.70 c                   endif
5.70 c     vtill1_key    reade     vtill1
5.70 c                   enddo
5.70  *
5.70 c                   if        w_tipr = 0 and
5.70 c                             hilety <> 0
5.70 c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = *blank
5.70 c                   eval      vtill1_lety = 0
5.70 c     vtill1_key    setll     vtill1
5.70 c     vtill1_key    reade     vtill1
5.70 c                   dow       not %eof
5.70 c                   if        hidato >= vtfdat and
5.70 c                             hidato <= vttdat
5.70 c                   if        hidato <> vtfdat or
5.70 c                             hidato = vtfdat and
5.70 c                             hitime >= vtftim
5.70 c                   if        hidato <> vttdat or
5.70 c                             hidato = vttdat and
5.70 c                             hitime <= vtttim
5.70  *
6.3d c**                 eval      hokamp = vtkamp
6.27 c                   eval      hoprgr = vtprgr
5.70  *
5.70 c                   select
5.70 c                   when      hienhe = vtenh1
5.70 c                   eval      w_lety = vtlety
6.3e c                   if        vttip1 < s_tipr
5.70 c                   eval      w_tipr = vttip1
6.3e c                   eval      s_tipr = vttip1
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
5.70 c                   if        vtkop1 <> 0
5.70 c                   eval      hokopr = vtkop1
5.70 c                   endif
5.70 c                   when      hienhe = vtenh2
5.70 c                   eval      w_lety = vtlety
6.3e c                   if        vttip2 < s_tipr
5.70 c                   eval      w_tipr = vttip2
6.3e c                   eval      s_tipr = vttip2
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
5.70 c                   if        vtkop2 <> 0
5.70 c                   eval      hokopr = vtkop2
5.70 c                   endif
5.70 c                   when      hienhe = vtenh3
5.70 c                   eval      w_lety = vtlety
6.3e c                   if        vttip3 < s_tipr
5.70 c                   eval      w_tipr = vttip3
6.3e c                   eval      s_tipr = vttip3
6.3d c                   eval      hokamp = vtkamp
6.3e c                   endif
5.70 c                   if        vtkop3 <> 0
5.70 c                   eval      hokopr = vtkop3
5.70 c                   endif
5.70 c                   endsl
5.70  *
6.3e c**                 leave
7.04 c                   if        u_704 = *on
7.04 c                   leave
7.04 c                   endif
5.70  *
5.70 c                   endif
5.70 c                   endif
5.70 c                   endif
5.70 c     vtill1_key    reade     vtill1
5.70 c                   enddo
5.70 c                   endif
5.70  *
5.70 c                   endif
      *
     c                   endif
6.21  *
6.21  * Dersom tilbud ikke ble funnet på oppgitt vare/prisgruppe/leveringstupe
6.21  * sjekkes varegruppe / leverandør
6.21  *
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_prgr = hiprgr
6.26 c                   eval      w_prgr      = hiprgr
6.25 c                   exsr      tilb_sjekk
6.25 c                   if        w_tipr = 0 and
6.25 c                             hiprgr <> *blank
6.25 c                   eval      vtill1_prgr = *blank
6.26 c                   eval      w_prgr      = *Blank
6.25 c                   exsr      tilb_sjekk
6.25 c                   endif
6.25 c                   endif
      *
      * Dersom kostpris 0, beregnes kostpris ut fra deknigsgrad på vare
      * eller undergruppe.
      *
     c                   if        hokopr = 0
      *
     c                   if        vvdekn = 0
     c                   eval      vugrl1_uogr = vvogrp
     c                   eval      vugrl1_uhgr = vvhgrp
     c                   eval      vugrl1_uugr = vvugrp
     c     vugrl1_key    chain     vugrl1r
     c                   if        %found
     c                   eval      vvdekn = vgudek
     c                   endif
     c                   endif
      *
     c                   eval(h)   hokopr = hosapr * vvdekn / 100
     c                   if        hokopr <> 0
     c                   eval      hokopr = hosapr - hokopr
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      *
6.20  *-------------------------------------------------------------------------
6.20  * Henter fra vare-pris, først med evt. utfylt prisgruppe, så prisgr. blank
6.20  *** Koden er flyttet i egen subr. for å gjøre det mer fleksibelt ***
6.20  *-------------------------------------------------------------------------
6.20  *
6.20 c     hent_pris     begsr
6.20  *
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = hiprgr
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = hilety
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   if        hiprgr <> *blank
6.20 c                   eval      b_prgr = *on
6.20 c                   endif
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20  *
6.20 c                   if        b_pris = *off and
6.20 c                             hilety <> 0
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = hiprgr
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = 0
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   if        hiprgr <> *blank
6.20 c                   eval      b_prgr = *on
6.20 c                   endif
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20 c                   endif
6.20  *
6.20  * Dersom pris ikke finnes for oppgitt prisgruppe, hentes pris fra
6.20  * prisgruppe blank
6.20  *
6.20 c                   if        b_pris = *off and
6.20 c                             hiprgr <> *blank
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = *blank
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = hilety
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20  *
6.20 c                   if        b_pris = *off and
6.20 c                             hilety <> 0
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = *blank
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = 0
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20 c                   endif
6.20  *
6.20 c                   endif
6.37  *
6.37  * hvis ikke prisgr-pris, så sett HOPRGR lik blank
6.37 c                   if        hiprgr <> *blank and
6.37 c                             b_prgr = *off
6.37 c                   eval      hoprgr = *blank
6.37 c                   endif
6.20  *
6.20 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente pris fra ordre/tilbud
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     ordre         begsr
      *
     c                   eval      b_ordr = *off
      *
     c                   eval      fohel1_numm = hinumm
     c                   eval      fohel1_suff = 0
     c     fohel1_key    chain     fohel1r
     c                   if        %found
      *
     c                   eval      fodtlv_vare = hivare
     c                   eval      fodtlv_numm = hinumm
     c                   eval      fodtlv_suff = 0
     c                   eval      fodtlv_enh1 = hienhe
     c     fodtlv_key    chain     fodtlvr
     c                   if        %found
     c                   eval      b_ordr = *on
     c                   eval      hokopr = fdkopr
     c                   eval      hosapr = fdsapr
     c                   eval      horab1 = fdrab1
     c                   eval      horab2 = fdrab2
     c                   eval      hokpri = fdkpri
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Beregner salgspris utfra påslag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     dekning       begsr
      *
     c                   eval      hokpri = *blank
     c                   eval      hodekn = hidekn
      *
      * Ønsket dekningsgrad vises som ordinær pris - rabatt
      *
     c                   if        hikode = *blank
      *
     c                   eval      w_sapr_w = hosapr
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
     c                   eval      hosapr = hokopr * 100
     c                   eval      w_pasl = 100 - hidekn
     c                   if        w_pasl <> 0
     c                   eval(h)   hosapr = hosapr / w_pasl
     c                   endif
      *
     c                   if        hosapr > w_sapr_w
     c                   eval      hosapr = w_sapr_w
     c                   endif
      *
     c                   eval      w_raba = w_sapr_w - hosapr
     c                   eval      hosapr = w_sapr_w
     c                   eval      w_raba = w_raba * 100
      *
     c                   if        hosapr <> 0
     c                   eval(h)   horab1 = w_raba / hosapr
     c                   eval      horab2 = 0
     c                   endif
      *
     c                   endif
      *
      * Ønsket dekningsgrad vises kun som pris
      *
     c                   if        hikode = 'P'
     c                   if        hokopr <> 0
     c                   eval      hokpri = *blank
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
     c                   eval      hosapr = hokopr * 100
     c                   eval      w_pasl = 100 - hidekn
     c                   eval(h)   hosapr = hosapr / w_pasl
     c                   endif
     c                   endif
      *
      * Ønsket dekningsgrad er ikke dekningsgrad, men en fast rabatt
      *
     c                   if        hikode = 'R'
     c                   eval      horab1 = hidekn
     c                   eval      horab2 = 0
     c                   eval      hodekn = 0
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente rabatter/DG fra rabattmatrise
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_matrise  begsr
      *
      * Avbryter dersom hverken rabattkategori eller kunde er oppgitt
      *
     c***                if        w_rkat = 0 and
     c***                          w_kund = 0
     c***                leavesr
     c***                endif
      *
      * Finner spesialpris eller rabatt/DG
      * Leter først etter spesialpris innenfor et nivå, og så på rabatt/DG
      * innenfor nivået dersom spesialpris ikke ble funnet.
      * Dersom nivå ikke finnes, eller dersom rabatt/DG innenfor nivået
      * ikke er aktivt, fortsettes det nedover i nivåene.
      *
      * Dersom leveringstype er forskjellig fra 0 og spesialpris ikke ble
      * funnet, letes det etter spesialpris på leveringstype 0.
      *
      * Det letes kun etter rabatter på den leveringstypen prisen er
      * hentet fra.
      *
      * Nivårekkefølge:
      *
      *  Rabattkategori
      *    Kundekategori
      *      Kunde
      *        Kundeprosjekt
      *          Overgruppe
      *            Hovedgruppe
      *              Undergruppe
      *                Leverandør
      *                  Modul
      *                    Vare
      *                      Enhet
      *                        Leveringstype
      *  _____________________
      *  - - x x - - - - - x x x    1. Kunde,prosj,vare,enh,lt
      *  - - x x - - - - - x - x    2. Kunde,prosj,vare,lt
      *  - - x x - - - - - x x 0    3. Kunde,prosj,vare,enh,lt=0
      *  - - x x - - - - - x - 0    4. Kunde,prosj,vare,lt=0
      *  - - x x - - - - x - x x    5. Kunde,prosj,modul,enh,lt
      *  - - x x - - - - x - - x    6. Kunde,prosj,modul,lt
      *  - - x x - - - - x - x 0    7. Kunde,prosj,modul,enh,lt=0
      *  - - x x - - - - x - - 0    8. Kunde,prosj,modul,lt=0
      *  - - x x x x x x - - x x    9. Kunde,prosj,ogr,hgr,ugr,lev,enh,lt
      *  - - x x x x x x - - - x   10. Kunde,prosj,ogr,hgr,ugr,lev,lt
      *  - - x x x x x x - - x 0   11. Kunde,prosj,ogr,hgr,ugr,lev,enh,lt=0
      *  - - x x x x x x - - - 0   12. Kunde,prosj,ogr,hgr,ugr,lev,lt=0
      *  - - x x x x - x - - x x   13. Kunde,prosj,ogr,hgr,lev,enh,lt
      *  - - x x x x - x - - - x   14. Kunde,prosj,ogr,hgr,lev,lt
      *  - - x x x x - x - - x 0   15. Kunde,prosj,ogr,hgr,lev,enh,lt=0
      *  - - x x x x - x - - - 0   16. Kunde,prosj,ogr,hgr,lev,lt=0
      *  - - x x x - - x - - x x   17. Kunde,prosj,ogr,lev,enh,lt
      *  - - x x x - - x - - - x   18. Kunde,prosj,ogr,lev,lt
      *  - - x x x - - x - - x 0   19. Kunde,prosj,ogr,lev,enh,lt=0
      *  - - x x x - - x - - - 0   20. Kunde,prosj,ogr,lev,lt=0
      *  - - x x - - - x - - x x   21. Kunde,prosj,lev,enh,lt
      *  - - x x - - - x - - - x   22. Kunde,prosj,lev,lt
      *  - - x x - - - x - - x 0   23. Kunde,prosj,lev,enh,lt=0
      *  - - x x - - - x - - - 0   24. Kunde,prosj,lev,lt=0
      *  - - x x x x x - - - x x   25. Kunde,prosj,ogr,hgr,ugr,enh,lt
      *  - - x x x x x - - - - x   26. Kunde,prosj,ogr,hgr,ugr,lt
      *  - - x x x x x - - - x 0   27. Kunde,prosj,ogr,hgr,ugr,enh,lt=0
      *  - - x x x x x - - - - 0   28. Kunde,prosj,ogr,hgr,ugr,lt=0
      *  - - x x x x - - - - x x   29. Kunde,prosj,ogr,hgr,enh,lt
      *  - - x x x x - - - - - x   30. Kunde,prosj,ogr,hgr,lt
      *  - - x x x x - - - - x 0   31. Kunde,prosj,ogr,hgr,enh,lt=0
      *  - - x x x x - - - - - 0   32. Kunde,prosj,ogr,hgr,lt=0
      *  - - x x x - - - - - x x   33. Kunde,prosj,ogr,enh,lt
      *  - - x x x - - - - - - x   34. Kunde,prosj,ogr,lt
      *  - - x x x - - - - - x 0   35. Kunde,prosj,ogr,enh,lt=0
      *  - - x x x - - - - - - 0   36. Kunde,prosj,ogr,lt=0
      *  - - x x - - - - - - x x   37. Kunde,prosj,enh,lt
      *  - - x x - - - - - - - x   38. Kunde,prosj,lt
      *  - - x x - - - - - - x 0   39. Kunde,prosj,enh,lt=0
      *  - - x x - - - - - - - 0   40. Kunde,prosj,lt=0

      *  - - x - - - - - - x x x   41. Kunde,vare,enh,lt
      *  - - x - - - - - - x - x   42. Kunde,vare,lt
      *  - - x - - - - - - x x 0   43. Kunde,vare,enh,lt=0
      *  - - x - - - - - - x - 0   44. Kunde,vare,lt=0
      *  - - x - - - - - x - x x   45. Kunde,modul,enh,lt
      *  - - x - - - - - x - - x   46. Kunde,modul,lt
      *  - - x - - - - - x - x 0   47. Kunde,modul,enh,lt=0
      *  - - x - - - - - x - - 0   48. Kunde,modul,lt=0
      *  - - x - x x x x - - x x   49. Kunde,ogr,hgr,ugr,lev,enh,lt
      *  - - x - x x x x - - - x   50. Kunde,ogr,hgr,ugr,lev,lt
      *  - - x - x x x x - - x 0   51. Kunde,ogr,hgr,ugr,lev,enh,lt=0
      *  - - x - x x x x - - - 0   52. Kunde,ogr,hgr,ugr,lev,lt=0
      *  - - x - x x - x - - x x   53. Kunde,ogr,hgr,lev,enh,lt
      *  - - x - x x - x - - - x   54. Kunde,ogr,hgr,lev,lt
      *  - - x - x x - x - - x 0   55. Kunde,ogr,hgr,lev,enh,lt=0
      *  - - x - x x - x - - - 0   56. Kunde,ogr,hgr,lev,lt=0
      *  - - x - x - - x - - x x   57. Kunde,ogr,lev,enh,lt
      *  - - x - x - - x - - - x   58. Kunde,ogr,lev,lt
      *  - - x - x - - x - - x 0   59. Kunde,ogr,lev,enh,lt=0
      *  - - x - x - - x - - - 0   60. Kunde,ogr,lev,lt=0
      *  - - x - - - - x - - x x   61. Kunde,lev,enh,lt
      *  - - x - - - - x - - - x   62. Kunde,lev,lt
      *  - - x - - - - x - - x 0   63. Kunde,lev,enh,lt=0
      *  - - x - - - - x - - - 0   64. Kunde,lev,lt=0
      *  - - x - x x x - - - x x   65. Kunde,ogr,hgr,ugr,enh,lt
      *  - - x - x x x - - - - x   66. Kunde,ogr,hgr,ugr,lt
      *  - - x - x x x - - - x 0   67. Kunde,ogr,hgr,ugr,enh,lt=0
      *  - - x - x x x - - - - 0   68. Kunde,ogr,hgr,ugr,lt=0
      *  - - x - x x - - - - x x   69. Kunde,ogr,hgr,enh,lt
      *  - - x - x x - - - - - x   70. Kunde,ogr,hgr,lt
      *  - - x - x x - - - - x 0   71. Kunde,ogr,hgr,enh,lt=0
      *  - - x - x x - - - - - 0   72. Kunde,ogr,hgr,lt=0
      *  - - x - x - - - - - x x   73. Kunde,ogr,enh,lt
      *  - - x - x - - - - - - x   74. Kunde,ogr,lt
      *  - - x - x - - - - - x 0   75. Kunde,ogr,enh,lt=0
      *  - - x - x - - - - - - 0   76. Kunde,ogr,lt=0
      *  - - x - - - - - - - x x   77. Kunde,enh,lt
      *  - - x - - - - - - - - x   78. Kunde,lt
      *  - - x - - - - - - - x 0   79. Kunde,enh,lt=0
      *  - - x - - - - - - - - 0   80. Kunde,lt=0

7.01  *  x x - - - - - - - x x x   81. Rab.kat,Kundekat,vare,enh,lt
7.01  *  x x - - - - - - - x - x   82. Rab.kat,Kundekat,vare,lt
7.01  *  x x - - - - - - - x x 0   83. Rab.kat,Kundekat,vare,enh,lt=0
7.01  *  x x - - - - - - - x - 0   84. Rab.kat,Kundekat,vare,lt=0
7.01  *  x x - - - - - - x - x x   85. Rab.kat,Kundekat,modul,enh,lt
7.01  *  x x - - - - - - x - - x   86. Rab.kat,Kundekat,modul,lt
7.01  *  x x - - - - - - x - x 0   87. Rab.kat,Kundekat,modul,enh,lt=0
7.01  *  x x - - - - - - x - - 0   88. Rab.kat,Kundekat,modul,lt=0
7.01  *  x x - - x x x x - - x x   89. Rab.kat,Kundekat,ogr,hgr,ugr,lev,enh,lt
7.01  *  x x - - x x x x - - - x   90. Rab.kat,Kundekat,ogr,hgr,ugr,lev,lt
7.01  *  x x - - x x x x - - x 0   91. Rab.kat,Kundekat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  x x - - x x x x - - - 0   92. Rab.kat,Kundekat,ogr,hgr,ugr,lev,lt=0
7.01  *  x x - - x x - x - - x x   93. Rab.kat,Kundekat,ogr,hgr,lev,enh,lt
7.01  *  x x - - x x - x - - - x   94. Rab.kat,Kundekat,ogr,hgr,lev,lt
7.01  *  x x - - x x - x - - x 0   95. Rab.kat,Kundekat,ogr,hgr,lev,enh,lt=0
7.01  *  x x - - x x - x - - - 0   96. Rab.kat,Kundekat,ogr,hgr,lev,lt=0
7.01  *  x x - - x - - x - - x x   97. Rab.kat,Kundekat,ogr,lev,enh,lt
7.01  *  x x - - x - - x - - - x   98. Rab.kat,Kundekat,ogr,lev,lt
7.01  *  x x - - x - - x - - x 0   99. Rab.kat,Kundekat,ogr,lev,enh,lt=0
7.01  *  x x - - x - - x - - - 0  100. Rab.kat,Kundekat,ogr,lev,lt=0
7.01  *  x x - - - - - x - - x x  101. Rab.kat,Kundekat,lev,enh,lt
7.01  *  x x - - - - - x - - - x  102. Rab.kat,Kundekat,lev,lt
7.01  *  x x - - - - - x - - x 0  103. Rab.kat,Kundekat,lev,enh,lt=0
7.01  *  x x - - - - - x - - - 0  104. Rab.kat,Kundekat,lev,lt=0
7.01  *  x x - - x x x - - - x x  105. Rab.kat,Kundekat,ogr,hgr,ugr,enh,lt
7.01  *  x x - - x x x - - - - x  106. Rab.kat,Kundekat,ogr,hgr,ugr,lt
7.01  *  x x - - x x x - - - x 0  107. Rab.kat,Kundekat,ogr,hgr,ugr,enh,lt=0
7.01  *  x x - - x x x - - - - 0  108. Rab.kat,Kundekat,ogr,hgr,ugr,lt=0
7.01  *  x x - - x x - - - - x x  109. Rab.kat,Kundekat,ogr,hgr,enh,lt
7.01  *  x x - - x x - - - - - x  110. Rab.kat,Kundekat,ogr,hgr,lt
7.01  *  x x - - x x - - - - x 0  111. Rab.kat,Kundekat,ogr,hgr,enh,lt=0
7.01  *  x x - - x x - - - - - 0  112. Rab.kat,Kundekat,ogr,hgr,lt=0
7.01  *  x x - - x - - - - - x x  113. Rab.kat,Kundekat,ogr,enh,lt
7.01  *  x x - - x - - - - - - x  114. Rab.kat,Kundekat,ogr,lt
7.01  *  x x - - x - - - - - x 0  115. Rab.kat,Kundekat,ogr,enh,lt=0
7.01  *  x x - - x - - - - - - 0  116. Rab.kat,Kundekat,ogr,lt=0
7.01  *  x x - - - - - - - - x x  117. Rab.kat,Kundekat,enh,lt
7.01  *  x x - - - - - - - - - x  118. Rab.kat,Kundekat,lt
7.01  *  x x - - - - - - - - x 0  119. Rab.kat,Kundekat,enh,lt=0
7.01  *  x x - - - - - - - - - 0  120. Rab.kat,Kundekat,lt=0
7.01  *
7.01  *  - x - - - - - - - x x x  121. Kundekat,vare,enh,lt
7.01  *  - x - - - - - - - x - x  122. Kundekat,vare,lt
7.01  *  - x - - - - - - - x x 0  123. Kundekat,vare,enh,lt=0
7.01  *  - x - - - - - - - x - 0  124. Kundekat,vare,lt=0
7.01  *  - x - - - - - - x - x x  125. Kundekat,modul,enh,lt
7.01  *  - x - - - - - - x - - x  126. Kundekat,modul,lt
7.01  *  - x - - - - - - x - x 0  127. Kundekat,modul,enh,lt=0
7.01  *  - x - - - - - - x - - 0  128. Kundekat,modul,lt=0
7.01  *  - x - - x x x x - - x x  129. Kundekat,ogr,hgr,ugr,lev,enh,lt
7.01  *  - x - - x x x x - - - x  130. Kundekat,ogr,hgr,ugr,lev,lt
7.01  *  - x - - x x x x - - x 0  131. Kundekat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  - x - - x x x x - - - 0  132. Kundekat,ogr,hgr,ugr,lev,lt=0
7.01  *  - x - - x x - x - - x x  133. Kundekat,ogr,hgr,lev,enh,lt
7.01  *  - x - - x x - x - - - x  134. Kundekat,ogr,hgr,lev,lt
7.01  *  - x - - x x - x - - x 0  135. Kundekat,ogr,hgr,lev,enh,lt=0
7.01  *  - x - - x x - x - - - 0  136. Kundekat,ogr,hgr,lev,lt=0
7.01  *  - x - - x - - x - - x x  137. Kundekat,ogr,lev,enh,lt
7.01  *  - x - - x - - x - - - x  138. Kundekat,ogr,lev,lt
7.01  *  - x - - x - - x - - x 0  139. Kundekat,ogr,lev,enh,lt=0
7.01  *  - x - - x - - x - - - 0  140. Kundekat,ogr,lev,lt=0
7.01  *  - x - - - - - x - - x x  141. Kundekat,lev,enh,lt
7.01  *  - x - - - - - x - - - x  142. Kundekat,lev,lt
7.01  *  - x - - - - - x - - x 0  143. Kundekat,lev,enh,lt=0
7.01  *  - x - - - - - x - - - 0  144. Kundekat,lev,lt=0
7.01  *  - x - - x x x - - - x x  145. Kundekat,ogr,hgr,ugr,enh,lt
7.01  *  - x - - x x x - - - - x  146. Kundekat,ogr,hgr,ugr,lt
7.01  *  - x - - x x x - - - x 0  147. Kundekat,ogr,hgr,ugr,enh,lt=0
7.01  *  - x - - x x x - - - - 0  148. Kundekat,ogr,hgr,ugr,lt=0
7.01  *  - x - - x x - - - - x x  149. Kundekat,ogr,hgr,enh,lt
7.01  *  - x - - x x - - - - - x  150. Kundekat,ogr,hgr,lt
7.01  *  - x - - x x - - - - x 0  151. Kundekat,ogr,hgr,enh,lt=0
7.01  *  - x - - x x - - - - - 0  152. Kundekat,ogr,hgr,lt=0
7.01  *  - x - - x - - - - - x x  153. Kundekat,ogr,enh,lt
7.01  *  - x - - x - - - - - - x  154. Kundekat,ogr,lt
7.01  *  - x - - x - - - - - x 0  155. Kundekat,ogr,enh,lt=0
7.01  *  - x - - x - - - - - - 0  156. Kundekat,ogr,lt=0
7.01  *  - x - - - - - - - - x x  157. Kundekat,enh,lt
7.01  *  - x - - - - - - - - - x  158. Kundekat,lt
7.01  *  - x - - - - - - - - x 0  159. Kundekat,enh,lt=0
7.01  *  - x - - - - - - - - - 0  160. Kundekat,lt=0
      *
7.01  *  x - - - - - - - - x x x  161. Rab.kat,vare,enh,lt
7.01  *  x - - - - - - - - x - x  162. Rab.kat,vare,lt
7.01  *  x - - - - - - - - x x 0  163. Rab.kat,vare,enh,lt=0
7.01  *  x - - - - - - - - x - 0  164. Rab.kat,vare,lt=0
7.01  *  x - - - - - - - x - x x  165. Rab.kat,modul,enh,lt
7.01  *  x - - - - - - - x - - x  166. Rab.kat,modul,lt
7.01  *  x - - - - - - - x - x 0  167. Rab.kat,modul,enh,lt=0
7.01  *  x - - - - - - - x - - 0  168. Rab.kat,modul,lt=0
7.01  *  x - - - x x x x - - x x  169. Rab.kat,ogr,hgr,ugr,lev,enh,lt
7.01  *  x - - - x x x x - - - x  170. Rab.kat,ogr,hgr,ugr,lev,lt
7.01  *  x - - - x x x x - - x 0  171. Rab.kat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  x - - - x x x x - - - 0  172. Rab.kat,ogr,hgr,ugr,lev,lt=0
7.01  *  x - - - x x - x - - x x  173. Rab.kat,ogr,hgr,lev,enh,lt
7.01  *  x - - - x x - x - - - x  174. Rab.kat,ogr,hgr,lev,lt
7.01  *  x - - - x x - x - - x 0  175. Rab.kat,ogr,hgr,lev,enh,lt=0
7.01  *  x - - - x x - x - - - 0  176. Rab.kat,ogr,hgr,lev,lt=0
7.01  *  x - - - x - - x - - x x  177. Rab.kat,ogr,lev,enh,lt
7.01  *  x - - - x - - x - - - x  178. Rab.kat,ogr,lev,lt
7.01  *  x - - - x - - x - - x 0  179. Rab.kat,ogr,lev,enh,lt=0
7.01  *  x - - - x - - x - - - 0  180. Rab.kat,ogr,lev,lt=0
7.01  *  x - - - - - - x - - x x  181. Rab.kat,lev,enh,lt
7.01  *  x - - - - - - x - - - x  182. Rab.kat,lev,lt
7.01  *  x - - - - - - x - - x 0  183. Rab.kat,lev,enh,lt=0
7.01  *  x - - - - - - x - - - 0  184. Rab.kat,lev,lt=0
7.01  *  x - - - x x x - - - x x  185. Rab.kat,ogr,hgr,ugr,enh,lt
7.01  *  x - - - x x x - - - - x  186. Rab.kat,ogr,hgr,ugr,lt
7.01  *  x - - - x x x - - - x 0  187. Rab.kat,ogr,hgr,ugr,enh,lt=0
7.01  *  x - - - x x x - - - - 0  188. Rab.kat,ogr,hgr,ugr,lt=0
7.01  *  x - - - x x - - - - x x  189. Rab.kat,ogr,hgr,enh,lt
7.01  *  x - - - x x - - - - - x  190. Rab.kat,ogr,hgr,lt
7.01  *  x - - - x x - - - - x 0  191. Rab.kat,ogr,hgr,enh,lt=0
7.01  *  x - - - x x - - - - - 0  192. Rab.kat,ogr,hgr,lt=0
7.01  *  x - - - x - - - - - x x  193. Rab.kat,ogr,enh,lt
7.01  *  x - - - x - - - - - - x  194. Rab.kat,ogr,lt
7.01  *  x - - - x - - - - - x 0  195. Rab.kat,ogr,enh,lt=0
7.01  *  x - - - x - - - - - - 0  196. Rab.kat,ogr,lt=0
7.01  *  x - - - - - - - - - x x  197. Rab.kat,enh,lt
7.01  *  x - - - - - - - - - - x  198. Rab.kat,lt
7.01  *  x - - - - - - - - - x 0  199. Rab.kat,enh,lt=0
7.01  *  x - - - - - - - - - - 0  200. Rab.kat,lt=0
      *
7.01  *  - - - - - - - - - x x x  201. Rab.kat,vare,enh,lt
7.01  *  - - - - - - - - - x - x  202. Rab.kat,vare,lt
7.01  *  - - - - - - - - - x x 0  203. Rab.kat,vare,enh,lt=0
7.01  *  - - - - - - - - - x - 0  204. Rab.kat,vare,lt=0
7.01  *  - - - - - - - - x - x x  205. Rab.kat,modul,enh,lt
7.01  *  - - - - - - - - x - - x  206. Rab.kat,modul,lt
7.01  *  - - - - - - - - x - x 0  207. Rab.kat,modul,enh,lt=0
7.01  *  - - - - - - - - x - - 0  208. Rab.kat,modul,lt=0
7.01  *  - - - - x x x x - - x x  209. Rab.kat,ogr,hgr,ugr,lev,enh,lt
7.01  *  - - - - x x x x - - - x  210. Rab.kat,ogr,hgr,ugr,lev,lt
7.01  *  - - - - x x x x - - x 0  211. Rab.kat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  - - - - x x x x - - - 0  212. Rab.kat,ogr,hgr,ugr,lev,lt=0
7.01  *  - - - - x x - x - - x x  213. Rab.kat,ogr,hgr,lev,enh,lt
7.01  *  - - - - x x - x - - - x  214. Rab.kat,ogr,hgr,lev,lt
7.01  *  - - - - x x - x - - x 0  215. Rab.kat,ogr,hgr,lev,enh,lt=0
7.01  *  - - - - x x - x - - - 0  216. Rab.kat,ogr,hgr,lev,lt=0
7.01  *  - - - - x - - x - - x x  217. Rab.kat,ogr,lev,enh,lt
7.01  *  - - - - x - - x - - - x  218. Rab.kat,ogr,lev,lt
7.01  *  - - - - x - - x - - x 0  219. Rab.kat,ogr,lev,enh,lt=0
7.01  *  - - - - x - - x - - - 0  220. Rab.kat,ogr,lev,lt=0
7.01  *  - - - - - - - x - - x x  221. Rab.kat,lev,enh,lt
7.01  *  - - - - - - - x - - - x  222. Rab.kat,lev,lt
7.01  *  - - - - - - - x - - x 0  223. Rab.kat,lev,enh,lt=0
7.01  *  - - - - - - - x - - - 0  224. Rab.kat,lev,lt=0
7.01  *  - - - - x x x - - - x x  225. Rab.kat,ogr,hgr,ugr,enh,lt
7.01  *  - - - - x x x - - - - x  226. Rab.kat,ogr,hgr,ugr,lt
7.01  *  - - - - x x x - - - x 0  227. Rab.kat,ogr,hgr,ugr,enh,lt=0
7.01  *  - - - - x x x - - - - 0  228. Rab.kat,ogr,hgr,ugr,lt=0
7.01  *  - - - - x x - - - - x x  229. Rab.kat,ogr,hgr,enh,lt
7.01  *  - - - - x x - - - - - x  230. Rab.kat,ogr,hgr,lt
7.01  *  - - - - x x - - - - x 0  231. Rab.kat,ogr,hgr,enh,lt=0
7.01  *  - - - - x x - - - - - 0  232. Rab.kat,ogr,hgr,lt=0
7.01  *  - - - - x - - - - - x x  233. Rab.kat,ogr,enh,lt
7.01  *  - - - - x - - - - - - x  234. Rab.kat,ogr,lt
7.01  *  - - - - x - - - - - x 0  235. Rab.kat,ogr,enh,lt=0
7.01  *  - - - - x - - - - - - 0  236. Rab.kat,ogr,lt=0
7.01  *  - - - - - - - - - - x x  237. Rab.kat,enh,lt
7.01  *  - - - - - - - - - - - x  238. Rab.kat,lt
7.01  *  - - - - - - - - - - x 0  239. Rab.kat,enh,lt=0
7.01  *  - - - - - - - - - - - 0  240. Rab.kat,lt=0
      *
      * Kunde/kundeprosjekt...
      *
     c                   if        w_kund <> 0 and
     c                             w_kpro <> 0
      *
      * 1.-4.
      *
     c                   eval      fpril1_rkat = 0
     c                   eval      fpril1_kkat = 0
     c                   eval      fpril1_kund = w_kund
     c                   eval      fpril1_kpro = w_kpro
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = w_kund
     c                   eval      frabl1_kpro = w_kpro
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 2
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 3
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 4
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 5
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 5.-8.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 6
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 7
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 8
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 9
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 9.-12.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 10
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 11
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 12
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 13
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 13.-16.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 14
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 15
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 16
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 17
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 17.-20.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 18
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 19
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 20
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 21
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 21.-24.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 22
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 23
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 23
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 24
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 25.-28.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 25
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 26
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 27
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 28
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 29.-32.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 29
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 30
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 31
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 32
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 33.-36.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 33
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 34
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 35
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 36
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 37.-40.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 37
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 38
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 39
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 40
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * Kunde...
      *
     c                   if        w_kund <> 0
      *
      * 41.-44.
      *
     c                   eval      fpril1_rkat = 0
     c                   eval      fpril1_kkat = 0
     c                   eval      fpril1_kund = w_kund
     c                   eval      fpril1_kpro = 0
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = w_kund
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 41
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 42
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 43
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 44
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 45.-48.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 45
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 46
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 47
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 48
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 49.-52.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 49
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 50
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 51
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 52
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 53.-56.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 53
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 54
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 55
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 56
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 57.-60.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 57
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 58
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 59
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 60
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 61.-64.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 61
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 62
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 63
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 64
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 65.-68.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 65
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 66
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 67
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 68
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 69.-72.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 69
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 70
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 71
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 72
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 73.-76.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 73
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 74
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 75
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 76
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 77.-80.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 77
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 78
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 77
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
6.33 c                   eval      w_niva = 78
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
7.01  *
7.01  * Kundekategori og rabattkategori
7.01  *
7.01 c                   if        w_kkat <> 0 and
7.01 c                             w_rkat <> 0
7.01  *
7.01  * 81.-84.
7.01  *
7.01 c                   eval      fpril1_rkat = w_rkat
7.01 c                   eval      fpril1_kkat = w_kkat
7.01 c                   eval      fpril1_kund = 0
7.01 c                   eval      fpril1_kpro = 0
7.01 c                   eval      fpril1_vare = hivare
7.01 c                   eval      fpril1_enhe = hienhe
7.01 c                   eval      fpril1_lety = hilety
7.01 c     fpril1_key    chain     fpril1
7.01 c                   if        %found
7.01 c                   exsr      spesialpris
7.01 c                   if        b_spes = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_rkat = w_rkat
7.01 c                   eval      frabl1_kkat = w_kkat
7.01 c                   eval      frabl1_kund = 0
7.01 c                   eval      frabl1_kpro = 0
7.01 c                   eval      frabl1_ogrp = 0
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = hivare
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 79
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 80
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0
7.01 c                   eval      fpril1_lety = 0
7.01 c     fpril1_key    chain     fpril1
7.01 c                   if        %found
7.01 c                   exsr      spesialpris
7.01 c                   if        b_spes = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 81
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 82
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 85.-88.
7.01  *
7.01 c                   if        vvnmod <> 0
7.01  *
7.01 c                   eval      frabl1_modn = vvnmod
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 83
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 84
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 85
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 86
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 89.-92.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = vvugrp
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 87
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 88
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 89
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 90
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 93.-96.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 91
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 92
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 92
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 93
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 97.-100.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 94
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 95
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 96
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 101.-104.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = 0
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 97
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 98
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 99
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 100
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 105.-108.
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = vvugrp
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 101
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 102
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 103
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 104
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 109.-112.
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 105
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 106
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 107
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 108
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 113.-116.
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 109
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 110
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 111
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 112
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 117.-120.
7.01  *
7.01 c                   eval      frabl1_ogrp = 0
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 113
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 114
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 115
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   eval      w_niva = 116
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
      * Kundekategori...
      *
     c                   if        w_kkat <> 0
      *
7.01  * 121.-124.
      *
     c                   eval      fpril1_rkat = 0
     c                   eval      fpril1_kkat = w_kkat
     c                   eval      fpril1_kund = 0
     c                   eval      fpril1_kpro = 0
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = w_kkat
     c                   eval      frabl1_kund = 0
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 119
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 120
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 121
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 122
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 125.-128.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 123
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 124
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 125
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 126
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 129.-132.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 127
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 128
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 129
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 130
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 133.-136.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 131
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 132
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 132
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 133
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 137.-140.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 134
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 135
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 136
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 141.-144.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 137
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 138
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 139
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 140
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 145.-148.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 141
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 142
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 143
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 144
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 149.-152.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 145
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 146
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 147
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 148
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 113.-116.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 149
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 150
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 151
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 152
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 157.-160.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 153
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 154
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 155
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 156
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * Rabattkategori...
      *
     c                   if        w_rkat <> 0
      *
      * 121.-124.
      *
     c                   eval      fpril1_rkat = w_rkat
     c                   eval      fpril1_kkat = 0
     c                   eval      fpril1_kund = 0
     c                   eval      fpril1_kpro = 0
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = w_rkat
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = 0
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 157
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 158
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 159
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 160
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 165.-168.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 161
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 162
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 163
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 164
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 169.-172.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 165
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 166
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 167
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 168
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 173.-176.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 169
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 170
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 171
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 172
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 177.-180.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 173
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 174
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 175
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 176
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 181.-184.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 177
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 178
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 179
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 180
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 185.-188.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 181
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 182
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 183
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 184
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 189.-192.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 185
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 186
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 187
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 188
7.01 c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 193.-196.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 189
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 190
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 191
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 192
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 157.-160.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 193
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 194
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 195
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 196
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * Generell...
      *
      * 161.-164.
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = 0
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 197
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 198
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 199
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 200
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 205.-208.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 201
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 202
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 203
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 204
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 169.-172.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 205
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 206
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 207
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 208
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 213.-216.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 209
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 210
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 211
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 212
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 217.-220.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 213
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 214
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 215
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 216
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 221.-224.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 217
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 218
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 219
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 220
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 225.-228.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 221
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 222
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 223
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 224
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 229.-232.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 225
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 226
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 227
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 228
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 193.-196.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 229
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 230
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 231
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 232
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 237.-240.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 233
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 234
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 235
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
7.01 c                   eval      w_niva = 236

     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente bruksrett-rabatt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_bruksrettbegsr
      *
      * Avbryter dersom kunde ikke er knyttet mot almenning, eller
      * dersom det er valgt å oppheve bruksretten på salget
      *
     c                   if        w_alme = 0 or
     c                             w_priv = 1
     c                   leavesr
     c                   endif
      *
      * Leter først etter bruksrett på varenivå
      *
     c                   eval      vbrkl5_alme = w_alme
     c                   eval      vbrkl5_vare = vvvare
     c     vbrkl5_key    chain     vbrkl5
     c                   if        not %found
      *
      * Leter etter bruksrett på modul og varegruppe-nivå
      *
     c                   eval      vbrkl1_alme = w_alme
     c                   eval      vbrkl1_ogrp = vvogrp
     c                   eval      vbrkl1_hgrp = vvhgrp
     c                   eval      vbrkl1_ugrp = vvugrp
     c                   eval      vbrkl1_modn = vvnmod
     c                   eval      vbrkl1_vare = *blank
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   eval      vbrkl1_modn = 0
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   eval      vbrkl1_ugrp = 0
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   eval      vbrkl1_hgrp = 0
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   eval      hoalme = w_alme
     c                   eval      hobrty = vbbrty
      *
     c                   eval      rmbtl1_talm = w_alme
     c                   eval      rmbtl1_tbrt = vbbrty
     c     rmbtl1_key    chain     rmbtl1
     c                   if        %found
     c                   eval      hobrr1 = rmtra1
     c                   eval      hobrr2 = rmtra2
     c                   if        hoomva <> '4' and
     c                             hoomva <> '0'
     c                   eval      hoomva = rmtmva
     c                   endif
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente spesialprisinformasjon fra spesialpris-
      * matrise
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     spesialpris   begsr
      *
     c                   eval      b_spes = *off
      *
     c                   eval      w_sapr = 0
     c                   eval      w_rab1 = 0
     c                   eval      w_rab2 = 0
     c                   eval      w_kopr = 0
      *
     c                   if        fpfdat = *loval or
     c                             hidato >= fpfdat and
     c                             hidato <= fptdat
      *
     c                   eval      b_spes = *on
      *
     c                   eval      w_sapr = fpsapr
     c                   eval      w_rab1 = fprab1
     c                   eval      w_rab2 = fprab2
     c                   eval      w_kopr = fpkopr
      *
     c                   eval      holety = fplety
6.3f c                   eval      hoprgr = fpprgr
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente rabatter eller DG etter treff i rabatt-
      * matrisen
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     rabatt        begsr
      *
     c                   eval      b_raba = *off
      *
     c                   eval      w_rab1 = 0
     c                   eval      w_rab2 = 0
     c                   eval      w_rabn = 0
     c                   eval      w_rabb = 0
     c                   eval      w_rabt = 0
     c                   eval      w_dekn = 0
      *
      * Henter rabatter i.h.t. dato og nivå i rabattmatrisen
      *
      * 0-rabatt
      *
     c                   if        frrab1 = 0 and
     c                             frra1d = 0 and
     c                             frrab2 = 0 and
     c                             frra2d = 0 and
     c                             frrabn = 0 and
     c                             frrand = 0 and
     c                             frrabb = 0 and
     c                             frrabd = 0 and
     c                             frrabt = 0 and
     c                             frratd = 0 and
     c                             frdekn = 0 and
     c                             frdekd = 0
     c                   eval      b_raba = *on
     c                   leavesr
     c                   endif
      *
      * Linjerabatt 1
      *
     c                   if        frrab1 <> 0 or
     c                             frra1d <> 0
      *
     c                   if        frra1d <> 0 and
     c                             hidato >= frra1f and
     c                             hidato <= frra1t
     c                   eval      w_rab1 = frra1d
     c                   else
     c                   eval      w_rab1 = frrab1
     c                   endif
      *
     c                   endif
      *
      * Linjerabatt 2
      *
     c                   if        frrab2 <> 0 or
     c                             frra2d <> 0
      *
     c                   if        frra2d <> 0 and
     c                             hidato >= frra2f and
     c                             hidato <= frra2t
     c                   eval      w_rab2 = frra2d
     c                   else
     c                   eval      w_rab2 = frrab2
     c                   endif
      *
     c                   endif
      *
      * Rabatt på nettopris
      *
     c                   if        frrabn <> 0 or
     c                             frrand <> 0
      *
     c                   if        frrand <> 0 and
     c                             hidato >= frranf and
     c                             hidato <= frrant
     c                   eval      w_rabn = frrand
     c                   else
     c                   eval      w_rabn = frrabn
     c                   endif
      *
     c                   endif
      *
      * Rabatt på bunnpris
      *
     c                   if        frrabb <> 0 or
     c                             frrabd <> 0
      *
     c                   if        frrabd <> 0 and
     c                             hidato >= frrbuf and
     c                             hidato <= frrbut
     c                   eval      w_rabb = frrabd
     c                   else
     c                   eval      w_rabb = frrabb
     c                   endif
      *
     c                   endif
      *
      * Rabatt på tilbudspris
      *
     c                   if        frrabt <> 0 or
     c                             frratd <> 0
      *
     c                   if        frratd <> 0 and
     c                             hidato >= frratf and
     c                             hidato <= frratt
     c                   eval      w_rabt = frratd
     c                   else
     c                   eval      w_rabt = frrabt
     c                   endif
      *
     c                   endif
      *
      * Dekningsgrad (DG). DG hentes kun dersom kostpris er funnet.
      *
     c                   if        hokopr <> 0
     c                   if        frdekn <> 0 or
     c                             frdekd <> 0
      *
     c                   if        frdekd <> 0 and
     c                             hidato >= frdekf and
     c                             hidato <= frdekt
     c                   eval      w_dekn = frdekd
     c                   else
     c                   eval      w_dekn = frdekn
     c                   endif
      *
     c                   endif
     c                   endif
      *
      * Sjekker om verdier er funnet i rabattmatrisen
      *
     c                   if        w_rab1 <> 0 or
     c                             w_rab2 <> 0 or
     c                             w_rabn <> 0 or
     c                             w_rabb <> 0 or
     c                             w_rabt <> 0 or
     c                             w_dekn <> 0
     c                   eval      b_raba = *on
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for beregning av rabatt/pris på vare
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     beregn_pris   begsr
      *
      * Dersom spesialpris er funnet skal denne benyttes
      * Dersom salgspris eller kostpris ikke er oppgitt som spesialpris,
      * benyttes standardverdier. Priskode settes alltid til 'A' (Avtalt)
      *
     c                   if        b_spes = *on
      *
     c                   eval      horab1 = w_rab1
     c                   eval      horab2 = w_rab2
     c                   eval      hokpri = 'A'
      *
     c                   if        w_sapr <> 0
     c                   eval      hosapr = w_sapr
     c                   endif
      *
     c                   if        w_kopr <> 0
     c                   eval      hokopr = w_kopr
     c                   endif
      *
     c                   leavesr
     c                   endif
6.3c  *
6.3c  * sjekker om det finnes kundeklubbpris
6.3c  *
6.3c c                   eval      w_klpr = 0
6.3c c                   if        hiklub = '1'
6.3c c                   exsr      sjekk_klub
6.3c c                   endif
      *
      * Dersom varen er diversevare eller tjeneste, eller dersom det ikke
      * ble treff i rabattmatrisen, kreves kjøper for laveste pris av
      * salgspris, butikkpris og tilbudspris
      *
5.70 c                   if        p_vtyp = 'D' or
5.70 c                             p_vtyp = 'T' or
     c                             b_raba = *off
     c                   if        w_bupr <> 0 and
     c                             w_bupr < hosapr
     c                   eval      hosapr = w_bupr
     c                   endif
     c                   if        w_tipr <> 0 and
     c                             w_tipr < hosapr
     c                   eval      holety = w_lety
     c                   eval      hosapr = w_tipr
6.27 c**                 eval      hoprgr = hiprgr
     c                   endif
6.3c c                   if        w_klpr <> 0 and
6.3c c                             w_klpr < hosapr
6.3c c                   eval      holety = w_letk
6.3c c                   eval      hosapr = w_klpr
6.3c c                   eval      hokamp = w_kamk
6.3c c                   eval      horab1 = 0
6.3c c                   eval      horab2 = 0
6.3c c                   endif
     c                   leavesr
     c                   endif
      *
      * Initierer beregnet salgspris
      *
     c                   eval      w_tipr_w = w_tipr
     c                   eval      w_sapr_w = hosapr
      *
      * Beregner tilbudspris fratrukket eventuelle rabatter
      *
     c                   if        w_tipr <> 0 and
     c                             w_rabt <> 0
     c                   eval(h)   w_tipr_w = w_tipr -
     c                                       (w_tipr * w_rabt / 100 )
     c                   endif
      *
      * Beregner salgspris fratrukket eventuelle rabatter
      *
      * Bunnpriset-vare
      *
     c                   if        vvkpri = 'B'
     c                   if        w_rabb <> 0
     c                   eval(h)   w_sapr_w = hosapr -
     c                                        (hosapr * w_rabb / 100)
     c                   endif
     c                   eval      horab1 = w_rabb
     c                   eval      horab2 = 0
     c                   endif
      *
      * Nettopriset-vare
      *
     c                   if        vvkpri = 'N'
     c                   if        w_rabn <> 0
     c                   eval(h)   w_sapr_w = hosapr -
     c                                        (hosapr * w_rabn / 100)
     c                   endif
     c                   eval      horab1 = w_rabn
     c                   eval      horab2 = 0
     c                   endif
      *
      * Ordinært priset vare
      *
     c                   if        vvkpri = *blank
     c                   if        w_rab1 <> 0
     c                   eval(h)   w_sapr_w = hosapr -
     c                                       (hosapr * w_rab1 / 100)
     c                   endif
     c                   if        w_rab2 <> 0
     c                   eval(h)   w_sapr_w = w_sapr_w -
     c                                       (w_sapr_w * w_rab2 / 100)
     c                   endif
     c                   eval      horab1 = w_rab1
     c                   eval      horab2 = w_rab2
     c                   endif
      *
      * Beregner salgspris etter dekningsgrad (DG)
      *
     c                   if        w_dekn <> 0 and
     c                             hosapr <> 0
      *
     c                   if        w_dekn = 100
     c                   eval      w_dgpr = hosapr
     c                   eval      w_raba = 0
     c                   else
     c                   eval(h)   w_dgpr = (100 * hokopr) / (100 - w_dekn)
     c                   eval      w_raba = hosapr - w_dgpr
     c                   endif
      *
     c                   select
     c                   when      (100 * w_raba / hosapr) < -999,99
     c                   eval      w_rabd = -999,99
     c                   when      (100 * w_raba / hosapr) > 999,99
     c                   eval      w_rabd = 999,99
     c                   other
     c                   eval(h)   w_rabd = 100 * w_raba / hosapr
     c                   endsl
      *
     c                   endif
      *
      * Sammenligner salgspris etter rabatter/DG med tilbudspris etter
      * rabatt og butikkpris. Kjøper kreves for laveste pris.
      *
     c                   eval      w_ntpr = w_sapr_w
      *
     c                   if        w_dgpr <> 0 and
     c                             w_dgpr < w_ntpr
     c                   eval      w_ntpr = w_dgpr
     c                   eval      horab1 = w_rabd
     c                   eval      horab2 = 0
     c                   endif
      *
     c                   if        w_tipr <> 0 and
     c                             w_tipr_w < w_ntpr
     c                   eval      w_ntpr = w_tipr_w
     c                   eval      holety = w_lety
     c                   eval      hosapr = w_tipr
     c                   eval      horab1 = w_rabt
     c                   eval      horab2 = 0
6.32 c*                  eval      hoprgr = hiprgr
     c                   endif
      *
     c                   if        w_bupr <> 0 and
     c                             w_bupr < w_ntpr
     c                   eval      hosapr = w_bupr
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
     c                   endif
      *
6.3c c                   if        w_klpr <> 0 and
6.3c c                             w_klpr < w_ntpr
6.3c c                   eval      hosapr = w_klpr
6.3c c                   eval      horab1 = 0
6.3c c                   eval      horab2 = 0
6.3c c                   endif
6.3c  *
     c                   endsr
      *
6.3c  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.3c  * Subrutine for å sjekke om det finnes noe for kundeklubb
6.3c  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.3c  *
6.3c c     sjekk_klub    begsr
6.3c c                   eval      b_ogrp = *off
6.3c c                   eval      w_klpr = 0
6.3c c                   eval      w_letk = 0
6.3c c                   eval      w_kopk = 0
6.3c  *
6.3c c                   eval      vklul1_ogrp = 0
6.3c c                   eval      vklul1_hgrp = 0
6.3c c                   eval      vklul1_ugrp = 0
6.3c c                   eval      vklul1_ldor = 0
6.3c c                   eval      vklul1_vare = hivare
6.3c c                   eval      vklul1_prgr = hiprgr
6.3c c                   eval      vklul1_lety = hilety
6.3c c                   exsr      klub_matr
6.3c  *
6.3c c                   if        w_klpr = 0 and
6.3c c                             hilety <> 0
6.3c c                   eval      vklul1_vare = hivare
6.3c c                   eval      vklul1_prgr = hiprgr
6.3c c                   eval      vklul1_lety = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *
6.3c  * Dersom pris ikke finnes for oppgitt prisgruppe, hentes pris fra
6.3c  * prisgruppe blank
6.3c  *
6.3c c                   if        w_klpr = 0 and
6.3c c                             hiprgr <> *blank
6.3c c                   eval      vklul1_vare = hivare
6.3c c                   eval      vklul1_prgr = *blank
6.3c c                   eval      vklul1_lety = hilety
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *
6.3c c                   if        w_klpr = 0 and
6.3c c                             hilety <> 0
6.3c c                   eval      vklul1_vare = hivare
6.3c c                   eval      vklul1_prgr = *blank
6.3c c                   eval      vklul1_lety = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *
6.3c  *  overgruppe,hovedgruppe,undergruppe
6.3c  *
6.3c c                   if        w_klpr = 0
6.3c c                   eval      b_ogrp = *on
6.3c c                   eval      vklul1_ogrp = vvogrp
6.3c c                   eval      vklul1_hgrp = vvhgrp
6.3c c                   eval      vklul1_ugrp = vvugrp
6.3c c                   eval      vklul1_ldor = 0
6.3c c                   eval      vklul1_lety = 0
6.3c c                   eval      vklul1_vare = *blank
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  overgruppe,hovedgruppe
6.3c c                   if        w_klpr = 0
6.3c c                   eval      vklul1_ugrp = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  overgruppe
6.3c c                   if        w_klpr = 0
6.3c c                   eval      vklul1_hgrp = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  overgruppe,hovedgruppe,undergruppe, leverandør
6.3c c                   if        w_klpr = 0
6.3c c                   eval      vklul1_ogrp = vvogrp
6.3c c                   eval      vklul1_hgrp = vvhgrp
6.3c c                   eval      vklul1_ugrp = vvugrp
6.3c c                   eval      vklul1_ldor = w_pldo
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  overgruppe,hovedgruppe              leverandør
6.3c c                   if        w_klpr = 0
6.3c c                   eval      vklul1_ugrp = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  overgruppe                          leverandør
6.3c c                   if        w_klpr = 0
6.3c c                   eval      vklul1_hgrp = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  leverandør
6.3c c                   if        w_klpr = 0
6.3c c                   eval      vklul1_ogrp = 0
6.3c c                   exsr      klub_matr
6.3c c                   endif
6.3c  *  Indikere om vi fant pris på kundeklubb matrisen eller ikke
6.3c c                   if        w_klpr <> 0
6.3c c                   eval      hoklub = '1'
6.3c c                   endif
6.3c  *
6.3c c                   endsr
6.3c  *---------------------------------------------------------------------
6.3c  * Subrutine for å sjekke om nivået har noe for kundeklubb
6.3c  *---------------------------------------------------------------------
6.3c c     klub_matr     begsr
6.3c c                   eval      w_kamk = *blank
6.3c  *
6.3c c     vklul1_key    setll     vklul1
6.3c c     vklul1_key    reade     vklul1
6.3c c                   dow       not %eof
6.3c c                   if        hidato >= vtkfda and
6.3c c                             hidato <= vtktda
6.3c c                   if        hidato <> vtkfda or
6.3c c                             hidato = vtkfda and
6.3c c                             hitime >= vtkfti
6.3c c                   if        hidato <> vtktda or
6.3c c                             hidato = vtktda and
6.3c c                             hitime <= vtktti
6.3c  *
6.3c c                   eval      w_kamk = vtkkam
6.3c  *
6.3c c                   if        b_ogrp = *on
6.3c  * her går rabatt på % og varegr eller leverandør
6.3c c                   eval(h)   w_klpr = hosapr -
6.3c c                                      (hosapr * vtkpr1)/100
6.3c c                   else
6.3c c                   select
6.3c c                   when      hienhe = vtken1
6.3c c                   eval      w_letk = vtklet
6.3c c                   eval      w_klpr = vtkti1
6.3c c                   if        vtkko1 <> 0
6.3c c                   eval      w_kopk = vtkko1
6.3c c                   endif
6.3c c                   when      hienhe = vtken2
6.3c c                   eval      w_letk = vtklet
6.3c c                   eval      w_klpr = vtkti2
6.3c c                   if        vtkko2 <> 0
6.3c c                   eval      w_kopk = vtkko2
6.3c c                   endif
6.3c c                   when      hienhe = vtken3
6.3c c                   eval      w_letk = vtklet
6.3c c                   eval      w_klpr = vtkti3
6.3c c                   if        vtkko3 <> 0
6.3c c                   eval      w_kopk = vtkko3
6.3c c                   endif
6.3c c                   endsl
6.3c c                   endif
6.3c  *
6.3c c                   leavesr
6.3c  *
6.3c c                   endif
6.3c c                   endif
6.3c c                   endif
6.3c c     vklul1_key    reade     vklul1
6.3c c                   enddo
6.3c  *
6.3c c                   endsr
6.3c  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering og nullstilling av variable
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     init          begsr
      *
      * Henter verdier fra input-parameter
      *
     c                   eval      hirec = p_irec
      *
     c                   eval      w_firm = hifirm
     c                   eval      w_rkat = hirkat
     c                   eval      w_kkat = 0
     c                   eval      w_kund = hikund
     c                   eval      w_kpro = hikpro
     c                   eval      w_avgf = hiavgf
     c                   eval      w_spfa = 0
     c                   eval      w_priv = hipriv
     c                   eval      w_alme = 0
6.3a c                   eval      p_vtyp = *blank
      *
      * Henter overstyringer fra kunde
      *
     c                   if        w_kund <> 0
     c                   eval      w_rkat = 0
     c                   eval      rkunl1_kund = w_kund
     c     rkunl1_key    chain     rkunl1
     c                   if        %found
8.02 c                   if        rklagr <> 0
8.02 c                   eval      w_lage = rklagr
8.02 c                   endif
     c                   eval      w_rkat = rkrabk
     c                   eval      w_kkat = rkkatg
     c                   eval      w_spfa = rkspfa
     c                   if        rkmkod = 1
     c                   eval      w_avgf = 1
     c                   endif
     c                   endif
     c                   endif
      *
      * Henter overstyringer fra kundeprosjekt
      *
     c                   if        w_kpro <> 0
      *
     c                   eval      fkprl1_kund = w_kund
     c                   eval      fkprl1_kpro = w_kpro
     c     fkprl1_key    chain     fkprl1
     c                   if        %found
      *
     c                   if        florka <> 0
     c                   eval      w_rkat = florka
     c                   endif
      *
6.31 c                   if        flmkod = 1
6.31 c                   eval      w_avgf = 1
6.31 c                   endif
      *
     c                   if        flokun <> 0
     c                   eval      w_kund = flokun
     c                   eval      w_kpro = 0
     c                   endif
      *
     c                   if        flokpr <> 0
     c                   eval      w_kpro = flokpr
     c                   endif
      *
     c                   if        flokun <> 0
     c                   eval      rkunl1_kund = flokun
     c     rkunl1_key    chain     rkunl1
     c                   if        %found
     c                   eval      w_rkat = rkrabk
     c                   eval      w_kkat = rkkatg
     c                   endif
     c                   endif
      *
     c                   if        flopda <> *loval
     c                   eval      hidato = flopda
     c                   endif
      *
     c                   if        flpriv = 1
     c                   eval      w_priv = 1
     c                   endif
      *
     c                   endif
     c                   endif
      *
      * Henter almenning
      *
     c                   eval      rmknl2_xknr = w_kund
     c     rmknl2_key    chain     rmknl2
     c                   if        %found
     c                   eval      w_alme = rmxalm
     c                   endif
      *
      * Initierer dato og klokkeslett
      *
     c                   if        hidato = *loval
     c                   time                    hidato
     c                   endif
      *
     c                   if        hitime = *loval
     c                   time                    hitime
     c                   endif
      *
      * Nullstiller output-parametre
      *
     c                   eval      holety = 0
     c                   eval      hokpri = *blank
     c                   eval      hooppr = 0
     c                   eval      hosapr = 0
     c                   eval      hokopr = 0
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
     c                   eval      hodekn = 0
     c                   eval      hopros = 0
     c                   eval      hokamp = *blank
     c                   eval      hoalme = 0
     c                   eval      hobrty = 0
     c                   eval      hobrr1 = 0
     c                   eval      hobrr2 = 0
     c                   eval      hoomva = *blank
5.70 c                   eval      hoprgr = *blank
      *
     c                   eval      p_orec = horec
      *
      * Initiering av variable
      *
     c                   eval      b_pris = *off
     c                   eval      b_spes = *off
     c                   eval      b_raba = *off
      *
     c                   eval      w_bupr = 0
     c                   eval      w_tipr = 0
6.26 c                   eval      w_prgr = *blank
     c                   eval      w_lety = 0
     c                   eval      w_sapr = 0
     c                   eval      w_kopr = 0
     c                   eval      w_rab1 = 0
     c                   eval      w_rab2 = 0
     c                   eval      w_rabn = 0
     c                   eval      w_rabb = 0
     c                   eval      w_rabt = 0
     c                   eval      w_dekn = 0
     c                   eval      w_ntpr = 0
     c                   eval      w_dgpr = 0
     c                   eval      w_rabd = 0
     c                   eval      w_raba = 0
     c                   eval      w_pasl = 0
      *
     c                   eval      w_tipr_w = 0
     c                   eval      w_sapr_w = 0
      *
     c                   endsr
6.20  *
6.25  *
6.25  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.25  * Subrutine for å hente tilbudspris på varegruppe/leverandørnivå
6.25  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.25  *
6.25 c     tilb_sjekk    begsr
6.25  *
6.25  *  overgruppe,hovedgruppe,undergruppe
6.25  *
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ogrp = vvogrp
6.25 c                   eval      vtill1_hgrp = vvhgrp
6.25 c                   eval      vtill1_ugrp = vvugrp
6.25 c                   eval      vtill1_ldor = 0
6.25 c                   eval      vtill1_lety = 0
6.25 c                   eval      vtill1_vare = *blank
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe,hovedgruppe
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ugrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_hgrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe,hovedgruppe,undergruppe, leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ogrp = vvogrp
6.25 c                   eval      vtill1_hgrp = vvhgrp
6.25 c                   eval      vtill1_ugrp = vvugrp
6.25 c                   eval      vtill1_ldor = w_pldo
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe,hovedgruppe              leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ugrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe                          leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_hgrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ogrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *
6.25 c                   endsr
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  * Subrutine for å hente tilbudspris på varegruppe/leverandørnivå
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.20  *
6.20 c     hent_tilb     begsr
6.20  *
6.21 c     vtill1_key    setll     vtill1
6.21 c     vtill1_key    reade     vtill1                                 90
6.21 c                   dow       *in90 = *off
6.21 c                   if        hidato >= vtfdat and
6.21 c                             hidato <= vttdat
6.21 c                   if        hidato <> vtfdat or
6.21 c                             hidato = vtfdat and
6.21 c                             hitime >= vtftim
6.21 c                   if        hidato <> vttdat or
6.21 c                             hidato = vttdat and
6.21 c                             hitime <= vtttim
6.21  *
6.21 c                   eval      hokamp = vtkamp
6.21 c                   eval      w_lety = vtlety
6.21 c                   eval(h)   w_tipr = hosapr -
6.21 c                                      (hosapr * vtpro1)/100
6.21  *
6.21 c                   leave
6.21  *
6.21 c                   endif
6.21 c                   endif
6.21 c                   endif
6.21 c     vtill1_key    reade     vtill1                                 90
6.21 c                   enddo
6.21  *
6.21 c                   endsr
6.35  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.35  * Subrutine for å hente  å hente mva for skaff
6.35  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.35  *
6.35 c     mva_beh_1     begsr
6.35  *
7.02  * Avgiftsfritt salg fir mva-kode '4'
7.02  * Dersom kunde også skal ha spesialfaktura settes mva-kode til '0'
7.02  *
7.02 c                   if        hiavgf = 1 and
7.02 c                             w_spfa = 1
7.02 c                   eval      hoomva = '0'
7.02 c                   leavesr
7.02 c                   endif
6.35  *
6.39 c                   if        hiavgf = 1
6.39 c                   eval      vmval1_mkod = 1
6.39 c                   else
6.35 c                   eval      vmval1_mkod = 0
6.39 c                   endif
6.35 c     vmval1_key    chain     vmval1
6.35 c                   if        %found
6.35 c                   eval      hoomva = vamkof
6.35 c                   if        hiavgf = 2 and
6.35 c                             vamkuo <> *blank
6.35 c                   eval      hoomva = vamkuo
6.35 c                   endif
6.35 c                   else
6.35 c                   select
6.35 c                   when      vvkmva = 1
6.35 c                   eval      hoomva = '4'
6.35 c                   when      vvkmva = 2
6.35 c                   eval      hoomva = 'H'
6.35 c                   endsl
6.35 c                   endif
6.35  *
6.35 c                   endsr
6.35  *
7.03  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
7.03  * Subrutine for å sjekke om varen er i sortiment for C - sentrallagervarer
7.03  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
7.03  *
7.03 c     sjekk_vsor    begsr
7.03  *
7.03 c                   eval      b_sent = *off
7.03 c                   eval      vsdtl7_vare = vvvare
7.03 c     vsdtl7_key    setll     vsdtl7
7.03 c     vsdtl7_key    reade     vsdtl7
7.03 c                   dow       not %eof(vsdtl7)
7.03  *
7.03 c                   eval      vshel1_vsor = vdvsor
7.03 c                   eval      vshel1_lage = vdlage
7.03 c     vshel1_key    chain     vshel1
7.03 c                   if        %found(vshel1)
7.03 c                   if        vctype = 'C'
7.03 c                   eval      b_sent = *on
7.03 c                   leavesr
7.03 c                   endif
7.03 c                   endif
7.03  *
7.03 c     vsdtl7_key    reade     vsdtl7
7.03 c                   enddo
7.03  *
7.03 c                   endsr
7.03  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_irec
     c                   parm                    p_orec
      *
      * Key for oppslag på kunde
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Key for oppslag på almenning, eiendomsknytning
      *
     c     rmknl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rmknl2_xknr
      *
      * Key for oppslag på kundeprosjekt
      *
     c     fkprl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fkprl1_kund
     c                   kfld                    fkprl1_kpro
      *
      * Key for oppslag på vare
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for les på vare-pris
      *
     c     vvprl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvprl1_vare
6.20 c                   kfld                    vvprl1_ldor
5.70 c                   kfld                    vvprl1_prgr
     c                   kfld                    vvprl1_enhe
     c                   kfld                    vvprl1_lety
      *
      * Key for les på tilbud
      *
     c     vtill1_key    klist
     c                   kfld                    w_firm
6.21 c                   kfld                    vtill1_ogrp
6.21 c                   kfld                    vtill1_hgrp
6.21 c                   kfld                    vtill1_ugrp
6.21 c                   kfld                    vtill1_ldor
     c                   kfld                    vtill1_vare
5.70 c                   kfld                    vtill1_prgr
     c                   kfld                    vtill1_lety
      *
      * Key for oppslag på undergruppe
      *
     c     vugrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vugrl1_uogr
     c                   kfld                    vugrl1_uhgr
     c                   kfld                    vugrl1_uugr
      *
      * Key for oppslag på ordre-hode
      *
     c     fohel1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fohel1_numm
     c                   kfld                    fohel1_suff
      *
      * Key for oppslag på ordre-linje med varenummer
      *
     c     fodtlv_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtlv_vare
     c                   kfld                    fodtlv_numm
     c                   kfld                    fodtlv_suff
     c                   kfld                    fodtlv_enh1
      *
      * Key for oppslag på spesialpris
      *
     c     fpril1_key    klist
     c                   kfld                    w_firm
5.70 c                   kfld                    fpril1_prgr
     c                   kfld                    fpril1_rkat
     c                   kfld                    fpril1_kkat
     c                   kfld                    fpril1_kund
     c                   kfld                    fpril1_kpro
     c                   kfld                    fpril1_vare
     c                   kfld                    fpril1_enhe
     c                   kfld                    fpril1_lety
      *
      * Key for oppslag på rabattmatrise
      *
     c     frabl1_key    klist
     c                   kfld                    w_firm
5.70 c                   kfld                    frabl1_prgr
     c                   kfld                    frabl1_rkat
     c                   kfld                    frabl1_kkat
     c                   kfld                    frabl1_kund
     c                   kfld                    frabl1_kpro
     c                   kfld                    frabl1_ogrp
     c                   kfld                    frabl1_hgrp
     c                   kfld                    frabl1_ugrp
     c                   kfld                    frabl1_ldor
     c                   kfld                    frabl1_modn
     c                   kfld                    frabl1_vare
     c                   kfld                    frabl1_enhe
     c                   kfld                    frabl1_lety
      *
      * Key for oppslag på bruksrett-knytning
      *
     c     vbrkl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vbrkl1_alme
     c                   kfld                    vbrkl1_ogrp
     c                   kfld                    vbrkl1_hgrp
     c                   kfld                    vbrkl1_ugrp
     c                   kfld                    vbrkl1_modn
     c                   kfld                    vbrkl1_vare
      *
     c     vbrkl5_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vbrkl5_alme
     c                   kfld                    vbrkl5_vare
      *
      * Key for oppslag på bruksrett-type
      *
     c     rmbtl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rmbtl1_talm
     c                   kfld                    rmbtl1_tbrt
      *
      * Key for oppslag på vare (VA)
      *
     c     jvarl1_key    klist
     c                   kfld                    jvarl1_vare
      *
      * Key for oppslag på mva.-kode
      *
     c     vmval1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vmval1_mkod
      *
      * Key for oppslag på vare-detalj
      *
     c     jvdtl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jvdtl1_dvar
6.3c  *
6.3c  * Key for les på kundeklubb
6.3c  *
6.3c c     vklul1_key    klist
6.3c c                   kfld                    w_firm
6.3c c                   kfld                    vklul1_ogrp
6.3c c                   kfld                    vklul1_hgrp
6.3c c                   kfld                    vklul1_ugrp
6.3c c                   kfld                    vklul1_ldor
6.3c c                   kfld                    vklul1_vare
6.3c c                   kfld                    vklul1_prgr
6.3c c                   kfld                    vklul1_lety
7.03  *
7.03  * Key for les av varer fra sortiment
7.03  *
7.03 c     vsdtl7_key    klist
7.03 c                   kfld                    w_firm
7.03 c                   kfld                    vsdtl7_vare
7.03  *
7.03  * Key for les av soritment hode
7.03  *
7.03 c     vshel1_key    klist
7.03 c                   kfld                    w_firm
7.03 c                   kfld                    vshel1_vsor
7.03 c                   kfld                    vshel1_lage
5.70  *
5.70 c                   eval      w_lage = l_lage
6.3c c                   eval      hoklub = ' '
7.03  *
7.03  * Endring 7.03 Hvis sentrallager-vare, finn hovedleverandør (Skattum)
7.03  *
7.03   CallP CO402R(l_filg:w_firm:0:'VP900R_703':
7.03                    co402_verdi1:co402_verdi2);
7.03   if co402_verdi1 = '1';
7.03     u_703 = *on;
7.03   endif;
7.04  *
7.04  * Endring 7.04 Styre om beste pris eller siste, skal gjelde
7.04  *              ved tilbudspriser.                 (Skattum)
7.04  *
7.04   CallP CO402R(l_filg:w_firm:0:'VP900R_704':
7.04                    co402_verdi1:co402_verdi2);
7.04   if co402_verdi1 = '1';
7.04     u_704 = *on;
7.04   endif;
      *
     c                   endsr
