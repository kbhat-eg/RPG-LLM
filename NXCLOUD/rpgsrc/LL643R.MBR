      /TITLE  Summering av enkeltposter hyllevarmere
     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * Program . . . . : LL643R                                        *
      * Beskrivelse . . : Summering av enkeltposter hyllevarmere        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.*
      * --------- ------  ----------------------------------------------*
6.30  *  6.30     240914  Utvidet parameterliste                   Bsa  *
      *                                                                 *
      *                                                                 *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     flwa1l1    if   e           k disk    rename(lwa1pfr:lwa1l1r)
     flwa2l3    o    e             disk    rename(lwa2pfr:lwa2l3r)
      *
      /eject
      ********************  I N P U T  S E C T I O N  ********************
      *
      *
     d                 ds
     d n_brd                         15
     d  n_ogrp                        2  0 overlay(n_brd)
     d  n_hgrp                        2  0 overlay(n_brd:3)
     d  n_ugrp                        3  0 overlay(n_brd:5)
     d  n_vare                        8  0 overlay(n_brd:8)
      *
     d                 ds
     d g_brd                         15
     d  g_ogrp                        2  0 overlay(g_brd)
     d  g_hgrp                        2  0 overlay(g_brd:3)
     d  g_ugrp                        3  0 overlay(g_brd:5)
     d  g_vare                        8  0 overlay(g_brd:8)
      *
     d                uds
     d l_firm                944    946  0
      *
     d w_ogrp          s                   like(mlogrp)
     d w_hgrp          s                   like(mlhgrp)
     d w_ugrp          s                   like(mlugrp)
     d w_vare          s                   like(mlvare)
     d w_lagv          s                   like(mllagv)
     d w_omst          s                   like(mlomst)
     d w_enhl          s                   like(mlenhl)
     d g_enhl          s                   like(mlenhl)
      *
     d wtolve          s                   like(mllagv)
     d wtooms          s                   like(mlomst)
     d w_firm          s                   like(mlfirm)
     d wwlagv          s                   like(mllagv)
     d wwomst          s                   like(mlomst)
      *
     d w_parm          s            128
      *
      *  Parameter-rec
      *
     d                 ds
     d p_prec                       128
     d  p_fvar                        8  0 overlay(p_prec)
     d  p_tvar                        8  0 overlay(p_prec:9)
     d  p_flag                        2  0 overlay(p_prec:17)
     d  p_tlag                        2  0 overlay(p_prec:19)
     d  p_fogr                        2  0 overlay(p_prec:21)
     d  p_togr                        2  0 overlay(p_prec:23)
     d  p_fhgr                        2  0 overlay(p_prec:25)
     d  p_thgr                        2  0 overlay(p_prec:27)
     d  p_fugr                        3  0 overlay(p_prec:29)
     d  p_tugr                        3  0 overlay(p_prec:32)
     d  p_levn                        6  0 overlay(p_prec:35)
     d  p_sakb                        4    overlay(p_prec:41)
     d  p_vari                        1  0 overlay(p_prec:45)
     d  p_type                        1  0 overlay(p_prec:46)
6.30 d  p_hori                        1  0 overlay(p_prec:47)
      *
      /EJECT
      *
      *---------------------------------------------------------------
      *  Behandle enkeltposter
      *---------------------------------------------------------------
      *
     c     les           tag
      *
     c                   read      lwa1l1r                                60
      *
     c                   if        *in60 = *on
     c*                  move      *hival        g_brd
     c                   move      *on           *inlr
     c                   exsr      brkto
     c                   goto      slutt
     c                   endif
      *
      * Hent nøkkelfeltet
      *
      * Bygg opp bruddbegrep
      *
     c                   eval      n_ogrp = mlogrp
     c                   eval      n_hgrp = mlhgrp
     c                   eval      n_ugrp = mlugrp
     c                   eval      n_vare = mlvare
      *
      * Ta vare på innleste felt
      *
     c                   eval      w_ogrp = mlogrp
     c                   eval      w_hgrp = mlhgrp
     c                   eval      w_ugrp = mlugrp
     c                   eval      w_vare = mlvare
     c                   eval      w_enhl = mlenhl
     c                   eval      w_omst = mlomst
     c                   eval      w_lagv = mllagv
      *
      * Brudd i kontrollbegrepet
      *
     c     brudd         tag
      *
      * Første gang -
      * ikke test på brudd
      *
     c                   if        g_brd = *zeros
     c                   goto      neste
     c                   endif
      *
     c                   if        n_brd <> g_brd
     c                   exsr      brkto
     c                   endif
      *
     c     neste         tag
      *
     c                   move      n_brd         g_brd
     c                   move      w_enhl        g_enhl
      *
      * Summer til bruddsummer
      *
     c                   eval      wwomst = wwomst + w_omst
     c                   eval      wwlagv = wwlagv + w_lagv
      *
     c                   goto      les
      *
      /EJECT
      *
      *  END OF JOB
      *
     c     slutt         tag
      *
      * Legg ut totaler
      *
     c                   eval      mwvare = *zeros
     c                   eval      mwogrp = *zeros
     c                   eval      mwhgrp = *zeros
     c                   eval      mwugrp = *zeros
     c                   eval      mwenhl = *blank
      *
     c                   if        p_type = 1
     c                   eval      mwomst = wtooms
     c                   endif
      *                                                                 .
     c                   eval      mwlagv = wtolve
      *
     c                   write     lwa2l3r
      *
      /EJECT
      ****************************************************************
      *   SUBRUTINE FOR BEHANDLING VED BRUDD                         *
      ****************************************************************
      *
     c     brkto         begsr
      *
     c                   move      g_enhl        mwenhl
      *                                                                 .
     c                   if        p_vari = 1
     c                   eval      mwvare = g_vare
     c                   endif
      *                                                                 .
     c                   if        p_type = 1
     c                   eval      mwomst = wwomst
     c                   endif
      *                                                                 .
     c                   eval      mwlagv = wwlagv
      *                                                                 .
      * Skriv record
      *
     c                   write     lwa2l3r
      *
      * Summer til totaler
      *
     c                   eval      wtooms = wtooms + wwomst
     c                   eval      wtolve = wtolve + wwlagv
      *
      * Nullstill arbeidsfelt
      *
     c                   eval      wwomst = *zeros
     c                   eval      wwlagv= *zeros
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Sett startverdier
      *
     c                   eval      n_brd = *zeros
     c                   eval      g_brd = *zeros
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    w_parm
     c                   eval      p_prec = w_parm
      *
      * Legge inn firmanummer
      *
     c                   eval      w_firm = l_firm
     c                   eval      mwfirm = l_firm
      *
     c                   endsr
