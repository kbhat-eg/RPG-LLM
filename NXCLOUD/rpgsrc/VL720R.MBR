     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOFAK
      * Program . . . . : VL720R
      * Beskrivelse . . : Lager - henter utgått dato fra lager
      *                           evt. fra vare
      *
      *
      *                   Input : firma, vare, lager, lr-flagg
      *                   Output: utgår dato
      *
      *                   LR-flagg må være lik '1' for at *inLR ikke skal
      *                   settes
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       021110 bof  Nytt program
6.20  * 6.20  070211 nho  Byttet ut fil mpspxx med vlagxx
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fvlagl1    if   e           k disk    rename(vlagpfr:vlagl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
      *
      * Definering av variable i nøkler
      *
     d vlagl1_firm     s                   like(vlfirm)
     d vlagl1_vare     s                   like(vlvare)
     d vlagl1_lage     s                   like(vllage)
6.20 d vlagl1_sfrm     s                   like(vlfirm)
6.20 d vlagl1_svar     s                   like(vlvare)
6.20 d vlagl1_slag     s                   like(vllage)
     d vvarl1_firm     s                   like(vvfirm)
     d vvarl1_vare     s                   like(vvvare)
      *
      * Definering av pamametre
      *
     d p_firm          s                   like(vlfirm)
     d p_vare          s                   like(vlvare)
     d p_lage          s                   like(vllage)
6.20 d*p_udat          s                   like(mosuda)
6.20 d p_udat          s                   like(vludat)
     d p_inlr          s              1
      *
      *
     d                uds
     d l_user                911    920
     d l_sfir                944    946  0
     d l_savd                947    950  0
     d l_lagr               1001   1002  0
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      * Initierer output-parametre
      *
     c                   eval      p_udat = *loval
      *
      * Henter prisgruppe
      *
     c                   eval      vlagl1_sfrm = p_firm
     c                   eval      vlagl1_svar = p_vare
     c                   eval      vlagl1_slag = p_lage
6.20 c     vlaglk_key    chain     vlagl1
6.20 c                   if        %found(vlagl1)
6.20 c                   if        vludat <> *loval
6.20 c                   eval      p_udat = vludat
     c                   endif
     c                   endif
      *
     c                   if        p_udat = *loval
     c                   eval      vvarl1_firm = p_firm
     c                   eval      vvarl1_vare = p_vare
     c     vvarl1_key    chain     vvarl1
     c                   if        %found(vvarl1)
     c                   eval      p_udat = vvudat
     c                   endif
     c                   endif
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   if        p_inlr <> *on
     c                   eval      *inlr = *on
     c                   endif
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_vare
     c                   parm                    p_lage
     c                   parm                    p_udat
     c                   parm                    p_inlr
      *
      * Key for les på lager-register
      *
     c     vlagl1_key    klist
     c                   kfld                    vlagl1_firm
     c                   kfld                    vlagl1_vare
     c                   kfld                    vlagl1_lage
      *
6.20 c     vlaglk_key    klist
6.20 c                   kfld                    vlagl1_sfrm
6.20 c                   kfld                    vlagl1_svar
6.20 c                   kfld                    vlagl1_slag
      *
      * Key for les på vare-register
      *
     c     vvarl1_key    klist
     c                   kfld                    vvarl1_firm
     c                   kfld                    vvarl1_vare
      *
      *
     c                   endsr
