      /TITLE  ASTELE Opprydding i filer
     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASTELE
      * Program . . . . : GL400R
      * Beskrivelse . . : Endre firma
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       101299 KOB  Nytt program
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fglonlu    uf   e           k disk    rename(glonpfr:glonlur)
     fgtrtpf    uf   e           k disk    rename(gtrtpfr:gtrtpfr)
     fgubfl1    uf   e           k disk    rename(gabfpfr:gubfl1r)
     fgulfpf    uf   e           k disk    rename(gulfpfr:gulfpfr)
     fgul1pf    uf   e           k disk    rename(gul1pfr:gul1pfr)
     fgul2pf    uf   e           k disk    rename(gul2pfr:gul2pfr)
     fgurfpf    uf   e           k disk    rename(gurfpfr:gurfpfr)
     fgur1pf    uf   e           k disk    rename(gur1pfr:gur1pfr)
     fgur2pf    uf   e           k disk    rename(gur2pfr:gur2pfr)
     fgurmlu    uf   e           k disk    rename(gurmpfr:gurmlur)
      *
     d                uds
     d l_user                911    920
     d l_fgrp                931    933
     d l_firm                944    946  0
     d l_navn                951    980
      *
     d w_firm          s              3  0
      *
      * Utbetaling l√∏nn
      *
     c     glonlu_key    setll     glonlu                                 90
     c     glonlu_key    reade     glonlu                                 90
     c                   dow       *in90 = *off
     c                   eval      glfirm = w_firm
     c                   update    glonlur
     c     glonlu_key    reade     glonlu                                 90
     c                   enddo
      *
      * Telegiro returer
      *
     c                   read      gtrtpf                                 90
     c                   dow       *in90 = *off
     c                   if        gdqfir = l_firm
     c                   eval      gdqfir = w_firm
     c                   update    gtrtpfr
     c                   endif
     c                   read      gtrtpf                                 90
     c                   enddo
      *
      * Utbetalingsforslag
      *
     c     gubfl1_key    setll     gubfl1                                 90
     c     gubfl1_key    reade     gubfl1                                 90
     c                   dow       *in90 = *off
     c                   eval      gafirm = w_firm
     c                   update    gubfl1r
     c     gubfl1_key    reade     gubfl1                                 90
     c                   enddo
      *
      * Feilretur
      *
     c     gulfpf_key    setll     gulfpf                                 90
     c     gulfpf_key    reade     gulfpf                                 90
     c                   dow       *in90 = *off
     c                   eval      gdvfir = w_firm
     c                   update    gulfpfr
     c     gulfpf_key    reade     gulfpf                                 90
     c                   enddo
      *
      * 1. gangs retur
      *
     c     gul1pf_key    setll     gul1pf                                 90
     c     gul1pf_key    reade     gul1pf                                 90
     c                   dow       *in90 = *off
     c                   eval      gdsfir = w_firm
     c                   update    gul1pfr
     c     gul1pf_key    reade     gul1pf                                 90
     c                   enddo
      *
      * 2. gangs retur
      *
     c     gul2pf_key    setll     gul2pf                                 90
     c     gul2pf_key    reade     gul2pf                                 90
     c                   dow       *in90 = *off
     c                   eval      gdsfir = w_firm
     c                   update    gul2pfr
     c     gul2pf_key    reade     gul2pf                                 90
     c                   enddo
      *
      * Feilretur
      *
     c     gurfpf_key    setll     gurfpf                                 90
     c     gurfpf_key    reade     gurfpf                                 90
     c                   dow       *in90 = *off
     c                   eval      gdpfir = w_firm
     c                   update    gurfpfr
     c     gurfpf_key    reade     gurfpf                                 90
     c                   enddo
      *
      * 1. gangs retur
      *
     c     gur1pf_key    setll     gur1pf                                 90
     c     gur1pf_key    reade     gur1pf                                 90
     c                   dow       *in90 = *off
     c                   eval      gdnfir = w_firm
     c                   update    gur1pfr
     c     gur1pf_key    reade     gur1pf                                 90
     c                   enddo
      *
      * 2. gangs retur
      *
     c     gur2pf_key    setll     gur2pf                                 90
     c     gur2pf_key    reade     gur2pf                                 90
     c                   dow       *in90 = *off
     c                   eval      gdofir = w_firm
     c                   update    gur2pfr
     c     gur2pf_key    reade     gur2pf                                 90
     c                   enddo
      *
      * Mottaksretur fra bank
      *
     c     gurmlu_key    setll     gurmlu                                 90
     c     gurmlu_key    reade     gurmlu                                 90
     c                   dow       *in90 = *off
     c                   eval      gdmfir = w_firm
     c                   update    gurmlur
     c     gurmlu_key    reade     gurmlu                                 90
     c                   enddo
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avspftt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c     *entry        plist
     c                   parm                    w_firm
      *
     c     glonlu_key    klist
     c                   kfld                    l_firm
      *
     c     gtrtpf_key    klist
     c                   kfld                    l_firm
      *
     c     gubfl1_key    klist
     c                   kfld                    l_firm
      *
     c     gulfpf_key    klist
     c                   kfld                    l_firm
      *
     c     gul1pf_key    klist
     c                   kfld                    l_firm
      *
     c     gul2pf_key    klist
     c                   kfld                    l_firm
      *
     c     gurfpf_key    klist
     c                   kfld                    l_firm
      *
     c     gur1pf_key    klist
     c                   kfld                    l_firm
      *
     c     gur2pf_key    klist
     c                   kfld                    l_firm
      *
     c     gurmlu_key    klist
     c                   kfld                    l_fgrp
     c                   kfld                    l_firm
      *
     c                   endsr
