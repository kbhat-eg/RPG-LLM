     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RR109R                                              *
      * Beskrivelse . . : Beregning av resultatregister                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
6.30  *           040719  Utvidet saldofelter                                 *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frrf5l1    if   e           k disk    rename(rrf5pfr:rrf5l1r)
     frrf5lu    uf   e           k disk    rename(rrf5pfr:rrf5lur)
     frrf8l2    uf   e           k disk    rename(rrf8pfr:rrf8l2r)
     frrf9l1    if   e           k disk    rename(rrf9pfr:rrf9l1r)
     frrf9lu    uf a e           k disk    rename(rrf9pfr:rrf9lur)
     frhsal1    if   e           k disk    rename(rhsapfr:rhsal1r)
      *
6.30 d bel             s             15  2 dim(14)                               BELØPSFELTER
     d bew             s             13  2 dim(14)                               ARBEIDSFELTER
     d lsa             s             11  2 dim(14)                               OPPDAT SALDOFELT
      *
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d n               s              2  0
     d p               s              2  0
     d sal1h           s             11  2
     d sal1p           s             11  2
     d wb9lin          s                   like(rr9lin)
     d p_5lin          s                   like(rr5lin)
     d p_5rap          s                   like(rr5rap)
     d ws9lin          s                   like(rr9lin)
     d w_avde          s                   like(riavde)
     d w_firm          s                   like(rifirm)
     d w_kont          s                   like(rikont)
     d w_raar          s                   like(riraar)
     d w_rper          s              2  0
     d w_spes          s                   like(rispes)
     d w_type          s                   like(ritype)
     d w_5lin          s                   like(rr5lin)
     d w_5rap          s                   like(rr5rap)
     d w_8lØp          s                   like(rr8lØp)
     d w_8lin          s                   like(rr8lin)
     d w_8rap          s                   like(rr8rap)
     d w_9aar          s                   like(rr9aar)
     d w_9avd          s                   like(rr9avd)
     d w_9dpr          s                   like(rr9dpr)
     d w_9hia          s                   like(rr9hia)
     d w_9lin          s                   like(rr9lin)
     d w_9rap          s                   like(rr9rap)
     d w_9typ          s                   like(rr9typ)
     d wx9lin          s                   like(rr9lin)
      *
     irrf9l1r       04
     i              rr9s01                      lsa(1)
     i              rr9s02                      lsa(2)
     i              rr9s03                      lsa(3)
     i              rr9s04                      lsa(4)
     i              rr9s05                      lsa(5)
     i              rr9s06                      lsa(6)
     i              rr9s07                      lsa(7)
     i              rr9s08                      lsa(8)
     i              rr9s09                      lsa(9)
     i              rr9s10                      lsa(10)
     i              rr9s11                      lsa(11)
     i              rr9s12                      lsa(12)
     i              rr9s13                      lsa(13)
     i              rr9s00                      lsa(14)
      *
     irrf9lur       05
     i              rr9s01                      lsa(1)
     i              rr9s02                      lsa(2)
     i              rr9s03                      lsa(3)
     i              rr9s04                      lsa(4)
     i              rr9s05                      lsa(5)
     i              rr9s06                      lsa(6)
     i              rr9s07                      lsa(7)
     i              rr9s08                      lsa(8)
     i              rr9s09                      lsa(9)
     i              rr9s10                      lsa(10)
     i              rr9s11                      lsa(11)
     i              rr9s12                      lsa(12)
     i              rr9s13                      lsa(13)
     i              rr9s00                      lsa(14)
      *
      *  Saldomatrise - hovedbok
     irhsal1r       06
     i              risa01                      bel(1)
     i              risa02                      bel(2)
     i              risa03                      bel(3)
     i              risa04                      bel(4)
     i              risa05                      bel(5)
     i              risa06                      bel(6)
     i              risa07                      bel(7)
     i              risa08                      bel(8)
     i              risa09                      bel(9)
     i              risa10                      bel(10)
     i              risa11                      bel(11)
     i              risa12                      bel(12)
     i              risa13                      bel(13)
     i              risa00                      bel(14)
      /eject
      *
     c     lesrap        tag
      *
     c                   read      rrf5l1                                 50
     c                   if        *in50 = *on
     c                   goto      xend
     c                   endif
      *
     c                   if        rr5fir > w_firm                                           .
     c                   eval      *in50 = *on                                               .
     c                   goto      xend                                                      .
     c                   endif                                                           .....
      *
     c                   if        p_5rap > *zero                                        .....
     c                             and rr5rap > p_5rap                                       .
     c                   eval      *in50 = *on                                               .
     c                   goto      xend                                                      .
     c                   endif                                                           .....
      *
     c                   if        p_5lin > *zero                                        .....
     c                             and rr5lin > p_5lin                                       .
     c                   eval      *in50 = *on                                               .
     c                   goto      xend                                                      .
     c                   endif                                                           .....
      *
      *  Tekstlinje
      *
     c                   if        rr5kod = 'T'                                          .....
     c                   exsr      xtsub                                                     .
     c                   goto      lesrap                                                    .
     c                   endif                                                           .....
      *
      *  Henting fra konto
      *
     c                   if        rr5kod = 'K'                                          .....
     c                   exsr      xksub                                                     .
     c                   goto      lesrap                                                    .
     c                   endif                                                           .....
      *
      *  Henting fra linje
      *
     c                   if        rr5kod = 'L'                                          .....
     c                   exsr      xlsub                                                     .
     c                   goto      lesrap                                                    .
     c                   endif                                                           .....
      *
      *  Subtotal
      *
     c                   if        rr5kod = 'B'                                          .....
     c                   exsr      xbsub                                                     .
     c                   goto      lesrap                                                    .
     c                   endif                                                           .....
      *
      *  Non-printtotal
      *
     c                   if        rr5kod = 'N'                                          .....
     c                   exsr      xssub                                                     .
     c                   goto      lesrap                                                    .
     c                   endif                                                           .....
      *
      *  Sumlinje
      *
     c                   if        rr5kod = 'S'                                          .....
     c                   exsr      xssub                                                     .
     c                   goto      lesrap                                                    .
     c                   endif                                                           .....
      *
     c                   goto      lesrap
      *
     c     xend          tag
      *
     c                   eval      *inlr = *on                                               .
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for behandling av tekstlinje                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xtsub         begsr
      *
      * Endret slik at tekstrecords ikke legges ut
      * i resultatdatabasen
      *
     c                   goto      xtend
      *
     c     xtend         tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for henting fra konto                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xksub         begsr                                                              ..
      *
      * Bygg opp key for
      * lesing av konto
      *
     c                   move      p_5rap        w_8rap
     c                   move      rr5lin        w_8lin
     c                   eval      w_8lØp = *zero
      *
     c     rrf8l2_key    setll     rrf8l2
      *
     c     xkles         tag
      *
     c                   read      rrf8l2                                 50
     c                   if        *in50 = *on
     c                   goto      xkend
     c                   endif
      *
     c                   if        rr8fir <> w_firm                                      .....
     c                             or rr8rap > p_5rap                                        .
     c                             or rr8lin > rr5lin                                        .
     c                   goto      xkend                                                     .
     c                   endif                                                           .....
      *
      * Bygg opp key for lesing av saldo
      *
     c                   move      rr8fav        w_avde
     c                   move      rr8fkt        w_kont
     c                   move      rr8fsp        w_spes
      *
     c     rhsal1_key    setll     rhsal1
      *
     c     xkres         tag
      *
     c                   read      rhsal1                                 50
      *
     c                   if        *in50 = *on
     c                   goto      xkles
     c                   endif
      *
     c                   if        rifirm > w_firm                                       .....
     c                             or rikont > rr8tkt                                    .....
     c                   goto      xkles                                                     .
     c                   endif                                                           .....
      *
      * Sjekk om spesifikasjon innenfor grensen
      *
     c                   if        rispes < rr8fsp                                       .....
     c                             or rispes > rr8tsp                                        .
     c                   goto      xkres                                                     .
     c                   endif                                                           .....
      *
      * Sjekk om avdeling innenfor grensen
      *
     c                   if        rr8tav <> *zeros                                      .....
     c                   if        riavde < rr8fav                                       ... .
     c                             or riavde > rr8tav                                      . .
     c                   goto      xkres                                                   . .
     c                   endif                                                           ... .
     c                   endif                                                           .....
      *
      * Hvis %-sats utfylt
      *
     c                   if        rr8pro > *zero                                        .....
     c                   eval      bew = bel * rr8pro                                        .
     c                   eval      bel = bew / 100                                           .
     c                   endif                                                           .....
      *
      * Hvis Motsatt utfylt
      *
     c                   if        rr8mot = 'J'                                          .....
     c                   eval      bel = 0 - bel                                             .
     c                   endif                                                           .....
      *
     c                   eval      n = 0                                         INDEX
     c                   eval      p = w_rper                                    PERIODE
      *
     c                   eval      sal1p = bel(p)                                SALDO DENNE PER
      *
      * Akkumulering av saldo hittil i år
      *
     c                   eval      sal1h = bel(14)
      *
     c     aa            tag
      *
     c                   eval      n = n + 1
     c                   eval      sal1h = sal1h + bel(n)                        SALDO HITTIL
     c                   eval      *in15 = n >= 13
      *
     c                   if        *in15 = *off
     c                   goto      aa
     c                   endif
      *
      * Oppdatere resultatregister
      *
     c                   move      p_5rap        w_9rap
     c                   move      rr5lin        w_9lin
     c                   move      riavde        w_9avd
     c                   move      riraar        w_9aar
     c                   move      ritype        w_9typ
     c     rrf9l1_key    chain     rrf9lu                             54
      *
      * Legg inn tall som måtte ligge på linje fra før
      *
     c                   if        *in54 = *off                                          .....
     c                   eval      n = 1                                                     .
      *                                                                 .
     c     xloop1        tag                                                                 .
      *                                                                 .
     c                   eval      lsa(n) = lsa(n) + bel(n)                                  .
     c                   eval      n = n + 1                                                 .
     c                   eval      *in55 = n <= 14                                           .
      *
     c                   if        *in55 = *on
     c                   goto      xloop1                                                    .
     c                   endif
      *
     c                   eval      rr9dpr = rr9dpr + sal1p                                   .
     c                   eval      rr9hia = rr9hia + sal1h                                   .
     c                   update    rrf9lur                                                   .
      *                                                                 .
     c                   else                                                                .
      *                                                                 .
     c                   move      w_firm        rr9fir                                      .
     c                   move      p_5rap        rr9rap                                      .
     c                   move      rr5lin        rr9lin                                      .
     c                   move      riavde        rr9avd                                      .
     c                   move      riraar        rr9aar                                      .
     c                   move      ritype        rr9typ                                      .
     c                   move      rr5txt        rr9txt                                      .
     c                   move      rr5kod        rr9kod                                      .
     c                   move      rr5sln        rr9sln                                      .
     c                   move      rr5nul        rr9nul                                      .
     c                   move      rr5abl        rr9abl                                      .
     c                   eval      rr9dpr = sal1p                                            .
     c                   eval      rr9hia = sal1h                                            .
     c                   move      bel           lsa                                         .
      *
     c                   write     rrf9lur                                                   .
      *                                                                 .
      * Oppdater kode beregnet linje                                    .
      *                                                                 .
     c                   move      p_5rap        w_5rap                                      .
     c                   move      rr9lin        w_5lin                                      .
     c     rrf5l1_key    chain     rrf5lu                             57                     .
      *
     c                   if        *in57 = *off                                              .
     c                   move      'J'           rr5ber                                      .
     c                   update    rrf5lur                                                   .
     c                   endif                                                           .....
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   goto      xkres
      *
     c     xkend         tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for henting fra linje                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xlsub         begsr                                                              ..
      *
      * Bygg opp key for lesing av linje
      *
     c                   move      p_5rap        w_8rap
     c                   move      rr5lin        w_8lin
     c                   eval      w_8lØp = *zero
      *
     c     rrf8l2_key    setll     rrf8l2
      *
     c     xlles         tag
      *
     c                   read      rrf8l2                                 50
      *
     c                   if        *in50 = *on
     c                   goto      xlend
     c                   endif
      *
     c                   if        rr8fir <> w_firm                                      .....
     c                             or rr8rap > p_5rap                                        .
     c                             or rr8lin > rr5lin                                        .
     c                   goto      xlend                                                     .
     c                   endif                                                           .....
      *
      * Bygg opp key for lesing av saldo
      *
     c                   move      p_5rap        w_9rap
     c                   move      rr8lif        w_9lin
     c                   eval      w_9avd = *zero
     c                   eval      w_9aar = *zero
     c                   eval      w_9typ = *zero
      *
     c     rrf9l1_key    setll     rrf9l1
      *
     c     xlres         tag
      *
     c                   read      rrf9l1                                 50
     c                   if        *in50 = *on
     c                   goto      xlles
     c                   endif
      *
     c                   if        rr9fir <> w_firm                                      .....
     c                             or rr9rap > p_5rap                                        .
     c                             or rr9lin > rr8lif                                        .
     c                   goto      xlles                                                     .
     c                   endif                                                           .....
      *
      * Hvis %-sats utfylt
      *
     c                   if        rr8pro > *zero                                        .....
     c                   eval      bew = lsa * rr8pro                                        .
     c                   eval      bel = bew / 100                                           .
     c                   else                                                                .
     c                   eval      bel = lsa                                                 .
     c                   endif                                                           .....
      *
      * Hvis Motsatt utfylt
      *
     c                   if        rr8mot = 'J'                                          .....
     c                   eval      bel = 0 - bel                                             .
     c                   endif                                                           .....
      *
     c                   eval      n = 1                                         INDEX
     c                   eval      p = w_rper                                    PERIODE
      *
      * Akkumulering av saldo
      *
     c                   eval      sal1p = bel(p)                                Periode
      *
     c                   eval      sal1h = bel(14)                               Hittil
      *
     c                   dou       n > p
     c                   eval      sal1h = sal1h + bel(n)
     c                   eval      n = n + 1
     c                   enddo
      *
      * Akkumulering av saldo denne periode
      *
     c                   move      p_5rap        w_9rap
     c                   move      rr5lin        w_9lin
     c                   move      rr9avd        w_9avd
     c                   move      rr9aar        w_9aar
     c                   move      rr9typ        w_9typ
     c     rrf9l1_key    chain     rrf9lu                             54
      *
      * Legg inn tall som måtte ligge på linje fra før
      *
     c                   if        *in54 = *off                                          .....
     c                   eval      n = 1                                                     .
      *                                                                 .
     c     xloop2        tag                                                                 .
      *                                                                 .
     c                   eval      lsa(n) = lsa(n) + bel(n)                                  .
     c                   eval      n = n + 1                                                 .
     c                   eval      *in55 = n <= 14                                           .
     c                   if        *in55 = *on
     c                   goto      xloop2                                                    .
     c                   endif
     c                   eval      rr9dpr = rr9dpr + sal1p                                   .
     c                   eval      rr9hia = rr9hia + sal1h                                   .
     c                   update    rrf9lur                                                   .
      *                                                                 .
     c                   else                                                                .
      *                                                                 .
     c                   move      w_firm        rr9fir                                      .
     c                   move      p_5rap        rr9rap                                      .
     c                   move      rr5lin        rr9lin                                      .
     c                   move      rr9avd        rr9avd                                      .
     c                   move      rr9aar        rr9aar                                      .
     c                   move      rr9typ        rr9typ                                      .
     c                   move      rr5txt        rr9txt                                      .
     c                   move      rr5kod        rr9kod                                      .
     c                   move      rr5sln        rr9sln                                      .
     c                   move      rr5nul        rr9nul                                      .
     c                   move      rr5abl        rr9abl                                      .
     c                   eval      rr9dpr = sal1p                                            .
     c                   eval      rr9hia = sal1h                                            .
     c                   move      bel           lsa                                         .
     c                   write     rrf9lur                                                   .
      *                                                                 .
      * Oppdater kode beregnet linje                                    .
      *                                                                 .
     c                   move      p_5rap        w_5rap                                      .
     c                   move      rr9lin        w_5lin                                      .
     c     rrf5l1_key    chain     rrf5lu                             57                     .
     c                   if        *in57 = *off                                              .
     c                   move      'J'           rr5ber                                      .
     c                   update    rrf5lur                                                   .
     c                   endif                                                           .....
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   goto      xlres
      *
     c     xlend         tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for behandling av subtotal                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xbsub         begsr                                                              ..
      *
      * Bygg opp key for lesing av saldo
      *
     c                   move      p_5rap        w_9rap
     c                   eval      w_9lin = 1 + wb9lin
     c                   eval      w_9avd = *zero
     c                   eval      w_9aar = *zero
     c                   eval      w_9typ = *zero
      *
     c     rrf9l1_key    setll     rrf9l1
      *
     c     xbres         tag
      *
     c                   read      rrf9l1                                 50
     c                   if        *in50 = *on
     c                   goto      xbend
     c                   endif
      *
     c                   if        rr9fir <> w_firm                                      .....
     c                             or rr9rap > p_5rap                                        .
     c                             or rr9lin >= rr5lin                                       .
     c                   goto      xbend                                                     .
     c                   endif                                                           .....
      *
     c                   eval      bel = lsa
      *
     c                   eval      n = 1                                         INDEX
     c                   eval      p = w_rper                                    PERIODE
      *
      * Akkumulering av saldo
      *
     c                   eval      sal1p = bel(p)                                Periode
      *
     c                   eval      sal1h = bel(14)                               Hittil
      *
     c                   dou       n > p
     c                   eval      sal1h = sal1h + bel(n)
     c                   eval      n = n + 1
     c                   enddo
      *
      * Akkumulering av saldo denne periode
      *
     c                   move      p_5rap        w_9rap
     c                   move      rr5lin        w_9lin
     c                   move      rr9avd        w_9avd
     c                   move      rr9aar        w_9aar
     c                   move      rr9typ        w_9typ
     c     rrf9l1_key    chain     rrf9lu                             54
      *
      * Legg inn tall som måtte ligge på linje fra før
      *
     c                   if        *in54 = *off                                          .....
     c                   eval      n = 1                                                     .
      *                                                                 .
     c     xloop3        tag                                                                 .
      *                                                                 .
     c                   eval      lsa(n) = lsa(n) + bel(n)                                  .
     c                   eval      n = n + 1                                                 .
     c                   eval      *in55 = n <= 14                                           .
     c                   if        *in55 = *on
     c                   goto      xloop3                                                    .
     c                   endif
     c                   eval      rr9dpr = rr9dpr + sal1p                                   .
     c                   eval      rr9hia = rr9hia + sal1h                                   .
     c                   update    rrf9lur                                                   .
      *                                                                 .
     c                   else                                                                .
      *                                                                 .
     c                   move      w_firm        rr9fir                                      .
     c                   move      p_5rap        rr9rap                                      .
     c                   move      rr5lin        rr9lin                                      .
     c                   move      rr9avd        rr9avd                                      .
     c                   move      rr9aar        rr9aar                                      .
     c                   move      rr9typ        rr9typ                                      .
     c                   move      rr5txt        rr9txt                                      .
     c                   move      rr5kod        rr9kod                                      .
     c                   move      rr5sln        rr9sln                                      .
     c                   move      rr5nul        rr9nul                                      .
     c                   move      rr5abl        rr9abl                                      .
     c                   eval      rr9dpr = sal1p                                            .
     c                   eval      rr9hia = sal1h                                            .
     c                   move      bel           lsa                                         .
     c                   write     rrf9lur                                                   .
      *                                                                 .
      * Oppdater kode beregnet linje                                    .
      *                                                                 .
     c                   move      p_5rap        w_5rap                                      .
     c                   move      rr9lin        w_5lin                                      .
     c     rrf5l1_key    chain     rrf5lu                             57                     .
     c                   if        *in57 = *off                                              .
     c                   move      'J'           rr5ber                                      .
     c                   update    rrf5lur                                                   .
     c                   endif                                                           .....
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   move      rr5lin        wb9lin
      *
     c                   goto      xbres
      *
     c     xbend         tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for behandling av sumlinje/non-printtotal             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xssub         begsr                                                              ..
      *
      * Bygg opp key for lesing av saldo
      *
     c                   move      p_5rap        w_9rap
     c                   eval      w_9lin = 1 + ws9lin
     c                   eval      w_9avd = *zero
     c                   eval      w_9aar = *zero
     c                   eval      w_9typ = *zero
      *
     c     rrf9l1_key    setll     rrf9l1
      *
     c     xsres         tag
      *
     c                   read      rrf9l1                                 50
     c                   if        *in50 = *on
     c                   goto      xsend
     c                   endif
      *
     c                   if        rr9fir > w_firm                                       .....
     c                             or rr9rap > p_5rap                                        .
     c                             or rr9lin >= rr5lin                                       .
     c                   goto      xsend                                                     .
     c                   endif                                                           .....
      *
      * Hopp over linjer som ikke skal behandles
      *
     c                   if        rr9kod = 'B'                                          .....
     c                   goto      xsres                                                     .
     c                   endif                                                           .....
      *
     c                   eval      bel = lsa                                                 .
      *
     c                   eval      n = 1                                         INDEX
     c                   eval      p = w_rper                                    PERIODE
      *
      * Akkumulering av saldo
      *
     c                   eval      sal1p = bel(p)                                Periode
      *
     c                   eval      sal1h = bel(14)                               Hittil
      *
     c                   dou       n > p
     c                   eval      sal1h = sal1h + bel(n)
     c                   eval      n = n + 1
     c                   enddo
      *
      * Akkumulering av saldo denne periode
      *
     c                   move      p_5rap        w_9rap
     c                   move      rr5lin        w_9lin
     c                   move      rr9avd        w_9avd
     c                   move      rr9aar        w_9aar
     c                   move      rr9typ        w_9typ
     c     rrf9l1_key    chain     rrf9lu                             54
      *
      * Legg inn tall som måtte ligge
      * på linje fra før
      *
     c                   if        *in54 = *off                                          .....
     c                   eval      n = 1                                                     .
      *                                                                 .
     c     xloop4        tag                                                                 .
      *                                                                 .
     c                   eval      lsa(n) = lsa(n) + bel(n)                                  .
     c                   eval      n = n + 1                                                 .
     c                   eval      *in55 = n <= 14                                           .
      *                                                                 .
     c                   if        *in55 = *on
     c                   goto      xloop4                                                    .
     c                   endif
      *                                                                 .
     c                   eval      rr9dpr = rr9dpr + sal1p                                   .
     c                   eval      rr9hia = rr9hia + sal1h                                   .
     c                   update    rrf9lur                                                   .
      *                                                                 .
     c                   else                                                                .
      *                                                                 .
     c                   move      w_firm        rr9fir                                      .
     c                   move      p_5rap        rr9rap                                      .
     c                   move      rr5lin        rr9lin                                      .
     c                   move      rr9avd        rr9avd                                      .
     c                   move      rr9aar        rr9aar                                      .
     c                   move      rr9typ        rr9typ                                      .
     c                   move      rr5txt        rr9txt                                      .
     c                   move      rr5kod        rr9kod                                      .
     c                   move      rr5sln        rr9sln                                      .
     c                   move      rr5nul        rr9nul                                      .
     c                   move      rr5abl        rr9abl                                      .
     c                   eval      rr9dpr = sal1p                                            .
     c                   eval      rr9hia = sal1h                                            .
     c                   move      bel           lsa                                         .
      *                                                                 .
     c                   write     rrf9lur                                                   .
      *                                                                 .
      * Oppdater kode beregnet linje                                    .
      *                                                                 .
     c                   move      p_5rap        w_5rap                                      .
     c                   move      rr9lin        w_5lin                                      .
     c     rrf5l1_key    chain     rrf5lu                             57                     .
      *                                                                 .
     c                   if        *in57 = *off                                              .
     c                   move      'J'           rr5ber                                      .
     c                   update    rrf5lur                                                   .
     c                   endif                                                           .....
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   move      rr5lin        wb9lin
     c                   move      rr5lin        ws9lin
      *
     c                   goto      xsres
      *
     c     xsend         tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for sletting av rapport/linje                         *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     c     slett         begsr
      *
      * Bygg opp key for
      * lesing av rapport/linje
      * som skal slettes
      *
     c                   move      p_5rap        w_9rap
     c                   move      p_5lin        w_9lin
      *
     c     rrf9l1_key    setll     rrf9lu
      *
     c     lesrr9        tag
      *
     c                   read      rrf9lu                                 15
      *
     c                   if        *in15 = *on
     c                   goto      xslett
     c                   endif
      *
     c                   if        p_5lin <> *zero
     c                             and rr9lin <> p_5lin
     c                   goto      xslett
     c                   endif
      *
     c                   if        p_5lin = *zero
     c                             and rr9rap <> p_5rap
     c                   goto      xslett
     c                   endif
      *
     c                   delete    rrf9lu
      *
     c                   goto      lesrr9
      *
     c     xslett        tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for fjerning av beregningsmerke                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     c     merke         begsr
      *
      * Bygg opp key for
      * lesing av rapport/linje
      * som skal fjernes
      *
     c                   move      p_5rap        w_5rap
     c                   move      p_5lin        w_5lin
      *
     c     rrf5l1_key    setll     rrf5lu
      *
     c     lesrr5        tag
      *
     c                   read      rrf5lu                                 15
      *
     c                   if        *in15 = *on
     c                   goto      xmerke
     c                   endif
      *
     c                   if        p_5lin <> *zero
     c                             and rr5lin <> p_5lin
     c                   goto      xmerke
     c                   endif
      *
     c                   if        p_5lin = *zero
     c                             and rr5rap <> p_5rap
     c                   goto      xmerke
     c                   endif
      *
     c                   if        rr5ber = 'J'
     c                   move      ' '           rr5ber
     c                   update    rrf5lur
     c                   endif
      *
     c                   goto      lesrr5
      *
     c     xmerke        tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_5rap
     c                   parm                    w_rper
      *
      * Key for linjeregister
      *
     c     rrf5l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_5rap
     c                   kfld                    w_5lin
      *
      * Key for konto/linje-register
      *
     c     rrf8l2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_8rap
     c                   kfld                    w_8lin
     c                   kfld                    w_8lØp
      *
     c     rhsal1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_kont
     c                   kfld                    w_spes
     c                   kfld                    w_avde
     c                   kfld                    w_raar
     c                   kfld                    w_type
      *
     c     rrf9l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_9rap
     c                   kfld                    w_9lin
     c                   kfld                    w_9avd
     c                   kfld                    w_9aar
     c                   kfld                    w_9typ
      *
      * Bygg opp key for
      * lesing av linje
      *
     c                   move      l_firm        w_firm
     c                   move      p_5rap        w_5rap
     c                   move      p_5lin        w_5lin
      *
     c     rrf5l1_key    setll     rrf5l1
      *
      * Slett rapport/linje som skal beregnes
      *
     c                   exsr      slett
      *
      * Fjern merking på linjer som er beregnet
      *
     c                   exsr      merke
      *
     c                   endsr
      **
