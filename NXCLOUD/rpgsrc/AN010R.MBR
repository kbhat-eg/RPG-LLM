     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASPGPL
      * Program . . . . : AN010R
      * Beskrivelse . . : Innlegging av parameter i nattrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * R1.08 151097 AMD  Tekniske og brukermessige forbedringer
6.11  * R6.10 261112 AMD  Se skjermbilde, nytt valg lagt inn
6.20  * R6.20 060613 SST  Lagt inn ny egen tabell for subsystemer
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     faverl1    if   e           k disk    rename(averpfr:averl1r)
     faverlu    uf a e           k disk    rename(averpfr:averlur)
     fan010d    cf   e             workstn
      *
      * Definering av datastrukturer
      *
     d                 ds
     d d_valg                       128
     d  d_time                        6  0 overlay(d_valg)
     d  d_dens                       11    overlay(d_valg:7)
     d  d_rorg                        1    overlay(d_valg:18)
     d  d_back                        1    overlay(d_valg:19)
     d  d_ssbs                        1    overlay(d_valg:20)
     d  d_prc1                        1    overlay(d_valg:21)
     d  d_prc2                        1    overlay(d_valg:22)
     d  d_genp                        1    overlay(d_valg:23)
     d  d_savf                        1    overlay(d_valg:24)
     d  d_smap                        1    overlay(d_valg:25)
     d  d_natt                        1    overlay(d_valg:26)
     d  d_strt                        1    overlay(d_valg:27)
     d  d_slut                        1    overlay(d_valg:28)
      *
     d  d_pro1                        8    overlay(d_valg:31)
     d  d_bib1                       10    overlay(d_valg:39)
     d  d_sys1                        2    overlay(d_valg:49)
     d  d_pro2                        8    overlay(d_valg:51)
     d  d_bib2                       10    overlay(d_valg:59)
     d  d_sys2                        2    overlay(d_valg:69)
      *                                                                     -
      * Definering av variable i nøkler
      *                                                                     -
     d averl1_vkey     s                   like(avvkey)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * A1TAG, Valg av hvilken nattjobb som skal ajourføres
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     a1tag         tag
      *
     c                   z-add     9             wactli
     c                   z-add     12            wactpo
     c                   exfmt     a1win
      *
     c                   if        *inkc = *on
     c                   goto      xslutt                                       Avslutt
     c                   endif
      *
     c                   if        a1valg = 1
     c                   z-add     a1valg        averl1_vkey
     c                   eval      b1natt = 'ASNAT1'
     c                   endif
      *
     c                   if        a1valg = 2
     c                   z-add     a1valg        averl1_vkey
     c                   eval      b1natt = 'ASNAT2'
     c                   endif
      *
     c                   if        a1valg = 3
     c                   z-add     a1valg        averl1_vkey
     c                   eval      b1natt = 'ASNAT3'
     c                   endif
      *
     c     averl1_key    chain     averl1                             60
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B1TAG, Legger inn parametre
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     b1tag         tag
      *
      *  Legge tilbake brukte verdier dersom de finnes
      *
     c                   if        *in60 = *off
     c                   eval      b1ttmm = avttmm
     c                   move      avrorg        b1rorg
     c                   move      avback        b1back
     c                   move      avsmap        b1smap
     c                   move      avsavf        b1savf
     c                   eval      b1dens = avdens
     c                   move      avssbs        b1ssbs
     c                   move      avprc1        b1prc1
     c                   move      avprc2        b1prc2
     c                   move      avstrt        b1strt
     c                   move      avslut        b1slut
     c                   eval      b1dato = avdato
      *
     c                   eval      c1pro1 = avpro1
     c                   eval      c1bib1 = avbib1
     c                   eval      c1sys1 = avsys1
     c                   eval      c1pro2 = avpro2
     c                   eval      c1bib2 = avbib2
     c                   eval      c1sys2 = avsys2
     c                   endif
      *
     c     b1taga        tag
      *
     c     b1tagb        tag
     c                   exfmt     b1bld
      *
      * Avslutt
      *
     c     *inkc         cabeq     *on           xslutt
      *
      * F4=Spørring
      *
     c                   if        *inkd = *on
     c                   if        wactre = 'B1BLD'
      *
      * Vis gyldig tetthet
      *
     c                   if        wactfe = 'B1DENS'
     c                   goto      g1tag
     c                   endif
      *
      * Ekstrajobber
      *
     c                   if        wactfe = 'B1PRC1'
     c                   goto      c1tag
     c                   endif
      *
      * Ekstrajobber fra andre programbibliotek
      *
     c                   if        wactfe = 'B1PRC2'
     c                   call      'AA020C'
     c                   goto      b1tagb
     c                   endif
      *
     c                   goto      b1tagb
      *
     c                   endif
     c                   endif
      *
      * Subsystemer
      *
     c     *inkf         cabeq     *on           e1tag
      *
      * Annuller
      *
     c                   if        *inkl = *on
     c     *inkl         cabeq     *on           b1tag
     c                   endif
      *
      * Er savefile benyttet sammen med full backup ?
      *
     c                   if        b1back = 2
6.11 c                   if        b1savf = 1 or
6.11 c                             b1savf = 2
     c                   eval      *in31 = *on
     c                   goto      b1tagb
     c                   endif
     c                   endif
      *
      * Er savefile oppgitt men ikke std. backup ?
      *
     c                   if        b1back <> 1
6.11 c                   if        b1savf = 1 or
6.11 c                             b1savf = 2
     c                   eval      *in34 = *on
     c                   goto      b1tagb
     c                   endif
     c                   endif
      *
      * Kjøre ekstrajobber... Er kode blank men jobber definert
      *
     c                   if        b1prc1 = 0
     c                   if        c1pro1 <> *blank
     c                             or c1pro2 <> *blank
     c                   eval      *in32 = *on
     c                   goto      b1tagb
     c                   endif
     c                   endif
      *
      * Kjøre ekstrajobber... Er kode satt men ingen jobber definert
      *
     c                   if        b1prc1 = 1
     c                   if        c1pro1 = *blank
     c                   if        c1pro2 = *blank
     c                   eval      *in33 = *on
     c                   goto      b1tagb
     c                   endif
     c                   endif
     c                   endif
      *
      * Gå til avslutningsbildet
      *
     c                   goto      f1tag
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Kjøre ekstra jobber
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     c1tag         tag
      *
     c                   z-add     10            wactli
     c                   z-add     12            wactpo
     c                   exfmt     c1win
      *
     c                   if        *inkc = *on
     c                   goto      b1tag                                        RETUR
     c                   endif
      *
     c                   if        *inkl = *on
     c                   goto      c1tag                                        ANNULER
     c                   endif
      *
      * Sett tilbake verdi for kjør ekstra jobb, dersom ingen prosedyre
      *
     c                   if        c1pro1 = *blank
     c                   if        c1pro2 = *blank
     c                   eval      b1prc1 = *zero
     c                   endif
     c                   endif
      *
     c                   goto      b1taga
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * E1TAG, Vedlikeholde subsystemer som skal startes
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     e1tag         tag
6.20  *
6.20  *  Ny løsning med egen tabell over subsystemer
6.20  *
6.20 c                   call      'AA073R'
6.20 c                   goto      b1tagb
      *
     c                   z-add     0             averl1_vkey
     c     averl1_key    chain     averl1                             60
      *
      *  Legge tilbake brukte verdier dersom de finnes
      *
     c                   if        *in60 = *off
     c                   eval      e1sbs1 = avsbs1
     c                   eval      e1sbs2 = avsbs2
     c                   eval      e1sbs3 = avsbs3
     c                   eval      e1sbs4 = avsbs4
     c                   eval      e1sbs5 = avsbs5
     c                   eval      e1sbs6 = avsbs6
     c                   eval      e1sbs7 = avsbs7
     c                   eval      e1sbs8 = avsbs8
     c                   eval      e1sbs9 = avsbs9
     c                   eval      e1sbs0 = avsbs0
     c                   eval      e1lib1 = avlib1
     c                   eval      e1lib2 = avlib2
     c                   eval      e1lib3 = avlib3
     c                   eval      e1lib4 = avlib4
     c                   eval      e1lib5 = avlib5
     c                   eval      e1lib6 = avlib6
     c                   eval      e1lib7 = avlib7
     c                   eval      e1lib8 = avlib8
     c                   eval      e1lib9 = avlib9
     c                   eval      e1lib0 = avlib0
     c                   else
     c                   eval      e1sbs1 = *blank
     c                   eval      e1sbs2 = *blank
     c                   eval      e1sbs3 = *blank
     c                   eval      e1sbs4 = *blank
     c                   eval      e1sbs5 = *blank
     c                   eval      e1sbs6 = *blank
     c                   eval      e1sbs7 = *blank
     c                   eval      e1sbs8 = *blank
     c                   eval      e1sbs9 = *blank
     c                   eval      e1sbs0 = *blank
     c                   eval      e1lib1 = *blank
     c                   eval      e1lib2 = *blank
     c                   eval      e1lib3 = *blank
     c                   eval      e1lib4 = *blank
     c                   eval      e1lib5 = *blank
     c                   eval      e1lib6 = *blank
     c                   eval      e1lib7 = *blank
     c                   eval      e1lib8 = *blank
     c                   eval      e1lib9 = *blank
     c                   eval      e1lib0 = *blank
     c                   endif
      *
     c                   z-add     4             wactli
     c                   z-add     48            wactpo
     c                   exfmt     e1win
      *
     c                   if        *inkc = *on
     c                   goto      b1tagb
     c                   endif
      *
      *  Oppdaterer register med verdier
      *
     c     averl1_key    chain     averlur                            60
      *
     c                   eval      avsbs1 = e1sbs1
     c                   eval      avsbs2 = e1sbs2
     c                   eval      avsbs3 = e1sbs3
     c                   eval      avsbs4 = e1sbs4
     c                   eval      avsbs5 = e1sbs5
     c                   eval      avsbs6 = e1sbs6
     c                   eval      avsbs7 = e1sbs7
     c                   eval      avsbs8 = e1sbs8
     c                   eval      avsbs9 = e1sbs9
     c                   eval      avsbs0 = e1sbs0
     c                   eval      avlib1 = e1lib1
     c                   eval      avlib2 = e1lib2
     c                   eval      avlib3 = e1lib3
     c                   eval      avlib4 = e1lib4
     c                   eval      avlib5 = e1lib5
     c                   eval      avlib6 = e1lib6
     c                   eval      avlib7 = e1lib7
     c                   eval      avlib8 = e1lib8
     c                   eval      avlib9 = e1lib9
     c                   eval      avlib0 = e1lib0
      *
     c                   if        *in60 = *off                                          .....
     c                   update    averlur                                                   .
     c                   else                                                                .
     c                   eval      avvkey = *zero
     c                   write     averlur                                                   .
     c                   endif                                                           .....
      *
     c                   goto      b1tagb
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * F1TAG, Avslutt.  Skal program genereres ?
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     f1tag         tag
      *
     c                   z-add     8             wactli
     c                   z-add     16            wactpo
     c                   exfmt     f1win
      *
     c                   if        *inkc = *on
     c                   goto      b1tagb
     c                   endif
      *
     c                   if        b1genp = 1
     c                   goto      xopdat
     c                   else
     c                   goto      xslutt
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Vise gyldige verdier for magnetbånd
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     g1tag         tag
      *
     c                   z-add     4             wactli
     c                   z-add     48            wactpo
     c                   exfmt     g1win
      *
     c                   goto      b1tagb
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Starter opp program for nattrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xopdat        tag
      *
     c                   z-add     a1valg        averl1_vkey
     c     averl1_key    chain     averl1                             60
      *
      *  Legger opp parameterverdier
      *
     c                   eval      d_natt = %editc(a1valg:'X')
     c                   movel     b1ttmm        d_time
     c                   eval      d_rorg = %editc(b1rorg:'X')
     c                   eval      d_back = %editc(b1back:'X')
     c                   eval      d_ssbs = %editc(b1ssbs:'X')
     c                   eval      d_prc1 = %editc(b1prc1:'X')
     c                   eval      d_prc2 = %editc(b1prc2:'X')
     c                   eval      d_strt = %editc(b1strt:'X')
     c                   eval      d_slut = %editc(b1slut:'X')
     c                   eval      d_genp = %editc(b1genp:'X')
     c                   eval      d_savf = %editc(b1savf:'X')
     c                   eval      d_smap = %editc(b1smap:'X')
     c                   eval      d_dens = b1dens
     c                   eval      d_pro1 = c1pro1
     c                   eval      d_bib1 = c1bib1
     c                   eval      d_sys1 = c1sys1
     c                   eval      d_pro2 = c1pro2
     c                   eval      d_bib2 = c1bib2
     c                   eval      d_sys2 = c1sys2
      *
      *  Kaller opp 'CL-prog' for utskrift
      *
     c                   call      'AN012C'
     c                   parm                    d_valg
      *
      *  Oppdaterer register med verdier
      *
     c     averl1_key    chain     averlur                            60
      *
     c                   eval      avttmm = b1ttmm
     c                   eval      avrorg = %editc(b1rorg:'X')
     c                   eval      avback = %editc(b1back:'X')
     c                   eval      avssbs = %editc(b1ssbs:'X')
     c                   eval      avprc1 = %editc(b1prc1:'X')
     c                   eval      avprc2 = %editc(b1prc2:'X')
     c                   eval      avstrt = %editc(b1strt:'X')
     c                   eval      avslut = %editc(b1slut:'X')
     c                   eval      avgenp = %editc(b1genp:'X')
     c                   eval      avsavf = %editc(b1savf:'X')
     c                   eval      avsmap = %editc(b1smap:'X')
     c                   eval      avdens = b1dens
     c                   eval      avdato = udate
     c                   eval      avpro1 = c1pro1
     c                   eval      avbib1 = c1bib1
     c                   eval      avsys1 = c1sys1
     c                   eval      avpro2 = c1pro2
     c                   eval      avbib2 = c1bib2
     c                   eval      avsys2 = c1sys2
      *
     c                   if        *in60 = *off                                          .....
     c                   update    averlur                                                   .
     c                   else                                                                .
     c                   z-add     a1valg        avvkey
     c                   write     averlur                                                   .
     c                   endif                                                           .....
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  END OF JOB
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Definering av felter som benyttes i systemet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c                   eval      d_natt = '0'
     c                   eval      d_time = *zero
     c                   eval      d_rorg = '0'
     c                   eval      d_back = '0'
     c                   eval      d_ssbs = '0'
     c                   eval      d_prc1 = '0'
     c                   eval      d_prc2 = '0'
     c                   eval      d_strt = '0'
     c                   eval      d_slut = '0'
     c                   eval      d_genp = '0'
     c                   eval      d_savf = '0'
     c                   eval      d_smap = '0'
     c                   eval      d_dens = *blank
      *
     c                   eval      d_pro1 = *blank
     c                   eval      d_bib1 = *blank
     c                   eval      d_sys1 = *blank
     c                   eval      d_pro2 = *blank
     c                   eval      d_bib2 = *blank
     c                   eval      d_sys2 = *blank
      *
      * Key for file med verdier fra nattrutine
      *
     c     averl1_key    klist
     c                   kfld                    averl1_vkey
      *
      *  Nullstiller variable som skal vises
      *
     c                   eval      b1ttmm = *zero
     c                   eval      b1rorg = *zero
     c                   eval      b1back = *zero
     c                   eval      b1ssbs = *zero
     c                   eval      b1prc1 = *zero
     c                   eval      b1prc2 = *zero
     c                   eval      b1strt = *zero
     c                   eval      b1slut = *zero
     c                   eval      b1genp = *zero
     c                   eval      b1savf = *zero
     c                   eval      b1smap = *zero
     c                   movel     '*CTGTYPE'    b1dens
      *
     c                   endsr
