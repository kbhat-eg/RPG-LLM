     h/TITLE  Beregning av modulus11 nummer
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : ASMD11                                              *
      * Beskrivelse . . : Kontroll og utregning av MOD11-nummer               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. : Modulus 11 som tillater minus i sjekksiffer         *
      * Tilpasset for . : Mestergruppen                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *                                                                       *
      *
     d m11             s              1  0 dim(24)                              Grunnlag for chksiff
     d u11             s              2  0 dim(24)
      *
      *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      *               :  DATASTRUKTURER                                  +
      *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      *
     d                 ds
     d  qdmd11                 1     25                                         Hele K
     d  q11                    1     24                                         Kontro
     d                                     dim(24)                              Grunnlag inn
     d  qdck11                25     25  0                                      Kontro
A    d  qdck11A               25     25                                         Kontro
      *
     d fa11            s              1  0
     d ix              s              3  0
     d ksifhj          s              1  0
     d modr11          s              2  0
     d mods11          s              6  0
     d wplist          s             25
     d zz              s              2  0
      *
      *        Start rutine for modulus-10 utregning.
      *
     c     *entry        plist
     c                   parm                    wplist
      *
     c                   eval      qdmd11 = wplist
      *
     c                   z-add     1             zz
     c                   z-add     7             fa11
     c                   z-add     0             mods11
     c                   z-add     0             modr11
     c                   z-add     0             ksifhj
      *
      * Flytt innput(arrey) til grunnlag(arrey)
      *
     c                   z-add     1             ix                                            R2.06
      *
B001 c                   dou       ix > 24
B002 c                   if        q11(ix) = *blank
 002 c                   move      *zero         m11(ix)
X002 c                   else
 002 c                   move      q11(ix)       m11(ix)
E002 c                   endif
 001 c                   add       1             ix
E001 c                   enddo
      *
     c     utr11         tag
      *
     c     m11(zz)       mult      fa11          u11(zz)
      *
B001 c                   if        zz = 24
 001 c                   z-add     1             zz
 001 c                   goto      add11
X001 c                   else
 001 c                   add       1             zz
B002 c                   if        fa11 = 2
 002 c                   z-add     7             fa11
X002 c                   else
 002 c                   sub       1             fa11
E002 c                   endif
 001 c                   goto      utr11
E001 c                   endif
      *
     c     add11         tag
      *
B001 c                   if        zz > 24
 001 c                   goto      sif11
E001 c                   endif
      *
     c                   add       u11(zz)       mods11
     c                   add       1             zz
      *
     c                   goto      add11
      *
     c     sif11         tag
      *
     c                   div       11            mods11
     c                   mvr                     modr11
      *
B001 c                   if        modr11 = 1
A001 c                   move      '-'           qdck11A
X001 c                   else
B002 c                   if        modr11 = 0
 002 c                   move      '0'           qdck11
X002 c                   else
 002 c     11            sub       modr11        ksifhj
 002 c                   eval      qdck11 = ksifhj
E002 c                   endif
E001 c                   endif
      *
      *----------------------------------------------
      *        Slutt rutine for modulus-11 utregning.
      *----------------------------------------------
      *
     c     slutt         tag
      *
     c                   eval      wplist = qdmd11
     c                   return
