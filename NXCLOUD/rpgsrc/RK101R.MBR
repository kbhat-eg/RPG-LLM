      /TITLE  Vedlikehold Kunderegister
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK101R                                              *
      * Beskrivelse . . : Vedlikehold kunderegister                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
T5.00 * V5.00     131202  Flere param. i call RS718R.                    HFL  *
T5.10 * V5.10     050503  Flytter tekst for avtalespes. hvis blanket i   KOB  *
      *                   skjermbildet
T5.10 * V5.20     241003  Fjernet bruk av spesialtabell for alfafelt     KOB  *
T5.20 * V5.20     040604  Ved ny kunde, hvis foretaksnr. finnes fra før       *
T5.20 *                   og det trykkes enter, ble saldo, kjøp i år og       *
T5.20 *                   kjøp i fjor kopiert inn. Rettet.               HFL  *
T5.31 * V5.31     030704  Lagt til overgang til kort/fakt.avtaler        GRO  *
T5.32 * V5.32     231104  Oppdat. av fakturatype (G2WIN)                 GRO  *
T5.33 * V5.30     040205  Lagt inn merke når notatark på kunden          HFL
T5.33 * V5.40     250505  Lagt inn vedlikehold av besøksadresse          KOB
T5.33 * V5.40     260505  Fjernet ubrukte koder fra F2-bildet            KOB
T5.33 * V5.40     260505  Fjernet ubrukte koder fra H2-bildet            KOB
T5.33 * V5.40     260505  Henter standardverdier fra kundekategori       KOB
T5.31 * V5.40     310505  Fjernet  overgang til kort/fakt.avtaler        KOB  *
T5.31 * V5.40     310505  Lagt inn overgang til kontaktperson            KOB  *
T5.31 * V5.40     310505  Lagt inn overgang til kort                     KOB  *
T5.40 * V5.40     150605  Leser RKLAL2 i stedet for RKLALU.              HFL
T5.40 * V5.40     030605  Lagt inn kontroll mot foretaknummer            KOB
T5.40 * V5.40     030605  Lagt inn kontroll mot eannummer                KOB
T5.40 * V5.40     030605  Lagt inn kontroll mot bankgironr.              KOB
T5.40 * V5.40     030605  Lagt inn kontroll mot telefonnr.               KOB
T5.40 * V5.40     030605  Lagt inn kontroll mot e-mailadresse            KOB
T5.40 * V5.40     140705  Lagt inn krav til felt som må fylles ut        KOB
T5.40 * V5.40     200705  Lagt inn kontroll mot mobilnummer              KOB
T5.40 * V5.40     250705  Lagt inn tabell 2 vedr service-kunder          SST
T5.40 * V5.40     030805  Utvidet parameterliste for RF020R              HFL
5.41  * V5.41     160804  Mulighet for valg av fakturatype (G2WIN)       GRO  *
 5.42 * V5.42     260805  Editering av kundens tlfnr. (nn nn nn nn)      GRO
 5.42 * V5.42     260805  Editering av kundens tlfx.. (nn nn nn nn)      KOB
 5.42 * V5.42     260805  Editering av kundens mobil. (nn nn nn nn)      KOB
 5.42 * V5.42     270805  Lagt inn kontroll av emailadr./ ehandelskunde  KOB
T5.40 * V5.42     250905  Lagt inn kontroll mot personnummer             KOB
T5.40 * V5.42     281005  Lagt inn kontroll mot mobiloperatør            KOB
T5.40 * V5.40     241105  Rettet parameterliste for RF020R               HFL
T5.40 * V5.40     211205  Feil i parameterliste for RF020R ved sperret=J HFL
T5.40 * V5.50     271205  Lagt inn save av felt med tekst/ny visning     KOB
T5.40 * V5.40     300506  Forbedret kontroll på spesialavtaler.          HFL
T5.40 * V5.50     240806  Fjernet kontaktperson fra kunderegister        KOB
T5.40 * V5.50     240806  Lagt inn behandling av Fornavn                 KOB
T5.50 * V5.50     120906  Når krav om kontaktperson, sjekk mot register. HFL
T5.40 * V5.50     310107  Lagt ut dato og bruker for opprettelse i F2    KOB
T5.40 * V5.50     070307  Utvidet med utenlandsk postnr.                 BOF
T5.40 * V5.50     070307  Utvidet med kode for låst kreditgrense         KOB
T5.50 * V5.50     200407  Henter std. kunde dersom PROFF-kunde           HFL
T5.50 * V5.50     050907  Endring for å unngå melding når langt fornavn. HFL
T5.50 * V5.50     110907  Hvis fakttype = 21 ikke test på bankgiro.      HFL
T5.50 *                   Lå i v5.40 men er falt ut.                     HFL
T5.50 * V5.60     220208  Lagt inn mod11 kontroll på foretaksnr.         KOB
T5.50 *                   bankkonto og personnummer                      KOB
T5.50 * V5.60     220208  Lagt inn muligheter for "dummy" informasjon    KOB
T5.50 *                   for felter som kreves utfylt, men hvor info    KOB
T5.50 *                   mangler. 9999... for nummeriske felt.          KOB
      *                   "." godtas for alfafelt. Gir ikke melding om   KOB
      *                   om duplikat ved kontroll.                      KOB
T5.60 * V5.60     011008  Henter kreditgrense fra kundekategori          KOB
T5.61 * V5.60     090108  Lagt inn edr.tidspkt. ved nyregistrering       bof
T5.62 * V5.60     300109  Tatt bort test på bankg.nr når faty = 24/22    bof
6.10  * V6.10     220909  Lagt inn sporingsfelter                        bsa
6.11  * V6.10     060510  Utvidet med sporingsfelter                     bsa
6.12  * V6.10     120510  Henter ikke kundekategori verdier fra RA11PF   NHO
      *                   utenom ved nyregistrering                      NHO
6.13  * V6.10     021210  Sjekk  mot at modul er installert              bsa
6.13  * V6.10     300511  Tatt bort test på bankg.nr når faty= 30        NHO
6.20  *  6.20     290312  Fikk ikke opp notatark pga. endr. i prosjekt
6.21  *  6.20     200512  Ny faty=28, lik 24, men lov med samlefaktura   bof
6.22  *  6.20     180612  Memosaldoregister må lages sammen med kunde    bsa
6.23  * V6.10     140113  Tester også på mail på kontaktp. for faty=22/25 BOF
6.24  * V6.10     140113  Hvis mail fjernes, sjekk kontaktp. og faty     BOF
6.25  * V6.10     160413  Ekstra test faty=24 på rkeanf                  BOF
6.26  * V6.10     230813  Test på nettb.kode og postadresse              BOF
6.27  * V6.20     221113  Test på koder fra kund.kat. -feilretting       BOF
6.28  * V6.20     090514  Fjern krav om mail hvis faty=20                BOF
6.30  * V6.30     260314  Utvidet med sidereg. RKU2PF kontantkun tilbud  BOF
6.30  *                   Tabellen skal syes sammen med RKUNPF i 6.30    BOF
6.31  * V6.30     110914  Felt flyttet fra RKUN til RKME (rkkjal)        Bsa
6.32  * V6.30     201014  Kopierer endringer til kundeprosjekt           BKV
6.33  * V6.30     231014  Kopierer kundeprosjekt, kun hvis ikke overst.  BKV
      *                   Kopierer til ordre                             BKV
6.34  *           130115  Fjernet RKU2PF, lagt inn i RKUNPF              BOF
6.35  *           110515  Feltet RAKFAX skal styre mobil (fra ra11pf)    BOF
6.36  *           120515  Hvis krav til felt kunder,ta med kunde.kat     BOF
6.37  *  6.30     290715  = er ikke gyldig verdi for EDIK feltet.
6.38  *  6.30 sst 020616  Oppslag på endringslogg fra Bet.betingelse
6.39  *  6.30 bsa 190816  Fjerner krav til bankgironummer ved fakturatype 20.
6.39  *                   Ref Logiq, er ikke dette nødvendig.
6.3a  *  6.30 bof 291116  Nye tester vedr. ny avgiftskode              pe 20.
6.40  *  6.30 nho 120617  Feilm.dersom navn endres og knr finnes i div pe 20.
6.3b  *  6.30 nho 271017  Test på e-mail (samme som vises under F7 hvi pe 20.
      *                   s kopiering. RKFATY er 22 eller 25 men e-mail
      *                   adresse er blank
6.3c  * V6.30     210819  Rettelse i kopiering til kundeprosjekt og      BKV
      *                   ordre. Sammenligne ikke med gammelverdi
      *
7.01  *  7.01 bsa 151019  Endret ledetekst for de som kan motta EDI
7.01  *                   ordrebekreftelse.
7.02a *  7.01 bof 311019  Endring av faty mm må også endre på ordre uten kpro
7.02  *  7.00 bkv 271119  Skal ikke ha mod11 sjekk på bankgiro (Gunvald)
7.03  *  7.00 bkv 240120  Sjekk at fakturakunde er 6 siffer
7.04  *  7.00 ask 300920  Endring av "kopierer data til kundeprosjekt og ordre"
7.04  *                   Dersom switch er satt, kopieres data fra kunde
7.04  *                   selv om feltet er tomt fra før.
      *
8.01  *K000   ask 160621  Lagt inn "Endret av" bruker ved nyoppretting av kunde
8.02  *K000   100221 bsa  Slår opp mot rest API for å hente inn gyldige
8.02  *K000               profiler.
8.03  *K000   111021 bsa  Feil ved oppdatering.
8.04  *K000   160921 bsa  Endring av fakturatype, bet.betingelse og fakturagebyr
8.04  *K000               medfører oppdatering av kundeprosjekt og åpne ordre.
8.06  *K000   040123 bsa  Endring av fakturatype skal oppdatere kundeprosjektet
8.06  *K000               uavhengig av om det er satt utgått.
8.09  *K000   040923 bsa  Legger ikke ut feilmelding i skjermen.
8.10  * 800   270723 ask  Lagt inn mulighet å hente nye kunder fra Bisnode,
      *                   samt mulighet for kredittsjekk på eksisterende kunder
8.11  * 800   210224 ask  Lagt inn fiks på feilmelding etter Bisnode oppslag
8.12  * 800   120424 ask  Lagt inn valg for å utelate kunden fra factoring iizy
8.13  * 800   240524 bsa  Lagt inn felt for å utelate samling av positive og
8.13  * 800               negative ordretyper.
8.14  * 800   230125 ask  Endret kontroll på registrering av postnummer
      *
      *
      *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
      *  BRUK AV INDIKATORER
      *                                                                 *
      *       KC = F3  = Exit                                           *
      *       KE = F5  = Forny                                          *
      *       KL = F12 = Annuller                                       *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       10 = Roll                                                 *
      *       12 = Sfldsp                                               *
      *       13 = Sfldspctl                                            *
      *       14 = Sflclr                                               *
      *       15 = Sflend                                               *
      *       16 = Readc 16 on, no more records                         *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
8.09 frkunlr    if   e           k disk    rename(rkunpfr:rkunlrr)
8.09 f                                     prefix(yy:2)
     frkunlu    uf a e           k disk    rename(rkunpfr:rkunlur)
     frkunl2    if   e           k disk    rename(rkunpfr:rkunl2r)
T5.20f                                     prefix(x:1)
     frkunl4    if   e           k disk    rename(rkunpfr:rkunl4r)
T5.20f                                     prefix(x:1)
     frkunl5    if   e           k disk    rename(rkunpfr:rkunl5r)
T5.20f                                     prefix(x:1)
     frkunl7    if   e           k disk    rename(rkunpfr:rkunl7r)
T5.20f                                     prefix(x:1)
     frkunl8    if   e           k disk    rename(rkunpfr:rkunl8r)
T5.20f                                     prefix(x:1)
     frkunl9    if   e           k disk    rename(rkunpfr:rkunl9r)
T5.20f                                     prefix(x:1)
     frkunla    if   e           k disk    rename(rkunpfr:rkunlar)
T5.20f                                     prefix(x:1)
     frkunlb    if   e           k disk    rename(rkunpfr:rkunlbr)
T5.20f                                     prefix(x:1)
     frksal1    if   e           k disk    rename(rksapfr:rksal1r)
     frksalu    uf a e           k disk    rename(rksapfr:rksalur)
E5.40frklal2    if   e           k disk    rename(rklapfr:rklal2r)
     fraa1l1    if   e           k disk    rename(raa1pfr:raa1l1r)
     fraa3l1    if   e           k disk    rename(raa3pfr:raa3l1r)
     fra11l1    if   e           k disk    rename(ra11pfr:ra11l1r)
     fapospf    if   e           k disk
5.41 fraa8l1    if   e           k disk    rename(raa8pfr:raa8l1r)
5.41 fafirl1    if   e           k disk    rename(afirpfr:afirl1r)
T5.50frukpl6    if   e           k disk    rename(rukppfr:rukpl6r)
6.22 frkmelu    uf a e           k disk    rename(rkmepfr:rkmelur)
6.32 ffkprl1    if   e           k disk    rename(fkprpfr:fkprl1r)
6.32 ffkprlu    uf a e           k disk    rename(fkprpfr:fkprlur)
     ffohelk    if   e           k disk    rename(fohepfr:fohelkr)
     ffohelu    uf a e           k disk    rename(fohepfr:fohelur)
6.40 ffstsl1    if   e           k disk    rename(fstspfr:fstsl1r)
6.40 fbstsl1    if   e           k disk    rename(bstspfr:bstsl1r)
8.02 frku3iu    uf a e           k disk    rename(rku3st:rku3iur)
8.02 frku3i1    if   e           k disk    rename(rku3st:rku3i1r)
8.02 fpromst    if   e           k disk    rename(promst:prompfr)
8.13 frku2lu    uf a e           k disk    rename(rku2pfr:rku2lur)
8.13 frku2l1    if   e           k disk    rename(rku2pfr:rku2l1r)
     frk101d    cf   e             workstn
      *
     d mld             s             11    dim(4) ctdata perrcd(1)
     d wpf             s              1    dim(30)
      *
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * Data struktur
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      *
      * LOCAL DATA
      *
     d                uds
     d l_user                911    920
7.00 d l_filg                931    933
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av variable i nøkler
      *
     d rkunl1_kund     s                   like(rkkund)
     d rkunlu_kund     s                   like(rkkund)
     d rksal1_kund     s                   like(rkkund)
     d rksalu_kund     s                   like(rkkund)
     d rkunl2_alfa     s                   like(rkalfa)
     d rkunl4_ftnr     s                   like(rkftnr)
     d rkunl5_eank     s                   like(rkeank)
     d rkunl7_bgir     s                   like(rkbgir)
     d rkunl8_tlfn     s                   like(rktlfn)
     d rkunl9_emal     s                   like(rkemal)
     d rkunla_mobn     s                   like(rkmobn)
     d rkunlb_penr     s                   like(rkpenr)
     d apospf_ponr     s                   like(apponr)
E5.40d rklal2_syst     s                   like(rxsyst)
E5.40d rklal2_pros     s                   like(rxpros)
E5.40d rklal2_akti     s                   like(rxakti)
E5.40d rklal2_kund     s                   like(rxkont)
T5.33d ra11l1_kkat     s                   like(rkkatg)
T5.50d rukpl6_kund     s                   like(rukund)
6.32 d fkprl1_kund     s                   like(flkund)
6.32 d fkprlu_kund     s                   like(flkund)
6.32 d fkprlu_kpro     s                   like(flkpro)
6.33 d fohelk_kund     s                   like(fokund)
6.33 d fohelu_numm     s                   like(fonumm)
6.33 d fohelu_suff     s                   like(fosuff)
8.02 d rku3iu_kund     s                   like(r3kund)
8.02 d rku3i1_kund     s                   like(r3kund)
8.09 d rkunlr_kund     s                   like(rkkund)
      *
      * Parametre
      *
     d p_stat          s              1
     d p_bkod          s                   like(rkbetm)
     d p_btxt          s             20
     d p_ckod          s                   like(rkbetb)
     d p_ctxt          s             20
     d p_fkod          s                   like(rkrabk)
     d p_ftxt          s             20
     d p_gkod          s                   like(rkavde)
     d p_gtxt          s             20
     d p_hkod          s                   like(rkdist)
     d p_htxt          s             20
     d p_ikod          s                   like(rkslgr)
     d p_itxt          s             20
     d p_jkod          s                   like(rklagr)
     d p_jtxt          s             20
     d p_kkod          s                   like(rkkatg)
     d p_ktxt          s             20
     d p_lkod          s                   like(rkland)
     d p_ltxt          s             20
     d p_mkod          s                   like(rkmobo)
     d p_mtxt          s             30
     d p_pkod          s                   like(rkvalk)
     d p_ptxt          s             20
     d p_qkod          s                   like(rkform)
     d p_qtxt          s             20
     d p_rkod          s                   like(rklbet)
     d p_rtxt          s             25
T5.00d p_tx2           s             25
T5.00d p_tx3           s             25
     d p_vkod          s                   like(rksped)
     d p_vtxt          s             20
     d p_ukod          s                   like(rkkjØr)
     d p_utxt          s             20
     d p_yrut          s                   like(rkkjØr)
     d p_ytxt          s             30
     d p_spav          s                   like(rkspav)
5.41 d p_kall          s              1
5.41 d p_faty          s              2  0
5.41 d p_tbes          s             20
6.38 d p_regi          s             10
6.38 d p_fore          s             10
6.38 d p_felt          s             10
     d wplist          s             25
      *
T5.50 * Definering av parametre RS250C
      *
T5.50d p_stdk          s              6  0
      *
E5.40i/COPY QCPYLESRC,RF020PAR
      *
     d rxupar          s                   like(rxulda)
      *
6.20 d wpakti          s              6
     d wpavde          s              4  0
     d wpkund          s                   like(rkkund)
     d wpponr          s                   like(rkponr)
6.20 d wppros          s              6
E5.33d wpspes          s              4  0
     d wpsyst          s              1
     d wpvalg          s              1  0
      *
     d p_retk          s              1
     d p_4knr          s              6  0
      *
     d w_ftst          s              1  0
     d w_feil          s              1  0
     d w_alin          s              2  0
     d w_acol          s              3  0
     d w_firm          s                   like(rkfirm)
     d w_kund          s                   like(rkkund)
     d w_faku          s                   like(rkfaku)
     d w_koku          s                   like(rkfaku)
     d w_1bek          s                   like(ra1bek)
     d w_1bkk          s                   like(ra1bkk)
     d w_3mfe          s                   like(ra3mfe)
serv d w_sprk          s              1
serv d w_levr          s              6  0 inz(0)
serv d w_tlfn          s             15
     d w_posm          s              2  0
     d w_alfa01        s              1
     d w_alfa10        s             10
     d w_alfa29        s             29
     d w_alfa49        s             49
6.13 d w_disp          s              1
6.13 d w_stat          s              1
6.13 d w_modu          s             10
6.23 d b_mail          s              1    inz(*off)
6.32 d w_faty          s                   like(rkfaty)
6.32 d w_mkod          s                   like(rkmkod)
6.32 d w_ekgb          s                   like(rkekgb)
6.32 d w_prpa          s                   like(rkprpa)
6.32 d w_betb          s                   like(rkbetb)
6.32 d w_neto          s                   like(rkneto)
6.32 d w_fagb          s                   like(rkfagb)
6.32 d w_samf          s                   like(rksamf)
6.32 d w_sekv          s                   like(rksekv)
6.32 d w_endr          s              1    inz(*off)
6.33 d w_kpro          s                   like(flkpro)
6.3a d w_mld1          s             50
6.40 d w_navn          s                   like(rknavn)
6.3c d w_date          s                   like(rkedat)
8.02 d w_memb          s             10
8.02 d w_pmtx          s             50
8.02 d w_noit          s              7  0
8.02 d w_fast          s             10
8.02 d w_fell          s              6
8.02 d w_kode          s              1
8.02 d w_numm          s              8  0
8.02 d w_type          s              2
8.02 d w_mld01         s             30
8.02 d w_mld02         s             30
8.02 d w_ctli          s              2  0
8.02 d w_ctpo          s              3  0
8.10 d w_kgre          s              8  0
8.10 d w_rati          s              5
8.10 d w_benav         s             30
8.10 d w_badr1         s             30
8.10 d w_badr2         s             30
8.10 d w_bpnum         s              4  0
8.10 d w_bpste         s             30
8.10 d w_btele         s             11
8.10 d w_bmobi         s             11
8.10 d w_bfdat         s             10
      *
      * Definering av save-variable
      *
     d s_ponr          s                   like(rkponr)
     d s_land          s                   like(rkland)
     d s_upnr          s                   like(rkupnr)
     d s_betb          s                   like(rkbetb)
     d s_valk          s                   like(rkvalk)
     d s_slgr          s                   like(rkslgr)
     d s_avde          s                   like(rkavde)
     d s_lagr          s                   like(rklagr)
     d s_rabk          s                   like(rkrabk)
     d s_betm          s                   like(rkbetm)
     d s_katg          s                   like(rkkatg)
     d s_dist          s                   like(rkdist)
6.3a d s_mkod          s                   like(rkmkod)
      *
      * Definering av konstanter
      *
     d lo              c                   'abcdefghijklmnopqrstuvwxyzæøåÆØÅ'
     d up              c                   'ABCDEFGHIJKLMNOPQRSTUVWXYZÆØÅÆØÅ'
     d digits          c                   ' 0123456789'
6.13 d c_modu          c                   'KORT      '
      *
      * Eksternt program
7.00   dcl-s co402_verdi1  char(1);
7.00   dcl-s co402_verdi2  char(2048);
7.00   DCL-PR CO402R EXTPGM('CO402R');
7.00     p_filgrp            char(3)     const;
7.00     p_firm              packed(3:0) const;
7.00     p_lager             packed(2:0) const;
7.00     p_nokkel            char(50)    const;
7.00     p_verdi1            char(1);
7.00     p_verdi2            char(2048);
7.00   END-PR;
7.02 d u_702           s              1    inz(*off)
7.04 d u_704           s              1    inz(*off)
8.10 d u_809           s              1    inz(*off)
      *
     c     dummy         tag
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * C2BLD  - C2 BILDE for endre/vise/opprette
      * F2WIN  - F2 Vindu for vedlikehold av OFAK-koder
      * E2WIN  - E2 Vindu for vedlikehold av besøksadresse
      * G2WIN  - G2 Vindu for vedlikehold av Fakturakunde/EAN-kunde
      * H2WIN  - H2 Vindu for vedlikehold av Autogiroinformasjon
      * I2WIN  - I2 Vindu for vedlikehold av Forsendelsesinformasjon
      * J2WIN  - J2 Vindu for vedlikehold av Avtalespesifikasjon
      * ASUME  -    Record for å styre at vindu legges over
      *             eksisterende data.
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * HOVEDRUTINE                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C2BLD Behandle bilde for ny - endring - vise                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * Hent kunde
      *
     c                   move      w_kund        rkunl1_kund
     c     rkunl1_key    chain     rkunl1                             60
      *
6.32 c                   eval      w_faty = rkfaty
6.32 c                   eval      w_mkod = rkmkod
6.32 c                   eval      w_ekgb = rkekgb
6.32 c                   eval      w_prpa = rkprpa
6.32 c                   eval      w_betb = rkbetb
6.32 c                   eval      w_neto = rkneto
6.32 c                   eval      w_fagb = rkfagb
6.32 c                   eval      w_samf = rksamf
6.32 c                   eval      w_sekv = rksekv
      *
     c                   if        *in60 = *off
     c                   movel     mld(2)        c2nyen
     c                   move      rkkund        c2kund
      *
      * Konvertere alfafelt
      *
     c                   move      rkalfa        c2alfa
      *
     c                   eval      w_posm = 0
     c                   eval      w_posm = %scan(',':rknavn)
6.40  * Ta vare på navn
6.40 c                   eval      w_navn = rknavn
      *
T5.50c                   if        w_posm > 0 and
T5.50c                             w_posm < 29
     c                   eval      c2navn = %subst(rknavn:1:w_posm - 1)
     c                   eval      c2fnav = %subst(rknavn:w_posm + 2)
     c                   else
     c                   eval      c2navn = rknavn
     c                   endif
      *
     c                   move      rkgate        c2gate
     c                   move      rkadr2        c2adr2
     c                   move      rksted        c2sted
     c                   move      rkponr        c2ponr
     c                   move      rkpass        c2pass
     c                   move      rkbetb        c2betb
     c                   move      rkbetm        c2betm
     c                   move      rkkatg        c2katg
     c                   move      rkslgr        c2slgr
     c                   move      rkland        c2land
T5.50c                   move      rkupnr        c2upnr
     c                   move      rksprk        c2sprk
     c                   move      rktlfn        c2tlfn
     c                   move      rkmobn        c2mobn
     c                   move      rktlfx        c2tlfx
     c                   move      rkbgir        c2bgir
     c                   move      rkftnr        c2ftnr
     c                   move      rkpenr        c2penr
     c                   move      rkrenk        c2renk
     c                   move      rkvalk        c2valk
     c                   move      rkgrns        c2grns
T5.50c                   move      rkkgrk        c2kgrk
     c                   move      rkfrie        c2frie
     c                   move      rkavde        c2avde
     c                   move      rkkres        c2kres
     c                   move      rkrabk        c2rabk
     c                   move      rkdist        c2dist
     c                   move      rklagr        c2lagr
     c                   move      rkspfa        c2spfa
     c                   move      rkspl1        c2spl1
     c                   move      rkspl2        c2spl2
     c                   move      rkspl3        c2spl3
     c                   move      rkspl4        c2spl4
     c                   move      rkspl5        c2spl5
     c                   move      rkptab        c2ptab
     c                   move      rkpta2        c2pta2
     c                   move      rkemal        c2emal
      *
     c                   if        rkedat = *loval
     c                   move      *zeros        c2edat
     c                   else
     c     *dmy          move      rkedat        c2edat
     c                   endif
      *
     c                   move      rkesig        c2esig
     c                   move      rkspav        c2spav
      *
     c                   move      rkkund        e2kund
     c                   move      rknavn        e2navn
     c                   move      rkbgat        e2bgat
     c                   move      rkbadr        e2badr
     c                   move      rkbpnr        e2bpnr
     c                   move      rkweba        e2weba
     c                   move      rkmobo        e2mobo
      *
8.13  * Hent info fra sideregister
      *
8.13 c     rkunl1_key    chain     rku2l1
8.13 c                   if        not %found
8.13 c                   eval      rk2fas = 0
8.13 c                   endif
      *
      * Hent poststed
      *
     c                   move      rkbpnr        apospf_ponr
     c     apospf_key    chain     apospfr
      *
     c                   if        %found
     c                   move      apsted        e2bste
     c                   endif
      *
8.12 c                   move      rkfack        f2fack
     c                   move      rkfagb        f2fagb
     c                   move      rkfrgb        f2frgb
     c                   move      rkekgb        f2ekgb
     c                   move      rkordb        f2ordb
     c                   move      rkprpa        f2prpa
6.34 c                   move      rkkoti        f2koti
     c                   move      rksamf        f2samf
     c                   move      rkrekv        f2rekv
     c                   move      rksekv        f2sekv
     c                   move      rkfagr        f2fagr
     c                   move      rkocop        f2ocop
     c                   move      rkpcop        f2pcop
     c                   move      rkfcop        f2fcop
     c                   move      rkfrsk        f2frsk
     c                   move      rkrasp        f2rasp
     c                   move      rkneto        f2neto
     c                   move      rkebiz        f2ebiz
     c                   move      rklety        f2lety
     c                   move      rkpbok        f2pbok
     c                   move      rkorab        f2orab
     c                   move      rkmkod        f2mkod
8.13 c                   eval      f22fas = rk2fas
      *
T5.00c                   if        rkndat = *loval
T5.00c                   move      *zeros        f2ndat
T5.00c                   else
     c     *dmy          move      rkndat        f2ndat
T5.00c                   endif
     c                   move      rknsig        f2nsig
      *
     c                   move      rkedik        g2edik
     c                   move      rkeank        g2eank
     c                   move      rkeanf        g2eanf
     c                   move      rkfaku        g2faku
     c                   move      rkfaku        w_faku
     c                   move      rkkoku        g2koku
     c                   move      rkkoku        w_koku
     c                   move      rkfacn        g2facn
5.32 c                   move      rkfaty        g2faty
      *
5.41 c                   if        rkfaty <> *zero
5.41 c                   eval      p_faty = rkfaty
5.41 c                   eval      p_tbes = *blank
5.41 c                   eval      p_kall = '1'
5.41 c                   call      'RK111C'
5.41 c                   parm                    w_firm
5.41 c                   parm                    p_kall
5.41 c                   parm                    p_faty
5.41 c                   parm                    p_tbes
5.41  *
5.41 c                   if        p_faty <> *zero
5.41 c                   eval      g2tbes = p_tbes
5.41 c                   else
5.41 c                   eval      g2tbes = *blank
5.41 c                   endif
5.41 c                   endif
5.41  *
     c                   if        rkafda = *loval
     c                   eval      h2afda = *zeros
     c                   else
     c     *dmy          move      rkafda        h2afda
     c                   endif
      *
     c                   if        rkatda = *loval
     c                   eval      h2atda = *zeros
     c                   else
     c     *dmy          move      rkatda        h2atda
     c                   endif
      *
     c                   move      rksent        h2sent
      *
     c                   move      rkform        i2form
     c                   move      rksped        i2sped
     c                   move      rklbet        i2lbet
     c                   move      rkladr        i2ladr
     c                   move      rkkjØr        i2kjor
     c                   move      rkkjnr        i2kjnr
      *
      * Hent standardverdier fra kundekategori
      *
6.12 c                   if        *in60 = '1'
     c                   exsr      xsrkat
6.12 c                   endif
      *
      * Hent tekst
      *
     c                   eval      w_ftst = 0
     c                   exsr      xsr020
8.02  *
8.02  * Hent inn verdier fra tilleggstabell
8.02  *
8.02 c                   eval      rku3i1_kund = w_kund
8.02 c     rku3i1_key    chain     rku3i1
8.02 c                   if        %found
8.02 c                   eval      f2pmtx = r3pmtx
8.02 c                   eval      f2noit = r3noit
8.02 c                   endif
      *
     c                   else
      *
     c                   movel     mld(1)        c2nyen
     c                   move      w_kund        c2kund
     c                   eval      c2alfa = *blank
     c                   eval      c2navn = *blank
     c                   eval      c2gate = *blank
     c                   eval      c2adr2 = *blank
     c                   eval      c2sted = *blank
     c                   eval      c2ponr = *zero
     c                   eval      c2pass = *blank
     c                   eval      c2betm = *zero
     c                   eval      c2katg = *zero
     c                   eval      c2slgr = *zero
     c                   eval      c2land = *blank
     c                   eval      c2upnr = *blank
     c                   eval      c2sprk = *blank
     c                   eval      c2tlfn = *blank
     c                   eval      c2mobn = *blank
     c                   eval      c2tlfx = *blank
     c                   eval      c2bgir = *zero
     c                   eval      c2ftnr = *zero
     c                   eval      c2penr = *zero
     c                   eval      c2renk = *zero
     c                   eval      c2valk = *blank
     c                   eval      c2grns = *zero
     c                   eval      c2frie = *blank
     c                   eval      c2avde = *zero
     c                   eval      c2kres = *zero
     c                   eval      c2rabk = *zero
     c                   eval      c2dist = *zero
     c                   eval      c2lagr = *zero
     c                   eval      c2spfa = *zero
     c                   eval      c2spl1 = *blank
     c                   eval      c2spl2 = *blank
     c                   eval      c2spl3 = *blank
     c                   eval      c2spl4 = *blank
     c                   eval      c2spl5 = *blank
     c                   eval      c2ptab = *zero
     c                   eval      c2pta2 = *zero
     c                   eval      c2emal = *blank
     c                   eval      c2spav = *zero
      *
     c                   eval      e2bgat = *blank
     c                   eval      e2badr = *blank
     c                   eval      e2bpnr = *zero
     c                   eval      e2weba = *blank
     c                   eval      e2mobo = *blank
      *
8.12 c                   eval      f2fack = *zero
     c                   eval      f2fagb = *zero
     c                   eval      f2frgb = *zero
     c                   eval      f2ekgb = *zero
     c                   eval      f2ordb = *zero
     c                   eval      f2prpa = *zero
6.34 c                   eval      f2koti = *zero
     c                   eval      f2samf = *zero
     c                   eval      f2sekv = *zero
     c                   eval      f2fagr = *zero
     c                   eval      f2ocop = *zero
     c                   eval      f2pcop = *zero
     c                   eval      f2fcop = *zero
     c                   eval      f2frsk = *blank
     c                   eval      f2rasp = *zero
     c                   eval      f2neto = *zero
     c                   eval      f2ebiz = *zero
     c                   eval      f2lety = *zero
     c                   eval      f2pbok = *zero
     c                   eval      f2orab = *zero
     c                   eval      f2mkod = *zero
8.02  *
8.02 c                   eval      f2pmtx = *blanks
8.02 c                   eval      f2noit = 0
      *
6.37 c                   eval      g2edik = *blanks
     c                   eval      g2eank = *zero
     c                   eval      g2faku = *zero
     c                   eval      w_faku = *zero
     c                   eval      g2navn = *blank
     c                   eval      g2eanf = *zero
     c                   eval      g2koku = *zero
     c                   eval      w_koku = *zero
     c                   eval      g2kona = *blank
     c                   eval      g2facn = *zero
5.32 c                   eval      g2faty = *zero
      *
     c                   eval      h2atda = *zero
     c                   eval      h2sent = *zero
      *
     c                   eval      i2form = *zero
     c                   eval      i2sped = *zero
     c                   eval      i2lbet = *zero
     c                   eval      i2ladr = *zero
     c                   eval      i2kjor = *zero
     c                   eval      i2kjnr = *zero
      *
T5.50 * Ved ny kunde, sjekker om proff-kunde
T5.50c                   exsr      xsrstdk
      *
     c                   endif
      *
     c                   if        *in30 = *on
     c                   movel     mld(3)        c2nyen
     c                   endif
      *
      * Ta vare på savefelt
      *
     c                   eval      s_ponr = c2ponr
     c                   eval      s_land = c2land
     c                   eval      s_upnr = c2upnr
     c                   eval      s_betb = c2betb
     c                   eval      s_valk = c2valk
     c                   eval      s_slgr = c2slgr
     c                   eval      s_avde = c2avde
     c                   eval      s_lagr = c2lagr
     c                   eval      s_rabk = c2rabk
     c                   eval      s_betm = c2betm
     c                   eval      s_katg = c2katg
     c                   eval      s_dist = c2dist
      *
      * Hent fakturakunde
      *
     c                   if        w_faku <> 0
     c                   eval      rkunl1_kund = w_faku
     c     rkunl1_key    chain     rkunl1                             60
     c                   move      rknavn        g2navn
     c                   move      w_faku        g2faku
     c                   endif
      *
      * Hent konsernkunde
      *
     c                   if        w_koku <> 0
     c                   eval      rkunl1_kund = w_koku
     c     rkunl1_key    chain     rkunl1                             60
     c                   move      rknavn        g2kona
     c                   move      w_koku        g2koku
     c                   endif
      *
     c     c2tagb        tag
      *
      * Posisjonere cursor
      *
6.38 c                   if        *in28 = *off and
6.38 c                             *in29 = *off and
6.38 c                             *in32 = *off and
     c                             *in33 = *off and
     c                             *in34 = *off and
     c                             *in35 = *off and
     c                             *in36 = *off and
     c                             *in37 = *off and
     c                             *in38 = *off and
     c                             *in39 = *off and
     c                             *in40 = *off and
     c                             *in41 = *off and
     c                             *in42 = *off and
     c                             *in43 = *off and
     c                             *in44 = *off and
     c                             *in45 = *off and
     c                             *in46 = *off and
6.38 c                             *in47 = *off and
6.38 c                             *in51 = *off and
6.38 c                             *in52 = *off and
6.38 c                             *in53 = *off and
6.38 c                             *in54 = *off
     c                   move      *on           *in31
     c                   endif
      *
T5.33 * Finnes notatark på kunden?
      *
E5.40c                   eval      rklal2_syst = 'K'
6.20 c                   eval      rklal2_pros = *blanks
E5.40c                   eval      rklal2_akti = *blanks
E5.40c                   eval      rklal2_kund = c2kund
E5.40c     rklal2_key    setll     rklal2                                 94
      *
T5.33c                   if        *in94 = *on
T5.33c                   eval      C2notb = 'NOTATARK'
T5.33c                   endif
8.10  *
8.10  * Kredittsjekk mot Bisnode?
8.10  *
8.10 c                   if        u_809 = *on
8.10 c                   eval      *in91 = *on
8.10 c                   endif
      *
     c                   exfmt     c2bld
      *
     c                   exsr      xnulle
      *
      * Oppkall av notatark.
      *
     c                   if        *inkb = *on
     c                   move      w_firm        rxfirm
     c                   move      wpsyst        rxsyst
E5.40c                   move      wppros        rxpros
     c                   move      wpakti        rxakti
     c                   move      w_kund        rxkont
     c                   move      wpspes        rxspes
     c                   move      wpavde        rxavde
     c                   eval      rxlinj = *zeros
     c                   eval      rxtext = *blank
     c                   move      wpvalg        rxvalg
T5.40c                   move      *loval        rxtist
T5.40c                   eval      rxbiln = *zero
T5.40c                   eval      rxrper = *zero
T5.40c                   eval      rxraar = *zero
T5.40c                   eval      rxonr  = *zero
     c                   move      rxulda        rxupar
     c                   call      'RF020R'
     c                   parm                    rxupar
     c                   move      rxupar        rxulda
     c                   goto      b2taga
     c                   endif
      *
     c                   if        *inkc or *inkl
      *
      * Reduser sist brukte kundenummer
      *
     c                   if        *in60
     c                   eval      p_4knr = w_kund
     c                   eval      p_retk = 'S'
     c                   call      'RS001R'
     c                   parm                    p_retk
     c                   parm                    w_firm
     c                   parm                    p_4knr
      *
     c                   endif
      *
     c                   goto      c2tag1
     c                   endif
      *
      * Call program for posteringer
      *
     c                   if        *inke = *on
     c                   exsr      xe2bld
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for OFAK-KODER
      *
     c                   if        *inkf = *on
     c                   exsr      xf2win
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for EAN-KODER
      *
     c                   if        *inkg = *on
     c                   exsr      xg2win
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for AUTOGIRO
      *
     c                   if        *inkh = *on
     c                   exsr      xh2win
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for FORSENDELSE
      *
     c                   if        *inki = *on
     c                   exsr      xi2win
     c                   goto      c2tagb
     c                   endif
5.31  *
5.31  * Call program for kontaktperson
5.31  *
5.31 c                   if        *inkj = *on
      *
5.31 c                   call      'RF210R'
5.31 c                   parm                    w_firm
5.31 c                   parm                    w_kund
5.31 c                   parm                    w_levr
      *
5.31 c                   goto      c2tagb
5.31 c                   endif
      *
      * Call program for Besøksadresse
      *
     c                   if        *inkk = *on
     c                   exsr      xe2win
     c                   goto      c2tagb
     c                   endif
5.31  *
5.31  * Call program for kort
5.31  *
5.31 c                   if        *inkm = *on
6.13  * Sjekk at modul er installert
6.13 c                   eval      w_modu = c_modu
6.13 c                   eval      w_disp = '1'
6.13 c                   eval      w_stat = '0'
6.13  *
6.13 c                   call      'AX700R'
6.13 c                   parm                    w_modu
6.13 c                   parm                    w_disp
6.13 c                   parm                    w_stat
6.13  *
6.13 c                   if        w_stat = '1'
6.13 c                   goto      c2tagb
6.13 c                   endif
      *
5.31 c                   call      'RF220R'
5.31 c                   parm                    w_firm
5.31 c                   parm                    w_kund
      *
5.31 c                   goto      c2tagb
5.31 c                   endif
8.10  *
8.10  * Bisnode ny kunde eller kreditkontroll
8.10  *
8.10 c                   if        *inks = *on
8.10 c                   if        c2nyen = '  Ny post'
8.10 c                   exsr      bis_kund
8.10 c                   else
8.10 c                   exsr      kred_sjk
8.10 c                   endif
8.10 c                   goto      c2tagb
8.10 c                   endif
      *
      * Call program for post-sted
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2PONR'
     c                   call      'AF010R'
     c                   parm                    wpponr
      *
     c                   if        wpponr <> *zero
     c                   move      wpponr        c2ponr
     c                   endif
      *
     c                   move      *on           *in32
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for BETALINGSMÅTE
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2BETM'
     c                   call      'RA502R'
     c                   parm                    w_firm
     c                   parm                    p_bkod
     c                   parm                    p_btxt
      *
     c                   if        p_bkod <> *zero
     c                   move      p_bkod        c2betm
     c                   move      p_btxt        c2btxt
     c                   endif
      *
     c                   move      *on           *in34
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for BETALINGSBETINGELSE
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2BETB'
     c                   call      'RA503R'
     c                   parm                    w_firm
     c                   parm                    p_ckod
     c                   parm                    p_ctxt
      *
     c                   if        p_ckod <> *zero
     c                   move      p_ckod        c2betb
     c                   move      p_ctxt        c2ctxt
     c                   endif
      *
     c                   move      *on           *in33
     c                   goto      c2tagb
     c                   endif
6.38  *
6.38  * Call program for BETALINGSBETINGELSE, Endringslogg
6.38  *
6.38 c                   if        *inky = *on
6.38 c                   movel     'KUNDE '      p_regi
6.38 c                   movel     c2kund        p_fore
6.38 c                   select
6.38 c                   when      w_afld = 'C2NAVN'
6.38 c                   movel     'RKNAVN'      p_felt
6.38 c                   when      w_afld = 'C2GATE'
6.38 c                   movel     'RKGATE'      p_felt
6.38 c                   when      w_afld = 'C2BGIR'
6.38 c                   movel     'RKBGIR'      p_felt
6.38 c                   when      w_afld = 'C2BETB'
6.38 c                   movel     'RKBETB'      p_felt
6.38 c                   when      w_afld = 'C2BETM'
6.38 c                   movel     'RKBETM'      p_felt
6.38 c                   when      w_afld = 'C2SPRK'
6.38 c                   movel     'RKSPRK'      p_felt
6.38 c                   when      w_afld = 'C2PASS'
6.38 c                   movel     'RKPASS'      p_felt
6.38 c                   when      w_afld = 'C2RABK'
6.38 c                   movel     'RKRABK'      p_felt
6.38 c                   when      w_afld = 'C2KRES'
6.38 c                   movel     'RKKRES'      p_felt
6.38 c                   when      w_afld = 'C2GRNS'
6.38 c                   movel     'RKGRNS'      p_felt
6.38 c                   when      w_afld = 'C2GKRK'
6.38 c                   movel     'RKGKRK'      p_felt
6.38 c                   when      w_afld = 'C2FRIE'
6.38 c                   movel     'RKFRIE'      p_felt
6.38 c                   other
6.38 c                   goto      noinKY
6.38 c                   endsl
6.38 c                   call      'EL001R'
6.38 c                   parm                    p_regi
6.38 c                   parm                    p_fore
6.38 c                   parm                    p_felt
6.38  *
6.38 c                   select
6.38 c                   when      w_afld = 'C2NAVN'
6.38 c                   move      *on           *in46
6.38 c                   when      w_afld = 'C2GATE'
6.38 c                   move      *on           *in28
6.38 c                   when      w_afld = 'C2BGIR'
6.38 c                   move      *on           *in29
6.38 c                   when      w_afld = 'C2BETB'
6.38 c                   move      *on           *in33
6.38 c                   when      w_afld = 'C2BETM'
6.38 c                   move      *on           *in34
6.38 c                   when      w_afld = 'C2SPRK'
6.38 c                   move      *on           *in54
6.38 c                   when      w_afld = 'C2PASS'
6.38 c                   move      *on           *in43
6.38 c                   when      w_afld = 'C2RABK'
6.38 c                   move      *on           *in35
6.38 c                   when      w_afld = 'C2KRES'
6.38 c                   move      *on           *in44
6.38 c                   when      w_afld = 'C2GRNS'
6.38 c                   move      *on           *in51
6.38 c                   when      w_afld = 'C2KGRK'
6.38 c                   move      *on           *in52
6.38 c                   when      w_afld = 'C2FRIE'
6.38 c                   move      *on           *in53
6.38 c                   other
6.38 c                   endsl
6.38  *
6.38 c                   goto      c2tagb
6.38 c                   endif
6.38 c     noinKY        tag
      *
      * Call program for RABATTKATEGORI
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2RABK'
     c                   call      'RA506R'
     c                   parm                    w_firm
     c                   parm                    p_fkod
     c                   parm                    p_ftxt
      *
     c                   if        p_fkod <> *zero
     c                   move      p_fkod        c2rabk
     c                   move      p_ftxt        c2ftxt
     c                   endif
      *
     c                   move      *on           *in35
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for AVDELING
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2AVDE'
     c                   call      'RA507R'
     c                   parm                    w_firm
     c                   parm                    p_gkod
     c                   parm                    p_gtxt
      *
     c                   if        p_gkod <> *zero
     c                   move      p_gkod        c2avde
     c                   move      p_gtxt        c2gtxt
     c                   endif
      *
     c                   move      *on           *in36
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for DISTRIKT
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2DIST'
     c                   call      'RA508R'
     c                   parm                    w_firm
     c                   parm                    p_hkod
     c                   parm                    p_htxt
      *
     c                   if        p_hkod <> *zero
     c                   move      p_hkod        c2dist
     c                   move      p_htxt        c2htxt
     c                   endif
      *
     c                   move      *on           *in37
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for SELGER
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2SLGR'
     c                   call      'RA509R'
     c                   parm                    w_firm
     c                   parm                    p_ikod
     c                   parm                    p_itxt
      *
     c                   if        p_ikod <> *zero
     c                   move      p_ikod        c2slgr
     c                   movel     p_itxt        c2itxt
     c                   endif
      *
     c                   move      *on           *in38
     c                   goto      c2tagb
     c                   endif
      *
6.3b  * Dersom kunde er kopiert kan fakturatype bli med over mens
6.3b  * e-mail adresse = *blank
6.3b c                   if        c2emal = *blank
6.3b c                   exsr      sjekk_mail
6.3b c                   if        b_mail = *off
6.3b c                   if        g2faty = 22 or
6.3b c                             g2faty = 25
6.3b c                   move      *on           *in82
6.3b c                   move      *on           *in81
6.3b c                   eval      w_feil = 1
6.3b c                   goto      c2tagb
6.3b c                   endif
6.3b c                   endif
6.3b c                   endif
      *
      * Call program for LAGER
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2LAGR'
     c                   call      'RA510R'
     c                   parm                    w_firm
     c                   parm                    p_jkod
     c                   parm                    p_jtxt
      *
     c                   if        p_jkod <> *zero
     c                   move      p_jkod        c2lagr
     c                   move      p_jtxt        c2jtxt
     c                   endif
      *
     c                   move      *on           *in39
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for KUNDEKATEGORI
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2KATG'
     c                   call      'RA511R'
     c                   parm                    w_firm
     c                   parm                    p_kkod
     c                   parm                    p_ktxt
      *
     c                   if        p_kkod <> *zero
     c                   move      p_kkod        c2katg
     c                   move      p_ktxt        c2ktxt
     c                   endif
      *
     c                   move      *on           *in40
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for LAND
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2LAND'
     c                   call      'RA512R'
     c                   parm                    w_firm
     c                   parm                    p_lkod
     c                   parm                    p_ltxt
      *
     c                   if        p_lkod <> *blank
     c                   move      p_lkod        c2land
     c                   move      p_ltxt        c2ltxt
     c                   endif
      *
     c                   move      *on           *in41
     c                   goto      c2tagb
     c                   endif
      *
      * Call program for VALUTA
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'C2VALK'
     c                   call      'RA516R'
     c                   parm                    w_firm
     c                   parm                    p_pkod
     c                   parm                    p_ptxt
      *
     c                   if        p_pkod <> *zero
     c                   move      p_pkod        c2valk
     c                   move      p_ptxt        c2pmna
     c                   endif
      *
     c                   move      *on           *in43
     c                   goto      c2tagb
     c                   endif
      *
      * F4 i ugyldig felt
      *
     c                   if        *inkd = *on and
     c                             w_arcd = 'C2BLD'
     c                   goto      c2tagb
     c                   endif
      *
      * Hent standardverdier fra kundekategori
      *
     c                   if        c2katg <> 0
6.12 c                   move      w_kund        rkunl1_kund
6.12 c     rkunl1_key    chain     rkunl1                             88
6.12 c                   if        *in88 = '1'
     c                   exsr      xsrkat
6.12 c                   endif
     c                   endif
      *
      * Dersom noen felt med tekst er endret,
      * sende bildet på nytt.
      *
     c                   if        c2ponr <> s_ponr or
     c                             c2land <> s_land or
     c                             c2betb <> s_betb or
     c                             c2valk <> s_valk or
     c                             c2slgr <> s_slgr or
     c                             c2avde <> s_avde or
     c                             c2lagr <> s_lagr or
     c                             c2rabk <> s_rabk or
     c                             c2betm <> s_betm or
     c                             c2katg <> s_katg or
     c                             c2dist <> s_dist
     c                   eval      s_ponr = c2ponr
     c                   eval      s_land = c2land
     c                   eval      s_betb = c2betb
     c                   eval      s_valk = c2valk
     c                   eval      s_slgr = c2slgr
     c                   eval      s_avde = c2avde
     c                   eval      s_lagr = c2lagr
     c                   eval      s_rabk = c2rabk
     c                   eval      s_betm = c2betm
     c                   eval      s_katg = c2katg
     c                   eval      s_katg = c2katg
     c                   eval      s_dist = c2dist
     c                   exsr      xsr020
     c                   goto      c2tagb
     c                   endif
      *
      * Konvertere alfafelt til store bokstaver
      *
     c                   if        c2alfa = *blank
     c                   eval      c2alfa = %trim(c2navn) + ' ' + %trim(c2fnav)
     c                   endif
      *
     c     lo:up         xlate     c2alfa        c2alfa
      *
      * Kontroll av skjermbildet
      *
     c                   eval      w_ftst = 1
     c                   exsr      xsr020
      *
     c                   if        w_feil <> 0
     c                   goto      c2tagb
     c                   endif
      *
      * Konvertere navn/adresse til store bokstaver, dersom statuskode=0
      *
     c                   if        w_1bkk = 0
     c     lo:up         xlate     c2navn        c2navn
     c     lo:up         xlate     c2fnav        c2fnav
     c     lo:up         xlate     c2gate        c2gate
     c     lo:up         xlate     c2adr2        c2adr2
     c     lo:up         xlate     c2sted        c2sted
     c                   endif
      *
     c                   move      w_kund        rkunlu_kund
     c     rkunlu_key    chain     rkunlur                            60
      *
      *
     c                   move      c2alfa        rkalfa
     c                   if        c2fnav <> *blank
     c                   eval      rknavn = %trim(c2navn) + ', ' + %trim(c2fnav)
     c                   else
     c                   eval      rknavn = c2navn
     c                   endif
      *
6.40  *
6.40 c                   if         wpvalg = 2 and
6.40 c                              w_navn <> rknavn
6.40  * kan ikke endre navn da knr finnes i systemregistere
6.40 c                   exsr      sj_syst
6.40 c                   if        *in79 = '1'
6.40 c                   eval      w_mld1 = 'Navn kan ikke endres +
6.40 c                                         for dette kundenr. +
6.40 c                                                '
6.40 c                   call      'AA005R'
6.40 c                   parm                    w_mld1
6.40 c                   eval      c2navn = w_navn
6.40 c                   goto      c2tagb
6.40 c                   endif
6.40 c                   endif
6.40  *
     c                   move      c2gate        rkgate
     c                   move      c2adr2        rkadr2
     c                   move      c2sted        rksted
     c                   move      c2ponr        rkponr
     c                   move      c2pass        rkpass
      *
     c                   if        c2betb = *zero
     c                   move      w_1bek        rkbetb
     c                   else
     c                   move      c2betb        rkbetb
     c                   endif
      *
     c                   move      c2betm        rkbetm
     c                   move      c2katg        rkkatg
     c                   move      c2slgr        rkslgr
     c                   move      c2land        rkland
     c                   move      c2upnr        rkupnr
     c                   move      c2sprk        rksprk
5.42  *
5.42 c                   movel     c2tlfn        w_tlfn
     c                   if        c2tlfn = '.'
5.42 c                   call      'RÅ950R'
5.42 c                   parm                    w_tlfn
     c                   endif
     c                   movel     w_tlfn        rktlfn
      *
5.42 c                   movel     c2mobn        w_tlfn
     c                   if        c2mobn = '.'
5.42 c                   call      'RÅ950R'
5.42 c                   parm                    w_tlfn
     c                   endif
     c                   movel     w_tlfn        rkmobn
      *
5.42 c                   movel     c2tlfx        w_tlfn
     c                   if        c2tlfx = '.'
5.42 c                   call      'RÅ950R'
5.42 c                   parm                    w_tlfn
     c                   endif
     c                   movel     w_tlfn        rktlfx
      *
     c                   move      c2bgir        rkbgir
     c                   move      c2ftnr        rkftnr
     c                   move      c2penr        rkpenr
     c                   move      c2renk        rkrenk
     c                   move      c2valk        rkvalk
     c                   move      c2grns        rkgrns
     c                   move      c2frie        rkfrie
     c                   move      c2avde        rkavde
     c                   move      c2kres        rkkres
     c                   move      c2rabk        rkrabk
     c                   move      c2dist        rkdist
     c                   move      c2lagr        rklagr
     c                   move      c2spfa        rkspfa
     c                   move      c2spl1        rkspl1
     c                   move      c2spl2        rkspl2
     c                   move      c2spl3        rkspl3
     c                   move      c2spl4        rkspl4
     c                   move      c2spl5        rkspl5
     c                   move      c2ptab        rkptab
     c                   move      c2pta2        rkpta2
     c                   move      c2emal        rkemal
     c                   move      c2spav        rkspav
T5.50c                   move      c2kgrk        rkkgrk
      *
     c                   eval      rkbgat = e2bgat
     c                   eval      rkbadr = e2badr
     c                   eval      rkbpnr = e2bpnr
     c                   eval      rkweba = e2weba
5.42 c                   eval      rkmobo = e2mobo
      *
8.12 c                   move      f2fack        rkfack
     c                   move      f2fagb        rkfagb
     c                   move      f2frgb        rkfrgb
     c                   move      f2ekgb        rkekgb
     c                   move      f2ordb        rkordb
     c                   move      f2prpa        rkprpa
6.34 c                   move      f2koti        rkkoti
     c                   move      f2samf        rksamf
     c                   move      f2rekv        rkrekv
     c                   move      f2sekv        rksekv
     c                   move      f2fagr        rkfagr
     c                   move      f2ocop        rkocop
     c                   move      f2pcop        rkpcop
     c                   move      f2fcop        rkfcop
     c                   move      f2frsk        rkfrsk
     c                   move      f2rasp        rkrasp
     c                   move      f2neto        rkneto
     c                   move      f2ebiz        rkebiz
     c                   move      f2lety        rklety
     c                   move      f2pbok        rkpbok
     c                   move      f2orab        rkorab
     c                   move      f2mkod        rkmkod
      *
     c                   move      g2edik        rkedik
     c                   move      g2eank        rkeank
     c                   move      g2faku        rkfaku
     c                   move      g2koku        rkkoku
     c                   move      g2eanf        rkeanf
     c                   move      g2facn        rkfacn
5.32 c                   move      g2faty        rkfaty
      *
     c                   if        h2afda = *zeros
     c                   move      *loval        rkafda
     c                   else
     c     *dmy          move      h2afda        rkafda
     c                   endif
      *
     c                   if        h2atda = *zeros
     c                   move      *loval        rkatda
     c                   else
     c     *dmy          move      h2atda        rkatda
     c                   endif
      *
     c                   move      h2sent        rksent
      *
     c                   move      i2form        rkform
     c                   move      i2sped        rksped
     c                   move      i2lbet        rklbet
     c                   move      i2ladr        rkladr
     c                   move      i2kjor        rkkjØr
     c                   move      i2kjnr        rkkjnr
      *
     c                   if        *in60 = *off
      *
     c                   if        *in30 = *off
     c                   time                    rkedat
     c                   time                    rketim
     c                   move      l_user        rkesig
6.11 c                   time                    rk2dpt
6.11 c                   eval      rkepgm = 'RK101R    '
     c                   update    rkunlur
     c                   exsr      sjekk_kundep
6.33 c                   eval      w_kpro = 0
6.3c c*                  exsr      sjekk_ordre
8.04 c                   exsr      sjekk_ordre
8.13  *
8.13  * Oppdater/opprett sideregister samtidig
8.13  *
8.13 c     rkunlu_key    chain     rku2lur
8.13 c                   eval      rk2fas = f22fas
8.13 c                   time                    rk2eda
8.13 c                   time                    rk2eti
8.13 c                   eval      rk2eus = l_user
8.13 c                   if        %found
8.13 c                   update    rku2lur
8.13 c                   else
8.13 c                   eval      rk2fir = w_firm
8.13 c                   eval      rk2kun = c2kund
8.13 c                   time                    rk2dat
8.13 c                   time                    rk2tim
8.13 c                   write     rku2lur
8.13 c                   endif
8.02  *
8.02  * Opprett/oppdater tilleggsregister med PM info
8.02  *
8.02 c     rkunlu_key    chain     rku3iur
8.02  *
8.02 c                   eval      r3pmtx = f2pmtx
8.02 c                   eval      r3noit = f2noit
8.02 c                   time                    r3edat
8.02 c                   time                    r3etim
8.02 c                   eval      r3eusr = l_user
8.02  *
8.02 c                   if        %found
8.03 c                   update    rku3iur
8.02 c                   else
8.02 c                   eval      r3firm = w_firm
8.02 c                   eval      r3kund = c2kund
8.02 c                   time                    r3odat
8.02 c                   time                    r3otim
8.02 c                   eval      r3ousr = l_user
8.02 c                   write     rku3iur
8.02 c                   endif
      *
6.33 c                   eval      w_faty = rkfaty
6.33 c                   eval      w_mkod = rkmkod
6.33 c                   eval      w_ekgb = rkekgb
6.33 c                   eval      w_prpa = rkprpa
6.33 c                   eval      w_betb = rkbetb
6.33 c                   eval      w_neto = rkneto
6.33 c                   eval      w_fagb = rkfagb
6.33 c                   eval      w_samf = rksamf
6.33 c                   eval      w_sekv = rksekv
     c                   endif
      *
     c                   else
      *
     c                   move      w_firm        rkfirm
     c                   move      c2kund        rkkund
     c                   time                    rkedat
5.61 c                   time                    rketim
     c                   time                    rkndat
     c                   time                    rkntim
     c                   move      l_user        rknsig
8.01 c                   move      l_user        rkesig
6.11 c                   time                    rk2dpt
6.11 c                   eval      rkepgm = 'RK101R    '
      *
     c                   write     rkunlur
6.22  * Opprett memosaldo register samtidig
6.22 c     rkunlu_key    chain     rkmelur
6.22 c                   if        not %found
6.22 c                   move      w_firm        rkfirm
6.22 c                   move      c2kund        rkkund
6.22 c                   eval      rkmems = 0
6.22 c                   eval      rkmema = 0
6.31 c                   eval      rkkjal = 0
6.22 c                   time                    rkmeda
6.22 c                   time                    rkmeti
6.22 c                   time                    rkmoda
6.22 c                   time                    rkmoti
6.22 c                   move      l_user        rkmeus
6.22 c                   write     rkmelur
6.22 c                   endif
8.13  *
8.13  * Opprett sideregister samtidig
8.13  *
8.13 c     rkunlu_key    chain     rku2lur
8.13 c                   if        not %found
8.13 c                   eval      rk2fir = w_firm
8.13 c                   eval      rk2kun = c2kund
8.13 c                   eval      rk2fas = f22fas
8.13 c                   time                    rk2eda
8.13 c                   time                    rk2eti
8.13 c                   time                    rk2dat
8.13 c                   time                    rk2tim
8.13 c                   eval      rk2eus = l_user
8.13 c                   write     rku2lur
8.13 c                   endif
     c                   endif
8.02  *
8.02  * Opprett tilleggsregister med PM info
8.02  *
8.02 c     rkunlu_key    chain     rku3iur
8.02 c                   if        not %found
8.02 c                   eval      r3firm = w_firm
8.02 c                   eval      r3kund = c2kund
8.02  *
8.02 c                   eval      r3pmtx = f2pmtx
8.02 c                   eval      r3noit = f2noit
8.02  *
8.02 c                   time                    r3edat
8.02 c                   time                    r3etim
8.02 c                   eval      r3eusr = l_user
8.02 c                   time                    r3odat
8.02 c                   time                    r3otim
8.02 c                   eval      r3ousr = l_user
8.02 c                   write     rku3iur
8.02 c                   endif
      *
     c                   call      'RK750R'
     c                   parm                    rkfirm
     c                   parm                    rkkund
serv  *
serv  * Dersom Sperrekode satt = J vises kladdeblokk
serv  *
serv c                   if        w_sprk <> c2sprk and
serv c                             c2sprk = 'J'
     c                   move      w_firm        rxfirm
     c                   move      wpsyst        rxsyst
e5.50c                   move      wppros        rxpros
     c                   move      wpakti        rxakti
     c                   move      w_kund        rxkont
     c                   move      wpspes        rxspes
     c                   move      wpavde        rxavde
     c                   eval      rxlinj = *zeros
     c                   eval      rxtext = *blank
     c                   move      wpvalg        rxvalg
T5.40c                   move      *loval        rxtist
T5.40c                   eval      rxbiln = *zero
T5.40c                   eval      rxrper = *zero
T5.40c                   eval      rxraar = *zero
T5.40c                   eval      rxonr  = *zero
     c                   move      rxulda        rxupar
serv c                   call      'RF020R'
serv c                   parm                    rxupar
serv c                   move      rxupar        rxulda
serv c                   endif
      *
      * Vis bilde for avtalespesifikasjon
      *
     c                   if        c2spav = 1
     c                   exsr      xj2win
     c                   endif
      *
     c     c2tag1        tag
      *
     c                   if        wpvalg = 2
     c                   move      *off          *in30
     c                   endif
      *
     c                   goto      xslutt
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * E2BLD Vise posteringer                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xe2bld        begsr
      *
     c                   call      'RK112R'
     c                   parm                    wpvalg
     c                   parm                    w_kund
      *
     c                   if        wpvalg = 2
     c                   move      *off          *in30
     c                   endif
      *
     c                   move      *on           *in31
      *
     c                   endsr
      *
      /eject
6.40  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
6.40  * Sjekk kundenr mot systemregistere                               *
6.40  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
6.40  *
6.40 c     sj_syst       begsr
6.40  *
6.40  *
6.40 c     key01         chain     bstsl1
6.40  *
6.40 c                   if        %found                                                .....
6.40 c                   if        c2kund = baakun                                           .
6.40 c                   eval      *in79 = '1'
6.40 c                   endif
6.40 c                   endif
6.40  *
6.40  *
     c     fstsl1_key    chain     fstsl1
6.40  *
6.40 c                   if        %found                                                .....
6.40 c                   if        c2kund = faakun or                                        .
6.40 c                             c2kund = faaknr
6.40 c                   eval      *in79 = '1'
6.40 c                   endif
6.40 c                   endif
6.40  *
6.40 c                   endsr
6.40  *
6.40  /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * F2WIN Behandle bilde                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xf2win        begsr
     c                   eval      w_alin = 4
     c                   eval      w_acol = 22
6.3a c                   eval      s_mkod = f2mkod
      *
6.26 c     f2tagb        tag
     c                   exfmt     f2win
      *
     c     *inkc         cabeq     *on           f2tag1
     c     *inkl         cabeq     *on           f2tag1
      *
6.26  * sjekker om poststed er oppgitt for ehandelskunde
6.26 c                   if        f2ebiz = 1  and
6.26 c                             %subst(c2sted:6:25) = *blank
6.26 c                   eval      *in85 = *on
6.26 c                   goto      f2tagb
6.26 c                   endif
      *
6.3a  * sjekker om landkode mot utfylt avgifskode
6.3a c                   if        (c2land =  *blank or
6.3a c                              c2land =  'NO')
6.3a c                   if         f2mkod = 2
6.3a  * norsk kunde - ikke tillatt med 2
6.3a c                   eval      w_mld1 = 'Norsk kunde kan ikke+
6.3a c                                        ha 2 i avgiftskode.+
6.3a c                                                '
6.3a c                   call      'AA005R'
6.3a c                   parm                    w_mld1
6.3a c                   eval      f2mkod = s_mkod
6.3a c                   goto      f2tagb
6.3a c                   endif
6.3a c                   else
6.3a c                   if         f2mkod = 1
6.3a  * utenlandsk kunde - ikke tillatt med 1
6.3a c                   eval      w_mld1 = 'Utenlandsk kunde kan+
6.3a c                                        ikke ha 1 i avgiftsk+
6.3a c                                       ode      '
6.3a c                   call      'AA005R'
6.3a c                   parm                    w_mld1
6.3a c                   eval      f2mkod = s_mkod
6.3a c                   goto      f2tagb
6.3a c                   endif
6.3a c                   endif
8.02  *
8.02  * Spørring
8.02  *
8.02 c                   if        *inkd
8.02  *
8.02  * Call program for Profile manager
8.02  *
8.02 c                   if        w_afld = 'F2PMTX'
8.02 c                   exsr      sub_profilm
8.02 c                   goto      f2tagb
8.02 c                   endif
8.02  *
8.02 c                   endif
      *
6.12  *
6.12 c                   move      w_kund        rkunl1_kund
6.12 c     rkunl1_key    chain     rkunlur                            60
6.12 c                   if        *in60 = '0'
6.34 c                   eval      rkkoti = f2koti
6.12 c                   eval      rkprpa = f2prpa
6.12 c                   eval      rkbetb = c2betb
6.12 c                   eval      rkbetm = c2betm
6.12 c                   eval      rkgrns = c2grns
6.12 c                   eval      rkneto = f2neto
6.12 c                   eval      rksamf = f2samf
6.12 c                   eval      rksekv = f2sekv
6.12 c                   eval      rkpbok = f2pbok
6.12 c                   update    rkunlur
     c                   exsr      sjekk_kundep
6.33 c                   eval      w_kpro = 0
6.3c c*                   exsr      sjekk_ordre
8.04 c                   exsr      sjekk_ordre
      *
6.33 c                   eval      w_faty = rkfaty
6.33 c                   eval      w_mkod = rkmkod
6.33 c                   eval      w_ekgb = rkekgb
6.33 c                   eval      w_prpa = rkprpa
6.33 c                   eval      w_betb = rkbetb
6.33 c                   eval      w_neto = rkneto
6.33 c                   eval      w_fagb = rkfagb
6.33 c                   eval      w_samf = rksamf
6.33 c                   eval      w_sekv = rksekv
6.12 c                   endif
      *
      * Fjernet oppdat. rku2pf, kun midlertid BM pakke
      *
      *
     c     f2tag1        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * G2WIN Behandle bilde                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xg2win        begsr
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 15
      *
5.41 c     g2tagb        tag
5.41  *
     c                   exfmt     g2win
      *
     c     *inkc         cabeq     *on           g2tag1
     c     *inkl         cabeq     *on           g2tag1
      *
5.41 c                   eval      *in49 = *off
5.41 c                   eval      *in50 = *off
5.41 c                   eval      *in51 = *off
5.41 c                   eval      *in52 = *off
5.41 c                   eval      *in53 = *off
5.41 c                   eval      *in54 = *off
5.41 c                   eval      *in55 = *off
5.41 c                   eval      *in56 = *off
5.41 c                   eval      *in57 = *off
5.41 c                   eval      *in58 = *off
7.03 c                   eval      *in83 = *off
5.41  *
5.41  * Call program for FAKTURATYPE
5.41  *
5.41 c                   if        *inkd = *on and
5.41 c                             w_afld = 'G2FATY'
5.41 c                   eval      p_kall = *blank
5.41 c                   call      'RK111C'
5.41 c                   parm                    w_firm
5.41 c                   parm                    p_kall
5.41 c                   parm                    p_faty
5.41 c                   parm                    p_tbes
5.41  *                                                                 .
5.41 c                   if        p_faty <> *zero
5.41 c                   move      p_faty        g2faty
5.41 c                   move      p_tbes        g2tbes
5.41 c                   else
5.41 c                   eval      g2faty = *zero
5.41 c                   eval      g2tbes = *blank
5.41 c                   endif
5.41  *                                                                 .
5.41 c                   goto      g2tagb
5.41 c                   endif
7.03  *
7.03  * Sjekk at fakturatype i bildet er gyldig
7.03  *
7.03  *
7.03 c                   if        g2faku <> *zero and g2faku > 999999
7.03 c                   eval      *in83 = *on
7.03 c                   goto      g2tagb
7.03 c                   endif
8.09 c                   if        g2faku <> 0
8.09 c                   eval      rkunlr_kund = g2faku
8.09 c     rkunlr_key    chain     rkunlr
8.09 c                   if        not %found
8.09 c                   eval      *in83 = *on
8.09 c                   goto      g2tagb
8.09 c                   endif
8.09 c                   endif
5.41  * Sjekk at fakturatype i bildet er gyldig
5.41  *
5.41 c                   if        g2faty <> *zero
5.41 c                   eval      p_faty = g2faty
5.41 c                   eval      p_tbes = *blank
5.41 c                   eval      p_kall = '1'
5.41 c                   call      'RK111C'
5.41 c                   parm                    w_firm
5.41 c                   parm                    p_kall
5.41 c                   parm                    p_faty
5.41 c                   parm                    p_tbes
5.41  *
5.41 c                   if        p_faty = *zero
5.41 c                   eval      *in49 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41  *
5.41  * Hvis fakturatype angitt - sjekk :
5.41  * - Hoved EAN-nummer
5.41  * - Firmaets bankgironr., foretaksnummer og e-mailadresse
5.41  * - Kundens EAN-nummer, bankgiro, foretaksnummer og e-mailadresse
5.41  *
5.41 c                   if        ra8ean = *zero
5.41 c                   eval      *in50 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41  *
5.41 c                   if        aafbgi = *zero
5.41 c                   eval      *in52 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41  *
5.41 c                   if        aafftn = *zero
5.41 c                   eval      *in53 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41  *
5.41 c                   if        g2faty = 22
5.41 c                   if        aamail = *blank
5.41 c                   eval      *in54 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41 c                   endif
5.41  *
6.21 c                   if        g2faty = 24 or
6.21 c                             g2faty = 28
5.41 c                   if        g2eank = *zero
5.41 c                   eval      *in51 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41 c                   endif
6.25 c                   if        g2faty = 24 or
6.25 c                             g2faty = 28
6.25 c                   if        g2eanf = *zero
6.25 c                   eval      *in61 = *on
6.25 c                   eval      *in81 = *on
6.25 c                   goto      g2tagb
6.25 c                   endif
6.25 c                   endif
5.41  *
5.62 c                   if        g2faty <> 21  and
5.62 c                             g2faty <> 22  and
5.62 c                             g2faty <> 24  and
5.62 c                             g2faty <> 28  and
5.62 c                             g2faty <> 25  AND
6.39 c                             g2faty <> 30  and
6.39 c                             g2faty <> 20
5.41 c                   if        c2bgir = *zero
5.41 c                   eval      *in55 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.50 c                   endif
5.41  *
6.21 c                   if        g2faty = 24 or
6.21 c                             g2faty = 28
5.41 c                   if        c2ftnr = *zero
5.41 c                   eval      *in56 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41 c                   endif
5.41  *
5.41 c                   if        g2faty = 22 or
5.62 c                             g2faty = 25
6.23 c                   exsr      sjekk_mail
6.23 c                   if        b_mail = *off   and
6.23 c                             c2emal = *blank
5.41 c                   eval      *in57 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41 c                   endif
5.41  *
5.41 c                   if        g2faty = 24
5.41 c                   if        f2samf <> 1
5.41 c                   eval      *in58 = *on
5.41 c                   eval      *in81 = *on
5.41 c                   goto      g2tagb
5.41 c                   endif
5.41 c                   endif
5.41  *
5.41 c                   endif
      *
     c     g2tag1        tag
      *
5.41 c                   if        *in49 = *on or
5.41 c                             *in50 = *on or
5.41 c                             *in51 = *on or
5.41 c                             *in52 = *on or
5.41 c                             *in53 = *on or
5.41 c                             *in54 = *on or
5.41 c                             *in55 = *on or
5.41 c                             *in56 = *on or
5.41 c                             *in57 = *on or
5.41 c                             *in58 = *on
5.41 c                   eval      g2faty = *zero
5.41 c                   eval      g2tbes = *blank
5.41 c                   endif
5.41  *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * H2WIN Behandle bilde                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xh2win        begsr
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     h2win
      *
     c     *inkc         cabeq     *on           h2tag1
     c     *inkl         cabeq     *on           h2tag1
      *
     c     h2tag1        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * I2WIN Behandle bilde                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xi2win        begsr
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exsr      xsr030
      *
     c     i2tagb        tag
      *
     c                   exfmt     i2win
     c                   exsr      xnulle
      *
     c     *inkc         cabeq     *on           i2tag1
     c     *inkl         cabeq     *on           i2tag1
      *
      * Call program for FORSENDELSESMÅTE
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'I2FORM'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
      *
     c                   if        p_qkod <> *zero
     c                   move      p_qkod        i2form
     c                   move      p_qtxt        i2qtxt
     c                   endif
      *
     c                   move      *on           *in43
     c                   goto      i2tagb
     c                   endif
      *
      * Call program for LEVERINGSBETINGELSE
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'I2LBET'
     c                   call      'RA518R'
     c                   parm                    w_firm
     c                   parm                    p_rkod
     c                   parm                    p_rtxt
      *
     c                   if        p_rkod <> *zero
     c                   move      p_rkod        i2lbet
     c                   movel     p_rtxt        i2rtx1
     c                   endif
      *
     c                   move      *on           *in44
     c                   goto      i2tagb
     c                   endif
      *
      * Call program for SPEDITØR
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'I2SPED'
     c                   call      'RA522R'
     c                   parm                    w_firm
     c                   parm                    p_vkod
     c                   parm                    p_vtxt
      *
     c                   if        p_vkod <> *zero
     c                   move      p_vkod        i2sped
     c                   move      p_vtxt        i2vtxt
     c                   endif
      *
     c                   move      *on           *in45
     c                   goto      i2tagb
     c                   endif
      *
      * Call program for KJØRERUTE
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'I2KJOR'
     c                   call      'RA525R'
     c                   parm                    w_firm
     c                   parm                    p_yrut
     c                   parm                    p_ytxt
      *
     c                   if        p_yrut <> *zero
     c                   move      p_yrut        i2kjor
     c                   move      p_ytxt        i2ytxt
     c                   endif
      *
     c                   move      *on           *in46
     c                   goto      i2tagb
     c                   endif
      *
     c                   exsr      xsr030
     c                   if        w_feil = 1
     c                   goto      i2tagb
     c                   endif
      *
     c     i2tag1        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * J2WIN Behandle bilde for vedlikehold av avtalespesifikasjon     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xj2win        begsr
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 23
      *
     c                   eval      rksal1_kund = w_kund
     c     rksal1_key    chain     rksal1                             93
      *
     c                   if        *in93 = *off
     c                   eval      j2sat1 = rksat1
     c                   eval      j2sat2 = rksat2
     c                   eval      j2sat3 = rksat3
     c                   else
     c                   eval      j2sat1 = *blanks
     c                   eval      j2sat2 = *blanks
     c                   eval      j2sat3 = *blanks
     c                   endif
      *
     c                   exfmt     j2win
      *
     c     *inkc         cabeq     *on           j2tag1
     c     *inkl         cabeq     *on           j2tag1
      *
     c                   eval      rksalu_kund = w_kund
     c     rksalu_key    chain     rksalu                             93
      *
T5.10c                   if        j2sat2 = *blank
T5.10c                   eval      j2sat2 = j2sat3
T5.10c                   eval      j2sat3 = *blank
T5.10c                   endif
T5.10 *
T5.10c                   if        j2sat1 = *blank
T5.10c                   eval      j2sat1 = j2sat2
T5.10c                   eval      j2sat2 = *blank
T5.10c                   eval      j2sat2 = j2sat3
T5.10c                   eval      j2sat3 = *blank
T5.10c                   endif
      *
     c                   eval      rksat1 = j2sat1
     c                   eval      rksat2 = j2sat2
     c                   eval      rksat3 = j2sat3
      *
T5.40c                   if        *in30 = *off
     c                   if        *in93 = *off
      *
T5.40 * Tom record slettes og kode settes til 0
T5.40c                   if        rksat1 = *blank and
T5.40c                             rksat2 = *blank and
T5.40c                             rksat3 = *blank
T5.40c                   delete    rksalur
T5.40c                   eval      rkunlu_kund = w_kund
T5.40c     rkunlu_key    chain     rkunlur                            60
T5.40c                   if        %found
T5.40c                   eval      rkspav = *zero
6.10 c                   time                    rkedat
6.10 c                   time                    rketim
6.10 c                   eval      rkesig = l_user
6.11 c                   time                    rk2dpt
6.11 c                   eval      rkepgm = 'RK101R    '
T5.40c                   update    rkunlur
T5.40c                   endif
T5.40c                   goto      j2tag1
T5.40c                   endif
      *
6.10 c                   time                    rkenda
6.10 c                   time                    rkenti
6.10 c                   eval      rkeusr = l_user
     c                   update    rksalur
     c                   else
      *
T5.40 * Skriver ikke tom record
T5.40c                   if        rksat1 = *blank and
T5.40c                             rksat2 = *blank and
T5.40c                             rksat3 = *blank
T5.40c                   eval      rkunlu_kund = w_kund
T5.40c     rkunlu_key    chain     rkunlur                            60
T5.40c                   if        %found
T5.40c                   eval      rkspav = *zero
6.10 c                   time                    rkedat
6.10 c                   time                    rketim
6.10 c                   eval      rkesig = l_user
6.11 c                   time                    rk2dpt
6.11 c                   eval      rkepgm = 'RK101R    '
T5.40c                   update    rkunlur
T5.40c                   endif
T5.40c                   goto      j2tag1
T5.40c                   endif
      *
     c                   eval      rksafi = w_firm
     c                   eval      rksaku = w_kund
6.10 c                   time                    rkodat
6.10 c                   time                    rkotim
6.10 c                   eval      rkousr = l_user
6.10 c                   time                    rkenda
6.10 c                   time                    rkenti
6.10 c                   eval      rkeusr = l_user
     c                   write     rksalur
     c                   endif
T5.40c                   endif
      *
     c     j2tag1        tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * E2WIN Behandle bilde for vedlikehold av besøksadresse           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xe2win        begsr
      *
     c     e2tagb        tag
      *
     c                   exfmt     e2win
      *
     c     *inkc         cabeq     *on           e2tag1
     c     *inkl         cabeq     *on           e2tag1
      *
      * Call program for post-sted
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'E2BPNR'
     c                   call      'AF010R'
     c                   parm                    wpponr
      *
     c                   if        wpponr <> *zero
     c                   move      wpponr        e2bpnr
     c                   endif
      *
     c                   goto      e2tagb
     c                   endif
      *
      * Call program for MOBILOPERATØR
      *
     c                   if        *inkd = *on and
     c                             w_afld = 'E2MOBO'
     c                   call      'RA529R'
     c                   parm                    w_firm
     c                   parm                    p_mkod
     c                   parm                    p_mtxt
      *
     c                   if        p_mkod <> ' '
     c                   move      p_mkod        e2mobo
     c                   move      p_mtxt        e2mtxt
     c                   endif
      *
     c                   move      *on           *in47
     c                   goto      e2tagb
     c                   endif
      *
     c     e2tag1        tag
      *
     c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XSRKAT Henter standardverdier fra kundekategori                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xsrkat        begsr
      *
      *
     c                   eval      ra11l1_kkat = c2katg
     c     ra11l1_key    chain     ra11l1
     c                   if        %found
      *
     c                   if        c2betb = 0
     c                   eval      c2betb = rakbeb
     c                   endif
      *
     c                   if        c2betm = 0
     c                   eval      c2betm = rakbem
     c                   endif
      *
     c                   if        c2grns = 0
     c                   eval      c2grns = rakgrn
     c                   endif
      *
     c                   if        f2prpa = 0
     c                   eval      f2prpa = rakppa
     c                   endif
      *
     c                   if        f2neto = 0
     c                   eval      f2neto = raknto
     c                   endif
      *
     c                   if        f2samf = 0
     c                   eval      f2samf = raksam
     c                   endif
      *
     c                   if        f2sekv = 0
     c                   eval      f2sekv = raksek
     c                   endif
      *
     c                   if        f2pbok = 0
     c                   eval      f2pbok = rakbok
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
T5.50 * XSRSTDK Sjekk om std.kunde i PROFF finnes                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
T5.50c     xsrstdk       begsr
      *
     c                   eval      p_stdk = *zeros
     c                   call      'RS250C'
     c                   parm                    w_firm
     c                   parm                    p_stdk
      *
     c                   if        p_stdk <> *zeros
     c                   eval      rkunl1_kund = p_stdk
     c     rkunl1_key    chain     rkunl1
     c                   if        %found
      *
     c                   eval      rksald = *zeros
     c                   eval      rksaif = *zeros
     c                   eval      rkkjØp = *zeros
     c                   eval      rkkjØf = *zeros
      *
     c                   if        c2betm = 0
     c                   eval      c2betm = rkbetm
      *
      * Henter betalingsmåte tekst
      *
     c                   if        c2betm <> *zero
     c                   move      c2betm        p_bkod
     c                   call      'RS702R'
     c                   parm                    p_stat
     c                   parm                    p_bkod
     c                   parm                    p_btxt
      *
     c                   if        p_stat = 'N'
     c                   eval      c2btxt = *blank
     c                   else
     c                   move      p_btxt        c2btxt
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        c2betb = 0
     c                   eval      c2betb = rkbetb
      *
      * Henter betalingsbetingelse tekst
      *
     c                   if        c2betb <> *zero
     c                   move      c2betb        p_ckod
     c                   call      'RS703R'
     c                   parm                    p_stat
     c                   parm                    p_ckod
     c                   parm                    p_ctxt
      *
     c                   if        p_stat = 'N'
     c                   eval      c2ctxt = *blank
     c                   else
     c                   move      p_ctxt        c2ctxt
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        c2ptab = 0
     c                   eval      c2ptab = rkptab
     c                   endif
      *
     c                   if        c2pta2 = 0
     c                   eval      c2pta2 = rkpta2
     c                   endif
      *
     c                   if        c2spfa = 0
     c                   eval      c2spfa = rkspfa
     c                   endif
      *
     c                   if        c2spl1 = *blank
     c                   eval      c2spl1 = rkspl1
     c                   endif
      *
     c                   if        c2spl2 = *blank
     c                   eval      c2spl2 = rkspl2
     c                   endif
      *
     c                   if        c2spl3 = *blank
     c                   eval      c2spl3 = rkspl3
     c                   endif
      *
     c                   if        c2spl4 = *blank
     c                   eval      c2spl4 = rkspl4
     c                   endif
      *
     c                   if        c2spl5 = *blank
     c                   eval      c2spl5 = rkspl5
     c                   endif
      *
     c                   endif
     c                   endif
      *
T5.50c                   endsr
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Kontroll  C2 bilde (endringer)                                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xsr020        begsr
      *
      * Sjekke om navn er utfyllt
      *
     c                   if        c2navn = *blank
     c                   move      *on           *in46
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om postnummer er gyldig
      *
8.14 c                   if        c2land = ' ' or
8.14 c                             c2land = 'NO'
8.14 c                   if        c2ponr = 0
8.14 c                   eval      *in32 = *on
8.14 c                   eval      *in81 = *on
8.14 c                   eval      w_feil = 1
8.14 c                   goto      xa2010
8.14 c                   endif
8.14 c                   endif
     c                   if        c2ponr <> *zero
     c                   move      c2ponr        apospf_ponr
     c     apospf_key    chain     apospfr                            62
      *
     c                   if        *in62 = *on
     c                   move      *on           *in32
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   eval      c2sted = *blank
     c                   movel     apponr        c2sted
     c                   move      apsted        c2sted
     c                   endif
     c                   endif
      *
      * Sjekke om betalingsmåte er gyldig
      *
     c                   if        c2betm <> *zero
     c                   move      c2betm        p_bkod
     c                   call      'RS702R'
     c                   parm                    p_stat
     c                   parm                    p_bkod
     c                   parm                    p_btxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in34
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_btxt        c2btxt
     c                   endif
     c                   endif
      *
      * Sjekke om betalingsbetingelse er gyldig
      *
     c                   if        c2betb <> *zero
     c                   move      c2betb        p_ckod
     c                   call      'RS703R'
     c                   parm                    p_stat
     c                   parm                    p_ckod
     c                   parm                    p_ctxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in33
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_ctxt        c2ctxt
     c                   endif
     c                   endif
      *
      * Sjekke om RABATTKATEGORI er gyldig
      *
     c                   if        c2rabk <> *zero
     c                   move      c2rabk        p_fkod
     c                   call      'RS706R'
     c                   parm                    p_stat
     c                   parm                    p_fkod
     c                   parm                    p_ftxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in35
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_ftxt        c2ftxt
     c                   endif
     c                   endif
      *
      * Sjekke om AVDELING er gyldig
      *
     c                   if        c2avde <> *zero
     c                   move      c2avde        p_gkod
     c                   call      'RS707R'
     c                   parm                    p_stat
     c                   parm                    p_gkod
     c                   parm                    p_gtxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in36
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_gtxt        c2gtxt
     c                   endif
     c                   endif
      *
      * Sjekke om DISTRIKT er gyldig
      *
     c                   if        c2dist <> *zero
     c                   move      c2dist        p_hkod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_hkod
     c                   parm                    p_htxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in37
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_htxt        c2htxt
     c                   endif
     c                   endif
      *
      * Sjekke om selger er gyldig
      *
     c                   if        c2slgr <> *zero
     c                   move      c2slgr        p_ikod
     c                   call      'RS709R'
     c                   parm                    p_stat
     c                   parm                    p_ikod
     c                   parm                    p_itxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in38
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   movel     p_itxt        c2itxt
     c                   endif
     c                   endif
      *
      * Sjekke om LAGER er gyldig
      *
     c                   if        c2lagr <> *zero
     c                   move      c2lagr        p_jkod
     c                   call      'RS710R'
     c                   parm                    p_stat
     c                   parm                    p_jkod
     c                   parm                    p_jtxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in39
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_jtxt        c2jtxt
     c                   endif
     c                   endif
      *
      * Sjekke om kundekategori er gyldig
      *
     c                   if        c2katg <> *zero
     c                   move      c2katg        p_kkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_kkod
     c                   parm                    p_ktxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in40
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_ktxt        c2ktxt
     c                   endif
     c                   endif
      *
      * Sjekke om utenlandsk postnr er utfylt
      *
     c                   if        c2land <> *blank and
     c                             c2land <> 'NO'   and
     c                             c2upnr =  *blank
     c                   move      *on           *in76
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   if        c2upnr <> *blank and
     c                             c2ponr <> 0
     c                   move      *on           *in78
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om LAND er gyldig
      *
     c                   if        c2land <> *blank
     c                   move      c2land        p_lkod
     c                   call      'RS712R'
     c                   parm                    p_stat
     c                   parm                    p_lkod
     c                   parm                    p_ltxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in41
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_ltxt        c2ltxt
     c                   endif
     c                   endif
      *
      * Sjekke at landkode er utfylt hvis utenlandsk postnr er utfylt
      *
     c                   if        c2upnr <> *blank and
     c                             (c2land =  *blank or
     c                              c2land =  'NO')
     c                   move      *on           *in77
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om VALUTA er gyldig
      *
     c                   if        c2valk <> *blank
     c                   move      c2valk        p_pkod
     c                   call      'RS716R'
     c                   parm                    p_stat
     c                   parm                    p_pkod
     c                   parm                    p_ptxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in42
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_ptxt        c2pmna
     c                   endif
     c                   endif
      *
      * Sjekke om MOBILOPERATØR er gyldig
      *
     c                   if        e2mobo <> *blank
     c                   move      e2mobo        p_mkod
     c                   call      'RS729R'
     c                   parm                    p_stat
     c                   parm                    p_mkod
     c                   parm                    p_mtxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in47
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   else
     c                   move      p_mtxt        e2mtxt
     c                   endif
     c                   endif
      *
      * Sjekke om emailadresse er oppgitt for ehandelskunde
      *
     c                   if        c2emal = *blank and
     c                             f2ebiz = 1
     c                   move      *on           *in59
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om emailadresse er hvis fakty 20,22 og 25, sjekker også
      * kontaktper.
      *
6.24 c                   if        c2emal = *blank
6.24 c                   exsr      sjekk_mail
6.24 c                   if        b_mail = *off
6.28 c                   if        g2faty = 22 or
6.24 c                             g2faty = 25
6.24 c                   move      *on           *in28
6.24 c                   move      *on           *in81
6.24 c                   eval      w_feil = 1
6.24 c                   goto      xa2010
6.24 c                   endif
6.24 c                   endif
6.24 c                   endif
      *
      *
T5.40 * Sjekk om spesialavtale finnes
      *
T5.40c                   if        c2spav <> 1
T5.40c                   if        *in30 = *off
      *
T5.40c                   eval      rksal1_kund = w_kund
T5.40c     rksal1_key    chain     rksal1                             93
      *
T5.40c                   if        *in93 = *off
T5.40c                   move      *on           *in74
T5.40c                   move      *on           *in81
T5.40c                   eval      w_feil = 1
T5.40c                   goto      xa2010
T5.40c                   endif
T5.40c                   endif
T5.40c                   endif
      *
      * Krav til utfylling av standardfelter på kunde
      *
     c                   if        w_3mfe = '1' and
     c                             w_ftst = 1
      *
      * Sjekke om adresse er utfyllt
      *
     c                   if        c2gate = *blank
     c                   move      *on           *in65
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om adresse er utfylt med dummyverdi
      *
     c                   if        c2gate <> ' '
     c                   move      c2gate        w_alfa29
     c                   movel     c2gate        w_alfa01
     c                   if        w_alfa01 = '.' and
     c                             w_alfa29 <> ' '
     c                   move      *on           *in27
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
     c                   endif
      *
      * Sjekke om postnr./poststed er utfyllt
      *
     c                   if        c2sted = *blank and
     c                             c2ponr = *zero
     c                   move      *on           *in66
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
6.36  *
6.36  * Sjekke om kundekategori er utfylt og gyldig
6.36  *
6.36 c                   move      c2katg        p_kkod
6.36 c                   call      'RS711R'
6.36 c                   parm                    p_stat
6.36 c                   parm                    p_kkod
6.36 c                   parm                    p_ktxt
6.36  *
6.36 c                   if        p_stat = 'N'
6.36 c                   move      *on           *in40
6.36 c                   move      *on           *in81
6.36 c                   eval      w_feil = 1
6.36 c                   goto      xa2010
6.36 c                   endif
      *
     c                   endif
      *
      * Hent inn kontrollfelt fra kundekategori
      *
     c                   eval      ra11l1_kkat = c2katg
     c     ra11l1_key    chain     ra11l1
      *
      * Sjekke om foretaksnummer skal være utfylt
      *
     c                   if        rakorg = 'J'
      *
     c                   if        c2ftnr = 0
     c                   move      *on           *in49
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
6.27 c                   endif
      *
      * Sjekke om foretaksnummer er gyldig modulus 11
      *
     c                   if        c2ftnr > 0  and
     c                             c2ftnr <> 999999999
     c                   eval      wplist = *blanks
     c                   move      c2ftnr        w_chks            1
     c                   move      c2ftnr        wplist
     c                   call      'ASMD11'
     c                   parm                    wplist           25
      *
     c                   move      wplist        w_sist            1
      *
7.02 c                   if        u_702 = *off
     c                   if        w_sist <> w_chks
     c                   move      *on           *in21
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
7.02 c                   endif
     c                   endif
      *
      * Sjekke om personnummer skal være utfylt
      *
     c                   if        rakpnr = 'J'
      *
     c                   if        c2penr = 0
     c                   move      *on           *in72
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om personnummer er gyldig modulus 11
      *
     c                   if        c2penr > 0  and
     c                             c2penr <> 99999999999
     c                   eval      wplist = *blanks
     c                   move      c2penr        w_chks            1
     c                   move      c2penr        wplist
     c                   call      'ASMD11'
     c                   parm                    wplist           25
      *
     c                   move      wplist        w_sist            1
      *
     c                   if        w_sist <> w_chks
     c                   move      *on           *in22
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * Sjekke om bankkontonummerer gyldig modulus 11
      *
     c                   if        c2bgir > 0
     c                   eval      wplist = *blanks
     c                   move      c2bgir        w_chks            1
     c                   move      c2bgir        wplist
     c                   call      'ASMD11'
     c                   parm                    wplist           25
      *
     c                   move      wplist        w_sist            1
      *
7.02 c                   if        u_702 = *off
     c                   if        w_sist <> w_chks
     c                   move      *on           *in23
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
7.02 c                   endif
     c                   endif
      *
      * Sjekke om kontaktperson er utfylt
      *
     c                   if        rakkpe = 'J'
      *
      * Finnes kontaktperson på kunden?
      *
     c                   eval      rukpl6_kund = c2kund
     c     rukpl6_key    setll     rukpl6                                 60
      *
     c                   if        *in60 = *off
     c                   move      *on           *in75
     c                   move      *on           *in40
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
      *
      * Sjekke om telefon/mobil er utfylt
      *
     c                   if        raktlf = 'J'
      *
6.35 c                   if        c2tlfn = *blank
6.35 c*                            c2mobn = *blank
     c                   move      *on           *in68
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om telefon er utfylt med dummyverdi
      *
     c                   move      c2tlfn        w_alfa10
     c                   movel     c2tlfn        w_alfa01
     c                   if        w_alfa01 = '.' and
     c                             w_alfa10 <> ' '
     c                   move      *on           *in24
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
      *
      * Sjekke om mobilnr  er utfylt
      *
     c                   if        rakfax = 'J'
      *
6.35 c                   if        c2mobn = *blank
     c                   move      *on           *in69
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om telefax er utfylt med dummyverdi
6.35  * (kan vel fjernes etterhvert....)
     c                   move      c2tlfx        w_alfa10
     c                   movel     c2tlfx        w_alfa01
     c                   if        w_alfa01 = '.' and
     c                             w_alfa10 <> ' '
     c                   move      *on           *in25
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
      *
      * Sjekke om e-mail adresse er utfylt
      *
     c                   if        rakema = 'J'
      *
     c                   if        c2emal = *blank
     c                   move      *on           *in70
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
      * Sjekke om e-mail adresse er utfylt med dummyverdi
      *
     c                   move      c2emal        w_alfa49
     c                   movel     c2emal        w_alfa01
     c                   if        w_alfa01 = '.' and
     c                             w_alfa49 <> ' '
     c                   move      *on           *in25
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
      *
6.27 c*                  endif
      *
      * Sjekke om foretaksnummer finnes fra før
      *
     c                   if        c2ftnr <> *zeros and
     c                             c2ftnr <> 999999999 and
     c                             w_ftst = 1
     c                   eval      rkunl4_ftnr = c2ftnr
     c     rkunl4_key    setll     rkunl4                                 63
     c     rkunl4_key    reade     rkunl4                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      u2kund = xkkund
     c                   eval      u2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     u2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in48
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunl4_key    reade     rkunl4                                 63
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om personnummer finnes fra før
      *
     c                   if        c2penr <> *zeros and
     c                             c2penr <> 99999999999 and
     c                             w_ftst = 1
     c                   eval      rkunlb_penr = c2penr
     c     rkunlb_key    setll     rkunlb                                 63
     c     rkunlb_key    reade     rkunlb                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      v2kund = xkkund
     c                   eval      v2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     v2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in73
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunlb_key    reade     rkunlb                                 63
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om alfaindex finnes fra før på samme postnr.
      *
     c                   if        c2alfa <> *blank and
     c                             w_ftst = 1
     c                   eval      rkunl2_alfa = c2alfa
     c     rkunl2_key    setll     rkunl2                                 64
     c     rkunl2_key    reade     rkunl2                                 64
     c                   dow       *in64 = *off
     c                   if        xkalfa = c2alfa and
     c                             xkponr = c2ponr and
     c                             xkkund <> c2kund
     c                   eval      w2kund = xkkund
     c                   eval      w2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     w2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunl2_key    reade     rkunl2                                 64
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om ean-nummer finnes fra før
      *
     c                   if        g2eank <> *zeros and
     c                             w_ftst = 1
     c                   eval      rkunl5_eank = g2eank
     c     rkunl5_key    setll     rkunl5                                 63
     c     rkunl5_key    reade     rkunl5                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      t2kund = xkkund
     c                   eval      t2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     t2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in48
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunl5_key    reade     rkunl5                                 63
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om bankgironummer finnes fra før
      *
     c                   if        c2bgir <> *zeros and
     c                             c2bgir <> 99999999999 and
     c                             w_ftst = 1
     c                   eval      rkunl7_bgir = c2bgir
     c     rkunl7_key    setll     rkunl7                                 63
     c     rkunl7_key    reade     rkunl7                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      x2kund = xkkund
     c                   eval      x2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     x2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in48
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunl7_key    reade     rkunl7                                 63
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om telefonnummer finnes fra før
      *
     c                   if        c2tlfn <> *blank and
     c                             c2tlfn <> '.' and
     c                             w_ftst = 1
     c                   eval      rkunl8_tlfn = c2tlfn
     c     rkunl8_key    setll     rkunl8                                 63
     c     rkunl8_key    reade     rkunl8                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      y2kund = xkkund
     c                   eval      y2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     y2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in48
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunl8_key    reade     rkunl8                                 63
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om emailadresse finnes fra før
      *
     c                   if        c2emal <> *blank and
     c                             c2emal <> '.' and
     c                              w_ftst = 1
     c                   eval      rkunl9_emal = c2emal
     c     rkunl9_key    setll     rkunl9                                 63
     c     rkunl9_key    reade     rkunl9                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      z2kund = xkkund
     c                   eval      z2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     z2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in48
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunl9_key    reade     rkunl9                                 63
     c                   enddo
      *
     c                   endif
      *
      * Sjekke om mobiltelefonnummer finnes fra før
      *
     c                   if        c2mobn <> *blank and
     c                             c2mobn <> '.' and
     c                             w_ftst = 1
     c                   eval      rkunla_mobn = c2mobn
     c     rkunla_key    setll     rkunla                                 63
     c     rkunla_key    reade     rkunla                                 63
     c                   dow       *in63 = *off
     c                   if        xkkund <> c2kund
     c                   eval      s2kund = xkkund
     c                   eval      s2navn = xknavn
      *
     c                   eval      w_alin = 6
     c                   eval      w_acol = 25
      *
     c                   exfmt     s2msg
      *
     c                   if        *inkc = *on
     c                   move      *on           *in48
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa2010
     c                   endif
      *
     c                   endif
     c     rkunla_key    reade     rkunla                                 63
     c                   enddo
      *
     c                   endif
      *
     c     xa2010        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Kontroll  I2 bilde (endringer)                                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xsr030        begsr
      *
      * Sjekke om FORSENDELSESMÅTE er gyldig
      *
     c                   if        i2form <> *zero
     c                   move      i2form        p_qkod
     c                   call      'RS717R'
     c                   parm                    p_stat
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in43
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa3010
     c                   else
     c                   move      p_qtxt        i2qtxt
     c                   endif
     c                   endif
      *
      * Sjekke om LEVERINGSBETINGELSE er gyldig
      *
     c                   if        i2lbet <> *zero
     c                   move      i2lbet        p_rkod
     c                   call      'RS718R'
     c                   parm                    p_stat
     c                   parm                    p_rkod
     c                   parm                    p_rtxt
T5.00c                   parm                    p_tx2
T5.00c                   parm                    p_tx3
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in44
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa3010
     c                   else
     c                   movel     p_rtxt        i2rtx1
     c                   endif
     c                   endif
      *
      * Sjekke om SPEDITØR er gyldig
      *
     c                   if        i2sped <> *zero
     c                   move      i2sped        p_vkod
     c                   call      'RS722R'
     c                   parm                    p_stat
     c                   parm                    p_vkod
     c                   parm                    p_vtxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in45
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa3010
     c                   else
     c                   move      p_vtxt        i2vtxt
     c                   endif
     c                   endif
      *
      * Sjekke om KJØRERUTE er gyldig
      *
     c                   if        i2kjor <> *zero
     c                   move      i2kjor        p_yrut
     c                   call      'RS725R'
     c                   parm                    p_stat
     c                   parm                    p_yrut
     c                   parm                    p_ytxt
      *
     c                   if        p_stat = 'N'
     c                   move      *on           *in46
     c                   move      *on           *in81
     c                   eval      w_feil = 1
     c                   goto      xa3010
     c                   else
     c                   move      p_ytxt        i2ytxt
     c                   endif
     c                   endif
      *
     c     xa3010        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * 0-Stilling av arbeidsindikatorer og arbeidsfelt                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xnulle        begsr
      *
     c                   eval      *in21 = *off
     c                   eval      *in22 = *off
     c                   eval      *in23 = *off
     c                   eval      *in24 = *off
     c                   eval      *in25 = *off
     c                   eval      *in27 = *off
6.24 c                   eval      *in28 = *off
6.38 c                   eval      *in29 = *off
      *
     c*                  eval      *in30 = *off
     c                   eval      *in31 = *off
     c                   eval      *in32 = *off
     c                   eval      *in33 = *off
     c                   eval      *in34 = *off
     c                   eval      *in35 = *off
     c                   eval      *in36 = *off
     c                   eval      *in37 = *off
     c                   eval      *in38 = *off
     c                   eval      *in39 = *off
      *
     c                   eval      *in40 = *off
     c                   eval      *in41 = *off
     c                   eval      *in42 = *off
     c                   eval      *in43 = *off
     c                   eval      *in44 = *off
     c                   eval      *in45 = *off
     c                   eval      *in46 = *off
     c                   eval      *in47 = *off
     c                   eval      *in48 = *off
     c                   eval      *in49 = *off
      *
     c                   eval      *in50 = *off
     c                   eval      *in51 = *off
     c                   eval      *in52 = *off
     c                   eval      *in53 = *off
     c                   eval      *in54 = *off
     c                   eval      *in55 = *off
     c                   eval      *in56 = *off
     c                   eval      *in57 = *off
     c                   eval      *in58 = *off
     c                   eval      *in59 = *off
6.3b c                   eval      *in82 = *off
      *
     c                   eval      *in60 = *off
     c                   eval      *in61 = *off
     c                   eval      *in62 = *off
     c                   eval      *in63 = *off
     c                   eval      *in64 = *off
     c                   eval      *in65 = *off
     c                   eval      *in66 = *off
     c                   eval      *in67 = *off
     c                   eval      *in68 = *off
     c                   eval      *in69 = *off
     c                   eval      *in70 = *off
     c                   eval      *in71 = *off
     c                   eval      *in72 = *off
     c                   eval      *in73 = *off
T5.40c                   eval      *in74 = *off
T5.50c                   eval      *in76 = *off
T5.50c                   eval      *in77 = *off
T5.50c                   eval      *in78 = *off
6.40 c                   eval      *in79 = *off
      *
T5.50c                   eval      *in81 = *off
      *
     c                   eval      w_feil = *zero
      *
     c                   endsr
6.23  /eject
6.23  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
6.23  * sjekker om ROLL1 og ROLL2 har mail-adressse på kontaktperson    *
6.23  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
6.23  *
6.23 c     sjekk_mail    begsr
6.23  *
6.23 c                   eval      b_mail = *off
6.23 c                   eval      rukpl6_kund = c2kund
6.23 c     rukpl6_key    setll     rukpl6
6.23 c     rukpl6_key    reade     rukpl6
6.23 c                   dow       not %eof(rukpl6)
6.23 c                   if        rukrol = 'EMAIL1' or
6.23 c                             rukrol = 'EMAIL2'
6.23 c                   if        rumail <> *blank
6.23 c                   eval      b_mail = *on
6.23 c                   leavesr
6.23 c                   endif
6.23 c                   endif
6.23 c     rukpl6_key    reade     rukpl6
6.23 c                   enddo
6.23  *
6.23 c                   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Sjekk om endring skal kopiers til ordre
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
6.33 c     sjekk_ordre   begsr
      *
      *  sjekk om ett av feltene er endret
     c                   if        w_faty <> rkfaty or
     c                             w_mkod <> rkmkod or
     c                             w_betb <> rkbetb or
     c                             w_ekgb <> rkekgb or
     c                             w_fagb <> rkfagb or
     c                             w_neto <> rkneto
      *
     c                   eval      fohelk_kund = rkkund
     c     fohelk_key    setll     fohelk
     c     fohelk_key    reade     fohelk
     c                   dow       not %eof
      * sjekk at ikke koblet mot kundeprosjekt
     c                   if        fokpro = w_kpro
      *
      * sjekk om et av feltene har gammel verdi
      *
     c                   eval      fohelu_numm = fonumm
     c                   eval      fohelu_suff = fosuff
     c     fohelu_key    chain     fohelu
     c                   if        %found
     c                   eval      w_endr = *off
7.04 c                   if        u_704 = *off
      * oppdater de feltene som har gammel verdi, og verdi er forskjellig fra kunde
8.04 c**                 if        fofaty <> 0 and fofaty <> rkfaty
8.04 c                   if        fofaty <> rkfaty
     c                   eval      fofaty = rkfaty
     c                   eval      w_endr = *on
     c                   endif
6.3c c                   if        fomkod <> 0 and fomkod <> rkmkod
     c                   eval      fomkod = rkmkod
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        fokgek <> 0 and fokgek <> rkekgb
8.04 c                   if        fokgek <> rkekgb
     c                   eval      fokgek = rkekgb
     c                   eval      w_endr = *on
     c                   endif
6.3c c                   if        fobetb <> 0 and fobetb <> rkbetb
     c                   eval      fobetb = rkbetb
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        foneto <> 0 and foneto <> rkneto
8.04 c                   if        foneto <> rkneto
     c                   eval      foneto = rkneto
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        fokgfa <> 0 and fokgfa <> rkfagb
8.04 c                   if        fokgfa <> rkfagb
     c                   eval      fokgfa = rkfagb
     c                   eval      w_endr = *on
     c                   endif
7.04 c                   else
7.04  * oppdater de feltene som er forskjellig fra kunde uansett
7.04 c                   if        fofaty <> rkfaty
7.04 c                   eval      fofaty = rkfaty
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        fomkod <> rkmkod
7.04 c                   eval      fomkod = rkmkod
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        fokgek <> rkekgb
7.04 c                   eval      fokgek = rkekgb
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        fobetb <> rkbetb
7.04 c                   eval      fobetb = rkbetb
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        foneto <> rkneto
7.04 c                   eval      foneto = rkneto
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        fokgfa <> rkfagb
7.04 c                   eval      fokgfa = rkfagb
7.04 c                   eval      w_endr = *on
7.04 c                   endif
     c                   endif
      *
     c                   if        w_endr = *on
     c                   time                    foedat
     c                   time                    foetim
     c                   eval      foeusr = l_user
     c                   update    fohelur
6.3c c                   else
6.3c c                   unlock    fohelu
     c                   endif
     c                   endif
     c                   endif
      *
     c     fohelk_key    reade     fohelk
     c                   enddo
      *
     c                   endif
      *
6.33 c                   endsr

      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Sjekk om endring skal kopiers til kundeprosjekt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
6.32 c     sjekk_kundep  begsr
      *
7.02ac                   eval      w_endr = *off
8.06  *
8.06  * Legger sjekken på fakturatype utenfor eksisterende logikk, da dette ikke
8.06  * er avhengig av om prosjektet er utgått. Ref JIRA sak NXS-15495.
8.06  *
8.06 c                   if        w_faty <> rkfaty
8.06  * Sjekker om kunde har kundeprosjekt med gammel verdi
8.06 c                   eval      fkprl1_kund = rkkund
8.06 c     fkprl1_key    setll     fkprl1
8.06 c     fkprl1_key    reade     fkprl1
8.06 c                   dow       not %eof
8.06  * Ikke hvis kundeprosjekt overstyrer kundeverdier
8.06 c                   if        flfkun = 0
8.06 c                   eval      fkprlu_kund = flkund
8.06 c                   eval      fkprlu_kpro = flkpro
8.06 c     fkprlu_key    chain     fkprlu
8.06 c                   if        %found
8.06  * oppdater de feltene som har gammel verdi, og verdi er forskjellig fra kunde
8.06 c                   if        flfaty <> rkfaty
8.06 c                   eval      flfaty = rkfaty
8.06 c                   eval      w_endr = *on
8.06 c                   eval      fleusr = l_user
8.06 c                   time                    fledat
8.06 c                   time                    fletim
8.06 c                   update    fkprlur
8.06 c                   eval      w_kpro = flkpro
8.06 c                   exsr      sjekk_ordre
8.06 c                   else
8.06 c                   unlock    fkprlu
8.06 c                   endif
8.06 c                   endif
8.06 c                   endif
8.06  *
8.06 c     fkprl1_key    reade     fkprl1
8.06 c                   enddo
8.06  *
8.06 c                   endif
8.06  *
      *  sjekk om ett av feltene er endret
8.06 c**                 if        w_faty <> rkfaty or
8.06 c                   if        w_mkod <> rkmkod or
     c                             w_ekgb <> rkekgb or
     c                             w_prpa <> rkprpa or
     c                             w_betb <> rkbetb or
     c                             w_neto <> rkneto or
     c                             w_fagb <> rkfagb or
     c                             w_samf <> rksamf or
     c                             w_sekv <> rksekv
      *
      * Sjekker om kunde har kundeprosjekt med gammel verdi
      *
     c                   eval      fkprl1_kund = rkkund
     c     fkprl1_key    setll     fkprl1
     c     fkprl1_key    reade     fkprl1
     c                   dow       not %eof
      * sjekk om kundeprosjekt er frikoblet fra kunde og aktivt
6.33 c                   if        flfkun = 0 and fltdat >= w_date
     c                   eval      fkprlu_kund = flkund
     c                   eval      fkprlu_kpro = flkpro
     c     fkprlu_key    chain     fkprlu
     c                   if        %found
     c                   eval      w_endr = *off
8.04  * Endringen skjer om prosjektet ikke er satt skal overstyre kunde
7.04 c                   if        u_704 = *off
      * oppdater de feltene som har gammel verdi, og verdi er forskjellig fra kunde
8.04 c**                 if        flfaty <> 0 and flfaty <> rkfaty
8.06 c**                 if        flfaty <> rkfaty
8.06 c**                 eval      flfaty = rkfaty
8.06 c**                 eval      w_endr = *on
8.06 c**                 endif
6.3c c                   if        flmkod <> 0 and flmkod <> rkmkod
     c                   eval      flmkod = rkmkod
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        flekgb <> 0 and flekgb <> rkekgb
8.04 c                   if        flekgb <> rkekgb
     c                   eval      flekgb = rkekgb
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        flprpa <> 0 and flprpa <> rkprpa
8.04 c                   if        flprpa <> rkprpa
     c                   eval      flprpa = rkprpa
     c                   eval      w_endr = *on
     c                   endif
6.3c c                   if        flbetb <> 0 and flbetb <> rkbetb
     c                   eval      flbetb = rkbetb
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        flneto <> 0 and flneto <> rkneto
8.04 c                   if        flneto <> rkneto
     c                   eval      flneto = rkneto
     c                   eval      w_endr = *on
     c                   endif
8.04 c**                 if        flfagb <> 0 and flfagb <> rkfagb
8.04 c                   if        flfagb <> rkfagb
     c                   eval      flfagb = rkfagb
     c                   eval      w_endr = *on
     c                   endif
6.3c c                   if        flsamf <> 0 and flsamf <> rksamf
     c                   eval      flsamf = rksamf
     c                   eval      w_endr = *on
     c                   endif
6.3c c                   if        flsekv <> 0 and flsekv <> rksekv
     c                   eval      flsekv = rksekv
     c                   eval      w_endr = *on
     c                   endif
7.04 c                   else
7.04  * oppdater de feltene som er forskjellig fra kunde uansett
8.06 c**                 if        flfaty <> rkfaty
8.06 c**                 eval      flfaty = rkfaty
8.06 c**                 eval      w_endr = *on
8.06 c**                 endif
7.04 c                   if        flmkod <> rkmkod
7.04 c                   eval      flmkod = rkmkod
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flekgb <> rkekgb
7.04 c                   eval      flekgb = rkekgb
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flprpa <> rkprpa
7.04 c                   eval      flprpa = rkprpa
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flbetb <> rkbetb
7.04 c                   eval      flbetb = rkbetb
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flneto <> rkneto
7.04 c                   eval      flneto = rkneto
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flfagb <> rkfagb
7.04 c                   eval      flfagb = rkfagb
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flsamf <> rksamf
7.04 c                   eval      flsamf = rksamf
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   if        flsekv <> rksekv
7.04 c                   eval      flsekv = rksekv
7.04 c                   eval      w_endr = *on
7.04 c                   endif
7.04 c                   endif
     c                   if        w_endr = *on
     c                   eval      fleusr = l_user
     c                   time                    fledat
     c                   time                    fletim
     c                   update    fkprlur
     c                   eval      w_kpro = flkpro
     c                   exsr      sjekk_ordre
6.3c c                   else
6.3c c                   unlock    fkprlu
     c                   endif
     c                   endif
6.33 c                   endif
     c     fkprl1_key    reade     fkprl1
     c                   enddo
7.02ac                   if        w_Endr = *off
7.02ac                   exsr      sjekk_ordre
7.02ac                   endif
     c                   endif
      *
     c                   endsr
      /eject
      *
8.02  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
8.02  * Håndtering av verdier fra Profil Manager
8.02  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
8.02  *
8.02 c     sub_profilm   begsr
8.02  *
8.02  *  Kall til API for å hente info om Profile Manager
8.02  *
8.02  * Henter inn løpenummer teller
8.02  *
8.02 c                   eval      w_kode = '0'
8.02 c                   eval      w_fell = 'NXTKLI'
8.02 c                   eval      w_type = *blank
8.02 c                   eval      w_fast = *blank
8.02 c                   eval      w_numm = *zero
8.02  *
8.02 c                   call      'AS100R'
8.02 c                   parm                    w_kode
8.02 c                   parm                    w_firm
8.02 c                   parm                    w_fell
8.02 c                   parm                    w_type
8.02 c                   parm                    w_fast
8.02 c                   parm                    w_numm
8.02  *
8.02 c                   eval      w_memb = 'AA' + %char(w_numm)
8.02 c                   eval      w_stat = '0'
8.02  * Slett for sikkerhetsskyld om det er noe som ligger her fra før
8.02 c/exec sql
8.02 c+ delete from promst
8.02 c+   where pmmemb = :w_memb
8.02 c/end-exec
8.02  *
8.02 c                   call      'AP050R'
8.02 c                   parm                    w_firm
8.02 c                   parm                    w_memb
8.02 c                   parm                    w_stat
8.02  *
8.02 c                   if        w_stat = '9'
8.02  *
8.02 c                   eval      w_ctli = 12
8.02 c                   eval      w_ctpo = 42
8.02 c                   eval      w_mld01 = 'Innhenting av PM info feilet'
8.02 c                   eval      w_mld02 = 'Prøv på nytt, eller kontakt EG'
8.02 c                   call      'AA006C'
8.02 c                   parm                    w_ctli
8.02 c                   parm                    w_ctpo
8.02 c                   parm                    w_mld01
8.02 c                   parm                    w_mld02
8.02  *
8.02 c                   elseif    w_stat = '8'
8.02  *
8.02 c                   eval      w_ctli = 12
8.02 c                   eval      w_ctpo = 42
8.02 c                   eval      w_mld01 = 'Teknisk feil ved retur       '
8.02 c                   eval      w_mld02 = 'Kontakt EG Support           '
8.02 c                   call      'AA006C'
8.02 c                   parm                    w_ctli
8.02 c                   parm                    w_ctpo
8.02 c                   parm                    w_mld01
8.02 c                   parm                    w_mld02
8.02  *
8.02 c                   elseif    w_stat = '7'
8.02  *
8.02 c                   eval      w_ctli = 12
8.02 c                   eval      w_ctpo = 42
8.02 c                   eval      w_mld01 = 'Returfila med PM info er tom '
8.02 c                   eval      w_mld02 = 'Kontakt EG Support           '
8.02 c                   call      'AA006C'
8.02 c                   parm                    w_ctli
8.02 c                   parm                    w_ctpo
8.02 c                   parm                    w_mld01
8.02 c                   parm                    w_mld02
8.02  * Da har vi fått noe i retur
8.02 c                   else
8.02  *
8.02 c                   call      'PM500R'
8.02 c                   parm                    w_memb
8.02 c                   parm                    w_pmtx
8.02 c                   parm                    w_noit
8.02  *
8.02 c                   eval      f2noit = w_noit
8.02 c                   eval      f2pmtx = w_pmtx
8.02  *
8.02 c                   endif
8.02  *
8.02  * Rydd opp etter API kall og valg av verdier
8.02  *
8.02 c/exec sql
8.02 c+ delete from promst
8.02 c+   where pmmemb = :w_memb
8.02 c/end-exec
8.02  *
8.02 c                   endsr
8.02  *
8.10  *
8.10  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
8.10  * Subrutine for hentingav kundeinfo fra Bisnode
8.10  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
8.10  *
8.10 c     bis_kund      begsr
8.10  *
8.10 c                   eval      w_alin = 3
8.10 c                   eval      w_acol = 5
8.10 c                   exfmt     g3win
8.10 c                   if        *inkc = *on or
8.10 c                             *inkl = *on
8.10 c                   leavesr
8.10 c                   endif
8.10
8.10 c                   if        g3pnum <> ' '
8.10 c                   call      'FA931R'
8.10 c                   parm                    g3pnum
8.10 c                   parm                    w_benav
8.10 c                   parm                    w_badr1
8.10 c                   parm                    w_badr2
8.10 c                   parm                    w_bpnum
8.10 c                   parm                    w_bpste
8.10 c                   parm                    w_btele
8.10 c                   parm                    w_bmobi
8.10 c                   parm                    w_kgre
8.10 c                   parm                    w_bfdat
8.10 c                   endif
8.10
8.10 c                   if        g3fnum <> ' '
8.10 c                   call      'FA932R'
8.10 c                   parm                    g3fnum
8.10 c                   parm                    w_benav
8.10 c                   parm                    w_badr1
8.10 c                   parm                    w_badr2
8.10 c                   parm                    w_bpnum
8.10 c                   parm                    w_bpste
8.10 c                   parm                    w_btele
8.10 c                   parm                    w_bmobi
8.10 c                   parm                    w_kgre
8.10 c                   parm                    w_rati
8.10 c                   endif
8.10
8.10 c                   if        w_benav <> ' '
8.10 c                   eval      c2navn = w_benav
8.10 c                   eval      c2gate = w_badr1
8.10 c                   eval      c2adr2 = w_badr2
8.10 c                   eval      c2ponr = w_bpnum
8.10 c                   eval      c2tlfn = w_btele
8.10 c                   eval      c2mobn = w_bmobi
8.10 c                   eval      c2grns = w_kgre
8.10 c                   endif
8.10  *
8.10 c     end_kund      endsr
8.10  *
8.10  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
8.10  * Subrutine for kredittsjekk mot Bisnode o
8.10  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
8.10  *
8.10 c     kred_sjk      begsr
8.10  *
8.10  // Sjekker om bisnode parametre er satt i koderegister
8.10
8.02  // Foretak?
8.02
8.10       if c2ftnr > 0;
8.10        exec sql
8.10        select rkktyp
8.10          into :w_type
8.10         from ra33st
8.10          where rkktyp = ' ';
8.10            if sqlcod = 100
8.10            or sqlcod < 0;
8.10              exfmt g3msg1;
8.10              leavesr;
8.10            endif;
8.10            *in63 = *on;
8.10            g4fnum = c2ftnr;
8.10           endif;
8.10
8.10  // Privat?
8.10
8.10       if c2ftnr = 0;
8.10        exec sql
8.10        select rkktyp
8.10          into :w_type
8.10         from ra33st
8.10          where rkktyp = 'PRIVAT';
8.10            if sqlcod = 100
8.10              or sqlcod < 0;
8.10              exfmt g3msg1;
8.10              leavesr;
8.10            endif;
8.10            *in63 = *off;
8.10            g4pnum = 0;
8.10       endif;
8.10
8.10 c                   eval      w_alin = 3
8.10 c                   eval      w_acol = 5
8.10 c                   exfmt     g4win
8.10 c                   if        *inkc = *on or
8.10 c                             *inkl = *on
8.10 c                   leavesr
8.10 c                   endif
8.10
8.10  *
8.10  * Call program for oppslag mot Bisnode firma
8.10  *
8.10 c                   if        g4fnum > 0
8.10 c                   call      'FA936R'
8.10 c                   parm                    g4fnum
8.10 c                   parm                    w_kgre
8.10 c                   parm                    w_rati
8.10  *
8.10 c                   endif
8.10  *
8.10  * Call program for oppslag mot Bisnode privat
8.10  *
8.10 c                   if        g4pnum > 0
8.10 c                   call      'FA935R'
8.10 c                   parm                    g4pnum
8.10 c                   parm                    w_kgre
8.10 c                   parm                    w_rati
8.10 c                   endif
8.10
8.10 c                   eval      g5fnum = g4fnum
8.10 c                   eval      g5pnum = g4pnum
8.11 c                   eval      *in64 = *off
8.11
8.11 c                   if        w_rati = 'Feil'
8.11 c                   eval      g5scor = 'Oppslag mot Bisnode feilet'
8.11 c                   eval      *in64 = *on
8.11 c                   else
8.10 c                   eval      g5scor = 'Score på ' + %trim(w_rati) +
8.10 c                                      ' gir kredittgrense på ' +
8.10 c                                       %trim(%char(w_kgre))
8.11 c                   endif
8.10 c                   exfmt     g5win
8.10 c                   if        *inkc = *on or
8.10 c                             *inkl = *on
8.10 c                   leavesr
8.10 c                   endif
8.10
8.10 c                   if        g5gopd = 'J'
8.10 c                   eval      c2grns = w_kgre
8.10 c                   endif
8.10  *
8.10 c     end_kred      endsr
8.10  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      w_alin = 0
     c                   eval      w_acol = 0
     c                   eval      w_feil = *zero
      *
      * Parametre til Notatark.
      *
     c                   move      'K'           wpsyst
     c                   eval      wpspes = 0
     c                   eval      wpavde = 0
6.20 c                   eval      wppros = *blanks
     c                   eval      wpakti = *blanks
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    w_kund
     c                   parm                    wpvalg
      *
      * Legge inn firmanummer
      *
     c                   move      l_firm        w_firm
     c                   move      w_kund        c2kund
      *
      * Sperre for registrering ved spørring
      *
     c                   if        wpvalg = 5
     c                   move      *on           *in30
     c                   endif
      *
      * Hent kunde
      *
     c     rkunl1_key    chain     rkunl1                             61
      *
      * Hent statuskode 1
      *
     c     raa1l1_key    chain     raa1l1
      *
     c                   if        %found(raa1l1)
     c                   move      ra1bek        w_1bek
     c                   move      ra1bkk        w_1bkk
     c                   else
     c                   move      15            w_1bek
     c                   move      0             w_1bkk
     c                   endif
      *
      * Hent statuskode 3
      *
     c     raa3l1_key    chain     raa3l1
      *
     c                   if        %found(raa3l1) and
     c                             ra3mfe = '1'
     c                   eval      w_3mfe = ra3mfe
     c                   else
     c                   eval      w_3mfe = ' '
     c                   endif
5.41  *
5.41  * Hent statuskode 8
5.41  *
5.41 c     raa8l1_key    chain     raa8l1
5.41  *
5.41  * Hent firmainformasjon
5.41  *
5.41 c     afir_key      chain     afirl1
7.02  *
7.02  * Endring 7.02
7.02  *
7.02   CallP CO402R(l_filg:w_firm:0:'RK101R_702':
7.02                    co402_verdi1:co402_verdi2);
7.02   if co402_verdi1 = '1';
7.02     u_702 = *on;
7.02   endif;
7.04  *
7.04  * Endring 7.04
7.04  *
7.04   CallP CO402R(l_filg:w_firm:0:'RK101R_704':
7.04                    co402_verdi1:co402_verdi2);
7.04   if co402_verdi1 = '1';
7.04     u_704 = *on;
7.04   endif;
8.09  *
8.09  * Kredittsjekk mot Bisnode?
8.09  *
8.09   CallP CO402R(l_filg:w_firm:0:'BISNODE - EKSTERNT_KUNDESØK':
8.09                    co402_verdi1:co402_verdi2);
8.09   if co402_verdi1 = '1';
8.09     u_809 = *on;
8.09   endif;
      *
      * Key for kunderegister via kundenummer
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Key for kunderegister via kundenummer
      *
     c     rkunlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunlu_kund
      *
      * Key for kunderegister via alfaindex
      *
     c     rkunl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl2_alfa
      *
      * Key for kunderegister via foretaksnummer
      *
     c     rkunl4_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl4_ftnr
      *
      * Key for kunderegister via ean-kundenummer
      *
     c     rkunl5_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl5_eank
      *
      * Key for kunderegister via bankgironummer
      *
     c     rkunl7_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl7_bgir
      *
      * Key for kunderegister via telefonnummer
      *
     c     rkunl8_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl8_tlfn
      *
      * Key for kunderegister via e-postadresse
      *
     c     rkunl9_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl9_emal
      *
      * Key for kunderegister via mobiltelfonnummer
      *
     c     rkunla_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunla_mobn
      *
      * Key for kunderegister via personnummer
      *
     c     rkunlb_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunlb_penr
      *
      * Key for avtalespesifikasjon
      *
     c     rksal1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rksal1_kund
      *
     c     rksalu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rksalu_kund
      *
T5.33 * Key for notatark
      *
E5.40c     rklal2_key    klist
T5.33c                   kfld                    w_firm
E5.40c                   kfld                    rklal2_syst
E5.40c                   kfld                    rklal2_pros
E5.40c                   kfld                    rklal2_akti
E5.40c                   kfld                    rklal2_kund
      *
      * Key for oppslag på statuskode 1
      *
     c     raa1l1_key    klist
     c                   kfld                    w_firm
      * Key for oppslag på statuskode 3
      *
     c     raa3l1_key    klist
     c                   kfld                    w_firm
5.41  *
5.41  * Key for oppslag på statuskode 8
5.41  *
5.41 c     raa8l1_key    klist
5.41 c                   kfld                    w_firm
5.41  *
5.41  * Key for firma
5.41  *
5.41 c     afir_key      klist
5.41 c                   kfld                    w_firm
      *
      * Key for postnummer-register
      *
     c     apospf_key    klist
     c                   kfld                    apospf_ponr
      *
      * Key for oppslag på kundekategori
      *
     c     ra11l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra11l1_kkat
      *
T5.50 * Key for kontaktpersonregister pr. kunde
      *
T5.50c     rukpl6_key    klist
T5.50c                   kfld                    w_firm
T5.50c                   kfld                    rukpl6_kund
6.32  *
6.32  * Key for les av kundeprosjekt
6.32  *
6.32 c     fkprl1_key    klist
6.32 c                   kfld                    w_firm
6.32 c                   kfld                    fkprl1_kund
6.32  *
6.32  * Key for oppdatering av kundeprosjekt
6.32  *
6.32 c     fkprlu_key    klist
6.32 c                   kfld                    w_firm
6.32 c                   kfld                    fkprlu_kund
6.32 c                   kfld                    fkprlu_kpro
6.33  *
6.33  * Key for oppslag på ordehode
6.33  *
6.33 c     fohelk_key    klist
6.33 c                   kfld                    w_firm
6.33 c                   kfld                    fohelk_kund
6.33  *
6.33  * Key for oppdatering av odre-hode
6.33  *
6.33 c     fohelu_key    klist
6.33 c                   kfld                    w_firm
6.33 c                   kfld                    fohelu_numm
6.33 c                   kfld                    fohelu_suff
      *
6.40  * Key for les på status-register
6.40  *
6.40 c     fstsl1_key    klist
6.40 c                   kfld                    w_firm
      *
6.40  * Key for oppslag av butikk-status
6.40  *
6.40 c     key01         klist
6.40 c                   kfld                    w_firm
8.02  *
8.02  * Key for oppdatering av profile manager
8.02  *
8.02 c     rku3iu_key    klist
8.02 c                   kfld                    w_firm
8.02 c                   kfld                    rku3iu_kund
8.02  *
8.02  * Key for oppdatering av profile manager
8.02  *
8.02 c     rku3i1_key    klist
8.02 c                   kfld                    w_firm
8.02 c                   kfld                    rku3i1_kund
8.09  *
8.09  * Key for oppdatering av profile manager
8.09  *
8.09 c     rkunlr_key    klist
8.09 c                   kfld                    w_firm
8.09 c                   kfld                    rkunlr_kund
      *
     c                   time                    w_date
      *
     c                   endsr
      *
      /eject
**
  Ny post                  001
  Endring                  002
  Vise                     003
* Slettet *                004
