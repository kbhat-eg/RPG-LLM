     h datedit(*dmy.) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RH965R                                              *
      * Beskrivelse . . : Hovedbok - omkjøring av journal - utplukk           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      * V5.40     240805  Fjernet testen mot faste konti                 KOB  *
      * V5.41     020905  Lagt inn nullstilling av mva.grl på resk.post. KOB  *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frhtrl1    if   e           k disk    rename(rhtrpfr:rhtrl1r)
     frktrl1    if   e           k disk    rename(rktrpfr:rktrl1r)
     frltrl1    if   e           k disk    rename(rltrpfr:rltrl1r)
     frhwapf    o    e           k disk
      *
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * Data struktur
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d                 ds
     d wksort                  2     65
     d  wkfirm                        3  0 overlay(wksort)                      Firma
     d  wkjour                        5  0 overlay(wksort:4)                    Kunde
6.NU d  wkbiln                        8  0 overlay(wksort:10)                   Bilags
6.NU d  wkbdat                         d   overlay(wksort:18)                   Bilags
6.NU d                                     datfmt(*iso)
6.NU d  wkkont                        6  0 overlay(wksort:28)                   Bilags
6.NU d  wkspes                        4  0 overlay(wksort:34)                   Bilags
6.NU d  wkavde                        4  0 overlay(wksort:38)                   Bilags
6.NU d  wkrper                        2  0 overlay(wksort:42)                   Bilags
6.NU d  wktist                         t   overlay(wksort:44)                   Post-n
      *
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * LOCAL DATA
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      *  Parameter i LDA
      *
     d                uds
     d rhpkda                300    305  0
     d rhprÅr                         4  0
     d rhpper                         2  0
     d rhppef                         2  0
     d rhppet                         2  0
     d rhpavf                         4  0
     d rhpavt                         4  0
     d rhpjof                         5  0
     d rhpjot                         5  0
     d rhpsrt                         1
     d rhpsml                         1
     d rhpavv                         1
     d rhpkgs                         1
     d rhpkks                         1
     d rhpsps                         1
     d rhpktu                         1
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d gavde           s                   like(rbavde)
     d gbdat           s                   like(rbbdat)
     d gbilk           s                   like(rbbilk)
     d gbiln           s                   like(rbbiln)
     d gfirm           s                   like(rbfirm)
     d gjour           s                   like(rbjour)
     d gkont           s                   like(rbkon6)
     d gmvak           s                   like(rbmvak)
     d gmvao           s                   like(rbmvao)
     d gneto           s                   like(rbneto)
     d graar           s                   like(rbraar)
     d grper           s                   like(rbrper)
     d gspes           s                   like(rbspes)
     d gtist           s                   like(rbtist)
     d gtext           s                   like(rbtext)
      *
     d w_firm          s              3  0
     d w_raar          s              4  0
      *
      /eject
      *
      * Les hovedboks-transaksjoner
      *
     c     rhtrl1_key    setll     rhtrl1                                 60
     c     rhtrl1_key    reade     rhtrl1                                 60
      *
     c                   dow       *in60 = *off                                              .
      *
      * Sjekk journalnr. fra/til
      *
     c                   if        rbjour < rhpjof or                                    .....
     c                             rbjour > rhpjot                                       .....
     c                   goto      lesh                                                      .
     c                   endif                                                           .....
      *
      * Ta vekk auto-poster kundereskontro/leverandørreskontro
      *
     c                   if        rbbilk = 94 or                                        .....
     c                             rbbilk = 95                                           .....
     c                   goto      lesh                                                      .
     c                   endif                                                           .....
      *
      * Behandling av utvalgte poster
      *
     c                   eval      wksort = *zeros
     c                   move      rbfirm        wkfirm
     c                   move      rbjour        wkjour
     c                   move      rbbiln        wkbiln
     c                   move      rbbdat        wkbdat
     c                   move      rbkont        wkkont
     c                   move      rbkont        rbkon6
     c                   move      rbspes        wkspes
     c                   move      rbavde        wkavde
     c                   move      rbrper        wkrper
     c                   move      rbtist        wktist
     c                   move      wksort        rwkkey
     c                   write     rhwapfr
      *
     c     lesh          tag
      *
     c     rhtrl1_key    reade     rhtrl1                                 60
     c                   enddo
      *
     c/eject
      *
      * Les kunde-transaksjoner
      *
     c     rktrl1_key    setll     rktrl1                                 61
     c     rktrl1_key    reade     rktrl1                                 61
      *
     c                   dow       *in61 = *off                                              .
      *
      * Sjekk om riktig år
      *
     c                   if        rnraar > rhprÅr or                                    .....
     c                             rnraar < rhprÅr                                       .....
     c                   goto      lesk                                                      .
     c                   endif                                                           .....
      *
      * Sjekk journalnr. fra/til
      *
     c                   if        rnjour < rhpjof or                                    .....
     c                             rnjour > rhpjot                                       .....
     c                   goto      lesk                                                      .
     c                   endif                                                           .....
      *
      * Behandling av utvalgte poster
      *
     c                   eval      wksort = *zeros
     c                   move      rnfirm        wkfirm
     c                   move      rnjour        wkjour
     c                   move      rnbiln        wkbiln
     c                   move      rnbdat        wkbdat
     c                   move      rnkund        wkkont
     c                   move      *zeros        wkspes
     c                   move      *zeros        wkavde
     c                   move      rnrper        wkrper
     c                   move      *loval        wktist
     c                   move      wksort        rwkkey
      *
     c                   move      rnfirm        rbfirm
     c                   move      rnraar        rbraar
     c                   move      rnkund        rbkon6
     c                   move      *zeros        rbspes
     c                   move      *zeros        rbavde
     c                   move      rnrper        rbrper
     c                   move      *loval        rbtist
     c                   move      *zeros        rbmvap
     c                   move      rnbiln        rbbiln
     c                   move      rnbilk        rbbilk
     c                   move      rntext        rbtext
     c                   move      rnbelØ        rbneto
     c                   move      *zeros        rbmvab
     c                   move      *zeros        rbmvag
     c                   move      *zeros        rbinvb
     c                   move      *blank        rbrmrk
     c                   move      *blank        rbmvak
     c                   move      *blank        rbmmrk
     c                   move      *blank        rbhmrk
     c                   move      *blank        rbautk
     c                   move      *blank        rbmvao
     c                   move      rnjour        rbjour
     c                   move      rnbdat        rbbdat
     c                   move      rnvalk        rbvalk
     c                   move      rnvalb        rbvalb
     c                   move      *zeros        rbvals
     c                   move      *zeros        rbmngd
     c                   move      *zeros        rbmngk
     c                   move      *zeros        rbpros
     c                   move      *blank        rbavst
     c                   move      *blank        rbbref
      *
     c                   write     rhwapfr
      *
     c     lesk          tag
      *
     c     rktrl1_key    reade     rktrl1                                 61
     c                   enddo
     c/eject
      *
      * Les leverandør-transaksjoner
      *
     c     rltrl1_key    setll     rltrl1                                 62
     c     rltrl1_key    reade     rltrl1                                 62
      *
     c                   dow       *in62 = *off                                              .
      *
      * Sjekk om riktig år
      *
     c                   if        roraar > rhprÅr or                                    .....
     c                             roraar < rhprÅr                                       .....
     c                   goto      lesl                                                      .
     c                   endif                                                           .....
      *
      * Sjekk journalnr. fra/til
      *
     c                   if        rojour < rhpjof or                                    .....
     c                             rojour > rhpjot                                       .....
     c                   goto      lesl                                                      .
     c                   endif                                                           .....
      *
      * Behandling av utvalgte poster
      *
     c                   eval      wksort = *zeros
     c                   move      rofirm        wkfirm
     c                   move      rojour        wkjour
     c                   move      robiln        wkbiln
     c                   move      robdat        wkbdat
     c                   move      rolevr        wkkont
     c                   move      *zeros        wkspes
     c                   move      *zeros        wkavde
     c                   move      rorper        wkrper
     c                   move      *loval        wktist
     c                   move      wksort        rwkkey
      *
     c                   move      rofirm        rbfirm
     c                   move      roraar        rbraar
     c                   move      rolevr        rbkon6
     c                   move      *zeros        rbspes
     c                   move      *zeros        rbavde
     c                   move      rorper        rbrper
     c                   move      *loval        rbtist
     c                   move      *zeros        rbmvap
     c                   move      robiln        rbbiln
     c                   move      robilk        rbbilk
     c                   move      rotext        rbtext
     c                   move      robelØ        rbneto
     c                   move      *zeros        rbmvab
     c                   move      *zeros        rbmvag
     c                   move      *zeros        rbinvb
     c                   move      *blank        rbrmrk
     c                   move      *blank        rbmvak
     c                   move      *blank        rbmmrk
     c                   move      *blank        rbhmrk
     c                   move      *blank        rbautk
     c                   move      *blank        rbmvao
     c                   move      rojour        rbjour
     c                   move      robdat        rbbdat
     c                   move      rovalk        rbvalk
     c                   move      rovalb        rbvalb
     c                   move      *zeros        rbvals
     c                   move      *zeros        rbmngd
     c                   move      *zeros        rbmngk
     c                   move      *zeros        rbpros
     c                   move      *blank        rbavst
     c                   move      *blank        rbbref
      *
     c                   write     rhwapfr
      *
     c     lesl          tag
      *
     c     rltrl1_key    reade     rltrl1                                 62
     c                   enddo
      *
     c/space 3
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
      *
     c/eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Key for hovedboksposter
      *
     c     rhtrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_raar
      *
      * Key for kundeposter
      *
     c     rktrl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for leverandørposter
      *
     c     rltrl1_key    klist
     c                   kfld                    w_firm
      *
     c                   eval      w_firm = l_firm
     c                   eval      w_raar = rhprÅr
      *
     c                   endsr
