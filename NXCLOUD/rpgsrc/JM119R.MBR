     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASVADM
      * Program . . . . : JM119R
      * Beskrivelse . . : Vedlikehold av kampanjepriser, start overføring
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       270997 HKO  Nytt program
      *       190905 HKO  Endret valg til kontrolliste ja/nei
7.01  *       100516 bof  Kan overføre pr. prisgruppe parm.
7.01  *       110516 bof  Kun enkelte brukere har tilgang til å endre prgr=' '
7.01  *                   FBKO19 styrer hvilke brukere - b_mast (masterbruker)
7.01  *                   For bruker i en prisgr
7.01  *                       - kun kopiere fra prisgr=' '
7.01  *                       - lov til å slette / endre med egen prisgr.
7.01  *                       - lov til å se egen og blank prisgr.
7.01  *                       - love til selektere bort prisgr=' ' hvis egen.
7.02  *       240417 bof  Hvis ikke master, så sendes prisgr. med i parrgr=' '
7.03  *       040220 bsa  Endringer relatert til ny GUI.
8.01  *PRG2   130622 bof  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
7.01 fra30l1    if   e           k disk    rename(ra30pfr:ra30l1r)
7.01 ffusrl1    if   e           k disk    rename(fusrpfr:fusrl1r)
     fjm119d    cf   e             workstn
      *
      * Datastruktur for parameterliste -ut
      *
     d                 ds
8.01 d d_list                        55
     d  d_firm                        3  0 overlay(d_list)
     d  d_kamp                        5    overlay(d_list:4)
     d  d_kntr                        1  0 overlay(d_list:9)
7.01 d  d_pgva                        1  0 overlay(d_list:10)
8.01 d  d_pr01                        2    overlay(d_list:11)
8.01 d  d_pr02                        2    overlay(d_list:13)
8.01 d  d_pr03                        2    overlay(d_list:15)
8.01 d  d_pr04                        2    overlay(d_list:17)
8.01 d  d_pr05                        2    overlay(d_list:19)
8.01 d  d_pr06                        2    overlay(d_list:21)
8.01 d  d_pr07                        2    overlay(d_list:23)
8.01 d  d_pr08                        2    overlay(d_list:25)
8.01 d  d_pr09                        2    overlay(d_list:27)
8.01 d  d_pr10                        2    overlay(d_list:29)
8.01 d  d_pr11                        2    overlay(d_list:31)
8.01 d  d_pr12                        2    overlay(d_list:33)
8.01 d  d_pr13                        2    overlay(d_list:35)
8.01 d  d_pr14                        2    overlay(d_list:37)
8.01 d  d_pr15                        2    overlay(d_list:39)
8.01 d  d_pr16                        2    overlay(d_list:41)
8.01 d  d_pr17                        2    overlay(d_list:43)
8.01 d  d_pr18                        2    overlay(d_list:45)
8.01 d  d_pr19                        2    overlay(d_list:47)
8.01 d  d_pr20                        2    overlay(d_list:49)
7.01  *
7.01  * Definering av variable i nøkler
7.01  *
7.01 d ra30l1_dkod     s                   like(redkod)
7.01 d fusrl1_user     s                   like(fbuser)
7.01 d w_firm          s                   like(redfir)
      *
      * Definering av parametre
      *
     d p_firm          s              3  0
     d p_kamp          s              5
7.02 d p_prgr          s                   like(redkod)
      *
7.01 d b_mast          s              1    inz(*off)
7.01  *
7.01  * Definering av Local data area
7.01  *
7.01 d                uds
7.01 d l_user                911    920
7.01 d l_firm                944    946  0
7.01 d l_fnav                951    980
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Behandler bildet
      *
     c     b1tag         tag
7.01 c                   if        b_mast = *off
      *
     c                   exfmt     b1bld
7.01 c                   else
7.01 c                   exfmt     b2bld
7.01 c                   endif
      *
      * Behandling av funksjonstaster
      *
     c                   if        *inkc or *inkl
     c                   goto      avslutt
     c                   endif
7.01  *
7.01 c                   if        b_mast = *on
7.01  *
7.01  * Validering
7.01  *
7.01 c                   if        b2pr01 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr01
7.01 c     ra30l1_key    chain     ra30l1                             41
7.01 c                   if        *in41 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr02 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr02
7.01 c     ra30l1_key    chain     ra30l1                             42
7.01 c                   if        *in42 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr03 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr03
7.01 c     ra30l1_key    chain     ra30l1                             43
7.01 c                   if        *in43 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr04 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr04
7.01 c     ra30l1_key    chain     ra30l1                             44
7.01 c                   if        *in44 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr05 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr05
7.01 c     ra30l1_key    chain     ra30l1                             45
7.01 c                   if        *in45 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr06 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr06
7.01 c     ra30l1_key    chain     ra30l1                             46
7.01 c                   if        *in46 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr07 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr07
7.01 c     ra30l1_key    chain     ra30l1                             47
7.01 c                   if        *in47 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr08 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr08
7.01 c     ra30l1_key    chain     ra30l1                             48
7.01 c                   if        *in48 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr09 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr09
7.01 c     ra30l1_key    chain     ra30l1                             49
7.01 c                   if        *in49 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr10 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr10
7.01 c     ra30l1_key    chain     ra30l1                             50
7.01 c                   if        *in50 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr11 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr11
7.01 c     ra30l1_key    chain     ra30l1                             51
7.01 c                   if        *in51 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr12 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr12
7.01 c     ra30l1_key    chain     ra30l1                             52
7.01 c                   if        *in52 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr13 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr13
7.01 c     ra30l1_key    chain     ra30l1                             53
7.01 c                   if        *in45 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr14 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr14
7.01 c     ra30l1_key    chain     ra30l1                             54
7.01 c                   if        *in54 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr15 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr15
7.01 c     ra30l1_key    chain     ra30l1                             55
7.01 c                   if        *in55 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr16 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr16
7.01 c     ra30l1_key    chain     ra30l1                             56
7.01 c                   if        *in56 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr17 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr17
7.01 c     ra30l1_key    chain     ra30l1                             57
7.01 c                   if        *in57 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr18 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr18
7.01 c     ra30l1_key    chain     ra30l1                             58
7.01 c                   if        *in58 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr19 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr19
7.01 c     ra30l1_key    chain     ra30l1                             59
7.01 c                   if        *in59 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   if        b2pr20 <> *blank
7.01 c                   eval      ra30l1_dkod = b2pr20
7.01 c     ra30l1_key    chain     ra30l1                             60
7.01 c                   if        *in60 = *on
7.01 c                   goto      b1tag
7.01 c                   endif
7.01 c                   endif
7.01 c                   endif
      *
      * Kaller behandlingsprogram
      *
     c                   eval      d_kntr = b1valg
7.01 c                   eval      d_pgva = b2pgva
7.02 c                   if        b_mast = *off
7.02 c                   eval      d_pr01 = p_prgr
7.02 c                   else
7.01 c                   eval      d_pr01 = b2pr01
7.02 c                   endif
7.01 c                   eval      d_pr02 = b2pr02
7.01 c                   eval      d_pr03 = b2pr03
7.01 c                   eval      d_pr04 = b2pr04
7.01 c                   eval      d_pr05 = b2pr05
7.01 c                   eval      d_pr06 = b2pr06
7.01 c                   eval      d_pr07 = b2pr07
7.01 c                   eval      d_pr08 = b2pr08
7.01 c                   eval      d_pr09 = b2pr09
7.01 c                   eval      d_pr10 = b2pr10
7.01 c                   eval      d_pr11 = b2pr11
7.01 c                   eval      d_pr12 = b2pr12
7.01 c                   eval      d_pr13 = b2pr13
7.01 c                   eval      d_pr14 = b2pr14
7.01 c                   eval      d_pr15 = b2pr15
7.01 c                   eval      d_pr16 = b2pr16
7.01 c                   eval      d_pr17 = b2pr17
7.01 c                   eval      d_pr18 = b2pr18
7.01 c                   eval      d_pr19 = b2pr19
7.01 c                   eval      d_pr20 = b2pr20
7.01  *
      *
     c                   call      'JM620C'
     c                   parm                    d_list
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_kamp
7.02 c                   parm                    p_prgr
7.01  *
7.01  * Key for prisgrupper
7.01  *
7.01 c     ra30l1_key    klist
7.01 c                   kfld                    w_firm
7.01 c                   kfld                    ra30l1_dkod
7.01  *
7.01  * Key for oppslag på bruker
7.01  *
7.01 c     fusrl1_key    klist
7.01 c                   kfld                    w_firm
7.01 c                   kfld                    fusrl1_user
      *
      * Flytter inngående parametre til utgående.
      *
7.01 c                   eval      d_list = *blank
     c                   eval      d_firm = p_firm
7.01 c                   eval      w_firm = p_firm
     c                   eval      d_kamp = p_kamp
7.01  *
7.01  * Henter opplysninger fra ofak bruker
7.01  *
7.01 c                   eval      fusrl1_user = l_user
7.01 c     fusrl1_key    chain     fusrl1
7.01 c                   if        fbko19 = 1
7.01 c                   eval      b_mast = *on
7.01 c                   endif
7.01  *
      *
      * Initiering av skjermfelter
      *
     c                   eval      b1valg = 0
      *
     c                   endsr
