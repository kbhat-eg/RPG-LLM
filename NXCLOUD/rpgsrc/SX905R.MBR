     H/TITLE  ASLAGR: Vedlikehold av betingelser for omregning
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASSTAT
      * Program . . . . : SX905R
      * Beskrivelse . . : Vedlikehold av logg/status overføring Cobuilder
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       190618 bsa  Nytt program
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fscobl1    if   e           k disk    rename(scobpfr:scobl1r)
     fscoblu    uf a e           k disk    rename(scobpfr:scoblur)
      *
     fsx905d    cf   e             workstn
      *
      * Definering av Local data area
      *
     d                UDS
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av variable
      *
     d w_firm          s                   like(scfirm)
     d w_dato          s                   like(scodat)
     d w_inkl          s              1  0
      *
      * Definering av variable i nøkler
      *
      *
      * Parametre
      *
     d p_stat          s              1
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * A1BLD Behandle bildet for valg
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     a1taga        tag
      *
      * Hent opplysninger fra statusregisteret
      *
     c     scobl1_key    chain     scobl1
     c                   if        %found
     c                   eval      a1stat = scstat
     c                   eval      a1mai1 = scmai1
     c                   eval      a1mai2 = scmai2
     c                   eval      a1mai3 = scmai3
     c                   eval      a1subj = scsubj
     c                   eval      a1txt1 = sctxt1
     c                   eval      a1txt2 = sctxt2
     c                   eval      a1txt3 = sctxt3
     c                   eval      a1send = scsend
      *
     c                   eval      a1kdat = sckdat
     c                   eval      a1udat = scudat
     c                   eval      a1utid = scutid
     c                   else
     c                   eval      a1stat = 0
     c                   eval      a1mai1 = *blanks
     c                   eval      a1mai2 = *blanks
     c                   eval      a1mai3 = *blanks
     c                   eval      a1subj = *blanks
     c                   eval      a1txt1 = *blanks
     c                   eval      a1txt2 = *blanks
     c                   eval      a1txt3 = *blanks
     c                   eval      a1send = *blanks
      *
     c                   eval      a1kdat = *loval
     c                   eval      a1udat = *loval
     c                   eval      a1utid = *loval
     c                   endif
      *
      * Vis bilde
      *
     c     a1tag1        tag
      *
     c                   exfmt     a1bld
      *
      * F3=Avslutt
      *
     c                   if        *inkc = *on or
     c                             *inkl = *on
     c                   goto      xslutt
     c                   endif
      *
      * F6=Start utskrift
      *
     c                   if        *inkf  = *on
     c                   exsr      xb6win
     c                   goto      a1tag1
     c                   endif
      *
      * Kontroller at status er riktig
      *
     c                   if        a1stat <> 0 and
     c                             a1stat <> 1
     c                   eval      *in32 = *on
     c                   goto      a1tag1
     c                   endif
      *
      * Sjekk mailadresse
      *
     c                   if        a1mai1 = *blanks
     c                   eval      *in30 = *on
     c                   goto      a1tag1
     c                   endif
      *
      * Oppdaterer status-registeret
      *
     c     scoblu_key    chain     scoblur
      *
     c                   eval      scstat = a1stat
     c                   eval      scmai1 = a1mai1
     c                   eval      scmai2 = a1mai2
     c                   eval      scmai3 = a1mai3
     c                   eval      scsubj = a1subj
     c                   eval      sctxt1 = a1txt1
     c                   eval      sctxt2 = a1txt2
     c                   eval      sctxt3 = a1txt3
     c                   eval      scsend = a1send
      *
     c                   if        %found
     c                   time                    scedat
     c                   time                    scetim
     c                   eval      sceusr = l_user
     c                   update    scoblur
     c                   else
     c                   eval      scfirm = w_firm
     c                   time                    scodat
     c                   time                    scotim
     c                   eval      scousr = l_user
     c                   time                    scedat
     c                   time                    scetim
     c                   eval      sceusr = l_user
     C                   write     scoblur
     C                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for sletting av oppdaterte og/eller slettemarkerte mld.
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xb6win        begsr
      *
     c                   eval      b1kdat = 0
      *
     c     xb6ut         tag
     c                   exfmt     f6win
      *
     c                   if        *inkc or *inkl
     c                   goto      end_xb6win
     c                   endif
      *
     c     *dmy          test(d)                 b1kdat                 31
     c                   if        *in31 = *on
     c                   goto      xb6ut
     c                   endif
      *
     c     *dmy          move      b1kdat        w_dato
     c                   eval      w_inkl = b1allv
      *
     c                   call      'SX903R'
     c                   parm                    w_dato
     c                   parm                    w_inkl
      *
     c     end_xb6win    endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for oppslag på status-registeret
      *
     c     scobl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for oppslag på status-registeret
      *
     c     scoblu_key    klist
     c                   kfld                    w_firm
      *
      * Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
