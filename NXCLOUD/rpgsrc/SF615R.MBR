     /TITLE  Utskrift av dekningsbidragsstatistikk
     H datedit(*dmy.)
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                 *
     *  System. . . . . : ASSTAT                                       *
     *  Program . . . . : SF615R                                       *
     *  Beskrivelse . . : Utskrift av dekningsbidragsstatistikk        *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                 *
     *  Spesialversjon. :                                              *
     *  Tilpasset for . :                                              *
     *                                                                 *
     *  Referanse  Dato   Endringsbeskrivelse                     Sign.*
     *  --------- ------  ---------------------------------------------*
      *  V5.30     080304  Henting av navn kundekategori var feil       *
      *  V5.30     080304  Henting av navn rabattkategori var feil      *
      *  V5.30     230604  Kundeprosjekttekst ble ikke hentet      KOB  *
      *  V5.30     200904  Fjernet rabattgruppe                    KOB  *
      *  V5.50     301006  Lagt inn selger i kasse                 KOB  *
     *                                                                 *
     *                                                                 *
     *                                                                 *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     Fskwwpf    ip   e           k disk
     Fskpml1    if   e           k disk
     Frkunl1    if   e           k disk
     Frlevl1    if   e           k disk
     Fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     Fvvasl1    if   e           k disk    rename(vvaspfr:vvasl1r)
     Fvahgl1    if   e           k disk
     Fvaugl1    if   e           k disk
     fvogrl1    if   e           k disk    rename(vogrpfr:vogrl1r)
     fvhgrl1    if   e           k disk    rename(vhgrpfr:vhgrl1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     Fvotyl1    if   e           k disk
     Fra06pf    if   e           k disk
     Fra07pf    if   e           k disk
     Fra08pf    if   e           k disk
     Fra09l1    if   e           k disk    rename(ra09pfr:ra09l1r)
     Fra10pf    if   e           k disk
     Fra11pf    if   e           k disk
     Fra12pf    if   e           k disk
     fskbul1    if   e           k disk    rename(skbupfr:skbul1r)
     Ffkprl1    if   e           k disk
     Fvltpl1    if   e           k disk
     Fsf615p    o    e             printer oflind(*in30)
     *
     /SPACE 3
     *
     ************************** T A B E L L E R *************************
     *
     D sal             s              9  0 dim(12)
     D rt              s             25    dim(60) ctdata perrcd(1)             Rapport-tekster
     *
     ******************* DATA STRUKTURER ********************************
      *
     D wwrest          ds           330
     D wwtext                        30
     D wwsrt1                         2  0
     D wwsrt2                         2  0
     D wwsrt3                         2  0
     D wwsps1                         1a
     D wwsps2                         1a
     D wwsps3                         1a
     D wwsps4                         1a
     D wwsps5                         1a
     D wwsps6                         1a
     D wwpmnd                         2  0
     D wwpaar                         4  0
     D wwsmli                         1a
     D wwsps7                         1a
     D wwsss1                         1a
     D wwsss2                         1a
     D wwsss3                         1a
     D wwslet                         1a
     *
     D                 ds
     D beg                           15
     D  k6                            6  0 overlay(beg)
     D   k5                           5  0 overlay(k6)
     D    k4                          4  0 overlay(k6)
     D     k3                         3  0 overlay(k6)
     D      k2                        2  0 overlay(k3)
     D       k2a                      2    overlay(k2)
     *
     D                 ds
     D wwxgrp                         7  0
     D  wwxogr                        2  0 overlay(wwxgrp:1)
     D  wwxhgr                        2  0 overlay(wwxgrp:3)
     D  wwxugr                        3  0 overlay(wwxgrp:5)
     *
     D                uds
     D lcwsid                901    910
     D lcuser                911    920
     D lcfirm                944    946  0
     D lcnavn                951    980
     *
     ******************* FELT DEFINERING ********************************
     *
     D retur           s              6
     D rp1             s              2  0
     D rp2             s              2  0
     D rp3             s              2  0
     *
     *  Betydning av feltnavn:
     *  1. pos:                         3. pos:
     *   a = antall                      p = denne periode
     *   b = beløp                       i = hittil
     *   d = dekningsgrad
     *
     *  2. pos:                         4. pos:
     *   b = brutto                      f = i fjor
     *   r = rabatt                      i = i år
     *   n = netto
     *   k = kost                       5. pos:
     *   d = dekningsbidrag              4 = sorteringsbegrep 3
     *   g = dekningsgrad                5 = sorteringsbegrep 2
     *   s = antall                      6 = sorteringsbegrep 1
     *                                   7 = firmatotal
     *                                   u = utskriftsfelt
     *
     *                                     Antall hittil i fjor
     D asifu           s              9  0
     D asif4           s             13  3
     D asif5           s             13  3
     D asif6           s             13  3
     D asif7           s             13  3
     *                                     Antall hittil i år
     D asiiu           s              9  0
     D asii4           s             13  3
     D asii5           s             13  3
     D asii6           s             13  3
     D asii7           s             13  3
     *                                     Antall d.p. i fjor
     D aspfu           s              9  0
     D aspf4           s             13  3
     D aspf5           s             13  3
     D aspf6           s             13  3
     D aspf7           s             13  3
     *                                     Antall d.p. i år
     D aspiu           s              9  0
     D aspi4           s             13  3
     D aspi5           s             13  3
     D aspi6           s             13  3
     D aspi7           s             13  3
     *                                     Brutto hittil i fjor
     D bbifu           s             11  0
     D bbif4           s             13  2
     D bbif5           s             13  2
     D bbif6           s             13  2
     D bbif7           s             13  2
     *                                     Brutto d.p. i fjor
     D bbpfu           s             11  0
     D bbpf4           s             13  2
     D bbpf5           s             13  2
     D bbpf6           s             13  2
     D bbpf7           s             13  2
     *                                     Brutto hittil i år
     D bbiiu           s             11  0
     D bbii4           s             13  2
     D bbii5           s             13  2
     D bbii6           s             13  2
     D bbii7           s             13  2
     *                                     Brutto d.p. i år
     D bbpiu           s             11  0
     D bbpi4           s             13  2
     D bbpi5           s             13  2
     D bbpi6           s             13  2
     D bbpi7           s             13  2
     *                                     Rabatt hittil i fjor
     D brifu           s             11  0
     D brif4           s             13  2
     D brif5           s             13  2
     D brif6           s             13  2
     D brif7           s             13  2
     *                                     Rabatt d.p. i fjor
     D brpfu           s             11  0
     D brpf4           s             13  2
     D brpf5           s             13  2
     D brpf6           s             13  2
     D brpf7           s             13  2
     *                                     Rabatt hittil i år
     D briiu           s             11  0
     D brii4           s             13  2
     D brii5           s             13  2
     D brii6           s             13  2
     D brii7           s             13  2
     *                                     Rabatt d.p. i år
     D brpiu           s             11  0
     D brpi4           s             13  2
     D brpi5           s             13  2
     D brpi6           s             13  2
     D brpi7           s             13  2
     *                                     Netto hittil i fjor
     D bnifu           s             11  0
     D bnif4           s             13  2
     D bnif5           s             13  2
     D bnif6           s             13  2
     D bnif7           s             13  2
     *                                     Netto d.p. i fjor
     D bnpfu           s             11  0
     D bnpf4           s             13  2
     D bnpf5           s             13  2
     D bnpf6           s             13  2
     D bnpf7           s             13  2
     *                                     Netto hittil i år
     D bniiu           s             11  0
     D bnii4           s             13  2
     D bnii5           s             13  2
     D bnii6           s             13  2
     D bnii7           s             13  2
     *                                     Netto d.p. i år
     D bnpiu           s             11  0
     D bnpi4           s             13  2
     D bnpi5           s             13  2
     D bnpi6           s             13  2
     D bnpi7           s             13  2
     *                                     Kost hittil i fjor
     D bkifu           s             11  0
     D bkif4           s             13  2
     D bkif5           s             13  2
     D bkif6           s             13  2
     D bkif7           s             13  2
     *                                     Kost d.p. i fjor
     D bkpfu           s             11  0
     D bkpf4           s             13  2
     D bkpf5           s             13  2
     D bkpf6           s             13  2
     D bkpf7           s             13  2
     *                                     Kost hittil i år
     D bkiiu           s             11  0
     D bkii4           s             13  2
     D bkii5           s             13  2
     D bkii6           s             13  2
     D bkii7           s             13  2
     *                                     Kost d.p. i år
     D bkpiu           s             11  0
     D bkpi4           s             13  2
     D bkpi5           s             13  2
     D bkpi6           s             13  2
     D bkpi7           s             13  2
     *                                     DB hittil i fjor
     D bdifu           s             11  0
     D bdif4           s             13  2
     D bdif5           s             13  2
     D bdif6           s             13  2
     D bdif7           s             13  2
     *                                     DB d.p. i fjor
     D bdpfu           s             11  0
     D bdpf4           s             13  2
     D bdpf5           s             13  2
     D bdpf6           s             13  2
     D bdpf7           s             13  2
     *                                     DB hittil i år
     D bdiiu           s             11  0
     D bdii4           s             13  2
     D bdii5           s             13  2
     D bdii6           s             13  2
     D bdii7           s             13  2
     *                                     DB d.p. i år
     D bdpiu           s             11  0
     D bdpi4           s             13  2
     D bdpi5           s             13  2
     D bdpi6           s             13  2
     D bdpi7           s             13  2
     *
     * Beregnede verdier
     *                                     Avvik i antall hittil i %
     D aaifu           s              7  1
     *                                     Avvik i antall d.p. i %
     D aapfu           s              7  1
     *                                     Avvik i % hittil i år
     D baifu           s              7  1
     *                                     Avvik i % d.p. ifjor
     D bapfu           s              7  1
     *                                     Gj.sn. hittil i år
     D gsiiu           s              9  2
     *                                     Gj.sn. d.p. i år
     D gspiu           s              9  2
     *                                     Gj.sn. hittil i fjor
     D gsifu           s              9  2
     *                                     Gj.sn. d.p. i fjor
     D gspfu           s              9  2
     *                                     Dekningsgrad hittil i år
     D dgiiu           s              5  2
     *                                     Dekningsgrad d.p. i år
     D dgpiu           s              5  2
     *                                     Dekningsgrad hittil i fjor
     D dgifu           s              5  2
     *                                     Dekningsgrad d.p. i fjor
     D dgpfu           s              5  2
     *
     *
     D wwdif           s             13  2
     D wwrab           s             13  2
     D wwnet           s             13  2
     D wwbid           s             13  2
     *
     D i               s              2  0
     D rap             s              2  0
     *
     D textl6          s             30
     D textl5          s             30
     D textl4          s             30
     D rptek           s             30
     D rpte1           s              8
     D rpte2           s              8
     D rpte3           s             12
     D utime           s              6  0
     *
     D wwhhaa          s                   like(sbhhaa)
     D wwvers          s                   like(sbvers)
     D wwkode          s                   like(sbkode)
     D wwaabb          s                   like(sbaabb)
     *
     D wwfirm          s                   like(lcfirm)
     D wwfkod          s                   like(rafkod)
     D wwgkod          s                   like(ragkod)
     D wwhkod          s                   like(rahkod)
     D wwikod          s                   like(raikod)
     D wwjkod          s                   like(rajkod)
     D wwkkod          s                   like(rakkod)
     D wwkund          s                   like(rkkund)
     D wwlevr          s                   like(rllevr)
     D wwlkod          s                   like(ralkod)
     D wwotyp          s                   like(vaotyp)
     D wwoogr          s                   like(vgoogr)
     D wwhogr          s                   like(vghogr)
     D wwhhgr          s                   like(vghhgr)
     D wwuogr          s                   like(vguogr)
     D wwuhgr          s                   like(vguhgr)
     D wwuugr          s                   like(vguugr)
     D wwvare          s                   like(vvvare)
     D wwkpro          s                   like(flkpro)
     D wwlety          s                   like(vylety)
     *
     /EJECT
     *********************** I N P U T  S E C T I O N *******************
     *
     *
     Iskwwpfr       01
     I                                          sffirm        L7
     I                                          swsrt1        L6
     I                                          swsrt2        L5
     I                                          swsrt3        L4
     *
     Iskbul1r
     I              sbbu01                      sal(1)
     I              sbbu02                      sal(2)
     I              sbbu03                      sal(3)
     I              sbbu04                      sal(4)
     I              sbbu05                      sal(5)
     I              sbbu06                      sal(6)
     I              sbbu07                      sal(7)
     I              sbbu08                      sal(8)
     I              sbbu09                      sal(9)
     I              sbbu10                      sal(10)
     I              sbbu11                      sal(11)
     I              sbbu12                      sal(12)
     *
     /EJECT
     ***************************  CALCULATION  **************************
     *
     * Brudd på L6 (SRT1)
     *
B001 C   L6              do
 001 C                   eval      bbpi6 = 0
 001 C                   eval      bbii6 = 0
 001 C                   eval      bbpf6 = 0
 001 C                   eval      bbif6 = 0
 001 C                   eval      brpi6 = 0
 001 C                   eval      brii6 = 0
 001 C                   eval      brpf6 = 0
 001 C                   eval      brif6 = 0
 001 C                   eval      aspi6 = 0
 001 C                   eval      asii6 = 0
 001 C                   eval      aspf6 = 0
 001 C                   eval      asif6 = 0
 001 C                   eval      bnii6 = 0
 001 C                   eval      bnpi6 = 0
 001 C                   eval      bnif6 = 0
 001 C                   eval      bnpf6 = 0
 001 C                   eval      bkii6 = 0
 001 C                   eval      bkpi6 = 0
 001 C                   eval      bkif6 = 0
 001 C                   eval      bkpf6 = 0
 001 C                   eval      bdii6 = 0
 001 C                   eval      bdpi6 = 0
 001 C                   eval      bdif6 = 0
 001 C                   eval      bdpf6 = 0
 001 *
 001 C                   eval      textl6 = *blank
 001 C                   move      swsrt1        beg
 001 C                   eval      rap = rp1
 001 C                   exsr      raprut
 001 C                   movel     rptek         textl6
 001 *
E001 C                   enddo
     /EJECT
     *
     * Brudd på L5 (SRT2)
     *
B001 C   L5              do
 001 C                   eval      bbpi5 = 0
 001 C                   eval      bbii5 = 0
 001 C                   eval      bbpf5 = 0
 001 C                   eval      bbif5 = 0
 001 C                   eval      brpi5 = 0
 001 C                   eval      brii5 = 0
 001 C                   eval      brpf5 = 0
 001 C                   eval      brif5 = 0
 001 C                   eval      aspi5 = 0
 001 C                   eval      asii5 = 0
 001 C                   eval      aspf5 = 0
 001 C                   eval      asif5 = 0
 001 C                   eval      bnii5 = 0
 001 C                   eval      bnpi5 = 0
 001 C                   eval      bnif5 = 0
 001 C                   eval      bnpf5 = 0
 001 C                   eval      bkii5 = 0
 001 C                   eval      bkpi5 = 0
 001 C                   eval      bkif5 = 0
 001 C                   eval      bkpf5 = 0
 001 C                   eval      bdii5 = 0
 001 C                   eval      bdpi5 = 0
 001 C                   eval      bdif5 = 0
 001 C                   eval      bdpf5 = 0
 001 *
 001 C                   eval      textl5 = *blank
 001 *
B002 C                   if        rp2 <> *zeros
 002 C                   move      swsrt2        beg
 002 C                   eval      rap = rp2
 002 C                   exsr      raprut
 002 C                   movel     rptek         textl5
E002 C                   endif
 001 *
E001 C                   enddo
     /EJECT
     *
     * Brudd på L4 (SRT3)
     *
B001 C   L4              do
 001 C                   eval      bbpi4 = 0
 001 C                   eval      bbii4 = 0
 001 C                   eval      bbpf4 = 0
 001 C                   eval      bbif4 = 0
 001 C                   eval      brpi4 = 0
 001 C                   eval      brii4 = 0
 001 C                   eval      brpf4 = 0
 001 C                   eval      brif4 = 0
 001 C                   eval      aspi4 = 0
 001 C                   eval      asii4 = 0
 001 C                   eval      aspf4 = 0
 001 C                   eval      asif4 = 0
 001 C                   eval      bnii4 = 0
 001 C                   eval      bnpi4 = 0
 001 C                   eval      bnif4 = 0
 001 C                   eval      bnpf4 = 0
 001 C                   eval      bkii4 = 0
 001 C                   eval      bkpi4 = 0
 001 C                   eval      bkif4 = 0
 001 C                   eval      bkpf4 = 0
 001 C                   eval      bdii4 = 0
 001 C                   eval      bdpi4 = 0
 001 C                   eval      bdif4 = 0
 001 C                   eval      bdpf4 = 0
 001 *
 001 C                   eval      textl4 = *blank
 001 *
B002 C                   if        rp3 <> *zeros
 002 C                   move      swsrt3        beg
 002 C                   eval      rap = rp3
 002 C                   exsr      raprut
 002 C                   movel     rptek         textl4
E002 C                   endif
 001 *
E001 C                   enddo
     /EJECT
     *
     * Summering av enkeltposter
     *
     * Sammenligning mot budsjett
     *
B001 C                   if        *in41 = *on
 001 C                             and sfpaar < wwpaar
 001 C                   goto      xslutt
E001 C                   endif
     *
     * Sammenlign mot i fjor
     *
B001 C                   if        *in42 = *on
     *
B001 C                   if        sfpaar < wwpaar - 1
 001 C                   goto      xslutt
E001 C                   endif
     *
B001 C                   if        sfpaar = wwpaar - 1
 001 C                   goto      ifjor
E001 C                   endif
     *
E001 C                   endif
     *
 001 C                   eval      wwrab = sfrab1 + sfrab2 + sfrabo             rabatt
 001 C                   eval      wwnet = sfsumb - wwrab                       netto
 001 C                   eval      wwbid = wwnet - sfsumk                       dekningsbidrag
     *
     C     iÅr           tag
     *
     * Summer til hittil i år
     *
B001 C                   if        sfpmnd <= wwpmnd
 001 C                   eval      asii4 = asii4  + sfanta                      antall
 001 C                   eval      bbii4 = bbii4  + sfsumb                      brutto
 001 C                   eval      brii4 = brii4  + wwrab                       rabatt
 001 C                   eval      bnii4 = bnii4  + wwnet                       netto
 001 C                   eval      bkii4 = bkii4  + sfsumk                      kost
 001 C                   eval      bdii4 = bdii4  + wwbid                       dekningsbidrag
E001 C                   endif
     *
     * Summer til denne periode i år
     *
B001 C                   if        sfpmnd = wwpmnd
 001 C                   eval      aspi4 = aspi4 + sfanta                       antall
 001 C                   eval      bbpi4 = bbpi4 + sfsumb                       brutto
 001 C                   eval      brpi4 = brpi4  + wwrab                       rabatt
 001 C                   eval      bnpi4 = bnpi4  + wwnet                       netto
 001 C                   eval      bkpi4 = bkpi4  + sfsumk                      kost
 001 C                   eval      bdpi4 = bdpi4  + wwbid                       dekningsbidrag
E001 C                   endif
     *
     C                   goto      xslutt
     *
     C     ifjor         tag
     *
 001 C                   eval      wwrab = sfrab1 + sfrab2 + sfrabo             rabatt
 001 C                   eval      wwnet = sfsumb - wwrab                       netto
 001 C                   eval      wwbid = wwnet - sfsumk                       dekningsbidrag
     *
     * Summer til hittil i fjor
     *
B001 C                   if        sfpmnd <= wwpmnd
 001 C                   eval      asif4 = asif4 + sfanta                       antall
 001 C                   eval      bbif4 = bbif4 + sfsumb                       brutto
 001 C                   eval      brif4 = brif4  + wwrab                       rabatt
 001 C                   eval      bnif4 = bnif4  + wwnet                       netto
 001 C                   eval      bkif4 = bkif4  + sfsumk                      kost
 001 C                   eval      bdif4 = bdif4  + wwbid                       dekningsbidrag
E001 C                   endif
     *
     * Summer til denne periode i fjor
     *
B001 C                   if        sfpmnd = wwpmnd
 001 C                   eval      aspf4 = aspf4 + sfanta                       antall
 001 C                   eval      bbpf4 = bbpf4 + sfsumb                       brutto
 001 C                   eval      brpf4 = brpf4  + wwrab                       rabatt
 001 C                   eval      bnpf4 = bnpf4  + wwnet                       netto
 001 C                   eval      bkpf4 = bkpf4  + sfsumk                      kost
 001 C                   eval      bdpf4 = bdpf4  + wwbid                       dekningsbidrag
E001 C                   endif
     *
     C     xslutt        tag
     *
     /EJECT
     *
     * Brudd på L4  (SRT1)
     *
     CL4                 exsr      L4brd
     CL4                 if        swsrt3 <> *blank
     C                             and wwsps3 = ' '
     CL4                 write     lin1                                 30
     CL4 73              move      *on           *in30
     CL4                 exsr      overflow
     CL4                 endif
     *
     * Brudd på L5  (SRT2)
     *
     CL5                 exsr      L5brd
     CL5                 if        swsrt2 <> *blank
     C                             and wwsps2 = ' '
     CL5                 write     lin1                                 30
     CL5 72              move      *on           *in30
     CL5                 exsr      overflow
     CL5                 endif
     *
     * Brudd på L6  (SRT3)
     *
     CL6                 exsr      L6brd
     CL6                 if        swsrt1 <> *blank
     C                             and wwsps1 = ' '
     CL6                 write     lin1                                 30
     CL6 71              move      *on           *in30
     CL6                 exsr      overflow
     *
     CL6                 write     und1                                 30
     CL6 71              move      *on           *in30
     CL6                 exsr      overflow
     CL6                 endif
     *
     * Brudd på L7  (FIRMA)
     *
     CL7                 exsr      L7brd
     CL7                 if        wwsps4 = ' '
     CL7                 write     lin1                                 30
     CL7                 exsr      overflow
     CL7                 endif
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for behandling av brudd på L4 (SRT3)                  *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     L4brd         begsr
     *
     * Summer til neste nivå
     *
     C                   eval      aspi5 = aspi5 + aspi4                        Antall d.p. i år
     C                   eval      asii5 = asii5 + asii4                        Antall hittil i år
     C                   eval      aspf5 = aspf5 + aspf4                        Antall d.p. i fjor
     C                   eval      asif5 = asif5 + asif4                        Antall hittil i fjor
     C                   eval      bbif5 = bbif5 + bbif4                        Brutto hittil i fjor
     C                   eval      bbpf5 = bbpf5 + bbpf4                        Brutto d.p. i fjor
     C                   eval      bbii5 = bbii5 + bbii4                        Brutto hittil i år
     C                   eval      bbpi5 = bbpi5 + bbpi4                        Brutto d.p. i år
     C                   eval      brif5 = brif5 + brif4                        Rabatt hittil i fjor
     C                   eval      brpf5 = brpf5 + brpf4                        Rabatt d.p. i fjor
     C                   eval      brii5 = brii5 + brii4                        Rabatt hittil i år
     C                   eval      brpi5 = brpi5 + brpi4                        Rabatt d.p. i år
     C                   eval      bnif5 = bnif5 + bnif4                        Netto hittil i fjor
     C                   eval      bnpi5 = bnpi5 + bnpi4                        Netto d.p. i fjor
     C                   eval      bnii5 = bnii5 + bnii4                        Netto hittil i år
     C                   eval      bnpf5 = bnpf5 + bnpf4                        Netto d.p. i år
     C                   eval      bkif5 = bkif5 + bkif4                        Kost hittil i fjor
     C                   eval      bkpi5 = bkpi5 + bkpi4                        Kost d.p. i fjor
     C                   eval      bkii5 = bkii5 + bkii4                        Kost hittil i år
     C                   eval      bkpf5 = bkpf5 + bkpf4                        Kost d.p. i år
     C                   eval      bdif5 = bdif5 + bdif4                        DB hittil i fjor
     C                   eval      bdpi5 = bdpi5 + bdpi4                        DB d.p. i fjor
     C                   eval      bdii5 = bdii5 + bdii4                        DB hittil i år
     C                   eval      bdpf5 = bdpf5 + bdpf4                        DB d.p. i år
     *
     *  Flytt til utskriftsfelt
     *
B001 C                   if        *in64 = *on
 001 C                   movel     swsrt3        vareu
 001 C                   movel     textl4        textu
     *
 001 C                   eval(h)   bniiu = bnii4                                Netto
 001 C                   eval(h)   bnifu = bnif4                                Netto ifjor
 001 C                   eval(h)   bkiiu = bkii4                                Kost
 001 C                   eval(h)   bdiiu = bdii4                                DB
 001 C                   eval(h)   bdifu = bdif4                                DB ifjor
     *
 001 C                   eval(h)   bnpiu = bnpi4                                Netto
 001 C                   eval(h)   bnpfu = bnpf4                                Netto ifjor
 001 C                   eval(h)   bkpiu = bkpi4                                Kost
 001 C                   eval(h)   bdpiu = bdpi4                                DB
 001 C                   eval(h)   bdpfu = bdpf4                                DB ifjor
     *
     C                   exsr      beregn
     *
E001 C                   endif
     *
     C                   endsr
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for behandling av brudd på L5 (SRT2)                  *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     L5brd         begsr
     *
     * Summer til neste nivå
     *
     C                   eval      aspi6 = aspi6 + aspi5                        Antall d.p. i år
     C                   eval      asii6 = asii6 + asii5                        Antall hittil i år
     C                   eval      aspf6 = aspf6 + aspf5                        Antall d.p. i fjor
     C                   eval      asif6 = asif6 + asif5                        Antall hittil i fjor
     C                   eval      bbif6 = bbif6 + bbif5                        Brutto hittil i fjor
     C                   eval      bbpf6 = bbpf6 + bbpf5                        Brutto d.p. i fjor
     C                   eval      bbii6 = bbii6 + bbii5                        Brutto hittil i år
     C                   eval      bbpi6 = bbpi6 + bbpi5                        Brutto d.p. i år
     C                   eval      brif6 = brif6 + brif5                        Rabatt hittil i fjor
     C                   eval      brpf6 = brpf6 + brpf5                        Rabatt d.p. i fjor
     C                   eval      brii6 = brii6 + brii5                        Rabatt hittil i år
     C                   eval      brpi6 = brpi6 + brpi5                        Rabatt d.p. i år
     C                   eval      bnif6 = bnif6 + bnif5                        Netto hittil i fjor
     C                   eval      bnpi6 = bnpi6 + bnpi5                        Netto d.p. i fjor
     C                   eval      bnii6 = bnii6 + bnii5                        Netto hittil i år
     C                   eval      bnpf6 = bnpf6 + bnpf5                        Netto d.p. i år
     C                   eval      bkif6 = bkif6 + bkif5                        Kost hittil i fjor
     C                   eval      bkpi6 = bkpi6 + bkpi5                        Kost d.p. i fjor
     C                   eval      bkii6 = bkii6 + bkii5                        Kost hittil i år
     C                   eval      bkpf6 = bkpf6 + bkpf5                        Kost d.p. i år
     C                   eval      bdif6 = bdif6 + bdif5                        DB hittil i fjor
     C                   eval      bdpi6 = bdpi6 + bdpi5                        DB d.p. i fjor
     C                   eval      bdii6 = bdii6 + bdii5                        DB hittil i år
     C                   eval      bdpf6 = bdpf6 + bdpf5                        DB d.p. i år
     *
     *  Flytt til utskriftsfelt
     *
B001 C                   if        *in65 = *on
 001 C                   movel     swsrt2        vareu
 002 C                   movel     textl5        textu
     *
 001 C                   eval(h)   bniiu = bnii5                                Netto
 001 C                   eval(h)   bnifu = bnif5                                Netto ifjor
 001 C                   eval(h)   bkiiu = bkii5                                Kost
 001 C                   eval(h)   bdiiu = bdii5                                DB
 001 C                   eval(h)   bdifu = bdif5                                DB ifjor
     *
 001 C                   eval(h)   bnpiu = bnpi5                                Netto
 001 C                   eval(h)   bnpfu = bnpf5                                Netto ifjor
 001 C                   eval(h)   bkpiu = bkpi5                                Kost
 001 C                   eval(h)   bdpiu = bdpi5                                DB
 001 C                   eval(h)   bdpfu = bdpf5                                DB ifjor
     *
     C                   exsr      beregn
     *
E001 C                   endif
     *
     C                   endsr
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for behandling av brudd på L6 (SRT1)                  *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     L6brd         begsr
     *
     * Summer til neste nivå
     *
     C                   eval      aspi7 = aspi7 + aspi6                        Antall d.p. i år
     C                   eval      asii7 = asii7 + asii6                        Antall hittil i år
     C                   eval      aspf7 = aspf7 + aspf6                        Antall d.p. i fjor
     C                   eval      asif7 = asif7 + asif6                        Antall hittil i fjor
     C                   eval      bbif7 = bbif7 + bbif6                        Brutto hittil i fjor
     C                   eval      bbpf7 = bbpf7 + bbpf6                        Brutto d.p. i fjor
     C                   eval      bbii7 = bbii7 + bbii6                        Brutto hittil i år
     C                   eval      bbpi7 = bbpi7 + bbpi6                        Brutto d.p. i år
     C                   eval      brif7 = brif7 + brif6                        Rabatt hittil i fjor
     C                   eval      brpf7 = brpf7 + brpf6                        Rabatt d.p. i fjor
     C                   eval      brii7 = brii7 + brii6                        Rabatt hittil i år
     C                   eval      brpi7 = brpi7 + brpi6                        Rabatt d.p. i år
     C                   eval      bnif7 = bnif7 + bnif6                        Netto hittil i fjor
     C                   eval      bnpi7 = bnpi7 + bnpi6                        Netto d.p. i fjor
     C                   eval      bnii7 = bnii7 + bnii6                        Netto hittil i år
     C                   eval      bnpf7 = bnpf7 + bnpf6                        Netto d.p. i år
     C                   eval      bkif7 = bkif7 + bkif6                        Kost hittil i fjor
     C                   eval      bkpi7 = bkpi7 + bkpi6                        Kost d.p. i fjor
     C                   eval      bkii7 = bkii7 + bkii6                        Kost hittil i år
     C                   eval      bkpf7 = bkpf7 + bkpf6                        Kost d.p. i år
     C                   eval      bdif7 = bdif7 + bdif6                        DB hittil i fjor
     C                   eval      bdpi7 = bdpi7 + bdpi6                        DB d.p. i fjor
     C                   eval      bdii7 = bdii7 + bdii6                        DB hittil i år
     C                   eval      bdpf7 = bdpf7 + bdpf6                        DB d.p. i år
     *
     *  Flytt til utskriftsfelt
     *
B001 C                   if        *in66 = *on
 001 C                   movel     swsrt1        vareu
 002 C                   movel     textl6        textu
     *
 001 C                   eval(h)   bniiu = bnii6                                Netto
 001 C                   eval(h)   bnifu = bnif6                                Netto ifjor
 001 C                   eval(h)   bkiiu = bkii6                                Kost
 001 C                   eval(h)   bdiiu = bdii6                                DB
 001 C                   eval(h)   bdifu = bdif6                                DB ifjor
     *
 001 C                   eval(h)   bnpiu = bnpi6                                Netto
 001 C                   eval(h)   bnpfu = bnpf6                                Netto ifjor
 001 C                   eval(h)   bkpiu = bkpi6                                Kost
 001 C                   eval(h)   bdpiu = bdpi6                                DB
 001 C                   eval(h)   bdpfu = bdpf6                                DB ifjor
     *
 001 C                   exsr      beregn
     *
E001 C                   endif
     *
     C                   endsr
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for behandling av brudd på L7 (FIRMA)                 *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     L7brd         begsr
     *
     *  Flytt til utskriftsfelt
     *
B001 C                   if        *in67 = *on
 002 C                   movel     lcfirm        vareu
 002 C                   movel     lcnavn        textu
     *
 001 C                   eval(h)   bniiu = bnii7                                Netto
 001 C                   eval(h)   bnifu = bnif7                                Netto ifjor
 001 C                   eval(h)   bkiiu = bkii7                                Kost
 001 C                   eval(h)   bdiiu = bdii7                                DB
 001 C                   eval(h)   bdifu = bdif7                                DB ifjor
     *
 001 C                   eval(h)   bnpiu = bnpi7                                Netto
 001 C                   eval(h)   bnpfu = bnpf7                                Netto ifjor
 001 C                   eval(h)   bkpiu = bkpi7                                Kost
 001 C                   eval(h)   bdpiu = bdpi7                                DB
 001 C                   eval(h)   bdpfu = bdpf7                                DB ifjor
     *
     C                   exsr      beregn
     *
E001 C                   endif
     *
     C                   endsr
     *
     /SPACE 3
     *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for behandling av overflow                            *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     C     overflow      begsr
     *
     C                   if        *in30 = *on
     C                   write     HD1A
     C                   endif
     *
     C                   endsr
     *
     /EJECT
     *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for beregning                                         *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     C     beregn        begsr
     *
     C                   eval      aaifu = *zeros                               Brutto
     C                   eval      aapfu = *zeros                               Brutto
     C                   eval      baifu = *zeros                               Brutto
     C                   eval      bapfu = *zeros                               Brutto
     C                   eval      gsiiu = *zeros                               Brutto
     C                   eval      gspiu = *zeros                               Brutto
     C                   eval      gsifu = *zeros                               Brutto
     C                   eval      gspfu = *zeros                               Brutto
     C                   eval      dgiiu = *zeros                               Brutto
     C                   eval      dgpiu = *zeros                               Brutto
     C                   eval      dgifu = *zeros                               Brutto
     C                   eval      dgpfu = *zeros                               Brutto
     *
     * Beregn gjsn. pris hittil i år
     *
B001 C                   if        asiiu <> *zero
 001 C                   eval(h)   gsiiu = bniiu / asiiu
E001 C                   endif
     *
     * Beregn gjsn. pris d.p. i år
     *
B001 C                   if        aspiu <> *zero
 001 C                   eval(h)   gspiu = bnpiu / aspiu
E001 C                   endif
     *
     * Beregn gjsn. pris hittil i fjor
     *
B001 C                   if        asifu <> *zero
 001 C                   eval(h)   gsifu = bnifu / asifu
E001 C                   endif
     *
     * Beregn gjsn. pris d.p. i fjor
     *
B001 C                   if        aspfu <> *zero
 001 C                   eval(h)   gspfu = bnpfu / aspfu
E001 C                   endif
     *
     * Beregn avvik i % - hittil (beløp)
     *
B001 C                   if        bnifu <> *zero
 001 C                   eval(h)   baifu = (bniiu - bnifu) * 100 / bnifu
E001 C                   endif
     *
     * Beregn avvik i % - d.p. (beløp)
     *
B001 C                   if        bnpfu <> *zero
 001 C                   eval(h)   bapfu = (bnpiu - bnpfu) * 100 / bnpfu
E001 C                   endif
     *
     * Beregn avvik i % - hittil (antall)
     *
B001 C                   if        asifu <> *zero
 001 C                   eval(h)   aaifu = (asiiu - asifu) * 100 / asifu
E001 C                   endif
     *
     * Beregn avvik i % - d.p. (antall)
     *
B001 C                   if        aspfu <> *zero
 001 C                   eval(h)   aapfu = (aspiu - aspfu) * 100 / aspfu
E001 C                   endif
     *
     * Beregn dekningsgrad - hittil i år
     *
B001 C                   if        bniiu <> *zero
     c                   select
 001 C                   when      (bdiiu * 100 / bniiu) < -999,99
     c                   eval      dgiiu = -999,99
 001 C                   when      (bdiiu * 100 / bniiu) > 999,99
     c                   eval      dgiiu = 999,99
     c                   other
 001 C                   eval(h)   dgiiu = bdiiu * 100 / bniiu
     c                   endsl
E001 C                   endif
     *
     * Beregn dekningsgrad - d.p. i år
     *
B001 C                   if        bnpiu <> *zero
     c                   select
 001 C                   when      (bdpiu * 100 / bnpiu) < -999,99
     c                   eval      dgpiu = -999,99
 001 C                   when      (bdpiu * 100 / bnpiu) > 999,99
     c                   eval      dgpiu = 999,99
     c                   other
 001 C                   eval(h)   dgpiu = bdpiu * 100 / bnpiu
     c                   endsl
E001 C                   endif
     *
     * Beregn dekningsgrad - hittil i fjor
     *
B001 C                   if        bnifu <> *zero
     c                   select
 001 C                   when      (bdifu * 100 / bnifu) < -999,99
     c                   eval      dgifu = -999,99
 001 C                   when      (bdifu * 100 / bnifu) > 999,99
     c                   eval      dgifu = 999,99
     c                   other
 001 C                   eval(h)   dgifu = bdifu * 100 / bnifu
     c                   endsl
E001 C                   endif
     *
     * Beregn dekningsgrad - d.p. i fjor
     *
B001 C                   if        bnpfu <> *zero
     c                   select
 001 C                   when      (bdpfu * 100 / bnpfu) < -999,99
     c                   eval      dgpfu = -999,99
 001 C                   when      (bdpfu * 100 / bnpfu) > 999,99
     c                   eval      dgpfu = 999,99
     c                   other
 001 C                   eval(h)   dgpfu = bdpfu * 100 / bnpfu
     c                   endsl
E001 C                   endif
     *
     C                   endsr
     *
     /EJECT
     *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for behandling av rapport                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     raprut        begsr
     *
     C                   eval      rptek = *blank
     *
     * -----------------
     * Alt. hovedgruppe
     * -----------------
     *
B001 C                   if        rap = 11
 001 C                   move      k2            wwhhgr
 001 C     hgrkey        chain     vahgl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vfhtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * -----------------
     * Alt. undergruppe
     * ------------------
     *
B001 C                   if        rap = 12
 001 C                   movel     k5            wwuhgr
 001 C                   move      k5            wwuugr
 001 C     ugrkey        chain     vaugl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vfutxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ------------------
     * Overgruppe
     * ------------------
     *
B001 C                   if        rap = 14                                               .....
 001 C                   movel     beg           wwxgrp                                       .
 001 C                   eval      wwoogr = wwxogr                                            .
 001 C     vogrl1_key    chain     vogrl1                             50                      .
B002 C                   if        *in50 = *off
 002 C                   movel     vgotxt        rptek                                        .
E002 C                   endif
 001 C                   goto      endrut                                                     .
E001 C                   endif                                                            .....
     *
     * ------------------
     * Hovedgruppe
     * ------------------
     *
B001 C                   if        rap = 15                                               .....
 001 C                   movel     beg           wwxgrp                                       .
 001 C                   eval      wwhogr = wwxogr                                            .
 001 C                   eval      wwhhgr = wwxhgr                                            .
 001 C     vhgrl1_key    chain     vhgrl1                             50                      .
B002 C                   if        *in50 = *off
 002 C                   movel     vghtxt        rptek                                        .
E002 C                   endif
 001 C                   goto      endrut                                                     .
E001 C                   endif                                                            .....
     *
     * ------------------
     * Undergruppe
     * ------------------
     *
B001 C                   if        rap = 16                                               .....
 001 C                   movel     beg           wwxgrp                                       .
 001 C                   eval      wwuogr = wwxogr                                            .
 001 C                   eval      wwuhgr = wwxhgr                                            .
 001 C                   eval      wwuugr = wwxugr                                            .
 001 C     vugrl1_key    chain     vugrl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vgutxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
     *
     * ---------------
     * Kundekategori
     * ---------------
     *
B001 C                   if        rap = 21
 001 C                   movel     k4            wwkkod
 001 C     ra11pf_key    chain     ra11pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raktxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Rabattkategori
     * ---------------
     *
B001 C                   if        rap = 22
 001 C                   movel     k3            wwfkod
 001 C     ra06pf_key    chain     ra06pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raftxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Distrikt
     * ---------------
     *
B001 C                   if        rap = 23
 001 C                   movel     k2            wwhkod
 001 C     ra08pf_key    chain     ra08pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rahtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Selger ordre
     * ---------------
     *
B001 C                   if        rap = 24
 001 C                   movel     k4            wwikod
 001 C     ra09l1_key    chain     ra09l1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raitxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Land
     * ---------------
     *
B001 C                   if        rap = 25
 001 C                   movel     k3            wwlkod
 001 C     ra12pf_key    chain     ra12pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raltxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Selger kasse
     * ---------------
     *
B001 C                   if        rap = 27
 001 C                   movel     k4            wwikod
 001 C     ra09l1_key    chain     ra09l1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     raitxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Varenummer
     * ---------------
     *
B001 C                   if        rap = 31
 001 C                   movel     beg           wwvare
 001 C     vvarl1_key    chain     vvarl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vvtek1        rptek
E002 C                   endif
B002 C                   if        *in50 = *on
 001 C     vvarl1_key    chain     vvasl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vvtek1        rptek
E002 C                   else
 002 C                   movel     sftek1        rptek
E002 C                   endif
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Kunde
     * ---------------
     *
B001 C                   if        rap = 32
 001 C                   movel     k6            wwkund
 001 C     rkunl1_key    chain     rkunl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rknavn        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Kundeprosjekt
     * ---------------
     *
B001 C                   if        rap = 33                                               .....
 001 C                   movel     k6            wwkpro
B001 C                   if        wwkpro <> *zeros                                       .....
 001 C                   move      sfvkun        wwkund
 001 C     fkprl1_key    chain     fkprl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     flnavn        rptek
E002 C                   endif
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
     *
     * ---------------
     * Fakt.nr/Kred.nr
     * ---------------
     *
B001 C                   if        rap = 42
 001 C                   movel     'Fakt.nr/'    rpte1
 001 C                   movel     'Kred.nr '    rpte2
 001 C                   eval      rpte3 = *blank
 001 C                   movel     rpte2         rpte3
 001 C                   movel     rpte1         rptek
 001 C                   move      rpte3         rptek
E001 C                   endif
     *
     * ---------------
     * Fakturadato
     * ---------------
     *
B001 C                   if        rap = 43
 001 C                   movel     'Fakturad'    rpte1
 001 C                   movel     'ato     '    rpte2
 001 C                   eval      rpte3 = *blank
 001 C                   movel     rpte2         rpte3
 001 C                   movel     rpte1         rptek
 001 C                   move      rpte3         rptek
E001 C                   endif
     *
     * ---------------
     * Ordretype
     * ---------------
     *
B001 C                   if        rap = 51
 001 C                   movel     k2a           wwotyp
 001 C     votyl1_key    chain     votyl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vaotxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Avdeling
     * ---------------
     *
B001 C                   if        rap = 52
 001 C                   movel     k2            wwgkod
 001 C     ra07pf_key    chain     ra07pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     ragtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Lager
     * ---------------
     *
B001 C                   if        rap = 53
 001 C                   movel     k2            wwjkod
 001 C     ra10pf_key    chain     ra10pf                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rajtxt        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif
     *
     * ----------------
     * Produktansvarlig
     * ----------------
     *
B001 C                   if        rap = 54
 001 C                   goto      endrut
E001 C                   endif
     *
     * ---------------
     * Leveringstype
     * ---------------
     *
B001 C                   if        rap = 55                                               .....
 001 C                   movel     rt(55)        rptek
 001 C                   movel     beg           wwlety
 001 C     vltpl1_key    chain     vltpl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     vybesk        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
     *
     * ---------------
     * Leverandørnummer
     * ---------------
     *
B001 C                   if        rap = 56                                               .....
 001 C                   movel     k6            wwlevr
 001 C     rlevl1_key    chain     rlevl1                             50
B002 C                   if        *in50 = *off
 002 C                   movel     rlnavn        rptek
E002 C                   endif
 001 C                   goto      endrut
E001 C                   endif                                                            .....
     *
     C     endrut        endsr
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for initiering av program                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     *inzsr        begsr
     *
     C                   eval      rptek = *blank
     C                   eval      *in20 = *off
     *
     * Behandle kriterier for valg
     *
     C     *entry        plist
     C                   parm                    dstype           10
     *
     * Behandle valg-parameter
     *
     C                   eval      spfirm = lcfirm
     C                   eval      sptype = dstype
     C                   eval      spkode = 00
     *
     C     skpml1_key    chain     skpml1                             50
     *
     C                   movel     sprest        wwrest
     *
     * Legg ut tekster i heading
     *
     C                   eval      rp1 = wwsrt1
     C                   eval      rp2 = wwsrt2
     C                   eval      rp3 = wwsrt3
     *
B001 C                   if        rp1 <> 0
 001 C                   eval      wwrt01 = rt(rp1)
E001 C                   endif
     *
B001 C                   if        rp2 <> 0
 001 C                   eval      wwrt02 = rt(rp2)
     C                   eval      *in57 = *on
E001 C                   endif
     *
B001 C                   if        rp3 <> 0
 001 C                   eval      wwrt03 = rt(rp3)
     C                   eval      *in58 = *on
E001 C                   endif
     *
     * Sjekk sammenligning
     *
B001 C                   if        wwsmli = ' '
 001 C                   eval      wwsmli = 'B'
E001 C                   endif
     *
B001 C                   if        wwsmli = 'B'
 001 C                   eval      *in41 = *on
E001 C                   endif
     *
B001 C                   if        wwsmli = 'F'
 001 C                   eval      *in42 = *on
E001 C                   endif
 001 *
     * Sjekk summering
     *
     C                   eval      *in64 = wwsps1 = ' '                          BEGREP 1
     C                   eval      *in65 = wwsps2 = ' '                          BEGREP 2
     C                   eval      *in66 = wwsps3 = ' '                          BEGREP 3
     C                   eval      *in67 = wwsps4 = ' '                          FIRMA
     *
     C                   eval      *in70 = wwsps7 <> ' '                         BEGREP 1
     C                   eval      *in71 = wwsss1 <> ' '                         BEGREP 1
     C                   eval      *in72 = wwsss2 <> ' '                         BEGREP 1
     C                   eval      *in73 = wwsss3 <> ' '                         BEGREP 1
     *
     C                   eval      *in20 = *on
     *
     C                   move      lcfirm        wwfirm
     *
     C                   time                    utime
     C                   eval      w_date = udate
     *
     C                   write     hd1a
     *
     * Key for vareregister
     *
     C     vvarl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwvare
     *
     * Key for kunderegister
     *
     C     rkunl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwkund
     *
     * Key for leverandørregister
     *
     C     rlevl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwlevr
     *
     * Key for kundeprosjekt
     *
     C     fkprl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwkund
     C                   kfld                    wwkpro
     *
     * Key for alt. hovedgruppe
     *
     C     hgrkey        klist
     C                   kfld                    wwfirm
     C                   kfld                    wwhhgr
     *
     * Key for alt. undergruppe
     *
     C     ugrkey        klist
     C                   kfld                    wwfirm
     C                   kfld                    wwuhgr
     C                   kfld                    wwuugr
     *
     * Key for overgruppe
     *
     C     vogrl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwoogr
     *
     * Key for hovedgruppe
     *
     C     vhgrl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwhogr
     C                   kfld                    wwhhgr
     *
     * Key for undergruppe
     *
     C     vugrl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwuogr
     C                   kfld                    wwuhgr
     C                   kfld                    wwuugr
     *
     * Key for ORDRETYPE
     *
     C     votyl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwotyp
     *
     * Key for RABATTKATEGORI
     *
     C     ra06pf_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwfkod
     *
     * Key for AVDELING
     *
     C     ra07pf_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwgkod
     *
     * Key for DISTRIKT
     *
     C     ra08pf_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwhkod
     *
     * Key for SELGER
     *
     C     ra09l1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwikod
     *
     * Key for LAGER
     *
     C     ra10pf_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwjkod
     *
     * Key for KUNDEKATEGORI
     *
     C     ra11pf_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwkkod
     *
     * Key for LAND
     *
     C     ra12pf_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwlkod
     *
     * Key for leveringstype
     *
     C     vltpl1_key    klist
     C                   kfld                    wwfirm
     C                   kfld                    wwlety
     *
     * Key for BUDSJETT
     *
     C     budkey        klist
     C                   kfld                    wwfirm
     C                   kfld                    wwhhaa
     C                   kfld                    wwvers
     C                   kfld                    wwkode
     C                   kfld                    wwaabb
     *
     * Key for PARAMETER
     *
     C     skpml1_key    klist
     C                   kfld                    spfirm
     C                   kfld                    sptype
     C                   kfld                    spkode
     *
     C                   endsr
     *
     C/EJECT
     *
     **********************  T A B E L L E R  ***************************
**       RAPPORT  TEKSTER
Ledig 01                   01
Ledig 02                   02
Ledig 03                   03
Ledig                      04
Ledig                      05
Ledig                      06
Ledig                      07
Ledig                      08
Ledig                      09
Ledig                      10
Alt. hovegruppe            11
Alt. undergruppe           12
Rabattgrp.                 13
Overgruppe                 14
Hovedgruppe                15
Undergruppe                16
Ledig                      17
Ledig                      18
Ledig                      19
Ledig                      20
Kundekategori              21
Rabattkateg.               22
Distrikt                   23
Selger ordre               24
Land                       25
Hgr.-kundekat.             26
Selger kasse               27
Ledig                      28
Ledig                      29
Ledig                      30
Varenummer                 31
Kunde                      32
Kundeprosjekt              33
Ledig                      34
Ledig                      35
Ledig                      36
Ledig                      37
Ledig                      38
Ledig                      39
Ledig                      40
Periode                    41
Faktnr/Krednr              42
Fakturadato                43
Ledig                      44
Ledig                      45
Ledig                      46
Ledig                      47
Ledig                      48
Ledig                      49
Ledig                      50
Ordretype                  51
Avdeling                   52
Lager                      53
Produktansvarlig           54
Leveringstype              55
Leverandør                 56
Time                       57
Ledig                      58
Ledig                      59
Ledig                      60
