     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : VV740R
      * Beskrivelse . . : Bytter varenummer på vare i alle tabeller
      *
      *                   Rutinen bytter ikke varenummer i vareregisteret
      *
      *               NB! Dersom det legges inn bytting av varenummer i
      *                   flere tabeller må også jobben for kopiering fra
      *                   filgruppe til filgruppe endres m.h.p. overriding
      *                   av tabeller mot databibliotek !!!
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       220699 HKO  Nytt program
      *       270200 HKO  Lagt inn bytting av notat-id (varenr) i notat
      *       130102 HKO  Lagt inn bytting av varenummer i påslag-linje
      *       161103 HKO  Fjernet behandling av rabattgruppe-knytning
      *       180104 HKO  Lagt inn bytting av varenummer i bruksrett-knytn.
      *       141104 HKO  Lagt inn bytting av varenummer i
      *                   spesialpris notat, ekstern ordre-linje,
      *       301104 HKO  Parametersatt om *inlr skal settes
      *       310306 HKO  Bytter varenr i alternativ-vare og
      *                   vare-erstatningsvare
      *       230408 bof  Bytter varenr i Påslagsreg. i VA
      * 6.10  220609 BSA  Oppdatert med sporingsinformasjon
6.11  * 6.10  070110 bof  Utvidet med vveppf
6.20  * 6.20  061110 bof  Utvidet lager på sortiment
6.21  * 6.21  020511 bof  Utvidet tilbudspris med varegr. /lev.nr
6.31  * 6.30  160616 bof  Utvide med VVASPF
6.32  * 6.30  261016 bof  For å unngå duplikat i VHISPF, endres VHSEKV
6.33  * 6.33  151118 bof  Endre modulnr ihht. VA
6.34  * 6.34  251118 hko  Utvidet med vare-lager (VVLEPS)
8.01  *PRG2   220622 bof  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
6.33 fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
     fvvenlu    uf   e           k disk    rename(vvenpfr:vvenlur)
6.11 fvveplu    uf   e           k disk    rename(vveppfr:vveplur)
     fvvprlu    uf   e           k disk    rename(vvprpfr:vvprlur)
     fvvsolu    uf   e           k disk    rename(vvsopfr:vvsolur)
     fvsoklu    uf   e           k disk    rename(vsokpfr:vsoklur)
6.21 fvtill9    uf   e           k disk    rename(vtilpfr:vtill9r)
     fvetilu    uf   e           k disk    rename(vetipfr:vetilur)
     fveanl2    uf   e           k disk    rename(veanpfr:veanl2r)
     fvsdtl7    uf   e           k disk    rename(vsdtpfr:vsdtl7r)
     fvpdtla    uf   e           k disk    rename(vpdtpfr:vpdtlar)
     fvbrkl6    uf   e           k disk    rename(vbrkpfr:vbrkl6r)
     fvvaal2    uf   e           k disk    rename(vvaapfr:vvaal2r)
     fvverlu    uf   e           k disk    rename(vverpfr:vverlur)
     fvverl2    uf   e           k disk    rename(vverpfr:vverl2r)
6.34 fvvlelu    uf   e           k disk    rename(vvlepfr:vvlelur)
6.31 fvvaslu    uf   e           k disk    rename(vvaspfr:vvaslur)
      *
     fvlaglu    uf   e           k disk    rename(vlagpfr:vlaglur)
     fvhisl3    uf   e           k disk    rename(vhispfr:vhisl3r)
      *
     ffrabla    uf   e           k disk    rename(frabpfr:frablar)
     ffpril5    uf   e           k disk    rename(fpripfr:fpril5r)
     ffprnl2    uf   e           k disk    rename(fprnpfr:fprnl2r)
     ffgeblv    uf   e           k disk    rename(fgebpfr:fgeblvr)
     ffodtlv    uf   e           k disk    rename(fodtpfr:fodtlvr)
      *
     fnodtl4    uf   e           k disk    rename(nodtpfr:nodtl4r)
      *
     fsodtlv    uf   e           k disk    rename(sodtpfr:sodtlvr)
     fbodtl2    uf   e           k disk    rename(bodtpfr:bodtl2r)
     fsstal2    uf   e           k disk    rename(sstapfr:sstal2r)
      *
     fanotlu    uf   e           k disk    rename(anotpfr:anotlur)
      *
     fjpfal6    uf   e           k disk    rename(jpfapfr:jpfal6r)
      *
6.10  * Local data area
6.10  *
6.10 d                uds
6.10 d l_user                911    920
      *
      * Definering av parametre
      *
     d p_firm          s              3  0
     d p_gvar          s             15
     d p_vare          s             15
     d p_inlr          s              1
      *
      * Definering av variable i nøkler
      *
6.33 d jvarl1_vare     s                   like(jvvare)
     d anotlu_syst     s                   like(ausyst)
     d anotlu_noid     s                   like(aunoid)
      *
      * Definering av variable
      *
     d w_firm          s              3  0
     d w_gvar          s             15
6.33 d w_modn          s                   like(jvmodn)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      w_firm = p_firm
     c                   eval      w_gvar = p_gvar
6.33  *
6.33  * les VA var
6.33  *
6.33 c                   eval      w_modn = 0
6.33 c                   eval      jvarl1_vare = p_vare
6.33 c     jvarl1_key    chain     jvarl1
6.33 c                   if        %found(jvarl1)
6.33 c                   eval      w_modn = jvmodn
6.33 c                   endif
      *
      * Oppdaterer varenummer i vare-enhets-register
      *
     c     key01         setll     vvenlu
     c     key01         reade     vvenlur                                90
     c                   dow       *in90 = *off
     c                   eval      vevare = p_vare
6.10 c                   time                    veedat
6.10 c                   time                    veetim
6.10 c                   eval      veeusr = l_user
     c                   update    vvenlur
     c     key01         reade     vvenlur                                90
     c                   enddo
6.11  *
6.11  * Oppdaterer varenummer i vare-enhets-prisgiver-register
6.11  *
6.11 c     key01         setll     vveplu
6.11 c     key01         reade     vveplur                                90
6.11 c                   dow       *in90 = *off
6.11 c                   eval      vepvar = p_vare
6.10 c                   time                    vepeda
6.10 c                   time                    vepeti
6.10 c                   eval      vepeus = l_user
6.11 c                   update    vveplur
6.11 c     key01         reade     vveplur                                90
6.11 c                   enddo
      *
      * Oppdaterer varenummer i vare-pris-register
      *
     c     key01         setll     vvprlu
     c     key01         reade     vvprlur                                90
     c                   dow       *in90 = *off
     c                   eval      vpvare = p_vare
6.10 c                   time                    vpedat
6.10 c                   time                    vpetim
6.10 c                   eval      vpeusr = l_user
     c                   update    vvprlur
     c     key01         reade     vvprlur                                90
     c                   enddo
      *
      * Oppdaterer varenummer i vare-søketekst-register
      *
     c     key01         setll     vvsolu
     c     key01         reade     vvsolur                                90
     c                   dow       *in90 = *off
     c                   eval      vvsvar = p_vare
     c                   update    vvsolur
     c     key01         reade     vvsolur                                90
     c                   enddo
      *
      * Oppdaterer varenummer i søketekst-register
      *
     c     key01         setll     vsoklu
     c     key01         reade     vsoklur                                90
     c                   dow       *in90 = *off
     c                   eval      vsvare = p_vare
     c                   update    vsoklur
     c     key01         reade     vsoklur                                90
     c                   enddo
      *
      * Oppdaterer varenummer i tilbuds-register
      *
6.21 c     key01         setll     vtill9
6.21 c     key01         reade     vtill9r                                90
     c                   dow       *in90 = *off
     c                   eval      vtvare = p_vare
6.10 c                   time                    vtedat
6.10 c                   time                    vtetim
6.10 c                   eval      vteusr = l_user
6.21 c                   update    vtill9r
6.21 c     key01         reade     vtill9r                                90
     c                   enddo
      *
      * Oppdaterer varenummer i etikett-register
      *
     c     key01         setll     vetilu
     c     key01         reade     vetilur                                90
     c                   dow       *in90 = *off
     c                   eval      vmvare = p_vare
6.10 c                   time                    vmedat
6.10 c                   time                    vmetim
6.10 c                   eval      vmeusr = l_user
     c                   update    vetilur
     c     key01         reade     vetilur                                90
     c                   enddo
      *
      * Oppdaterer varenummer i EAN-register
      *
     c     key01         setll     veanl2
     c     key01         reade     veanl2r                                90
     c                   dow       *in90 = *off
     c                   eval      vxvare = p_vare
6.10 c                   time                    vxedat
6.10 c                   time                    vxetim
6.10 c                   eval      vxeusr = l_user
     c                   update    veanl2r
     c     key01         reade     veanl2r                                90
     c                   enddo
      *
      * Oppdaterer varenummer i sortiment-linje-register
      *
     c     key01         setll     vsdtl7
     c     key01         reade     vsdtl7r                                90
     c                   dow       *in90 = *off
     c                   eval      vdvare = p_vare
6.33 c                   if        vdmodn <> 0 and
6.33 c                             w_modn <> 0
6.33 c                   eval      vdmodn = w_modn
6.33 c                   endif
6.10 c                   time                    vdedat
6.10 c                   time                    vdetim
6.10 c                   eval      vdeusr = l_user
     c                   update    vsdtl7r
     c     key01         reade     vsdtl7r                                90
     c                   enddo
      *
      * Oppdaterer varenummer i påslag-linje-register
      *
     c     key01         setll     vpdtla
     c     key01         reade     vpdtlar                                90
     c                   dow       *in90 = *off
     c                   eval      vjvare = p_vare
6.10 c                   time                    vjedat
6.10 c                   time                    vjetim
6.10 c                   eval      vjeusr = l_user
     c                   update    vpdtlar
     c     key01         reade     vpdtlar                                90
     c                   enddo
      *
      * Oppdaterer varenummer i bruksrett-knytning
      *
     c     key01         setll     vbrkl6
     c     key01         reade     vbrkl6r
     c                   dow       not %eof
     c                   eval      vbvare = p_vare
     c                   update    vbrkl6r
     c     key01         reade     vbrkl6r
     c                   enddo
      *
      * Oppdaterer varenummer i alternativ vare
      *
     c     key01         setll     vvaal2
     c     key01         reade     vvaal2r
     c                   dow       not %eof
     c                   eval      vvaava = p_vare
6.10 c                   time                    vvaeda
6.10 c                   time                    vvaeti
6.10 c                   eval      vvaeus = l_user
     c                   update    vvaal2r
     c     key01         reade     vvaal2r
     c                   enddo
      *
      * Oppdaterer varenummer i vare-erstatningsvare
      *
     c     key01         setll     vverlu
     c     key01         reade     vverlur
     c                   dow       not %eof
     c                   eval      vvenvr = p_vare
6.10 c                   time                    vveeda
6.10 c                   time                    vveeti
6.10 c                   eval      vveeus = l_user
     c                   update    vverlur
     c     key01         reade     vverlur
     c                   enddo
      *
     c     key01         setll     vverl2
     c     key01         reade     vverl2r
     c                   dow       not %eof
     c                   eval      vvegvr = p_vare
6.10 c                   time                    vveeda
6.10 c                   time                    vveeti
6.10 c                   eval      vveeus = l_user
     c                   update    vverl2r
     c     key01         reade     vverl2r
     c                   enddo
      *
6.34  * Oppdaterer varenummer i vare-leverandør
6.34  *
6.34 c     key01         setll     vvlelu
6.34 c     key01         reade     vvlelur
6.34 c                   dow       not %eof
6.34 c                   eval      vvlvnr = p_vare
6.34 c                   eval      vvleda = %date
6.34 c                   eval      vvleti = %time
6.34 c                   eval      vvleus = l_user
6.34 c                   update    vvlelur
6.34 c     key01         reade     vvlelur
6.34 c                   enddo
      *
      * Oppdaterer varenummer i lager-register
      *
     c     key01         setll     vlaglu
     c     key01         reade     vlaglur                                90
     c                   dow       *in90 = *off
     c                   eval      vlvare = p_vare
6.10 c                   time                    vledat
6.10 c                   time                    vletim
6.10 c                   eval      vleusr = l_user
     c                   update    vlaglur
     c     key01         reade     vlaglur                                90
     c                   enddo
      *
      * Oppdaterer varenummer i historisk lagerbok-register
      *
     c     key01         setll     vhisl3
     c     key01         reade     vhisl3r                                90
     c                   dow       *in90 = *off
     c                   eval      vhvare = p_vare
6.32 c                   eval      vhsekv = vhsekv + 9000
6.10 c                   time                    vhedat
6.10 c                   time                    vhetim
6.10 c                   eval      vheusr = l_user
     c                   update    vhisl3r
     c     key01         reade     vhisl3r                                90
     c                   enddo
      *
      * Oppdaterer varenummer i rabattmatrise-register
      *
     c     key01         setll     frabla
     c     key01         reade     frablar                                90
     c                   dow       *in90 = *off
     c                   eval      frvare = p_vare
6.10 c                   time                    fredat
6.10 c                   time                    fretim
6.10 c                   eval      freusr = l_user
     c                   update    frablar
     c     key01         reade     frablar                                90
     c                   enddo
      *
      * Oppdaterer varenummer i spesialpris-register
      *
     c     key01         setll     fpril5
     c     key01         reade     fpril5r                                90
     c                   dow       *in90 = *off
     c                   eval      fpvare = p_vare
6.10 c                   time                    fpedat
6.10 c                   time                    fpetim
6.10 c                   eval      fpeusr = l_user
     c                   update    fpril5r
     c     key01         reade     fpril5r                                90
     c                   enddo
      *
      * Oppdaterer varenummer i spesialpris-notat-register
      *
     c     key01         setll     fprnl2
     c     key01         reade     fprnl2r
     c                   dow       not %eof
     c                   eval      fpnvar = p_vare
6.10 c                   time                    fpneda
6.10 c                   time                    fpneti
6.10 c                   eval      fpneus = l_user
     c                   update    fprnl2r
     c     key01         reade     fprnl2r
     c                   enddo
      *
      * Oppdaterer varenummer i gebyr-register
      *
     c     key01         setll     fgeblv
     c     key01         reade     fgeblvr                                90
     c                   dow       *in90 = *off
     c                   eval      fgvare = p_vare
6.10 c                   time                    fgedat
6.10 c                   time                    fgetim
6.10 c                   eval      fgeusr = l_user
     c                   update    fgeblvr
     c     key01         reade     fgeblvr                                90
     c                   enddo
      *
      * Oppdaterer varenummer i ordre-linje-register
      *
     c     key01         setll     fodtlv
     c     key01         reade     fodtlvr                                90
     c                   dow       *in90 = *off
     c                   eval      fdvare = p_vare
6.10 c                   time                    fdedat
6.10 c                   time                    fdetim
6.10 c                   eval      fdeusr = l_user
     c                   update    fodtlvr
     c     key01         reade     fodtlvr                                90
     c                   enddo
6.31  *
6.31  * Oppdaterer varenummer i vare-slettet register
6.31  *
6.31 c     key01         setll     vvaslu
6.31 c     key01         reade     vvaslur                                90
6.31 c                   dow       *in90 = *off
6.31 c                   eval      vvvare = p_vare
6.31 c                   time                    vvedat
6.31 c                   time                    vvetim
6.31 c                   eval      vveusr = l_user
6.31 c                   update    vvaslur
6.31 c     key01         reade     vvaslur                                90
6.31 c                   enddo
      *
      * Oppdaterer varenummer i ekstern ordre-linje-register
      *
     c     key01         setll     nodtl4
     c     key01         reade     nodtl4r
     c                   dow       not %eof
     c                   eval      ndvare = p_vare
6.10 c                   time                    ndedat
6.10 c                   time                    ndetim
6.10 c                   eval      ndeusr = l_user
     c                   update    nodtl4r
     c     key01         reade     nodtl4r
     c                   enddo
      *
      * Oppdaterer varenummer i faktura-linje-register
      *
     c     key01         setll     sodtlv
     c     key01         reade     sodtlvr                                90
     c                   dow       *in90 = *off
     c                   eval      sdvare = p_vare
6.10 c                   time                    sdedat
6.10 c                   time                    sdetim
6.10 c                   eval      sdeusr = l_user
     c                   update    sodtlvr
     c     key01         reade     sodtlvr                                90
     c                   enddo
      *
      * Oppdaterer varenummer i Bong-linje-register
      *
     c     key01         setll     bodtl2
     c     key01         reade     bodtl2r                                90
     c                   dow       *in90 = *off
     c                   eval      bdvare = p_vare
6.10 c                   time                    bdedat
6.10 c                   time                    bdetim
6.10 c                   eval      bdeusr = l_user
     c                   update    bodtl2r
     c     key01         reade     bodtl2r                                90
     c                   enddo
      *
      * Oppdaterer varenummer i Salgsstatistikk-register
      *
     c     key01         setll     sstal2
     c     key01         reade     sstal2r                                90
     c                   dow       *in90 = *off
     c                   eval      sfvare = p_vare
     c                   update    sstal2r
     c     key01         reade     sstal2r                                90
     c                   enddo
      *
      * Oppdaterer notat-id i notat
      *
     c                   eval      anotlu_syst = 'VVAR'
     c                   eval      anotlu_noid = w_gvar
     c     anotlu_key    setll     anotlu
     c     anotlu_key    reade     anotlur                                90
     c                   dow       *in90 = *off
     c                   eval      aunoid = p_vare
6.10 c                   time                    auedat
6.10 c                   time                    auetim
6.10 c                   eval      aueusr = l_user
     c                   update    anotlur
     c     anotlu_key    reade     anotlur                                90
     c                   enddo
      *
      * Oppdaterer varenummer i påslagsregister i VA
      *
     c     key01         setll     jpfal6
     c     key01         reade     jpfal6r                                90
     c                   dow       *in90 = *off
     c                   eval      jcvare = p_vare
6.33 c                   if        jcmodn <> 0 and
6.33 c                             w_modn <> 0
6.33 c                   eval      jcmodn = w_modn
6.33 c                   endif
6.10 c                   time                    jcedat
6.10 c                   time                    jcetim
6.10 c                   eval      jceusr = l_user
     c                   update    jpfal6r
     c     key01         reade     jpfal6r                                90
     c                   enddo
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   if        p_inlr <> *on
     c                   eval      *inlr = *on
     c                   endif
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_firm
     c                   parm                    p_gvar
     c                   parm                    p_vare
     c                   parm                    p_inlr
      *
      * Key for oppslag/les på vare
      *
     c     key01         klist
     c                   kfld                    w_firm
     c                   kfld                    w_gvar
      *
      * Key for oppdatering av notat
      *
     c     anotlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    anotlu_syst
     c                   kfld                    anotlu_noid
6.33  *
6.33  * les av VA vare
6.33  *
6.33 c     jvarl1_key    klist
6.33 c                   kfld                    jvarl1_vare
      *
     c                   endsr
