     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
      *                                                                       *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RA210R                                              *
      * Beskrivelse . . : Kunder til Adra Match                               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
6.30  * 2017_08_07 sst    Legger ut Bet.varsel2 i tillegg (Inkasso)           *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frktrld    ip   e           k disk    rename(rktrpfr:rktrldr)
     frktal1    if   e           k disk    rename(rktapfr:rktal1r)
     fakidl3    if   e           k disk    rename(akidpfr:akidl3r)
     fakidl1    if   e           k disk    rename(akidpfr:akidl1r)
     frltrl9    if   e           k disk    rename(rltrpfr:rltrl9r)
     fadrktra   o    f  256        disk
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_aar           s              4  0
     d w_mnd           s              2  0
     d w_fgr           s              3
     d w_sted          s             25
     d w_kund          s              6
     d w_biln          s              8
     d w_kid21         s             21
     d w_kid22         s             21
     d w_kidbv         s             21
     d w_bnrbv         s              8
6.30 d w_kidb2         s             21
6.30 d w_bnrb2         s              8
6.30 d w_kidb3         s             21
6.30 d w_bnrb3         s              8
     d w_kidgn         s             21
     d w_bnrgn         s              8
     d w_datx          s             10
     d w_fdat          s              8
     d w_bel           s             15
     d w_6x            s              6
     d w_8x            s              8
     d krec            s            256
      *
     d rktal1_firm     s                   like(rkafir)
     d rktal1_tist     s                   like(rkatis)
     d akidl3_firm     s                   like(akfirm)
     d akidl3_kidd     s                   like(akkidd)
     d akidl1_firm     s                   like(akfirm)
     d akidl1_kidd     s                   like(akkidr)
     d rltrl9_firm     s                   like(rofirm)
     d rltrl9_levr     s                   like(rolevr)
      *
      *   Sjekk om post har vært med på purring/betalingsvarsel
     c                   if        rnbiln = 363255
     c                   eval      rnbiln = rnbiln
     c                   endif
      *
     c                   eval      rktal1_firm = rnfirm
     c                   eval      rktal1_tist = rntist
     c                   eval      w_kidbv = *blank
     c                   eval      w_kidgn = *blank
     c                   eval      w_kidb2 = *blank
     c                   eval      w_kidb3 = *blank
     c     rktal1_key    chain     rktal1
     c                   if        %found(rktal1)
     c                   if        rkagki = '01591477'
     c                   eval      rkagki = rkagki
     c                   endif
     c                   move      rkabvn        w_bnrbv
     c                   movel     rkakid        w_kidbv
6.30 c                   move      rkabv2        w_bnrb2
6.30 c                   movel     rkaki2        w_kidb2
6.30 c                   move      rkabv3        w_bnrb3
6.30 c                   movel     rkaki3        w_kidb3
     c                   move      rkagnn        w_bnrgn
     c                   movel     rkagki        w_kidgn
     c                   else
     c                   move      *blank        w_bnrbv
     c                   move      *blank        w_kidbv
6.30 c                   move      *blank        w_bnrb2
6.30 c                   move      *blank        w_kidb2
6.30 c                   move      *blank        w_bnrb3
6.30 c                   move      *blank        w_kidb3
     c                   move      *blank        w_bnrgn
     c                   move      *blank        w_kidgn
     c                   endif
      *  Debug
     c                   if        rnkund = 499924  and
     c                             rnbiln = 01447379
     c                   eval      rnbiln = rnbiln
     c                   endif
     c                   move      rnkund        w_kund
     c                   eval      w_bel = %char(rnrest)
     c                   eval      w_bel = %xlate('.' :',':w_bel)
     c                   move      rnbiln        w_biln
     c                   move      *blank        w_kid21
     c                   movel     rnkidr        w_kid21
     c                   movel     rnkidi        w_kid22
      *  Ev. hente kidd fra akidl3 fra vanlig fakturering
     c                   if        w_kid21 = *blank or
     c                             w_kid21 = '00000000'
     c                   movel     '000000'      akidl3_kidd
     c                   move      rnkund        w_6x
     c                   move      rnbiln        w_8x
     c                   eval      %subst(akidl3_kidd:7:6) = w_6x
     c                   eval      %subst(akidl3_kidd:13:8) = w_8x
     c     akidl3_key    setll     akidl3
     c                   read      akidl3
     c                   if        not %eof(akidl3) and
     c                             %subst(akidl3_kidd:1:20) =
     c                             %subst(akkidd:1:20)
     c                   movel     akkidr        w_kid21
s    c                   move      *blank        w_kid21
s    c                   movel     akkidr        w_x9              9
s    c                   move      akksif        w_x9
s    c                   movel     w_x9          w_kid21
     c                   movel     akkidd        w_kid22
     c                   goto      kidok
     c                   endif
     c                   endif
      *  Ev. hente kidd fra akidl3 fra rentenota
     c                   if        w_kid21 = *blank or
     c                             w_kid21 = '00000000'
     c                   movel     '000200'      akidl3_kidd
     c                   move      rnkund        w_6x
     c                   move      rnbiln        w_8x
     c                   eval      %subst(akidl3_kidd:7:6) = w_6x
     c                   eval      %subst(akidl3_kidd:13:8) = w_8x
     c     akidl3_key    setll     akidl3
     c                   read      akidl3
     c                   if        not %eof(akidl3) and
     c                             %subst(akidl3_kidd:1:20) =
     c                             %subst(akkidd:1:20)
     c                   movel     akkidr        w_kid21
s    c                   move      *blank        w_kid21
s    c                   movel     akkidr        w_x9              9
s    c                   move      akksif        w_x9
s    c                   movel     w_x9          w_kid21
     c                   movel     akkidd        w_kid22
     c                   endif
     c                   goto      kidok
     c                   endif
      *  Ev. hente kidd fra akidl3 fra Inkassovarsel
     c                   if        w_kid21 = *blank or
     c                             w_kid21 = '00000000'
     c                   movel     '000100'      akidl3_kidd
     c                   move      rnkund        w_6x
     c                   move      rnbiln        w_8x
     c                   eval      %subst(akidl3_kidd:7:6) = w_6x
     c                   eval      %subst(akidl3_kidd:13:8) = w_8x
     c     akidl3_key    setll     akidl3
     c                   read      akidl3
     c                   if        not %eof(akidl3) and
     c                             %subst(akidl3_kidd:1:20) =
     c                             %subst(akkidd:1:20)
     c                   movel     akkidr        w_kid21
s    c                   move      *blank        w_kid21
s    c                   movel     akkidr        w_x9              9
s    c                   move      akksif        w_x9
s    c                   movel     w_x9          w_kid21
     c                   movel     akkidd        w_kid22
     c                   endif
     c                   goto      kidok
     c                   endif
      *
     c     kidok         tag
      *
      *  Henter sjekksiffer til kid på bet.varsel
     c                   if        w_kidbv <> *blank
     c                   movel     w_kidbv       akidl1_kidd
     c     akidl1_key    chain     akidl1
     c                   if        %found(akidl1)
     c                   eval      %subst(w_kidbv:9:1) = %char(akksif)
     c                   endif
     c                   endif
      *  Henter sjekksiffer til kid på b2
     c                   if        w_kidb2 <> *blank
     c                   movel     w_kidb2       akidl1_kidd
     c     akidl1_key    chain     akidl1
     c                   if        %found(akidl1)
     c                   eval      %subst(w_kidb2:9:1) = %char(akksif)
     c                   endif
     c                   endif
      *  Henter sjekksiffer til kid på b3
     c                   if        w_kidb3 <> *blank
     c                   movel     w_kidb3       akidl1_kidd
     c     akidl1_key    chain     akidl1
     c                   if        %found(akidl1)
     c                   eval      %subst(w_kidb3:9:1) = %char(akksif)
     c                   endif
     c                   endif
      *  Henter sjekksiffer til kid på generalnota
     c                   if        w_kidgn <> *blank
     c                   movel     w_kidgn       akidl1_kidd
     c     akidl1_key    chain     akidl1
     c                   if        %found(akidl1)
     c                   eval      %subst(w_kidgn:9:1) = %char(akksif)
     c                   endif
     c                   endif
      *
     c                   move      rnfdat        w_datx
     c                   eval      w_fdat =
     c                             %subst(w_datx:1:4) +
     c                             %subst(w_datx:6:2) +
     c                             %subst(w_datx:9:2)
      *
     c                   dow       %subst(w_kund:1:1) = '0'
     c                   eval      %subst(w_kund:1:5) =
     c                             %subst(w_kund:2:5)
     c                   eval      %subst(w_kund:6:1) = *blank
     c                   enddo
      *
     c                   dow       %subst(w_biln:1:1) = '0'
     c                   eval      %subst(w_biln:1:7) =
     c                             %subst(w_biln:2:7)
     c                   eval      %subst(w_biln:8:1) = *blank
     c                   enddo
      *
     c                   eval      krec  = '          ' +
     c                             w_kund               +
     c                             '       '            +
     c                             w_bel                +
     c                             ' '                  +
     c                             w_fdat               +
     c                             w_biln               +
     c                             '          '         +
     c                             w_kid21              +
     c                             '                  ' +
     c                             '                  ' +
     c                             '   '                +
     c                             w_kid22              +
     c                             ' '                  +
     c                             w_bnrbv              +
     c                             '  '                 +
     c                             w_kidbv              +
     c                             ' '                  +
     c                             w_bnrgn              +
     c                             '  '                 +
     c                             w_kidgn              +
6.30 c                             ' '                  +
6.30 c                             w_bnrb2              +
6.30 c                             '  '                 +
6.30 c                             w_kidb2              +
     c                             ' '                  +
6.30 c                             w_bnrb3              +
6.30 c                             '  '                 +
6.30 c                             w_kidb3              +
     c                             ' '
     c                   except    kundrec
      *
     clr                 eval      rltrl9_firm = *zero
     clr                 eval      rltrl9_levr = *zero
     clr   rltrl9_key    setll     rltrl9
     clr                 read      rltrl9
     clr                 dow       not %eof(rltrl9)
     clr                 exsr      lever
     clr                 read      rltrl9
     clr                 enddo
      *
     c     lever         begsr
     c                   move      *blank        w_bnrbv
     c                   move      *blank        w_kidbv
6.30 c                   move      *blank        w_bnrb2
6.30 c                   move      *blank        w_kidb2
6.30 c                   move      *blank        w_bnrb3
6.30 c                   move      *blank        w_kidb3
     c                   move      *blank        w_bnrgn
     c                   move      *blank        w_kidgn
      *  Debug
     c                   move      rolevr        w_kund
     c                   eval      w_bel = %char(rorest)
     c                   eval      w_bel = %xlate('.' :',':w_bel)
     c                   move      robiln        w_biln
     c                   movel     rokidr        w_kid21
     c                   movel     rokidi        w_kid22
     c                   move      rofdat        w_datx
      *
     c                   dow       %subst(w_kund:1:1) = '0'
     c                   eval      %subst(w_kund:1:5) =
     c                             %subst(w_kund:2:5)
     c                   eval      %subst(w_kund:6:1) = *blank
     c                   enddo
      *
     c                   dow       %subst(w_biln:1:1) = '0'
     c                   eval      %subst(w_biln:1:7) =
     c                             %subst(w_biln:2:7)
     c                   eval      %subst(w_biln:8:1) = *blank
     c                   enddo
     c                   eval      w_fdat =
     c                             %subst(w_datx:1:4) +
     c                             %subst(w_datx:6:2) +
     c                             %subst(w_datx:9:2)
      *
     c                   eval      krec  = '          ' +
     c                             w_kund               +
     c                             '       '            +
     c                             w_bel                +
     c                             ' '                  +
     c                             w_fdat               +
     c                             w_biln               +
     c                             '          '         +
     c                             w_kid21              +
     c                             '                  ' +
     c                             '                  ' +
     c                             '   '                +
     c                             w_kid22              +
     c                             ' '                  +
     c                             w_bnrbv              +
     c                             '  '                 +
     c                             w_kidbv              +
     c                             ' '                  +
     c                             w_bnrgn              +
     c                             '  '                 +
     c                             w_kidgn              +
6.30 c                             ' '                  +
6.30 c                             w_bnrb2              +
6.30 c                             '  '                 +
6.30 c                             w_kidb2              +
6.30 c                             ' '                  +
6.30 c                             w_bnrb3              +
6.30 c                             '  '                 +
6.30 c                             w_kidb3              +
     c                             ' '
     c                   except    kundrec
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
 001  *
     c     rktal1_key    klist
     c                   kfld                    rktal1_firm
     c                   kfld                    rktal1_tist
 001  *
     c     akidl3_key    klist
     c                   kfld                    akidl3_firm
     c                   kfld                    akidl3_kidd
 001  *
     c     akidl1_key    klist
     c                   kfld                    akidl1_firm
     c                   kfld                    akidl1_kidd
     c     rltrl9_key    klist
     c                   kfld                    rltrl9_firm
     c                   kfld                    rltrl9_levr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    w_fgr
      *
     c                   eval      akidl3_firm = l_firm
     c                   eval      akidl1_firm = l_firm
      *
     c                   endsr
     oadrktra   e            kundrec
     o                       krec               256
