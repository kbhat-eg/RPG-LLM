      /TITLE  ASOKON Arbeid med returfiler
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * System  . . . . : ASTELE                                        *
      * Program . . . . : GL230R                                        *
      * Beskrivelse . . : Konverteringsrutine                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.*
      * --------- ------  ----------------------------------------------*
      * 31011     310101  Nytt program.                            RH   *
      *                                                                 *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fgl230d    o    e             workstn
     fgatrpf    uf   e           k disk
     fgbtrpf    uf   e           k disk
     fgavtl1    if   e           k disk
      *
     d w_arow          s              2  0
     d w_acol          s              3  0
     d wgatrl          s              9  0
     d wgatro          s              9  0
     d wgbtrl          s              9  0
     d wgbtro          s              9  0
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2CTL Behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Send Alt
      *
     c     a000          tag
      *
     c                   write     a1win
      *
      * BEHANDLER RETURFILEN (GATRPF):
      *
     c                   read      gatrpf                                 60
      *
     c                   dow       *in60 = *off                                 .....
     c                   eval      wgatrl = wgatrl + 1                              .
      *                                                        .
      * Finner avtaleposten:                                   .
      *                                                        .
     c     gbgiro        chain     gavtl1                             61            .
      *                                                        .
     c                   if        *in61 = *off                                     .
     c                             and gbgiro <> 0                              ... .
      *                                                      . .
      * Bytter ut kontonummer med sonekontonummer:           . .
      *                                                      . .
     c                   eval      gbgiro = gcskto                                . .
      *                                                      . .
      * Legger ut Filgrupper og Firmanummer:                 . .
      *                                                      . .
     c                   movel     gcfilg        gbfgrp                           . .
     c                   eval      gbfirm = gcfirm                                . .
      *                                                      . .
      * Oppdaterer GATRPF:                                   . .
      *                                                      . .
     c                   update    gatrpfr                                        . .
     c                   eval      wgatro = wgatro + 1                              .
      *                                                      . .
     c                   endif                                                  ... .
      *                                                        .
     c                   read      gatrpf                                 60        .
     c                   enddo                                                  .....
      *
      * Skriver en kvittering på antall poster som er behandlet:
      *
     c                   eval      a1atrl = wgatrl
     c                   eval      a1atro = wgatro
     c                   write     a1win
      *
     c                   eval      w_arow = w_arow + 10
      *
     c                   write     a2win
      *
      * BEHANDLER BACKUPFILEN (GBTRPF):
      *
     c                   read      gbtrpf                                 60
      *
     c                   dow       *in60 = *off                                 .....
     c                   eval      wgbtrl = wgbtrl + 1                              .
      *                                                        .
      * Finner avtaleposten:                                   .
      *                                                        .
     c     gfgiro        chain     gavtl1                             61            .
      *                                                        .
     c                   if        *in61 = *off                                     .
     c                             and gfgiro <> 0                              ... .
      *                                                      . .
      * Bytter ut kontonummer med sonekontonummer:           . .
      *                                                      . .
     c                   eval      gfgiro = gcskto                                . .
      *                                                      . .
      * Legger ut Filgrupper og Firmanummer:                 . .
      *                                                      . .
     c                   movel     gcfilg        gffgrp                           . .
     c                   eval      gffirm = gcfirm                                . .
      *                                                      . .
      * Oppdaterer GATRPF:                                   . .
      *                                                      . .
     c                   update    gbtrpfr                                        . .
     c                   eval      wgbtro = wgbtro + 1                              .
      *                                                      . .
     c                   endif                                                  ... .
      *                                                        .
     c                   read      gbtrpf                                 60        .
     c                   enddo                                                  .....
      *
      * Skriver en kvittering på antall poster som er behandlet:
      *
     c                   eval      a2atrl = wgbtrl
     c                   eval      a2atro = wgbtro
      *
     c                   write     a2win
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      w_arow = 2
     c                   eval      w_acol = 10
     c                   eval      wgatro = 0
     c                   eval      wgatrl = 0
     c                   eval      wgbtro = 0
     c                   eval      wgbtrl = 0
      *
     c                   endsr
      *
