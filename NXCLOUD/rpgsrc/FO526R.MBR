      /TITLE  ASOFAK: Vise kunde-opplysninger
     h datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FO526R
      * Beskrivelse . . : Vise kunde-opplysninger
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * R4.00 230102 AMD  Skrevet om til ny standard
7.xx  * 7.00  260116 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
7.00  * 7.00  060320 bkv  Takler 132 bilder
      *
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffo526d    cf   e             workstn
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
      *
      * Definering av parametere
      *
     d p_retu          s              1
     d p_firm          s              3  0
      *
      * Definering av local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(rkfirm)
     d rkunl1_kund     s                   like(rkkund)
      *
      * Definering av variable
      *
     d w_retu          s              1
     d w_otyp          s              2
     d w_kund          s                   like(rkkund)
     d w_navn          s                   like(rknavn)
      *
      * Forklaring til statuskoder
      *
      *      w_retu  Benyttes ved retur fra ett annet program
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B1 Behandler registrering av kundernummer
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     b1tag         tag
      *
      * Nullstiller/Blanker felter som skal benyttes
      *
     c     b1taga        tag
      *
     c                   eval      *in41 = *off
     c                   eval      b1kund = *zero
     c                   eval      w_kund = *zero
      *
     c                   eval      b2navn = *blank
     c                   eval      b2gate = *blank
     c                   eval      b2adr2 = *blank
     c                   eval      b2sted = *blank
      *
      * Send Alt
      *
     c     b1tagb        tag
     c                   eval      w_retu = *blank
     c                   eval      b1valg = *zero
      *
     c                   exfmt     b1bld
      *
      * F3=Avslutt program
      *
     c                   if        *inkc = *on
     c                   goto      avslutt
     c                   endif
      *
      * F4=Spørring i kunde-register
      *
     c                   if        *inkd = *on
     c                   call      'RK500R'
     c                   parm                    w_firm
     c                   parm                    b1kund
     c                   parm                    w_navn
      *
     c                   if        w_retu <> *blank
     c                   goto      b1tag
     c                   endif
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekker opplysninger om kunden
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     b1tag0        tag
      *
      * Sjekk, Finnes kunde i KUNDE-REGISTER
      *
     c                   if        b1kund <> w_kund
     c                   eval      rkunl1_kund = b1kund
     c     rkunl1_key    chain     rkunl1r                            90
     c                   if        *in90 = *on
     c                   eval      *in31 = *on
     c                   eval      *in41 = *off
     c                   goto      b1tagb
     c                   endif
      *
     c                   eval      *in41 = *on
     c                   eval      w_kund = b1kund
     c                   eval      b2navn = rknavn
     c                   eval      b2gate = rkgate
     c                   eval      b2adr2 = rkadr2
     c                   eval      b2sted = rksted
      *
     c                   goto      b1tagb
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekker hvilket valg som er benyttet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Kaller opp SUB-program for å vise   (KUNDE/ORDRE/LINJE)
      *
     c                   if        b1valg = 01
     c                   eval      w_retu = '0'
     c                   call      'VA556R'
     c                   parm                    w_retu
     c                   parm                    w_firm
     c                   parm                    w_otyp
      *
     c                   if        w_retu = *blank
     c                   call      'FO510R'
     c                   parm                    w_retu
     c                   parm                    w_otyp
     c                   parm                    b1valg
     c                   parm                    w_firm
     c                   parm                    b1kund
     c                   parm                    b2navn
     c                   goto      b1tagb
     c                   endif
     c                   endif
      *
      * Kaller opp SUB-program for å vise   (KUNDE/VARE)
      *
     c                   if        b1valg = 02
     c                   eval      w_retu = '0'
     c                   call      'VA556R'
     c                   parm                    w_retu
     c                   parm                    w_firm
     c                   parm                    w_otyp
      *
     c                   if        w_retu = *blank
     c                   call      'FO510R'
     c                   parm                    w_retu
     c                   parm                    w_otyp
     c                   parm                    b1valg
     c                   parm                    w_firm
     c                   parm                    b1kund
     c                   parm                    b2navn
     c                   goto      b1tagb
     c                   endif
     c                   endif
      *
      * Gå tilbake til start
      *
     c                   goto      b1tagb
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Nullstilling av felter som ikke kan redefineres
      *
     c                   eval      w_retu = *blank
     c                   eval      w_otyp = *blank
      *
      * Key for file : KUNDE-REGISTER
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Parametere
      *
     c     *entry        plist
     c                   parm                    p_retu
     c                   parm                    p_firm
      *
      * Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
