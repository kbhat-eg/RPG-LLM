     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASVADM
      * Program . . . . : JM740R
      * Beskrivelse . . : Kampanje, Nobb integrasjonsformat   - parameter
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       300408 bof  Nytt program
6.30  *       250311 bof  Utvidet med valg av csv format
6.20  *       191214 nho  Lagt inn feilmelding på kampanjenavn, kan kun
6.20  *                   inneholde 5 posisjoner
6.31  *       100316 bof  Legg inn melding om at csv-fil ikke er klar ennå.
6.32  *       060220 bof  Fjernet medling om at den ikke er klar ennå.
6.33  *       060220 bof  Standardmappe skal være PRIS_INN
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fJM740d    cf   e             workstn
      *
      * Definering av variable
      *
     d b_feil          s              1    inz(*off)
6.20 d w_leng          s              6  0
6.31 d w_mld1          s             50
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B1 Behandle åpningsbildet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Behandler bildet
      *
     c     b1taga        tag
      *
     c                   exfmt     b1bld
      *
      * Behandling av funksjonstaster
      *
     c                   if        *inkc or *inkl
     c                   goto      avslutt
     c                   endif
      *
     c                   if        b1filn = *blank
     c                   eval      *in31  = *on
     c                   exfmt     b1msg
     c                   goto      b1taga
     c                   endif
      *
     c                   if        b1kamp = *blank
     c                   eval      *in32  = *on
     c                   goto      b1taga
     c                   endif
      *
6.20 c                   eval      w_leng = %len(%trim(b1kamp))
6.20 c                   if        w_leng > 5
6.20 c                   eval      *in33  = *on
6.20 c                   goto      b1taga
6.20 c                   endif
6.32 c*                  if        b1csvf = 1
6.32 c*                  eval      w_mld1 = 'CSV-filen er ikke kl+
6.32 c*                                      ar,kommer i løpet av +
6.32 c*                                      VER 6.30.'
6.32 c*                  call      'AA005R'
6.32 c*                  parm                    w_mld1
6.32 c*                  goto      b1taga
6.32 c*                  endif
      *
      * Kaller program for henting av data, avbryter dersom feil
      *
     c                   if        b1fldr = *blank
6.33 c                   eval      b1fldr = 'PRIS_INN'
     c                   endif
      *
     c                   call      'JM740C'
     c                   parm                    b1fldr
     c                   parm                    b1filn
     c                   parm                    b_feil
      *
     c                   if        b_feil = *on
     c                   exfmt     b1msg
     c                   goto      b1taga
     c                   endif
      *
      * Kaller styreprogram
      *
6.30 c                   if        b1csvf = 1
6.30 c                   call      'JM742R'
6.30 c                   parm                    b1kamp
6.30 c                   else
     c                   call      'JM741R'
     c                   parm                    b1kamp
6.30 c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Initierer skjermbildet
      *
6.33 c                   eval      b1fldr = 'PRIS_INN'
      *
     c                   endsr
