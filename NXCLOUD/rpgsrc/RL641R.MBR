      /TITLE  Hjelperegister for kontoutdrag
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RL641R                                              *
      * Beskrivelse . . : Bygging av hjelpe-register for kontoutdrag          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
 6.20 * R6.20     080911  Rekompilert pga endring i RPARRKDS            *NHO
      *                                                                       *
      *                                                                       *
      *                                                                       *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frlevl1    if   e           k disk    rename(rlevpfr:rlevl1r)
     frlw1pf    o  a e           k disk
      *
      /eject
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * Data struktur
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      *
     d                 ds
     d wkwrec                  2    192
     d  wlfirm                        3  0 overlay(wkwrec)
     d  wllevr                        6  0 overlay(wkwrec:4)
     d  wlnavn                       30    overlay(wkwrec:10)
      *
     d bruddx          s              1
     d w_alfa          s                   like(rlalfa)
     d n               s              2  0
     d tstkt           s              7  0
      *
     d w_firm          s                   like(rlfirm)
      *
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * LOCAL DATA
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d/COPY QCPYLESRC,RPARRKDS
      /eject
      *
      * Leser leverandør-register
      *
     c                   move      l_firm        w_firm
     c     rlevl1_key    setll     rlevl1
     c     rlevl1_key    reade     rlevl1                                 60
      *
     c                   dow       *in60 = *off
      *
      * Seleksjon av ønsket avdeling
      *
     c                   if        rlavde < pavdf or
     c                             rlavde > pavdt and
     c                             pavdt > 0
     c                   goto      neste
     c                   endif
      *
      * Seleksjon av ønsket kategori
      *
     c                   if        rlkatg < pkatf or
     c                             rlkatg > pkatt and
     c                             pkatt > 0
     c                   goto      neste
     c                   endif
      *
      * Leverandøren ligger innenfor fra - til
      *
     c                   if        rllevr >= pknrf and
     c                             rllevr <= pknrt
     c                   goto      skriv_levr
     c                   endif
      *
      * Sjekk om enkeltleverandør er valgt
      *
     c                   if        tstkt = *zeros                                        .....
     c                   goto      neste                                                     .
     c                   endif                                                           .....
      *
      * Leverandørnr. ligger utenfor fra - til
      * sjekk mot tabell
      *
     c                   eval      n = 1
     c                   dou       n > 10                                                .....
      *                                                                 .
     c                   if        kun(n) <> *zeros                                          .
      *                                                                 .
     c                   if        rllevr = kun(n)                                           .
     c                   goto      skriv_levr                                                .
     c                   endif                                                               .
      *                                                                 .
     c                   endif                                                               .
      *                                                                 .
     c                   eval      n = n + 1                                                 .
     c                   enddo                                                           .....
      *
      * Konto heller ikke i tabell -
      * les neste postering
      *
     c                   goto      neste
      *
     c     skriv_levr    tag
      *
     c                   eval      w_alfa = rlalfa                              Alfa-felt
      * - Sortering
     c                   if        psort = ' '
     c                   eval      w_alfa = *blank
     c                   endif
      *
      * - Skal det være brudd-sum?
      *
     c                   if        bruddx <> *blank
     c                   eval      rwkniv = *zeros
      *
      * - Avdelings-sum                                   Avdeling
      *
     c                   if        pavds = 'J'
     c                   eval      rwkniv = rlavde                              Brudd
     c                   endif
      *
      * - Kategori-sum                                    Kategori
      *
     c                   if        pkats = 'J'
     c                   eval      rwkniv = rlkatg                              Brudd
     c                   endif
      *
     c                   endif
      *
      * Legg ut leverandør
      *
     c                   eval      rwkfir = w_firm
     c                   eval      wlnavn = rlnavn                              levretekst
     c                   eval      wllevr = rllevr                              levre
     c                   move      wkwrec        rwkrec
      *
      * Legg ut sorteringsbegrep
      *
     c                   eval      rwksal = *zeros
     c                   eval      rwkalf = w_alfa
     c                   eval      rwkknr = rllevr
      *
     c                   write     rlw1pfr                                      Legger ut
      *
     c     neste         tag
      *
     c     rlevl1_key    reade     rlevl1                                 60
     c                   enddo                                                     fordeling
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
      *                                                      trans
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      wkwrec = *zeros
      *
     c                   eval      w_firm = l_firm
      *
      * Skal det være brudd-sum
      *
     c                   if        pavds <> *blank
     c                   movel     'X'           bruddx
     c                   endif
      *
     c                   if        pkats <> *blank
     c                   movel     'X'           bruddx
     c                   endif
      *
      * Sjekk om tabell er utfylt
      *
     c                   xfoot     kun           tstkt
      *
     c     rlevl1_key    klist
     c                   kfld                    w_firm
      *
     c                   endsr
