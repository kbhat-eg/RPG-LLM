      /TITLE  ASOFAK: Skriver hylle etiketter
     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FP221R
      * Beskrivelse . . : Skriver hylle etiketter på laser
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * V5.50 170406 KOB  Nytt program
      * V5.50 030507 KOB  Utvidet lagerplass til 8 poisjoner
6.30  * 6.30  280514 BKV  LVAR økt fra 15 til 20
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fvaw1pf    if   f  512    64aidisk
     ffp221p    o    e             printer oflind(*in30)
      *
      *************************  T A B E L L E R  ************************
      *
     d evnr            s              8    dim(3)                               Eget varenummer
     d eanr            s             13    dim(3)                               EAN-nummer
     d vtx1            s             35    dim(3)                               Varetekst 1
     d vtx2            s             35    dim(3)                               Varetekst 2
     d enh1            s              3    dim(3)                               Enhet 1
     d pri1            s              8    dim(3)                               Pris 1
     d enh2            s              3    dim(3)                               Enhet 2
     d pri2            s              8    dim(3)                               Pris 2
     d senh            s              3    dim(3)                               Sammenligningsenhet
     d spri            s              8    dim(3)                               Pris sammenlign.enh
     d pkod            s              5    dim(3)                               Priskode
     d vtyp            s              1    dim(3)                               Varetype
     *
      * Definering av variable
      *
     d n               s              1  0
      *
     ivaw1pf    ns  01
      *
     i                                  1    4 0vaanta                          Antall etiketter
     i                                  5   19  vattxt                          Tekst fra fastreg.
     i                                 20   25  vatvar                          Varenr. (Fast tekst)
     i                                 26   32  vatpri                          Pris (Fast tekst)
     i                                 33   37  vatenh                          Enhet (Fast tekst)
     i                                 38   45  vadato                          Dato
     i                                 46   53  vanobb                          Nobb varenr.
     i                                 59   66  vavare                          Eget varenr.
     i                                 74   86  vaeann                          EAN nummer
     i                                 87  101  valvar                          Leverandørens varenr
6.30 i                                107  141  vatek1                          Varetekst 1
6.30 i                                142  176  vatek2                          Varetekst 2
6.30 i                                177  179  vaenh1                          Salgsenhet 1
6.30 i                                180  187  vapri1                          Pris salgsenhet 1
6.30 i                                188  190  vaenh2                          Salgsenhet 2
6.30 i                                191  198  vapri2                          Pris salgsenhet 2
6.30 i                                199  203  vabesk                          Tekst priskode
6.30 i                                204  208 0vabpun                          Bestillingspunkt
6.30 i                                209  213 0vabmen                          Bestillingsmengde
6.30 i                                214  214 0vahyle                          Type etikett
6.30 i                                215  215 0valvko                          Skriv i div. felt
6.30 i                                216  223  vaplas                          Lagerplass
6.30 i                                224  224 0vaetyp                          Etikettype
6.30 i                                225  227  vamini                          Minimumsbeholdn.(L)
6.30 i                                228  230  vamaks                          Maksimumbeholdn.(L)
6.30 i                                231  231  vavtyp                          Varetype
6.30 i                                232  234  vaenin                          Bestillingsenhet
6.30 i                                235  237  vaenps                          Sammenligningsenhet
6.30 i                                238  245  vapspr                          Pris sammenligning
      *
     i                                256  256  vadumy
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   read      vaw1pf                                 61
      *
     c                   dow       *in61 = *off
      *
      * Sjekk om riktig etikettype
      *
     c                   if        vaetyp <> 5
     c                   goto      neste
     c                   endif
      *
     c                   eval      n = n + 1
     c                   eval      evnr(n) = vavare
     c                   eval      eanr(n) = vaeann
     c                   eval      vtx1(n) = vatek1
     c                   eval      vtx2(n) = vatek2
     c                   eval      enh1(n) = vaenh1
     c                   eval      pri1(n) = vapri1
     c                   eval      enh2(n) = vaenh2
     c                   eval      pri2(n) = vapri2
     c                   eval      senh(n) = vaenps
     c                   eval      spri(n) = vapspr
     c                   eval      pkod(n) = vabesk
     c                   eval      vtyp(n) = vavtyp
      *
      * Skriv etiketter
      *
     c                   if        n = 3                                                     .
     c                   eval      d1evnr = evnr(1)
     c                   eval      d1eanr = eanr(1)
     c                   eval      d1vtx1 = vtx1(1)
     c                   eval      d1vtx2 = vtx2(1)
     c                   eval      d1enh1 = enh1(1)
     c                   eval      d1pri1 = pri1(1)
     c                   eval      d1enh2 = enh2(1)
     c                   eval      d1pri2 = pri2(1)
     c                   eval      d1senh = senh(1)
     c                   eval      d1spri = spri(1)
     c                   eval      d1pkod = pkod(1)
     c                   eval      d1vtyp = vtyp(1)
      *
     c                   eval      d2evnr = evnr(2)
     c                   eval      d2eanr = eanr(2)
     c                   eval      d2vtx1 = vtx1(2)
     c                   eval      d2vtx2 = vtx2(2)
     c                   eval      d2enh1 = enh1(2)
     c                   eval      d2pri1 = pri1(2)
     c                   eval      d2enh2 = enh2(2)
     c                   eval      d2pri2 = pri2(2)
     c                   eval      d2senh = senh(2)
     c                   eval      d2spri = spri(2)
     c                   eval      d2pkod = pkod(2)
     c                   eval      d2vtyp = vtyp(2)
      *
     c                   eval      d3evnr = evnr(3)
     c                   eval      d3eanr = eanr(3)
     c                   eval      d3vtx1 = vtx1(3)
     c                   eval      d3vtx2 = vtx2(3)
     c                   eval      d3enh1 = enh1(3)
     c                   eval      d3pri1 = pri1(3)
     c                   eval      d3enh2 = enh2(3)
     c                   eval      d3pri2 = pri2(3)
     c                   eval      d3senh = senh(3)
     c                   eval      d3spri = spri(3)
     c                   eval      d3pkod = pkod(3)
     c                   eval      d3vtyp = vtyp(3)
      *
     c                   write     etikett                                                   .
      *
     c                   exsr      xnull                                                     .
     c                   endif
      *
     c     neste         tag
      *
     c                   read      vaw1pf                                 61
     c                   enddo
      *
      * Skriv gjenstående etiketter
      *
     c                   if        n > *zeros                                                .
     c                   eval      d1evnr = evnr(1)
     c                   eval      d1eanr = eanr(1)
     c                   eval      d1vtx1 = vtx1(1)
     c                   eval      d1vtx2 = vtx2(1)
     c                   eval      d1enh1 = enh1(1)
     c                   eval      d1pri1 = pri1(1)
     c                   eval      d1enh2 = enh2(1)
     c                   eval      d1pri2 = pri2(1)
     c                   eval      d1senh = senh(1)
     c                   eval      d1spri = spri(1)
     c                   eval      d1pkod = pkod(1)
     c                   eval      d1vtyp = vtyp(1)
     c                   endif                                                           .....
      *
     c                   if        n = 2                                                 .....
     c                   eval      d2evnr = evnr(2)
     c                   eval      d2eanr = eanr(2)
     c                   eval      d2vtx1 = vtx1(2)
     c                   eval      d2vtx2 = vtx2(2)
     c                   eval      d2enh1 = enh1(2)
     c                   eval      d2pri1 = pri1(2)
     c                   eval      d2enh2 = enh2(2)
     c                   eval      d2pri2 = pri2(2)
     c                   eval      d2senh = senh(2)
     c                   eval      d2spri = spri(2)
     c                   eval      d2pkod = pkod(2)
     c                   eval      d2vtyp = vtyp(2)
     c                   endif                                                           .....
      *
     c                   write     etikett                                                   .
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for nullstilling av tabeller                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xnull         begsr
      *                                                                 .
     c                   eval      n = 0                                                     .
     c                   eval      evnr = *blanks
     c                   eval      eanr = *blanks
     c                   eval      vtx1 = *blanks
     c                   eval      vtx2 = *blanks
     c                   eval      enh1 = *blanks
     c                   eval      pri1 = *blanks
     c                   eval      enh2 = *blanks
     c                   eval      pri2 = *blanks
     c                   eval      senh = *blanks
     c                   eval      spri = *blanks
     c                   eval      pkod = *blanks
     c                   eval      vtyp = *blanks
      *
     c                   eval      d2evnr = *blanks
     c                   eval      d2eanr = *blanks
     c                   eval      d2vtx1 = *blanks
     c                   eval      d2vtx2 = *blanks
     c                   eval      d2enh1 = *blanks
     c                   eval      d2pri1 = *blanks
     c                   eval      d2enh2 = *blanks
     c                   eval      d2pri2 = *blanks
     c                   eval      d2senh = *blanks
     c                   eval      d2spri = *blanks
     c                   eval      d2pkod = *blanks
     c                   eval      d2vtyp = *blanks
      *
     c                   eval      d3evnr = *blanks
     c                   eval      d3eanr = *blanks
     c                   eval      d3vtx1 = *blanks
     c                   eval      d3vtx2 = *blanks
     c                   eval      d3enh1 = *blanks
     c                   eval      d3pri1 = *blanks
     c                   eval      d3enh2 = *blanks
     c                   eval      d3pri2 = *blanks
     c                   eval      d3senh = *blanks
     c                   eval      d3spri = *blanks
     c                   eval      d3pkod = *blanks
     c                   eval      d3vtyp = *blanks
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c                   endsr
