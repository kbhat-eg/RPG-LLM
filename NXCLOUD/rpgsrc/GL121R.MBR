      /TITLE  GL121R Felles sekvensteller
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * System  . . . . : ASOKON                                        *
      * Program . . . . : GL121R                                        *
      * Beskrivelse . . : Felles sekvensteller                         g*
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.*
      * --------- ------  ----------------------------------------------*
      *           181194  Nytt program november-1994               RH   *
      *                                                                 *
      *                                                                 *
      *                                                                 *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KC = F3  = Exit                                           *
      *       KL = F12 = Annuller                                       *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fgl121d    cf   e             workstn
     fgustl1    uf a e           k disk
     fdirrem    if   e             disk
      *
      *
     d                 ds
     d dsdat1                         8  0
     d  dsuÅr1                        4  0 overlay(dsdat1)
     d  dsumn1                        2  0 overlay(dsdat1:5)
     d  dsuda1                        2  0 overlay(dsdat1:7)
      *
     d                 ds
     d dsdat2                         8  0
     d  dsuda2                        2  0 overlay(dsdat2)
     d  dsumn2                        2  0 overlay(dsdat2:3)
     d  dsuÅr2                        4  0 overlay(dsdat2:5)
      *
      * Datastruktur for å ta ut sist brukte sekvensteller fra DIRREM:
      *
     d                 ds
     d dsqrem                        80
     d  dsdase                        6  0 overlay(dsqrem:14)
     d  dsefse                        4  0 overlay(dsqrem:71)
      *
     d w_arow          s              2  0
     d w_acol          s              3  0
     d w_in12          s              1  0
     d w_lest          s              3
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Kommentarer til program.                                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Programmet vedlikeholder file GUSTPF, felles sekvensteller.
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * A1BLD  - A1 Registrering av foretaksnummer
      * A2BLD  - A2 Vedlikehold av teller.
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Test på parameterinformasjon.                                   *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a1tag         tag
      *
      * Hent opp informasjon
      *
     c     key01         chain     gustl1                             60
      *
      * Legger over tellerverdier til skjermbildet.
      *
     c                   eval      a1usb1 = gdusb1
     c                   eval      a1usb2 = gdusb2
      *
     c                   eval      dsdat1 = gdudat
     c                   eval      dsuÅr2 = dsuÅr1
     c                   eval      dsumn2 = dsumn1
     c                   eval      dsuda2 = dsuda1
     c                   eval      a1udat = dsdat2
      *
     c                   eval      a1utim = gdutim
      *
     c                   exfmt     d1win
      *
      * Avslutt program ved F3 eller F12.
      *
     c     *inkc         cabeq     *on           xslutt
      *
      * Henter sist brukte sekvensteller:
      *
     c                   if        *inkk = *on                                    ...        .
      *                                                        .
      * Det er kun den første posten av DIRREM (sekvensiell)   .
      * filen som er aktuell å lese, d.v.s. det skal kun ut-   .
      * føres en les av filen.  Dette styres v.h.a. hjelpe-    .
      * feltet w_LEST:                                         .
      *                                                        .
     c                   if        w_lest = 'NEI'                                 o .
     c                   read      dirrem                                 60      o .
     c                   move      gdqrem        dsqrem                           o .
     c                   movel     'JA '         w_lest                           o .
     c                   endif                                                    o .
      *                                                        .
     c                   eval      e1dase = dsdase - 1                              .
     c                   eval      e1efse = dsefse - 1                              .
      *                                                        .
     c                   eval      w_arow = 10                                      .
     c                   eval      w_acol = 37                                      .
     c                   exfmt     e1win                                            .
     c                   eval      w_arow = 4                                       .
     c                   eval      w_acol = 37                                      .
      *                                                        .
     c                   goto      a1tag                                            .        .
      *                                                        .
     c                   endif                                                    ...        .
      *
      * Lagrer nye verdier.
      *
     c     key01         chain     gustl1                             60
      *
     c                   eval      gdusb1 = a1usb1
     c                   eval      gdusb2 = a1usb2
      *
     c                   if        *in60 = *on
     c                   eval      gdufor = a1ufor
     c                   write     gustpfr
     c                   else
     c                   update    gustpfr
     c                   endif
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    a1ufor
     c                   parm                    w_in12
      *
     c                   eval      w_in12 = 0
     c                   eval      w_arow = 4
     c                   eval      w_acol = 37
     c                   movel     'NEI'         w_lest
      *
      * Key for faste data - RAA7PF
      *
     c     key01         klist
     c                   kfld                    a1ufor
      *
     c                   endsr
