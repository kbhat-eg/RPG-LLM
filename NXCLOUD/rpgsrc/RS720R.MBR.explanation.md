# Overview  
This RPG IV (ILE) program (`RS720R`) validates whether a given account group code (`p_tkod`) exists in the file `RA20L1R`. It sets a status flag (`p_stat`) and message text (`p_ttxt`) accordingly.

---

## 1. File Declaration  
```
     fra20l1    if   e           k disk    rename(ra20pfr:ra20l1r)
```
- `fra20l1`  
  • Input file spec  
  • External (`e`), keyed (`k`), disk file  
- File is renamed from `RA20PFR` to `RA20L1R` in this program  

### Key List for `RA20L1R`  
Defined in the subroutine:  
```rpg
     ra20l1_key    klist
       kfld w_firm
       kfld ra20l1_tkod
```
- Composite key consists of:
  1. `w_firm` (company number)  
  2. `ra20l1_tkod` (the code to look up)

---

## 2. Data Definitions  
```rpg
d w_firm          s                   like(ratfir)
d p_stat          s              1
d p_tkod          s                   like(ratkod)
d p_ttxt          s                   like(rattxt)
d ra20l1_tkod     s                   like(ratkod)
```
- **w_firm**: Working field for company (from external indicator `l_firm`)
- **p_stat**: Output status code (1 char)  
  • ‘N’ = not found  
  • Blank = found  
- **p_tkod**: Input code to validate  
- **p_ttxt**: Output text message  
- **ra20l1_tkod**: Local copy of `p_tkod` for file keying

Also defined (unused in logic shown):  
```rpg
d l_user   911    920
d l_firm   944    946  0
d l_fnav   951    980
```

---

## 3. Main Logic Flow  
1. **Load the key**  
   ```rpg
   eval ra20l1_tkod = p_tkod
   ```
2. **Attempt Chain (random access)**  
   ```rpg
   chain ra20l1r ra20l1_key 60
   ```
   - Uses indicators **60-61** as file status indicators
3. **Check indicator 60**  
   ```rpg
   if *in60 = *on
     eval p_stat = 'N'
     eval p_ttxt = 'Koden er ugyldig  '   // “Code is invalid”
   else
     eval p_stat = *blank
     eval p_ttxt = rattxt  // Text from the RA20L1R record
   endif
   ```
   - **\*in60 = \*on** means the record was *not* found  
   - Sets `p_stat` and `p_ttxt` accordingly  
4. **End and Return**  
   ```rpg
   tag slutt
     eval *inlr = *on
     return
   ```
   - `*inlr = *on` ends the program and closes files  

---

## 4. Initialization Subroutine  
```rpg
c     *inzsr  begsr
  eval w_firm = l_firm
c     *entry  plist
      parm p_stat
      parm p_tkod
      parm p_ttxt
c     ra20l1_key klist
      kfld w_firm
      kfld ra20l1_tkod
c     endsr
```
- **\*INZSR** is automatically called before main logic  
- Initializes `w_firm` from external indicator field `l_firm`  
- Defines the parameter list (`p_stat`, `p_tkod`, `p_ttxt`) for callers  

---

## 5. Usage Notes  
- Call this program via **CALLP** or **EXSR** passing three parameters:  
  1. `p_stat` (output)  
  2. `p_tkod` (input)  
  3. `p_ttxt` (output)  
- After return, check `p_stat`:  
  - Blank → valid code (`p_ttxt` contains description)  
  - ‘N’   → invalid code (`p_ttxt` = “Koden er ugyldig”)