     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RL675R                                              *
      * Beskrivelse . . : Leverandørposter - utskrift av reklamasjoner        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
T5.30 * R5.30 090704 HFL  Valg av bare åpne poster eller alle.                *
T5.30 *                   Skriver restbeløp.                                  *
T5.30 * V5.30 140904 HFL  Kan skrive kladdeblokk.
T5.40 * V5.40 170605 HFL  Leser RKLAL2 i stedet for RKLALU.
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frltrl1    if   e           k disk    rename(rltrpfr:rltrl1r)
     frlevl1    if   e           k disk    rename(rlevpfr:rlevl1r)
E5.40frklal2    if   e           k disk    rename(rklapfr:rklal2r)
     frl675p    o    e             printer oflind(*in30)
      *
     d                uds
T5.30d l_klad                301    301
     d  l_wsid               901    910
     d  l_user               911    920
     d  l_fgrp               931    933
     d  l_firm               944    946  0
     d  l_fnav               951    980
      *
     d w_firm          s              3  0
     d rlevl1_levr     s                   like(rolevr)
     d n               s              3  0
T5.30d w_type          s              1
T5.30d w_syst          s                   like(rxsyst)
T5.30d w_pros          s                   like(rxpros)
T5.30d w_akti          s                   like(rxakti)
T5.30d w_kont          s                   like(rxkont)
T5.30d s_levr          s                   like(rllevr)
      *
     d                 ds
     d w6bdat                         6  0
     d  w6bdag                        2  0 overlay(w6bdat)
     d  w6bmnd                        2  0 overlay(w6bdat:3)
     d  w6baar                        2  0 overlay(w6bdat:5)
      *
     c     dummy         tag
      *
      * Les leverandørposter
      *
     c     rltrl1_key    setll     rltrl1r                                60
     c     rltrl1_key    reade     rltrl1r                                60
      *
     c                   dow       *in60 = *off
      *
      * Sjekk om reklamasjon
      *
     c                   if        robilk <> 89 and
     c                             rorekl = *blank
     c                   goto      neste
     c                   endif
      *
T5.30c                   if        w_type = 'J' and
T5.30c                             rorest = *zeros
T5.30c                   goto      neste
T5.30c                   endif
      *
T5.30 * Ved brudd på kunde, sjekkes det om kladdebok skal skrives
      *
T5.30c                   if        rolevr <> s_levr and
T5.30c                             s_levr <> *zeros
T5.30c                   if        l_klad = 'J'
T5.30c                   exsr      kladde
T5.30c                   endif
T5.30c                   endif
      *
      * Sjekker om overflow
      *
     c                   if        *in30 = *on                                               .
     c                   write     a1hdr                                                     .
     c                   eval      *in30 = *off                                              .
     c                   endif                                                           .....
      *
     c     *dmy          move      robdat        d1bdat
      *
     c                   eval      d1belo = robelØ
T5.30c                   eval      d1rest = rorest
      *
     c                   move      rolevr        rlevl1_levr
     c     rlevl1_key    chain     rlevl1r                              61
      *
     c                   write     d1det
T5.30c                   eval      s_levr = rolevr
      *
     c     neste         tag
      *
     c     rltrl1_key    reade     rltrl1r                                60
     c                   enddo
      *
     c     slutt         tag
      *
T5.30 * Kladdeblokk på sist skrevne leverandør?
      *
T5.30c                   if        l_klad = 'J'
T5.30c                   exsr      kladde
T5.30c                   endif
     c                   eval      *inlr = *on
      *
T5.30 * Subrutine for kladdeblokk                                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
T5.30c     kladde        begsr
T5.30 * Finnes notatblokk på kunden?
      *
T5.30c                   eval      w_syst = 'L'                                              .
T5.30c                   eval      w_pros = *zeros                                           .
T5.30c                   eval      w_akti = *blanks                                          .
T5.30c                   eval      w_kont = s_levr                                           .
E5.40c     keynot        setll     rklal2                                 60
      *
T5.30c                   if        *in60 = *on
      *
E5.40c     keynot        reade     rklal2                                 61
T5.30c                   dow       *in61 = *off
T5.30c                   eval      wnotat = rxtext
      *
T5.30 * Sjekker om overflow
      *
T5.30c                   if        *in30 = *on                                               .
T5.30c                   write     a1hdr                                                     .
T5.30c                   eval      *in30 = *off                                              .
T5.30c                   endif                                                           .....
T5.30c                   write     notatb                                                    .
E5.40c     keynot        reade     rklal2                                 61
T5.30c                   enddo                                                           .....
T5.30c                   endif                                                               .
T5.30c                   endsr
     c/eject
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
T5.30c     *entry        plist
T5.30c                   parm                    w_type
      *
T5.30c                   if        w_type = 'J'
T5.30c                   eval      wtekst = 'Bare åpne poster'
T5.30c                   else
T5.30c                   eval      wtekst = *blanks
T5.30c                   endif
      *
     c     rlevl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevl1_levr
      *
     c     rltrl1_key    klist
     c                   kfld                    w_firm
      *
T5.30 * Key for notatblokk
      *
T5.30c     keynot        klist
T5.30c                   kfld                    w_firm
T5.30c                   kfld                    w_syst
T5.30c                   kfld                    W_pros
T5.30c                   kfld                    W_akti
T5.30c                   kfld                    W_kont
T5.30c*                  kfld                    w_spes
T5.30c*                  kfld                    w_avde
T5.30c*                  kfld                    w_linj
      *
     c                   move      l_firm        w_firm
      *
     c                   write     a1hdr                                                     .
      *
     c                   endsr
      *
