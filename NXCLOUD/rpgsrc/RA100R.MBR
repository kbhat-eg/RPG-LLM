      /TITLE  Vedlikehold koder fellesprogram
     H datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Program . . . . : RA100R
      * Beskrivelse . . : Vedlikehold koder fellesprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.
      * --------- ------  ----------------------------------------------------
      *                   Nytt program april 94                     AMD
      * V5.41     281005  Lagt inn støtte for mobiloperatør         KOB
PRGR  * V5.70     021008  Lagt inn støtte for priskoder             BOF
6.30  * V6.30     270314  Utidet med forsendelsesmåte bestilling    BOF
7.xx  * 7.00  010316 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
7.01  * V7.01     200819  Lagt inn støtte for returkoder            NHO
7.02  * V6.30 sst 120218  Adgangskontroll på kodetyper som vedlikeholdes
7.03  * V6.30 sst 200319  Justering av kall til adgangskontroll på valgs
8.01  * 800   ask 021221  Reorganisert skjermbilde og lagt inn kredittgrense
8.02  * 800   ask 090322 Lagt inn vedlikehold av roller på kontaktpersoner
8.03  * 800   ask 061022 Lagt vedlikehold av ekterne lager
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       10 = Roll                                                 *
      *       12 = Sfldsp                                               *
      *       13 = Sfldspctl                                            *
      *       14 = Sflclr                                               *
      *       15 = Sflend                                               *
      *       16 = Readc 16 on, no more records                         *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fra100d    cf   e             workstn
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d wpakod          s              2  0
     d wpatxt          s             20
     d wpbtxt          s             20
     d wpctx1          s             20
     d wpctx2          s             20
     d wpetxt          s             20
     d wpfirm          s              3  0
     d wpftxt          s             20
     d wpgtxt          s             20
     d wphtxt          s             20
     d wpitxt          s             20
     d wpjtxt          s             20
     d wpktxt          s              2  0
     d wpk01a          s              1
     d wpk02a          s              2
     d wpk02n          s              2  0
     d wpk03a          s              3
     d wpk03n          s              3  0
     d wpk04n          s              4  0
     d wpltxt          s             20
     d wpmtxt          s             20
     d wpntxt          s             20
     d wpotxt          s             20
     d wppmna          s             20
     d wpqtxt          s             20
     d wprtx1          s             20
     d wprtx2          s             20
     d wprtx3          s             20
     d wpstxt          s             20
     d wpttxt          s             20
     d wputxt          s             20
     d wpvtxt          s             20
     d wpwtxt          s             20
     d wpxtxt          s             20
     d w_firm          s                   like(l_firm)
      *
7.02 d w_tilgko        s             10
7.02 d w_felt          s             10
7.02 d w_rutine        s             10
7.02 d w_adv           s              3
7.02 d w_status        s             10
      *
     c     dummy         tag
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * A2BLD  - A2 Åpningsbilde for valg av kodetype
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A2BLD Behandle bilde for valg av kodetype                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a2taga        tag
      *
      * Nullstille
      *
     c                   eval      a2valg = 0
      *
      * Bare data
      *
     c     a2tagb        tag
     c                   exfmt     a2bld
      *
      * Gå ut
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * Er kode for
      * valg lik 0
      *
     c                   if        a2valg = *zero                                        .....
     c                   move      *on           *in31                                       .
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Er kode for
      * valg ugyldig
      *
     c                   if        a2valg <> 01                                          .....
     c                             and a2valg <> 02                                          .
     c                             and a2valg <> 03                                          .
     c                             and a2valg <> 04                                          .
     c                             and a2valg <> 05                                          .
     c                             and a2valg <> 06                                          .
     c                             and a2valg <> 07                                          .
     c                             and a2valg <> 08                                          .
     c                             and a2valg <> 09                                          .
     c                             and a2valg <> 10                                          .
     c                             and a2valg <> 11                                          .
     c                             and a2valg <> 12                                          .
     c                             and a2valg <> 13                                          .
     c                             and a2valg <> 14                                          .
     c                             and a2valg <> 15                                          .
     c                             and a2valg <> 16                                          .
     c                             and a2valg <> 17                                          .
     c                             and a2valg <> 18                                          .
     c                             and a2valg <> 19                                          .
     c                             and a2valg <> 20                                          .
     c                             and a2valg <> 21                                          .
     c                             and a2valg <> 22                                          .
     c                             and a2valg <> 23                                          .
     c                             and a2valg <> 24                                          .
     c                             and a2valg <> 25                                          .
     c                             and a2valg <> 26                                          .
     c                             and a2valg <> 27                                          .
     c                             and a2valg <> 28                                          .
     c                             and a2valg <> 29                                          .
     c                             and a2valg <> 30                                          .
6.30 c                             and a2valg <> 31                                          .
7.01 c                             and a2valg <> 32                                          .
8.01 c                             and a2valg <> 33                                          .
8.02 c                             and a2valg <> 34                                          .
8.03 c                             and a2valg <> 37                                          .
     c                   move      *on           *in31                                       .
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
7.02 c                   eval      w_tilgko = l_user
7.02 c                   eval      w_rutine = 'RA100R'
7.02 c                   eval      w_status = *blank
7.03 c**                 movel     a2valg        w_adv
7.03 c                   move      a2valg        w_adv
7.02 c                   call      'AD005R'
7.02 c                   parm                    w_tilgko
7.02 c                   parm                    w_rutine
7.02 c                   parm                    w_adv
7.02 c                   parm                    w_status
7.02 c                   if        w_status <> 'Ok'
7.02 c                   goto      a2tagb
7.02 c                   endif
      *
      * Call program for
      * bilagskoder
      *
     c                   if        a2valg = 01                                           .....
     c                   call      'RA101R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpatxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * betalingsmåte
      *
     c                   if        a2valg = 02                                           .....
     c                   call      'RA102R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpbtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * betalingsbetingelse
      *
     c                   if        a2valg = 03                                           .....
     c                   call      'RA103R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpctx1
     c                   parm                    wpctx2
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * faste konti
      *
     c                   if        a2valg = 04                                           .....
     c                   call      'RA104R'                                                  .
     c                   parm                    w_firm                                      .
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * MVA - koder
      *
     c                   if        a2valg = 05                                           .....
     c                   call      'RA105R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk01a                                      .
     c                   parm                    wpetxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * Rabattkategori
      *
     c                   if        a2valg = 06                                           .....
     c                   call      'RA106R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk03n                                      .
     c                   parm                    wpftxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * avdeling
      *
     c                   if        a2valg = 07                                           .....
     c                   call      'RA107R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk04n                                      .
     c                   parm                    wpgtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * distrikt
      *
     c                   if        a2valg = 08                                           .....
     c                   call      'RA108R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wphtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * selger
      *
     c                   if        a2valg = 09                                           .....
     c                   call      'RA109R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpitxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * lager
      *
     c                   if        a2valg = 10                                           .....
     c                   call      'RA110R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpjtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * kundekategori
      *
     c                   if        a2valg = 11                                           .....
     c                   call      'RA111R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpktxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * land
      *
     c                   if        a2valg = 12                                           .....
     c                   call      'RA112R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk03n                                      .
     c                   parm                    wpltxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * fordelingsnøkler
      *
     c                   if        a2valg = 13                                           .....
     c                   call      'RA113R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpmtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * leverandørkategori
      *
     c                   if        a2valg = 14                                           .....
     c                   call      'RA114R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpntxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * mengde
      *
     c                   if        a2valg = 15                                           .....
     c                   call      'RA115R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpotxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * valutakurser
      *
     c                   if        a2valg = 16                                           .....
     c                   call      'RA116R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk03a                                      .
     c                   parm                    wppmna
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * forsendelsesmåte
      *
     c                   if        a2valg = 17                                           .....
     c                   call      'RA117R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpqtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * leveringsbetingelse
      *
     c                   if        a2valg = 18                                           .....
     c                   call      'RA118R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wprtx1
     c                   parm                    wprtx2
     c                   parm                    wprtx3
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * kontoklasse
      *
     c                   if        a2valg = 19                                           .....
     c                   call      'RA119R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpstxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * kontogruppe
      *
     c                   if        a2valg = 20                                           .....
     c                   call      'RA120R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02n                                      .
     c                   parm                    wpttxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * aktivitet
      *
     c                   if        a2valg = 21                                           .....
     c                   call      'RA121R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk03a                                      .
     c                   parm                    wputxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * speditør
      *
     c                   if        a2valg = 22                                           .....
     c                   call      'RA122R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk03n                                      .
     c                   parm                    wpvtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * virksomhet
      *
     c                   if        a2valg = 23                                           .....
     c                   call      'RA123R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpwtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * reklamasjonsårsak
      *
     c                   if        a2valg = 24                                           .....
     c                   call      'RA124R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * kjørerute
      *
     c                   if        a2valg = 25                                           .....
     c                   call      'RA125R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * saksbehandler
      *
     c                   if        a2valg = 26                                           .....
     c                   call      'RA126R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * kostnadsbærergruppe
      *
     c                   if        a2valg = 27                                           .....
     c                   call      'RA127R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * kostnadsbærer
      *
     c                   if        a2valg = 28                                           .....
     c                   call      'RA128R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * mobiloperatør
      *
     c                   if        a2valg = 29                                           .....
     c                   call      'RA129R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk02a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
      *
      * Call program for
      * prisgrupper
      *
     c                   if        a2valg = 30                                           .....
     c                   call      'RA130R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    wpk01a                                      .
     c                   parm                    wpxtxt
     c                   goto      a2tagb                                                    .
     c                   endif                                                           .....
6.30  *
6.30  * Call program for
6.30  * prisgrupper
6.30  *
6.30 c                   if        a2valg = 31                                           .....
6.30 c                   call      'RA131R'                                                  .
6.30 c                   parm                    w_firm                                      .
6.30 c                   parm                    wpk01a                                      .
6.30 c                   parm                    wpxtxt
6.30 c                   goto      a2tagb                                                    .
6.30 c                   endif                                                           .....
7.01  *
7.01  * Call program for
7.01  * returer
7.01  *
7.01 c                   if        a2valg = 32                                           .....
7.01 c                   call      'RA150R'                                                  .
7.01 c                   parm                    w_firm                                      .
7.01 c                   parm                    wpk01a                                      .
7.01 c                   parm                    wpxtxt
7.01 c                   goto      a2tagb                                                    .
7.01 c                   endif                                                           .....
8.01  *
8.01  * Call program for
8.01  * kretittgrenser
8.01  *
8.01 c                   if        a2valg = 33                                           .....
8.01 c                   call      'RA133R'                                                  .
8.01 c                   parm                    w_firm                                      .
8.01 c                   goto      a2tagb                                                    .
8.01 c                   endif                                                           .....
8.02  *
8.02  * Call program for
8.02  * roller på kontaktpersoner
8.02  *
8.02 c                   if        a2valg = 34                                           .....
8.02 c                   call      'RA135R'                                                  .
8.02 c                   parm                    w_firm                                      .
8.02 c                   goto      a2tagb                                                    .
8.02 c                   endif                                                           .....
8.02  *
8.02  * Call program for
8.02  * vedlikehold av eksterne lager
8.02  *
8.02 c                   if        a2valg = 37                                           .....
8.02 c                   call      'RA137R'                                                  .
8.02 c                   parm                    w_firm                                      .
8.02 c                   goto      a2tagb                                                    .
8.02 c                   endif                                                           .....
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      wpfirm = *zero
     c                   eval      wpakod = *zero
     c                   eval      wpk02n = *zero
     c                   eval      wpk03n = *zero
     c                   eval      wpk04n = *zero
     c                   eval      wpk01a = *blank
     c                   eval      wpk02a = *blank
     c                   eval      wpk03a = *blank
      *
      *
      * Legge inn firma-
      * nummer og navn
      * fra parameter
      *
     c                   move      l_firm        w_firm
      *
      * Initiere felter
      *
     c                   eval      a2valg = *zero
      *
     c                   endsr
