     h option(*nodebugio) datedit(*dmy) decedit(',') DFTACTGRP(*NO) ACTGRP(*NEW)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Definering av parametre
      *
     d  p_filg         s             10a
     d  p_firm         s              3a
     d  p_numm         s              6a
     d  p_suff         s              2a
     d  p_type         s              1a
     d  p_addr         s             30a
     d  p_port         s              5a
      *
     d  w_errrun       s              1s 0 INZ(0)
      *
5.62  * Datastruktur for informasjon ved exceptions
      *
     d PgmError       sds
     d  proc_name        *proc
     d  pgm_status       *STATUS
     d  prv_status            16     20s 0
     d  line_numm             21     28
     d  routine          *ROUTINE
     d  parms            *PARMS
     d  excp_type             40     42
     d  excp_numm             43     46
     d  pgm_lib               81     90
     d  excp_data             91    170
     d  excp_id              171    174
     d  date                 191    198
     d  year                 199    200s 0
     d  last_file            201    208
     d  file_info            209    243
     d  job_name             244    253
     d  job_user             254    263
     d  job_numb             264    269s 0
      *
      *
      *
     D  MsgInfo        s            512a
     D  MsgInfoLen     s             10i 0
     D  FormatName     s              8a   INZ('RCVM0100')
     D  CallStackEntr  s             10a   INZ('*')
     D  CallStackCtr   s             10i 0 INZ(*ZERO)
     D  MsgType        s             10a   INZ('*EXCP')
     D  MsgKey         s              4a   INZ(*BLANKS)
     D  WaitTime       s             10i 0 INZ(*ZERO)
     D  MsgAction      s             10a   INZ('*OLD')
     D  ErrorStruct    s              8a   inz(x'0000000000001000')
      *
      * Variabler
      *
      * w_link         s            512a
      * w_consts       s             10i 0
     d  w_head         s            180a
     d  w_text         s            512a
     d  w_ttyp         s              1a
      *
     d DataQ           S             10a   inz('PROADTAQ')
     d Library         S             10a   inz('*LIBL')
     d text            s            200a
     d DataLen         s              5  0 inz(200)
      *
      * Konstanter
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      text = '{collectprinterinfo}'
     c                   eval      DataLen = %len(%trim(text))
     c                   eval      Library = p_filg
     c                   call      'QSNDDTAQ'
     c                   parm                    DataQ
     c                   parm                    Library
     c                   parm                    DataLen
     c                   parm                    text
      *
      * Avslutt
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * Sette error text iht siste melding
      *
     c     seterrtxt     begsr
      *
     c                   eval      w_errrun = 1
      *
     c                   eval      MsgInfoLen = %size(MsgInfo)
     c                   call      'QMHRCVPM'
     c                   parm                    MsgInfo
     c                   parm                    MsgInfoLen
     c                   parm                    FormatName
     c                   parm                    CallStackEntr
     c                   parm                    CallStackCtr
     c                   parm                    MsgType
     c                   parm                    MsgKey
     c                   parm                    WaitTime
     c                   parm                    MsgAction
     c                   parm                    ErrorStruct
      *
     c                   eval      w_text = %trim(%subst(MsgInfo : 96 : 300))
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Feilrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *pssr         begsr
      *
     c*                  if        w_errrun = 0
     c*                  exsr      seterrtxt
     c*                  endif
      *
      * Skippe MSGW
     c*                  goto      avslutt
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parameter
      *
     c     *entry        plist
     c                   parm                    p_filg
     c*                  parm                    p_firm
     c*                  parm                    p_numm
     c*                  parm                    p_suff
     c*                  parm                    p_type
     c*                  parm                    p_addr
     c*                  parm                    p_port
      *
     c                   endsr
