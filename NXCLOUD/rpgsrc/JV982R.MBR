      /TITLE  Fix : konv. noen spes. tegn på jvarpf
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  System  . . . . : ASVADM
      *  Program . . . . : jv981R
      *  Beskrivelse . . : Leser hele JVARPF og konv. spes.tegn som
      *                    skaper problemer
      *                    Denne leter først etter tegn før den oppdatere
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      *  Referanse  Dato   Endringsbeskrivelse                     Sign.
      * --------- ------  --------------------------------------------------
      *           081111  Nytt program                             BOF
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
     fjvarlu    uf   e           k disk    rename(jvarpfr:jvarlur)
      *
     d jvarlu_vare     s                   like(jvvare)
     d w_tek1          s                   like(jvtek1)
     d w_tek2          s                   like(jvtek2)
     d pos1            s              4  0
     d pos2            s              4  0
     d b_sokfl         s              1    inz(*off)
      *
      *  UDS Local Data Area
      *
     d                uds
     d l_firm                944    946  0
      *
      *  Definering av variable i nøkler
      *
      *
      *  Definering av variable
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      *  Lese file
      *
     c                   read      jvarl1                                 90
     c                   dow       *in90 = *off
      *
      * søker er "
      *
     c     sok_fler1     tag
     c                   eval      pos1 = %scan('&hy':jvtek1)
     c                   eval      pos2 = %scan('&hy':jvtek2)
     c                   if        pos1 > 0 or
     c                             pos2 > 0
     c                   eval      jvarlu_vare = jvvare
     c     jvarlu_key    chain     jvarlu
     c                   if        %found(jvarlu)
     c                   if        pos1 > 0
     c                   eval      w_tek1 = *blank
     c                   if        pos1 < 30
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"' +
     c                                      %subst(jvtek1:pos1+6)
     c                   else
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"'
     c                   endif
     c                   eval      jvtek1 = w_tek1
     c                   endif
     c                   if        pos2 > 0
     c                   eval      w_tek2 = *blank
     c                   if        pos2 < 30
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"' +
     c                                      %subst(jvtek2:pos2+6)
     c                   else
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"'
     c                   endif
     c                   eval      jvtek2 = w_tek2
     c                   endif
     c                   update    jvarlur
     c                   goto      sok_fler1
     c                   endif
     c                   endif
      *
      *søker etter "
      *
     c     sok_fler2     tag
     c                   eval      pos1 = %scan('&quot;':jvtek1)
     c                   eval      pos2 = %scan('&quot;':jvtek2)
     c                   if        pos1 > 0 or
     c                             pos2 > 0
     c                   eval      jvarlu_vare = jvvare
     c     jvarlu_key    chain     jvarlu
     c                   if        %found(jvarlu)
     c                   if        pos1 > 0
     c                   eval      w_tek1 = *blank
     c                   if        pos1 < 30
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"' +
     c                                      %subst(jvtek1:pos1+6)
     c                   else
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"'
     c                   endif
     c                   eval      jvtek1 = w_tek1
     c                   endif
     c                   if        pos2 > 0
     c                   eval      w_tek2 = *blank
     c                   if        pos2 < 30
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"' +
     c                                      %subst(jvtek2:pos2+6)
     c                   else
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"'
     c                   endif
     c                   eval      jvtek2 = w_tek2
     c                   endif
     c                   update    jvarlur
     c                   goto      sok_fler2
     c                   endif
     c                   endif
      *
      *søker etter '
      *
     c     sok_fler3     tag
     c                   eval      pos1 = %scan('&apos;':jvtek1)
     c                   eval      pos2 = %scan('&apos;':jvtek2)
     c                   if        pos1 > 0 or
     c                             pos2 > 0
     c                   eval      jvarlu_vare = jvvare
     c     jvarlu_key    chain     jvarlu
     c                   if        %found(jvarlu)
     c                   if        pos1 > 0
     c                   eval      w_tek1 = *blank
     c                   if        pos1 < 30
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"' +
     c                                      %subst(jvtek1:pos1+6)
     c                   else
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"'
     c                   endif
     c                   eval      jvtek1 = w_tek1
     c                   endif
     c                   if        pos2 > 0
     c                   eval      w_tek2 = *blank
     c                   if        pos2 < 30
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"' +
     c                                      %subst(jvtek2:pos2+6)
     c                   else
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"'
     c                   endif
     c                   eval      jvtek2 = w_tek2
     c                   endif
     c                   update    jvarlur
     c                   goto      sok_fler3
     c                   endif
     c                   endif
      *
      *søker etter <
      *
     c     sok_fler4     tag
     c                   eval      pos1 = %scan('&lt;':jvtek1)
     c                   eval      pos2 = %scan('&lt;':jvtek2)
     c                   if        pos1 > 0 or
     c                             pos2 > 0
     c                   eval      jvarlu_vare = jvvare
     c     jvarlu_key    chain     jvarlu
     c                   if        %found(jvarlu)
     c                   if        pos1 > 0
     c                   eval      w_tek1 = *blank
     c                   if        pos1 < 32
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"' +
     c                                      %subst(jvtek1:pos1+4)
     c                   else
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"'
     c                   endif
     c                   eval      jvtek1 = w_tek1
     c                   endif
     c                   if        pos2 > 0
     c                   eval      w_tek2 = *blank
     c                   if        pos2 < 32
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"' +
     c                                      %subst(jvtek2:pos2+4)
     c                   else
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"'
     c                   endif
     c                   eval      jvtek2 = w_tek2
     c                   endif
     c                   update    jvarlur
     c                   goto      sok_fler4
     c                   endif
     c                   endif
      *
      *søker etter >
      *
     c     sok_fler5     tag
     c                   eval      pos1 = %scan('&gt;':jvtek1)
     c                   eval      pos2 = %scan('&gt;':jvtek2)
     c                   if        pos1 > 0 or
     c                             pos2 > 0
     c                   eval      jvarlu_vare = jvvare
     c     jvarlu_key    chain     jvarlu
     c                   if        %found(jvarlu)
     c                   if        pos1 > 0
     c                   eval      w_tek1 = *blank
     c                   if        pos1 < 32
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"' +
     c                                      %subst(jvtek1:pos1+4)
     c                   else
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"'
     c                   endif
     c                   eval      jvtek1 = w_tek1
     c                   endif
     c                   if        pos2 > 0
     c                   eval      w_tek2 = *blank
     c                   if        pos2 < 32
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"' +
     c                                      %subst(jvtek2:pos2+4)
     c                   else
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"'
     c                   endif
     c                   eval      jvtek2 = w_tek2
     c                   endif
     c                   update    jvarlur
     c                   goto      sok_fler5
     c                   endif
     c                   endif
      *
      *søker etter &
      *
     c     sok_fler6     tag
     c                   eval      pos1 = %scan('&amp;':jvtek1)
     c                   eval      pos2 = %scan('&amp;':jvtek2)
     c                   if        pos1 > 0 or
     c                             pos2 > 0
     c                   eval      jvarlu_vare = jvvare
     c     jvarlu_key    chain     jvarlu
     c                   if        %found(jvarlu)
     c                   if        pos1 > 0
     c                   eval      w_tek1 = *blank
     c                   if        pos1 < 31
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"' +
     c                                      %subst(jvtek1:pos1+5)
     c                   else
     c                   eval      w_tek1 = %subst(jvtek1:1:pos1-1) + '"'
     c                   endif
     c                   eval      jvtek1 = w_tek1
     c                   endif
     c                   if        pos2 > 0
     c                   eval      w_tek2 = *blank
     c                   if        pos2 < 31
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"' +
     c                                      %subst(jvtek2:pos2+5)
     c                   else
     c                   eval      w_tek2 = %subst(jvtek2:1:pos2-1) + '"'
     c                   endif
     c                   eval      jvtek2 = w_tek2
     c                   endif
     c                   update    jvarlur
     c                   goto      sok_fler6
     c                   endif
     c                   endif
      *
      *
     c                   read      jvarl1                                 90
     c                   enddo
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for oppdatering av vare
      *
     c     jvarlu_key    klist
     c                   kfld                    jvarlu_vare
      *
      *
      *  Legge inn opplysninger i nøklene
      *
      *
     c                   endsr
