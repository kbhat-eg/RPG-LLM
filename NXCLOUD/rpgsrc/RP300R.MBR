     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOKON
      * Program . . . . : rp300R
      * Beskrivelse . . : Prosjekt, vedlikehold 2013 -
      *
      * Spesialversjon. :             Prosj.leder
      * Tilpasset for . :             opprettet dato
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       191218 sst  Nytt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *       10 = Rollup
      *       11 = Rolldown
      *       12 = Sfldsp
      *       13 = Sfldspctl
      *       14 = Sflclr
      *       15 = Sflend
      *       21 = Home-key
      *       22 = Plassering av cursor
      *       30 = Protect av felter ved vise
      *    31-79 = Varsle m/feilmeldinger/skjermindikatorer
      *    80-99 = Arbeidsindikatorer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     frpxll1    if   e           k disk    rename(rpxlpfr:rpxll1r)
     frpxllr    if   e           k disk    rename(rpxlpfr:rpxllrr)
     frpxllu    uf a e           k disk    rename(rpxlpfr:rpxllur)
     frp1plu    uf a e           k disk    rename(rp1ppfr:rp1plur)
     frp2ulu    uf a e           k disk    rename(rp2upfr:rp2ulur)
     frp3alu    uf a e           k disk    rename(rp3apfr:rp3alur)
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     filonl1    if   e           k disk    rename(ilonpfr:ilonl1r)
     fra07l1    if   e           k disk    rename(ra07pfr:ra07l1r)
6.34 fra09l1    if   e           k disk    rename(ra09pfr:ra09l1r)
     frprrl1    if   e           k disk    rename(rprrpfr:rprrl1r)
6.22 frhtrlc    if   e           k disk    rename(rhtrpfr:rhtrlcr)
6.22 fausrl1    if   e           k disk    rename(ausrpfr:ausrl1r)
6.22 ffusrl1    if   e           k disk    rename(fusrpfr:fusrl1r)
      *
     frp300d    cf   e             workstn sfile(b1sfl:w_srrn)
     f                                     infds(dspfbk)
      *
4.44 d lo              c                   'abcdefghijklmnopqrstuvwxyzæøå'
4.44 d up              c                   'ABCDEFGHIJKLMNOPQRSTUVWXYZÆØÅ'
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av Information Data Structure - display feedback
      *
     d dspfbk          ds
     d  d_fcrn               378    379I 0
      *
      * Definering av variabler i nøkler
      *
     d rpxll1_user     s                   like(d_user)
     d rpxll1_ppro     s                   like(d_ppro)
     d rpxll1_uupr     s                   like(d_uupr)
     d rpxll1_aakt     s                   like(d_aakt)
     d rpxllr_user     s                   like(d_user)
     d rpxllr_ppro     s                   like(d_ppro)
     d rpxllr_uupr     s                   like(d_uupr)
     d rpxllr_aakt     s                   like(d_aakt)
     d rpxllu_user     s                   like(d_user)
     d rpxllu_ppro     s                   like(d_ppro)
     d rpxllu_uupr     s                   like(d_uupr)
     d rpxllu_aakt     s                   like(d_aakt)
     d rp1plu_pros     s                   like(rp1pro)
     d rp2ulu_pros     s                   like(rp2pro)
     d rp2ulu_upro     s                   like(rp2upr)
     d rp3alu_pros     s                   like(rp3pro)
     d rp3alu_upro     s                   like(rp3upr)
     d rp3alu_akti     s                   like(rp3akt)
     d rkunl1_kund     s                   like(rkkund)
     d ilonl1_kli      s                   like(ilrkli)
     d ilonl1_lnr      s                   like(ilrlnr)
6.34 d ra09l1_fir      s                   like(raifir)
6.34 d ra09l1_kod      s                   like(raikod)
     d ra07l1_frm      s                   like(ragfir)
     d ra07l1_kod      s                   like(ragkod)
     d rprrl1_fir      s                   like(rphfir)
     d rprrl1_rap      s                   like(rphrap)
     d rprrl1_lin      s                   like(rphlin)
     d rprrl1_uli      s                   like(rphuli)
6.22 d rhtrlc_fir      s                   like(rbfirm)
6.22 d rhtrlc_pro      s                   like(rbhpro)
6.22 d fusrl1_fir      s                   like(fbfirm)
6.22 d fusrl1_usr      s                   like(fbuser)
6.22 d ausrl1_usr      s                   like(abuser)
      *
      * Definering av variable
      *
     d w_fcrn          s              4  0
     d w_stel          s              4  0
     d w_spge          s              4  0
     d w_srrn          s              4  0
     d w_sfrn          s                   like(w_srrn)
     d w_ssrn          s                   like(w_srrn)
      *
     d w_seqe          s              1
     d b_forn          s              1    inz(*off)
     d b_oppr          s              1    inz(*off)
     d b_anul          s              1    inz(*off)
     d b_feil          s              1    inz(*off)
     d b_subf          s              1    inz(*off)
      *
     d w_firm          s              3  0
     d s_ppro          s                   like(d_ppro)
     d s_uupr          s                   like(d_uupr)
     d s_aakt          s                   like(d_aakt)
      *
     d w_pknr          s                   like(rkkund)
     d w_pkna          s                   like(rknavn)
     d w_dato          s             10
     d w_datd          s                   like(rp1fsd)
     d w_datx          s             10
     d w_datn          s              6  0
     d w_lnr           s                   like(ilrlnr)
6.34 d w_lnr4          s              4  0
     d w_lnav          s                   like(ilrnav)
     d p_avd           s                   like(ilravd)
     d p_tx30          s             30
     d p_rapx          s              4
     d w_fper          s              6  0
     d p_rapt          s             30
     d p_firm          s              3
     d w3avde          s              4
     d w3prol          s              5
6.22 d w_sumi          s              8  0
6.22 d w_sumix         s             11  0
6.22 d w_sumk          s              8  0
6.22 d w_sumkx         s             11  0
6.22 d w_buo           s              8  0
6.22 d w_but           s              8  0
     d w_rest          s              8  0
     d w_ppro          s              8  0
6.22 d w_mld1          s             50
6.22 d w_stat          s              1
6.22 d w_spor          s              1    inz('5')
6.22 d w_endr          s              1    inz('2')
     d w_a51           s              1  0 inz(0)
     d w_tilgko        s             10
     d w_rutine        s             10
     d w_adv           s              3
     d w_status        s             10
     d w_upro          s                   like(d_ppro)
     d                                      inz(' ')
     d w_blank         s                   like(d_ppro)
     d                                      inz(' ')
6.34  * w_prlslg styr om Pr.leder hentes fra prosj.leder(P) eller selger(S)
6.34 d w_prlslg        s              1    inz('S')
     d w_1alf          s                   like(rp1alf)
     d w_fm            s                   like(d_feil)
     d i               s              3  0
     d w_feil          s                   like(d_feil)
     d w_fase          s              1    inz('S')
     d w_ftyp          s              1    inz('p')
     d w_feildato      s              1         inz(*off)
     d w_dx            s             10
     d w_dat           s              6  0
     d w_dax           s              6
     d w_iso           s               d        datfmt(*iso)
      *
      * Definering av konstanter
      *
     d c_sfil          s              2  0 inz(14)
      *
      * Forklaring på spesielle felter
      * som benyttes ved sub-files.
      * - - - - - - - - - - - - - - - - -
      * w_fcrn - Første recordnummer på siden
      * w_stel - Subfile-teller
      * w_spge - Sidestørrelse i subfile (page)
      * w_srrn - Relativt recordnummer i subfile
      * w_sfrn - Første recordnummer på siste side
      * w_ssrn - Siste recordnummer på siste side
      * w_curn - Current recordnummer på siden
      * w_virn - Side og cursorplassering som skal vises
      * w_afld - Aktivt feltnavn
      * w_arow - Aktiv rad for cursor
      * w_acol - Aktiv kolonne for cursor
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      * B1SFL  - B1 Subfile - record
      * B2CTL  - B2 Subfile - control record
      * B2CMD  - B2 Eget skjermbilde for CMD-taster
      * C1BLD  - C1 Skjermbilde for innlegging av nøkkel ved oppretting
      * C1MSG  - C1 Meldingsbilde for C1BLD
      * C2BLD  - C2 Skjermbilde for opprette/endre/vise
      * D1WIN  - D1 Vindu for slette (Delete)
      * K1WIN  - K1 Vindu for kopiere
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B2CTL Behandle åpningsbildet med subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Send Alt
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * Bare data
      *
     c     b2tagb        tag
      *
     c                   exsr      dsp_subfile
      *
      * Behandling av funksjonstaster
      *
     c                   select
     c                   when      *inkc or *inkl
     c                   goto      avslutt
     c                   when      *inke
     c                   exsr      forny
     c                   goto      b2tagb
     c                   when      *inkf
     c                   exsr      xc1bld
     c                   goto      b2taga
     c                   when      *inkk
     c                   select
     c                   when      w_a51 = 0
7.xx c                   eval      b2hea1 = 'Budsj.Innt.'
7.xx c                   eval      b2hea2 = 'Budsj.Kost.'
7.xx c                   eval      b2hea3 = '   Inntekt'
7.xx c                   eval      b2hea4 = '   Kostnad'
     c                   eval      w_a51 = 1
     c                   when      w_a51 = 1
7.xx c                   eval      b2hea1 = 'Budsj.Innt.'
7.xx c                   eval      b2hea2 = 'Virk.Innt.'
7.xx c                   eval      b2hea3 = ' Gjennstår'
7.xx c                   eval      b2hea4 = '  Utført %'
     c                   eval      w_a51 = 2
     c                   when      w_a51 = 2
7.xx c                   eval      b2hea1 = 'Budsj.Kost.'
7.xx c                   eval      b2hea2 = 'Virk.Kost.'
7.xx c                   eval      b2hea3 = ' Gjennstår'
7.xx c                   eval      b2hea4 = '  Utført %'
     c                   eval      w_a51 = 3
     c                   when      w_a51 = 3
7.xx c*                   eval      b2head = 'Fra dato    Til dato     -
7.xx c*                             Avd.     Pr.leder'
7.xx c                   eval      b2hea1 = 'Fra dato'
7.xx c                   eval      b2hea2 = 'Til dato'
7.xx c                   eval      b2hea3 = 'Avd.'
7.xx c                   eval      b2hea4 = 'Pr.leder'
     c                   eval      w_a51 = 0
     c                   endsl
6.22 c                   exsr      forny
6.22 c                   goto      b2taga
      *  Hente prosjekt fra Excel
     c                   when      *inkm
     c                   call      'RP700C'
6.22 c                   exsr      forny
6.22 c                   goto      b2taga
     c                   when      *in10
     c                   exsr      crt_subfile
     c                   goto      b2tagb
     c                   when      *in21
     c                   eval      *in22 = *on
     c                   goto      b2taga
     c                   endsl
      *
      * Posisjonering
      *
     c                   if        b2pros <> *blank
     c                   exsr      posisjoner
     c                   goto      b2tagb
     c                   endif
      *
      * Behandling av subfile
      *
     c                   exsr      subfile
      *
     c*                  if        b_subf = *on
     c                   goto      b2taga
     c*                  endif
      *
      * Retur til første bilde
      *
     c                   goto      b2tagb
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for fornying av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     forny         begsr
      *
     c                   select
     c                   other
     c     rpxll1_key    setll     rpxll1
     c                   endsl
      *
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
     c     end_forny     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for posisjonering i subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     posisjoner    begsr
      *
      * Posisjoner startverdi på prosjekt
      *
     c                   if        b2pros <> *blank
     c                   eval      w_seqe = ' '
     c                   eval      rpxll1_ppro = b2pros
     c     rpxll1_key    setll     rpxll1
     c                   endif
      *
      * Posisjoner startverdi på teskt
      *
      * Blanker subfile, og fyller opp i.h.t. posisjonering
      *
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
      * Blanker posisjoneringsfelter
      *
     c                   eval      b2pros = *blank
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     subfile       begsr
      *
     c                   eval      b_forn = *off
     c                   eval      b_subf = *off
      *
     c                   eval      w_virn = w_fcrn
      *
      * Leser og behandler subfile
      *
     c                   do        w_ssrn
     c                   readc     b1sfl                                  16
      *
     c                   if        *in16
     c                   leave
     c                   endif
      *
     c                   eval      b_subf = *on
     c                   eval      w_virn = w_srrn
      *
      * Endre post
      *
     c                   if        b1valg = 2
     c                   eval      w_fase = 'S'
     c                   eval      c1pros = b1pros
     c                   eval      c1upro = b1upro
     c                   eval      c1akti = b1akti
     c                   exsr      xc2bld
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Kopiere post
      *
     c                   if        b1valg = 3
     c                   eval      k1pros = b1pros
     c                   exsr      xk1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Slette post
      *
     c                   if        b1valg = 4
     c                   eval      d1user = b1user
     c                   eval      d1pros = b1pros
     c                   eval      d1upro = b1upro
     c                   eval      d1akti = b1akti
     c                   exsr      xd1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Vise post
      *
     c                   if        b1valg = 5
     c                   eval      c1pros = b1pros
     c                   eval      c1upro = b1upro
     c                   eval      c1akti = b1akti
     c                   exsr      xc2bld
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Oppdatere Prosjekt
      *
     c                   if        b1valg = 6
     c                   eval      c1pros = b1pros
     c                   eval      c1upro = b1upro
     c                   eval      c1akti = b1akti
     c                   exsr      xc6bld
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
     c                   enddo
      *
     c*                  if        b_forn = *on
     c                   exsr      forny
     c*                  endif
      *
     c     end_subfile   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av skjermbilde for ny rad (C1BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc1bld        begsr
      *
     c                   eval      b_oppr = *on
     c                   eval      b_forn = *off
      *
     c                   eval      c1pros = *blank
      *
     c     c1taga        tag
      *
     c                   exfmt     c1bld
      *
      * Behandling av funksjonstaster
      *
     c                   select
     c                   when      *inkc or *inkl
     c                   goto      end_c1bld
     c                   endsl
      *
6.31 c                   if        c1pros = *blank
6.31 c                   goto      end_c1bld
6.31 c                   endif
      *
      * Validering
      *
      *
      * Sender opp informasjonsbilde dersom rad finnes fra før
      *
     c                   eval      rpxllr_ppro = c1pros
     c                   eval      rpxllr_uupr = c1upro
     c                   eval      rpxllr_aakt = c1akti
     c     rpxllr_key    chain     rpxllr
     c                   if        %found
     c                   exsr      xc1msg
     c                   if        b_anul = *on
     c                   goto      c1taga
     c                   endif
     c                   endif
      *
      * Kaller vedlikeholdsprogram
      *
     c                   eval      *in23 = *on
     c                   exsr      xc2bld
      *
     c     end_c1bld     tag
      *
     c                   if        b_forn = *on
     c                   exsr      forny
     c                   endif
      *
     c                   eval      b_oppr = *off
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for utlegging av opprettelsesmelding
      * Meldingsbildet legges ut dersom det forsøkes å opprette en rad som
      * finnes fra før.
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc1msg        begsr
      *
     c                   eval      b_anul = *off
      *
     c                   exfmt     c1msg
      *
      * Behandling av funksjonstaster
      *
     c                   if        *inkc or *inkl
     c                   eval      b_anul = *on
     c                   goto      end_c1msg
     c                   endif
      *
     c     end_c1msg     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å behandle bilde for ny/endring/vise (C2BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc2bld        begsr
      *
     c     nyFase        tag
     c                   select
     c                   when      w_fase = 'S'
     c                   eval      c2head = 'Prosjekt'
     c                   eval      w_fase = 'P'
     c                   eval      w_ftyp = 'p'
     c                   when      w_fase = 'P'
     c                             and d_pupr = 'J'
     c                   eval      w_fase = 'U'
     c                   eval      w_ftyp = 'u'
     c                   eval      c2head = 'UnderProsjekt'
     c                   when      w_fase = 'P'
     c                             and d_pakt = 'J'
     c                   eval      w_fase = 'A'
     c                   eval      w_ftyp = 'a'
     c                   eval      c2head = 'Aktivitet    '
     c                   when      w_fase = 'U'
     c                             and d_uakt = 'J'
     c                   eval      w_fase = 'A'
     c                   eval      w_ftyp = 'a'
     c                   eval      c2head = 'Aktivitet    '
     c                   other
     c                   goto      UppdSubf
     c                   endsl
     c                   eval      w_arow = 0
     c                   eval      w_acol = 0
      *
     c                   eval      rpxllr_user = l_user
     c                   eval      rpxllr_ppro = c1pros
     c                   eval      rpxllr_uupr = c1upro
     c                   eval      rpxllr_aakt = c1akti
     c     rpxllr_key    chain     rpxllr
      *
     c                   if        %found
     c                   select
     c                   when      w_fase = 'P'
     c                   eval      c2besk = d_ptxt
     c                   eval      c2fsd  = %char(d_pfra)
     c                   eval      c2fed  = %char(d_ptil)
     c                   eval      c2prl  = d_pprl
6.34 c                   if        w_PrlSlg = 'P'
     c                   eval      ilonl1_kli  = l_firm
     c                   eval      ilonl1_lnr  = %int(%trim(d_pprl))
     c     ilonl1_key    chain     ilonl1
     c                   if        %found(ilonl1)
     c                   eval      c2prx  = ilrnav
     c                   else
     c                   eval      c2prx  = *blank
     c                   endif
6.34 c                   else
6.34 c                   eval      ra09l1_fir  = l_firm
6.34 c                   eval      ra09l1_kod  = %int(%trim(d_pprl))
6.34 c     ra09l1_key    chain     ra09l1
6.34 c                   if        %found(ra09l1)
6.34 c                   eval      c2prx  = raitxt
6.34 c                   else
6.34 c                   eval      c2prx  = *blank
6.34 c                   endif
6.34 c                   endif
     c                   eval      c2avd  = d_pavd
     c                   eval      ra07l1_kod  = %int(%trim(d_pavd))
     c     ra07l1_key    chain     ra07l1
     c                   if        %found(ra07l1)
     c                   eval      c2avx  = ragtxt
     c                   else
     c                   eval      c2avx  = *blank
     c                   endif
     c                   eval      c2knr  = d_pknr
     c                   eval      rkunl1_kund = %int(%trim(d_pknr))
     c     rkunl1_key    chain     rkunl1
     c                   if        %found(rkunl1)
     c                   eval      c2kna  = rknavn
     c                   else
     c                   eval      c2kna  = *blank
     c                   endif
     c                   eval      c2buo  = d_pbin
6.22 c                   eval      c2but  = d_pbut
     c                   eval      c2pty  = d_ptyp
     c                   eval      c2sts  = d_psta
6.32 c                   eval      c2rup  = d_pupr
6.32 c                   eval      c2rak  = d_pakt
     c                   eval      c2eusr = l_user
     c     *dmy          move      d_dato        c2edat
      * <<<<<<<<<<<<
     c                   when      w_fase = 'U'
     c                   eval      c2besk = d_utxt
     c                   eval      c2fsd  = %char(d_ufra)
     c                   eval      c2fed  = %char(d_util)
     c                   eval      c2prl  = d_uprl
     c                   if        d_uprl > *blank
6.34 c                   if        w_PrlSlg = 'P'
     c                   eval      ilonl1_kli  = l_firm
     c                   eval      ilonl1_lnr  = %int(%trim(d_uprl))
     c     ilonl1_key    chain     ilonl1
     c                   if        %found(ilonl1)
     c                   eval      c2prx  = ilrnav
     c                   else
     c                   eval      c2prx  = *blank
     c                   endif
6.34 c                   else
6.34 c                   eval      ra09l1_fir  = l_firm
6.34 c                   eval      ra09l1_kod  = %int(%trim(d_uprl))
6.34 c     ra09l1_key    chain     ra09l1
6.34 c                   if        %found(ra09l1)
6.34 c                   eval      c2prx  = raitxt
6.34 c                   else
6.34 c                   eval      c2prx  = *blank
6.34 c                   endif
6.34 c                   endif
     c                   else
     c                   eval      c2prx = *blank
     c                   endif
      *
     c                   if        d_uavd <> *blank
     c                   eval      c2avd  = d_uavd
     c                   eval      ra07l1_kod  = %int(%trim(d_uavd))
     c     ra07l1_key    chain     ra07l1
     c                   if        %found(ra07l1)
     c                   eval      c2avx  = ragtxt
     c                   else
     c                   eval      c2avx  = *blank
     c                   endif
     c                   else
     c                   eval      c2avx = *blank
     c                   endif
      *
     c                   if        d_uknr > *blank
     c                   eval      c2knr  = d_uknr
     c                   eval      rkunl1_kund = %int(%trim(d_uknr))
     c     rkunl1_key    chain     rkunl1
     c                   if        %found(rkunl1)
     c                   eval      c2kna  = rknavn
     c                   else
     c                   eval      c2kna  = *blank
     c                   endif
     c                   else
     c                   eval      c2avx = *blank
     c                   endif
      *
     c                   eval      c2buo  = d_ubin
6.22 c                   eval      c2but  = d_ubut
     c                   eval      c2sts  = d_usta
6.32 c                   eval      c2rak  = d_uakt
     c                   eval      c2eusr = l_user
     c                   eval      c2krf  = d_ukrf
     c                   eval      c2tlf  = d_utlf
     c                   eval      c2epo  = d_uepo
     c     *dmy          move      d_dato        c2edat
     c                   when      w_fase = 'A'
     c                   eval      c2besk = d_atxt
     c                   eval      c2fsd  = %char(d_afra)
     c                   eval      c2fed  = %char(d_atil)
     c                   eval      c2prl  = d_aprl
     c                   if        d_aprl > *blank
6.34 c                   if        w_PrlSlg = 'P'
     c                   eval      ilonl1_kli  = l_firm
     c                   eval      ilonl1_lnr  = %int(%trim(d_aprl))
     c     ilonl1_key    chain     ilonl1
     c                   if        %found(ilonl1)
     c                   eval      c2prx  = ilrnav
     c                   else
     c                   eval      c2prx  = *blank
     c                   endif
6.34 c                   else
6.34 c                   eval      ra09l1_fir  = l_firm
6.34 c                   eval      ra09l1_kod  = %int(%trim(d_aprl))
6.34 c     ra09l1_key    chain     ra09l1
6.34 c                   if        %found(ra09l1)
6.34 c                   eval      c2prx  = raitxt
6.34 c                   else
6.34 c                   eval      c2prx  = *blank
6.34 c                   endif
6.34 c                   endif
6.34 c                   endif
      *
     c                   eval      c2avd  = d_aavd
     c                   if        d_aavd > *blank
     c                   eval      ra07l1_kod  = %int(%trim(d_aavd))
     c     ra07l1_key    chain     ra07l1
     c                   if        %found(ra07l1)
     c                   eval      c2avx  = ragtxt
     c                   else
     c                   eval      c2avx  = *blank
     c                   endif
     c                   endif
      *
     c                   eval      c2knr  = d_aknr
     c                   if        d_aknr > *blank
     c                   eval      rkunl1_kund = %int(%trim(d_aknr))
     c     rkunl1_key    chain     rkunl1
     c                   if        %found(rkunl1)
     c                   eval      c2kna  = rknavn
     c                   else
     c                   eval      c2kna  = *blank
     c                   endif
     c                   endif
      *
     c                   eval      c2buo  = d_abin
6.22 c                   eval      c2but  = d_abut
     c                   eval      c2sts  = d_asta
     c                   eval      c2eusr = l_user
     c                   eval      c2krf  = d_akrf
     c                   eval      c2tlf  = d_atlf
     c                   eval      c2epo  = d_aepo
     c     *dmy          move      d_dato        c2edat
     c                   endsl
      * <<<<<<<<<<<<
     c                   else
     c                   eval      c2besk = *blank
     c                   eval      c2fsd  = *blank
     c                   eval      c2fed  = *blank
     c                   eval      c2prl  = *blank
     c                   eval      c2avd  = *blank
     c                   eval      c2knr  = *blank
     c                   eval      c2pty  = *blank
     c                   eval      c2sts  = *blank
6.32 c                   eval      c2rup  = *blank
6.32 c                   eval      c2rak  = *blank
     c                   eval      c2buo  = *blank
6.22 c                   eval      c2but  = *blank
     c                   eval      c2kna  = *blank
     c                   eval      c2eusr = *blank
     c                   eval      c2edat = 0
     c                   eval      c2eusr = *blank
     c                   endif
      *
     c                   eval      *in52 = *off
     c                   eval      *in53 = *off
     c                   eval      *in54 = *off
     c                   eval      *in55 = *off
     c                   eval      *in56 = *off
     c                   eval      *in57 = *off
     c                   eval      *in58 = *off
     c                   eval      *in59 = *off
     c                   eval      *in60 = *off
     c                   eval      *in61 = *off
     c                   eval      *in62 = *off
     c                   eval      *in63 = *off
      *
     c                   eval      i = %scan('   ':d_feil)
     c                   eval      d_feil = %trim(d_feil) + ',,,'
     c                   dow       d_feil <> *blank
     c                             and %subst(d_feil:1:1) = w_ftyp
     c                   eval      i = %scan(',':d_feil)
     c                   eval      w_fm   = %trim(%subst(d_feil:1:i-1))
     c                   eval      d_feil = %subst(d_feil:i+1:100-i)
     c                   select
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '1 '
     c                   eval      *in52 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '2 '
     c                   eval      *in52 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '3 '
     c                   eval      *in52 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '4 '
     c                   eval      *in53 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '5 '
     c                   eval      *in54 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '6 '
     c                   eval      *in55 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '7 '
     c                   eval      *in56 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '8 '
     c                   eval      *in57 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '9 '
     c                   eval      *in58 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '10'
     c                   eval      *in59 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '11'
     c                   eval      *in59 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '12'
     c                   eval      *in60 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '13'
     c                   eval      *in61 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '14'
     c                   eval      *in62 = *on
     c                   when      %subst(w_fm:1:1) = w_ftyp
     c                             and %subst(w_fm:2:2) = '15'
     c                   eval      *in63 = *on
     c                   endsl
      *
     c                   enddo
      *
     c                   eval      w_feil = d_feil
      *
     c                   if        b1valg = 3
     c                   eval      c1pros = k1pros
     c                   endif
      *
     c                   if        b1valg = 5
     c                   eval      *in30 = *on
     c                   endif
      *
     c     c2tagb        tag
      *
     c                   exfmt     c2bld
      *
     c                   setoff                                       232425
     c                   setoff                                       262728
      *
     c                   if        *inkc or *in30
     c                   goto      end_c2bld
     c                   endif
      *
      * Spørring
      *
      *  Prosjektleder
     c                   if        *inkd = *on and
5.33 c                             w_afld = 'C2PRL '
     c                   eval      w_lnr       = *zero
     c                   eval      w_lnav      = *blank
6.34 c                   if        w_PrlSlg = 'P'
4.88 c                   call      'RP603R  '
4.55 c                   PARM                    w_firm
     c                   PARM                    w_lnr
     c                   PARM                    w_lnav
6.34 c                   else
6.34 c                   eval      w_lnr4 = *zero
6.34 c                   call      'RA509R  '
6.34 c                   PARM                    w_firm
6.34 c                   PARM                    w_lnr4
6.34 c                   PARM                    w_lnav
6.34 c                   eval      w_lnr = w_lnr4
6.34 c                   endif
     c                   if        w_lnr <> *zero
     c                   eval      c2prl  = %char(w_lnr)
     c                   eval      c2prx  = w_lnav
     c                   endif
     c                   goto      c2tagb
     c                   endif
      *  Avdeling
     c                   if        *inkd = *on and
5.33 c                             w_afld = 'C2AVD '
     c                   eval      p_avd       = *zero
     c                   eval      p_tx30      = *blank
4.88 c                   call      'RA507R  '
4.55 c                   PARM                    w_firm
     c                   PARM                    p_avd
     c                   PARM                    p_tx30
     c                   if        p_avd <> *zero
     c                   eval      c2avd  = %char(p_avd)
     c                   eval      c2avx  = p_tx30
     c                   endif
     c                   goto      c2tagb
     c                   endif
      *  Kunde
     c                   if        *inkd = *on and
5.33 c                             w_afld = 'C2KNR '
     c                   eval      w_pknr      = *zero
     c                   eval      w_pkna      = *blank
4.88 c                   call      'RK500R  '
4.55 c                   PARM                    w_firm
     c                   PARM                    w_pknr
     c                   PARM                    w_pkna
     c                   eval      c2knr  = %char(w_pknr)
     c                   eval      c2kna  = w_pkna
     c                   goto      c2tagb
     c                   endif
6.22  *  Spørring prosjektposter
6.22 c                   if        *inkg = *on
6.22 c                   call      'RP510R  '
6.22 c                   parm                    w_firm
6.22 c                   parm                    c1pros
6.22 c                   goto      c2tagb
6.22 c                   endif
      *
      * Validering av input
      *
     c                   if        c2besk = *blank
     c                   eval      *in23 = *on
     c                   goto      c2tagb
     c                   endif
      *  Start Dato
     c                   if        c2fsd = *blank
     c                             and w_fase = 'P'
     c                   eval      *in24 = *on
     c                   goto      c2tagb
     c                   endif
      *
     c                   if        c2fsd <> *blank
     c                   eval      w_dx   = c2fsd
     c                   eval      w_datn = *zero
     c                   exsr      reddato
      *
     c                   if        w_feildato = *on
     c                   eval      *in25 = *on
     c                   goto      c2tagb
     c                   else
     c                   move      w_dx          c2fsd
     c                   endif
     c                   endif
      *  Slutt Dato
     c                   if        c2fed = *blank
     c                             and w_fase = 'P'
     c                   eval      *in26 = *on
     c                   goto      c2tagb
     c                   endif
      *
     c                   if        c2fed <> *blank
     c                   eval      w_dx   = c2fed
     c                   eval      w_datn = *zero
     c                   exsr      reddato
      *
     c                   if        w_feildato = *on
     c                   eval      *in27 = *on
     c                   goto      c2tagb
     c                   else
     c                   move      w_dx          c2fed
     c                   endif
     c                   endif
6.22  *  Prosjektleder
6.22 c                   if        c2prl  <> *blank
     c                             and w_fase = 'P'
6.34 c                   if        w_PrlSlg = 'P'
6.22 c                   eval      ilonl1_kli  = l_firm
6.22 c                   eval      ilonl1_lnr  = %int(%trim(c2prl))
6.22 c     ilonl1_key    chain     ilonl1
6.22 c                   if        not %found(ilonl1)
6.22 c                   eval      c2prx  = ilrnav
6.22 c                   eval      *in37 = *on
6.22 c                   goto      c2tagb
6.22 c                   endif
6.34 c                   else
6.34 c                   eval      ra09l1_fir  = l_firm
6.34 c                   eval      ra09l1_kod  = %int(%trim(c2prl))
6.34 c     ra09l1_key    chain     ra09l1
6.34 c                   if        %found(ra09l1)
6.34 c                   eval      c2prx  = raitxt
6.34 c                   else
6.34 c                   eval      *in37 = *on
6.34 c                   goto      c2tagb
6.34 c                   endif
6.34 c                   endif
6.22 c                   endif
      *  Kunde
     c                   if        c2knr  = *blank
     c                             and w_fase = 'P'
     c                             and c2pty  = 'K'
     c                   eval      *in28 = *on
     c                   goto      c2tagb
     c                   endif
      *
     c                   if        c2knr  > *blank
     c                   eval      rkunl1_kund = %int(%trim(c2knr))
     c     rkunl1_key    chain     rkunl1
     c                   if        not %found(rkunl1)
     c                   eval      *in29 = *on
     c                   goto      c2tagb
     c                   endif
     c                   endif
      *  Prosjkettype
     c                   if        c2pty <> 'I '
     c                             and c2pty <> 'K '
     c                             and w_fase = 'P'
     c                   eval      *in35 = *on
     c                   goto      c2tagb
     c                   endif
      *  Prosjketstatus
     c                   if        c2sts <> 'A' and
     c                             c2sts <> 'O' and
     c                             c2sts <> ' '
     c                   eval      *in36 = *on
     c                   goto      c2tagb
     c                   endif
6.32  *  Bruk av underprosjekt
6.32 c                   if            w_fase = 'P'
6.32 c                             and c2rup <> 'J'
6.32 c                             and c2rup <> ' '
6.32 c                   eval      *in38 = *on
6.32 c                   goto      c2tagb
6.32 c                   endif
6.32  *  Bruk av aktivitet
6.32 c                   if            w_fase = 'P'
     c                             or  w_fase = 'U'
6.32 c                   if        c2rak <> 'J' and
6.32 c                             c2rak <> ' '
6.32 c                   eval      *in39 = *on
6.32 c                   goto      c2tagb
6.32 c                   endif
6.32 c                   endif
6.35  *
6.35  *  Ikke Budjsett dersom inndleing i underprosjekt eller aktivitet
6.35 c                   if        (w_fase = 'P'
6.35 c                              and (c2rup = 'J'
6.35 c                               or  c2rak = 'J')
6.35 c                             or   w_fase = 'U'
6.35 c                              and  c2rak = 'J')
6.35 c                             and (c2buo <> *blank
6.35 c                             or   c2but <> *blank)
6.35 c                   eval      *in40 = *on
6.35 c                   goto      c2tagb
6.35 c                   endif
      *
      * Oppdatering
      *
     c                   clear                   rpxllur
      *
     c                   eval      rpxllu_user = l_user
     c                   eval      rpxllu_ppro = c1pros
     c                   eval      rpxllu_uupr = c1upro
     c                   eval      rpxllu_aakt = c1akti
     c     rpxllu_key    chain     rpxllur
      *
     c                   select
     c                   when      w_fase = 'P'
     c                   eval      d_ptxt = c2besk
     c                   eval      d_pfra = c2fsd
     c                   eval      d_ptil = c2fed
     c                   eval      d_pprl = c2prl
     c                   eval      d_pavd = c2avd
     c                   eval      d_pknr = c2knr
     c                   eval      d_pbin = c2buo
6.22 c                   eval      d_pbut = c2but
     c                   eval      d_ptyp = c2pty
     c                   eval      d_psta = c2sts
6.32 c                   eval      d_pupr = c2rup
6.32 c                   eval      d_pakt = c2rak
6.32 c                   eval      d_feil = w_feil
     c                   when      w_fase = 'U'
     c                   eval      d_utxt = c2besk
     c                   eval      d_ufra = c2fsd
     c                   eval      d_util = c2fed
     c                   eval      d_uprl = c2prl
     c                   eval      d_uavd = c2avd
     c                   eval      d_uknr = c2knr
     c                   eval      d_ubin = c2buo
6.22 c                   eval      d_ubut = c2but
     c                   eval      d_usta = c2sts
6.32 c***                eval      d_uupr = c2rup
6.32 c                   eval      d_uakt = c2rak
     c                   eval      d_ukrf = c2krf
     c                   eval      d_utlf = c2tlf
     c                   eval      d_uepo = c2epo
6.32 c                   eval      d_feil = w_feil
     c                   when      w_fase = 'A'
     c                   eval      d_atxt = c2besk
     c                   eval      d_afra = c2fsd
     c                   eval      d_atil = c2fed
     c                   eval      d_aprl = c2prl
     c                   eval      d_aavd = c2avd
     c                   eval      d_aknr = c2knr
     c                   eval      d_abin = c2buo
6.22 c                   eval      d_abut = c2but
     c                   eval      d_asta = c2sts
6.32 c***                eval      d_aakt = c2rak
     c                   eval      d_akrf = c2krf
     c                   eval      d_atlf = c2tlf
     c                   eval      d_aepo = c2epo
6.32 c                   eval      d_feil = w_feil
     c                   endsl
      *
     c                   eval      d_user = l_user
      *
     c                   if        %found
     c                   update    rpxllur
     c                   else
     c                   eval      d_ppro = c1pros
6.36 c                   eval      d_uupr = c1upro
6.36 c                   eval      d_aakt = c1akti
     c                   time                    d_dato
     c                   eval      d_user = l_user
     c                   write     rpxllur
     c                   endif
      *
      * ________________________________________________________________
     c                   eval      c2besk = *blank
     c                   eval      c2fsd  = *blank
     c                   eval      c2fed  = *blank
     c                   eval      c2pty  = *blank
     c                   eval      c2prl  = *blank
     c                   eval      c2avd  = *blank
     c                   eval      c2knr  = *blank
     c                   eval      c2buo  = *blank
     c                   eval      c2but  = *blank
     c                   eval      c2sts  = *blank
     c                   eval      c2rup  = *blank
     c                   eval      c2rak  = *blank
     c                   eval      c2krf  = *blank
     c                   eval      c2tlf  = *blank
     c                   eval      c2epo  = *blank
     c                   goto      nyFase
      * ________________________________________________________________
     c     UppdSubf      tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = 2
     c                   eval      b1besk = d_ptxt
     c                   eval      b1fsd = d_pfra
     c                   eval      b1fed = d_ptil
     c                   eval      b1upro = d_uupr
     c                   eval      b1akti = d_aakt
     c                   endif
      *
     c                   if        b_oppr = *on or
     c                             b1valg = 3
     c                   eval      b_forn = *on
     c                   endif
      *
     c     end_c2bld     tag
      *
     c                   eval      *in30  = *off
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å oppdaterer Prosjetk til RP1P, RP2U og RP3A
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc6bld        begsr
      *
     c                   eval      rpxllu_user = l_user
     c                   eval      rpxllu_ppro = c1pros
     c                   eval      rpxllu_uupr = c1upro
     c                   eval      rpxllu_aakt = c1akti
     c     rpxllu_key    chain     rpxllu
      *
     c                   if        %found
      *   Prosjekt
     c                   eval      rp1plu_pros = d_ppro
     c     rp1plu_key    chain     rp1plu
     c                   if        not %found(rp1plu)
     c                   eval      rp1frm = l_firm
     c                   eval      rp1pro = d_ppro
     c                   eval      rp1txt = d_ptxt
     c                   move      d_pfra        rp1fsd
     c                   move      d_ptil        rp1fed
     c                   eval      rp1prl = %int(%trim(d_pprl))
     c                   eval      rp1avd = %int(%trim(d_pavd))
     c                   eval      rp1knr = %int(%trim(d_pknr))
     c*                  eval      rp1krf = d_pkrf
     c*                  eval      rp1krt = d_ptel
     c*                  eval      rp1krm = d_pepo
     c                   if        d_pbin <> *blank
     c                   eval      rp1buo = %int(%trim(d_pbin))
     c                   else
     c                   eval      rp1buo = *zero
     c                   endif
     c                   if        d_pbut <> *blank
     c                   eval      rp1but = %int(%trim(d_pbut))
     c                   else
6.22 c                   eval      rp1but = *zero
     c                   endif
     c                   eval      rp1pty = d_ptyp
     c                   eval      rp1sts = d_psta
6.32 c                   eval      rp1rup = d_pupr
6.32 c                   eval      rp1rak = d_pakt
     c                   eval      rp1eav = l_user
     c                   eval      rp1oav = l_user
     c                   time                    rp1eda
     c                   time                    rp1eti
     c                   time                    rp1oda
     c                   time                    rp1oti
     c                   write     rp1plur
     c                   endif
      *
      *   UnderProsjekt
     c                   eval      rp2ulu_pros = d_ppro
     c                   eval      rp2ulu_upro = d_uupr
     c     rp2ulu_key    chain     rp2ulu
     c                   if        not %found(rp2ulu)
     c                   eval      rp2frm = l_firm
     c                   eval      rp2pro = d_ppro
     c                   eval      rp2upr = d_uupr
     c                   eval      rp2txt = d_utxt
     c                   move      d_ufra        rp2fsd
     c                   move      d_util        rp2fed
     c                   if        d_uprl <> *blank
     c                   eval      rp2prl = %int(%trim(d_uprl))
     c                   else
     c                   eval      rp2prl = %int(%trim(d_pprl))
     c                   endif
     c                   if        d_uavd <> *blank
     c                   eval      rp2avd = %int(%trim(d_uavd))
     c                   else
     c                   eval      rp2avd = %int(%trim(d_pavd))
     c                   endif
     c                   if        d_uknr <> *blank
     c                   eval      rp2knr = %int(%trim(d_uknr))
     c                   else
     c                   eval      rp2knr = %int(%trim(d_pknr))
     c                   endif
     c                   eval      rp2krf = d_ukrf
     c                   eval      rp2krt = d_utlf
     c                   eval      rp2krm = d_uepo
     c                   if        d_ubin <> *blank
     c                   eval      rp2buo = %int(%trim(d_ubin))
     c                   else
     c                   eval      rp2buo = *zero
     c                   endif
     c                   if        d_ubut <> *blank
     c                   eval      rp2but = %int(%trim(d_ubut))
     c                   else
6.22 c                   eval      rp2but = *zero
     c                   endif
     c                   eval      rp2pty = d_ptyp
     c                   eval      rp2sts = d_usta
6.32 c                   eval      rp2rak = d_uakt
     c                   eval      rp2eav = l_user
     c                   eval      rp2oav = l_user
     c                   time                    rp2eda
     c                   time                    rp2eti
     c                   time                    rp2oda
     c                   time                    rp2oti
     c                   write     rp2ulur
     c                   endif
      *
      *   Aktivitet
     c                   eval      rp3alu_pros = d_ppro
     c                   eval      rp3alu_upro = d_uupr
     c                   eval      rp3alu_akti = d_aakt
     c     rp3alu_key    chain     rp3alu
     c                   if        not %found(rp3alu)
     c                   eval      rp3frm = l_firm
     c                   eval      rp3pro = d_ppro
     c                   eval      rp3upr = d_uupr
     c                   eval      rp3akt = d_aakt
     c                   eval      rp3txt = d_atxt
     c                   move      d_afra        rp3fsd
     c                   move      d_atil        rp3fed
     c                   select
     c                   when      d_aprl <> *blank
     c                   eval      rp3prl = %int(%trim(d_aprl))
     c                   when      d_uprl <> *blank
     c                   eval      rp3prl = %int(%trim(d_uprl))
     c                   other
     c                   eval      rp3prl = %int(%trim(d_pprl))
     c                   endsl
     c                   select
     c                   when      d_aavd <> *blank
     c                   eval      rp3avd = %int(%trim(d_aavd))
     c                   when      d_uavd <> *blank
     c                   eval      rp3avd = %int(%trim(d_uavd))
     c                   other
     c                   eval      rp3avd = %int(%trim(d_pavd))
     c                   endsl
     c                   select
     c                   when      d_aknr <> *blank
     c                   eval      rp3knr = %int(%trim(d_aknr))
     c                   when      d_uknr <> *blank
     c                   eval      rp3knr = %int(%trim(d_uknr))
     c                   other
     c                   eval      rp3knr = %int(%trim(d_pknr))
     c                   endsl
     c                   eval      rp3krf = d_akrf
     c                   eval      rp3krt = d_atlf
     c                   eval      rp3krm = d_aepo
     c                   if        d_abin <> *blank
     c                   eval      rp3buo = %int(%trim(d_abin))
     c                   else
     c                   eval      rp3buo = *zero
     c                   endif
     c                   if        d_abut <> *blank
     c                   eval      rp3but = %int(%trim(d_abut))
     c                   else
6.22 c                   eval      rp3but = *zero
     c                   endif
     c                   eval      rp3aty = d_ptyp
     c                   eval      rp3sts = d_asta
     c                   eval      rp3eav = l_user
     c                   eval      rp3oav = l_user
     c                   time                    rp3eda
     c                   time                    rp3eti
     c                   time                    rp3oda
     c                   time                    rp3oti
     c                   write     rp3alur
     c                   endif
      *
     c                   delete    rpxllur
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å redigere inntastet dato
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     reddato       begsr
      *
     c                   eval      w_feildato = *off
      *
      *  Er dato av format 'ddmmåå eller ååmmdd'?
     c                   select
     c                   when      %subst(w_dx:7:4) = *blank
     c                   if        %subst(w_dx:6:5) = *blank
     c                   eval      w_dat = %int(%trim(%subst(w_dx:1:5)))
     c                   else
     c                   eval      w_dat = %int(%trim(%subst(w_dx:1:6)))
     c                   endif
      *    Format ddmmyy eller yymmdd
     c     *dmy          test (d)                w_dat                  41
     c                   if        *in41 = *off
     c     *dmy          move      w_dat         w_iso
     c                   else
     c     *ymd          test (d)                w_dat                  41
     c                   if        *in41 = *off
     c     *ymd          move      w_dat         w_iso
     c                   else
     c                   eval      w_feildato = *on
     c                   endif
     c                   endif
     c                   leavesr
      *
     c     format_2      tag
      *  Er dato av format 'dd.mm.åå eller dd-mm-åå'?
     c                   when      %subst(w_dx:9:2) = *blank
     c                             and %subst(w_dx:7:2) > '17'
     c                             and %subst(w_dx:7:2) < '40'
     c                             and %subst(w_dx:1:2) < '32'
     c                             and (%subst(w_dx:3:1) = '.'
     c                              or  %subst(w_dx:3:1) = '-')
     c                   eval      w_dax = %subst(w_dx:1:2) +
     c                                     %subst(w_dx:4:2) +
     c                                     %subst(w_dx:7:2)
     c                   eval      w_dat = %int(w_dax)
     c     *dmy          test (d)                w_dat                  41
     c                   if        *in41 = *off
     c     *dmy          move      w_dat         w_iso
     c                   else
     c                   eval      w_feildato = *on
     c                   endif
     c                   leavesr
      *  __________________________________________________________________
      *  Er dato av format 'dd.mm.åååå eller dd-mm-åååå'?
     c                   when      %subst(w_dx:9:2) <> *blank
     c                             and %subst(w_dx:7:4) > '2000'
     c                             and %subst(w_dx:7:4) < '2040'
     c                             and (%subst(w_dx:3:1) = '.'
     c                              or  %subst(w_dx:3:1) = '-')
     c                   eval      w_dax = %subst(w_dx:1:2) +
     c                                     %subst(w_dx:4:2) +
     c                                     %subst(w_dx:9:2)
     c                   eval      w_dat = %int(w_dax)
     c     *dmy          test (d)                w_dat                  41
     c                   if        *in41 = *off
     c     *dmy          move      w_dat         w_iso
     c                   else
     c                   eval      w_feildato = *on
     c                   endif
     c                   leavesr
      *  __________________________________________________________________
      *  Er dato av format 'åååå.mm.dd eller åååå-mm-dd'?
     c                   when      %subst(w_dx:9:2) <> *blank
     c                             and %subst(w_dx:1:4) > '2000'
     c                             and %subst(w_dx:1:4) < '2040'
     c                             and (%subst(w_dx:5:1) = '.'
     c                              or  %subst(w_dx:5:1) = '-')
     c                   eval      w_dax = %subst(w_dx:9:2) +
     c                                     %subst(w_dx:6:2) +
     c                                     %subst(w_dx:3:2)
     c                   eval      w_dat = %int(w_dax)
     c     *dmy          test (d)                w_dat                  41
     c                   if        *in41 = *off
     c     *dmy          move      w_dat         w_iso
     c                   else
     c                   eval      w_feildato = *on
     c                   endif
     c                   leavesr
      *
     c                   other
     c                   goto      format_2
     c                   eval      w_feildato = *on
     c                   endsl
      *
     c     redend        endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av slette-bildet (D1WIN)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xd1win        begsr
      *
     c                   eval      rpxllr_ppro = d1pros
     c                   eval      rpxllr_uupr = d1upro
     c                   eval      rpxllr_aakt = d1akti
     c                   eval      rpxllr_user = d1user
     c     rpxllr_key    chain     rpxllr
      *
     c                   exfmt     d1win
      *
     c                   if        *inkc or *inkl
     c                   goto      end_d1win
     c                   endif
      *
     c                   eval      b_forn = *on
      *
      * Sletter rad
      *
     c                   eval      rpxllu_ppro = d1pros
     c                   eval      rpxllu_uupr = d1upro
     c                   eval      rpxllu_aakt = d1akti
     c                   eval      rpxllu_user = d1user
     c     rpxllu_key    chain     rpxllur
     c                   if        %found(rpxllu)
     c                   delete    rpxllur
     c                   endif
      *
     c     end_d1win     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å behandle kopierings-bildet (K1WIN)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xk1win        begsr
      *
      * Tar vare på nøkkel til rad det skal kopieres fra
      *
     c                   eval      s_ppro = k1pros
     c                   eval      s_uupr = k1upro
     c                   eval      s_aakt = k1akti
      *
      * Fyller kopierings-bildet
      *
     c                   eval      rpxllr_ppro = k1pros
     c     rpxllr_key    chain     rpxllr
      *
     c     k1tagb        tag
      *
     c                   exfmt     k1win
      *
     c                   if        *inkc or *inkl
     c                   goto      end_k1win
     c                   endif
      *
      * Sjekk om utfylt
      *
     c                   if        k1pros = *blank
     c                   eval      *in31 = *on
     c                   goto      k1tagb
     c                   endif
      *
      * Sjekker om rad finnes fra før
      *
     c                   eval      rpxllr_ppro = k1pros
     c     rpxllr_key    chain     rpxllr
     c                   if        %found
     c                   eval      *in33 = *on
     c                   goto      k1tagb
     c                   endif
      *
      * Kaller vedlikeholdsprogram
      *
     c                   eval      c1pros = s_ppro
     c                   eval      c1upro = s_uupr
     c                   eval      c1akti = s_aakt
     c                   exsr      xc2bld
      *
     c     end_k1win     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for tømming av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     clr_subfile   begsr
      *
     c                   eval      *in14 = *on
     c                   write     b2ctl
     c                   eval      *in14 = *off
      *
     c                   eval      *in15 = *off
     c                   eval      w_srrn = 0
     c                   eval      w_sfrn = 0
     c                   eval      w_ssrn = 0
     c                   eval      w_spge = 0
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å fylle opp subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     crt_subfile   begsr
      *    debug
     c                   eval      w_spge = w_spge + c_sfil
     c                   eval      w_srrn = w_ssrn
      *
     c                   dou       w_srrn = w_spge
      *
     c                   select
     c                   other
     c                   read      rpxll1                                 15
     c                   endsl
      *
5.61 c                   if        *in15
     c                   leave
     c                   endif
      *
     c                   eval      w_srrn = w_srrn + 1
      *
     c                   eval      b1valg = 0
     c                   eval      b1pros = d_ppro
     c                   eval      b1besk = d_ptxt
     c                   eval      b1fsd  = d_pfra
     c                   eval      b1fed  = d_ptil
     c                   eval      b1upro = d_uupr
     c                   eval      b1akti = d_aakt
     c                   eval      b1user = d_user
6.22 c                   eval      b1buo  = d_pbin
6.22 c                   eval      b1but  = d_pbut
     c                   eval      b1buo  = d_pbin
     c                   eval      b1but  = d_pbut
     c                   if        d_feil <> *blank
     c                             and %subst(d_feil:1:3) <> ',,,'
     c                   eval      *in51 = *on
     c                   else
     c                   eval      *in51 = *off
     c                   endif
     c**                 endif
6.22  *
     c                   select
     c                   when      w_a51  = 0
6.22  * dato informasjon
6.22 c                   eval      b1flt1 = *blank
6.22 c                   eval      b1flt2 = *blank
6.22 c                   eval      b1flt3 = *blank
6.22 c                   eval      b1flt4 = *blank
6.22 c                   if        b1fsd <> *loval
6.22 c**   *dmy          move      b1fsd         w_datn
6.22 c**                 eval      b1flt1 = %editw(w_datn : '  .  .  ')
6.22 c                   eval      b1flt1 = b1fsd
6.22 c                   endif
6.22 c                   if        b1fed <> *loval
6.22 c**   *dmy          move      b1fed         w_datn
6.22 c**                 eval      b1flt2 = %editw(w_datn : '  .  .  ')
6.22 c                   eval      b1flt2 = b1fed
6,22 c                   endif
     c**                 eval      b1flt3 = %editw(b1avd: '    0')
     c**                 eval      b1flt4 = %editw(b1prl: '    0')
     c                   eval      b1flt3 = b1upro
     c                   eval      b1flt4 = b1akti
      *
     c                   when      w_a51 = 1
6.22  * beløpsinformasjon
6.22 c                   eval      b1flt1 = *blank
6.22 c                   eval      b1flt2 = *blank
6.22 c                   eval      b1flt3 = *blank
6.22 c                   eval      b1flt4 = *blank
6.22 c                   exsr      finn_sum
6.22 c                   eval      w_buo  = %int(%trim(b1buo))
6.22 c                   eval      w_but  = %int(%trim(b1but))
6.22 c                   eval      b1flt1 = %editw(w_buo :'  .   .   -')
6.22 c                   eval      b1flt2 = %editw(w_but :'  .   .   -')
6.22 c                   eval      b1flt3 = %editw(w_sumi:'  .   .   -')
6.22 c                   eval      b1flt4 = %editw(w_sumk:'  .   .   -')
     c                   if        w_sumk > w_sumi
     c                   eval      *in41 = *on
     c                   else
     c                   eval      *in41 = *off
     c                   endif
      *
     c                   when      w_a51 = 2
      * Inntekts informasjon
     c                   eval      b1flt1 = *blank
     c                   eval      b1flt2 = *blank
     c                   eval      b1flt3 = *blank
     c                   eval      b1flt4 = *blank
     c                   exsr      finn_sum
     c                   eval      w_buo  = %int(%trim(b1buo))
     c                   eval      w_but  = %int(%trim(b1but))
     c                   eval      w_rest = w_buo - w_sumi
     c                   if        w_buo <> 0
     c                   eval(h)   w_ppro = w_sumi * 100 / w_buo
     c                   else
     c                   eval      w_ppro = 0
     c                   endif
     c                   eval      b1flt1 = %editw(w_buo :'  .   .   -')
     c                   eval      b1flt2 = %editw(w_sumi:'  .   .   -')
     c                   eval      b1flt3 = %editw(w_rest:'  .   .   -')
     c                   eval      b1flt4 = %editw(w_ppro:'  .   .   -')
     c                   if        w_rest < 0
     c                   eval      *in41 = *on
     c                   else
     c                   eval      *in41 = *off
     c                   endif
      *
     c                   when      w_a51 = 3
      * Kostnads informasjon
     c                   eval      b1flt1 = *blank
     c                   eval      b1flt2 = *blank
     c                   eval      b1flt3 = *blank
     c                   eval      b1flt4 = *blank
     c                   exsr      finn_sum
     c                   eval      w_buo  = %int(%trim(b1buo))
     c                   eval      w_but  = %int(%trim(b1but))
     c                   eval      w_rest = w_but - w_sumk
     c                   if        w_but <> 0
     c                   eval(h)   w_ppro = w_sumk * 100 / w_but
     c                   else
     c                   eval      w_ppro = 0
     c                   endif
     c                   eval      b1flt1 = %editw(w_but :'  .   .   -')
     c                   eval      b1flt2 = %editw(w_sumk:'  .   .   -')
     c                   eval      b1flt3 = %editw(w_rest:'  .   .   -')
     c                   eval      b1flt4 = %editw(w_ppro:'  .   .   -')
     c                   if        w_rest < 0
     c                   eval      *in41 = *on
     c                   else
     c                   eval      *in41 = *off
     c                   endif
     c                   endsl
     c                   write     b1sfl
      *
     c                   enddo
      *
     c                   if        w_srrn > w_ssrn
     c                   eval      w_sfrn = w_ssrn + 1
     c                   endif
      *
     c                   eval      w_ssrn = w_srrn
     c                   eval      w_virn = w_sfrn
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for display av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     dsp_subfile   begsr
      *
     c                   if        w_srrn <> 0
     c                   eval      *in12 = *on
     c                   else
     c                   write     b2cmd
     c                   endif
      *
     c                   eval      *in13 = *on
     c                   exfmt     b2ctl
      *
     c                   eval      *in12 = *off
     c                   eval      *in13 = *off
     c                   eval      *in22 = *off
      *
     c                   eval      w_fcrn = d_fcrn
      *
     c                   endsr
6.22  *
6.22  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.22  * Subrutine for å hente summer av prosjekt
6.22  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.22  *
6.22 c     finn_sum      begsr
6.22  *
6.22 c                   eval      w_sumi = 0
6.22 c                   eval      w_sumk = 0
6.22 c                   eval      w_sumix = 0
6.22 c                   eval      w_sumkx = 0
6.22  * inntekter
6.22 c                   eval      rprrl1_fir = w_firm
6.22 c                   eval      rprrl1_rap = 9700
6.22 c                   eval      rprrl1_lin = 10
6.22 c                   eval      rprrl1_uli = *zero
     c                   dow       rprrl1_lin < 20
6.22 c     rprrl1_key    chain     rprrl1
6.22 c                   if        %found(rprrl1)
6.22  * inntekter
6.22 c                   eval      rhtrlc_fir = w_firm
6.22 c                   eval      rhtrlc_pro = b1pros
6.22 c     rhtrlc_key    setll     rhtrlc
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   dow       not %eof(rhtrlc) and
6.22 c                             rbhpro = b1pros
6.22 c                   if        rbkont >= rphktf and
6.22 c                             rbkont <= rphktt
     c                   if        rphfun = '-'
6.22 c                   eval(h)   w_sumix = w_sumix - rbneto
6.22 c                   else
6.22 c                   eval(h)   w_sumix = w_sumix + rbneto
6.22 c                   endif
6.22 c                   endif
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   enddo
6.22 c                   endif
6.22  *
     c                   eval      rprrl1_lin = rprrl1_lin + 1
     c                   enddo
6.22  *
6.22  *
6.22  * utgifter varekjøp
6.22 c                   eval      rprrl1_fir = w_firm
6.22 c                   eval      rprrl1_rap = 9700
6.22 c                   eval      rprrl1_lin = 20
6.22 c                   eval      rprrl1_uli = *zero
     c                   dow       rprrl1_lin < 30
6.22 c     rprrl1_key    chain     rprrl1
6.22 c                   if        %found(rprrl1)
6.22 c                   eval      rhtrlc_fir = w_firm
6.22 c                   eval      rhtrlc_pro = b1pros
6.22 c     rhtrlc_key    setll     rhtrlc
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   dow       not %eof(rhtrlc)
6.22 c                   if        rbkont >= rphktf and
6.22 c                             rbkont <= rphktt
     c                   if        rphfun = '-'
6.22 c                   eval(h)   w_sumkx = w_sumkx - rbneto
6.22 c                   else
6.22 c                   eval(h)   w_sumkx = w_sumkx + rbneto
6.22 c                   endif
6.22 c                   endif
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   enddo
6.22 c                   endif
6.22  *
     c                   eval      rprrl1_lin = rprrl1_lin + 1
     c                   enddo
6.22  *
6.22  * utgifter lønn
6.22 c                   eval      rprrl1_fir = w_firm
6.22 c                   eval      rprrl1_rap = 9700
6.22 c                   eval      rprrl1_lin = 30
6.22 c                   eval      rprrl1_uli = *zero
     c                   dow       rprrl1_lin < 40
6.22 c     rprrl1_key    chain     rprrl1
6.22 c                   if        %found(rprrl1)
6.22 c                   eval      rhtrlc_fir = w_firm
6.22 c                   eval      rhtrlc_pro = b1pros
6.22 c     rhtrlc_key    setll     rhtrlc
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   dow       not %eof(rhtrlc)
6.22 c                   if        rbkont >= rphktf and
6.22 c                             rbkont <= rphktt
     c                   if        rphfun = '-'
6.22 c                   eval(h)   w_sumkx = w_sumkx - rbneto
6.22 c                   else
6.22 c                   eval(h)   w_sumkx = w_sumkx + rbneto
6.22 c                   endif
6.22 c                   endif
6.22  *
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   enddo
6.22 c                   endif
6.22  *
     c                   eval      rprrl1_lin = rprrl1_lin + 1
     c                   enddo
6.22  * andre kostnader
6.22 c                   eval      rprrl1_fir = w_firm
6.22 c                   eval      rprrl1_rap = 9700
6.22 c                   eval      rprrl1_lin = 50
6.22 c                   eval      rprrl1_uli = *zero
     c                   dow       rprrl1_lin < 60
6.22 c     rprrl1_key    chain     rprrl1
6.22 c                   if        %found(rprrl1)
6.22  * utgifter
6.22 c                   eval      rhtrlc_fir = w_firm
6.22 c                   eval      rhtrlc_pro = b1pros
6.22 c     rhtrlc_key    setll     rhtrlc
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   dow       not %eof(rhtrlc)
6.22 c                   if        rbkont >= rphktf and
6.22 c                             rbkont <= rphktt
     c                   if        rphfun = '-'
6.22 c                   eval(h)   w_sumkx = w_sumkx - rbneto
6.22 c                   else
6.22 c                   eval(h)   w_sumkx = w_sumkx + rbneto
6.22 c                   endif
6.22 c                   endif
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   enddo
6.22 c                   endif
6.22  *
     c                   eval      rprrl1_lin = rprrl1_lin + 1
     c                   enddo
6.22  *
6.22  * finans kostnader
6.22 c                   eval      rprrl1_fir = w_firm
6.22 c                   eval      rprrl1_rap = 9700
6.22 c                   eval      rprrl1_lin = 60
6.22 c                   eval      rprrl1_uli = *zero
     c                   dow       rprrl1_lin < 70
6.22 c     rprrl1_key    chain     rprrl1
6.22 c                   if        %found(rprrl1)
6.22  * utgifter
6.22 c                   eval      rhtrlc_fir = w_firm
6.22 c                   eval      rhtrlc_pro = b1pros
6.22 c     rhtrlc_key    setll     rhtrlc
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   dow       not %eof(rhtrlc)
6.22 c                   if        rbkont >= rphktf and
6.22 c                             rbkont <= rphktt
     c                   if        rphfun = '-'
6.22 c                   eval(h)   w_sumkx = w_sumkx - rbneto
6.22 c                   else
6.22 c                   eval(h)   w_sumkx = w_sumkx + rbneto
6.22 c                   endif
6.22 c                   endif
6.22 c     rhtrlc_key    reade     rhtrlc
6.22 c                   enddo
6.22  *
6.22 c                   endif
6.22  *
     c                   eval      rprrl1_lin = rprrl1_lin + 1
     c                   enddo
      *    ---------------------------------------------------------
     c                   if        %abs(w_sumix) <= 9999999
     c                   eval      w_sumi = w_sumix
     c                   else
     c                   eval      w_sumi = 9999999
     c                   endif
      *
     c                   if        %abs(w_sumkx) <= 9999999
     c                   eval      w_sumk = w_sumkx
     c                   else
     c                   eval      w_sumk = 9999999
     c                   endif
6.22  *
6.22 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for posisjonering på prosjekt
      *
     c     rpxll1_key    klist
     c                   kfld                    rpxll1_user
     c                   kfld                    rpxll1_ppro
     c                   kfld                    rpxll1_uupr
     c                   kfld                    rpxll1_aakt
      *
      * Key for les på prosjekt
      *
     c     rpxllr_key    klist
     c                   kfld                    rpxllr_user
     c                   kfld                    rpxllr_ppro
     c                   kfld                    rpxllr_uupr
     c                   kfld                    rpxllr_aakt
      *
      * Key for oppdatering av prosjket
      *
     c     rpxllu_key    klist
     c                   kfld                    rpxllu_user
     c                   kfld                    rpxllu_ppro
     c                   kfld                    rpxllu_uupr
     c                   kfld                    rpxllu_aakt
6.35  *
6.35  * Key for lesing av Prosjekt
6.35  *
6.35 c     rp1plu_key    klist
6.35 c                   kfld                    w_firm
6.35 c                   kfld                    rp1plu_pros
6.35  *
6.35  * Key for lesing av underprosjekt
6.35  *
6.35 c     rp2ulu_key    klist
6.35 c                   kfld                    w_firm
6.35 c                   kfld                    rp2ulu_pros
6.35 c                   kfld                    rp2ulu_upro
6.35  *
6.35  * Key for lesing av aktivitet
6.35  *
6.35 c     rp3alu_key    klist
6.35 c                   kfld                    w_firm
6.35 c                   kfld                    rp3alu_pros
6.35 c                   kfld                    rp3alu_upro
6.35 c                   kfld                    rp3alu_akti
      *
      * Key for oppslag på kunde
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Key for oppslag på Prosjektleder
      *
     c     ilonl1_key    klist
     c                   kfld                    ilonl1_kli
     c                   kfld                    ilonl1_lnr
6.34  *
6.34  * Key for oppslag på Selger
6.34  *
6.34 c     ra09l1_key    klist
6.34 c                   kfld                    ra09l1_fir
6.34 c                   kfld                    ra09l1_kod
      *
      * Key for oppslag på avdeling
      *
     c     ra07l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra07l1_kod
      *
      * Key for posisjonering på prosjekt-rapport
      *
     c     rprrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rprrl1_rap
     c                   kfld                    rprrl1_lin
     c                   kfld                    rprrl1_uli
6.22  *
6.22  * Key for les på posteringer
6.22  *
6.22 c     rhtrlc_key    klist
6.22 c                   kfld                    w_firm
6.22 c                   kfld                    rhtrlc_pro
6.22  *
6.22  * Key for les på bruker(FUSR)
6.22  *
6.22 c     fusrl1_key    klist
6.22 c                   kfld                    w_firm
6.22 c                   kfld                    fusrl1_usr
6.22  *
6.22  * Key for les på bruker(AUSR)
6.22  *
6.22 c     ausrl1_key    klist
6.22 c                   kfld                    ausrl1_usr
      *
     c                   eval      w_firm = l_firm
      *
      * Initierer skjermbildet
      *
     c                   eval      *in22 = *on
      *
      * Hent opp brukerens selgernummer
      *
     c                   eval      fusrl1_usr = l_user
     c     fusrl1_key    chain     fusrl1
     c                   eval      ausrl1_usr = l_user
     c     ausrl1_key    chain     ausrl1
      *
      * Posisjonerer databasen, og fyller opp subfile
      *
     c                   eval      w_seqe      = *blank
     c                   eval      rpxll1_user = l_user
     c                   eval      rpxllu_user = l_user
     c                   eval      rpxllr_user = l_user
     c                   eval      rpxll1_ppro = *blank
     c     rpxll1_key    setll     rpxll1
      *
7.xx c*                  eval      b2head = 'Fra dato    Til dato     -
7.xx c*                            Avd.     Pr.leder'
7.xx c                   eval      b2hea1 = 'Fra dato'
7.xx c                   eval      b2hea2 = 'Til dato'
7.xx c                   eval      b2hea3 = 'UnderPro'
7.xx c                   eval      b2hea4 = 'Aktivitet'
     c                   exsr      crt_subfile
      *
     c                   endsr
