     H/TITLE  ASOFAK: Vedlikehold av status-koder
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : LO810R
      * Beskrivelse . . : Vedlikehold av kobling SMS/Forsendelsesmåte
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *  6.20 100215 bsa  Nytt program
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffsmsL1    if   e           k disk    rename(fsmspfr:fsmsl1r)
     ffsmslu    uf a e           k disk    rename(fsmspfr:fsmslur)
     fra17l1    if   e           k disk    rename(ra17pfr:ra17l1r)
      *
     flo810d    cf   e             workstn
      *
     d w_firm          s                   like(smfirm)
      *
     d ra17l1_qkod     s                   like(raqkod)
      *
     d p_qkod          s                   like(raqkod)
     d p_qtxt          s             20A
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  A1BLD Behandle bildet for valg                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     a1taga        tag
      *
      *  Hent opplysninger fra koblingstabell
      *
     c     fsmsl1_key    chain     fsmsl1
     c                   if        %found
     c                   eval      a1fm01 = smfm01
     c                   eval      a1fm02 = smfm02
     c                   eval      a1fm03 = smfm03
     c                   eval      a1fm04 = smfm04
     c                   eval      a1fm05 = smfm05
     c                   eval      a1fm06 = smfm06
     c                   eval      a1fm07 = smfm07
     c                   eval      a1fm08 = smfm08
     c                   eval      a1fm09 = smfm09
     c                   eval      a1fm10 = smfm10
     c                   eval      a1sv01 = smsv01
     c                   eval      a1sv02 = smsv02
     c                   eval      a1sv03 = smsv03
     c                   eval      a1sv04 = smsv04
     c                   eval      a1sv05 = smsv05
     c                   eval      a1sv06 = smsv06
     c                   eval      a1sv07 = smsv07
     c                   eval      a1sv08 = smsv08
     c                   eval      a1sv09 = smsv09
     c                   eval      a1sv10 = smsv10
     c                   else
     c                   eval      a1fm01 = 0
     c                   eval      a1fm02 = 0
     c                   eval      a1fm03 = 0
     c                   eval      a1fm04 = 0
     c                   eval      a1fm05 = 0
     c                   eval      a1fm06 = 0
     c                   eval      a1fm07 = 0
     c                   eval      a1fm08 = 0
     c                   eval      a1fm09 = 0
     c                   eval      a1fm10 = 0
     c                   eval      a1sv01 = 0
     c                   eval      a1sv02 = 0
     c                   eval      a1sv03 = 0
     c                   eval      a1sv04 = 0
     c                   eval      a1sv05 = 0
     c                   eval      a1sv06 = 0
     c                   eval      a1sv07 = 0
     c                   eval      a1sv08 = 0
     c                   eval      a1sv09 = 0
     c                   eval      a1sv10 = 0
     c                   endif
      *
      *  Vis bilde
      *
     c     a1tagb        tag
      *
     c                   exfmt     a1bld
      *
      *  F3=Avslutt
      *
     c     *inkc         cabeq     *on           xslutt
      *
     c                   eval      *in31 = *off
      * Spørring
     c                   if        *inkd = *on
     c                   exsr      spØrring
     c                   goto      a1tagb
     c                   endif
      * Sjekk input
     c                   if        a1fm01 <> 0
     c                   eval      ra17l1_qkod = a1fm01
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm02 <> 0
     c                   eval      ra17l1_qkod = a1fm02
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm03 <> 0
     c                   eval      ra17l1_qkod = a1fm03
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm04 <> 0
     c                   eval      ra17l1_qkod = a1fm04
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm05 <> 0
     c                   eval      ra17l1_qkod = a1fm05
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm06 <> 0
     c                   eval      ra17l1_qkod = a1fm06
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1sv07 <> 0
     c                   eval      ra17l1_qkod = a1sv07
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm08 <> 0
     c                   eval      ra17l1_qkod = a1fm08
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm09 <> 0
     c                   eval      ra17l1_qkod = a1fm09
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
     c                   if        a1fm10 <> 0
     c                   eval      ra17l1_qkod = a1fm10
     c     ra17l1_key    chain     ra17l1
     c                   if        not %found
     c                   eval      *in31 = *on
     c                   goto      a1tagb
     c                   endif
     c                   endif
      *
      *  Oppdater OFAK-KODE-REGISTER
      *
     c     fsmsl1_key    chain     fsmslur
      *
     c                   eval      smfm01 = a1fm01
     c                   eval      smfm02 = a1fm02
     c                   eval      smfm03 = a1fm03
     c                   eval      smfm04 = a1fm04
     c                   eval      smfm05 = a1fm05
     c                   eval      smfm06 = a1fm06
     c                   eval      smfm07 = a1fm07
     c                   eval      smfm08 = a1fm08
     c                   eval      smfm09 = a1fm09
     c                   eval      smfm10 = a1fm10
     c                   eval      smsv01 = a1sv01
     c                   eval      smsv02 = a1sv02
     c                   eval      smsv03 = a1sv03
     c                   eval      smsv04 = a1sv04
     c                   eval      smsv05 = a1sv05
     c                   eval      smsv06 = a1sv06
     c                   eval      smsv07 = a1sv07
     c                   eval      smsv08 = a1sv08
     c                   eval      smsv09 = a1sv09
     c                   eval      smsv10 = a1sv10
      *
     c                   if        %found
     c                   update    fsmslur
     c                   else
     c                   eval      smfirm = w_firm
     c                   time                    smodat
     c                   time                    smotim
     c                   eval      smuser = l_user
     c                   write     fsmslur
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Avslutt program                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for spørring
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     spØrring      begsr
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM01'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm01 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM02'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm02 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM03'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm03 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM04'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm04 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM05'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm05 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM06'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm06 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM07'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm07 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM08'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm08 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM09'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm09 = p_qkod
     c                   leavesr
     c                   endif
      *
      * Spørring på forsendelsesmåte
      *
     c                   if        w_afld = 'A1FM10'
     c                   call      'RA517R'
     c                   parm                    w_firm
     c                   parm                    p_qkod
     c                   parm                    p_qtxt
     c                   eval      a1fm10 = p_qkod
     c                   leavesr
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Subrutine for initiering av program                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *  Key for file : Kobling
      *
     c     fsmsl1_key    klist
     c                   kfld                    w_firm
      *
      *  Key for file : Forsendelsesmåte
      *
     c     ra17l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra17l1_qkod
      *
      *  Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
