     H/TITLE  Utskrift av butikk-skjerm-kasse-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSHOP
      * Program . . . . : BO530R
      * Beskrivelse . . : Utskrift av butikk-skjerm-kasse-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     FVOTYL1    IF   E           K DISK
     F                                     RENAME(VOTYPFR:VOTYL1R)
      *
     FBWSDL1    IF   E           K DISK
     F                                     RENAME(BWSDPFR:BWSDL1R)
     FBSTSL1    IF   E           K DISK
     F                                     RENAME(BSTSPFR:BSTSL1R)
     FAWSDL1    IF   E           K DISK
     F                                     RENAME(AWSDPFR:AWSDL1R)
     FBO530P    O    E             PRINTER
      *
      * Hente inn firma fra local
      *
      *
     D                UDS
     D  DSFIRM               944    946  0
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av formater                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede formater
      * - - - - - - - - - -
      *
      * A1HDR  - Heading A1 på rapport
      * D1DET  - Detail  D1 på rapport
      * T1TOT  - Total   T1 på rapport
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Forklaring til logikken i programmet :                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Programmet inneholder en litt spesiell logikk for å håndtere
      * vedlikehold av opplysninger for hvilke utkøer/printere som
      * skal benyttes.  I skjermbildet ligger det 5 felter hvor du kan
      * registrere printer.  Dette blir ikke oppdatert i denne filen,
      * men ajourfører standardfilen for Skjerm/rutine som finnes i
      * ASPGPL.  På ordretypen ligger det et rutinenavn, og dette
      * benyttes sammen med skjermid. som key.  For lettere å huske
      * hva som er gjort her, kan etterfølgende beskrivelse benyttes:
      *
      * Initieringsrutine:
      * ------------------
      * - Henter inn Butikk-statusregister
      *   --------------------------------
      *          Key : Firma
      *                           Får : BAAOKD    BAAOKK
      *                                 BAAOCD    BAAOCK
      *                                 BAAOFD    BAAOFK
      *                                 BAAOBD    BAAOBK
      *                                 BAAOLD
      *
      *   I og med at denne record chaines kun i initieringsrutinen,
      *   vil disse felter ligge tilgjengelig og urørt så lenge
      *   programmet er aktivt.
      *
      * - Henter inn Register for ordretype
      *   ---------------------------------
      *          Key : Firma
      *                Ordretype
      *
      *          Dersom ordretype er oppgitt i statusregister,
      *          Dersom ordretype finnes i ordretyperegister,
      *
      *                           Får : WRUOKD    WRUOKK
      *                                 WRUOCD    WRUOCK
      *                                 WRUOFD    WRUOFK
      *                                 WRUOBD    WRUOBK
      *                                 WRUOPD
      *
      *   Dette er felter som inneholder rutinenavn.
      *   Disse felter vil også ligge tilgjengelig og urørt så lenge
      *   programmet er aktivt.
      *
      *
      * - Subrutine XHENTE, henter data fra AWSDPF-registeret i ADBxxx
      *   ------------------------------------------------------------
      *          Key : Skjerm-id
      *                Rutine-navn
      *
      *          Dersom rutinenavn ikke er blankt,
      *          Dersom post finnes i AWSDPF-registeret,
      *
      *                           Får : WSKONQ
      *                                 WSKRNQ
      *                                 WSFANQ
      *                                 WSIUTQ
      *                                 WSPLUQ
      *
      *          Dette er de felter som skal printes ut på rapporten
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A1HDR Behandle heading A1                                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Skrive heading
      *
     C                   WRITE     A1HDR
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * D1DET Behandle file                                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Lese file
      *
     C     KEY01         SETLL     BWSDL1
     C                   READ      BWSDL1                                 15
      *
     C     *IN15         DOWEQ     '0'                                                   .....
      *                                                                 .
      * Hente utkø/skriver                                              .
      *                                                                 .
     C                   MOVE      BWWSID        WWWSID                                      .
     C                   EXSR      XHENTE                                                    .
      *                                                                 .
      * Behandle record                                                 .
      *                                                                 .
     C                   MOVE      WSKONQ        D1OUTQ                                      .
     C                   ADD       1             T1POST                                      .
     C                   WRITE     D1DET                                30                   .
      *                                                                 .
      * Er det overflow ?                                               .
      *                                                                 .
     C     *IN30         IFEQ      *ON                                                       .
     C                   WRITE     A1HDR                                                     .
     C                   ENDIF                                                               .
      *                                                                 .
      * Behandle outq2                                                  .
      *                                                                 .
     C                   MOVE      WSKRNQ        D2OUTQ                                      .
     C     D2OUTQ        IFNE      *BLANK                                                    .
     C                   WRITE     D2DET                                30                   .
     C                   ENDIF                                                               .
      *                                                                 .
      * Er det overflow ?                                               .
      *                                                                 .
     C     *IN30         IFEQ      *ON                                                       .
     C                   WRITE     A1HDR                                                     .
     C                   ENDIF                                                               .
      *                                                                 .
      * Behandle outq3                                                  .
      *                                                                 .
     C                   MOVE      WSFANQ        D3OUTQ                                      .
     C     D3OUTQ        IFNE      *BLANK                                                    .
     C                   WRITE     D3DET                                30                   .
     C                   ENDIF                                                               .
      *                                                                 .
      * Er det overflow ?                                               .
      *                                                                 .
     C     *IN30         IFEQ      *ON                                                       .
     C                   WRITE     A1HDR                                                     .
     C                   ENDIF                                                               .
      *                                                                 .
      * Behandle outq4                                                  .
      *                                                                 .
     C                   MOVE      WSIUTQ        D4OUTQ                                      .
     C     D4OUTQ        IFNE      *BLANK                                                    .
     C                   WRITE     D4DET                                30                   .
     C                   ENDIF                                                               .
      *                                                                 .
      * Er det overflow ?                                               .
      *                                                                 .
     C     *IN30         IFEQ      *ON                                                       .
     C                   WRITE     A1HDR                                                     .
     C                   ENDIF                                                               .
      *                                                                 .
      * Behandle outq5                                                  .
      *                                                                 .
     C                   MOVE      WSPLUQ        D5OUTQ                                      .
     C     D5OUTQ        IFNE      *BLANK                                                    .
     C                   WRITE     D5DET                                30                   .
     C                   ENDIF                                                               .
      *                                                                 .
      * Er det overflow ?                                               .
      *                                                                 .
     C     *IN30         IFEQ      *ON                                                       .
     C                   WRITE     A1HDR                                                     .
     C                   ENDIF                                                               .
      *                                                                 .
     C                   READ      BWSDL1                                 15                 .
     C                   ENDDO                                                           .....
      *
     C     XEND01        TAG
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * T1TOT Behandle total T1                                         *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Skrive total
      *
     C                   WRITE     T1TOT                                30
     C                   GOTO      XSLUTT
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XSLUTT        TAG
     C                   SETON                                        LR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Hente inn data for utkø/printer                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XHENTE        BEGSR
      *
      * Hente inn skjerm / rutine register
      *
     C                   MOVE      *BLANK        WSKONQ
     C                   MOVE      *BLANK        WSKRNQ
     C                   MOVE      *BLANK        WSFANQ
     C                   MOVE      *BLANK        WSIUTQ
     C                   MOVE      *BLANK        WSPLUQ
      *
     C     WRUOKD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOKD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSKONQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOCD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOCD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSKRNQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOFD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOFD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSFANQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOBD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOBD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSIUTQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOPD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOPD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSPLUQ                                      .
     C                   ENDIF                                                           .....
      *
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     *INZSR        BEGSR
      *
     C     *LIKE         DEFINE    BWFIRM        WWFIRM
     C     *LIKE         DEFINE    BWWSID        WWWSID
     C     *LIKE         DEFINE    VAOTYP        WWOTYP
     C     *LIKE         DEFINE    AWRUTI        WWRUTI
     C     *LIKE         DEFINE    AWRUTI        WRUOKD
     C     *LIKE         DEFINE    AWRUTI        WRUOKK
     C     *LIKE         DEFINE    AWRUTI        WRUOCD
     C     *LIKE         DEFINE    AWRUTI        WRUOCK
     C     *LIKE         DEFINE    AWRUTI        WRUOFD
     C     *LIKE         DEFINE    AWRUTI        WRUOFK
     C     *LIKE         DEFINE    AWRUTI        WRUOBD
     C     *LIKE         DEFINE    AWRUTI        WRUOBK
     C     *LIKE         DEFINE    AWRUTI        WRUOPD
     C     *LIKE         DEFINE    AWOUTQ        WWKONQ
     C     *LIKE         DEFINE    AWOUTQ        WWKRNQ
     C     *LIKE         DEFINE    AWOUTQ        WWFANQ
     C     *LIKE         DEFINE    AWOUTQ        WWIUTQ
     C     *LIKE         DEFINE    AWOUTQ        WWPLUQ
     C     *LIKE         DEFINE    AWOUTQ        WSKONQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSKRNQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSFANQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSIUTQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSPLUQ                         Save-felter
     C     *LIKE         DEFINE    AWWSID        WSWSID                         Save-felter
      *
      * Legge inn key
      *
     C                   MOVE      DSFIRM        WWFIRM
      *
      * Key for file kasse/skjermregister
      *
     C     KEY01         KLIST
     C                   KFLD                    WWFIRM
     C                   KFLD                    WWWSID
      *
      * Key for statusregister
      *
     C     KEY02         KLIST
     C                   KFLD                    WWFIRM
      *
      * Key for ordretyperegister
      *
     C     KEY03         KLIST
     C                   KFLD                    WWFIRM
     C                   KFLD                    WWOTYP
      *
      * Key for skjerm/rutine-register
      *
     C     KEY04         KLIST
     C                   KFLD                    WWWSID
     C                   KFLD                    WWRUTI
      *
      * Hente inn butikk-status-record
      *
     C     KEY02         CHAIN     BSTSL1                             62
      *
      * Hente inn ordre-type-register
      *
     C     BAAOKD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOKD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOKD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOKK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOKK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOKK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOCD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOCD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOCD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOCK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOCK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOCK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOFD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOFD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOFD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOFK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOFK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOFK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOBD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOBD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOBD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOBK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOBK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOBK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOLD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOLD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOPD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C                   ENDSR
      *
