     h option(*nodebugio) datedit(*dmy)
     h decedit('0.')
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOFAK
      * Program . . . . : RV012R
      * Beskrivelse . . : Leser linjer fra LOVF til kommaseparert til
      *                   (Global format (ImportRGBatchLineCSV.ifs))
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * ----- ------ ---- -------------------------------------------------
      *
9.01  *       011221 mst   Endring av layout og form på dato
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     flovfl1    ip   e           k disk
      *
      *
     frv12pf    o    e           k disk
      *
      * Definering av Local data area
      *
     d                uds
     d l_firm                944    946  0
      *
      *
      * Definering av inputfil
      *
     d rfirm           s              3  0
     d rperi           s              4  0
     d rbunt           s              5  0
     d rbln            s              8  0
     d rbil            s              4  0
     d rbdat           s             10
     d rdat            s             10
     d rgbilk          s              2  0
     d rgtext          s             20
     d rgdavd          s              4  0
     d rgdkto          s              6  0
     d rgdsps          s              4  0
     d rgdmom          s              1
     d rgbelp          s             10  2
     d rgmvag          s             10  2
     d rgcavd          s              4  0
     d rgckto          s              6  0
     d rgcsps          s              4  0
     d rgcmom          s              1
     d rgproj          s              6
     d rgakti          s              6
     d rgkref          s              8  0
     d rgkund          s              6  0
     d rgvalks         s              3
     d rgvalb          s             11  2
     d rgmngk          s              2  0
     d rgmngd          s              9  2
     d rgautx          s              1
     d rgkidi          s             25
     d rgsfak          s             15
     d rgupro          s              6
     d rgarbo          s              6
     d tell            s              2  0
      *
      * Datastruktur for posteringsdato
     d                 ds
     d p_fdati                 1     10
     d  p_fa                   1      4
     d  p_f1                   5      5
     d  p_fm                   6      7
     d  p_f2                   8      8
     d  p_fd                   9     10
     d                 ds
     d p_fdatu                 1      6
     d  p_fdu                  1      2
     d  p_fmu                  3      4
     d  p_fau                  5      6
     d*
      * Datastruktur for bilagsdato
     d                 ds
     d b_fdati                 1     10
     d  b_aa                   1      4
     d  b_a1                   5      5
     d  b_mn                   6      7
     d  b_a2                   8      8
     d  b_dd                   9     10
     d                 ds
     d b_fdatu                 1      6
     d  b_ddu                  1      2
     d  b_mnu                  3      4
     d  b_aau                  5      6
      *
      *
      * Datastruktur for forfallsdato
     d                 ds
     d f_fdati                 1     10
     d  f_fa                   1      4
     d  f_f1                   5      5
     d  f_fn                   6      7
     d  f_f2                   8      8
     d  f_fd                   9     10
     d                 ds
     d f_fdatu                 1      6
     d  f_fdu                  1      2
     d  f_fnu                  3      4
     d  f_fau                  5      6
      *
     c                   if        l_firm <> lgfirm
     c                   goto      slutt
     c                   endif
     c* Heading for kjøring
     c                   if        tell   = 0
     c                   add       1             tell
     c                   eval      rvdata = *blank
     c                   eval      rvdata = %trim('@FIRM_BEGIN(2217)')
     c                   write     rv12pfr
      *
     c                   eval      rvdata = *blank
     c                   eval      rvdata = %trim('@IMPORT_METHOD(3)')
     c                   write     rv12pfr
      *
     c                   eval      rvdata = *blank
     c                   eval      rvdata = %trim('@WaBnd(Descr,ValDT)')
     c                   write     rv12pfr
      *
     c                   eval      rvdata = *blank
      *
      *
      * Utgår ?
     c*                  movel     valdat        d_fdati
     c*                  movel     d_fa          nval08
     c*                  movel     d_fn          nval04
     c*                  move      d_fd          nval04
     c*                  move      nval04        nval08
     c*                  eval      rvdata = %trim('"KREDITSYSTEM" "') +
     c*                                     %char(nval08) +
     c*                                     %trim('"')
     c                   write     rv12pfr
      *
     c                   eval      rvdata = *blank
     c                   eval      rvdata = %trim('@WaVo(VoT,VoDt,') +
     c                                           ('BilNr,BilDt,BilArt,Txt,') +
     c                                           ('Avd,Pro,Dkto,Kkto,') +
     c                                           ('Mva,Val,Valk,ValB,Bel,') +
     c                                           ('Mbil,Fdat,Kjn,Men,KID,') +
     c                                           ('AvgK,SLA,LFakt,Rem,Pro,') +
     c                                           ('Marb,Ex1,Ex2,Ex3,Ex4)')
     c                   write     rv12pfr
      *
     c                   endif
      *
      ***********************************************************
     c
     c* Blanker felt
     c                   eval      p_fdati  = *blanks
     c                   eval      b_fdati  = *blanks
     c                   eval      f_fdati  = *blanks
      *
      *
      * Posteringsdato
     c                   movel     lgbdat        p_fdati
9.01 c*                  movel     p_fa          p_fau
9.01 c                   move      p_fa          p_fau
     c                   movel     p_fm          p_fmu
     c                   movel     p_fd          p_fdu
     c*                  movel     p_fdatu       p_fdatu
      *
      * Bilagsdato
     c                   movel     lgfdat        b_fdati
9.01 c*                  movel     b_aa          b_aau
9.01 c                   move      b_aa          b_aau
     c                   movel     b_mn          b_mnu
     c                   movel     b_dd          b_ddu
     c*                  movel     b_fdatu       b_fdatu
      *
      * Forfallsdato
     c                   movel     lgfdat        f_fdati
9.01 c*                  movel     f_fa          f_fau
9.01 c                   move      f_fa          f_fau
     c                   movel     f_fn          f_fnu
     c                   movel     f_fd          f_fdu
     c*                  movel     f_fdatu       f_fdatu
     c*
      * Beløp skal legges ut med 4 desimaler
     c*                  z-add     lgbelp        zfbelp
      * Legger ut detaljer fra bovf
      * Nullstiller
      *
     c*
     c                   eval      rvdata = *blank
      * Start
9.01 c                   eval      rvdata = %trim('') +
      * Type journal
     c                                     %char('1')     + ',' +
      * Posteringsdato
     c                                     %char(p_fdatu)     + ',' +
      * Bilagsnummer
     c                                     %char(lgbiln)    + ',' +
      * Bilagsdato
     c                                     %char(b_fdatu)     + ',' +
      * Bilagsart
     c                                     %char(lgbilk)     + ',' +
      * Bilagstekst
     c                                     %trim(lgtext)     + ',' +
      * Avd.nummer
     c                                     %char(lgdavd)     + ',' +
     c                                     %char(lgcavd)     + ',' +
      * Prosjekt nummer
     c                                     %trim(lgproj)     + ',' +
      * Debet konto
     c                                     %char(lgdkto)     + ',' +
      * Kredit konto
     c                                     %char(lgckto)     + ',' +
      * Mva kode
     c                                     %char(lgcmom)     + ',' +
     c                                     %char(lgdmom)     + ',' +
      * Valutakode
     c                                     %char(lgvalk)    + ',' +
      * Valuta kurs   NB!   Skal være kurs
     c                                     %char(lgvalb)    + ',' +
      * Valuta beløp
     c                                     %char(lgvalb)    + ',' +
      * Beløp
     c                                     %char(lgbelp)    + ',' +
      * Motbilagsnummer
     c                                     %char(' ')       + ',' +
      * Forfallsdato
     c                                     %char(f_fdatu)    + ',' +
      * Kjedenummer
     c                                     %char(' ')       + ',' +
      * Mengde
     c                                     %char(lgmngd)    + ',' +
      * Kid
     c                                     %trim(lgkidi)    + ',' +
      * Avgiftklasse
     c                                     %trim(',') +
      * SLAccount
     c                                     %trim(',') +
      * Lev.fakt.nr.
     c                                     %trim(lgsfak)    + ',' +
      * RemittanceProfileNO
     c                                     %trim(',') +
      * Produktnr.
     c                                     %trim(',') +
      * Medarbeidernr.
     c                                     %trim(',') +
      * Ekstra 1
     c                                     %trim(',') +
      * Ekstra 2
     c                                     %trim(',') +
      * Ekstra 3
     c                                     %trim(',') +
      * Ekstra 4
     c                                     %trim(',')
      *
     c                   write     rv12pfr
      *
     c     slutt         tag
      *
