     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOFAK
      * Program . . . . : VV781R
      * Beskrivelse . . : Kopiering av varer til annen filgruppe,
      *                   styreprogram
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       171199 HKO  Nytt program
      *       240101 HKO  Lagt inn behandling av varesortiment, påslag og
      *                   beholding av varetype
      *       300101 HKO  Lagt inn kopiering av varegruppe, rabattgruppe,
      *                   rabattgruppe-knytning og varesortiment-reg.
      *       100402 HKO  Lagt inn behandling av nye parametre
      *       240107 HKO  Lagt inn behandling av valgt firma innenfor
      *                   filgruppe
      *       220607 BOF  Lagt inn filgruppe som påslag skal hentes fra
6.31  *       040718 bof  Utvidet med les varer fra csv-fil
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     facpll1    if   e           k disk    rename(acplpfr:acpll1r)
      *
      * Datastruktur for parameterliste -inn/-ut
      *
     d                 ds
     d d_list                       260
     d  d_fgrp                        3    overlay(d_list:1)
     d  d_firm                        3  0 overlay(d_list:4)
     d  d_ldor                        6  0 overlay(d_list:7)
     d  d_ogrp                        2  0 overlay(d_list:13)
     d  d_hgrp                        2  0 overlay(d_list:15)
     d  d_ugrp                        3  0 overlay(d_list:17)
     d  d_var0                       15    overlay(d_list:20)
     d  d_var1                       15    overlay(d_list:35)
     d  d_var2                       15    overlay(d_list:50)
     d  d_var3                       15    overlay(d_list:65)
     d  d_var4                       15    overlay(d_list:80)
     d  d_var5                       15    overlay(d_list:95)
     d  d_var6                       15    overlay(d_list:110)
     d  d_var7                       15    overlay(d_list:125)
     d  d_var8                       15    overlay(d_list:140)
     d  d_var9                       15    overlay(d_list:155)
     d  d_odat                         d   overlay(d_list:170) datfmt(*iso)
     d  d_vtyp                        1    overlay(d_list:180)
     d  d_fgt0                        3    overlay(d_list:181)
     d  d_fit0                        3  0 overlay(d_list:184)
     d  d_fgt1                        3    overlay(d_list:187)
     d  d_fit1                        3  0 overlay(d_list:190)
     d  d_fgt2                        3    overlay(d_list:193)
     d  d_fit2                        3  0 overlay(d_list:196)
     d  d_fgt3                        3    overlay(d_list:199)
     d  d_fit3                        3  0 overlay(d_list:202)
     d  d_fgt4                        3    overlay(d_list:205)
     d  d_fit4                        3  0 overlay(d_list:208)
     d  d_fgt5                        3    overlay(d_list:211)
     d  d_fit5                        3  0 overlay(d_list:214)
     d  d_fgt6                        3    overlay(d_list:217)
     d  d_fit6                        3  0 overlay(d_list:220)
     d  d_fgt7                        3    overlay(d_list:223)
     d  d_fit7                        3  0 overlay(d_list:226)
     d  d_fgt8                        3    overlay(d_list:229)
     d  d_fit8                        3  0 overlay(d_list:232)
     d  d_fgt9                        3    overlay(d_list:235)
     d  d_fit9                        3  0 overlay(d_list:238)
6.31 d  d_file                        1    overlay(d_list:241)
      *
      * Datastruktur for parameterliste -ut
      *
     d                 ds
     d d_list2                       40
     d  d_fgrt                        3    overlay(d_list2:1)
     d  d_firt                        3  0 overlay(d_list2:4)
     d  d_vsor                       10    overlay(d_list2:7)
     d  d_pasl                       10    overlay(d_list2:17)
     d  d_bvty                        1  0 overlay(d_list2:27)
     d  d_bpko                        1  0 overlay(d_list2:28)
     d  d_ovso                        1  0 overlay(d_list2:29)
     d  d_klev                        1  0 overlay(d_list2:30)
     d  d_krsp                        1  0 overlay(d_list2:31)
     d  d_kvgr                        1  0 overlay(d_list2:32)
     d  d_krgr                        1  0 overlay(d_list2:33)
     d  d_krgk                        1  0 overlay(d_list2:34)
     d  d_kvso                        1  0 overlay(d_list2:35)
     d  d_pfgr                        3    overlay(d_list2:36)
      *
      * Definering av parametre
      *
     d p_list          s            260
     d p_natt          s              1
      *
      * Definering av variable i nøkler
      *
     d acpll1_lfgr     s                   like(aclfgr)
     d acpll1_lfir     s                   like(aclfir)
     d acpll1_lfgt     s                   like(aclfgt)
     d acpll1_lfit     s                   like(aclfit)
      *
      * Definering av variable
      *
     d w_tmst          s               z
     d w_tmst_20       s             20
     d w_memb          s             10
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Leser filkopiering-linje-register og behandler alle filgrupper/
      * firmaer det skal kopieres til
      *
     c                   if        d_fgt0 = *blank and
     c                             d_fgt1 = *blank and
     c                             d_fgt2 = *blank and
     c                             d_fgt3 = *blank and
     c                             d_fgt4 = *blank and
     c                             d_fgt5 = *blank and
     c                             d_fgt6 = *blank and
     c                             d_fgt7 = *blank and
     c                             d_fgt8 = *blank and
     c                             d_fgt9 = *blank
      *
     c                   eval      acpll1_lfgr = d_fgrp
     c                   eval      acpll1_lfir = d_firm
     c     acpll1_key    setll     acpll1
     c     acpll1_key    reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key    reade     acpll1
     c                   enddo
      *
     c                   goto      avslutt
      *
     c                   endif
      *
      * Behandler valgte filgrupper
      *
     c                   if        d_fgt0 <> *blank or
     c                             d_fgt1 <> *blank or
     c                             d_fgt2 <> *blank or
     c                             d_fgt3 <> *blank or
     c                             d_fgt4 <> *blank or
     c                             d_fgt5 <> *blank or
     c                             d_fgt6 <> *blank or
     c                             d_fgt7 <> *blank or
     c                             d_fgt8 <> *blank or
     c                             d_fgt9 <> *blank
      *
     c                   eval      acpll1_lfgr = d_fgrp
     c                   eval      acpll1_lfir = d_firm
      *
     c                   if        d_fgt0 <> *blank
     c                   eval      acpll1_lfgt = d_fgt0
     c                   eval      acpll1_lfit = d_fit0
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt1 <> *blank
     c                   eval      acpll1_lfgt = d_fgt1
     c                   eval      acpll1_lfit = d_fit1
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt2 <> *blank
     c                   eval      acpll1_lfgt = d_fgt2
     c                   eval      acpll1_lfit = d_fit2
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt3 <> *blank
     c                   eval      acpll1_lfgt = d_fgt3
     c                   eval      acpll1_lfit = d_fit3
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt4 <> *blank
     c                   eval      acpll1_lfgt = d_fgt4
     c                   eval      acpll1_lfit = d_fit4
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt5 <> *blank
     c                   eval      acpll1_lfgt = d_fgt5
     c                   eval      acpll1_lfit = d_fit5
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt6 <> *blank
     c                   eval      acpll1_lfgt = d_fgt6
     c                   eval      acpll1_lfit = d_fit6
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt7 <> *blank
     c                   eval      acpll1_lfgt = d_fgt7
     c                   eval      acpll1_lfit = d_fit7
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt8 <> *blank
     c                   eval      acpll1_lfgt = d_fgt8
     c                   eval      acpll1_lfit = d_fit8
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   if        d_fgt9 <> *blank
     c                   eval      acpll1_lfgt = d_fgt9
     c                   eval      acpll1_lfit = d_fit9
     c     acpll1_key2   setll     acpll1
     c     acpll1_key2   reade     acpll1
     c                   dow       not %eof
     c                   exsr      behandling
     c     acpll1_key2   reade     acpll1
     c                   enddo
     c                   endif
      *
     c                   goto      avslutt
      *
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   move      *on           *inlr
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine som kaller program for kopiering av filgruppe/firma
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     behandling    begsr
      *
     c                   eval      d_fgrt = aclfgt
     c                   eval      d_firt = aclfit
     c                   eval      d_vsor = aclvso
     c                   eval      d_pasl = aclpfa
     c                   eval      d_pfgr = aclpfg
     c                   eval      d_bvty = aclvty
     c                   eval      d_bpko = aclpko
     c                   eval      d_ovso = aclovs
     c                   eval      d_klev = aclkle
     c                   eval      d_krsp = aclkrs
     c                   eval      d_kvgr = aclkvg
     c                   eval      d_krgr = aclkrg
     c                   eval      d_krgk = aclkrk
     c                   eval      d_kvso = aclkvs
      *
     c                   time                    w_tmst
     c     *iso0         move      w_tmst        w_tmst_20
      *
     c                   eval      w_memb = 'K' + %subst(w_tmst_20:9:9)
      *
     c                   call      'VV782C'
     c                   parm                    d_list
     c                   parm                    d_list2
     c                   parm                    w_memb
     c                   parm                    p_natt
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
     c     *entry        plist
     c                   parm                    p_list
     c                   parm                    p_natt
      *
      * Key for les på filkopierings-linje-register
      *
     c     acpll1_key    klist
     c                   kfld                    acpll1_lfgr
     c                   kfld                    acpll1_lfir
      *
     c     acpll1_key2   klist
     c                   kfld                    acpll1_lfgr
     c                   kfld                    acpll1_lfir
     c                   kfld                    acpll1_lfgt
     c                   kfld                    acpll1_lfit
      *
      *
      * Kopiering av parameterliste til datastruktur
      *
     c                   eval      d_list = p_list
      *
     c                   endsr
