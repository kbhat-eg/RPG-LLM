     h/title  Vedlikehold kundeposteringer - autogiro
     h option(*nodebugio)
     h datedit(*dmy)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK819R                                              *
      * Beskrivelse . . : Vedlikehold kundeposteringer - autogiro             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * referanse  dato   endringsbeskrivelse                            sign *
      * --------- ------  ---------------------------------------------- ---- *
T5.40 * V5.40     030805  Utvidet parameterliste for RF020R              HFL
6.10  * V6.10     220909  Lagt inn sporingsfelter                        BSA  *
6.30  * R6.30     290216  Justert i skjermbildet pga jacada              BSA  *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                 *
      *  bruk av indikatorer                                            *
      *                                                                 *
      *       kc = f3  = exit                                           *
      *       ke = f5  = forny                                          *
      *       kl = f12 = annuller                                       *
      *                                                                 *
      *       lr = avslutt program                                      *
      *       10 = roll                                                 *
      *       12 = sfldsp                                               *
      *       13 = sfldspctl                                            *
      *       14 = sflclr                                               *
      *       15 = sflend                                               *
      *       16 = readc 16 on, no more records                         *
      *       30 = protect av felter ved vise                           *
      *    31-59 = varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = fileindikatorer chain etc.                           *
      *    70-79 = arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = arbeidsindikatorer ordinære                          *
      *    90-99 = benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frkwcpf    if   e           k disk
     frkwclu    uf   e           k disk
     f                                     rename(rktrpfr:rkwclur)
     frkunpf    if   e           k disk
     frk819d    cf   e             workstn
     f                                     sfile(b1wsf:srrn01)
      *
     d mld             s             11    dim(4) ctdata perrcd(1)               meldinger
     d txt             s             20    dim(2) ctdata perrcd(1)               meldinger
      *
      *                                                    bilagsdato
     d                 ds
     d wwbida                         6  0
     d  wwbidg                        2  0 overlay(wwbida)
     d  wwbimn                        2  0 overlay(wwbida:3)
     d  wwbiÅr                        2  0 overlay(wwbida:5)
      *
      *                                                    forfallsdato
     d                 ds
     d wwfoda                         6  0
     d  wwfodg                        2  0 overlay(wwfoda)
     d  wwfomn                        2  0 overlay(wwfoda:3)
     d  wwfoÅr                        2  0 overlay(wwfoda:5)
      *
      *                                                    forfallsdato
     d                 ds
     d wwfdat                         8  0
     d  wwfÅÅr                        4  0 overlay(wwfdat)
     d  wwfmnd                        2  0 overlay(wwfdat:5)
     d  wwfdag                        2  0 overlay(wwfdat:7)
      *
     d*/copy qcpysrc,ra01pfds
     d* koderegister - bilagskoder
     d                 ds
     d raalda                       128                                         hele utvekslingsfelt
     d  raasta                        1    overlay(raalda)                      u:  utgått
     d  raafir                        3  0 overlay(raalda:2)                    firma
     d  raaf01                        4  0 overlay(raalda:5)                    fri/ledig 001
     d  raakod                        2  0 overlay(raalda:9)                    bilagskode
     d  raatxt                       20    overlay(raalda:11)                   bilagstekst
     d  raakjØ                        1    overlay(raalda:31)                   =1:varekjøpoppdateri
     d  raaink                        1    overlay(raalda:32)                   innkassokode
     d  raarnk                        1    overlay(raalda:33)                   rentekode
     d  raasum                        1    overlay(raalda:34)                   =1:summering av post
     d  raaf02                       66    overlay(raalda:35)                   fri/ledig 002
     d  raausr                       10    overlay(raalda:119)                  bruker-id
     d*/copy qcpysrc,ra07pfds
     d* koderegister - avdelingskoder
     d                 ds
     d raglda                       159                                         hele utvekslingsfelt
     d  ragsta                        1    overlay(raglda)                      u:  utgått
     d  ragfir                        3  0 overlay(raglda:2)                    firma
     d  ragf01                        2  0 overlay(raglda:5)                    fri/ledig 001
     d  ragkod                        4  0 overlay(raglda:7)                    avdeling
     d  ragtxt                       20    overlay(raglda:11)                   beskrivende tekst
     d  ragpÅt                        1    overlay(raglda:31)                   type sats
     d  ragsat                        7  2 overlay(raglda:32)                   sats (p/%)
     d  ragf02                        2    overlay(raglda:39)                   fri/ledig 002
     d  ragmef                        3  0 overlay(raglda:41)                   med-post firma
     d  ragmek                        5  0 overlay(raglda:44)                   med-post konto
     d  ragmes                        2  0 overlay(raglda:49)                   med-post spes
     d  ragmea                        4  0 overlay(raglda:51)                   med-post avd.
     d  ragf03                       11    overlay(raglda:55)                   fri/ledig 003
     d  ragmof                        3  0 overlay(raglda:66)                   mot-post firma
     d  ragmok                        5  0 overlay(raglda:69)                   mot-post konto
     d  ragmos                        2  0 overlay(raglda:74)                   mot-post spes.
     d  ragmoa                        4  0 overlay(raglda:76)                   mot-post avd.
     d  ragf04                       11    overlay(raglda:80)                   fri/ledig 004
     d  ragkta                        1    overlay(raglda:91)                   kontroll avd.
     d  ragprf                        4    overlay(raglda:92)                   profitsenter
     d  ragadr                       30    overlay(raglda:96)                   postadresse
     d  ragpnr                        4  0 overlay(raglda:126)                  postnummer
     d  ragste                       30    overlay(raglda:130)                  poststed
     d*/copy qcpysrc,ra09pfds
     d* koderegister - selger
     d                 ds
     d railda                       128                                         hele utvekslingsfelt
     d  raista                        1    overlay(railda)                      u:  utgått
     d  raifir                        3  0 overlay(railda:2)                    firma
     d  raif01                        2  0 overlay(railda:5)                    fri/ledig 001
     d  raikod                        4  0 overlay(railda:7)                    selger
     d  raitxt                       20    overlay(railda:11)                   beskrivende tekst
     d  raikto                        6  0 overlay(railda:31)                   konto
     d  rairsk                        6  0 overlay(railda:37)                   reskontro
     d  raimva                        1  0 overlay(railda:43)                   mva-kode
     d  raiprk                        1  0 overlay(railda:44)                   provisjonskode
     d  raiblk                        2  0 overlay(railda:45)                   bilagskode
     d  raisa2                        2  0 overlay(railda:47)                   sats 2
     d  raisa3                        2  0 overlay(railda:49)                   sats 3
     d  raisa4                        2  0 overlay(railda:51)                   sats 4
     d  raisa5                        2  0 overlay(railda:53)                   sats 5
     d  raif03                       46    overlay(railda:55)                   fri/ledig 003
     d  raiusr                       10    overlay(railda:119)                  bruker-id
     d*/copy qcpysrc,asdatods
     d*   parameterliste for subprogram: asdato
     d                 ds
     d aqulda                       256                                         hele utvekslingsfelt
     d  aqida1                        8  0 overlay(aqulda)                      dato-1
     d  aqidm1                        3    overlay(aqulda:9)                    dato-1 = dmÅ/Åmd/???
     d  aqidg1                        4  0 overlay(aqulda:12)                   dato-1 forfallsdager
     d  aqifr1                        1    overlay(aqulda:16)                   dato-1 fri mnd. (j/n
     d  aqida2                        8  0 overlay(aqulda:21)                   dato-2
     d  aqidm2                        3    overlay(aqulda:29)                   dato-2 = dmÅ/Åmd/???
     d  aqidg2                        4  0 overlay(aqulda:32)                   dato-2 forfallsdager
     d  aqifr2                        1    overlay(aqulda:36)                   dato-2 fri mnd. (j/n
     d  aqibdg                        1    overlay(aqulda:41)                   dato-2 beregn dag(j/
     d  aqibuk                        1    overlay(aqulda:42)                   dato-2 beregn uke(j/
     d  aqa1ok                        1    overlay(aqulda:43)                   dato-1 ok?! (j/n)
     d  aqa2ok                        1    overlay(aqulda:44)                   dato-2 ok?! (j/n)
     d  aqager                        5  0 overlay(aqulda:45)                   dager (dato2-dato1)
     d  aqa1dm                        8  0 overlay(aqulda:51)                   dato-1 = ddmmÅÅÅÅ
     d  aqa1Åm                        8  0 overlay(aqulda:59)                   dato-1 = ÅÅÅÅmmdd
     d  aqu1dg                        1  0 overlay(aqulda:67)                   dato-1 ukedag
     d  aqunr1                        2  0 overlay(aqulda:68)                   dato-1 ukenr.
     d  aqgnr1                        3  0 overlay(aqulda:70)                   dato-1 dagnr.
     d  aqa2dm                        8  0 overlay(aqulda:81)                   dato-2 = ddmmÅÅÅÅ
     d  aqa2Åm                        8  0 overlay(aqulda:89)                   dato-2 = ÅÅÅÅmmdd
     d  aqu2dg                        1  0 overlay(aqulda:97)                   dato-2 ukedag
     d  aqunr2                        2  0 overlay(aqulda:98)                   dato-2 ukenr.
     d  aqgnr2                        3  0 overlay(aqulda:100)                  dato-2 dagnr.
     d  aqa3dm                        8  0 overlay(aqulda:111)                  forfall-1 = ddmmÅÅÅÅ
     d  aqa3Åm                        8  0 overlay(aqulda:119)                  forfall-1 = ÅÅÅÅmmdd
     d  aqu3dg                        1  0 overlay(aqulda:127)                  forfall-1 ukedag
     d  aqunr3                        2  0 overlay(aqulda:128)                  forfall-1 ukenr.
     d  aqgnr3                        3  0 overlay(aqulda:130)                  forfall-1 dagnr.
     d  aqa4dm                        8  0 overlay(aqulda:141)                  forfall-2 = ddmmÅÅÅÅ
     d  aqa4Åm                        8  0 overlay(aqulda:149)                  forfall-2 = ÅÅÅÅmmdd
     d  aqu4dg                        1  0 overlay(aqulda:157)                  forfall-2 ukedag
     d  aqunr4                        2  0 overlay(aqulda:158)                  forfall-2 ukenr.
     d  aqgnr4                        3  0 overlay(aqulda:160)                  forfall-2 dagnr.
     d  aq1dmÅ                        6  0 overlay(aqulda:171)                  dato-1 = ddmmÅÅ
     d  aq1Åmd                        6  0 overlay(aqulda:177)                  dato-1 = ÅÅmmdd
     d  aq2dmÅ                        6  0 overlay(aqulda:183)                  dato-2 = ddmmÅÅ
     d  aq2Åmd                        6  0 overlay(aqulda:189)                  dato-2 = ÅÅmmdd
     d  aq3dmÅ                        6  0 overlay(aqulda:195)                  forfall-1 = ddmmÅÅ
     d  aq3Åmd                        6  0 overlay(aqulda:201)                  forfall-1 = ÅÅmmdd
     d  aq4dmÅ                        6  0 overlay(aqulda:207)                  forfall-2 = ddmmÅÅ
     d  aq4Åmd                        6  0 overlay(aqulda:213)                  forfall-2 = ÅÅmmdd
     d*/copy qcpysrc,rf020par
     d* parameter - program rf020r
     d                 ds
6.NU d rxulda                       178                                         Hele utvekslingsfelt
     d  rxstat                        1    overlay(rxulda)                      status
     d  rxfirm                        3  0 overlay(rxulda:2)                    firma
     d  rxsyst                        1    overlay(rxulda:5)                    systemkode
E5.40d  rxpros                        6  0 overlay(rxulda:6)                    prosjekt
     d  rxakti                        3    overlay(rxulda:12)                   aktivitet
     d  rxf001                        3    overlay(rxulda:15)                   fast = blank
     d  rxkont                        6  0 overlay(rxulda:18)                   konto
E5.40d  rxspes                        4  0 overlay(rxulda:24)                   spesifikasjon
E5.40d  rxavde                        4  0 overlay(rxulda:28)                   avdeling
E5.40d  rxlinj                        4  0 overlay(rxulda:32)                   linjenr.
E5.40d  rxtgrp                        3    overlay(rxulda:36)                   grupperingskode
E5.40d  rxtext                       78    overlay(rxulda:39)                   fri-tekst
E5.40d  rxf002                       13    overlay(rxulda:117)                  fri/ledig 002
E5.40d  rxvalg                        1    overlay(rxulda:130)                  vedlikeholdvalg
T5.40d  rxtist                         z   overlay(rxulda:131)                  Timestamp
6.NU d  rxbiln                        8  0 overlay(rxulda:158)                  Konto
6.NU d  rxrper                        2  0 overlay(rxulda:166)                  Konto
6.NU d  rxraar                        4  0 overlay(rxulda:168)                  Konto
6.NU d  rxonr                         6  0 overlay(rxulda:172)                  Konto
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_navn                951    980
     d*---------------------------------------------------------------------
     d* Stand Alone Fields - TOP
     d*---------------------------------------------------------------------
     d fem0            s              5  0
     d femt0           s             15  0
     d raalst          s                   like(raalda)
     d raglst          s                   like(raglda)
     d railst          s                   like(railda)
     d rxupar          s                   like(rxulda)
     d sfrn01          s                   like(srrn01)
     d sju0            s              7  0
     d spge01          s              3  0
     d srrn01          s              4  0
     d ssrn01          s                   like(srrn01)
     d wactli          s              2  0
     d wactpo          s              3  0
     d wbel0           s                   like(rnbelØ)
     d wbel1           s                   like(rnbelØ)
     d wbel2           s                   like(rnbelØ)
     d wbel3           s                   like(rnbelØ)
     d wbel4           s                   like(rnbelØ)
     d wbel5           s                   like(rnbelØ)
     d werror          s              1  0
     d winkas          s                   like(rnbelØ)
     d wkbedg          s                   like(femt0)
     d wkbelØ          s                   like(rnbelØ)
     d wkbewk          s                   like(femt0)
     d wkdagr          s                   like(sju0)
     d wkjØpÅ          s                   like(rnbelØ)
     d wkotid          s                   like(fem0)
     d wktran          s                   like(sju0)
     d wkvtid          s                   like(fem0)
     d wnbelØ          s                   like(rnbelØ)
     d wpakod          s                   like(raakod)
     d wpakti          s              3
     d wpantp          s              2  0
     d wpatxt          s                   like(raatxt)
     d wpavde          s              4  0
     d wpfirm          s                   like(rnfirm)
     d wpfunk          s              1  0
     d wpgkod          s                   like(ragkod)
     d wpgtxt          s                   like(ragtxt)
     d wpikod          s                   like(raikod)
     d wpitxt          s                   like(raitxt)
     d wpkund          s                   like(rnkund)
     d wplist          s                   like(aqulda)
     d wppros          s              6  0
     d wpspes          s              2  0
     d wpsyst          s              1
     d wpvalg          s              1
     d wsaldo          s                   like(rnbelØ)
     d wvvalg          s                   like(b1valg)
     d wwbiln          s                   like(rnbiln)
     d wwfirm          s                   like(rnfirm)
     d wwkund          s                   like(rnkund)
     d wwrest          s                   like(rnrest)
     d wwbdat          s                   like(rnbdat)
     d wwtist          s                   like(rntist)
      *
      * Parametre
      *
     d p_stat          s              1
     d p_avde          s              4  0
     d p_tx20          s             20
     d p_akod          s              2  0
      *
     d*---------------------------------------------------------------------
     d* Stand Alone Fields - BOTTOM
     d*---------------------------------------------------------------------
      *
     c/eject
     c     dummy         tag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * forklaring på spesielle felter
      * som benyttes ved sub-files.
      * - - - - - - - - - - - - - - - - -
      *     nn - er 01 for subfile 01,
      *             02 for subfile 02,
      *             03 for subfile 03, o.s.v.
      * srrnnn - relativt recordnummer i subfile
      * spgenn - sidestørrelse i subfile (page)
      * sfrnnn - første recordnummer på siden
      * ssrnnn - siste  recordnummer på siden
      * svrnnn - vis den side som inneholder denne record.
      *
      * forklaring på spesielle felter
      * som benyttes ved windows.
      * - - - - - - - - - - - - - - - - -
      *
      * wactli - actual line, angir startlinje for vindu.
      * wactpo - actual posision, angir startposisjon for vindu.
      *
      * benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * b1wfl  - b1 subfile   - vindu for valg av post
      * b2wct  - b2 subfile   - vindu control record
      * b2cmd  - b2 vindu for cmd-taster
      * c2win  - c2 vindu for endre/vise
      * d2win  - d2 vindu for sletting
      * asume  -    record for å styre at vindu legges over
      *             eksisterende data.
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * b2wct behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * send alt
      *
     c     b2taga        tag
     c                   eval      wactli = 4
     c                   eval      wactpo = 6
     c                   write     b2cmd
      *
      * bare data
      *
     c     b2tagb        tag
     c                   exsr      xdsp01                                       dsp sfl
     c                   exsr      xnulle
      *
      * oppkall av notatark.
      *
     c                   if        *inkb = *on                                  .....
     c                   move      wwfirm        rxfirm                             .
     c                   eval      rxsyst = wpsyst                                  .
E5.40c                   eval      rxpros = wppros                                  .
     c                   eval      rxakti = wpakti                                  .
     c                   move      wwkund        rxkont                             .
     c                   eval      rxspes = wpspes                                  .
     c                   eval      rxavde = wpavde                                  .
     c                   eval      rxlinj = *zeros                                  .
     c                   eval      rxtext = *blank                                  .
     c                   eval      rxvalg = b1valg                                  .
     c                   eval      rxupar = rxulda                                  .
     c                   call      'RF020R'                                         .
     c                   parm                    rxupar                             .
     c                   eval      rxulda = rxupar                                  .
     c                   goto      b2taga                                           .
     c                   endif                                                  .....
      *
      * avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * forny
      *
     c                   if        *inke = *on                                           .....
     c                   if        sfrn01 <> *zero                                           .
     c     sfrn01        chain     b1wsf                                                     .
     c                   eval      *in60 = not%found                                         .
     c                   endif                                                               .
      *                                                                 .
     c                   eval      wwbdat = *loval                                           .
     c                   eval      wwtist = *loval                                           .
      *                                                                 .
     c     key01         setll     rkwcpf                                                    .
      *                                                                 .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * nok/valuta
      *
     c                   if        *inkg = *on                                           .....
     c                   if        wvvalg = '1'                                              .
     c                   eval      wvvalg = '0'                                 nok          .
     c                   else                                                                .
     c                   eval      wvvalg = '1'                                 valuta       .
     c                   endif                                                               .
      *                                                                 .
     c                   eval      wwbdat = *loval                                           .
     c                   eval      wwtist = *loval                                           .
      *                                                                 .
     c     key01         setll     rkwcpf                                                    .
      *                                                                 .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * roll
      *
     c                   if        *in10 = *on                                           .....
     c                   exsr      xcrt01                                       crt sfl      .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * posisjoner startverdi på posteringer
      *
     c                   if        b2bdat <> *loval                                      .....
     c                   eval      wwbdat = b2bdat                                           .
     c                   eval      wwtist = *loval
     c     key01         setll     rkwcpf                                                    .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   eval      b2bdat = *loval                                           .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * behandling av subfile                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * sjekk om valg er foretatt i subfile
      *
     c                   do        ssrn01                                                .....
     c                   readc     b1wsf                                                     .
     c                   eval      *in16 = %eof                                              .
     c                   if        *in16 = *on                                               .
     c                   leave                                                               .
     c                   endif                                                               .
      *                                                                 .
      * kun spørring                                                    .
      *                                                                 .
     c                   if        wpvalg = '5'                                        ..... .
     c                   eval      b1valg = '5'                                            . .
     c                   endif                                                         ..... .
      *                                                                 .
      * endre post                                                      .
      *                                                                 .
     c                   if        b1valg = '2'                                        ..... .
     c                   move      *off          *in30                                     . .
     c                   eval      c2bdat = b1bdat                                         . .
     c                   eval      wwbdat = b1bdat                                         . .
     c                   eval      wwtist = b1tist                                         . .
     c                   exsr      xc2win                                                  . .
     c                   iter                                                              . .
     c                   endif                                                         ..... .
      *                                                                 .
      * slette post                                                     .
      *                                                                 .
     c                   if        b1valg = '4'                                        ..... .
     c                   move      *off          *in30                                     . .
     c                   eval      c2bdat = b1bdat                                         . .
     c                   eval      wwbdat = b1bdat                                         . .
     c                   eval      wwtist = b1tist                                         . .
     c                   exsr      xd2win                                                  . .
     c                   iter                                                              . .
     c                   endif                                                         ..... .
      *                                                                 .
      * vise post                                                       .
      *                                                                 .
     c                   if        b1valg = '5'                                        ..... .
     c                   move      *on           *in30                                     . .
     c                   eval      wwbdat = b1bdat                                         . .
     c                   eval      wwtist = b1tist                                         . .
     c                   exsr      xc2win                                                  . .
     c                   iter                                                              . .
     c                   endif                                                         ..... .
      *                                                                 .
     c                   enddo                                                           .....
      *
     c                   goto      b2taga
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * c2win behandle bilde for      endring - vise                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xc2win        begsr
      *
     c     key01         chain     rkwcpf
     c                   eval      *in60 = not%found
      *
     c                   if        *in60 = *off                                          .....
     c                   movel     mld(2)        c2nyen                                      .
     c                   eval      c2biln = rnbiln                                           .
     c                   eval      c2bilk = rnbilk                                           .
     c                   eval      c2text = rntext                                           .
     c                   eval      c2bdat = rnbdat                                           .
     c                   eval      c2fdat = rnfdat                                           .
     c                   eval      c2rper = rnrper                                           .
     c                   eval      c2raar = rnraar                                           .
     c                   eval      c2rekl = rnrekl                                           .
     c                   eval      c2jour = rnjour                                           .
     c                   eval      c2refn = rnrefn                                           .
     c                   eval      c2samf = rnsamf                                           .
     c                   eval      c2antp = rnantp                                           .
     c                   eval      c2belØ = rnbelØ                                           .
     c                   eval      c2rest = rnrest                                           .
     c                   eval      c2renk = rnrenk                                           .
     c                   eval      c2inko = rninko                                           .
     c                   eval      c2valk = rnvalk                                           .
     c                   eval      c2avde = rnavde                                           .
     c                   eval      c2valb = rnvalb                                           .
     c                   eval      c2valr = rnvalr                                           .
     c                   eval      c2slgr = rnslgr                                           .
      *                                                                 .
     c                   endif                                                           .....
      *
     c                   if        *in30 = *on                                           .....
     c                   movel     mld(3)        c2nyen                                      .
     c                   endif                                                           .....
      *
     c     c2tagb        tag
      *
      * posisjonere cursor
      *
     c                   if        *in32 = *off
     c                   if        *in33 = *off
     c                   if        *in34 = *off
     c                   if        *in35 = *off
     c                   if        *in36 = *off
     c                   move      *on           *in31
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   eval      wactli = 6
     c                   eval      wactpo = 1
     c                   exfmt     c2win
     c                   exsr      xnulle
      *
     c     *inkc         cabeq     *on           c2tag1
     c     *inkl         cabeq     *on           c2tag1
     c     *in30         cabeq     *on           c2tag1
      *
      * call program for bilagskode
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2BILK'                                         .
     c                   call      'RA501R'                                                  .
     c                   parm                    wpfirm                                      .
     c                   parm                    wpakod                                      .
     c                   parm                    wpatxt                                      .
     c*                                                                 .
     c                   eval      c2bilk = wpakod                                           .
     c                   eval      c2text = wpatxt                                           .
     c                   move      *on           *in33                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for avdeling
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2AVDE'                                         .
     c                   call      'RA107R'                                                  .
     c                   parm                    wwfirm                                      .
     c                   parm                    wpgkod                                      .
     c                   parm                    wpgtxt                                      .
     c*                                                                 .
     c                   if        wpgkod <> *zero                                           .
     c                   eval      c2avde = wpgkod                                           .
     c                   endif                                                               .
     c*                                                                 .
     c                   move      *on           *in36                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for
      * selger
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2SLGR'                                         .
     c                   call      'RA509R'                                                  .
     c                   parm                    wwfirm                                      .
     c                   parm                    wpikod                                      .
     c                   parm                    wpitxt                                      .
     c*                                                                 .
     c                   if        wpikod <> *zero                                           .
     c                   eval      c2slgr = wpikod                                           .
     c                   endif                                                               .
     c*                                                                 .
     c                   move      *on           *in38                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * kontroll av skjermbildet
      *
     c                   exsr      xsr020
     c                   if        werror <> 0
     c                   goto      c2tagb
     c                   endif
      *
      * oppdater posteringsregister
      *
     c     key01         chain     rkwclur
     c                   eval      *in60 = not%found
      *
     c                   eval      rnbilk = c2bilk
     c                   eval      rntext = c2text
     c                   eval      rnfdat = c2fdat
     c                   eval      rnrekl = c2rekl
     c                   eval      rnrefn = c2refn
     c                   eval      rnantp = c2antp
     c                   eval      rnrenk = c2renk
     c                   eval      rninko = c2inko
     c                   eval      rnavde = c2avde
     c                   eval      rnslgr = c2slgr
     c                   eval      rnrest = c2rest                                           .
     c*                  eval      rnvalr = c2valr                                           .
     c                   eval      rnvalr = rnrest                                           .
      *
     c                   if        *in60 = *off                                          .....
     c                   if        b1valg = '2'                                              .
6.10 c*                  time                    rnedat
6.10 c*                  time                    rnetim
6.10 c*                  eval      rneusr = l_user
     c                   update    rkwclur                                                   .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * oppdater subfile
      *
     c                   if        b1valg = '2'                                          .....
     c                   eval      b1bilk = c2bilk                                           .
     c                   movel     c2text        b1text                                      .
     c                   endif                                                           .....
      *
     c     c2tag1        tag
      *
     c                   if        b1valg = '2'                                          .....
     c                             or b1valg = '5'                                           .
     c                   eval      svrn01 = srrn01                                           .
     c                   eval      b1valg = *blank                                           .
     c                   update    b1wsf                                                     .
     c                   endif                                                           .....
      *
     c                   if        wpvalg <> '2'
     c                   move      *off          *in30
     c                   endif
      *
     c                   move      *on           *in31
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * d2win behandle bilde for  sletting                              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xd2win        begsr
      *
     c     key01         chain     rkwclur
     c                   eval      *in60 = not%found
      *
     c                   eval      wactli = 6
     c                   eval      wactpo = 1
     c                   exfmt     d2win
     c                   exsr      xnulle
      *
     c     *inkc         cabeq     *on           d2tag1
     c     *inkl         cabeq     *on           d2tag1
     c     *in30         cabeq     *on           d2tag1
      *
     c                   if        *in60 = *off                                          .....
     c                             and b1valg = '4'                                          .
     c                   delete    rkwclur                                                   .
     c                   endif                                                           .....
      *
      * oppdater subfile
      *
     c                   if        b1valg = '4'                                          .....
     c                   eval      b1text = *blank                                           .
     c                   movel     mld(4)        b1text                                      .
     c                   endif                                                           .....
      *
     c     d2tag1        tag
      *
     c                   if        b1valg = '4'                                              .
     c                   eval      svrn01 = srrn01                                           .
     c                   eval      b1valg = *blank                                           .
     c                   update    b1wsf                                                     .
     c                   endif                                                           .....
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * tøm subfile                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xclr01        begsr
      *
     c                   move      *on           *in14
     c                   write     b2wct
     c                   move      *off          *in14
      *
     c                   move      *off          *in15
     c                   eval      srrn01 = 0
     c                   eval      sfrn01 = 0
     c                   eval      ssrn01 = 0
     c                   eval      spge01 = 0
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * fyll opp subfile                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xcrt01        begsr
      *
     c                   eval      spge01 = spge01 + 13                         sfl end
     c                   eval      srrn01 = ssrn01
      *
     c                   dou       srrn01 = spge01                                       .....
      *                                                                 .
     c                   read      rkwcpf                                                    .
     c                   eval      *in15 = %eof                                              .
      *                                                                 .
     c     *in15         cabeq     *on           xend01                         eof          .
      *                                                                 .
     c                   if        rnfirm <> wwfirm                                          .
     c                   move      *on           *in15                                       .
     c                   endif                                                               .
      *                                                                 .
     c                   if        rnkund <> wwkund                                          .
     c                   move      *on           *in15                                       .
     c                   endif                                                               .
      *                                                                 .
     c     *in15         cabeq     *on           xend01                         nytt firma   .
      *                                                                 .
      * ved valg "valuta"                                               .
      * test om valutakode = blank                                      .
      *                                                                 .
     c                   if        wvvalg = '1'                                          ... .
     c                   if        rnvalk = *blank                                         . .
     c                   goto      xenddo                                                  . .
     c                   endif                                                             . .
     c                   endif                                                           ... .
      *                                                                 .
     c                   eval      b1biln = rnbiln                                           .
     c                   eval      b1bdat = rnbdat                                           .
     c                   eval      b1tist = rntist                                           .
     c                   eval      b1bilk = rnbilk                                           .
     c                   movel     rntext        b1text                                      .
     c                   eval      b1refn = rnrefn                                           .
     c     *dmy          move      rnbdat        wwbida
     c                   move      wwbida        b1bida
     c     *dmy          move      rnfdat        wwfoda
     c                   move      wwfoda        b1foda
      *                                                                 .
      * valuta/nok                                                      .
      *                                                                 .
     c                   if        wvvalg = '0'                                          ... .
     c                   z-add     rnbelØ        b1belØ                         nok        . .
     c                   z-add     rnrest        b1rest                                    . .
     c                   else                                                              . .
     c                   z-add     rnvalb        b1belØ                         valuta     . .
     c                   z-add     rnvalr        b1rest                                    . .
     c                   move      '    '        b1text                                    . .
     c                   move      rnvalk        b1text                                    . .
     c                   endif                                                           ... .
      *                                                                 .
     c                   eval      srrn01 = srrn01 + 1                                       .
     c                   write     b1wsf                                                     .
      *                                                                 .
     c     xenddo        tag                                                                 .
     c                   enddo                                                           .....
      *
     c     xend01        tag
      *
      * send melding hvis ingen poster
      *
     c                   if        srrn01 = *zero                                        .....
     c                   if        wvvalg = '0'                                        ..... .
     c                   movel     txt(1)        b1text                         alle       . .
     c                   else                                                              . .
     c                   movel     txt(2)        b1text                         valuta     . .
     c                   endif                                                         ..... .
      *                                                                 .
     c                   eval      srrn01 = srrn01 + 1                                       .
     c                   eval      b1biln = *zero                                            .
     c                   eval      b1bdat = *loval                                           .
     c                   eval      b1bilk = *zero                                            .
     c                   eval      b1refn = *zero                                            .
     c                   eval      b1belØ = *zero                                            .
     c                   eval      b1rest = *zero                                            .
     c                   write     b1wsf                                                     .
     c                   endif                                                           .....
      *
     c                   if        srrn01 > ssrn01                                       .....
     c                   eval      sfrn01 = ssrn01 + 1                                       .
     c                   endif                                                           .....
      *
     c                   eval      ssrn01 = srrn01
     c                   eval      svrn01 = sfrn01
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * display subfile                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xdsp01        begsr
      *
     c                   if        srrn01 <> 0                                           .....
     c                   move      *on           *in12                                       .
     c                   endif                                                           .....
      *
     c                   move      *on           *in13
     c                   exfmt     b2wct
     c                   move      *off          *in12
     c                   move      *off          *in13
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * kontroll  c2 bilde (endringer)                                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xsr020        begsr
      *
      * sjekke om bilagskode er gyldig
      *
     c                   eval      p_akod = c2bilk
     c                   call      'RS701R'                                      bilags-
     c                   parm                    p_stat
     c                   parm                    p_akod
     c                   parm                    p_tx20
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in33                          pos.cur.     .
     c                   move      *on           *in81                          error        .
     c                   eval      werror = 1                                                .
     c                   goto      xa2010                                                    .
     c                   endif                                                           .....
      *
      * sjekke om avdeling er gyldig
      *
     c                   if        c2avde <> *zero                                       .....
     c                   eval      p_avde = c2avde                                           .
     c                   call      'RS707R'                                      avdelings-
     c                   parm                    p_stat
     c                   parm                    p_avde
     c                   parm                    p_tx20
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in34                          pos.cur,     .
     c                   move      *on           *in81                          error        .
     c                   eval      werror = 1                                                .
     c                   goto      xa2010                                                    .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * sjekke om selger er gyldig
      *
     c                   if        c2slgr <> *zero                                       .....
     c                   eval      raikod = c2slgr                                           .
     c                   eval      railst = railda                              hent
     c                   call      'RS109R'                                      selger-
     c                   parm                    railst                           kode
     c                   eval      railda = railst
     c                   if        raista = 'N'                                 kode
     c                   move      *on           *in38                          pos.cur.     .
     c                   move      *on           *in81                          error        .
     c                   eval      werror = 1                                                .
     c                   goto      xa2010                                                    .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
     c     xa2010        tag
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * 0-stilling av arbeidsindikatorer og arbeidsfelt                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xnulle        begsr
      *
     c                   eval      *in31 = *off
     c                   eval      *in32 = *off
     c                   eval      *in33 = *off
     c                   eval      *in34 = *off
     c                   eval      *in35 = *off
     c                   eval      *in36 = *off
     c                   eval      werror = *zero
      *
     c                   endsr
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      spge01 = 0
     c                   eval      srrn01 = 0
     c                   eval      wactli = 0
     c                   eval      wactpo = 0
     c                   eval      werror = *zero
     c                   eval      wpfunk = *zero
     c                   eval      wpantp = *zero
     c                   eval      femt0 = *zeros
     c                   eval      sju0 = *zeros
     c                   eval      fem0 = *zeros
     c                   move      *zeros        aqulda
     c                   eval      aqida2 = *date                               kjøredato
     c                   eval      aqidm2 = 'DMÅ'                               datoformat
     c                   move      *on           *in91
      *
      * parametre til notatark.
      *
     c                   eval      wpsyst = 'K'
     c                   eval      wpspes = 0
     c                   eval      wpavde = 0
     c                   eval      wppros = 0
     c                   eval      wpakti = *blanks
      *
      *
      *
      *
      * parameterliste
      *
     c     *entry        plist
     c                   parm                    wpvalg
     c                   parm                    wpkund
     c                   parm                    wwbiln
     c                   parm                    wwrest
      *
      * legge inn firmanummer
      *
     c                   move      l_firm        wwfirm
     c                   eval      raafir = l_firm
     c                   eval      ragfir = l_firm
     c                   eval      raifir = l_firm
     c                   move      wpkund        wwkund
     c                   move      wpkund        b2kund
     c                   eval      wwbiln = *zero
     c                   eval      wwrest = *zero
     c                   eval      wvvalg = '0'                                 nok
      *
      * hent kunde
      *
     c     keyku         chain     rkunpf
     c                   eval      *in61 = not%found
     c                   if        *in61 = *off
     c                   eval      b2navn = rknavn
     c                   endif
      *
      * key for kundeposter via kundenummer
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwkund
     c                   kfld                    wwbdat
     c                   kfld                    wwtist
      *
      * key for kunderegister via kundenummer
      *
     c     keyku         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwkund
      *
      * key for statuskode 1
      *
     c     keya1         klist
     c                   kfld                    wwfirm
      *
      * key for statuskode 3
      *
     c     keya3         klist
     c                   kfld                    wwfirm
      *
     c                   move      wpkund        wwkund
     c                   eval      wwbdat = *loval
     c                   eval      wwtist = *loval
      *
     c     key01         setll     rkwcpf
      *
     c                   exsr      xcrt01
      *
     c                   endsr
      *
     c/eject
**
                           001
  Endring                  002
  Vise                     003
* Slettet *                004
**
Ingen poster               002
Ingen valutaposter         003
