      /TITLE  Utskrift av kvalitetsrapport kunderegister
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK625R                                        *
      * Beskrivelse . . : Utskrift av kvalitetsrapport kunderegister    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.*
      * --------- ------  ----------------------------------------------*
      * V5.50     201005  Nytt program                             KOB  *     *
      *                                                                 *     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     frk625p    o    e             printer oflind(*in30)
      *
     d                uds
     d l_katf                300    303  0
     d l_katt                         4  0
     d l_kadr                         1
     d l_kstd                         1
     d l_kkat                         1
     d l_korg                         1
     d l_kpnr                         1
     d l_kkpe                         1
     d l_kema                         1
     d l_ktlf                         1
     d l_kfax                         1
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_user          s                   like(l_user)
     d w_firm          s                   like(rkfirm)
     d w_feil          s              1
      *
     c     rkunl1_key    reade     rkunl1                                 60                 .
      *
     c                   dow       *in60 = *off                                          .....
      *
     c                   if        %eof
     c                   leave                                                  FERDIG
     c                   endif
      *
      * Sjekk kundekategori fra/til
      *
     c                   if        rkkatg < l_katf or                                    .....
     c                             rkkatg > l_katt                                       .....
     c                   leave                                                               .
     c                   endif                                                           .....
      *
     c                   eval      w_feil = ' '                                              .
      *
     c                   eval      a1kadr = ' '                                              .
     c                   eval      a1kstd = ' '                                              .
     c                   eval      a1kkat = ' '                                              .
     c                   eval      a1korg = ' '                                              .
     c                   eval      a1kpnr = ' '                                              .
     c                   eval      a1kkpe = ' '                                              .
     c                   eval      a1kema = ' '                                              .
     c                   eval      a1ktlf = ' '                                              .
     c                   eval      a1kfax = ' '                                              .
      *
     c                   if        l_kadr = 'J' and                                      .....
     c                             rkgate = ' '                                          .....
     c                   eval      a1kadr = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_kstd = 'J' and                                      .....
     c                             rksted = ' ' and                                      .....
     c                             rkponr = 0                                            .....
     c                   eval      a1kstd = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_kkat = 'J' and                                      .....
     c                             rkkatg = 0                                            .....
     c                   eval      a1kkat = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
      * Pr. kundekategori
      *
     c                   if        l_korg = 'J' and                                      .....
     c                             rkftnr = 0                                            .....
     c                   eval      a1korg = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_kpnr = 'J' and                                      .....
     c                             rkpenr = 0                                            .....
     c                   eval      w_feil = '1'                                              .
     c                   eval      a1kpnr = 'X'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_kkpe = 'J' and                                      .....
     c                             rkpers = ' '                                          .....
     c                   eval      a1kkpe = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_kema = 'J' and                                      .....
     c                             rkemal = ' '                                          .....
     c                   eval      a1kema = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_ktlf = 'J' and                                      .....
     c                             rktlfn = ' '                                          .....
     c                   eval      a1ktlf = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        l_kfax = 'J' and                                      .....
     c                             rktlfx = ' '                                          .....
     c                   eval      a1kfax = 'X'                                              .
     c                   eval      w_feil = '1'                                              .
     c                   endif                                                           .....
      *
     c                   if        w_feil = '1'                                          .....
     c                   write     skriv                                                     .
     c                   endif                                                           .....
      *
      * Sjekker om overflow
      *
     c                   if        *in30 = *on                                        .....  .
     c                   write     head1                                                     .
     c                   eval      *in30 = *off                                              .
     c                   endif                                                           .....
      *
     c     rkunl1_key    reade     rkunl1                                 60
     c                   enddo
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Sette startverdier
      *
     c                   move      l_firm        w_firm
     c                   move      l_user        w_user
      *
     c     rkunl1_key    setll     rkunl1                                                    .
      *
      * Skriv heading på første side
      *
     c                   write     head1
      *
      * Key for kunderegister
      * via kundenummer
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
      *
     c                   endsr
      *
