     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
      *                                                                       *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RE111R                                              *
      * Beskrivelse . . : Oppdaterer leverandører fra Externe systemer        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     fre0lpf    ip  ae           k disk
     fraa1l1    if   e           k disk    rename(raa1pfr:raa1l1r)
     frlevlu    uf a e           k disk    rename(rlevpfr:rlevlur)
      *
     d lo              c                   'abcdefghijklmnopqrstuvwxyzæøåÆØÅ'
     d uh              c                   'ABCDEFGHIJKLMNOPQRSTUVWXYZ²ÔÖ²ÔÖ'
      *
      * LOCAL DATA
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_adr2          s                   like(rladr2)
     d w_alfa          s                   like(rlalfa)
     d w_avde          s                   like(rlavde)
     d w_avts          s                   like(rlavts)
     d w_betb          s                   like(rlbetb)
     d w_bgir          s                   like(rlbgir)
     d w_betm          s                   like(rlbetm)
     d w_bonu          s                   like(rlbonu)
     d w_dist          s                   like(rldist)
     d w_eanl          s                   like(rleanl)
     d w_edik          s                   like(rledik)
     d w_emal          s                   like(rlemal)
     d w_facn          s                   like(rlfacn)
     d w_fact          s                   like(rlfact)
     d w_firm          s                   like(rlfirm)
     d w_form          s                   like(rlform)
     d w_frie          s                   like(rlfrie)
     d w_ftnr          s                   like(rlftnr)
     d w_gate          s                   like(rlgate)
     d w_hyle          s                   like(rlhyle)
     d w_isok          s                   like(rlisok)
     d w_katg          s                   like(rlkatg)
     d w_komn          s                   like(rlkomn)
     d w_kpri          s                   like(rlkpri)
     d w_lagr          s                   like(rllagr)
     d w_land          s                   like(rlland)
     d w_lbet          s                   like(rllbet)
     d w_levr          s                   like(rllevr)
     d w_lvko          s                   like(rllvko)
     d w_mkod          s                   like(rlmkod)
     d w_mobn          s                   like(rlmobn)
     d w_navn          s                   like(rlnavn)
     d w_nobb          s                   like(rlnobb)
     d w_orab          s                   like(rlorab)
     d w_orsk          s                   like(rlorsk)
     d w_pakk          s                   like(rlpakk)
     d w_pers          s                   like(rlpers)
     d w_ponr          s                   like(rlponr)
     d w_ppro          s                   like(rlppro)
     d w_prio          s                   like(rlprio)
     d w_purr          s                   like(rlpurr)
     d w_rabk          s                   like(rlrabk)
     d w_remk          s                   like(rlremk)
     d w_rest          s                   like(rlrest)
     d w_saks          s                   like(rlsaks)
     d w_slet          s                   like(rlslet)
     d w_spes          s                   like(rlspes)
     d w_sprk          s                   like(rlsprk)
     d w_sted          s                   like(rlsted)
     d w_stko          s                   like(rlstko)
     d w_tlfn          s                   like(rltlfn)
     d w_tlfx          s                   like(rltlfx)
     d w_valk          s                   like(rlvalk)
      *
     d rlevlu_levr     s                   like(rllevr)
      *
     c                   if        rlfirm <> l_firm or                          Innenfor grenser
     c                             rllevr > ra1hrs                              Innenfor grenser
     c                   goto      slutt                                         FOR LEVERANDØRER
     c                   endif
      *
     c                   eval      rlfirm = l_firm                              Firma
     c                   eval      w_firm = l_firm                              Firma
     c                   eval      w_levr = rllevr                              Kunde
     c                   eval      w_navn = rlnavn                              Navn
     c                   eval      w_gate = rlgate                              Gate
     c                   eval      w_tlfn = rltlfn                              Telefon
     c                   eval      w_saks = rlsaks                              SAKSBEHANDLER
     c                   eval      w_dist = rldist                              Distrikt
     c                   eval      w_katg = rlkatg                              Kategori
     c                   eval      w_betb = rlbetb                              Betalingsbetingelse
     c                   eval      w_betm = rlbetm                              Betalingsmåte
     c                   eval      w_isok = rlisok                              ISO-kode
     c                   eval      w_fact = rlfact                              Factoring lev.nr.
     c                   eval      w_valk = rlvalk                              Valutakode
     c                   eval      w_sprk = rlsprk                              Sperrekode
     c                   eval      w_mkod = rlmkod                              MVA-kode
     c                   eval      w_form = rlform                              Forsendelsemåte
     c                   eval      w_land = rlland                              Landkode
     c                   eval      w_ponr = rlponr                              Postnummer
     c                   eval      w_sted = rlsted                              Sted
     c                   eval      w_frie = rlfrie                              Frie koder
     c                   eval      w_adr2 = rladr2                              Mellomadresse
     c                   eval      w_alfa = rlalfa                              Alfa søkefelt
      *
     c                   if        w_alfa = *blank
     c                   movel     rlnavn        rlalfa                         Alfa søkefelt
     c                   endif
      *
      * Konvertere alfafelt til store bokstaver
      *
     c     lo:uh         xlate     rlalfa        rlalfa
      *
     c                   eval      w_facn = rlfacn                              Faktoringnummer
     c                   eval      w_avde = rlavde                              Avdeling
     c                   eval      w_rabk = rlrabk                              Rabattkategori
     c                   eval      w_bonu = rlbonu                              Bonuskode
     c                   eval      w_purr = rlpurr                              Purrekode
     c                   eval      w_lbet = rllbet                              Leveringsbetingelse
     c                   eval      w_spes = rlspes                              Spesialavtale
     c                   eval      w_prio = rlprio                              Prioritetskode
     c                   eval      w_avts = rlavts                              Avtalespesifikasjon
     c                   eval      w_tlfx = rltlfx                              Telefaksnummer
     c                   eval      w_rest = rlrest                              Restordre
     c                   eval      w_pakk = rlpakk                              Pakkseddel
     c                   eval      w_lagr = rllagr                              Lager
     c                   eval      w_orsk = rlorsk                              Ordrebekreftelse
     c                   eval      w_orab = rlorab                              Ordrerabatt
     c                   eval      w_kpri = rlkpri                              Kostpriskontering
     c                   eval      w_ppro = rlppro                              Påslagsprosent
     c                   eval      w_pers = rlpers                              Kontaktperson
     c                   eval      w_remk = rlremk                              Remmiteringskode
     c                   eval      w_ftnr = rlftnr                              Foretaksnummer
     c                   eval      w_slet = rlslet                              Slettekode
     c                   eval      w_hyle = rlhyle                              Type hylle-etikett
     c                   eval      w_lvko = rllvko                              Skriv i div. felt
     c                   eval      w_edik = rledik                              EDI-kode
     c                   eval      w_eanl = rleanl                              EAN-Leverandør
     c                   eval      w_komn = rlkomn                              Kommunenummer
     c                   eval      w_nobb = rlnobb                              NOBB-nummer
     c                   eval      w_mobn = rlmobn                              Mobilnummer
     c                   eval      w_emal = rlemal                              E-mail adresse
      *
     c                   eval      rlevlu_levr = rllevr                         E-mail adresse
     c     rlevlu_key    chain     rlevlu
      *
     c                   if        %found                                       ....................
      *
     c                   eval      rlnavn = w_navn                              Navn
     c                   eval      rlgate = w_gate                              Gate
     c                   eval      rladr2 = w_adr2                              Mellomadresse
     c                   eval      rlponr = w_ponr                              Postnummer
     c                   eval      rlsted = w_sted                              Sted
      *
     c                   if        w_tlfn <> *blank
     c                   eval      rltlfn = w_tlfn                              Telefon
     c                   endif
      *
     c                   if        w_saks <> *zero
     c                   eval      rlsaks = w_saks                              Saksbehandler
     c                   endif
      *
     c                   if        w_dist <> *zero
     c                   eval      rldist = w_dist                              Distrikt
     c                   endif
      *
     c                   if        w_katg <> *zero
     c                   eval      rlkatg = w_katg                              Kategori
     c                   endif
      *
     c                   if        w_betb <> *zero
     c                   eval      rlbetb = w_betb                              Betalingsbetingelse
     c                   endif
      *
     c                   if        w_betm <> *zero
     c                   eval      rlbetm = w_betm                              Betalingsmåte
     c                   endif
      *
     c                   if        w_bgir <> *zero
     c                   eval      rlbgir = w_bgir                              Bankgiro
     c                   endif
      *
     c                   if        w_isok <> *zero
     c                   eval      rlisok = w_isok
     c                   endif
      *
     c                   if        w_fact <> *zero
     c                   eval      rlfact = w_fact                              Factoring lev.nr.
     c                   endif
      *
     c                   if        w_valk <> *blank
     c                   eval      rlvalk = w_valk                              Valutakode
     c                   endif
      *
     c                   if        w_sprk <> *blank
     c                   eval      rlsprk = w_sprk                              Sperrekode
     c                   endif
      *
     c                   if        w_mkod <> *zero
     c                   eval      rlmkod = w_mkod                              MVA-kode
     c                   endif
      *
     c                   if        w_form <> *zero
     c                   eval      rlform = w_form                              Forsendelsemåte
     c                   endif
      *
     c                   if        w_land <> *blank
     c                   eval      rlland = w_land                              Landkode
     c                   endif
      *
     c                   if        w_frie <> *blank
     c                   eval      rlfrie = w_frie                              Frie koder
     c                   endif
      *
     c                   if        w_alfa <> *blank
     c                   eval      rlalfa = w_alfa                              Alfa søkefelt
     c                   endif
      *
     c                   if        w_facn <> *zero
     c                   eval      rlfacn = w_facn                              Faktoringnummer
     c                   endif
      *
     c                   if        w_avde <> *zero
     c                   eval      rlavde = w_avde                              Avdeling
     c                   endif
      *
     c                   if        w_rabk <> *zero
     c                   eval      rlrabk = w_rabk                              Rabattkategori
     c                   endif
      *
     c                   if        w_bonu <> *zero
     c                   eval      rlbonu = w_bonu                              Bonuskode
     c                   endif
      *
     c                   if        w_purr <> *zero
     c                   eval      rlpurr = w_purr                              Purrekode
     c                   endif
      *
     c                   if        w_lbet <> *zero
     c                   eval      rllbet = w_lbet                              Leveringsbetingelse
     c                   endif
      *
     c                   if        w_spes <> *zero
     c                   eval      rlspes = w_spes                              Spesialavtale
     c                   endif
      *
     c                   if        w_prio <> *zero
     c                   eval      rlprio = w_prio                              Prioritetskode
     c                   endif
      *
     c                   if        w_avts <> *blank
     c                   eval      rlavts = w_avts                              Avtalespesifikasjon
     c                   endif
      *
     c                   if        w_tlfx <> *blank
     c                   eval      rltlfx = w_tlfx                              Telefaksnummer
     c                   endif
      *
     c                   if        w_rest <> *zero
     c                   eval      rlrest = w_rest                              Restordre
     c                   endif
      *
     c                   if        w_pakk <> *zero
     c                   eval      rlpakk = w_pakk                              Pakkseddel
     c                   endif
      *
     c                   if        w_lagr <> *zero
     c                   eval      rllagr = w_lagr                              Lager
     c                   endif
      *
     c                   if        w_orsk <> *zero
     c                   eval      rlorsk = w_orsk                              Ordrebekreftelse
     c                   endif
      *
     c                   if        w_orab <> *zero
     c                   eval      rlorab = w_orab                              Ordrerabatt
     c                   endif
      *
     c                   if        w_stko <> *zero
     c                   eval      rlstko = w_stko                              Frie statistikk kode
     c                   endif
      *
     c                   if        w_kpri <> *zero
     c                   eval      rlkpri = w_kpri                              Kostpriskontering
     c                   endif
      *
     c                   if        w_ppro <> *zero
     c                   eval      rlppro = w_ppro                              Påslagsprosent
     c                   endif
      *
     c                   if        w_pers <> *blank
     c                   eval      rlpers = w_pers                              Kontaktperson
     c                   endif
      *
     c                   if        w_remk <> *zero
     c                   eval      rlremk = w_remk                              Remmiteringskode
     c                   endif
      *
     c                   if        w_ftnr <> *zero
     c                   eval      rlftnr = w_ftnr                              Foretaksnummer
     c                   endif
      *
     c                   if        w_slet <> *blank
     c                   eval      rlslet = w_slet                              Slettekode
     c                   endif
      *
     c                   if        w_hyle <> *zero
     c                   eval      rlhyle = w_hyle                              Type hylle-etikett
     c                   endif
      *
     c                   if        w_lvko <> *zero
     c                   eval      rllvko = w_lvko                              Skriv i div.felt
     c                   endif
      *
     c                   if        w_edik <> *blank
     c                   eval      rledik = w_edik                              EDI-kode
     c                   endif
      *
     c                   if        w_eanl <> *zero
     c                   eval      rleanl = w_eanl                              EAN-leverandør
     c                   endif
      *
     c                   if        w_komn <> *zero
     c                   eval      rlkomn = w_komn                              Kommunenummer
     c                   endif
      *
     c                   if        w_nobb <> *zero
     c                   eval      rlnobb = w_nobb                              NOBB-nummer
     c                   endif
      *
     c                   if        w_mobn <> *blank
     c                   eval      rlmobn = w_mobn                              Mobilnummer
     c                   endif
      *
     c                   if        w_emal <> *blank
     c                   eval      rlemal = w_emal                              E-mail adresse
     c                   endif
      *
     c                   endif                                                  ....................
      *
     c                   if        not%found                                    ....................
      *
     c                   eval      rlsald = *zeros                              Saldo
     c                   eval      rlkjØp = *zeros                              Kjøp
     c                   eval      rlktid = *zeros                              Kredittid
      *
     c                   eval      rlkjØf = *zeros                              Kjøp i fjor
     c                   eval      rlsaif = *zeros                              SALDO i fjor
      *
     c                   if        rlbetm = *zero                               Bruk standard     .
     c                   move      ra1bel        rlbetm                          betalingsmåte    .
     c                   endif                                                                    .
      *
     c                   time                    rlndat
     c                   time                    rlntim
     c                   eval      rlnsig = l_user
     c                   time                    rledat
     c                   time                    rletim
     c                   eval      rlesig = l_user
     c                   endif                                                  ....................
      *
6.10 c                   time                    rl2dpt
6.10 c                   eval      rlepgm = 'RE111R    '
      *
     c                   if        not%found
     c                   write     rlevlur                                      Skriv kunde
     c                   else
     c                   update    rlevlur                                      Oppdater kunde
     c                   endif
      *
     c     slutt         tag
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Legge inn firmanummer og navn fra LDA
      *
     c                   eval      w_firm = l_firm
      *
     c     raa1l1_key    chain     raa1l1                             60
      *
      * Key for statuskode 1
      *
     c     raa1l1_key    klist
     c                   kfld                    w_firm
      *
      *
      *
     c     rlevlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rlevlu_levr
      *
     c                   endsr
