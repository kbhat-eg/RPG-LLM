     h/TITLE    Oppdatering av autogirokode med dato
     h option(*nodebugio)
     h decedit(',') datedit(*dmy.)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK822R                                              *
      * Beskrivelse . . : Oppdatering av autogirokode med dato                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
6.10  * V6.10     210909  Lagt inn sporingsfelter                        BSA  *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frkw4pf    if   e           k disk
     frktrlu    uf   e           k disk    rename(rktrpfr:rktrlur)
      *
     d                 ds
     d d_parm                       120
     d  pfirm                         3  0 overlay(d_parm)
     d  pnavn                        30    overlay(d_parm:4)
     d  puser                        10    overlay(d_parm:34)
     d  pkdat                         6  0 overlay(d_parm:44)
     d  praar                         4  0 overlay(d_parm:50)
     d  prper                         2  0 overlay(d_parm:54)
     d  pavdf                         4  0 overlay(d_parm:56)
     d  pavdt                         4  0 overlay(d_parm:60)
     d  pkatf                         4  0 overlay(d_parm:64)
     d  pkatt                         4  0 overlay(d_parm:68)
     d  pself                         4  0 overlay(d_parm:72)
     d  pselt                         4  0 overlay(d_parm:76)
     d  pknrf                         6  0 overlay(d_parm:80)
     d  pknrt                         6  0 overlay(d_parm:86)
     d  pbilf                         6  0 overlay(d_parm:92)
     d  pbilt                         6  0 overlay(d_parm:98)
     d  pfdat                         6  0 overlay(d_parm:104)
     d  palfa                         1    overlay(d_parm:110)
     d                 ds
     d wwdato                         8  0
     d  wwaar                         4  0 overlay(wwdato)
     d  wwmnd                         2  0 overlay(wwdato:5)
     d  wwdag                         2  0 overlay(wwdato:7)
      *
     d w_parm          s            120
     d wnantp          s                   like(rnantp)
     d wpakod          s              2  0
     d wpffir          s              3
     d wpfnav          s             30
     d wpuser          s             10
     d wwwÅr           s                   like(wpakod)
      *
6.10 d                uds
6.10 d l_user                911    920
      *
      *  --------------------------------
      *  OPPDATER ANTALL PURRINGER + INKASSOKODE (+dato!!)
      *  --------------------------------
      *
     c     kwakey        setll     rkw4pf
     c                   read      rkw4pf
      *
     c                   dow       not %eof
     c     rnkey         chain     rktrlu                             10
      *
     c                   if        %found
     c                   eval      rninko = 'A'                                 KODE - Sendt autogir
     c     *dmy          move      pkdat         rnidat
     c*                  eval      rnstat = 'A '                                Merket for autogiro
     c                   eval      rnauto = 'A '                                Merket for autogiro
6.10 c                   time                    rnedat
6.10 c                   time                    rnetim
6.10 c                   eval      rneusr = l_user
 001 c                   update    rktrlur
E001 c                   endif
      *
     c                   read      rkw4pf
     c                   enddo
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    w_parm
     c                   eval      d_parm = w_parm
      *
     c                   eval      wpakod = *zero
      *
     c                   movel     pkdat         wwaar
     c                   move      wwaar         wwmnd
     c                   movel     wwaar         wwdag
     c                   move      pkdat         wwwÅr
     c                   eval      wwaar = wwwÅr
B001 c                   if        wwwÅr < 81
 001 c                   movel     20            wwaar
X001 c                   else
 001 c                   movel     19            wwaar
E001 c                   endif
      *
      * Key for kundeposteringer
      *
     c     rnkey         klist
     c                   kfld                    rnfirm
     c                   kfld                    rnkund
     c                   kfld                    rnbdat
     c                   kfld                    rntist
      *
     c     kwakey        klist
     c                   kfld                    rwkkey
      *
     c                   endsr
