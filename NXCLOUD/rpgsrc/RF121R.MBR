      /TITLE  Tildeler riktig periode i.h.t. bankreferanse
     h dftname(rf121r) datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RF121R                                        *
      * Beskrivelse . . : Tildeler samme periode med lik referanse      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.*
      * --------- ------  ----------------------------------------------*
T5.00 * R5.00     140103  Rettet feil i WSRAAR.                    HFL  *
T5.30 * R5.30     020605  Splitting på periode er endret           HFL  *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frjoupf    up   e           k disk
     fraa3l1    if   e           k disk    rename(raa3pfr:raa3l1r)
      *
610  d                uds
610  d l_user                911    920
     d per             s              2  0 dim(13) ctdata perrcd(13)            PERIODER
      *
      *       KEY-REKKEFØLGE PÅ RJOUPF (POSTER UT)
      *
     d                 ds
     d wssort                  2     37
     d  wsfirm                        3  0 overlay(wssort)
     d  wsbref                       12    overlay(wssort:4)
     d  waar                          2  0 overlay(wssort:18)
     d  wmnd                          2  0 overlay(wssort:20)
     d  wdag                          2  0 overlay(wssort:22)
      *
     d wsraar          s                   like(rjraar)
     d wsrper          s                   like(rjrper)
     d w_firm          s                   like(rjfirm)
610  d w_memb          s                   like(rjmemb)
      *
     irjoupfr
     i                                          rjfirm        l3
     i                                          rjbref        l2
T5.30i                                          rjbdat        l1
      *
610   *
610  c                   if        rjmemb > w_memb
610  c                   move      *on           *inlr
610  c                   goto      end
610  c                   endif
610   *
610  c                   if        rjmemb <> w_memb
610  c                   move      *off          *inl1
610  c                   move      *off          *inl2
610  c                   move      *off          *inl3
610  c                   goto      end
610  c                   endif
      *
      * Brudd på Firma
     c   l3              do                                                              .....
      *                                                                 .
      * Hent tabell for avvikende regnskapsår                           .
      *                                                                 .
     c                   move      rjfirm        w_firm                                      .
     c     raa3l1_key    chain     raa3l1                             61                     .
      *                                                                 .
     c                   if        *in61 = *off                                          .....
     c                   move      ra3p01        per(01)                                     .
     c                   move      ra3p02        per(02)                                     .
     c                   move      ra3p03        per(03)                                     .
     c                   move      ra3p04        per(04)                                     .
     c                   move      ra3p05        per(05)                                     .
     c                   move      ra3p06        per(06)                                     .
     c                   move      ra3p07        per(07)                                     .
     c                   move      ra3p08        per(08)                                     .
     c                   move      ra3p09        per(09)                                     .
     c                   move      ra3p10        per(10)                                     .
     c                   move      ra3p11        per(11)                                     .
     c                   move      ra3p12        per(12)                                     .
     c                   move      ra3p13        per(13)                                     .
     c                   endif                                                           .....
      *                                                                 .
     c                   if        *in61 = *on                                           .....
     c                   move      01            ra3stp                                      .
     c                   endif                                                           .....
      *                                                                 .
     c                   enddo                                                           .....
      *
      * Brudd referanse
      *
S5.30c*  l2              do
T5.30c   l1              do
      *
     c                   move      rjsort        wssort
     c                   move      per(wmnd)     wsrper
T5.00c                   move      2000          wsraar
     c                   move      waar          wsraar
      *
     c                   if        wmnd < ra3stp                                ...............
     c                   eval      wsraar = wsraar - 1                                        .
      *
     c                   if        waar = *zeros                                ..........    .
E5.00c                   eval      wsraar = 2099                                         .    .
     c                   endif                                                  ..........    .
      *
     c                   endif                                                  ...............
      *
     c                   enddo
      *
     c                   move      wsrper        rjrper
     c                   move      wsraar        rjraar
610  c                   time                    rjedat
610  c                   time                    rjetim
610  c                   eval      rjeusr = l_user
      *
     c                   update    rjoupfr
      *
610  c     end           tag
     c     *inzsr        begsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
610  c     *entry        plist
610  c                   parm                    w_memb                         user
      *
      * Key for statuskode 3
      *
     c     raa3l1_key    klist
     c                   kfld                    w_firm
      *
     c                   endsr
      *
** TAB - NORMALT REGNSKAPSÅR
01020304050607080910111213
