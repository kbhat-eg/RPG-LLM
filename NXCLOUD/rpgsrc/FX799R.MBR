     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOFAK
      * Program . . . . : FX799R
      * Beskrivelse . . : Kontohenvisning, kontrollprogram
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       171003 AMD  Nytt program for kontroll av kontohenvisning
6.10  *       030811 bof  Sjekker om varenr finnes - gir feilmelding
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *       30 = Protect av felter ved vise
      *    31-79 = Varsle m/feilmeldinger/skjermindikatorer
      *    80-99 = Arbeidsindikatorer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     ffx799d    cf   e             workstn
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Datastruktur for kontoinformasjon
      *
     d                 ds
     d d_hele                       128
     d  d_kav1                        4  0 overlay(d_hele)
     d  d_kko1                        6  0 overlay(d_hele:5)
     d  d_ksp1                        4  0 overlay(d_hele:11)
     d  d_kav2                        4  0 overlay(d_hele:15)
     d  d_kko2                        6  0 overlay(d_hele:19)
     d  d_ksp2                        4  0 overlay(d_hele:25)
     d  d_kav3                        4  0 overlay(d_hele:29)
     d  d_kko3                        6  0 overlay(d_hele:33)
     d  d_ksp3                        4  0 overlay(d_hele:39)
     d  d_kav4                        4  0 overlay(d_hele:43)
     d  d_kko4                        6  0 overlay(d_hele:47)
     d  d_ksp4                        4  0 overlay(d_hele:53)
     d  d_kav5                        4  0 overlay(d_hele:57)
     d  d_kko5                        6  0 overlay(d_hele:61)
     d  d_ksp5                        4  0 overlay(d_hele:67)
     d  d_kav6                        4  0 overlay(d_hele:71)
     d  d_kko6                        6  0 overlay(d_hele:75)
     d  d_ksp6                        4  0 overlay(d_hele:81)
     d  d_kav7                        4  0 overlay(d_hele:85)
     d  d_kko7                        6  0 overlay(d_hele:89)
     d  d_ksp7                        4  0 overlay(d_hele:95)
     d  d_khnv                        4    overlay(d_hele:99)
     d  d_nivo                        1    overlay(d_hele:103)
      *
      * Definering av variabler i nøkler
      *
     d vvarl1_vare     s                   like(vvvare)
      *
      * Definering av variable
      *
      *
     d w_stat          s              1
     d w_hele          s            128
     d w_ogrp          s              2  0
     d w_hgrp          s              2  0
     d w_ugrp          s              3  0
     d w_vare          s             15
      *
6.10 d b_feil          s              1    inz(*off)
      *
     d w_firm          s              3  0
      *
      * Definering av konstanter
      *
      *
      *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      * C1BLD  - C1 Skjermbilde for innlegging av nøkkel ved oppretting
      * C2BLD  - C2 Skjermbilde for opprette/endre/vise
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Behandling av Åpningsbildet
      *
     c                   exsr      xc1bld
      *
      * Avslutt program
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av skjermbilde (C1BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc1bld        begsr
      *
     c                   eval      c1vare = *zero
     c                   eval      c1klty = *zero
     c                   eval      c1koty = *blank
      *
     c     c1taga        tag
      *
     c                   exfmt     c1bld
      *
      * Behandling av funksjonstaster
      *
     c                   select
     c                   when      *inkc or *inkl
     c                   goto      end_c1bld
     c                   endsl
      *
     c                   if        c1vare = 0
     c                   goto      end_c1bld
     c                   endif
      *
      * Gå til neste bilde
      *
     c                   exsr      xc2bld
6.10  *
6.10 c                   if        b_feil = *on
6.10 c                   eval      *in31  = *on
6.10 c                   goto      c1taga
6.10 c                   endif
      *
     c                   eval      c1vare = *zero
     c                   eval      c1klty = *zero
     c                   eval      c1koty = *blank
      *
     c                   goto      c1taga
      *
     c     end_c1bld     tag
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å behandle bilde (C2BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc2bld        begsr
6.10 c                   eval      b_feil = *off
      *
     c                   movel     c1vare        w_vare
      *
      * Hent opplysninger fra VARE-REGISTER
      *
     c                   eval      vvarl1_vare = w_vare
     c     vvarl1_key    chain     vvarl1r
6.10 c                   if        not %found(vvarl1)
6.10 c                   eval      b_feil = *on
6.10 c                   leavesr
6.10 c                   else
     c                   eval      w_ogrp = vvogrp
     c                   eval      w_hgrp = vvhgrp
     c                   eval      w_ugrp = vvugrp
     c                   endif
      *
      * Kaller opp program for kontohenvisning
      *
     c                   call      'VA720R'
     c                   parm                    w_stat
     c                   parm                    c1klty
     c                   parm                    c1koty
     c                   parm                    w_ogrp
     c                   parm                    w_hgrp
     c                   parm                    w_ugrp
     c                   parm                    w_vare
     c                   parm                    w_hele
      *
     c                   eval      d_hele = w_hele                                            .
      *
     c                   if        w_stat = *blank
     c                   eval      c2kav1 = d_kav1                                            .
     c                   eval      c2kko1 = d_kko1                                            .
     c                   eval      c2ksp1 = d_ksp1                                            .
     c                   eval      c2kav2 = d_kav2                                            .
     c                   eval      c2kko2 = d_kko2                                            .
     c                   eval      c2ksp2 = d_ksp2                                            .
     c                   eval      c2kav3 = d_kav3                                            .
     c                   eval      c2kko3 = d_kko3                                            .
     c                   eval      c2ksp3 = d_ksp3                                            .
     c                   eval      c2kav4 = d_kav4                                            .
     c                   eval      c2kko4 = d_kko4                                            .
     c                   eval      c2ksp4 = d_ksp4                                            .
     c                   eval      c2kav5 = d_kav5                                            .
     c                   eval      c2kko5 = d_kko5                                            .
     c                   eval      c2ksp5 = d_ksp5                                            .
     c                   eval      c2kav6 = d_kav6                                            .
     c                   eval      c2kko6 = d_kko6                                            .
     c                   eval      c2ksp6 = d_ksp6                                            .
     c                   eval      c2kav7 = d_kav7                                            .
     c                   eval      c2kko7 = d_kko7                                            .
     c                   eval      c2ksp7 = d_ksp7                                            .
     c                   eval      c2khnv = d_khnv                                            .
     c                   else
     c                   eval      c2kav1 = 0                                                 .
     c                   eval      c2kko1 = 0                                                 .
     c                   eval      c2ksp1 = 0                                                 .
     c                   eval      c2kav2 = 0                                                 .
     c                   eval      c2kko2 = 0                                                 .
     c                   eval      c2ksp2 = 0                                                 .
     c                   eval      c2kav3 = 0                                                 .
     c                   eval      c2kko3 = 0                                                 .
     c                   eval      c2ksp3 = 0                                                 .
     c                   eval      c2kav4 = 0                                                 .
     c                   eval      c2kko4 = 0                                                 .
     c                   eval      c2ksp4 = 0                                                 .
     c                   eval      c2kav5 = 0                                                 .
     c                   eval      c2kko5 = 0                                                 .
     c                   eval      c2ksp5 = 0                                                 .
     c                   eval      c2kav6 = 0                                                 .
     c                   eval      c2kko6 = 0                                                 .
     c                   eval      c2ksp6 = 0                                                 .
     c                   eval      c2kav7 = 0                                                 .
     c                   eval      c2kko7 = 0                                                 .
     c                   eval      c2ksp7 = 0                                                 .
     c                   eval      c2khnv = *blank                                            .
     c                   endif
      *
      * Legg inn informasjon om hvilket nivå
      * kontohenvisning er hentet i fra
      *
     c                   if        w_stat = *blank
      *
     c                   if        d_nivo = '1'
     c                   eval      c2nivo = 'Statusregister      '                            .
     c                   endif
      *
     c                   if        d_nivo = '2'
     c                   eval      c2nivo = 'Overgruppe          '                            .
     c                   endif
      *
     c                   if        d_nivo = '3'
     c                   eval      c2nivo = 'Hovedgruppe         '                            .
     c                   endif
      *
     c                   if        d_nivo = '4'
     c                   eval      c2nivo = 'Undergruppe         '                            .
     c                   endif
      *
     c                   if        d_nivo = '5'
     c                   eval      c2nivo = 'Vareregister        '                            .
     c                   endif
      *
     c                   if        d_nivo = ' '
     c                   eval      c2nivo = 'Feil i innhenting   '                            .
     c                   endif
      *
     c                   else
     c                   eval      c2nivo = 'Feil i innhenting   '                            .
      *
     c                   endif
      *
     c                   exfmt     c2bld
      *
     c                   if        *inkc or *inkl
     c                   goto      end_c2bld
     c                   endif
      *
     c     end_c2bld     tag
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for file : VARE-REGISTER
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Henter firma fra LDA
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
