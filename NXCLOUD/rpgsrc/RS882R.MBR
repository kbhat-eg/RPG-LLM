      /TITLE  Kontroll av gyldig arb.ordre
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RS882R                                              *
      * Beskrivelse . . : Kontroll av gyldig arb.ordre                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *    60-61 = Fileindikatorer chain etc.                           *
      *                                                                 *
      *  BRUK AV RETURKODE                                              *
      *                                                                 *
      *  N = Arbeidsordre finnes ikke i registeret                      *
      *  S = Arbeidsordre er avsluttet                                  *
      *                                                                 *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frp4ol1    if   e           k disk    rename(rp4opfr:rp4ol1r)
     frp1pl1    if   e           k disk    rename(rp1ppfr:rp1pl1r)
      *
     d txt             s             30    dim(2) ctdata perrcd(1)
      *
     d p_firm          s                   like(rp4frm)
     d p_arb           s                   like(rp4ord)
     d p_proj          s                   like(rp4pro)
     d p_upro          s                   like(rp4upr)
     d p_akti          s                   like(rp4akt)
     d p_retk          s              1
     d p_txt1          s                   like(rp4txt)
     d p_txt2          s                   like(rp4tx2)
     d p_prt1          s                   like(rp4tx2)
      *
     d w_firm          s                   like(rp4frm)
      *
     d rp4ol1_arb      s                   like(rp4ord)
     d rp1pl1_pro      s                   like(rp1pro)
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_retk
     c                   parm                    p_arb
     c                   parm                    p_proj
     c                   parm                    p_upro
     c                   parm                    p_akti
     c                   parm                    p_txt1
     c                   parm                    p_txt2
     c                   parm                    p_prt1
      *
      * Legge inn firmanummer
      *
     c                   eval      w_firm = l_firm
     c                   eval      p_retk = *blank
     c                   eval      p_proj = *blank
     c                   eval      p_upro = *blank
     c                   eval      p_akti = *blank
     c                   eval      p_txt1 = *blank
     c                   eval      p_txt2 = *blank
     c                   eval      p_prt1 = *blank
      *
      * Sjekke arb.ordre
      *
     c                   eval      rp4ol1_arb = p_arb
     c     rp4ol1_key    chain     rp4ol1r                            60
      *
      * Sjekk om aktivitetf innes
      *
     c                   if        *in60 = *on
     c     rp4ol1_key    chain     rp4ol1r                            60
     c                   endif
      *
      * Sjekk om prosjekt uten konto finnes
      *
     c                   if        *in60 = *on
     c     rp4ol1_key    chain     rp4ol1                             60
     c                   endif
      *
      * Sjekk om prosjekt uten aktivitet finnes
      *
     c                   if        *in60 = *on
     c     rp4ol1_key    chain     rp4ol1                             60
     c                   endif
      *
     c                   if        *in60 = *on
     c                   move      'N'           p_retk
     c                   move      txt(1)        p_txt1
     c                   goto      slutt
     c                   endif
      *
      * Er arb.ordre?
      *
     c**                 if        rp1sts <> *loval
     c**                 move      'S'           p_retk
     c**                 endif
      *
     c                   move      rp4txt        p_txt1
     c                   move      rp4tx2        p_txt2
     c                   move      rp4pro        p_proj
     c                   move      rp4upr        p_upro
     c                   move      rp4akt        p_akti
      *
      * Hent tekst for prosjekt
     c                   eval      rp1pl1_pro = p_proj
     c     rp1pl1_key    chain     rp1pl1r                            60
     c                   if        *in60 = *off
     c                   move      rp1txt        p_prt1
     c                   endif
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *
      * Key for arbeidsordre
      *
     c     rp4ol1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rp4ol1_arb
      *
      *
     c     rp1pl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rp1pl1_pro
      *
     c                   endsr
**
ARBEIDSORDRE ER UGYLDIG
ARBIDSORDREN ER AVLUTTET
