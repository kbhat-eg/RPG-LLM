     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  System. . . . . : ASOFAK
      *  Program . . . . : Fo535R
      *  Beskrivelse . . : Generere unike KID benyttes ved Santander betaling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Spesialversjon. :
      *  Tilpasset for . :
      *
      *  Referanse  Dato   Endringsbeskrivelse                     Sign.
      *  --------- ------  -------------------------------------------------
      *            151117  Nytt program                            bsa
7.01  *   7.01     211217  Feil modulustall beregnet               bsa
7.02  *   7.02     110121  Feil i utlegg av timestamp              bsa
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      *  Definering av datastrukturer for filnavn
      *
     d                 ds
     d d_kidr                        26
     d  d_part_01                     2  0 overlay(d_kidr)
     d  d_part_02                     2  0 overlay(d_kidr:3)
     d  d_part_03                     1    overlay(d_kidr:5)
     d  d_part_04                     2  0 overlay(d_kidr:6)
     d  d_part_05                     1    overlay(d_kidr:8)
     d  d_part_06                     2  0 overlay(d_kidr:9)
     d  d_part_07                     1    overlay(d_kidr:11)
     d  d_part_08                     2  0 overlay(d_kidr:12)
     d  d_part_09                     1    overlay(d_kidr:14)
     d  d_part_10                     2  0 overlay(d_kidr:15)
     d  d_part_11                     1    overlay(d_kidr:17)
     d  d_part_12                     2  0 overlay(d_kidr:18)
     d  d_part_13                     1    overlay(d_kidr:20)
7.02 d* d_part_14                     5  0 overlay(d_kidr:21)
7.02 d  d_part_14                     3  0 overlay(d_kidr:21)
     d  d_part_15                     1  0 overlay(d_kidr:26)
     d                 ds
     d d_kida                        18
     d  d_del                        17    overlay(d_kida)
     d  d_del_01                      2  0 overlay(d_kida)
     d  d_del_02                      2  0 overlay(d_kida:3)
     d  d_del_03                      2  0 overlay(d_kida:5)
     d  d_del_04                      2  0 overlay(d_kida:7)
     d  d_del_05                      2  0 overlay(d_kida:9)
     d  d_del_06                      2  0 overlay(d_kida:11)
     d  d_del_07                      2  0 overlay(d_kida:13)
7.02 d  d_del_08                      3  0 overlay(d_kida:15)
     d  d_kmod                        1  0 overlay(d_kida:18)
     d                 ds
      *
      *  Definering av variable i parameter
      *
     d p_kida          s             18
     d p_kidn          s             18  0
      *
      * Definering av øvrige variable
      *
     d w_tmstp         s               z
     d w_ksif          s              1  0
     d w_kkus          s             24
9.xx d t_kkus          s             17
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Henter timestamp og bygger filanvn
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   time                    w_tmstp
      *
     c                   movel     w_tmstp       d_kidr
7.02 c*                  eval      d_del_02 = d_part_04
7.02 c*                  eval      d_del_03 = d_part_06
     c*                  eval      d_del_04 = d_part_08
     c*                  eval      d_del_05 = d_part_10
     c*                  eval      d_del_06 = d_part_12
     c*                  eval      d_del_07 = d_part_14
7.02 c                   eval      d_del_01 = d_part_01
7.02 c                   eval      d_del_02 = d_part_02
7.02 c                   eval      d_del_03 = d_part_04
7.02 c                   eval      d_del_04 = d_part_06
7.02 c                   eval      d_del_05 = d_part_08
7.02 c                   eval      d_del_06 = d_part_10
7.02 c                   eval      d_del_07 = d_part_12
7.02 c                   eval      d_del_08 = d_part_14
      *
      * Beregning av sjekksiffer på kiddfelt
      *
     c**                 eval      w_kkus = '17122113591422000'
9.xx c**                 eval      t_kkus = '17122113591422000'
9.xx c*                  move      t_kkus        w_kkus
9.01 c**                 eval      w_kkus = d_del
9.01 c                   move      d_del         w_kkus
     c                   call      'AK720R'
     c                   parm                    w_kkus
     c                   parm                    w_ksif
      *
     c                   eval      d_kmod = w_ksif
     c                   eval      p_kida = d_kida
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     end_pgm       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_kida
      *
     c                   endsr
