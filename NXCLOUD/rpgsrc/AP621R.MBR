      /TITLE  Skjermvisning av PDF utskrifter
     H DECEDIT('0.') DATEDIT(*DMY.) option(*nodebugio)
     h DftActgrp(*No)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Program . . . . : AP621R
      * Beskrivelse . . : Skjermvisning av PDF utskrifter
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- - - - - - - - - - - - - - - - - - - - - - - - - -
      *       290410 BSA  Nytt program
6.20  *       020113 BSA  Kaller nytt program for selve visningen
6.30  *       190115 BSA  Kaller nytt program for selve visningen - del 2
7.xx  *       130418 BKV  Justeringer basert på ny GUI og regler
7.01  *       130418 BKV  Ikke bruk skjerm
Q.01  * 7.00  080219 bsa  Quick wins - takler bredere skjerm
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     fafpslr    if   e           k disk    rename(afpspfr:afpslrr)
7.01  * fap621d    cf   e             workstn
      *
      * Definering av parametre
      *
     d p_jkey          s             41
6.20 d p_link          s            256
      *
      * Definering av variabler i nøkler
      *
     d afpslr_ufil     s                   like(l_filg)
     d afpslr_uide     s                   like(afuide)
      *
      * Definering av variable
      *
     d w_date          s               d   datfmt(*iso)
     d w_jkey          s             41
     d w_brpt          s             60
     d prvpath         s            100
     d w_sti           s             11
      *
      *
      * - - - - - - - - - - - - - -
      * Henter inn data fra LDA
      * - - - - - - - - - - - - - -
      *
     d                uds
     d l_ruti                800    809
     d l_outq                810    819
     d l_wsid                901    910
     d l_user                911    920
     d l_filg                931    933
     d l_firm                944    946  0
      *
      *
      * Definering av variabler i nøkler
      *
      *
      * Definering av variable
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Vi bygger opp path til PDF og launcher browser                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c                   eval      w_brpt = %trim(p_jkey)
     c                   eval      Cmd160 = 'STRPCCMD PCCMD(''start '+
     c                             %trim(prvpath)+%Trim(w_brpt)+''') Pause(*no)'
6.20  *
6.20 c                   eval      p_link = %trim(prvpath)+%Trim(w_brpt)
6.20  *
6.30 c                   call      'AP628C'
6.20 c                   parm                    p_link
6.20  *
6.20 c                   goto      end_prv
      *
      * Sender opp "ramme" for skjermbildet
      *
7.01 c*                   eval      a1path = %trim(prvpath)
7.01 c*                   eval      a1pkey = %trim(w_brpt)
7.01  **
7.01 c*                   write     s1win
7.01  **
7.01  ** Sender opp skjermbildet
7.01  **
7.01 c*                   exfmt     a1win
7.01  **
7.01  ** Annullere registrering.
7.01  **
7.01 c*                   if        *inkc = *on
7.01 c*                   goto      end_prv
7.01 c*                   endif
7.01  **
7.01 c*                   if        *inkl = *on
7.01 c*                   goto      end_prv
7.01 c*                   endif
      *
      * Initier link
      *
     c                   Call      'QCMDEXC'
     c                   Parm                    CMD160          160
     c                   Parm      160           CMDLEN           15 5
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     end_prv       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_jkey
      *
      * Key for propertiesfil
      *
     c     afpslr_key    klist
     c                   kfld                    afpslr_ufil
     c                   kfld                    afpslr_uide
      *
      *---------------------------------------------------------------
      *
     c                   time                    w_date
      *
      * Hent inn path til preview
      *
     c                   eval      afpslr_ufil = l_filg
     c                   eval      afpslr_uide = 'PREVPATH  '
     c     afpslr_key    chain     afpslrr
     c                   if        %found
     c                   eval      prvpath = *blanks
     c                   movel     afudss        prvpath
     c                   endif
      *
7.01 c*                   eval      w_alin = 5
7.01 c*                   eval      w_apos = 10
      *
     c                   endsr
      *
