      /TITLE  Vedlikehold av statuskoder  -  1 + 3
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RA006R                                              *
      * Beskrivelse . . : Vedlikehold av statuskoder - 6                      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *                                                                       *
      *                                                                       *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fraa6l1    if   e           k disk    rename(raa6pfr:raa6l1r)
     fraa6lu    uf a e           k disk    rename(raa6pfr:raa6lur)
     fra006d    cf   e             workstn
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_firm          s                   like(ra6fir)
     d p_stat          s              1
     d p_ckod          s              2  0
     d p_ctxt          s             20
     d p_ctx2          s             20
      *
     c     dummy         tag
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A2BLD Behandle bilde for vedlikehold av statuskode 6            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a2taga        tag
      *
      * Bare data
      *
     c     a2tagb        tag
     c                   exfmt     a2bld
     c                   eval      *in31 = *off
     c                   eval      *in32 = *off
     c                   eval      *in33 = *off
     c                   eval      *in34 = *off
     c                   eval      *in35 = *off
     c                   eval      *in36 = *off
     c                   eval      *in37 = *off
     c                   eval      *in38 = *off
     c                   eval      *in39 = *off
     c                   eval      *in40 = *off
     c                   eval      *in41 = *off
     c                   eval      *in42 = *off
     c                   eval      *in43 = *off
     c                   eval      *in44 = *off
     c                   eval      *in45 = *off
     c                   eval      *in46 = *off
     c                   eval      *in47 = *off
     c                   eval      *in48 = *off
      *
      * Gå ut
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
     c                   if        *inkd = *on and                                       .....
     c                             w_afld = 'A26PBT'                                         .
      *                                                                 .
     c                   call      'RA503R'                                                  .
     c                   parm                    w_firm                                      .
     c                   parm                    p_ckod                                      .
     c                   parm                    p_ctxt                                      .
     c                   parm                    p_ctx2                                        V1.03
      *                                                                 .
     c                   if        p_ckod <> *zero                                           .
     c                   move      p_ckod        a26pbt                                      .
     c                   endif                                                               .
     c                   goto      a2taga                                                    .
     c                   endif                                                               .
      *
     c                   if        a26pbt <> *zero                                       .....
     c                   move      a26pbt        p_ckod                                      .
      *
     c                   call      'RS703R'                                      betalingsbetingelse
     c                   parm                    p_stat
     c                   parm                    p_ckod
     c                   parm                    p_ctxt
      *
     c                   if        p_stat = 'N'                                 Kode
     c                   move      *on           *in46                           finnes      .
     c                   goto      a2taga                                         ikke       .
     c                   endif                                                               .
      *
     c                   endif                                                           .....
      *
      * Oppdater statuskode 6
      *
     c     raa6lu_key    chain     raa6lu
      *
     c                   eval      ra6ppr = a26ppr
     c                   eval      ra6pnu = a26pnu
     c                   eval      ra6pgr = a26pgr
     c                   eval      ra6pld = a26pld
     c***                eval      ra6pfo = a26pfo
     c                   eval      ra6pib = a26pib
     c                   eval      ra6pfg = a26pfg
     c                   eval      ra6por = a26por
     c                   eval      ra6pbt = a26pbt
     c                   eval      ra6kpr = a26kpr
     c                   eval      ra6rpu = a26rpu
      *
     c                   time                    ra6dat
     c                   time                    ra6tim
     c                   eval      ra6usr = l_user
      *
     c                   if        %found
     c                   update    raa6lur                                                   .
     c                   else                                                                .
     c                   eval      ra6fir = l_firm
     c                   write     raa6lur                                                   .
     c                   endif                                                           .....
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *
      * Legge inn firmanummer og navn fra LDA
      *
     c                   move      l_firm        w_firm
      *
      * Hent STATUSKODE 6
      *
     c     raa6l1_key    chain     raa6l1
      *
     c                   if        %found                                                .....
      *                                                                 .
     c                   if        ra6pda = *loval                                       .....
     c                   eval      a26pda = 0
     c                   else
     c     *dmy          move      ra6pda        a26pda
     c                   endif
      *
     c                   eval      a26ppr = ra6ppr
     c                   eval      a26pnu = ra6pnu
     c                   eval      a26pgr = ra6pgr
     c                   eval      a26pld = ra6pld
     c***                eval      a26pfo = ra6pfo
     c                   eval      a26pib = ra6pib
     c                   eval      a26pfg = ra6pfg
     c                   eval      a26por = ra6por
     c                   eval      a26pbt = ra6pbt
     c                   eval      a26kpr = ra6kpr
     c                   eval      a26rpu = ra6rpu
      *                                                                 .
     c                   eval      a26usr = ra6usr
     c     *dmy          move      ra6dat        a26dat
      *
     c                   endif                                                           .....
      *
      * Key for statuskode 6
      *
     c     raa6l1_key    klist
     c                   kfld                    w_firm
      *
     c     raa6lu_key    klist
     c                   kfld                    w_firm
      *
     c                   endsr
      /eject
