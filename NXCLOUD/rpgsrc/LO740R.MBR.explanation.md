## Overview
This program, named LO740R, acts as a controller (“Styreprogram”) for sending orders or purchase requests (“bestillinger”) from the system to external recipients. It determines the appropriate communication method (EDI, NGN_EDI, WEBTRADE, FTP, etc.), handles logging and status updates on sent orders, and ensures that business rules (e.g., NEB standard checks) are satisfied before transmitting.

## High-Level Flow
1. The program is invoked with parameters for an order number (p_numm), suffix (p_suff), and some status fields.  
2. It retrieves order details using the LOHEPF file (accessed via the lohelr/lohelu file specs). If the order is already marked as sent (lobsen = 1), it allows an “override” flow with F10 or proceeds to finalization.  
3. It chains to RLEVPF (rlevl1) to fetch supplier (leverandør) information, verifying that supplier data exists (e.g., a GLN number for EDI).  
4. It consults LLDIPF (lldilr/lldilu) to retrieve shipping details (mottakerinfo, forms, etc.). Depending on the content of lpform, lptype, and lpmott, the program decides how to transmit the order.  
5. Checks (e.g., NEB standard compliance via LI653R) validate whether line items meet certain data-quality requirements.  
6. If the order format and type indicate an “internal” flow, it calls NO124R to convert the purchase request into an internal order. Else, it routes to specific subprograms (LO750C, LO760C, LO768C, etc.) to perform transmissions (FTP or SNA-based) and update statuses.  
7. If the system is configured to manage distribution-center copies, logic in “sjk_rds_bes” or “sjk_rds_kop” determines whether to send extra copies to a distribution warehouse (RDS).  
8. After a successful transmission, the program updates logs in LOHEPF (lobsen, lobsda, etc.) and LLDIPF to mark the request as sent, and logs an event code “2” via LM900R.

## Data Files and Key Fields
- **LOHEPF** (lohelr/lohelu): Stores order headers (lonumm, losuff, lobsen, etc.).  
- **LLDIPF** (lldilr/lldilu): Holds distribution/shipping instructions (lptype, lpform, lpmott, NEB checks, etc.) keyed by firm and supplier/lager.  
- **RLEVPF** (rlevl1): Supplier master data (leverandør ID, name, and EDI fields like GLN).  
- **AVALPF** (avall1): Firm-specific validation flags (e.g., requiring a certain forsendelsesmåte).  
- **LODTPF** (lodtlu): Order detail lines used for updating line-level fields such as desired delivery dates.  
- **FOHEPF** (fohel1): Referenced if an associated order exists (loornr, loorsu) and for distribution logic.  
- **Local Data Areas**: The code references LDA fields like l_wsid, l_user, l_firm, controlling runtime environment details.

## External Programs
- **LI653R**: Validates NEB standard compliance on line items.  
- **LO750C, LO760C, LO768C, etc.**: Specialized routines for generating or sending EDI/FTP files to various suppliers (e.g., NBS, Jernia, Farveringen, Løvenskiold).  
- **NO124R**: Creates internal orders from “INTERN” requests.  
- **AA005R** and **LO741R**: Provide error messaging or user notifications.  
- **LM900R**: Logs events and statuses for the order.  
- **AP058R**: Manages external fleet or transport requests if “flåtestyring” is enabled.  
- **CO402R**: Fetches configuration switches (e.g., BEST_RDS for distribution center copies, EKSTERN_FLATESTYRING) from a general control file.

## Notable Design and Business Logic
- The program uses an indicator-based flow but relies heavily on external calls for actual file creation or EDI transmissions. The code emphasizes modularization by delegating specialized logic to separate *C or *R modules (LO75xC, LO76xC, etc.).  
- Certain flows (e.g., “INTERN”) are prevented from recursive calls. If FO100R is found in the program stack, LO740R will not attempt to call it again.  
- “NEB standard checks” ensure that both the supplier and the items meet specific data requirements (e.g., presence of mandatory fields).  
- When an order’s distribution method or item handling requires a copy to a distribution center (RDS), the logic in “sjk_rds_bes” or “sjk_rds_kop” is triggered, possibly altering w_rdsk to direct the flow to LO768C.  
- A subroutine “logg_levdat” demonstrates how line-level records can be updated with a new delivery date if the lines were never set. This is especially relevant within NGN_EDI flows.  
- The flow to external transport (AP058R) is conditionally triggered if “u_flat” is on, skipping it when NGN_EDI is the format (because that goes to a separate route).

## Summary
LO740R is the central orchestrator for sending orders from the system to vendors, distribution centers, or internal conversions. It checks for existing transmissions, verifies compliance (NEB, data completeness), and delegates detailed file-building or sending processes to other modules. Post-transmission, it updates the order status, logs the event for reporting and traceability, and optionally handles distribution copies or external transport requests. This approach allows new providers or methods to be added by connecting more specialized subprograms without heavily modifying the main controller logic.