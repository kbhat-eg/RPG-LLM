     h datedit(*dmy)
     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASSHOP
      * Program . . . . : BO123R
      * Beskrivelse . . : Oppstart dagsoppgjør fra jobbplan
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * R8.00 210621 sst  Nytt program
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fbstsl1    if   e           k disk    rename(bstspfr:bstsl1r)
     fbdopl1    if   e           k disk    rename(bdoppfr:bdopl1r)
      *
      * Definering av datastrukturer
      *
     d                 ds
     d ldambr                        10
     d  ldabok                        1    overlay(ldambr)
     d  ldafir                        3  0 overlay(ldambr:2)
     d  ldalst                        6  0 overlay(ldambr:5)
      *
     d                 ds
     d ldprec                       256
     d  ldotal                        4    overlay(ldprec)
     d  ldot01                        2    overlay(ldprec:5)
     d  ldot02                        2    overlay(ldprec:7)
     d  ldot03                        2    overlay(ldprec:9)
     d  ldot04                        2    overlay(ldprec:11)
     d  ldot05                        2    overlay(ldprec:13)
     d  ldot06                        2    overlay(ldprec:15)
     d  ldot07                        2    overlay(ldprec:17)
     d  ldot08                        2    overlay(ldprec:19)
     d  ldot09                        2    overlay(ldprec:21)
     d  ldot10                        2    overlay(ldprec:23)
     d  ldwsgr                        6    overlay(ldprec:25)
     d  ldwsal                       10    overlay(ldprec:31)
     d  ldws01                       10    overlay(ldprec:41)
     d  ldws02                       10    overlay(ldprec:51)
     d  ldws03                       10    overlay(ldprec:61)
     d  ldws04                       10    overlay(ldprec:71)
     d  ldws05                       10    overlay(ldprec:81)
     d  ldws06                       10    overlay(ldprec:91)
     d  ldws07                       10    overlay(ldprec:101)
     d  ldws08                       10    overlay(ldprec:111)
     d  ldws09                       10    overlay(ldprec:121)
     d  ldws10                       10    overlay(ldprec:131)
     d  ldavst                        1  0 overlay(ldprec:142)
     d  lddato                       10d   datfmt(*iso)
     d                                     overlay(ldprec:143)
     d  ldperi                        6  0 overlay(ldprec:153)
     d  lddekn                        1  0 overlay(ldprec:159)
     d  ldvdag                        2  0 overlay(ldprec:160)
     d  lddeta                        1  0 overlay(ldprec:162)
     d  ldtota                        1  0 overlay(ldprec:163)
     d  ldfrad                       10d   datfmt(*iso)
     d                                     overlay(ldprec:164)
     d  ldtild                       10d   datfmt(*iso)
     d                                     overlay(ldprec:174)
     d  ldaarr                        4  0 overlay(ldprec:184)
     d  ldlavs                        8  0 overlay(ldprec:188)
     d  ldldet                        6  0 overlay(ldprec:196)
     d  ldtime                        6  0 overlay(ldprec:202)
     d  ldkred                        1  0 overlay(ldprec:208)
     d  ldjobp                        1    overlay(ldprec:209)
      *
      * Definering av local data area
      *
     d lda            uds
     d l_prtf                800    809
     d l_chgv                844    844
     d l_user                911    920
     d l_filg                931    933
     d l_sfir                944    946  0
     d l_fnav                951    980
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(bopfir)
     d bdopl1_sgr      s                   like(bopsgr)
      *
      * Definering av variable
      *
     d w_kode          s              2  0
     d w_onof          s              1  0
     d w_avst          s              1
     d w_tota          s              1
     d w_deta          s              1
     d w_dekn          s              1
     d w_pos           s              2s 0
     d w_kon           s              1
     d w_dat           s              8  0
      *
     d grpant          s              1  0
     d wpin03          s              1
     d wsfast          s             10
     d wsfell          s              6
     d wsfirm          s              3  0
     d wskode          s              1
     d wsnumm          s              8  0
     d wstype          s              2
     d wwaar           s              2  0
     d wwamn           s              4  0
     d wwcen           s              4  0
     d wwmnd           s              2  0
     d wwvalg          s              1
      *
      *
      * Firmastyrt validering av felt
      *
     d u_wsgr          s              1    inz(*off)
     d u_702           s              1    inz(*off)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B1 Behandle åpningsbildet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      bdopl1_sgr  = *blank
     c     bdopl1_key    chain     bdopl1
     c                   eval      ldprec = boprec
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Behandlinging av utskriftsvalgh som er tastet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Legger inn kjøredato
      *
     c     *dmy          move      udate         lddato
     c     *dmy          move      udate         ldfrad
     c     *ymd          move      ldfrad        w_dat
     c                   movel     '20'          w_dat
     c                   movel     w_dat         ldperi
     c                   move      w_dat         ldvdag
      *
      * Hent nummer for liste
      *
     c                   eval      wsfell = baalst
     c                   exsr      hntnum
     c                   eval      ldalst = wsnumm
      *
      * Hent nummer for avstemmingsliste
      *
     c                   eval      wsfell = baaavs
     c                   exsr      hntnum
     c                   eval      ldlavs = wsnumm
      *
      * Hent nummer for detalj-liste
      *
     c                   eval      wsfell = baadet
     c                   exsr      hntnum
     c                   eval      ldldet = wsnumm
      *
     c                   time                    ldtime
      *
s.st c                   if        ldabok <> 'K'
s.st c                   eval      ldabok = 'K'
s.st c                   eval      ldafir = l_sfir
     c                   eval      ldalst = wsnumm
     c                   endif
      *
     c                   eval      wwvalg = '0'
     c                   call      'BO121C'
     c                   parm                    ldambr
     c                   parm                    ldprec
     c                   parm                    wwvalg
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Henter/Oppdatering av NUMMER-REGISTER
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     hntnum        begsr
      *
     c                   eval      wskode = '0'
     c                   eval      wsfirm = l_sfir
     c                   eval      wstype = *blank
     c                   eval      wsfast = *blank
      *
      * Kaller opp subprogram for henting av nummer fra NUMMER-REGISTER
      *
     c                   call      'AS100R'
     c                   parm                    wskode
     c                   parm                    wsfirm
     c                   parm                    wsfell
     c                   parm                    wstype
     c                   parm                    wsfast
     c                   parm                    wsnumm
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Definisjon av local data area for output
      *
     c     *dtaara       define    *lda          lda
      *
     c                   eval      wpin03 = *blank
      *
      * Nullstilling av felter som ikke kan redefineres
      *
     c                   move      *zero         wwvalg
     c                   eval      grpant = *zero
     c                   eval      wwmnd = *zero
     c                   eval      wwaar = *zero
     c                   eval      wwamn = *zero
     c                   eval      wwcen = *zero
      *
     c                   eval      wskode = *blank
     c                   eval      wsfirm = *zero
     c                   eval      wsfell = *blank
     c                   eval      wstype = *blank
     c                   eval      wsfast = *blank
     c                   eval      wsnumm = *zero
      *
      * Key for file : BUTIKK-STATUSKODE-REGISTER
      *
     c     bstsl1_key    klist
     c                   kfld                    w_firm
      *
      *
      * Key for file : Dagsoppgjør paramter
      *
     c     bdopl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bdopl1_sgr
      *
      * Hent idenifikasjon fra BUTIKK-STATUS-REGISTER
      *
     c                   eval      w_firm = l_sfir
     c     bstsl1_key    chain     bstsl1r                            60
      *
     c                   if        *in60 = *on
     c                   eval      baaavs = *blank
     c                   eval      baadet = *blank
     c                   eval      baalst = *blank
     c                   endif
      *
      *
      *
     c                   endsr
      *
