     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASLAGR
      * Program . . . . : LA101R
      * Beskrivelse . . : Vedlikehold av status-koder, Generelle
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Referanse  Dato   Endringsbeskrivelse                     Sign.
      * --------- ------  -------------------------------------------------
      *  6.10     180609  Oppdatert med sporingsinformasjon       BSA
6.10  * R6.10     080909  Utvidet med kjedesortiment              bof
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *       21 = Home-key
      *       22 = Plassering av cursor
      *       30 = Protect av felter ved vise
      *    31-79 = Varsle m/feilmeldinger/skjermindikatorer
      *    80-99 = Arbeidsindikatorer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     flstsl1    if   e           k disk    rename(lstspfr:lstsl1r)
     flstslu    uf a e           k disk    rename(lstspfr:lstslur)
     fla101d    cf   e             workstn
      *
      * Definering av Local data area
      *
     d                uds
6.10 d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av variable
      *
     d w_firm          s                   like(laafir)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  A1BLD Behandle bildet for valg
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     a1taga        tag
      *
      *  Hent opplysninger fra LAGER-KODE
      *
     c     lstsl1_key    chain     lstsl1
     c                   if        %found
     c                   eval      a1abrk = laabrk
     c                   eval      a1abin = laabin
     c                   eval      a1afor = laafor
     c                   eval      a1adel = laadel
     c                   eval      a1alsm = laalsm
     c                   eval      a1abat = laabat
     c                   eval      a1abun = laabun
     c                   eval      a1atel = laatel
     c                   eval      a1atbu = laatbu
     c                   eval      a1akhv = laakhv
     c                   eval      a1aoty = laaoty
     c                   eval      a1alty = laalty
     c                   eval      a1atty = laatty
     c                   eval      a1alev = laalev
     c                   eval      a1alnr = laalnr
     c                   eval      a1avnr = laavnr
     c                   eval      a1abil = laabil
     c                   eval      a1abif = laabif
6.10 c                   eval      a1akso = laakso
     c                   else
     c                   eval      a1abrk = *blank
     c                   eval      a1abin = *blank
     c                   eval      a1afor = *blank
     c                   eval      a1adel = *blank
     c                   eval      a1alsm = *blank
     c                   eval      a1abat = *blank
     c                   eval      a1abun = *blank
     c                   eval      a1atel = *blank
     c                   eval      a1atbu = *blank
     c                   eval      a1akhv = *blank
     c                   eval      a1aoty = *blank
     c                   eval      a1alty = *blank
     c                   eval      a1atty = *blank
     c                   eval      a1alev = 0
     c                   eval      a1alnr = 0
     c                   eval      a1avnr = *blank
     c                   eval      a1abil = 0
     c                   eval      a1abif = 0
6.10 c                   eval      a1akso = *blank
     c                   endif
      *
      *  Vis bilde
      *
     c                   exfmt     a1bld
      *
      *  F3=Avslutt
      *
     c                   if        *inkc = *on
     c                   goto      end_pgm
     c                   endif
      *
      *  Oppdater LAGER-KODE
      *
     c     lstslu_key    chain     lstslur
      *
     c                   eval      laabrk = a1abrk
     c                   eval      laabin = a1abin
     c                   eval      laafor = a1afor
     c                   eval      laadel = a1adel
     c                   eval      laalsm = a1alsm
     c                   eval      laabat = a1abat
     c                   eval      laabun = a1abun
     c                   eval      laatel = a1atel
     c                   eval      laatbu = a1atbu
     c                   eval      laakhv = a1akhv
     c                   eval      laaoty = a1aoty
     c                   eval      laalty = a1alty
     c                   eval      laatty = a1atty
     c                   eval      laalev = a1alev
     c                   eval      laalnr = a1alnr
     c                   eval      laavnr = a1avnr
     c                   eval      laabil = a1abil
     c                   eval      laabif = a1abif
6.10 c                   eval      laakso = a1akso
      *
     c                   if        %found
6.10 c                   time                    laaeda
6.10 c                   time                    laaeti
6.10 c                   eval      laaeus = l_user
     c                   update    lstslur
     c                   else
     c                   eval      laafir = w_firm
6.10 c                   time                    laaoda
6.10 c                   time                    laaoti
6.10 c                   eval      laaous = l_user
6.10 c                   time                    laaeda
6.10 c                   time                    laaeti
6.10 c                   eval      laaeus = l_user
     c                   write     lstslur
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     end_pgm       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      *  Key for les av LAGER-KODE
      *
     c     lstsl1_key    klist
     c                   kfld                    w_firm
      *
      *  Key for oppdtering av LAGER-KODE
      *
     c     lstslu_key    klist
     c                   kfld                    w_firm
      *
      *  Legger inn firma i n√∏klene
      *
     c                   eval      w_firm = l_firm
      *
     c                   endsr
