     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASLAGR
      * Program . . . . : LB700R
      * Beskrivelse . . : Kontroll av tilganger for bruker
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       310714 ASK  Nytt program
      *
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     flusrl1    if   e           k disk    rename(lusrpfr:lusrl1r)
      *
      * Definering av local data area
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
     d l_firm                944    946  0
      *
      * Definering av parametere
      *
     d p_kode          s              2  0
     d p_onof          s                   like(lbko01)
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(lbfirm)
     d lusrl1_user     s                   like(lbuser)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedrutine
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Forklaring på programmet :
      * --------------------------
      * Dette programmet benyttes som et generelt program for å finne
      * ut om en bruker har tilgang til en funksjon.
      * Det er oppslag mot brukerregister lusrL1.
      * Programmet som kaller dette sender med en parameter som sier
      * hvilken tilgangskode som skal sjekkes (Idag fra 1 - 20)
      * Programmet svarer tilbake med en parameter som inneholder
      * verdien til den ønskede koden d.v.s.  0 eller 1
      *
      *
     c                   eval      p_onof = 0
      *
      * Slå opp bruker
      *
     c     lusrl1_key    chain     lusrl1
      *
     c                   if        %found
      *
     c                   if        p_kode = 01
     c                   eval      p_onof = lbko01
     c                   endif
      *
     c                   if        p_kode = 02
     c                   eval      p_onof = lbko02
     c                   endif
      *
     c                   if        p_kode = 03
     c                   eval      p_onof = lbko03
     c                   endif
      *
     c                   if        p_kode = 04
     c                   eval      p_onof = lbko04
     c                   endif
      *
     c                   if        p_kode = 05
     c                   eval      p_onof = lbko05
     c                   endif
      *
     c                   if        p_kode = 06
     c                   eval      p_onof = lbko06
     c                   endif
      *
     c                   if        p_kode = 07
     c                   eval      p_onof = lbko07
     c                   endif
      *
     c                   if        p_kode = 08
     c                   eval      p_onof = lbko08
     c                   endif
      *
     c                   if        p_kode = 09
     c                   eval      p_onof = lbko09
     c                   endif
      *
     c                   if        p_kode = 10
     c                   eval      p_onof = lbko10
     c                   endif
      *
     c                   if        p_kode = 11
     c                   eval      p_onof = lbko11
     c                   endif
      *
     c                   if        p_kode = 12
     c                   eval      p_onof = lbko12
     c                   endif
      *
     c                   if        p_kode = 13
     c                   eval      p_onof = lbko13
     c                   endif
      *
     c                   if        p_kode = 14
     c                   eval      p_onof = lbko14
     c                   endif
      *
     c                   if        p_kode = 15
     c                   eval      p_onof = lbko15
     c                   endif
      *
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      *  Key for file : BRUKER-REGISTER OFAK
      *
     c     lusrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    lusrl1_user
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *  Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_kode
     c                   parm                    p_onof
      *
      *  Legger inn firmanummer og bruker i nøkkel
      *
     c                   eval      w_firm = l_firm
     c                   eval      lusrl1_user = l_user
      *
     c                   endsr
