     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RH651R                                        *
      * Beskrivelse . . : Hovedbok - revisjonsjournal - utvelgelse      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign *
      * --------- ------  ----------------------------------------------*
      * 5.10      130603  Lagt inn parameter for om alle poster skal    *
      *                   skrives ut                                    *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frhtrl1    if   e           k disk    rename(rhtrpfr:rhtrl1r)
     frktrl2    if   e           k disk    rename(rktrpfr:rktrl2r)
     frltrl2    if   e           k disk    rename(rltrpfr:rltrl2r)
     frhjopf    uf a e           k disk
     frhw2pf    o    e           k disk
      *
     d                uds
     d rhpkda                300    305  0
     d rhprÅr                         4  0
     d rhpper                         2  0
     d rhpblk                         1
     d rhpskr                         1
      *
     d l_wsid                901    910
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_firm          s                   like(rbfirm)
     d w_raar          s                   like(rbraar)
      *
     c     dummy         tag
      /eject
      *
      * Les hovedboksposteringer
      *
     c     rhtrl1_key    setll     rhtrl1r                                60
     c     rhtrl1_key    reade     rhtrl1r                                60
      *
     c                   dow       *in60 = *off
      *
      * Test om posteringen har vært
      * med på revisjonsjournal før
      *
     c                   if        rhpskr = ' ' and                                      .....
     c                             rbrmrk = '1'                                          .....
     c                   goto      neste_kont                                                .
     c                   endif                                                           .....
      *
      * Test om riktig år og mnd
      *
     c                   if        rbrper <= rhpper                                          .
      *                                                                 .
      * Legg ut hovedbokspostering                                      .
      *                                                                 .
     c                   move      'H'           rbstat                                      .
     c                   move      rbkont        rbkon6                                      .
     c                   write     rhw2pfr                                                   .
      *                                                                 .
      * Legg ut journalnummer for                                       .
      * utvalgte hovedboksposteringer                                   .
      *                                                                 .
     c     rhjopf_key    chain     rhjopfr                            60                     .
     c                   if        *in60 = *on
     c                   write     rhjopfr                                                   .
     c                   endif
      *                                                                 .
     c                   endif                                                           .....
      *
     c     neste_kont    tag
      *
     c     rhtrl1_key    reade     rhtrl1r                                60
     c                   enddo                                                           .....
      /eject
      *
      * Les kundeposteringer
      *
     c     rktrl2_key    setll     rktrl2r                                60
     c     rktrl2_key    reade     rktrl2r                                60
      *
     c                   dow       *in60 = *off
      *
      * Test om riktig år og mnd
      *
     c                   if        rnraar = rhprÅr and                                   .....
     c                             rnrper <= rhpper                                          .
      *                                                                 .
      * Test posteringen                                                .
      * mot valgte journalnr.                                           .
      *                                                                 .
     c                   move      rnjour        rbjour                                      .
     c     rhjopf_key    chain     rhjopfr                            61                     .
      *                                                                 .
     c                   if        *in61 = *on
     c                   goto      neste_kund                                                .
     c                   endif
      *                                                                 .
      * Legg ut kundepostering                                          .
      *                                                                 .
     c                   move      'K'           rbstat                                      .
     c                   move      rnfirm        rbfirm                                      .
     c                   move      rnraar        rbraar                                      .
     c                   move      rnkund        rbkon6                                      .
     c                   eval      rbspes = *zeros                                           .
     c                   eval      rbavde = *zeros                                           .
     c                   move      rnrper        rbrper                                      .
     c                   eval      rbtist = *loval                                           .
     c                   move      rnbiln        rbbiln                                      .
     c                   move      rnbilk        rbbilk                                      .
     c                   move      rntext        rbtext                                      .
     c                   move      rnbelØ        rbneto                                      .
     c                   move      rnjour        rbjour                                      .
     c                   move      rnbdat        rbbdat                                      .
     c                   move      rnvalk        rbvalk                                      .
     c                   move      rnvalb        rbvalb                                      .
     c                   move      rnvalr        rbvals                                      .
      *                                                                 .
     c                   write     rhw2pfr                                                   .
      *                                                                 .
     c                   endif                                                               .
      *
     c     neste_kund    tag
      *
     c     rktrl2_key    reade     rktrl2r                                60
     c                   enddo
      *
      /eject
      *
      * Les leverandørposteringer
      *
     c     rltrl2_key    setll     rltrl2r                                60
     c     rltrl2_key    reade     rltrl2r                                60
      *
     c                   dow       *in60 = *off
      *
      * Test om riktig år og mnd
      *
     c                   if        roraar = rhprÅr and                                   .....
     c                             rorper <= rhpper                                          .
      *                                                                 .
      * Test posteringen                                                .
      * mot valgte journalnr.                                           .
      *                                                                 .
     c                   move      rojour        rbjour                                      .
     c     rhjopf_key    chain     rhjopfr                            61                     .
      *                                                                 .
     c                   if        *in61 = *on
     c                   goto      neste_leve                                                .
     c                   endif
      *                                                                 .
      * Legg ut leverandørpostering                                     .
      *                                                                 .
     c                   move      'L'           rbstat                                      .
     c                   move      rofirm        rbfirm                                      .
     c                   move      roraar        rbraar                                      .
     c                   move      rolevr        rbkon6                                      .
     c                   eval      rbspes = *zeros                                           .
     c                   eval      rbavde = *zeros                                           .
     c                   move      rorper        rbrper                                      .
     c                   eval      rbtist = *loval                                           .
     c                   move      robiln        rbbiln                                      .
     c                   move      robilk        rbbilk                                      .
     c                   move      rotext        rbtext                                      .
     c                   move      robelØ        rbneto                                      .
     c                   move      rojour        rbjour                                      .
     c                   move      robdat        rbbdat                                      .
     c                   move      rovalk        rbvalk                                      .
     c                   move      rovalb        rbvalb                                      .
     c                   move      rovalr        rbvals                                      .
      *                                                                 .
     c                   write     rhw2pfr                                                   .
      *                                                                 .
     c                   endif                                                           .....
      *
     c     neste_leve    tag
      *
     c     rltrl2_key    reade     rltrl2r                                60
     c                   enddo
      *
      /eject
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Sett start for
      * lesing av register
      *
     c                   move      l_firm        w_firm
     c                   move      rhprÅr        w_raar
      *
     c     rktrl2_key    setll     rktrl2r
      *
     c     rltrl2_key    setll     rltrl2r
      *
      * Key for hovedboksposteringer
      *
     c     rhtrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_raar
      *
      * Key for kundeposteringer
      *
     c     rktrl2_key    klist
     c                   kfld                    w_firm
      *
      * Key for leverandørposteringer
      *
     c     rltrl2_key    klist
     c                   kfld                    w_firm
      *
      * Key for journal-register
      *
     c     rhjopf_key    klist
     c                   kfld                    rbfirm
     c                   kfld                    rbjour
      *
     c                   endsr
      /eject
