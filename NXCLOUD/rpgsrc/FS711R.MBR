     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FS710R
      * Beskrivelse . . : Logger slettede ordrelinjer
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       140208 AMD  Nytt program
5.70  * prgr  131108 bof  Utvidet med prisgruppe
      * 6.10  220609 BSA  Oppdatert med sporingsinformasjon
6.NU  * R6.30 260514 bsa  Programmet gjennomgått mtp nummerutvidelser.
      *
8.01  * K000  150223 bsa  Ikke lukk program før hele ordren er
8.01  * K000              slettet.
8.02  * K000  130923 bsa  Flyttet overføring av parameter, da *inzsr
8.02  * K000              kun kjøres første gang programmet kalles.
8.03  *PRG2   050124 bsa  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffodtl1    if   e           k disk    rename(fodtpfr:fodtl1r)
     ffdeslu    o  a e           k disk    rename(fdespfr:fdeslur)
      *
      * Definering av local data area
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
      *
      * Definering av parametere
      *
     d p_firm          s                   like(fsfirm)
6.NU d p_numm          s                   like(fsnumm)
     d p_suff          s                   like(fssuff)
     d p_line          s                   like(fsline)
     d p_spgm          s                   like(fsspgm)
8.01 d p_inlr          s              1
      *
      * Definering av variable i nøkler
      *
     d fodtl1_numm     s                   like(fdnumm)
     d fodtl1_suff     s                   like(fdsuff)
     d fodtl1_line     s                   like(fdline)
      *
      * Definering av variable
      *
     d w_firm          s                   like(fdfirm)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Finner ordrelinje som skal slettes
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
8.01  * "Ekstrarunde" for å stenge åpne filer?
8.01  *
8.01 c                   if        p_inlr = *on
8.01 c                   goto      xslutt
8.01 c                   endif
      *
8.02 c                   eval      fodtl1_line = p_line
     c     fodtl1_key    chain     fodtl1r
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Legger ut ordrelinje i ordre-slettet-linje-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   if        %found
      *
     c                   eval      fsfirm = fdfirm
     c                   eval      fsnumm = fdnumm
     c                   eval      fssuff = fdsuff
     c                   eval      fsline = fdline
     c                   eval      fsotyp = fdotyp
     c                   eval      fsltyp = fdltyp
     c                   eval      fslety = fdlety
     c                   eval      fsvare = fdvare
     c                   eval      fsenh1 = fdenh1
     c                   eval      fslage = fdlage
     c                   eval      fskakk = fdkakk
     c                   eval      fskpri = fdkpri
     c                   eval      fskgeb = fdkgeb
     c                   eval      fslass = fdlass
     c                   eval      fskund = fdkund
     c                   eval      fsbenr = fdbenr
     c                   eval      fsbsuf = fdbsuf
     c                   eval      fsblin = fdblin
     c                   eval      fsldor = fdldor
     c                   eval      fsldat = fdldat
     c                   eval      fsavde = fdavde
     c                   eval      fskont = fdkont
     c                   eval      fsspes = fdspes
     c                   eval      fsproj = fdproj
     c                   eval      fsalme = fdalme
     c                   eval      fsbrty = fdbrty
     c                   eval      fspriv = fdpriv
     c                   eval      fsakti = fdakti
     c                   eval      fslvar = fdlvar
     c                   eval      fsnobb = fdnobb
     c                   eval      fstek1 = fdtek1
     c                   eval      fstek2 = fdtek2
     c                   eval      fsanta = fdanta
     c                   eval      fsantb = fdantb
     c                   eval      fsantc = fdantc
     c                   eval      fsoppr = fdoppr
     c                   eval      fssapr = fdsapr
     c                   eval      fskopr = fdkopr
     c                   eval      fsinpr = fdinpr
     c                   eval      fsrab1 = fdrab1
     c                   eval      fsrab2 = fdrab2
     c                   eval      fsrab3 = fdrab3
     c                   eval      fsrab4 = fdrab4
     c                   eval      fsrab5 = fdrab5
     c                   eval      fsbrr1 = fdbrr1
     c                   eval      fsbrr2 = fdbrr2
     c                   eval      fspasl = fdpasl
     c                   eval      fsrkr1 = fdrkr1
     c                   eval      fsrkr2 = fdrkr2
     c                   eval      fssums = fdsums
     c                   eval      fssumr = fdsumr
     c                   eval      fssumk = fdsumk
     c                   eval      fsbbon = fdbbon
     c                   eval      fsomva = fdomva
     c                   eval      fslvre = fdlvre
     c                   eval      fsolag = fdolag
     c                   eval      fsogrp = fdogrp
     c                   eval      fshgrp = fdhgrp
     c                   eval      fsugrp = fdugrp
     c                   eval      fsgave = fdgave
     c                   eval      fsvari = fdvari
     c                   eval      fsedih = fdedih
     c                   eval      fsedil = fdedil
     c                   eval      fskamp = fdkamp
     c                   eval      fskbnr = fdkbnr
     c                   eval      fskbli = fdkbli
     c                   eval      fseann = fdeann
5.70 c                   eval      fsprgr = fdprgr
     c                   eval      fsstim = fdstim
     c                   eval      fswsid = fdwsid
     c                   eval      fsuser = fduser
     c                   eval      fsdate = fddate
     c                   eval      fstime = fdtime
      *
      * Oppdatering av tilleggsfelter
      * som ikke ligger på ordrelinje
      *
     c                   time                    fsslda
     c                   time                    fsslti
     c                   eval      fsspgm = p_spgm
     c                   eval      fsslws = l_wsid
     c                   eval      fsslus = l_user
      *
6.10 c                   time                    fsodat
6.10 c                   time                    fsotim
6.10 c                   eval      fsousr = l_user
6.10 c                   time                    fsedat
6.10 c                   time                    fsetim
6.10 c                   eval      fseusr = l_user
     c                   write     fdeslur
      *
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xslutt        tag
      *
8.01 c                   if        p_inlr = *on
     c                   eval      *inlr = *on
8.01 c                   endif
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Key for file : ORDRE-LINJE-REGISTER
      *
     c     fodtl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtl1_numm
     c                   kfld                    fodtl1_suff
     c                   kfld                    fodtl1_line
      *
      * Key for file : ORDRE-SLETTET-LINJE
      *
      *    fdeslu_key    klist
      *                  kfld                    w_firm
      *                  kfld                    fdeslu_numm
      *                  kfld                    fdeslu_suff
      *                  kfld                    fdeslu_line
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_firm
6.NU c                   parm                    p_numm
     c                   parm                    p_suff
     c                   parm                    p_line
     c                   parm                    p_spgm
8.01 c                   parm                    p_inlr
      *
      * Legger inn firmanummer i nøkklene
      *
     c                   eval      w_firm = p_firm
      *
      * Legger inn ordrenummer og suffix og linje i nøkler
      *
     c                   eval      fodtl1_numm = p_numm
     c                   eval      fodtl1_suff = p_suff
8.02 c**                 eval      fodtl1_line = p_line
      *
     c                   endsr
