      /TITLE  Utvalg av innkjøpsstatistikktransaksjoner
     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SI600R
      * Beskrivelse . . : Utvalg av innkjøpsstatistikk
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * V5.30 260304 KOB  Fjernet kode for leveringsadresse
      * V5.45 110207 KOB  endret uogp fra 3 til 2 pos.
6.nu  * V6.30 090615 bsa  Tar høyde for utvidet faktura/kreditnota nummer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     Fslpml1    if   f  512    25aidisk    keyloc(1)
     Fsistpf    if   e             disk
     Fslwwpf    o  a e           k disk
     Fsi600p    o    e             printer
     F
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tabeller                                                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     D rpt             s             25    dim(60) ctdata perrcd(1)
     D utv             s              1    dim(60)
     D hhgr            s              2    dim(999)
     D uhgr            s              2    dim(999)
     D uugr            s              3    dim(999)
     D rgr             s              3    dim(999)
     D oogp            s              2    dim(999)
     D hogp            s              2    dim(999)
     D hhgp            s              2    dim(999)
     D uogp            s              2    dim(999)
     D uhgp            s              2    dim(999)
     D uugp            s              3    dim(999)
     D kka             s              4    dim(999)
     D rka             s              3    dim(999)
     D dis             s              2    dim(999)
     D sel             s              2    dim(999)
     D lan             s              3    dim(999)
     D srfvar          s             15    dim(10)
     D srtvar          s             15    dim(10)
     D srflev          s              6    dim(10)
     D srtlev          s              6    dim(10)
     D srflad          s              6    dim(10)
     D srtlad          s              6    dim(10)
     D oty             s              2    dim(999)
     D avd             s              4    dim(999)
     D lag             s              2    dim(999)
     D pra             s              5    dim(999)
      *
     D w_siperi        s              6  0
     D w_bida          s              8  0
      *
     D                 ds
     D umtid                         12  0
     D  umtime                        6  0 overlay(umtid)
     D  umdato                        6  0 overlay(umtid:7)
      *
     D                 ds
     D w_ahug                         5  0
     D  sihgrp                             overlay(w_ahug:1)
     D  siugrp                             overlay(w_ahug:3)
      *
     D                 ds
     D w_ohug                         7
     D  w_ogrp                        2    overlay(w_ohug:1)
     D  w_hgrp                        2    overlay(w_ohug:3)
     D  w_ugrp                        3    overlay(w_ohug:5)
      *
     D                 ds
     D w_peri                         6  0
     D  sipaar                             overlay(w_peri:1)
     D  sipmnd                             overlay(w_peri:5)
      *
     D                 ds
     D w__peri                        6  0
     d w_aaaa          s              4  0
     d w_mm            s              2  0
      *
     D                uds
     D l_wsid                901    910
     D l_user                        10
     D l_firm                944    946  0
     D l_navn                951    980
      *
     D alf2x           s              2
     D alf1            s              1
     D alf2            s              2
     D alf3            s              3
     D alf4            s              4
     D alf5            s              5
     D alf6            s              6
     D alf7            s              7
      *
     D n               s              3  0
     D rpt01           s             25
     D rpt02           s             25
     D rpt03           s             25
      *
     D styp            s              2  0
     D swsrt1          s             15
     D swsrt2          s             15
     D swsrt3          s             15
      *
     D tid             s              6  0
     D ty00            s              1
     D v               s              2  0
     D whkk            s              1  0
      *
     D wlnr            s              6
     D wladr           s              6
     d w_timestamp     s             12  0
      *
     d wr1             s                   like(r1)
     d wr2             s                   like(r2)
     d wr3             s                   like(r3)
     d wpsp1           s                   like(psp1)
     d wpsp2           s                   like(psp2)
     d wpsp3           s                   like(psp3)
     d wpsp4           s                   like(psp4)
     d wpsp5           s                   like(psp5)
      *
     d                 ds
     d slpml1_key                    25
     d w_srfirm                       3  0 overlay(slpml1_key:1)
     d w_srtype                      10    overlay(slpml1_key:4)
     d w_srkode                       2  0 overlay(slpml1_key:14)
     d w_srvalg                      10    overlay(slpml1_key:16)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Input                                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     Islpml1    ns  01   14 c0   15 c0
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61   62 0r1
     I                                 63   64 0r2
     I                                 65   66 0r3
     I                                 67   67  psp1
     I                                 68   68  psp2
     I                                 69   69  psp3
     I                                 70   70  psp4
     I                                 71   71  psp5
      *                                                    Alt. Hovedgruppe
     I          ns  01   14 c1   15 c1
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17 0srhgrp
     I                                 31   60  srtext
      *                                                    Alt. Undergruppe
     I          ns  01   14 c1   15 c2
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17 0srhgrp
     I                                 18   20 0srugrp
     I                                 31   60  srtext
      *                                                    Rabattgruppe
     I          ns  01   14 c1   15 c3
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   20 0srrgrp
     I                                 31   60  srtext
      *                                                    Hovedgruppe  (Nobb)
     I          ns  01   14 c1   15 c4
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17 0srnogr
     I                                 31   60  srtext
      *                                                    Hovedgruppe (Nobb)
     I          ns  01   14 c1   15 c5
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17 0srnogr
     I                                 18   19 0srnhgr
     I                                 31   60  srtext
      *                                                    Undergruppe (Nobb)
     I          ns  01   14 c1   15 c6
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17 0srnogr
     I                                 18   19 0srnhgr
     I                                 20   22 0srnugr
     I                                 31   60  srtext
      *                                                    Leverandørkategori
     I          ns  01   14 c2   15 c1
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   19 0srlkat
     I                                 31   60  srtext
      *                                                    Rabattkategori
     I          ns  01   14 c2   15 c2
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   18 0srrkat
     I                                 31   60  srtext
      *                                                    Distrikt
     I          ns  01   14 c2   15 c3
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   19 0srdist
     I                                 31   60  srtext
      *                                                    Selger
     I          ns  01   14 c2   15 c4
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   19 0srkons
     I                                 31   60  srtext
      *                                                    Land
     I          ns  01   14 c2   15 c5
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17  srland
     I                                 31   60  srtext
      *                                                    Varenummer
     I          ns  01   14 c3   15 c1
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61  210  srfvar
     I                                211  360  srtvar
      *                                                    Leverandør-nr
     I          ns  01   14 c3   15 c2
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61  120  srflev
     I                                121  180  srtlev
      *                                                    Kundeprosjekt
     I          ns  01   14 c3   15 c3
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61  120  srflad
     I                                121  180  srtlad
      *                                                    Periode
     I          ns  01   14 c4   15 c1
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61   66 0srfper
     I                                 67   72 0srtper
      *                                                    Fakturanummer
     I          ns  01   14 c4   15 c2
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
6.nu I                                 61   68 0srffak
6.nu I                                 69   76 0srtfak
6.nu I                                 77   84 0srfkre
6.nu I                                 85   92 0srtkre
      *                                                    Fakturadato
     I          ns  01   14 c4   15 c3
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61   68 0srffda
     I                                 69   76 0srftda
      *                                                    Kampanje
     I          ns  01   14 c4   15 c4
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 31   60  srtext
     I                                 61   65  srkamp
      *                                                    Ordretype
     I          ns  01   14 c5   15 c1
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17  srotyp
     I                                 31   60  srtext
      *                                                    Avdeling
     I          ns  01   14 c5   15 c2
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   19 0sravde
     I                                 31   60  srtext
      *                                                    Lager
     I          ns  01   14 c5   15 c3
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   17 0srlage
     I                                 31   60  srtext
      *                                                    Produktansvarlig
     I          ns  01   14 c5   15 c4
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   19  srpran
     I                                 31   60  srtext
      *                                                    Leveringstype
     I          ns  01   14 c5   15 c5
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   16 0srlety
     I                                 31   60  srtext
      *                                                    Leverandør
     I          ns  01   14 c5   15 c6
     I                                  1    3 0srfirm
     I                                  4   13  srtype
     I                                 14   15 0srkode
     I                                 16   2100srlevr
     I                                 31   60  srtext
     I          ns  02
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XTRANS Behandle detaljlinjer                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     xtrans        tag
      *
      * Les fra Innkjøpstatikkregister
      *
     c                   read      sistpf                                 lr
     c                   if        *inlr = *on
     c                   goto      endprg
     c                   endif
      *
      * Sjekk utvalg FIRMA
      *
B001 C                   if        w_srfirm <> sifirm
 001 C                   goto      xtrans
E001 C                   endif
      *
E001 C                   eval      w_lest = w_lest + 1
      *
B001 C                   if        utv(11) = 'J'
 001 C                   exsr      subhgr
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(12) = 'J'
 001 C                   exsr      subugr
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(13) = 'J'
 001 C                   exsr      subrgr
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(14) = 'J' or
B001 C                             utv(15) = 'J' or
B001 C                             utv(16) = 'J'
 001 C                   exsr      subgrp
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(21) = 'J'
 001 C                   exsr      subkka
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(22) = 'J'
 001 C                   exsr      subrka
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(23) = 'J'
 001 C                   exsr      subdis
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(24) = 'J'
 001 C                   exsr      subsel
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(25) = 'J'
 001 C                   exsr      sublan
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(31) = 'J'
 001 C                   exsr      subvnr
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(32) = 'J'
 001 C                   exsr      sublnr
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(41) = 'J'
 001 C                   exsr      subper
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 c                   if        utv(42) = 'J'
 001 c                   exsr      subfnr
B002 c                   if        *in98 = *on
 002 c                   goto      xtrans
E002 c                   endif
E001 c                   endif
     *
B001 C                   if        utv(43) = 'J'
 001 C                   exsr      subfda
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(44) = 'J'
 001 C                   exsr      subkam
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(51) = 'J'
 001 C                   exsr      suboty
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(52) = 'J'
 001 C                   exsr      subavd
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(53) = 'J'
 001 C                   exsr      sublag
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
B001 C                   if        utv(54) = 'J'
 001 C                   exsr      subpra
B002 C                   if        *in98 = *on
 002 C                   goto      xtrans
E002 C                   endif
E001 C                   endif
      *
      /eject
      *
      * Varelinjer som har kommet gjennom nåløyet
      *
      * Bygg opp sorteringsbegrep 1
      *
B001 C                   if        *in11 = *on
 001 C                   movel     sihgrp        swsrt1
E001 C                   endif
      *
B001 C                   if        *in12 = *on
 001 C                   movel     w_ahug        swsrt1
E001 C                   endif
      *
B001 C                   if        *in13 = *on
 001 C                   movel     sirgrp        swsrt1
E001 C                   endif
      *
B001 C                   if        *in60 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      *blank        w_hgrp
 001 C                   move      *blank        w_ugrp
 001 C                   movel     w_ohug        swsrt1
E001 C                   endif
      *
B001 C                   if        *in61 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      sihgrp        w_hgrp
 001 C                   move      *blank        w_ugrp
 001 C                   movel     w_ohug        swsrt1
E001 C                   endif
      *
B001 C                   if        *in62 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      sihgrp        w_hgrp
 001 C                   move      siugrp        w_ugrp
 001 C                   movel     w_ohug        swsrt1
E001 C                   endif
      *
B001 C                   if        *in14 = *on
 001 C                   movel     silkat        swsrt1
E001 C                   endif
      *
B001 C                   if        *in15 = *on
 001 C                   movel     sirkat        swsrt1
E001 C                   endif
      *
B001 C                   if        *in16 = *on
 001 C                   movel     sidist        swsrt1
E001 C                   endif
      *
B001 C                   if        *in17 = *on
 001 C                   movel     siselg        swsrt1
E001 C                   endif
      *
B001 C                   if        *in18 = *on
 001 C                   movel     siland        swsrt1
E001 C                   endif
      *
B001 C                   if        *in19 = *on
 001 C                   movel     sivare        swsrt1
E001 C                   endif
      *
B001 C                   if        *in20 = *on
B001 C                   if        sivaln = *zeros
 001 C                   movel     sifaln        swsrt1
X001 C                   else
 001 C                   movel     sivaln        swsrt1
E001 C                   endif
E001 C                   endif
      *
B001 C                   if        *in21 = *on
     C                   movel     sipaar        w_siperi
     C                   move      sipmnd        w_siperi
 001 C                   movel     w_siperi      swsrt1
E001 C                   endif
      *
B001 C                   if        *in22 = *on
 001 C                   movel     sibinr        swsrt1
E001 C                   endif
      *
B001 C                   if        *in23 = *on
 001  *                  movel     sifkda        swsrt1
 001 C                   movel     w_peri        swsrt1
E001 C                   endif
      *
B001 C                   if        *in24 = *on
 001 C                   movel     siotyp        swsrt1
E001 C                   endif
      *
B001 C                   if        *in25 = *on
 001 C                   movel     sikavd        swsrt1
E001 C                   endif
      *
B001 C                   if        *in26 = *on
 001 C                   movel     silage        swsrt1
E001 C                   endif
      *
B001 C                   if        *in27 = *on
 001 C                   movel     silkat        whkk
 001 C                   movel     whkk          swsrt1
E001 C                   endif
      *
B001 C                   if        *in28 = *on
 001 C                   movel     sipran        swsrt1
E001 C                   endif
      *
B001 C                   if        *in29 = *on
 001 C                   movel     siladr        swsrt1
E001 C                   endif
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      * Bygg opp sorteringsbegrep 2
      *
B001 C                   if        *in41 = *on
 001 C                   movel     sihgrp        swsrt2
E001 C                   endif
      *
B001 C                   if        *in42 = *on
 001 C                   movel     w_ahug        swsrt2
E001 C                   endif
      *
B001 C                   if        *in43 = *on
 001 C                   movel     sirgrp        swsrt2
E001 C                   endif
      *
B001 C                   if        *in63 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      *blank        w_hgrp
 001 C                   move      *blank        w_ugrp
 001 C                   movel     w_ohug        swsrt2
E001 C                   endif
      *
B001 C                   if        *in64 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      sihgrp        w_hgrp
 001 C                   move      *blank        w_ugrp
 001 C                   movel     w_ohug        swsrt2
E001 C                   endif
      *
B001 C                   if        *in65 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      sihgrp        w_hgrp
 001 C                   move      siugrp        w_ugrp
 001 C                   movel     w_ohug        swsrt2
E001 C                   endif
      *
B001 C                   if        *in44 = *on
 001 C                   movel     silkat        swsrt2
E001 C                   endif
      *
B001 C                   if        *in45 = *on
 001 C                   movel     sirkat        swsrt2
E001 C                   endif
      *
B001 C                   if        *in46 = *on
 001 C                   movel     sidist        swsrt2
E001 C                   endif
      *
B001 C                   if        *in47 = *on
 001 C                   movel     siselg        swsrt2
E001 C                   endif
      *
B001 C                   if        *in48 = *on
 001 C                   movel     siland        swsrt2
E001 C                   endif
      *
B001 C                   if        *in49 = *on
 001 C                   movel     sivare        swsrt2
E001 C                   endif
      *
B001 C                   if        *in50 = *on
B001 C                   if        sivaln = *zeros
 001 C                   movel     sifaln        swsrt2
X001 C                   else
 001 C                   movel     sivaln        swsrt2
E001 C                   endif
E001 C                   endif
      *
B001 C                   if        *in51 = *on
     C                   movel     sipaar        w_siperi
     C                   move      sipmnd        w_siperi
 001 C                   movel     w_siperi      swsrt2
E001 C                   endif
      *
B001 C                   if        *in52 = *on
 001 C                   movel     sibinr        swsrt2
E001 C                   endif
      *
B001 C                   if        *in53 = *on
 001  *                  movel     sifkda        swsrt2
 001 C                   movel     w_peri        swsrt2
E001 C                   endif
      *
B001 C                   if        *in54 = *on
 001 C                   movel     siotyp        swsrt2
E001 C                   endif
      *
B001 C                   if        *in55 = *on
 001 C                   movel     sikavd        swsrt2
E001 C                   endif
      *
B001 C                   if        *in56 = *on
 001 C                   movel     silage        swsrt2
E001 C                   endif
      *
B001 C                   if        *in57 = *on
 001 C                   movel     silkat        whkk
 001 C                   movel     whkk          swsrt2
E001 C                   endif
      *
B001 C                   if        *in58 = *on
 001 C                   movel     sipran        swsrt2
E001 C                   endif
      *
B001 C                   if        *in59 = *on
 001 C                   movel     siladr        swsrt2
E001 C                   endif
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      * Bygg opp sorteringsbegrep 3
      *
B001 C                   if        *in71 = *on
 001 C                   movel     sihgrp        swsrt3
E001 C                   endif
      *
B001 C                   if        *in72 = *on
 001 C                   movel     w_ahug        swsrt3
E001 C                   endif
      *
B001 C                   if        *in73 = *on
 001 C                   movel     sirgrp        swsrt3
E001 C                   endif
      *
B001 C                   if        *in66 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      *blank        w_hgrp
 001 C                   move      *blank        w_ugrp
 001 C                   movel     w_ohug        swsrt3
E001 C                   endif
      *
B001 C                   if        *in67 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      sihgrp        w_hgrp
 001 C                   move      *blank        w_ugrp
 001 C                   movel     w_ohug        swsrt3
E001 C                   endif
      *
B001 C                   if        *in68 = *on
 001 C                   move      siogrp        w_ogrp
 001 C                   move      sihgrp        w_hgrp
 001 C                   move      siugrp        w_ugrp
 001 C                   movel     w_ohug        swsrt3
E001 C                   endif
      *
B001 C                   if        *in74 = *on
 001 C                   movel     silkat        swsrt3
E001 C                   endif
      *
B001 C                   if        *in75 = *on
 001 C                   movel     sirkat        swsrt3
E001 C                   endif
      *
B001 C                   if        *in76 = *on
 001 C                   movel     sidist        swsrt3
E001 C                   endif
      *
B001 C                   if        *in77 = *on
 001 C                   movel     siselg        swsrt3
E001 C                   endif
      *
B001 C                   if        *in78 = *on
 001 C                   movel     siland        swsrt3
E001 C                   endif
      *
B001 C                   if        *in79 = *on
 001 C                   movel     sivare        swsrt3
E001 C                   endif
      *
B001 C                   if        *in50 = *on
B001 C                   if        sivaln = *zeros
 001 C                   movel     sifaln        swsrt3
X001 C                   else
 001 C                   movel     sivaln        swsrt3
E001 C                   endif
E001 C                   endif
      *
B001 C                   if        *in81 = *on
     C                   movel     sipaar        w_siperi
     C                   move      sipmnd        w_siperi
 001 C                   movel     w_siperi      swsrt3
E001 C                   endif
      *
B001 C                   if        *in82 = *on
 001 C                   movel     sibinr        swsrt3
E001 C                   endif
      *
B001 C                   if        *in83 = *on
 001 C*>                 movel     sifkda        swsrt3
 001 C                   movel     w_peri        swsrt3
E001 C                   endif
      *
B001 C                   if        *in84 = *on
 001 C                   movel     siotyp        swsrt3
E001 C                   endif
      *
B001 C                   if        *in85 = *on
 001 C                   movel     sikavd        swsrt3
E001 C                   endif
      *
B001 C                   if        *in86 = *on
 001 C                   movel     silage        swsrt3
E001 C                   endif
      *
B001 C                   if        *in87 = *on
 001 C                   movel     silkat        whkk
 001 C                   movel     whkk          swsrt3
E001 C                   endif
      *
B001 C                   if        *in88 = *on
 001 C                   movel     sipran        swsrt3
E001 C                   endif
      *
B001 C                   if        *in89 = *on
 001 C                   movel     siladr        swsrt3
E001 C                   endif
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
      *
E001 C                   eval      w_valgt = w_valgt + 1
      *
     C                   write     slwwpfr
      *
      * Returner til nytt les
      *
     C                   goto      xtrans
      *
     C     endprg        tag
      *
     C                   write     sm01                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for      hovedgruppe
      * ------------------------------------------
      *
     C     subhgr        begsr
     C                   eval      *in98 = *on
     C                   move      sihgrp        alf2
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        hhgr(n) = *blank
 002 C                   goto      endhgr
E002 C                   endif
 001  *                                                                  .
B002 C                   if        hhgr(n) = alf2
 002 C                   eval      *in98 = *off
 002 C                   goto      endhgr
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endhgr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for      undergruppe
      * ------------------------------------------
      *
     C     subugr        begsr
     C                   eval      *in98 = *on
     C                   move      sihgrp        alf2
     C                   move      siugrp        alf3
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        uugr(n) = *blank
 002 C                   goto      endugr
E002 C                   endif
 001  *                                                                  .
B002 C                   if        uhgr(n) = *blank
 002 C                   goto      endugr
E002 C                   endif
 001  *                                                                  .
B002 C                   if        uhgr(n) = alf2
B002 C                   if        uugr(n) = alf3
 002 C                   eval      *in98 = *off
 002 C                   goto      endugr
E002 C                   endif
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endugr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for rabattgruppe
      * ------------------------------------------
      *
     C     subrgr        begsr
     C                   eval      *in98 = *on
     C                   move      sirgrp        alf3
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        rgr(n) = *blank
 002 C                   goto      endrgr
E002 C                   endif
 001  *                                                                  .
B002 C                   if        rgr(n) = alf3
 002 C                   eval      *in98 = *off
 002 C                   goto      endrgr
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endrgr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for varegruppe  (Nobb)
      * ------------------------------------------
      *
     C     subgrp        begsr
     C                   eval      *in98 = *on
     C                   move      siogrp        alf2x
     C                   move      sihgrp        alf2
     C                   move      siugrp        alf3
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        oogp(n) = *blank
 002 C                   goto      endogp
E002 C                   endif
 001  *
B002 C                   if        oogp(n) = alf2x
 002 C                   eval      *in98 = *off
 002 C                   goto      endgrp
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endogp        tag
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        hogp(n) = *blank
B002 C                             or hhgp(n) = *blank
 002 C                   goto      endhgp
E002 C                   endif
 001  *
B002 C                   if        hogp(n) = alf2x
B002 C                             and hhgp(n) = alf2
 002 C                   eval      *in98 = *off
 002 C                   goto      endgrp
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endhgp        tag
      *
     C                   eval      *in98 = *on
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        uugp(n) = *blank
B002 C                             or uhgp(n) = *blank
B002 C                             or uogp(n) = *blank
 002 C                   goto      endugp
E002 C                   endif
 001  *
B002 C                   if        uogp(n) = alf2x
B002 C                             and uhgp(n) = alf2
B002 C                             and uugp(n) = alf3
 002 C                   eval      *in98 = *off
 002 C                   goto      endgrp
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endugp        tag
      *
     C     endgrp        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for Leverandørkategori
      * ------------------------------------------
      *
     C     subkka        begsr
     C                   eval      *in98 = *on
     C                   move      silkat        alf4
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        kka(n) = *blank
 002 C                   goto      endkka
E002 C                   endif
 001  *
B002 C                   if        kka(n) = alf4
 002 C                   eval      *in98 = *off
 002 C                   goto      endkka
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endkka        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for rabattkategori
      * ------------------------------------------
      *
     C     subrka        begsr
     C                   eval      *in98 = *on
     C                   move      sirkat        alf3
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        rka(n) = *blank
 002 C                   goto      endrka
E002 C                   endif
 001  *
B002 C                   if        rka(n) = alf3
 002 C                   eval      *in98 = *off
 002 C                   goto      endrka
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endrka        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for distrikt
      * ------------------------------------------
      *
     C     subdis        begsr
     C                   eval      *in98 = *on
     C                   move      sidist        alf2
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        dis(n) = *blank
 002 C                   goto      enddis
E002 C                   endif
 001  *
B002 C                   if        dis(n) = alf2
 002 C                   eval      *in98 = *off
 002 C                   goto      enddis
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     enddis        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for selger
      * ------------------------------------------
      *
     C     subsel        begsr
     C                   eval      *in98 = *on
     C                   move      siselg        alf2
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        sel(n) = *blank
 002 C                   goto      endsel
E002 C                   endif
 001  *
B002 C                   if        sel(n) = alf2
 002 C                   eval      *in98 = *off
 002 C                   goto      endsel
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endsel        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for land
      * ------------------------------------------
      *
     C     sublan        begsr
     C                   eval      *in98 = *on
     C                   move      siland        alf3
      *
B001 C     1             do        999           n
 001  *
B002 C                   if        lan(n) = *blank
 002 C                   goto      endlan
E002 C                   endif
 001  *
B002 C                   if        lan(n) = alf3
 002 C                   eval      *in98 = *off
 002 C                   goto      endlan
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endlan        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for varenummer fra / til
      * ------------------------------------------
      *
     C     subvnr        begsr
     C                   eval      *in98 = *on
      *
B001 C     1             do        10            n
 001  *
B002 C                   if        srfvar(n) = *blank
 002 C                   goto      endvnr
E002 C                   endif
 001  *
B002 C                   if        srfvar(n) <= sivare
B003 C                   if        srtvar(n) >= sivare
 003 C                   eval      *in98 = *off
 003 C                   goto      endvnr
E003 C                   endif
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endvnr        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for leverandørnummer fra / til
      * ------------------------------------------
      *
     C     sublnr        begsr
     C                   eval      *in98 = *on
      *
B001 C                   if        sivaln = *zeros
 001 C                   movel     sifaln        wlnr
      *
X001 C                   else
 001 C                   movel     sivaln        wlnr
E001 C                   endif
      *
B001 C     1             do        10            n
 001  *
B002 C                   if        srflev(n) = *blank
 002 C                   goto      endlnr
E002 C                   endif
 001  *
B002 C                   if        srflev(n) <= wlnr
B003 C                   if        srtlev(n) >= wlnr
 003 C                   eval      *in98 = *off
 003 C                   goto      endlnr
E003 C                   endif
E002 C                   endif
 001  *
E001 C                   enddo
      *
     C     endlnr        endsr
      *
      /space 2
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for periode fra / til
      * ------------------------------------------
      *
     C     subper        begsr
     C                   eval      *in98 = *on
B001 C                   if        srfper <= w_peri
B002 C                   if        srtper >= w_peri
 002 C                   eval      *in98 = *off
E002 C                   endif
E001 C                   endif
      *
     C                   endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for fakturanr/kreditnotanr
      * ------------------------------------------
      *
     c     subfnr        begsr
     c                   eval      *in98 = *on
      *
B002 c                   if        srffak <= sibinr
B003 c                   if        srtfak >= sibinr
 003 c                   eval      *in98 = *off
E003 c                   endif
E002 c                   endif
      *
B002 c                   if        srfkre <= sibinr
B003 c                   if        srtkre >= sibinr
 003 c                   eval      *in98 = *off
E003 c                   endif
E002 c                   endif
      *
     c                   endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for fakturadato  fra / til
      * ------------------------------------------
      *
     C     subfda        begsr
     C                   eval      *in98 = *on
     C                   move      sibida        w_bida
B001 C                   if        srffda <= w_bida
B002 C                   if        srftda >= w_bida
 002 C                   eval      *in98 = *off
E002 C                   endif
E001 C                   endif
      *
     C                   endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for ordretype
      * ------------------------------------------
      *
     C     suboty        begsr
     C                   eval      *in98 = *on
     C                   move      siotyp        alf2
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        oty(n) = *blank
 002 C                   goto      endoty
E002 C                   endif
 001  *                                                                  .
B002 C                   if        oty(n) = alf2
 002 C                   eval      *in98 = *off
 002 C                   goto      endoty
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endoty        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for avdeling
      * ------------------------------------------
      *
     C     subavd        begsr
     C                   eval      *in98 = *on
     C                   move      sikavd        alf4
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        avd(n) = *blank
 002 C                   goto      endavd
E002 C                   endif
 001  *                                                                  .
B002 C                   if        avd(n) = alf4
 002 C                   eval      *in98 = *off
 002 C                   goto      endavd
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endavd        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for lager
      * ------------------------------------------
      *
     C     sublag        begsr
     C                   eval      *in98 = *on
     C                   move      silage        alf2
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        lag(n) = *blank
 002 C                   goto      endlag
E002 C                   endif
 001  *                                                                  .
B002 C                   if        lag(n) = alf2
 002 C                   eval      *in98 = *off
 002 C                   goto      endlag
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endlag        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for produktansvarlig
      * ------------------------------------------
      *
     C     subpra        begsr
     C                   eval      *in98 = *on
     C                   move      sipran        alf5
      *
B001 C     1             do        999           n
 001  *                                                                  .
B002 C                   if        pra(n) = *blank
 002 C                   goto      endpra
E002 C                   endif
 001  *                                                                  .
B002 C                   if        pra(n) = alf5
 002 C                   eval      *in98 = *off
 002 C                   goto      endpra
E002 C                   endif
 001  *                                                                  .
E001 C                   enddo
      *
     C     endpra        endsr
      *
      /space 2
      *
      * ------------------------------------------
      * Subrutine for kampanje
      * ------------------------------------------
      *
     C     subkam        begsr
     C                   eval      *in98 = *on
 001  *
B002 C                   if        srkamp = sikamp
 002 C                   eval      *in98 = *off
 002 C                   goto      endkam
E002 C                   endif
 001  *
     C     endkam        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     *inzsr        begsr
      *
     C     *entry        plist
     C                   parm                    dstype           10
     C                   parm                    dskode            1
     *
     C                   eval      ty00 = *blank
     C                   eval      wlnr = *blank
     C                   eval      alf2 = *blank
     C                   eval      alf3 = *blank
     C                   eval      alf4 = *blank
     C                   eval      swsrt1 = *blank
     C                   eval      swsrt2 = *blank
     C                   eval      swsrt3 = *blank
     C                   eval      rpt01 = *blank
     C                   eval      rpt02 = *blank
     C                   eval      rpt03 = *blank
     C                   eval      styp = *zero
     C                   eval      n = *zero
     C                   eval      v = *zero
     C                   eval      whkk = *zero
     C                   eval      w_lest = *zero
     C                   eval      w_valgt = *zero
      *
     c                   eval      w_srfirm = l_firm
     c                   eval      w_srtype = dstype
     c                   eval      w_ohug = *zeros
      *
     C                   time                    umtid
     C                   move      umtime        tid
      *
      /eject
      *
      * -------------------------
      * Hent inn parameterposter
      * -------------------------
      *
     C                   eval      w_srfirm = l_firm
     C                   eval      w_srtype = dstype
     C                   eval      w_srkode = *zeros
     C                   eval      w_srvalg = *blank
     c     slpml1_key    setll     slpml1
      *
     C     nyles         tag
      *
     C                   eval      styp = srkode
     C                   read      slpml1                                 10
B001 C                   if        *in10 = *on
 001 C                   goto      pslut
E001 C                   endif
      *
      * Sjekk riktig firma
      *
B001 C                   if        srfirm  > l_firm
 001 C                   goto      pslut
E001 C                   endif
      *
      * Sjekk riktig kode
      *
B001 C                   if        srtype  > dstype
 001 C                   goto      pslut
E001 C                   endif
      *
B001 C                   if        styp <> srkode
 001 C                   eval      n = 0
E001 C                   endif
      *
     C                   eval      n = n + 1
      *
      * TYPE 00
      * -------
      *
B001 C                   if        srkode = 00
 001 C                   move      'J'           ty00
 001  *
 001  * Skriv heading på
 001  * kvitteringsliste
 001  *
 001 c                   write     HD1A                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
 001  *
 001  *
 001  *
 001  *
 001  *
 001  *
 001  *
 001  *
 001  *
 001  * Test sorteringsbegrep
 001  *
 001 C                   eval      *in11 = r1 = 11
 001 C                   eval      *in12 = r1 = 12
 001 C                   eval      *in13 = r1 = 13
 001 C                   eval      *in60 = r1 = 14
 001 C                   eval      *in61 = r1 = 15
 001 C                   eval      *in62 = r1 = 16
 001 C                   eval      *in14 = r1 = 21
 001 C                   eval      *in15 = r1 = 22
 001 C                   eval      *in16 = r1 = 23
 001 C                   eval      *in17 = r1 = 24
 001 C                   eval      *in18 = r1 = 25
 001 C                   eval      *in19 = r1 = 31
 001 C                   eval      *in20 = r1 = 32
 001 C                   eval      *in21 = r1 = 41
 001 C                   eval      *in22 = r1 = 42
 001 C                   eval      *in23 = r1 = 43
 001 C                   eval      *in24 = r1 = 51
 001 C                   eval      *in25 = r1 = 52
 001 C                   eval      *in26 = r1 = 53
 001 C                   eval      *in27 = r1 = 26
 001 C                   eval      *in28 = r1 = 54
 001 C                   eval      *in29 = r1 = 33
 001  *
 001 C                   eval      *in41 = r2 = 11
 001 C                   eval      *in42 = r2 = 12
 001 C                   eval      *in43 = r2 = 13
 001 C                   eval      *in63 = r2 = 14
 001 C                   eval      *in64 = r2 = 15
 001 C                   eval      *in65 = r2 = 16
 001 C                   eval      *in44 = r2 = 21
 001 C                   eval      *in45 = r2 = 22
 001 C                   eval      *in46 = r2 = 23
 001 C                   eval      *in47 = r2 = 24
 001 C                   eval      *in48 = r2 = 25
 001 C                   eval      *in49 = r2 = 31
 001 C                   eval      *in50 = r2 = 32
 001 C                   eval      *in51 = r2 = 41
 001 C                   eval      *in52 = r2 = 42
 001 C                   eval      *in53 = r2 = 43
 001 C                   eval      *in54 = r2 = 51
 001 C                   eval      *in55 = r2 = 52
 001 C                   eval      *in56 = r2 = 53
 001 C                   eval      *in57 = r2 = 26
 001 C                   eval      *in58 = r2 = 54
 001 C                   eval      *in59 = r2 = 33
 001  *
 001 C                   eval      *in71 = r3 = 11
 001 C                   eval      *in72 = r3 = 12
 001 C                   eval      *in73 = r3 = 13
 001 C                   eval      *in66 = r3 = 14
 001 C                   eval      *in67 = r3 = 15
 001 C                   eval      *in68 = r3 = 16
 001 C                   eval      *in74 = r3 = 21
 001 C                   eval      *in75 = r3 = 22
 001 C                   eval      *in76 = r3 = 23
 001 C                   eval      *in77 = r3 = 24
 001 C                   eval      *in78 = r3 = 25
 001 C                   eval      *in79 = r3 = 31
 001 C                   eval      *in80 = r3 = 32
 001 C                   eval      *in81 = r3 = 41
 001 C                   eval      *in82 = r3 = 42
 001 C                   eval      *in83 = r3 = 43
 001 C                   eval      *in84 = r3 = 51
 001 C                   eval      *in85 = r3 = 52
 001 C                   eval      *in86 = r3 = 53
 001 C                   eval      *in87 = r3 = 26
 001 C                   eval      *in88 = r3 = 54
 001 C                   eval      *in89 = r3 = 33
 001  *
 001  * Ta vare på felt for utskrift
 001  *
     C                   eval      wr1 = r1
     C                   eval      wr2 = r2
     C                   eval      wr3 = r3
     C                   eval      wpsp1 = psp1
     C                   eval      wpsp2 = psp2
     C                   eval      wpsp3 = psp3
     C                   eval      wpsp4 = psp4
     C                   eval      wpsp5 = psp5
      *
E001 C                   endif
      *
      /eject
      *
      * TYPE 11 - Hovedgruppe
      * -------
      *
B001 C                   if        srkode = 11
 001 C                   move      11            v
 001 C                   move      srhgrp        hhgr(n)
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E001 C                   endif
 001 C                   write     pr11                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 12 - Undergruppe
      * -------
      *
B001 C                   if        srkode = 12
 001 C                   move      12            v
 001 C                   move      srhgrp        uhgr(n)
 001 C                   move      srugrp        uugr(n)
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr12                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 13 - Rabattgruppe
      * -------
      *
B001 C                   if        srkode= 13
 001 C                   move      13            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srrgrp        rgr(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr13                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 14 - Overgruppe  (Nobb)
      * -------
      *
B001 C                   if        srkode = 14
 001 C                   move      14            v
 001 C                   move      srnogr        oogp(n)
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E001 C                   endif
 001 C                   write     pr14                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 15 - Hovedgruppe
      * -------
      *
B001 C                   if        srkode = 15
 001 C                   move      15            v
 001 C                   move      srnogr        hogp(n)
 001 C                   move      srnhgr        hhgr(n)
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E001 C                   endif
 001 C                   write     pr15                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
     C                   endif
      *
      * TYPE 16 - Undergruppe
      * -------
      *
B001 C                   if        srkode = 16
 001 C                   move      16            v
 001 C                   move      srnogr        uogp(n)
 001 C                   move      srnhgr        uhgp(n)
 001 C                   move      srnugr        uugp(n)
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr16                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 21 - Leverandørkategori
      * -------
      *
B001 C                   if        srkode = 21
 001 C                   move      21            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srlkat        kka(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr21                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 22 - Rabattkategori
      * -------
      *
B001 C                   if        srkode = 22
 001 C                   move      22            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srrkat        rka(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr22                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
4    C                   goto      nyles
E001 C                   endif
      *
      * TYPE 23 - Distrikt
      * -------
      *
B001 C                   if        srkode = 23
 001 C                   move      23            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srdist        dis(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr23                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 24 - Selger
      * -------
      *
B001 C                   if        srkode = 24
 001 C                   move      24            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srkons        sel(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr24                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 25 - Land
      * -------
      *
B001 C                   if        srkode = 25
 001 C                   move      25            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srland        lan(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr25                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPER 31-32-33-41-42-43-44 INNEHOLDER KUN EN RECORD
      * OG KOMMER AUTOMATISK MED VED READ AV PARAM.
      * ---------------------------------------------
      *
      * TYPE 31 - Varenummer
      * -------
      *
B001 C                   if        srkode = 31
 001 C                   move      31            v
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
     C                   eval      wwfva1 = srfvar(1)
     C                   eval      wwfva2 = srfvar(2)
     C                   eval      wwfva3 = srfvar(3)
     C                   eval      wwfva4 = srfvar(4)
     C                   eval      wwfva5 = srfvar(5)
     C                   eval      wwfva6 = srfvar(6)
     C                   eval      wwfva7 = srfvar(7)
     C                   eval      wwfva8 = srfvar(8)
     C                   eval      wwfva9 = srfvar(9)
     C                   eval      wwfva0 = srfvar(10)
     C                   eval      wwtva1 = srtvar(1)
     C                   eval      wwtva2 = srtvar(2)
     C                   eval      wwtva3 = srtvar(3)
     C                   eval      wwtva4 = srtvar(4)
     C                   eval      wwtva5 = srtvar(5)
     C                   eval      wwtva6 = srtvar(6)
     C                   eval      wwtva7 = srtvar(7)
     C                   eval      wwtva8 = srtvar(8)
     C                   eval      wwtva9 = srtvar(9)
     C                   eval      wwtva0 = srtvar(10)
      *
 001 C                   write     pr31a                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
 001 C                   write     pr31b                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
 001 C                   write     pr31c                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
 001 C                   write     pr31d                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 32 - Leverandørnummer
      * -------
      *
B001 C                   if        srkode = 32
 001 C                   move      32            v
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
     C                   eval      wwfku1 = srflev(1)
     C                   eval      wwfku2 = srflev(2)
     C                   eval      wwfku3 = srflev(3)
     C                   eval      wwfku4 = srflev(4)
     C                   eval      wwfku5 = srflev(5)
     C                   eval      wwfku6 = srflev(6)
     C                   eval      wwfku7 = srflev(7)
     C                   eval      wwfku8 = srflev(8)
     C                   eval      wwfku9 = srflev(9)
     C                   eval      wwfku0 = srflev(10)
     C                   eval      wwtku1 = srtlev(1)
     C                   eval      wwtku2 = srtlev(2)
     C                   eval      wwtku3 = srtlev(3)
     C                   eval      wwtku4 = srtlev(4)
     C                   eval      wwtku5 = srtlev(5)
     C                   eval      wwtku6 = srtlev(6)
     C                   eval      wwtku7 = srtlev(7)
     C                   eval      wwtku8 = srtlev(8)
     C                   eval      wwtku9 = srtlev(9)
     C                   eval      wwtku0 = srtlev(10)
      *
 001 C                   write     pr32a                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
 001 C                   write     pr32b                                30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 41 - Periode
      * -------
      *
B001 C                   if        srkode = 41
 001 C                   move      41            v
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr41                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 42 - Fakturanummer
      * -------
      *
B001 C                   if        srkode = 42
 001 C                   move      42            v
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr42                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 43 - Fakturadato
      * -------
      *
B001 C                   if        srkode = 43
 001 C                   move      43            v
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr43                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 44 - Kampanje
      * -------
      *
B001 C                   if        srkode = 44
 001 C                   move      44            v
 001 C                   move      'J'           utv(v)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr44                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 51 - Ordretype
      * -------
      *
B001 C                   if        srkode = 51
 001 C                   move      51            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srotyp        oty(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr51                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 52 - Avdeling
      * -------
      *
B001 C                   if        srkode = 52
 001 C                   move      52            v
 001 C                   move      'J'           utv(v)
 001 C                   move      sravde        avd(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr52                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
      * TYPE 53 - Lager
      * -------
      *
B001 C                   if        srkode = 53
 001 C                   move      53            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srlage        lag(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr53                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
4    C                   goto      nyles
E001 C                   endif
      *
      * TYPE 54 - Produktansvarlig
      * -------
      *
B001 C                   if        srkode = 54
 001 C                   move      54            v
 001 C                   move      'J'           utv(v)
 001 C                   move      srpran        pra(n)
B002 C                   if        n = 1
     C                   eval      wwrpt = rpt(v)
     C                   exsr      heading
E002 C                   endif
 001 C                   write     pr54                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
     C                   goto      nyles
E001 C                   endif
      *
     C                   goto      nyles
      *
      /eject
      *
     C     pslut         tag
      *
B001 C                   if        ty00 <> 'J'
 001 C                   goto      xtrans
E001 C                   endif
      *
      * Skriv kvittering for sumnivåer
      *
     C                   write     pr00                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
B001 C                   if        wpsp1 = *blank
B002 C                   if        wr1 <> *zero
 002 C                   move      rpt(wr1)      rpt01
E002 C                   endif
 001 C                   write     pr01                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
E001 C                   endif
      *
B001 C                   if        wpsp2 = *blank
B002 C                   if        wr2 <> *zero
 002 C                   move      rpt(wr2)      rpt02
E002 C                   endif
 001 C                   write     pr02                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
E001 C                   endif
      *
B001 C                   if        wpsp3 = *blank
B002 C                   if        wr3 <> *zero
 002 C                   move      rpt(wr3)      rpt03
E002 C                   endif
 001 C                   write     pr03                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
E001 C                   endif
      *
B001 C                   if        wpsp4 = *blank
 001 C                   write     pr04                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
E001 C                   endif
      *
B001 C                   if        wpsp5 = *blank
 001 C                   write     pr05                                 30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
E001 C                   endif
      *
     C                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * ERROR-rutine                                                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     heading       begsr
      *
 002 C                   write     HD2A                                 30
      *
     C                   if        *in30 = *on
     C                   exsr      overflow
     C                   endif
      *
     C                   endsr
      *
     c/space 3
      *
     C     overflow      BEGSR
      *
      * Skriv heading på
      * kvitteringsliste
      *
 001 C                   write     HD1A
 001  *
     C                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tar inn parameter fra forrige program                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
**       GRUPPER SOM KAN SELEKTERES
 Ledig                      01
 Ledig                      02
 Ledig                      03
 Ledig                      04
 Ledig                      05
 Ledig                      06
 Ledig                      07
 Ledig                      08
 Ledig                      09
 Ledig                      10
 Hovedgruppe                11
 Undergruppe                12
 Rabattgrp.                 13
 Overgruppe  (Nobb)         14
 Hovedgruppe (Nobb)         15
 Undergruppe (Nobb)         16
 Ledig                      17
 Ledig                      18
 Ledig                      19
 Ledig                      20
 Leverandørkategori         21
 Rabattkateg.               22
 Distrikt                   23
 Selger                     24
 Land                       25
 Hovedgr.-levr.kategori     26
 Ledig                      27
 Ledig                      28
 Ledig                      29
 Ledig                      30
 Varenummer                 31
 Leverandør                 32
 Ledig                      33
 Ledig                      34
 Ledig                      35
 Ledig                      36
 Ledig                      37
 Ledig                      38
 Ledig                      39
 Ledig                      40
 Periode                    41
 Faktnr/Krednr              42
 Fakturadato                43
 Kampanje                   44
 Ledig                      45
 Ledig                      46
 Ledig                      47
 Ledig                      48
 Ledig                      49
 Ledig                      50
 Ordretype                  51
 Avdeling                   52
 Lager                      53
 Produktansvarlig           54
 Ledig                      55
 Ledig                      56
 Ledig                      57
 Ledig                      58
 Ledig                      59
 Ledig                      60
