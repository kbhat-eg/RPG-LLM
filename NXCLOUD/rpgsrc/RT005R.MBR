     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOKON
      * Program . . . . : RT005R
      * Beskrivelse . . : Danne total kontoplan
      *
      * Leser RHSAPF: Rectype 1 = saldo i år og i fjor på valgt firma
      *                       3 = budsjett i år + neste år
      *                       4 = anslag i år   + neste år
      *
      * Lager fil m/alle forekomster av firma - konto - bærer - avd.
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       060804 HFL  Nytt program
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     frhsal1    if   e           k disk    rename(rhsapfr:rhsal1r)
     Frtotl1    uf a e           k disk    rename(rtotpfr:rtotl1r)
      *
     d                uds
     D  WANN                 801    801  0
     D  WWAAR4               810    813  0
     d lcfirm                944    946  0
     d lcnavn                951    980
      *
     d w_firm          s                   like(rifirm)
     d w_kont          s                   like(rikont)
     d w_spes          s                   like(rispes)
     d w_avde          s                   like(riavde)
      *
     C     *LIKE         DEFINE    WWAAR4        WWIFJ
     C     *LIKE         DEFINE    WWAAR4        WWNEST
      *
     c     rhsal1_key    klist
     C                   KFLD                    w_firm
      *
     C     TOTKEY        KLIST                                                  TOTALKL1
     C                   KFLD                    firma
     C                   KFLD                    konto
     C                   KFLD                    avde
     C                   KFLD                    kbarer
      *
      *------------------------------------------------------------------*
      *   HOVEDPROGRAM                                                   *
      *------------------------------------------------------------------*
     C                   MOVE      lcfirm        w_firm
     C     WWAAR4        SUB       1             WWIFJ
     C     WWAAR4        ADD       1             WWNEST
      *
      * LESER ETT FIRMA i RHSALPF
      *
     c     rhsal1_key    setll     rhsal1                             50
     C     *IN50         DOWEQ     *OFF
     C     rhsal1_key    reade     rhsal1r                                50
     C     *IN50         IFEQ      *OFF
     C     RIRAAR        IFEQ      WWAAR4
     C     RIRAAR        OREQ      WWIFJ
     C     RIRAAR        OREQ      WWNEST
      *
     C     RITYPE        IFEQ      1
      * 1=saldo
     C                   EXSR      saldo
     C                   else                                                   <HSRAAR
      * 3=budsjett
     C     RITYPE        IFEQ      3
     C                   EXSR      budsj
     C                   else                                                   <HSRAAR
      * 4=anslag t
     C     RITYPE        IFEQ      4
     C                   EXSR      ansla
     C                   endif                                                  <HSRAAR
     C                   endif                                                  <HSRAAR
     C                   endif                                                  <HSRAAR
     C                   ENDIF                                                  <HSRAAR
     C                   ENDIF                                                  <IN50
      *
     C                   ENDDO                                                  <IN53
      *
     C     SLUTT         TAG
      *
     C                   MOVE      '1'           *INLR
      *---------------------------------------------------------
      * SUBRUTINE SALDO FLYTTER FELT
      *---------------------------------------------------------
      *
     C     SALDO         BEGSR
      * Tar med i år og i fjor
     C     RIRAAR        IFEQ      WWAAR4
     C     RIRAAR        OREQ      WWIFJ
     C                   MOVE      rifirm        firma
     C                   MOVE      rikont        konto
     C                   MOVE      riavde        avde
     C                   MOVE      rispes        kbarer
     C                   EXSR      TOTAL
     C                   ENDIF
     C                   ENDSR
      *---------------------------------------------------------
      * SUBRUTINE BUDSJ FLYTTER FELT
      *---------------------------------------------------------
      *
     C     BUDSJ         BEGSR
      * Tar med i år og i fjor
     C     RIRAAR        IFEQ      WWAAR4
     C     RIRAAR        OREQ      WWNEST
     C                   MOVE      rifirm        firma
     C                   MOVE      rikont        konto
     C                   MOVE      riavde        avde
     C                   MOVE      rispes        kbarer
     C                   EXSR      TOTAL
     C                   ENDIF
     C                   ENDSR
      *---------------------------------------------------------
      * SUBRUTINE ANSLA FLYTTER FELT
      *---------------------------------------------------------
      *
     C     ANSLA         BEGSR
      * Tar med i år og i fjor
     C     RIRAAR        IFEQ      WWAAR4
     C     RIRAAR        OREQ      WWNEST
     C                   MOVE      rifirm        firma
     C                   MOVE      rikont        konto
     C                   MOVE      riavde        avde
     C                   MOVE      rispes        kbarer
     C                   EXSR      TOTAL
     C                   ENDIF
     C                   ENDSR
      *---------------------------------------------------------
      * SUBRUTINE TOTAL DANNER POST HVIS IKKE FRA FØR
      *---------------------------------------------------------
      *
     C     TOTAL         BEGSR
      *
     C     TOTKEY        CHAIN     RTOTL1R                            59
     C     *IN59         IFEQ      *ON
     C                   WRITE     RTOTL1R
     C                   ENDIF                                                  *IN59
      *
     C                   ENDSR
