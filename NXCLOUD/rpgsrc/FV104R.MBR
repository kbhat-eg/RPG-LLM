     H/TITLE  ASOFAK: Vedlikehold av avrundingsregler
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FV104R
      * Beskrivelse . . : Vedlikehold av status-koder, Avrundingsregler
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *              KOB  Nytt program
      * 6.10  250609 BSA  Oppdatert med sporingsinformasjon
      *
      *
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     FFSTSL1    IF   E           K DISK    RENAME(FSTSPFR:FSTSL1R)
     FFSTSLU    UF A E           K DISK    RENAME(FSTSPFR:FSTSLUR)
      *
     FFV104D    CF   E             WORKSTN
      *
      * Definering av Local data area
      *
     D                UDS
6.10 d l_user                911    920
     D L_FIRM                944    946  0
     D l_fnav                951    980
      *
      * Definering av variable
      *
     D W_FIRM          S                   LIKE(FAAFIR)
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * A1BLD Behandle bildet for valg
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     C     A1TAGA        TAG
      *
      * Hent opplysninger fra statusregisteret
      *
     C     FSTSL1_KEY    CHAIN     FSTSL1                             60
     C     *IN60         IFEQ      *OFF
     C                   MOVE      FAAGR0        A1AGR0
     C                   MOVE      FAAGR1        A1AGR1
     C                   MOVE      FAAGR2        A1AGR2
     C                   MOVE      FAAGR3        A1AGR3
     C                   MOVE      FAAGR4        A1AGR4
     C                   MOVE      FAABL1        A1ABL1
     C                   MOVE      FAABL2        A1ABL2
     C                   MOVE      FAABL3        A1ABL3
     C                   MOVE      FAABL4        A1ABL4
     C                   MOVE      FAABL5        A1ABL5
     C***                MOVE      FAAINK        A1AINK
     C***                MOVE      FAAKOS        A1AKOS
     C***                MOVE      FAAEMV        A1AEMV
     C                   MOVE      FAAIMV        A1AIMV
     C                   ELSE
     C                   MOVE      *ZEROS        A1AGR0
     C                   MOVE      *ZEROS        A1AGR1
     C                   MOVE      *ZEROS        A1AGR2
     C                   MOVE      *ZEROS        A1AGR3
     C                   MOVE      *ZEROS        A1AGR4
     C                   MOVE      *ZEROS        A1ABL1
     C                   MOVE      *ZEROS        A1ABL2
     C                   MOVE      *ZEROS        A1ABL3
     C                   MOVE      *ZEROS        A1ABL4
     C                   MOVE      *ZEROS        A1ABL5
     C***                MOVE      *ZEROS        A1AINK
     C***                MOVE      *ZEROS        A1AKOS
     C***                MOVE      *ZEROS        A1AEMV
     C                   MOVE      *ZEROS        A1AIMV
     C                   ENDIF
      *
      * Legg inn standardverdier
      *
     C                   Z-ADD     0.05          A1ABL1
     C                   Z-ADD     0.10          A1ABL2
     C                   Z-ADD     0.50          A1ABL3
     C                   Z-ADD     1.00          A1ABL4
     C                   Z-ADD     10.00         A1ABL5
      *
      * Vis bilde
      *
     C                   EXFMT     A1BLD
      *
      * F3=Avslutt
      *
     C                   IF        *INKC = *ON OR
     C                             *INKL = *ON
     C                   GOTO      XSLUTT
     C                   ENDIF
      *
      * Kontroller at beløp er stigende
      *
     C     A1AGR1        IFNE      *ZERO
     C     A1AGR1        IFLE      A1AGR0
     C                   MOVE      *ON           *IN31
     C                   GOTO      A1TAGA
     C                   ENDIF
     C                   ENDIF
      *
     C     A1AGR2        IFNE      *ZERO
     C     A1AGR2        IFLE      A1AGR0
     C     A1AGR2        ORLE      A1AGR1
     C                   MOVE      *ON           *IN32
     C                   GOTO      A1TAGA
     C                   ENDIF
     C                   ENDIF
      *
     C     A1AGR3        IFNE      *ZERO
     C     A1AGR3        IFLE      A1AGR0
     C     A1AGR3        ORLE      A1AGR1
     C     A1AGR3        ORLE      A1AGR2
     C                   MOVE      *ON           *IN33
     C                   GOTO      A1TAGA
     C                   ENDIF
     C                   ENDIF
      *
     C     A1AGR4        IFNE      *ZERO
     C     A1AGR4        IFLE      A1AGR0
     C     A1AGR4        ORLE      A1AGR1
     C     A1AGR4        ORLE      A1AGR2
     C     A1AGR4        ORLE      A1AGR3
     C                   MOVE      *ON           *IN34
     C                   GOTO      A1TAGA
     C                   ENDIF
     C                   ENDIF
      *
      * Oppdaterer status-registeret
      *
     C     FSTSLU_KEY    CHAIN     FSTSLUR                            60
      *
     C                   MOVE      A1AGR0        FAAGR0
     C                   MOVE      A1AGR1        FAAGR1
     C                   MOVE      A1AGR2        FAAGR2
     C                   MOVE      A1AGR3        FAAGR3
     C                   MOVE      A1AGR4        FAAGR4
     C                   MOVE      A1ABL1        FAABL1
     C                   MOVE      A1ABL2        FAABL2
     C                   MOVE      A1ABL3        FAABL3
     C                   MOVE      A1ABL4        FAABL4
     C                   MOVE      A1ABL5        FAABL5
     C***                MOVE      A1AINK        FAAINK
     C***                MOVE      A1AKOS        FAAKOS
     C***                MOVE      A1AEMV        FAAEMV
     C                   MOVE      A1AIMV        FAAIMV
      *
     C     *IN60         IFEQ      *OFF
6.10 c                   time                    faaeda
6.10 c                   time                    faaeti
6.10 c                   eval      faaeus = l_user
     C                   UPDATE    FSTSLUR
     C                   ELSE
     C                   MOVE      L_FIRM        FAAFIR
6.10 c                   time                    faaoda
6.10 c                   time                    faaoti
6.10 c                   eval      faaous = l_user
6.10 c                   time                    faaeda
6.10 c                   time                    faaeti
6.10 c                   eval      faaeus = l_user
     C                   WRITE     FSTSLUR
     C                   ENDIF
      *
     C                   GOTO      XSLUTT
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     C     XSLUTT        TAG
      *
     C                   MOVE      *ON           *INLR
     C                   RETURN
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     C     *INZSR        BEGSR
      *
      * Key for oppslag på status-registeret
      *
     c     FSTSL1_KEY    KLIST
     c                   KFLD                    W_FIRM
      *
      * Key for oppdatering  av status-registeret
      *
     c     FSTSLU_KEY    KLIST
     c                   KFLD                    W_FIRM
      *
      *
      * Legger inn firmanummer i nøkklene
      *
     C                   MOVE      L_FIRM        W_FIRM
      *
     C                   ENDSR
