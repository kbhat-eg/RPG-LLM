```markdown
# RPG Program Explanation: RK676R

This RPG code is for a program that prints a report of customers who have exceeded their credit limit, via interactive screen parameter selection.

## 1. Control Options and Metadata

- `h option(*nodebugio) datedit(*dmy)`
  - Specifies options for the program: no debug for I/O and date format is Day-Month-Year.
- Extensive comments describe the program, version history, and indicator usage conventions.

## 2. File Declarations

- `fausrl1 if e k disk`
  - Defines a keyed input file (`ausrl1`) for reading (e=external, k=keyed, disk file).
- `frk676d cf e workstn`
  - Defines a display file (`rk676d`), for screen-based interaction (cf=control/display, e=external, workstn=workstation).

## 3. Data Area and Work Variables

- `uds` (User Data Space) is defined implicitly to access the LDA (Local Data Area).
- Specific fields are mapped within the LDA:
  - `l_user` (positions 911–920): The user’s name.
  - `l_firm` (positions 944–946): Company number.
  - `l_fnav` (positions 951–980): Company name.
- Stand-alone variables:
  - `w_firm` (3,0): Current company number.
  - `w_in03` (1): Stores status code for the print job (`'0'` or `'1'`).
  - `w_type` (1): Stores the type of print requested.

## 4. Main Processing Logic

### Program Start (`dummy` tag)

- **Screen Display for Parameters:**
  - `exfmt a2bld`: Shows the parameter-entry screen (`a2bld` format) and waits for user input.

- **Reset Error Indicator:**
  - `eval *in31 = *off`: Clears the error indicator, used for input validation.

- **Exit Handling:**
  - If function key F3 (`*inkc`) is pressed:
    - Set `w_in03` to `'1'` (exit code).
    - Jump to `xslutt` label to terminate the program.

- **Input Validation for Report Type:**
  - If `a2type` is not `'A'`, `'K'`, or blank:
    - Set error indicator `*in31` (invalid input).
    - Redisplay the parameter screen by going back to `a2taga`.

- **Store Valid Input:**
  - Move `a2type` (type selected on screen) into work variable `w_type`.

- **Call Print Routine:**
  - Calls external program `"RK677C"`, passing `w_in03` (status/exit) and `w_type` (report type) as parameters.

### Program End (`xslutt` tag)

- `eval *inlr = *on`: Signals end of program (last record indicator ON).
- `return`: Exits the program.

## 5. Initialization Subroutine (`*inzsr`)

- Initializes default values when the program starts:
  - Sets `a2type` to `'K'` (default report type).
  - Sets `w_in03` to `'0'` (normal start state).
  - Copies LDA company number (`l_firm`) to work variable `w_firm`.

## 6. Indicators Usage

The comments document internal indicator usage:
- F1 (`KA`): Select company
- F3 (`KC`): Exit
- `LR`: End of program
- `30`: Protect (lock) screen fields
- `31–59`: Error/Warning/Screen indicators
- `60–69`: File status/chain
- `70–79`: Work indicators in subroutines
- `80–89`: Ordinary work indicators
- `90–99`: Standard subroutines

## 7. Summary of Flow

1. Program initializes, loading default values from LDA.
2. Displays the parameter entry screen (`a2bld`) for the user to select report parameters.
3. Validates the user’s selection:
   - If invalid, shows an error and redisplays the screen.
   - If F3 is pressed, exits.
   - If valid, stores the parameters and calls the print routine.
4. After print or exit, cleans up and ends the program.

---

### Key Points for Onboarding

- The program is mostly user interaction and validation, passing parameters to another program for report generation.
- All company and user context is obtained from the LDA.
- User interacts through a display file driven by the `a2bld` screen format.
- All indicator logic and error handling follow clear conventions set out in comments.
- Changes to supported report types or validation must be reflected in both the validation logic and the display file.
```