      /TITLE  GL320R Henter navn på filer til/fra banken
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * System  . . . . : ASTELE                                        *
      * Program . . . . : GL210R                                        *
      * Beskrivelse . . : Kontroll på om TF2 er mottatt tidligere      g*
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      * Spesialversjon. :                                               *
      * Tilpasset for . :                                               *
      *                                                                 *
      * Referanse  Dato   Endringsbeskrivelse                      Sign.*
      * --------- ------  ----------------------------------------------*
      *           270204  Nytt program                             RH   *
      *                                                                 *
      * 08074     080704  Utvidet kontrollen mhp TF2 (27024)       RH   *
      *                                                                 *
      * 12105     121005  Avviser ikke lenger hele batchen når det RH   *
      *                   mottas dobbel retur for en post, dvs det      *
      *                   er brukeren selv som må slette post via       *
      *                   "Jusering".                                   *
      *                                                                 *
6.10  * 10.05.11  NHO     Feilmelding også vedr. UTLAND, betfor04       *
      *                   *in33 tilsier utland                          *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KC = F3  = Exit                                           *
      *       KL = F12 = Annuller                                       *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     fgl210d    cf   e             workstn
     fgubflu    if   e           k disk
     fgatrlu    if   e           k disk
      *
     d lda            uds
     d l_fgrp                931    933
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d                 ds
     d d_00a                        131
     d  d_betf                        8    overlay(d_00a:41)
     d  d_bfnr                        3    overlay(d_00a:09)
     d  d_bfli                        5    overlay(d_00a:12)
08074d  d_belp                       15  2 overlay(d_00a:18)
08074d  d_belk                        1    overlay(d_00a:33)
08074d  d_levr                        6    overlay(d_00a:31)
08074d  d_leva                       15    overlay(d_00a:49)
6.10  *
6.10 d d_00b                        131
6.10 d  x_hj00                        5    overlay(d_00b:1)
6.10 d  x_belk                        1    overlay(d_00b:6)
6.10 d  x_betf                        8    overlay(d_00b:41)
6.10 d  x_bfnr                        3    overlay(d_00b:57)
6.10 d  x_bfli                        5    overlay(d_00b:60)
6.10 d  x_belp                       10  0 overlay(d_00b:71)
6.10 d  x_levr                        6    overlay(d_00b:31)
      *
27024d wxlØpn          s                   like(gblØpn)
27024d wxtype          s                   like(gbtype)
27024d wxgiro          s                   like(gbgiro)
27024d wxfeil          s              1
27024d wxfilg          s              3
27024d wxfirm          s              3  0
27024d wxbfnr          s              3  0
27024d wxbfli          s              5  0
08074d wxlevr          s              6  0
08074d wxleva          s             15
08074d wxbelp          s             15  2
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Test på parameterinformasjon.                                   *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a1tag         tag
      *
      * Hent opp informasjon
      *
     c     key01         setll     gatrlu
     c     key01         reade     gatrlu
      *
     c                   dow       not %eof
6.10 c                   eval      *in33 = '0'
      *
      *    Dersom BETFOR21 må det leses 1 records til for å nå
      *    linjen som inneholde leverandørnummer og navn:
      *
08074c                   movel     gbreco        d_00a
08074c                   if        d_betf = 'BETFOR21'
08074c     key01         reade     gatrlu
08074c                   movel     gbreco        d_00a
08074c                   movel     d_levr        wxlevr
08074c                   movel     d_leva        wxleva
08074c                   endif
      *
6.104c                   if        d_betf = 'BETFOR01'
6.104c     key01         reade     gatrlu
6.104c                   movel     gbreco        d_00b
6.104c                   movel     x_levr        wxlevr
6.104c                   movel     *blank        wxleva
6.104c                   endif
      *
      *    Dersom BETFOR23 må det leses 3 records til for å nå
      *    linjen som inneholde forslags- og linjenummer:
      *
      *    Tester da på om forslag finnes.  Dersom IKKE, så er TF2
      *    lest inn tiligere, og det må sendes opp ADVARSEL:
      *
6.10  *    Sjekker utland
6.10 c                   if        d_betf = 'BETFOR04'
6.10 c                   eval      *in33 = '1'
6.10 c                   endif
      *
     c                   movel     gbreco        d_00a
6.10 c*                  if        d_betf = 'BETFOR23'
6.10 c                   if        d_betf = 'BETFOR23' or
6.10 c                             d_betf = 'BETFOR04'
     c     key01         reade     gatrlu
6.10 c   33              movel     gbreco        d_00b
6.10  *
6.10 c                   if        *in33 = '1'
6.10 c                   movel     x_bfnr        wxbfnr
6.10 c                   movel     x_bfli        wxbfli
6.10 c                   movel     x_belp        wxbelp
6.10 c                   endif
     c     key01         reade     gatrlu
6.10 c                   if        *in33 = '1'
6.10 c                   movel     gbreco        d_00b
6.10 c                   goto      utlan1
6.10 c                   endif
6.10  *
     c     key01         reade     gatrlu
     c                   movel     gbreco        d_00a
     c                   movel     d_bfnr        wxbfnr
     c                   movel     d_bfli        wxbfli
      *
08074c                   if        d_belk = 'K'
08074c                   eval      d_belp = d_belp * -1
08074c                   endif
6.10  *
6.10 c  N33              movel     d_belp        wxbelp
6.10  *
6.10 c     utlan1        tag
6.10  *
6.10 c                   if        *in33 = '1'
6.10 c     key01         reade     gatrlu
6.10 c                   move      x_hj00        wxbelp
6.10 c                   if        x_belk = 'K'
6.10 c                   eval      wxbelp = wxbelp * -1
6.10 c                   endif
6.10 c                   endif
      *
     c     key02         chain     gubflu
      *
     c                   if        not %found
12105c                   eval      w_arow = 2
12105c                   eval      w_acol = 33
12105c                   eval      e1lØpn = wxlØpn
12105c                   eval      e1fors = wxbfnr
12105c                   eval      e1linj = wxbfli
12105c                   eval      e1levr = wxlevr
12105c                   eval      e1leva = wxleva
12105c                   eval      e1belp = wxbelp
12105c                   exfmt     e1win
     c                   eval      wxfeil = 'F'
     c***                   eval      *inlr = *on
     c***                   leave
     c                   endif
      *
     c                   endif
      *
     c     key01         reade     gatrlu
     c                   enddo
      *
     c                   eval      *inlr = *on
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    wxgiro
     c                   parm                    wxlØpn
     c                   parm                    wxtype
     c                   parm                    wxfirm
     c                   parm                    wxbfnr
     c                   parm                    wxbfli
     c                   parm                    wxlevr
     c                   parm                    wxleva
     c                   parm                    wxbelp
     c                   parm                    wxfeil
      *
     c     *dtaara       define    *lda          lda
      *
      * Key for GBTRLU:
      *
     c     key01         klist
     c                   kfld                    wxgiro
     c                   kfld                    wxlØpn
     c                   kfld                    wxtype
      *
      * Key for GUBFLU:
      *
     c     key02         klist
     c                   kfld                    wxfirm
     c                   kfld                    wxbfnr
     c                   kfld                    wxbfli
      *
     c                   endsr
