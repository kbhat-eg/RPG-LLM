# RPG Program CI700R - Explanation

This ILE RPG program (`CI700R`) is a simple utility that serves as an interface to call another program (`CI701R`). It primarily deals with parameter passing and follows common RPG III/400 style.

---

## 1. Program Header & Options

```rpg
h option(*nodebugio) datedit(*dmy)
```
- **option(*nodebugio):** Disables debug I/O to improve performance and reduce debug information.
- **dateedit(*dmy):** Sets default date editing to day/month/year format.

---

## 2. Documentation Block

- Describes the system, program name, purpose (Internet, export to file - external call), author, and change history (originally written 2011-05-15 by HKO).

---

## 3. Parameter Definitions

```rpg
d p_firm          s              3
d p_avde          s              4
```
- **p_firm:** A 3-character string, intended to hold a "firm" or company code.
- **p_avde:** A 4-character string, possibly a department or division code.

---

## 4. Data Structure for Outgoing Parameters

```rpg
d                 ds
d d_list                         8
d  d_firm                        3  0 overlay(d_list:1)
d  d_avde                        4  0 overlay(d_list:4)
```
- **d_list:** An 8-byte structure used to pass parameters as a single block.
    - **d_firm:** 3-character numeric (packed) field, starting at byte 1 of `d_list`.
    - **d_avde:** 4-character numeric (packed) field, starting at byte 4 of `d_list`.
- `overlay` aligns these subfields on top of `d_list`, making it easy to populate and pass both fields as one parameter.

---

## 5. Main Program Logic

```rpg
c                   move      p_firm        d_firm
c                   move      p_avde        d_avde
```
- Moves the incoming program parameter values (`p_firm` and `p_avde`) into the data structure fields (`d_firm`, `d_avde`). This prepares `d_list` for the call.

```rpg
c                   call      'CI701R'
c                   parm                    d_list
```
- Calls program `CI701R`, passing the assembled `d_list` parameter. The expectation is that `CI701R` will unpack and process the firm and avde values.

---

## 6. Program Exit

```rpg
c     avslutt       tag
c                   eval      *inlr = *on
c                   return
```
- **avslutt:** Tag label for the ending point (not used for GOTO here).
- **eval *inlr = *on:** Sets the Last Record Indicator, signaling RPG to clean up (close files, reclaim storage, end program).
- **return:** Ends the program.

---

## 7. Program Initialization Subroutine (`*inzsr`)

```rpg
c     *inzsr        begsr
c     *entry        plist
c                   parm                    p_firm
c                   parm                    p_avde
c                   endsr
```
- **\*inzsr:** Implicit initialization subroutine, run at program start.
- **\*entry plist:** Defines the program's parameter list, mapping two external parameters onto `p_firm` and `p_avde`.
- Ensures that when the program is called, the parameters provided are loaded into `p_firm` and `p_avde`.

---

## **Summary**

- The program receives two parameters: `p_firm` (company) and `p_avde` (department).
- These are moved into a data structure (`d_list`) that overlays both values for compact parameter passing.
- The program then calls another program (`CI701R`), passing this structured parameter.
- Finally, it cleans up and exits.
- The structure and style follow classic RPG standards, designed for straightforward parameter mediation between programs.