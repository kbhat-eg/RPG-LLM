     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
     frxmll1    if   e           k disk    rename(rxmlpfr:rxmll1r)
     frhtrl5    if   e           k disk    rename(rhtrpfr:rhtrl5r)
     faxmlut    o    e             disk
      *
      *  Dette programmet henter data fra ADBxxx/RHTRPF m/RBFIRM = Firma
      *
6.30  *  281116  sst  Lagt til brudd på bilagsdato i tillegg til bil.nummer
xml   *  100519  sst  Tilpasset standard xml utskrift
7.00  *  090222  sst  Justert utleging av kontonr.
      *
     d                uds
     d l_firm                944    946  0
     d l_user                911    920
      *
     d rhtrl5_firm     s                       like(rbfirm)
     d rhtrl5_raar     s                       like(rbraar)
     d rhtrl5_rper     s                       like(rbrper)
     d rhtrl5_biln     s                       like(rbbiln)
6.30 d rhtrl5_bdat     s                       like(rbbdat)
     d rhtrl5_kont     s                       like(rbkont)
     d rhtrl5_spes     s                       like(rbspes)
      *
     d rxmll1_head     s                       like(axhead)
     d rxmll1_linj     s                       like(axlinj)
      *
xml  d XML_Input       s            256a   Varying
xml  d XML_Output      s            256a   Varying
xml  d XML_Outhead     s            256a   Varying
xml  d XML_path        s            256a
xml  d w_xmlp          s             50
xml  d options         s            200a   Varying
      *
6.22 d w_firm          s              3A   inz('000')
6.22 d w_firmn         s              3S 0
6.22 d w_neto          s                   like(rbneto)
6.22 d text            s             50
6.22 d txt2            s             50
6.22 d stmt            s            500A
6.22 d xmlut           s            500A
6.22 d i               s              9S 0
6.22 d j               s              9S 0
6.22 d s_i             s              9S 0
6.22 d f               s              3
6.22 d t               s              3
6.22 d s               s              3S 0
6.22 d fn              s              3S 0
6.22 d tn              s              3S 0
     d s_head          s                   like(axhead)
     d s_linj          s                   like(axlinj)
     d s_kont          s                   like(rbkont)
     d s_biln          s                   like(rbbiln)
6.30 d s_bdat          s                   like(rbbdat)
     d s_linja         s                   like(axlinj)
     d s_kontx         s              5
     d w_iso_dat       s               d   datfmt(*iso)
     d w_x_dat         s             10A
     d w_salix         s             14
     d w_salux         s             14
     d w_test          s            100
     d w_02            s              2S 2
     d w_s             s             11S 2
     d w_110           s             11S 0
     d w_110x          s             11
     d w_02x           s              2
     d w_saldoi        s             11S 2
     d w_saldou        s             11S 2
     d w_kurs          s              6S 3
     d w_kx            s              6
      * *
     d w_str_i         s            100
     d w_str_u         s            100
     d w_posi          s              2  0
     d w_posu          s              2  0
     d w_str_x         s              1
     d c_apos          c                   x'7D'
      * *
     d p_perfm         s              2
     d p_perfa         s              4
     d p_pertm         s              2
     d p_perta         s              4
     d p_pfm           s              2S 0
     d p_pfa           s              4S 0
     d p_ptm           s              2S 0
     d p_pta           s              4S 0
     d p_frabil        s                       like(rbbiln)
     d                                         inz(00000000)
     d p_hcom          s             50
      *
      *    Posisjoner Hovedbok på fra periode ==================>
     c     StartP        tag
      *    ======
     c                   eval      rhtrl5_firm = w_firmn
     c                   eval      rhtrl5_raar = p_pfa
     c                   eval      rhtrl5_rper = p_pfm
     c                   eval      rhtrl5_biln = *zero
6.30 c                   eval      rhtrl5_bdat = *loval
     c                   eval      rhtrl5_kont = *zero
     c                   eval      rhtrl5_spes = *zero
     c     rhtrl5_key    setll     rhtrl5
     c                   read      rhtrl5
      *   Les fram til det bilag jeg ønsker og teste på    NBNBNBNB!!!!!!
      *   >>>>>>>>>>>>>>   DETTE SKAL UTIGJEN NÅR TESTING OK <<<<<<<<<<<<
      *
     c                   dow       rbbiln < p_frabil
     c                   read      rhtrl5
     c                   enddo
      *                                                     UT hit.
      *    Skriv ut ev heading xml - linjer før loop pr bilag, until 'S'
     c                   dow       axmaop <> 'S'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   enddo
     c                   eval      s_linjA = axlinj
      *
      *    Start Hovedbok nytt Bilag ===========================>
     c     HovedP        tag
      *
      *  Behandle alle bilag
     c                   dow       not %eof(rhtrl5)  and
     c                             rbfirm = w_firmn  and
     c                             (rbraar < p_pta   or
     c                             (rbraar = p_pta    and
     c                              rbrper <= p_ptm))
      *  Debugsst
     c                   if        rbbiln = 704
     c                             and   rbkont = 7740
     c                             and   rbrper = 09
     c                   eval      rbrper = rbrper
     c                   endif
      *
      *    Her skal man komme tilbake for hvert nytt bilag.    Debug
     c                   eval      rbbiln = rbbiln
     c                   exsr      Bilag
     c                   enddo
      *
      *    Siste bilag er nå behandlet
      *    Legg ut ev faste linjer som avlsutning på Hovedbok
     c                   dow       not %eof(rxmll1) and
     c                             axhead = 'HOVEDBOK'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   if        axlinj = 350
     c                   eval      axlinj = axlinj
     c                   endif
     c                   enddo
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * ----------------------------------------------------------------
     c     Bilag         begsr
      *
     c     StartBilag    tag
      *    Her skal man start på nytt på nytt bilag   linje 20   Debug
     c                   eval      rxmll1_linj = s_linjA
     c     rxmll1_key    setll     rxmll1
     c                   read      rxmll1
     c                   if        axmaop = 'S'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   endif
      *
      *  Skriv xml for start bilag
     c                   dow       axmaop <> 'S' and
     c                             axmaop <> 'E'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   enddo
      *   Lagre start xml for ny konto(postering)
     c                   eval      s_linj = axlinj
      *   Lagre dette bilagsnummer
     c                   eval      s_biln = rbbiln
6.30 c                   eval      s_bdat = rbbdat
      *
      *  Skrive  alle linjene på en postering
     c                   dow       not %eof(rhtrl5) and
6.30 c                             rbbiln = s_biln  and
6.30 c                             rbbdat = s_bdat
     c                   exsr      BehKonto
     c                   enddo
      *  Skrive slutt xml for bilaget
     c                   dow       not %eof(rxmll1) and
     c                             axmaop <> 'E'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   enddo
     c                   if        axmaop = 'E'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   endif
      *
     c                   endsr
      * ----------------------------------------------------------------
      *
      *
      *
     c     BehKonto      begsr
     c                   eval      rbkont = rbkont
      *  Skriv xml Start konto
     c                   eval      rxmll1_linj = s_linj
     c     rxmll1_key    setll     rxmll1
     c                   read      rxmll1
      *  Beh alle xml linjer for denne konto(postering)
     c                   dow       axmaop <> 'E'
     c                   exsr      sxmlut
     c                   read      rxmll1
     c                   enddo
      *   Skriv xml Slutt konto
     c                   exsr      sxmlut
     c                   read      rxmll1
      *   Les neste konto(postering)
     c                   read      rhtrl5
      *
     c                   endsr
      * ----------------------------------------------------------------
      *
      *
      * >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
      *     SXMLUT  legger ut linja etter koder fra alle nivåer
      *     ---------------------------------------------------
     c     SXMLUT        begsr
x     *  Hvis type er merket med 'X' er ikke denne linja klargjort enda
x    c                   if        axtype = 'X'
x    c                   goto      EXMLUT
x    c                   endif
     c                   if        axlinj = 360
     c                   eval      axlinj = axlinj
     c                   endif
x     *
x     *  Sjekk om linja er avhengig av innhold i felt
x    c                   if        axmaop = 'V'
x    c                   if        axfast = '*IF +'   and
x    c                             axfelt = 'RBNETO'  and
     c                             rbneto < 0
x    c                   goto      EXMLUT
x    c                   endif
x    c                   if        axfast = '*IF -'   and
x    c                             axfelt = 'RBNETO'  and
     c                             rbneto >= 0
x    c                   goto      EXMLUT
x    c                   endif
     c                   endif
      *  Skip en sekvens dersom felt inneholder ??
     c                   if        axmaop = 'O' and
     c                             %subst(axfast:1:9) = 'SKIP IF =' and
     c                             axfelt = 'RBMVAK' and
     c                             rbmvak = '0'
     c                   eval      s = %scan('<':axxmlt)
     c                   if        s > 0
     c                   eval      w_test = %subst(axxmlt:1:s) + '/' +
     c                                      %subst(axxmlt:s+1:100-s)
     c                   dow       w_test <> axxmlt and
     c                             not %eof(rxmll1)
     c                   read      rxmll1
     c                   eval      axxmlt = axxmlt
     c                   enddo
      *                  read      rxmll1
     c                   goto      EXMLUT
     c                   endif
     c                   endif
      *
x     *
x     *  Sjekk om bare xml linja skal ut
x    c                   if        axtype = 'F'
x    c                   eval      xmlrec = axxmlt
x    c                   goto      skrivxml
x    c                   endif
x     *
x     *  Skal det hentes inn et variabelt felt?
x    c                   eval      i = %scan('?V?':axxmlt)
x    c                   if        i > 0
x     *  Dagens dato hentes dersom axtype = 'C' (current)
x    c                   if        axtype = 'C'
x    c     *dmy          move      udate         w_iso_dat
x    c                   move      w_iso_dat     w_x_dat
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(w_x_dat) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   goto      skrivxml
x    c                   endif
x     *
x    c                   eval      text = *blank
x     *
x     *  Hente inn tekst felt
x    c                   if        axtype = 'T'
      *
     c                   select
     c                   when      axfelt = 'RBOUSR'
     c                   movel     rbousr        text
     c                   when      axfelt = 'RBTEXT'
     c                   movel     rbtext        text
     c                   exsr      spstgn
     c                   when      axfelt = 'RBMVAK'
     c                   movel     rbmvak        text
     c                   exsr      redmvak
     c                   endsl
x     *
x    c                   if        %subst(axfast:1:1) = '('
x    c                   eval      j = %scan(',':axfast)
x    c                   if        j > 0
x    c                   eval      f = %subst(axfast:2:3)
x    c                   eval      t = %subst(axfast:6:3)
x    c                   move      f             fn
x    c                   move      t             tn
x    c                   eval      txt2 = %subst(text:fn:tn-fn+1)
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(txt2) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   goto      skrivxml
x    c                   endif
x    c                   endif
x     *
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(text) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   endif
x     *  Hente inn numerisk felt
x    c                   if        axtype = 'N'
     c                   select
     c                   when      axfelt = 'RBBILN'
     c                   movel     rbbiln        text
     c                   when      axfelt = 'RBRPER'
     c                   movel     rbrper        text
     c                   when      axfelt = 'RBRAAR'
     c                   movel     rbraar        text
     c                   when      axfelt = 'RBBDAT'
     c                   movel     rbbdat        text
     c                   when      axfelt = 'RBJOUR'
     c                   movel     rbjour        text
      *
     c                   when      axfelt = 'RBODAT'
     c                   movel     rbodat        text
      *
     c                   when      axfelt = 'RBKONT'
7.00 c                   eval      s_kont = rbkont
7.00 c                   move      s_kont        s_kontx
7.00 c                   dow       %subst(s_kontx:1:1) = '0' or
7.00 c                             s_kont = 0
7.00 c                   eval      %subst(s_kontx:1:4) = %subst(s_kontx:2:4)
7.00 c                   eval      %subst(s_kontx:5:1) = ' '
7.00 c                   enddo
7.00 c                   movel     s_kontx       text
      *
     c                   when      axfelt = 'RBPMVA'
     c                   movel     rbpmva        text
     c                   if        rbmvak = '0'  and
     c                             rbmvag = 0
     c                   eval      text   = *blank
     c                   endif
     c                   exsr      redefnum
      *
     c                   when      axfelt = 'RBAMVA'
     c                   movel     rbamva        text
     c                   if        rbmvak = '0'  and
     c                             rbmvag = 0
     c                   eval      text   = *blank
     c                   endif
     c                   exsr      redefnum
      *
     c                   when      axfelt = 'RBMVAB'
     c                   if        rbmvab < 0
     c                   eval      rbmvab = rbmvab * -1
     c                   endif
     c                   movel     rbmvab        text
     c                   exsr      redefnum
      *
     c                   when      axfelt = 'RBNETO'
     c                   if        rbneto < 0
     c                   eval      w_neto = rbneto * -1
     c                   else
     c                   eval      w_neto = rbneto
     c                   endif
     c                   movel     w_neto        text
     c                   exsr      redefnum
     c                   eval      text = text
     c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
     c                             %trim(text) +
     c                             %subst(axxmlt:i+3:50)
     c                   write     axmlutr
     c                   if        rbvalk <> '   ' and
     c                             rbvalk <> 'NOK' and
     c                             rbvalb <> 0     and
     c                             rbvalb <> rbneto
     c                   eval      xmlrec = '               ' +
     c                                      '<CurrencyCode>' +
     c                                      %trim(rbvalk) +
     c                                      '</CurrencyCode>'
     c                   write     axmlutr
     c                   movel     rbvalb        text
     c                   exsr      redefnum
     c                   eval      xmlrec = '               ' +
     c                                      '<CurrencyAmount>' +
     c                                      %trim(text) +
     c                                      '</CurrencyAmount>'
     c                   write     axmlutr
     c                   eval      w_kurs = rbneto / rbvalb
     c                   move      w_kurs        w_kx
     c                   eval      xmlrec = '               ' +
     c                                      '<ExchangeRate>' +
     c                                      %trim(%subst(w_kx:1:3)) + '.' +
     c                                      %trim(%subst(w_kx:4:3)) +
     c                                      '</ExchangeRate>'
     c                   write     axmlutr
     c                   endif
     c                   goto      Exmlut
      *
     c                   endsl
      *
     c                   eval      text = text
     c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
     c                             %trim(text) +
     c                             %subst(axxmlt:i+3:50)
     c                   endif
      *
      *  Hente inn dato felt
     c                   if        axtype = 'D'
     c                   select
     c                   when      axfelt = 'RBBDAT'
     c                   movel     rbbdat        text
     c                   when      axfelt = 'RBODAT'
     c                   movel     rbodat        text
x    c                   endsl
x     *
x    c                   eval      w_x_dat = text
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(w_x_dat) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   endif
x     *  Hente inn parameter via p_xxxxx felt fra axfelt
x    c                   if        axtype = 'P'
x    c                   eval      text = *blank
x    c                   select
x    c                   when      axfelt = 'P_PERFM'
x    c                   movel     p_perfm       text
x    c                   when      axfelt = 'P_PERFA'
x    c                   movel     p_perfa       text
x    c                   when      axfelt = 'P_PERTM'
x    c                   movel     p_pertm       text
x    c                   when      axfelt = 'P_PERTA'
x    c                   movel     p_perta       text
x    c                   when      axfelt = 'P_HCOM'
x    c                   movel     p_hcom        text
x    c                   when      axfelt = 'L_USER'
x    c                   movel     l_user        text
x    c                   endsl
x     *
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(text) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   endif
x     *
x    c                   goto      skrivxml
x     *  END ?V?
x    c                   endif
x     *
x     *  Sjekk om faste felter skal legges ut
x    c                   eval      i = %scan('?F?':axxmlt)
x    c                   if        i > 0
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(axfast) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   goto      skrivxml
x    c                   endif
x     *
x     *  Sjekk xml linja skal ut med parameter
x    c                   if        axtype = 'F'
x    c                   eval      xmlrec = %subst(axxmlt:1:i-1) +
x    c                             %trim(axfast) +
x    c                             %subst(axxmlt:i+3:50)
x    c                   goto      skrivxml
x    c                   endif
x    c     skrivxml      tag
x    c                   write     axmlutr
      *
     c     EXMLUT        tag
      *
     c                   endsr
      * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
     c     redefnum      begsr
     c                   dow       %subst(text:1:1) = '0'
     c                             and %subst(text:3:1) <> ' '
     c                   eval      %subst(text:1:20) = %subst(text:2:20)
     c                   enddo
     c     ' '           scan      text          j
     c                   if        j > 3
     c                   eval      text = %subst(text:1:j-3) + '.' +
     c                                    %subst(text:j-2:2)
     c                   else
     c                   eval      text = '0.' + %subst(text:1:2)
     c                   endif
     c                   if        text = '0.'
     c                   eval      text = '0 '
     c                   endif
     c                   endsr
      * <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
     c     redmvak       begsr
     c                   select
     c                   when      text = '0'
     c                   eval      text = '00'
     c                   when      text = '1'
     c                   eval      text = '01'
     c                   when      text = '2'
     c                   eval      text = '02'
     c                   when      text = '3'
     c                   eval      text = '03'
     c                   when      text = '4'
     c                   eval      text = '04'
     c                   when      text = '5'
     c                   eval      text = '05'
     c                   when      text = '6'
     c                   eval      text = '06'
     c                   when      text = '7'
     c                   eval      text = '07'
     c                   when      text = '8'
     c                   eval      text = '08'
     c                   when      text = '9'
     c                   eval      text = '09'
     c                   when      text = 'A'
     c                   eval      text = '34'
     c                   when      text = 'B'
     c                   eval      text = '35'
     c                   when      text = 'C'
     c                   eval      text = '36'
     c                   when      text = 'D'
     c                   eval      text = '37'
     c                   when      text = 'E'
     c                   eval      text = '38'
     c                   when      text = 'F'
     c                   eval      text = '39'
     c                   when      text = 'G'
     c                   eval      text = '40'
     c                   when      text = 'H'
     c                   eval      text = '13'
     c                   when      text = 'I'
     c                   eval      text = '11'
     c                   when      text = 'J'
     c                   eval      text = '21'
     c                   when      text = 'K'
     c                   eval      text = '23'
     c                   when      text = 'L'
     c                   eval      text = '41'
     c                   when      text = 'M'
     c                   eval      text = '42'
     c                   when      text = 'N'
     c                   eval      text = '43'
     c                   when      text = 'O'
     c                   eval      text = '44'
     c                   when      text = 'P'
     c                   eval      text = '45'
     c                   when      text = 'R'
     c                   eval      text = '46'
     c                   when      text = 'S'
     c                   eval      text = '47'
     c                   when      text = 'T'
     c                   eval      text = '12'
     c                   when      text = 'U'
     c                   eval      text = '10'
     c                   when      text = 'V'
     c                   eval      text = '48'
     c                   endsl
     c                   endsr
      *----
     c     spstgn        begsr
     c                   eval      s_i = i
     c     'Æ'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'06' +
     c                             %subst(text:i+1:50-i)
     c     'Æ'           scan      text          i
     c                   enddo
      *
     c     'Ø'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'38' +
     c                             %subst(text:i+1:50-i)
     c     'Ø'           scan      text          i
     c                   enddo
      *
     c     'Å'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'15' +
     c                             %subst(text:i+1:50-i)
     c     'Å'           scan      text          i
     c                   enddo
      *
     c     'æ'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'70' +
     c                             %subst(text:i+1:50-i)
     c     'æ'           scan      text          i
     c                   enddo
      *
     c     'ø'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'9D' +
     c                             %subst(text:i+1:50-i)
     c     'ø'           scan      text          i
     c                   enddo
      *
     c     'å'           scan      text          i
     c                   dow       i > 0
     c                   eval      text   = %subst(text:1:i-1) +
     c                             X'66' + X'B2' +
     c                             %subst(text:i+1:50-i)
     c     'å'           scan      text          i
     c                   enddo
     c                   eval      i = s_i
     c*    'Æ':X'92'     xlate     text          text
     c*    'æ':X'91'     xlate     text          text
     c*    'Ø':X'9D'     xlate     text          text
     c*    'ø':X'9B'     xlate     text          text
     c*    'Å':X'8F'     xlate     text          text
     c*    'å':X'86'     xlate     text          text
     c*    '§':X'9B'     xlate     text          text
     c*    'é':X'AE'     xlate     text          text
     c*    'è':X'FE'     xlate     text          text
     c*    'É':X'1A'     xlate     text          text
     c*    'È':X'35'     xlate     text          text
     c*    'ü':X'FA'     xlate     text          text
     c*    'Ü':X'04'     xlate     text          text
     c*    'ö':X'E1'     xlate     text          text
     c*    'Ö':X'75'     xlate     text          text
     c*    'ä':X'CF'     xlate     text          text
     c*    'Ä':X'20'     xlate     text          text
     c*    'à':X'EE'     xlate     text          text
     c*    'À':X'22'     xlate     text          text
     c*    'á':X'59'     xlate     text          text
     c*    'Á':X'17'     xlate     text          text
     c                   eval      w_posi = 0
     c                   eval      w_posu = 0
     c                   eval      w_str_u = *blank
     c                   eval      w_str_i = text
      *
     c                   dow       w_posi < 70
     c                   eval      w_posi = w_posi + 1
     c                   eval      w_str_x = %subst(w_str_i:w_posi:1)
     c                   if        w_posu < 90
     c                   select
     c                   when      w_str_x = '&'
     c                   eval      w_posu = w_posu + 1
     c                   eval      %subst(w_str_u:w_posu:5) = '&amp;'
     c                   eval      w_posu = w_posu + 4
      *
     c                   when      w_str_x = '<'
     c                   eval      w_posu = w_posu + 1
     c                   eval      %subst(w_str_u:w_posu:4) = '&lt;'
     c                   eval      w_posu = w_posu + 3
      *
     c                   when      w_str_x = '>'
     c                   eval      w_posu = w_posu + 1
     c                   eval      %subst(w_str_u:w_posu:4) = '&gt;'
     c                   eval      w_posu = w_posu + 3
      *
     c                   when      w_str_x = c_apos
     c                   eval      w_posu = w_posu + 1
     c                   eval      %subst(w_str_u:w_posu:6) = '&apos;'
     c                   eval      w_posu = w_posu + 5
      *
     c                   when      w_str_x = '"'
     c                   eval      w_posu = w_posu + 1
     c                   eval      %subst(w_str_u:w_posu:6) = '&quot;'
     c                   eval      w_posu = w_posu + 5
      *
     c                   other
     c                   eval      w_posu = w_posu + 1
     c                   eval      %subst(w_str_u:w_posu:1) = w_str_x
      *
     c                   endsl
     c                   endif
     c                   enddo
      *
     c                   eval      text   =  w_str_u
      *
     c                   endsr
      * =============================================================
     c     *inzsr        begsr
      *
     c     rhtrl5_key    klist
     c                   kfld                    rhtrl5_firm
     c                   kfld                    rhtrl5_raar
     c                   kfld                    rhtrl5_rper
     c                   kfld                    rhtrl5_biln
6.30 c                   kfld                    rhtrl5_bdat
     c                   kfld                    rhtrl5_kont
     c                   kfld                    rhtrl5_spes
      *
     c     rxmll1_key    klist
     c                   kfld                    rxmll1_head
     c                   kfld                    rxmll1_linj
      *
     c     *dtaara       define                  ax000par        100
     c     *lock         in        *dtaara
     c                   eval      p_perfm = %subst(ax000par:1:2)
     c                   eval      p_perfa = %subst(ax000par:3:4)
     c                   eval      p_pertm = %subst(ax000par:7:2)
     c                   eval      p_perta = %subst(ax000par:9:4)
     c                   eval      p_hcom  = %subst(ax000par:13:50)
      *
     c                   move      p_perfm       p_pfm
     c                   move      p_perfa       p_pfa
     c                   move      p_pertm       p_ptm
     c                   move      p_perta       p_pta
      *
     c                   move      w_firm        w_firmn
     c                   movel     'HOVEDBOK'    rxmll1_head
     c                   movel     'HOVEDBOK'    s_head
     c                   move      *zero         rxmll1_linj
     c     rxmll1_key    setll     rxmll1
     c                   read      rxmll1
      *
     c                   endsr
      *
