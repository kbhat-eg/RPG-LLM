      /TITLE  ASOFAK Opprydding i filer
     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FO400R
      * Beskrivelse . . : Endre firma
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       101299 KOB  Nytt program
      * 6.10  250609 BSA  Oppdatert med sporingsinformasjon
6.11  * 6.10  070110 bof  Lagt til vvepf
6.20  * 6.20  041110 bof  utvidet nøkkel vsdtpf/vshepf
6.21  * 6.20  210311 bof  utvidet nøkkel vvprpf
6.22  * 6.20  020511 bof  utvidet vtilpf med varegr./ldor
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fvahglu    uf   e           k disk    rename(vahgpfr:vahglur)
     fvauglu    uf   e           k disk    rename(vaugpfr:vauglur)
     fvbldlu    uf   e           k disk    rename(vbldpfr:vbldlur)
     fveanlu    uf   e           k disk    rename(veanpfr:veanlur)
     fvenhlu    uf   e           k disk    rename(venhpfr:venhlur)
     fvetilu    uf   e           k disk    rename(vetipfr:vetilur)
     fvfaslu    uf   e           k disk    rename(vfaspfr:vfaslur)
     fvhgrlu    uf   e           k disk    rename(vhgrpfr:vhgrlur)
     fvhislu    uf   e           k disk    rename(vhispfr:vhislur)
     fvinflu    uf   e           k disk    rename(vinfpfr:vinflur)
     fvkhvlu    uf   e           k disk    rename(vkhvpfr:vkhvlur)
     fvlaglu    uf   e           k disk    rename(vlagpfr:vlaglur)
     fvltylu    uf   e           k disk    rename(vltypfr:vltylur)
     fvltplu    uf   e           k disk    rename(vltppfr:vltplur)
     fvogrlu    uf   e           k disk    rename(vogrpfr:vogrlur)
     fvotylu    uf   e           k disk    rename(votypfr:votylur)
     fvparlu    uf   e           k disk    rename(vparpfr:vparlur)
     fvpdtlu    uf   e           k disk    rename(vpdtpfr:vpdtlur)
     fvphelu    uf   e           k disk    rename(vphepfr:vphelur)
     fvpkolu    uf   e           k disk    rename(vpkopfr:vpkolur)
     fvsdtlu    uf   e           k disk    rename(vsdtpfr:vsdtlur)
     fvshelu    uf   e           k disk    rename(vshepfr:vshelur)
     fvsoklu    uf   e           k disk    rename(vsokpfr:vsoklur)
     fvstrlu    uf   e           k disk    rename(vstrpfr:vstrlur)
     fvtillu    uf   e           k disk    rename(vtilpfr:vtillur)
     fvugrlu    uf   e           k disk    rename(vugrpfr:vugrlur)
     fvvaqpf    uf   e           k disk    rename(vvaqpfr:vvaqpfr)
     fvvarlu    uf   e           k disk    rename(vvarpfr:vvarlur)
     fvvaslu    uf   e           k disk    rename(vvaspfr:vvaslur)
     fvvenlu    uf   e           k disk    rename(vvenpfr:vvenlur)
     fvveplu    uf   e           k disk    rename(vveppfr:vveplur)
     fvvgklu    uf   e           k disk    rename(vvgkpfr:vvgklur)
     fvvprlu    uf   e           k disk    rename(vvprpfr:vvprlur)
     fvvsolu    uf   e           k disk    rename(vvsopfr:vvsolur)
     fvvtylu    uf   e           k disk    rename(vvtypfr:vvtylur)
      *
     d                uds
     d l_user                911    920
     d l_fgrp                931    933
     d l_firm                944    946  0
     d l_navn                951    980
      *
     d w_firm          s              3  0
      *
      * Alternativ hovedgruppe
      *
     c     vahglu_key    setll     vahglu                                 90
     c     vahglu_key    reade     vahglu                                 90
     c                   dow       *in90 = *off
     c                   eval      vfhfir = w_firm
6.10 c                   time                    vfheda
6.10 c                   time                    vfheti
6.10 c                   eval      vfheus = l_user
     c                   update    vahglur
     c     vahglu_key    reade     vahglu                                 90
     c                   enddo
      *
      * Alternativ undergruppe
      *
     c     vauglu_key    setll     vauglu                                 90
     c     vauglu_key    reade     vauglu                                 90
     c                   dow       *in90 = *off
     c                   eval      vfufir = w_firm
6.10 c                   time                    vfueda
6.10 c                   time                    vfueti
6.10 c                   eval      vfueus = l_user
     c                   update    vauglur
     c     vauglu_key    reade     vauglu                                 90
     c                   enddo
      *
      * Bilde-alternativ
      *
     c     vbldlu_key    setll     vbldlu                                 90
     c     vbldlu_key    reade     vbldlu                                 90
     c                   read      vbldlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vabfir = w_firm
6.10 c                   time                    vabeda
6.10 c                   time                    vabeti
6.10 c                   eval      vabeus = l_user
     c                   update    vbldlur
     c     vbldlu_key    reade     vbldlu                                 90
     c                   enddo
      *
      * EAN-register
      *
     c     veanlu_key    setll     veanlu                                 90
     c     veanlu_key    reade     veanlu                                 90
     c                   read      veanlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vxfirm = w_firm
6.10 c                   time                    vxedat
6.10 c                   time                    vxetim
6.10 c                   eval      vxeusr = l_user
     c                   update    veanlur
     c     veanlu_key    reade     veanlu                                 90
     c                   enddo
      *
      * Enhetsregister
      *
     c     venhlu_key    setll     venhlu                                 90
     c     venhlu_key    reade     venhlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vaefir = w_firm
6.10 c                   time                    vaeeda
6.10 c                   time                    vaeeti
6.10 c                   eval      vaeeus = l_user
     c                   update    venhlur
     c     venhlu_key    reade     venhlu                                 90
     c                   enddo
      *
      * Etikettregister
      *
     c     vetilu_key    setll     vetilu                                 90
     c     vetilu_key    reade     vetilu                                 90
     c                   dow       *in90 = *off
     c                   eval      vmfirm = w_firm
6.10 c                   time                    vmetim
6.10 c                   time                    vmedat
6.10 c                   eval      vmeusr = l_user
     c                   update    vetilur
     c     vetilu_key    reade     vetilu                                 90
     c                   enddo
      *
      * Fast tekst etiketter
      *
     c     vfaslu_key    setll     vfaslu                                 90
     c     vfaslu_key    reade     vfaslu                                 90
     c                   dow       *in90 = *off
     c                   eval      vnfirm = w_firm
6.10 c                   time                    vnedat
6.10 c                   time                    vnetim
6.10 c                   eval      vneusr = l_user
     c                   update    vfaslur
     c     vfaslu_key    reade     vfaslu                                 90
     c                   enddo
      *
      * Hovedgruppe
      *
     c     vhgrlu_key    setll     vhgrlu                                 90
     c     vhgrlu_key    reade     vhgrlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vghfir = w_firm
6.10 c                   time                    vgheda
6.10 c                   time                    vgheti
6.10 c                   eval      vgheus = l_user
     c                   update    vhgrlur
     c     vhgrlu_key    reade     vhgrlu                                 90
     c                   enddo
      *
      * Historisk lagerbok
      *
     c     vhislu_key    setll     vhislu                                 90
     c     vhislu_key    reade     vhislu                                 90
     c                   dow       *in90 = *off
     c                   eval      vhfirm = w_firm
6.10 c                   time                    vhedat
6.10 c                   time                    vhetim
6.10 c                   eval      vheusr = l_user
     c                   update    vhislur
     c     vhislu_key    reade     vhislu                                 90
     c                   enddo
      *
      * Ordreinformasjon
      *
     c     vinflu_key    setll     vinflu                                 90
     c     vinflu_key    reade     vinflu                                 90
     c                   dow       *in90 = *off
     c                   eval      vaifir = w_firm
6.10 c                   time                    vaieda
6.10 c                   time                    vaieti
6.10 c                   eval      vaieus = l_user
     c                   update    vinflur
     c     vinflu_key    reade     vinflu                                 90
     c                   enddo
      *
      * Kontohenvisning
      *
     c     vkhvlu_key    setll     vkhvlu                                 90
     c     vkhvlu_key    reade     vkhvlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vakfir = w_firm
6.10 c                   time                    vakeda
6.10 c                   time                    vaketi
6.10 c                   eval      vakeus = l_user
     c                   update    vkhvlur
     c     vkhvlu_key    reade     vkhvlu                                 90
     c                   enddo
      *
      * Lager
      *
     c     vlaglu_key    setll     vlaglu                                 90
     c     vlaglu_key    reade     vlaglu                                 90
     c                   dow       *in90 = *off
     c                   eval      vlfirm = w_firm
6.10 c                   time                    vledat
6.10 c                   time                    vletim
6.10 c                   eval      vleusr = l_user
     c                   update    vlaglur
     c     vlaglu_key    reade     vlaglu                                 90
     c                   enddo
      *
      * Leveringstype
      *
     c     vltplu_key    setll     vltplu                                 90
     c     vltplu_key    reade     vltplu                                 90
     c                   dow       *in90 = *off
     c                   eval      vyfirm = w_firm
6.10 c                   time                    vyedat
6.10 c                   time                    vyetim
6.10 c                   eval      vyeusr = l_user
     c                   update    vltplur
     c     vltplu_key    reade     vltplu                                 90
     c                   enddo
      *
      * Linjetype
      *
     c     vltylu_key    setll     vltylu                                 90
     c     vltylu_key    reade     vltylu                                 90
     c                   dow       *in90 = *off
     c                   eval      valfir = w_firm
6.10 c                   time                    valeda
6.10 c                   time                    valeti
6.10 c                   eval      valeus = l_user
     c                   update    vltylur
     c     vltylu_key    reade     vltylu                                 90
     c                   enddo
      *
      * Overgruppe
      *
     c     vogrlu_key    setll     vogrlu                                 90
     c     vogrlu_key    reade     vogrlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vgofir = w_firm
6.10 c                   time                    vgoeda
6.10 c                   time                    vgoeti
6.10 c                   eval      vgoeus = l_user
     c                   update    vogrlur
     c     vogrlu_key    reade     vogrlu                                 90
     c                   enddo
      *
      * Ordretype
      *
     c     votylu_key    setll     votylu                                 90
     c     votylu_key    reade     votylu                                 90
     c                   dow       *in90 = *off
     c                   eval      vaofir = w_firm
6.10 c                   time                    vaoeda
6.10 c                   time                    vaoeti
6.10 c                   eval      vaoeus = l_user
     c                   update    votylur
     c     votylu_key    reade     votylu                                 90
     c                   enddo
      *
      * Parameter
      *
     c     vparlu_key    setll     vparlu                                 90
     c     vparlu_key    reade     vparlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vwpfir = w_firm
     c                   update    vparlur
     c     vparlu_key    reade     vparlu                                 90
     c                   enddo
      *
      * Påslag-linje
      *
     c     vpdtlu_key    setll     vpdtlu                                 90
     c     vpdtlu_key    reade     vpdtlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vjfirm = w_firm
6.10 c                   time                    vjedat
6.10 c                   time                    vjetim
6.10 c                   eval      vjeusr = l_user
     c                   update    vpdtlur
     c     vpdtlu_key    reade     vpdtlu                                 90
     c                   enddo
      *
      * Påslag-hode
      *
     c     vphelu_key    setll     vphelu                                 90
     c     vphelu_key    reade     vphelu                                 90
     c                   dow       *in90 = *off
     c                   eval      vifirm = w_firm
6.10 c                   time                    viedat
6.10 c                   time                    vietim
6.10 c                   eval      vieusr = l_user
     c                   update    vphelur
     c     vphelu_key    reade     vphelu                                 90
     c                   enddo
      *
      * Priskoder
      *
     c     vpkolu_key    setll     vpkolu                                 90
     c     vpkolu_key    reade     vpkolu                                 90
     c                   dow       *in90 = *off
     c                   eval      vapfir = w_firm
6.10 c                   time                    vapeda
6.10 c                   time                    vapeti
6.10 c                   eval      vapusr = l_user
     c                   update    vpkolur
     c     vpkolu_key    reade     vpkolu                                 90
     c                   enddo
      *
      * Varesortiment linje
      *
     c     vsdtlu_key    setll     vsdtlu                                 90
     c     vsdtlu_key    reade     vsdtlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vdfirm = w_firm
6.10 c                   time                    vdedat
6.10 c                   time                    vdetim
6.10 c                   eval      vdeusr = l_user
     c                   update    vsdtlur
     c     vsdtlu_key    reade     vsdtlu                                 90
     c                   enddo
      *
      * Varesortiment hode
      *
     c     vshelu_key    setll     vshelu                                 90
     c     vshelu_key    reade     vshelu                                 90
     c                   dow       *in90 = *off
     c                   eval      vcfirm = w_firm
6.10 c                   time                    vcedat
6.10 c                   time                    vcetim
6.10 c                   eval      vceusr = l_user
     c                   update    vshelur
     c     vshelu_key    reade     vshelu                                 90
     c                   enddo
      *
      * Søketekst
      *
     c     vsoklu_key    setll     vsoklu                                 90
     c     vsoklu_key    reade     vsoklu                                 90
     c                   dow       *in90 = *off
     c                   eval      vsfirm = w_firm
     c                   update    vsoklur
     c     vsoklu_key    reade     vsoklu                                 90
     c                   enddo
      *
      * Strukturvarer
      *
     c     vstrlu_key    setll     vstrlu                                 90
     c     vstrlu_key    reade     vsoklu                                 90
     c                   dow       *in90 = *off
     c                   eval      vufirm = w_firm
6.10 c                   time                    vuedat
6.10 c                   time                    vuetim
6.10 c                   eval      vueusr = l_user
     c                   update    vstrlur
     c     vstrlu_key    reade     vstrlu                                 90
     c                   enddo
      *
      * Tilbud
      *
     c     vtillu_key    setll     vtillu                                 90
     c     vtillu_key    reade     vtillu                                 90
     c                   dow       *in90 = *off
     c                   eval      vtfirm = w_firm
6.10 c                   time                    vtedat
6.10 c                   time                    vtetim
6.10 c                   eval      vteusr = l_user
     c                   update    vtillur
     c     vtillu_key    reade     vtillu                                 90
     c                   enddo
      *
      * Undergruppe
      *
     c     vugrlu_key    setll     vugrlu                                 90
     c     vugrlu_key    reade     vugrlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vgufir = w_firm
6.10 c                   time                    vgueda
6.10 c                   time                    vgueti
6.10 c                   eval      vgueus = l_user
     c                   update    vugrlur
     c     vugrlu_key    reade     vugrlu                                 90
     c                   enddo
      *
      * Vare Query
      *
     c                   read      vvaqpf                                 90
     c                   dow       *in90 = *off
     c                   if        vvfirm = l_firm
     c                   eval      vvfirm = w_firm
     c                   update    vvaqpfr
     c                   endif
     c                   read      vvaqpf                                 90
     c                   enddo
      *
      * Vare
      *
     c     vvarlu_key    setll     vvarlu                                 90
     c     vvarlu_key    reade     vvarlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vvfirm = w_firm
6.10 c                   time                    vvedat
6.10 c                   time                    vvetim
6.10 c                   eval      vveusr = l_user
     c                   update    vvarlur
     c     vvarlu_key    reade     vvarlu                                 90
     c                   enddo
      *
      * Slettede varer
      *
     c     vvaslu_key    setll     vvaslu                                 90
     c     vvaslu_key    reade     vvaslu                                 90
     c                   dow       *in90 = *off
     c                   eval      vvfirm = w_firm
6.10 c                   time                    vvedat
6.10 c                   time                    vvetim
6.10 c                   eval      vveusr = l_user
     c                   update    vvaslur
     c     vvaslu_key    reade     vvaslu                                 90
     c                   enddo
      *
      * Vare-enhet
      *
     c     vvenlu_key    setll     vvenlu                                 90
     c     vvenlu_key    reade     vvenlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vefirm = w_firm
6.10 c                   time                    veedat
6.10 c                   time                    veetim
6.10 c                   eval      veeusr = l_user
     c                   update    vvenlur
     c     vvenlu_key    reade     vvenlu                                 90
     c                   enddo
6.11  *
6.11  * Vare-enhet-prisgiver
6.11  *
6.11 c     vveplu_key    setll     vveplu                                 90
6.11 c     vveplu_key    reade     vveplu                                 90
6.11 c                   dow       *in90 = *off
6.11 c                   eval      vepfir = w_firm
6.11 c                   time                    vepeda
6.11 c                   time                    vepeda
6.11 c                   eval      vepeus = l_user
6.11 c                   update    vveplur
6.11 c     vveplu_key    reade     vveplu                                 90
6.11 c                   enddo
      *
      * Varegruppeknytning
      *
     c     vvgklu_key    setll     vvgklu                                 90
     c     vvgklu_key    reade     vvgklu                                 90
     c                   dow       *in90 = *off
     c                   eval      vkfirm = w_firm
6.10 c                   time                    vkedat
6.10 c                   time                    vketim
6.10 c                   eval      vkeusr = l_user
     c                   update    vvgklur
     c     vvgklu_key    reade     vvgklu                                 90
     c                   enddo
      *
      * Vare-pris
      *
     c     vvprlu_key    setll     vvprlu                                 90
     c     vvprlu_key    reade     vvprlu                                 90
     c                   dow       *in90 = *off
     c                   eval      vpfirm = w_firm
6.10 c                   time                    vpedat
6.10 c                   time                    vpetim
6.10 c                   eval      vpeusr = l_user
     c                   update    vvprlur
     c     vvprlu_key    reade     vvprlu                                 90
     c                   enddo
      *
      * Vare-søk
      *
     c     vvsolu_key    setll     vvsolu                                 90
     c     vvsolu_key    reade     vvsolu                                 90
     c                   dow       *in90 = *off
     c                   eval      vvsfir = w_firm
     c                   update    vvsolur
     c     vvsolu_key    reade     vvsolu                                 90
     c                   enddo
      *
      * Varetype
      *
     c     vvtylu_key    setll     vvtylu                                 90
     c     vvtylu_key    reade     vvtylu                                 90
     c                   dow       *in90 = *off
     c                   eval      vavfir = w_firm
6.10 c                   time                    vaveda
6.10 c                   time                    vaveti
6.10 c                   eval      vaveus = l_user
     c                   update    vvtylur
     c     vvtylu_key    reade     vvtylu                                 90
     c                   enddo
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
     c     *entry        plist
     c                   parm                    w_firm
      *
     c     vahglu_key    klist
     c                   kfld                    l_firm
      *
     c     vauglu_key    klist
     c                   kfld                    l_firm
      *
     c     vbldlu_key    klist
     c                   kfld                    l_firm
      *
     c     veanlu_key    klist
     c                   kfld                    l_firm
      *
     c     venhlu_key    klist
     c                   kfld                    l_firm
      *
     c     vetilu_key    klist
     c                   kfld                    l_firm
      *
     c     vfaslu_key    klist
     c                   kfld                    l_firm
      *
     c     vhgrlu_key    klist
     c                   kfld                    l_firm
      *
     c     vhislu_key    klist
     c                   kfld                    l_firm
      *
     c     vinflu_key    klist
     c                   kfld                    l_firm
      *
     c     vkhvlu_key    klist
     c                   kfld                    l_firm
      *
     c     vlaglu_key    klist
     c                   kfld                    l_firm
      *
     c     vltylu_key    klist
     c                   kfld                    l_firm
      *
     c     vltplu_key    klist
     c                   kfld                    l_firm
      *
     c     vogrlu_key    klist
     c                   kfld                    l_firm
      *
     c     votylu_key    klist
     c                   kfld                    l_firm
      *
     c     vparlu_key    klist
     c                   kfld                    l_firm
      *
     c     vpdtlu_key    klist
     c                   kfld                    l_firm
      *
     c     vphelu_key    klist
     c                   kfld                    l_firm
      *
     c     vpkolu_key    klist
     c                   kfld                    l_firm
      *
     c     vsdtlu_key    klist
     c                   kfld                    l_firm
      *
     c     vshelu_key    klist
     c                   kfld                    l_firm
      *
     c     vsoklu_key    klist
     c                   kfld                    l_firm
      *
     c     vstrlu_key    klist
     c                   kfld                    l_firm
      *
     c     vtillu_key    klist
     c                   kfld                    l_firm
      *
     c     vugrlu_key    klist
     c                   kfld                    l_firm
      *
     c     vvaqpf_key    klist
     c                   kfld                    l_firm
      *
     c     vvarlu_key    klist
     c                   kfld                    l_firm
      *
     c     vvaslu_key    klist
     c                   kfld                    l_firm
      *
     c     vvenlu_key    klist
     c                   kfld                    l_firm
      *
     c     vveplu_key    klist
     c                   kfld                    l_firm
      *
     c     vvgklu_key    klist
     c                   kfld                    l_firm
      *
     c     vvprlu_key    klist
     c                   kfld                    l_firm
      *
     c     vvsolu_key    klist
     c                   kfld                    l_firm
      *
     c     vvtylu_key    klist
     c                   kfld                    l_firm
      *
     c                   endsr
