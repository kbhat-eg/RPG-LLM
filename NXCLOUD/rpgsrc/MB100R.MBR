     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASLOGI
      * Program . . . . : MB100R
      * Beskrivelse . . : ABC parameter,vedlikehold
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       190804 bø   Nytt program
5.50  *       281107 bø   rettet feil for parameter til kall MB601C
5.51  *       080508 tsv  Lagt inn oppdatering til lager
5.60  *       050808 bof  rettet reade-logikk
5.61  *       070808 bof  små justeringer vedr. oppdateringer ++
5.62  *       080808 bof  låskode for abc-kode på lager
5.63  *       190309 bof  Kaller MM747R for oppd.av abckode på prognose
5.64  *       020409 bof  Rydder i alle abckoder på valgt parameter
      * 6.10  180609 BSA  Oppdatert med sporingsinformasjon
      * 6.10  240909 ASK  Lagt inn valg på oppdatering av lagerfelt
6.11  * 6.10  290110 bof  Rettet test på hvilken abc.kode som oppdat.
6.12  * 6.10  291010 bof  Nullstiller alle felt ved oppretting av ny
6.20  * 6.20  121110 bof  Utvidet med lager på sortiment
6.21  * 6.20  111113 bof  utvidet parameterkall til VC500R
6.22  *       130214 nho  Lagt inn sperre på vedlikehold av % felt
      *                   kan ikke legges inn verdier > 99
6.23  * 6.20  231215 bsa  Utvidet parameterliste til MB401, slik at den
6.23  *                   rydder i riktig ABC kode.
      *              NB!  I 630 vil % felter endres fra 3 til 2 numm
6.nu  *       040614 bof  sjekket mtp. nummerutvidelsen
6.30  * 6.30  230914 bsa  Utvider mulighet for 100 %  (Reversert 6.22)
7.xx  * 7.00  170316 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  Bruk av indikatorer:
      *
      *       LR = Avslutt program
      *       10 = Rollup
      *       11 = Rolldown
      *       12 = Sfldsp
      *       13 = Sfldspctl
      *       14 = Sflclr
      *       15 = Sflend
      *       21 = Home-key
      *       22 = Plassering av cursor
      *       30 = Protect av felter ved vise
      *    31-79 = Varsle m/feilmeldinger/skjermindikatorer
      *    80-99 = Arbeidsindikatorer
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fmabcl1    if   e           k disk    rename(mabcpfr:mabcl1r)
     fmabcl2    if   e           k disk    rename(mabcpfr:mabcl2r)
     fmabclr    if   e           k disk    rename(mabcpfr:mabclrr)
     fmabclu    uf a e           k disk    rename(mabcpfr:mabclur)
     fmabdl2    if   e           k disk    rename(mabdpfr:mabdl2r)
     fmabdlu    uf   e           k disk    rename(mabdpfr:mabdlur)
     fvvarlu    uf   e           k disk    rename(vvarpfr:vvarlur)
     fvogrl1    if   e           k disk    rename(vogrpfr:vogrl1r)
     fvhgrl1    if   e           k disk    rename(vhgrpfr:vhgrl1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvshel1    if   e           k disk    rename(vshepfr:vshel1r)
      *
5.51 fvlaglu    uf   e           k disk    rename(vlagpfr:vlaglur)
      *
     fMB100d    cf   e             workstn sfile(b1sfl:w_srrn)
     f                                     infds(dspfbk)
      *
     d a_lage          s              2  0 DIM(10)
     d a_ltyp          s              1  0 DIM(10)
      *
      * Datastruktur - parameter inn
      *
     d                 ds
     d d_list                       128
     d  d_fvar                        8  0 overlay(d_list)
     d  d_tvar                        8  0 overlay(d_list:9)
     d  d_flag                        2  0 overlay(d_list:17)
     d  d_tlag                        2  0 overlay(d_list:19)
     d  d_fogr                        2  0 overlay(d_list:21)
     d  d_togr                        2  0 overlay(d_list:23)
     d  d_fhgr                        2  0 overlay(d_list:25)
     d  d_thgr                        2  0 overlay(d_list:27)
     d  d_fugr                        3  0 overlay(d_list:29)
     d  d_tugr                        3  0 overlay(d_list:32)
     d  d_levn                        6  0 overlay(d_list:35)
     d  d_selg                        4  0 overlay(d_list:41)
     d  d_faar                        4  0 overlay(d_list:45)
     d  d_fmnd                        2  0 overlay(d_list:49)
     d  d_taar                        4  0 overlay(d_list:51)
     d  d_tmnd                        2  0 overlay(d_list:55)
     d  d_aint                        2  0 overlay(d_list:57)
     d  d_bint                        2  0 overlay(d_list:59)
     d  d_cint                        2  0 overlay(d_list:61)
     d  d_xint                        2  0 overlay(d_list:63)
     d  d_yint                        2  0 overlay(d_list:65)
     d  d_zint                        2  0 overlay(d_list:67)
     d  d_sorb                        1  0 overlay(d_list:69)
     d  d_sorn                        1  0 overlay(d_list:70)
     d  d_sora                        1  0 overlay(d_list:71)
     d  d_oppd                        1  0 overlay(d_list:72)
     d  d_lt01                        1  0 overlay(d_list:73)
     d  d_lt02                        1  0 overlay(d_list:74)
     d  d_lt03                        1  0 overlay(d_list:75)
     d  d_lt04                        1  0 overlay(d_list:76)
     d  d_lt05                        1  0 overlay(d_list:77)
     d  d_lt06                        1  0 overlay(d_list:78)
     d  d_lt07                        1  0 overlay(d_list:79)
     d  d_lt08                        1  0 overlay(d_list:80)
     d  d_lt09                        1  0 overlay(d_list:81)
     d  d_lt10                        1  0 overlay(d_list:82)
     d  d_vtyp                        1    overlay(d_list:83)
     d  d_fvso                       10    overlay(d_list:84)
     d  d_tvso                       10    overlay(d_list:94)
     d  d_lager                      20  0 overlay(d_list:104)
     d  d_lagk                        2    overlay(d_list:124)
     d  d_dumm                        1    overlay(d_list:126)
     d                 ds
     d p_prec                       128
     d  p_fabc                        2    overlay(p_prec)
     d  p_tabc                        2    overlay(p_prec:3)
     d  p_fogr                        2  0 overlay(p_prec:5)
     d  p_togr                        2  0 overlay(p_prec:7)
     d  p_fhgr                        2  0 overlay(p_prec:9)
     d  p_thgr                        2  0 overlay(p_prec:11)
     d  p_fugr                        3  0 overlay(p_prec:13)
     d  p_tugr                        3  0 overlay(p_prec:16)
     d  p_levn                        6  0 overlay(p_prec:19)
     d  p_vsor                       10    overlay(p_prec:25)
     d  p_mbeh                        1  0 overlay(p_prec:35)
     d  p_tell                        1  0 overlay(p_prec:36)
     d  p_lagk                        2    overlay(p_prec:37)
      *
      *
     d                 ds
     d d_fper                         6
     d  d_fpar                        4  0 overlay(d_fper)
     d  d_fpmd                        2  0 overlay(d_fper:5)
     d                 ds
     d d_tper                         6
     d  d_tpar                        4  0 overlay(d_tper)
     d  d_tpmd                        2  0 overlay(d_tper:5)
      *
     d d_lagr          ds
     d  d_la01                        2  0
     d  d_la02                        2  0
     d  d_la03                        2  0
     d  d_la04                        2  0
     d  d_la05                        2  0
     d  d_la06                        2  0
     d  d_la07                        2  0
     d  d_la08                        2  0
     d  d_la09                        2  0
     d  d_la10                        2  0
      *
     d d_ltyp          ds
     d  d_lty1                        1  0
     d  d_lty2                        1  0
     d  d_lty3                        1  0
     d  d_lty4                        1  0
     d  d_lty5                        1  0
     d  d_lty6                        1  0
     d  d_lty7                        1  0
     d  d_lty8                        1  0
     d  d_lty9                        1  0
     d  d_lty0                        1  0
5.64  *
5.64 d                 ds
5.64 d d_lis401                     128
5.64 d  d_vsor                       10    overlay(d_lis401)
5.64 d  d_ogrp                        2  0 overlay(d_lis401:11)
5.64 d  d_hgrp                        2  0 overlay(d_lis401:13)
5.64 d  d_ugrp                        3  0 overlay(d_lis401:15)
5.64 d  d_lage                        2    overlay(d_lis401:18)
6.23 d  d_pabc                        1    overlay(d_lis401:20)
5.64 d  d_dum1                        1    overlay(d_lis401:126)
      *
      * Definering av Local data area
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      * Definering av Information Data Structure - display feedback
      *
     d dspfbk          ds
     d  d_fcrn               378    379I 0
      *
      * Definering av variabler i nøkler
      *
     d mabcl2_vsor     s                   like(mavsor)
     d mabcl1_ogrp     s                   like(maogrp)
     d mabcl1_hgrp     s                   like(mahgrp)
     d mabcl1_ugrp     s                   like(maugrp)
     d mabclr_vsor     s                   like(mavsor)
     d mabclr_ogrp     s                   like(maogrp)
     d mabclr_hgrp     s                   like(mahgrp)
     d mabclr_ugrp     s                   like(maugrp)
     d mabclr_lagk     s                   like(malagk)
     d mabclu_vsor     s                   like(mavsor)
     d mabclu_ogrp     s                   like(maogrp)
     d mabclu_hgrp     s                   like(mahgrp)
     d mabclu_ugrp     s                   like(maugrp)
     d mabclu_lagk     s                   like(malagk)
     d mabdl2_lagk     s                   like(mblagk)
     d mabdl2_vsor     s                   like(mbvsor)
     d mabdl2_ogrp     s                   like(mbogrp)
     d mabdl2_hgrp     s                   like(mbhgrp)
     d mabdl2_ugrp     s                   like(mbugrp)
     d mabdl2_kabc     s                   like(mbkabc)
     d mabdlu_lagk     s                   like(mblagk)
     d mabdlu_vsor     s                   like(mbvsor)
     d mabdlu_ogrp     s                   like(mbogrp)
     d mabdlu_hgrp     s                   like(mbhgrp)
     d mabdlu_ugrp     s                   like(mbugrp)
     d vvarlu_vare     s                   like(vvvare)
     d vvarl1_vare     s                   like(vvvare)
     d vogrl1_oogr     s                   like(vgoogr)
     d vhgrl1_hhgr     s                   like(vghogr)
     d vugrl1_uugr     s                   like(vguugr)
     d vshel1_vsor     s                   like(vcvsor)
6.20 d vshel1_lage     s                   like(vclage)
      *
5.51 d vlaglu_vare     s                   like(vlvare)
5.51 d vlaglu_lage     s                   like(vllage)
      *
5.51 d                 ds
5.51 d vlag_lagc                      2
     d  vlag_lagn                     2  0 overlay(vlag_lagc)
      *
      * Definering av variable
      *
     d w_fcrn          s              4  0
     d w_stel          s              4  0
     d w_spge          s              4  0
     d w_srrn          s              4  0
     d w_sfrn          s                   like(w_srrn)
     d w_ssrn          s                   like(w_srrn)
      *
     d w_seqe          s              1
     d b_oppr          s              1    inz(*off)
     d b_forn          s              1    inz(*off)
     d b_anul          s              1    inz(*off)
     d b_feil          s              1    inz(*off)
      *
     d w_firm          s                   like(mafirm)
     d w_lagk          s                   like(malagk)
     d w_vsor          s                   like(mavsor)
     d w_ogrp          s                   like(maogrp)
     d w_hgrp          s                   like(mahgrp)
     d w_ugrp          s                   like(maugrp)
     d w_kabc          s                   like(mbkabc)
     d w_lagr          s             20
     d ww_lagr         s             20  0
     d w_vsna          s             30
     d w_ogna          s             30
     d w_hgna          s             30
     d w_ugna          s             30
     d w_totax         s             11  0
     d w_totay         s             11  0
     d w_totaz         s             11  0
     d w_totbx         s             11  0
     d w_totby         s             11  0
     d w_totbz         s             11  0
     d w_totcx         s             11  0
     d w_totcy         s             11  0
     d w_totcz         s             11  0
     d w_jkod          s              2  0
     d w_jtxt          s             30
     d w_navn          s             30
     d w_valg          s              2
     d w_stat          s              1
5.64 d w_list          s            128
6.21 d w_lage          s                   like(vclage)
      *
     d s_vsor          s                   like(mavsor)
     d s_ogrp          s                   like(maogrp)
     d s_hgrp          s                   like(mahgrp)
     d s_ugrp          s                   like(maugrp)
     d s_lagk          s                   like(malagk)
      *
      * Definering av konstanter
      *
     d c_sfil          s              2  0 inz(14)
      *
      * Forklaring på spesielle felter
      * som benyttes ved sub-files.
      * - - - - - - - - - - - - - - - - -
      * w_fcrn - Første recordnummer på siden
      * w_stel - Subfile-teller
      * w_spge - Sidestørrelse i subfile (page)
      * w_srrn - Relativt recordnummer i subfile
      * w_sfrn - Første recordnummer på siste side
      * w_ssrn - Siste recordnummer på siste side
      * w_curn - Current recordnummer på siden
      * w_virn - Side og cursorplassering som skal vises
      * w_afld - Aktivt feltnavn
      * w_arow - Aktiv rad for cursor
      * w_acol - Aktiv kolonne for cursor
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      * B1SFL  - B1 Subfile - record
      * B2CTL  - B2 Subfile - control record
      * B2CMD  - B2 Eget skjermbilde for CMD-taster
      * C1BLD  - C1 Skjermbilde for innlegging av nøkkel ved oppretting
      * C1MSG  - C1 Meldingsbilde for C1BLD
      * C2BLD  - C2 Skjermbilde for opprette/endre/vise
      * D1WIN  - D1 Vindu for slette (Delete)
      * K1WIN  - K1 Vindu for kopiere
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B2CTL Behandle åpningsbildet med subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Send Alt
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * Bare data
      *
     c     b2tagb        tag
      *
     c                   exsr      dsp_subfile
      *
      * Behandling av funksjonstaster
      *
     c                   select
     c                   when      *inkc or *inkl
     c                   goto      avslutt
     c                   when      *inkd
     c                   exsr      spØrring
     c                   goto      b2tagb
     c                   when      *inke
     c                   exsr      forny
     c                   goto      b2tagb
     c                   when      *inkf
     c                   exsr      xc1bld
     c                   goto      b2taga
     c                   when      *in10
     c                   exsr      crt_subfile
     c                   goto      b2tagb
     c                   when      *in11
     c                   exsr      bck_subfile
     c                   goto      b2tagb
     c                   when      *in21
     c                   eval      *in22 = *on
     c                   goto      b2taga
     c                   endsl
      *
      * Posisjonering
      *
     c                   if        b2ogrp <> 0 or
     c                             b2vsor <> *blank
     c                   exsr      posisjoner
     c                   goto      b2tagb
     c                   endif
      *
      * Behandling av subfile
      *
     c                   exsr      subfile
      *
     c                   goto      b2taga
      *
      * Avslutt program
      *
     c     avslutt       tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for fornying av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     forny         begsr
      *
     c                   if        w_fcrn <> 0
     c     w_fcrn        chain     b1sfl
     c                   endif
      *
     c                   select
     c                   when      w_seqe = 'B'
     c                   eval      mabcl2_vsor = b1vsor
     c     mabcl2_key    setll     mabcl2
     c                   other
     c                   eval      mabcl1_ogrp = b1ogrp
     c     mabcl1_key    setll     mabcl1
     c                   endsl
      *
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for posisjonering i subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     posisjoner    begsr
      *
      * Overgruppe
      *
     c                   if        b2ogrp <> 0
     c                   eval      w_seqe = *blank
     c                   eval      mabcl1_ogrp = b2ogrp
     c     mabcl1_key    setll     mabcl1
     c                   goto      end_pos
     c                   endif
      *
      * Varesortiment
      *
     c                   if        b2vsor <> *blank
     c                   eval      w_seqe = 'B'
     c                   eval      mabcl2_vsor = b2vsor
     c     mabcl2_key    setll     mabcl2
     c                   goto      end_pos
     c                   endif
      *
     c     end_pos       tag
      *
      * Blanker subfile, og fyller opp i.h.t. posisjonering
      *
     c                   eval      *in22 = *off
      *
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
      * Blanker posisjoneringsfelter
      *
     c                   eval      b2ogrp = 0
     c                   eval      b2vsor = *blank
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     subfile       begsr
      *
     c                   eval      b_forn = *off
      *
     c                   if        *in22 = *off
     c                   eval      *in22 = *on
     c                   else
     c                   eval      *in22 = *off
     c                   endif
      *
     c                   eval      w_virn = w_fcrn
      *
      * Leser og behandler subfile
      *
     c                   do        w_ssrn
     c                   readc     b1sfl
      *
     c                   if        %eof
     c                   leave
     c                   endif
      *
     c                   eval      *in22 = *off
     c                   eval      w_virn = w_srrn
      *
      * Endre
      *
     c                   if        b1valg = 2
     c                   eval      c1vsor = b1vsor
     c                   eval      c1ogrp = b1ogrp
     c                   eval      c1hgrp = b1hgrp
     c                   eval      c1ugrp = b1ugrp
     c                   eval      c1lagk = b1lagk
     c                   exsr      xc2bld
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Kopier
      *
     c                   if        b1valg = 3
     c                   eval      k1vsor = b1vsor
     c                   eval      k1ogrp = b1ogrp
     c                   eval      k1hgrp = b1hgrp
     c                   eval      k1ugrp = b1ugrp
     c                   eval      k1lagk = b1lagk
     c                   exsr      xk1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Slett
      *
     c                   if        b1valg = 4
     c                   eval      d1vsor = b1vsor
     c                   eval      d1ogrp = b1ogrp
     c                   eval      d1hgrp = b1hgrp
     c                   eval      d1ugrp = b1ugrp
     c                   eval      d1lagk = b1lagk
     c                   exsr      xd1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Vis
      *
     c                   if        b1valg = 5
     c                   eval      c1vsor = b1vsor
     c                   eval      c1ogrp = b1ogrp
     c                   eval      c1hgrp = b1hgrp
     c                   eval      c1ugrp = b1ugrp
     c                   eval      c1lagk = b1lagk
     c                   exsr      xc2bld
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Utskrift
      *
     c                   if        b1valg = 6
     c                   eval      p1vsor = b1vsor
     c                   eval      p1ogrp = b1ogrp
     c                   eval      p1hgrp = b1hgrp
     c                   eval      p1ugrp = b1ugrp
     c                   eval      p1lagk = b1lagk
     c                   exsr      xp1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Kjør analyse
      *
     c                   if        b1valg = 7
     c                   eval      e1vsor = b1vsor
     c                   eval      e1ogrp = b1ogrp
     c                   eval      e1hgrp = b1hgrp
     c                   eval      e1ugrp = b1ugrp
     c                   eval      e1lagk = b1lagk
     c                   exsr      xe1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Se på sumnivå
      *
     c                   if        b1valg = 8
     c                   eval      c1vsor = b1vsor
     c                   eval      c1ogrp = b1ogrp
     c                   eval      c1hgrp = b1hgrp
     c                   eval      c1ugrp = b1ugrp
     c                   eval      c1lagk = b1lagk
     c                   exsr      xc3bld
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
      * Oppdater vare
5.51  * Hvis lager IKKE er oppgitt
      *
5.51 c                   if        b1valg = 9 and
5.51 c                             b1lagk = *blank
     c                   eval      f1vsor = b1vsor
     c                   eval      f1ogrp = b1ogrp
     c                   eval      f1hgrp = b1hgrp
     c                   eval      f1ugrp = b1ugrp
     c                   eval      f1lagk = b1lagk
     c                   exsr      xf1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
     c                   endif
      *
5.51  * Oppdater lager
5.51  * Hvis lager er oppgitt
      *
     c                   if        b1valg = 9 and
5.51 c                             b1lagk <> *blank
     c                   eval      g1vsor = b1vsor
     c                   eval      g1ogrp = b1ogrp
     c                   eval      g1hgrp = b1hgrp
     c                   eval      g1ugrp = b1ugrp
     c                   eval      g1lagk = b1lagk
5.51 c                   exsr      xg1win
     c                   eval      b1valg = 0
     c                   update    b1sfl
     c                   iter
5.51 c                   endif
      *
     c                   enddo
      *
     c                   if        b_forn = *on
     c                   exsr      forny
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av skjermbilde for ny rad (C1BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc1bld        begsr
      *
     c                   eval      b_oppr = *on
     c                   eval      b_forn = *off
      *
     c                   eval      c1vsna = *blank
     c                   eval      c1ogna = *blank
     c                   eval      c1hgna = *blank
     c                   eval      c1ugna = *blank
     c                   eval      c1ogrp = b2ogrp
     c                   eval      c1hgrp = 0
     c                   eval      c1ugrp = 0
     c                   eval      c1vsor = *blank
     c                   eval      c1lagk = *blank
      *
     c     c1taga        tag
      *
     c                   exfmt     c1bld
      *
      * Behandling av funksjonstaster
      *
     c                   select
     c                   when      *inkc or *inkl
     c                   goto      end_c1bld
     c                   endsl
      *
      * Spørring
      *
     c                   if        *inkd
     c                   exsr      spØrring
     c                   goto      c1taga
     c                   endif
      *
     c*                  if        c1ogrp = 0 and
     c*                            c1hgrp = 0 and
     c*                            c1ugrp = 0
     c*                  goto      end_c1bld
     c*                  endif
      *
      * Validering
      *
     c***                if        c1ogrp = 0
     c***                eval      *in31  = *on
     c***                goto      c1taga
     c***                endif
      *
     c                   if        c1vsor <> *blank
     c                   eval      vshel1_vsor = c1vsor
6.20 c                   eval      vshel1_lage = 0
     c     vshel1_key    chain     vshel1
     c                   if        not %found(vshel1)
     c                   eval      *in34 = *on
     c                   goto      c1taga
     c                   endif
     c                   eval      c1vsna = vcbesk
     c                   endif
      *
     c                   if        c1ogrp <> 0
     c                   eval      vogrl1_oogr = c1ogrp
     c     vogrl1_key    chain     vogrl1
     c                   if        not %found(vogrl1)
     c                   eval      *in31 = *on
     c                   goto      c1taga
     c                   endif
     c                   eval      c1ogna = vgotxt
     c                   endif
      *
     c                   if        c1hgrp <> 0
     c                   eval      vogrl1_oogr = c1ogrp
     c                   eval      vhgrl1_hhgr = c1hgrp
     c     vhgrl1_key    chain     vhgrl1
     c                   if        not %found(vhgrl1)
     c                   eval      *in32 = *on
     c                   goto      c1taga
     c                   endif
     c                   eval      c1hgna = vghtxt
     c                   endif
      *
     c                   if        c1ugrp <> 0
     c                   eval      vogrl1_oogr = c1ogrp
     c                   eval      vhgrl1_hhgr = c1hgrp
     c                   eval      vugrl1_uugr = c1ugrp
     c     vugrl1_key    chain     vugrl1
     c                   if        not %found(vugrl1)
     c                   eval      *in33 = *on
     c                   goto      c1taga
     c                   endif
     c                   eval      c1ugna = vgutxt
     c                   endif
      *
     c                   if        c1lagk <> *blank
     c                   move      c1lagk        w_jkod
     c                   eval      w_stat = *blank
     c                   call      'RS710R '
     c                   parm                    w_stat
     c                   parm                    w_jkod
     c                   parm                    w_jtxt
      *
     c                   if        w_stat <> *blank
     c                   eval      *in34 = *on
     c                   goto      c1taga
     c                   endif
     c                   endif
      *
      * Sender opp informasjonsbilde dersom rad finnes fra før
      *
     c                   eval      mabclr_vsor = c1vsor
     c                   eval      mabclr_ogrp = c1ogrp
     c                   eval      mabclr_hgrp = c1hgrp
     c                   eval      mabclr_ugrp = c1ugrp
     c                   eval      mabclr_lagk = c1lagk
     c     mabclr_key    chain     mabclr
     c                   if        %found
     c                   exsr      xc1msg
     c                   if        b_anul = *on
     c                   goto      c1taga
     c                   endif
     c                   endif
      *
      * Kaller vedlikeholdsprogram
      *
     c                   exsr      xc2bld
      *
     c                   eval      c1vsor = *blank
     c                   eval      c1ogrp = 0
     c                   eval      c1hgrp = 0
     c                   eval      c1ugrp = 0
     c                   eval      c1lagk = *blank
     c                   eval      c1vsna = *blank
     c                   eval      c1ogna = *blank
     c                   eval      c1hgna = *blank
     c                   eval      c1ugna = *blank
      *
     c                   goto      c1taga
      *
     c     end_c1bld     tag
      *
     c                   eval      b_oppr = *off
     c                   eval      b2ogrp = 0
      *
     c                   if        b_forn = *on
     c                   exsr      forny
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for utlegging av opprettelsesmelding
      * Meldingsbildet legges ut dersom det forsøkes å opprette en rad som
      * finnes fra før.
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc1msg        begsr
      *
     c                   eval      b_anul = *off
      *
     c                   exfmt     c1msg
      *
      * Behandling av funksjonstaster
      *
     c                   if        *inkc or *inkl
     c                   eval      b_anul = *on
     c                   leavesr
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å behandle bilde for ny/endring/vise (C2BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc2bld        begsr
      *
     c                   eval      w_arow = 0
     c                   eval      w_acol = 0
      *
     c                   eval      mabclr_vsor = c1vsor
     c                   eval      mabclr_ogrp = c1ogrp
     c                   eval      mabclr_hgrp = c1hgrp
     c                   eval      mabclr_ugrp = c1ugrp
     c                   eval      mabclr_lagk = c1lagk
     c     mabclr_key    chain     mabclr
      *
     c                   if        %found
     c                   eval      c2text = matext
     c                   eval      c2abap = maabap
     c                   eval      c2abbp = maabbp
     c                   eval      c2abcp = maabcp
     c                   eval      c2xyxp = maxyxp
     c                   eval      c2xyyp = maxyyp
     c                   eval      c2xyzp = maxyzp
     c                   move      mafaar        c2fper
     c                   move      mataar        c2tper
     c                   movel     mafmnd        c2fper
     c                   movel     matmnd        c2tper
     c                   move      malagr        d_lagr
     c                   eval      a_lage(1) = d_la01
     c                   eval      a_lage(2) = d_la02
     c                   eval      a_lage(3) = d_la03
     c                   eval      a_lage(4) = d_la04
     c                   eval      a_lage(5) = d_la05
     c                   eval      a_lage(6) = d_la06
     c                   eval      a_lage(7) = d_la07
     c                   eval      a_lage(8) = d_la08
     c                   eval      a_lage(9) = d_la09
     c                   eval      a_lage(10) = d_la10
     c                   eval      c2lagr = %editw(a_lage(1):' 0') + ' ' +
     c                                      %editw(a_lage(2):' 0') + ' ' +
     c                                      %editw(a_lage(3):' 0') + ' ' +
     c                                      %editw(a_lage(4):' 0') + ' ' +
     c                                      %editw(a_lage(5):' 0') + ' ' +
     c                                      %editw(a_lage(6):' 0') + ' ' +
     c                                      %editw(a_lage(7):' 0') + ' ' +
     c                                      %editw(a_lage(8):' 0') + ' ' +
     c                                      %editw(a_lage(9):' 0') + ' ' +
     c                                      %editw(a_lage(10):' 0')
     c                   move      maltyp        d_ltyp
     c                   eval      a_ltyp(1) = d_lty1
     c                   eval      a_ltyp(2) = d_lty2
     c                   eval      a_ltyp(3) = d_lty3
     c                   eval      a_ltyp(4) = d_lty4
     c                   eval      a_ltyp(5) = d_lty5
     c                   eval      a_ltyp(6) = d_lty6
     c                   eval      a_ltyp(7) = d_lty7
     c                   eval      a_ltyp(8) = d_lty8
     c                   eval      a_ltyp(9) = d_lty9
     c                   eval      a_ltyp(10) = d_lty0
     c                   eval      c2ltyp = %editw(a_ltyp(1):'0') + ' ' +
     c                                      %editw(a_ltyp(2):'0') + ' ' +
     c                                      %editw(a_ltyp(3):'0') + ' ' +
     c                                      %editw(a_ltyp(4):'0') + ' ' +
     c                                      %editw(a_ltyp(5):'0') + ' ' +
     c                                      %editw(a_ltyp(6):'0') + ' ' +
     c                                      %editw(a_ltyp(7):'0') + ' ' +
     c                                      %editw(a_ltyp(8):'0') + ' ' +
     c                                      %editw(a_ltyp(9):'0') + ' ' +
     c                                      %editw(a_ltyp(10):'0')
     c                   eval      c2eusr = mauser
     c     *dmy          move      maodat        c2odat
     c     *dmy          move      maedat        c2edat
     c                   eval      w_vsor = c1vsor
     c                   eval      w_ogrp = c1ogrp
     c                   eval      w_hgrp = c1hgrp
     c                   eval      w_ugrp = c1ugrp
     c                   exsr      hent_txt
     c                   eval      c1vsna = w_vsna
     c                   eval      c1ogna = w_ogna
     c                   eval      c1hgna = w_hgna
     c                   eval      c1ugna = w_ugna
     c                   else
     c                   eval      c2text = *blank
     c                   eval      c2abap = 0
     c                   eval      c2abbp = 0
     c                   eval      c2abcp = 0
     c                   eval      c2xyxp = 0
     c                   eval      c2xyyp = 0
     c                   eval      c2xyzp = 0
6.12 c                   eval      c2fper = 0
6.12 c                   eval      c2tper = 0
6.12 c                   eval      d_lagr = *blank
6.12 c                   eval      a_lage(*) = 0
6.12 c                   eval      c2lagr = *blank
6.12 c                   eval      a_ltyp(*) = 0
6.12 c                   eval      c2ltyp = *blank
6.12 c                   eval      d_ltyp = *blank
6.12 c                   eval      c2eusr = *blank
6.12 c                   eval      c2odat = 0
6.12 c                   eval      c2edat = 0
6.12 c                   eval      c1vsna = *blank
6.12 c                   eval      c1ogna = *blank
6.12 c                   eval      c1hgna = *blank
6.12 c                   eval      c1ugna = *blank
     c                   endif
      *
     c                   if        b1valg = 3
     c                   eval      c1vsor = k1vsor
     c                   eval      c1ogrp = k1ogrp
     c                   eval      c1hgrp = k1hgrp
     c                   eval      c1ugrp = k1ugrp
     c                   eval      c1lagk = k1lagk
     c                   eval      w_vsor = k1vsor
     c                   eval      w_ogrp = k1ogrp
     c                   eval      w_hgrp = k1hgrp
     c                   eval      w_ugrp = k1ugrp
     c                   exsr      hent_txt
     c                   eval      c1vsna = w_vsna
     c                   eval      c1ogna = w_ogna
     c                   eval      c1hgna = w_hgna
     c                   eval      c1ugna = w_ugna
     c                   endif
      *
     c                   if        b1valg = 5
     c                   eval      *in30 = *on
     c                   endif
      *
     c     c2taga        tag
      *
     c                   exfmt     c2bld
      *
     c                   select
     c                   when      *inkc or *inkl or *in30
     c                   goto      end_c2bld
     c                   when      *inkd
     c                   exsr      spØrring
     c                   goto      c2taga
     c                   endsl
      *
      * Validering av input
6.30 c                   if        c2abap > 100
6.30 c*                  eval      c2abap = 0
6.30 c                   eval      *in33 = *on
6.22 c                   goto      c2taga
6.22 c                   endif
      *
6.30 c                   if        c2abbp > 100
6.30 c*                  eval      c2abbp = 0
6.30 c                   eval      *in33 = *on
6.22 c                   goto      c2taga
6.22 c                   endif
      *
6.30 c                   if        c2abcp > 100
6.30 c*                  eval      c2abcp = 0
6.30 c                   eval      *in33 = *on
6.22 c                   goto      c2taga
6.22 c                   endif
      *
     c                   if        c2abap + c2abbp + c2abcp <> 100
     c                   eval      *in31 = *on
     c                   goto      c2taga
     c                   endif
      *
      *
6.30 c                   if        c2xyxp > 100
6.30 c*                  eval      c2xyxp = 0
6.30 c                   eval      *in33 = *on
6.22 c                   goto      c2taga
6.22 c                   endif
      *
6.30 c                   if        c2xyyp > 100
6.30 c*                  eval      c2xyyp = 0
6.30 c                   eval      *in33 = *on
6.22 c                   goto      c2taga
6.22 c                   endif
      *
6.30 c                   if        c2xyzp > 100
6.30 c*                  eval      c2xyzp = 0
6.30 c                   eval      *in33 = *on
6.22 c                   goto      c2taga
6.22 c                   endif
      *
     c                   if        c2xyxp + c2xyyp + c2xyzp <> 100
     c                   eval      *in32 = *on
     c                   goto      c2taga
     c                   endif
      * lager
     c                   if        c2lage <> 0
     c                   eval      w_stat = *blank
     c                   move      c2lage        w_jkod
     c                   call      'RS710R  '
     c                   parm                    w_stat
     c                   parm                    w_jkod
     c                   parm                    w_jtxt
     c                   if        w_stat <> *blank
     c                   eval      *in35 = *on
     c                   goto      c2taga
     c                   endif
     c                   endif
      *
      * periode
      *
     c                   if        c2fper = 0
     c                   eval      *in37 = *on
     c                   goto      c2taga
     c                   endif
      *
     c                   move      c2fper        d_fpar
     c                   movel     c2fper        d_fpmd
     c                   move      c2tper        d_tpar
     c                   movel     c2tper        d_tpmd
      *
     c                   if        d_fpmd < 1 or
     c                             d_fpmd > 13
     c                   eval      *in38 = *on
     c                   goto      c2taga
     c                   endif
      *
     c                   if        d_tpmd < 1 or
     c                             d_tpmd > 13
     c                   eval      *in37 = *on
     c                   goto      c2taga
     c                   endif
      *
     c                   if        c2tper <> 0 and
     c                             d_tpar < d_fpar
     c                   eval      *in37 = *on
     c                   goto      c2taga
     c                   endif
      *
     c                   if        c2tper = 0
     c                   eval      c2tper = c2fper
     c                   endif
      *
      * Oppdatering
      *
     c                   clear                   mabclur
      *
     c                   eval      mabclu_vsor = c1vsor
     c                   eval      mabclu_ogrp = c1ogrp
     c                   eval      mabclu_hgrp = c1hgrp
     c                   eval      mabclu_ugrp = c1ugrp
     c                   eval      mabclu_lagk = c1lagk
     c     mabclu_key    chain     mabclur
      *
     c                   eval      matext = c2text
     c                   eval      maabap = c2abap
     c                   eval      maabbp = c2abbp
     c                   eval      maabcp = c2abcp
     c                   eval      maxyxp = c2xyxp
     c                   eval      maxyyp = c2xyyp
     c                   eval      maxyzp = c2xyzp
     c                   move      c2fper        mafaar
     c                   move      c2tper        mataar
     c                   movel     c2fper        mafmnd
     c                   movel     c2tper        matmnd
     c                   eval      d_la01    =   a_lage(1)
     c                   eval      d_la02    =   a_lage(2)
     c                   eval      d_la03    =   a_lage(3)
     c                   eval      d_la04    =   a_lage(4)
     c                   eval      d_la05    =   a_lage(5)
     c                   eval      d_la06    =   a_lage(6)
     c                   eval      d_la07    =   a_lage(7)
     c                   eval      d_la08    =   a_lage(8)
     c                   eval      d_la09    =   a_lage(9)
     c                   eval      d_la10    =   a_lage(10)
     c                   move      d_lagr        malagr
     c                   eval      d_lty1    =   a_ltyp(1)
     c                   eval      d_lty2    =   a_ltyp(2)
     c                   eval      d_lty3    =   a_ltyp(3)
     c                   eval      d_lty4    =   a_ltyp(4)
     c                   eval      d_lty5    =   a_ltyp(5)
     c                   eval      d_lty6    =   a_ltyp(6)
     c                   eval      d_lty7    =   a_ltyp(7)
     c                   eval      d_lty8    =   a_ltyp(8)
     c                   eval      d_lty9    =   a_ltyp(9)
     c                   eval      d_lty0    =   a_ltyp(10)
     c                   move      d_ltyp        maltyp
      *
     c                   time                    maedat
     c                   time                    maetim
     c                   eval      mauser = l_user
      *
     c                   if        %found
6.10 c                   time                    maedat
6.10 c                   time                    maetim
6.10 c                   eval      maeusr = l_user
     c                   update    mabclur
     c                   else
     c                   eval      mafirm = w_firm
     c                   eval      mavsor = c1vsor
     c                   eval      maogrp = c1ogrp
     c                   eval      mahgrp = c1hgrp
     c                   eval      maugrp = c1ugrp
     c                   eval      malagk = c1lagk
     c                   time                    maodat
6.10 c                   time                    maotim
6.10 c                   eval      mauser = l_user
6.10 c                   time                    maedat
6.10 c                   time                    maetim
6.10 c                   eval      maeusr = l_user
     c                   write     mabclur
     c                   endif
      *
      * Oppdater subfile
      *
     c                   if        b1valg = 2
     c                   eval      b1text = matext
     c                   eval      b1abap = maabap
     c                   eval      b1abbp = maabbp
     c                   eval      b1abcp = maabcp
     c                   eval      b1xyxp = maxyxp
     c                   eval      b1xyyp = maxyyp
     c                   eval      b1xyzp = maxyzp
     c                   endif
      *
     c                   if        b_oppr = *on or
     c                             b1valg = 3
     c                   eval      b_forn = *on
     c                   endif
      *
     c     end_c2bld     tag
      *
     c                   eval      *in30  = *off
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å behandle bilde for ny/endring/vise (C2BLD)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xc3bld        begsr
      *
     c     c3tag0        tag
     c                   eval      w_arow = 0
     c                   eval      w_acol = 0
      *
     c                   eval      *in50 = *on
     c                   eval      mabclr_vsor = c1vsor
     c                   eval      mabclr_ogrp = c1ogrp
     c                   eval      mabclr_hgrp = c1hgrp
     c                   eval      mabclr_ugrp = c1ugrp
     c                   eval      mabclr_lagk = c1lagk
     c     mabclr_key    chain     mabclr
      *
     c                   if        %found
     c                   eval      c3abap = maabap
     c                   eval      c3abbp = maabbp
     c                   eval      c3abcp = maabcp
     c                   eval      c3xyxp = maxyxp
     c                   eval      c3xyyp = maxyyp
     c                   eval      c3xyzp = maxyzp
     c                   eval      c3anax = maanax
     c                   eval      c3anay = maanay
     c                   eval      c3anaz = maanaz
     c                   eval      c3anbx = maanbx
     c                   eval      c3anby = maanby
     c                   eval      c3anbz = maanbz
     c                   eval      c3ancx = maancx
     c                   eval      c3ancy = maancy
     c                   eval      c3ancz = maancz
     c                   eval      c3eusr = mauser
     c     *dmy          move      maodat        c2odat
     c     *dmy          move      maedat        c2edat
     c                   endif
     c                   eval      w_vsor = c1vsor
     c                   eval      w_ogrp = c1ogrp
     c                   eval      w_hgrp = c1hgrp
     c                   eval      w_ugrp = c1ugrp
     c                   exsr      hent_txt
     c                   eval      c1ogna = w_ogna
     c                   eval      c1hgna = w_hgna
     c                   eval      c1ugna = w_ugna
      *
     c     c3taga        tag
      *
     c                   exfmt     c3bld
      *
     c                   select
     c                   when      *inkc or *inkl or *in30
     c                   goto      end_c3bld
     c                   when      *inkd
     c                   exsr      spØrring
     c                   goto      c3tag0
     c                   when      *inkg or *inkh or *inki
     c                   exsr      velg_pgm
     c                   goto      c3taga
     c                   endsl
      * hvis f4-feltet er utfylt med noe så tolkes det slik at man ønsker
      * å se på dette
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
      *
     c                   if        c3axf4 <> *blank
     c                   eval      w_kabc      = 'AX'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3axf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3ayf4 <> *blank
     c                   eval      w_kabc      = 'AY'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3ayf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3azf4 <> *blank
     c                   eval      w_kabc      = 'AZ'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   eval      c3azf4 = *blank
     c                   exsr      upd_sum
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3bxf4 <> *blank
     c                   eval      w_kabc      = 'BX'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3bxf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3byf4 <> *blank
     c                   eval      w_kabc      = 'BY'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3byf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3bzf4 <> *blank
     c                   eval      w_kabc      = 'BZ'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3bzf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3cxf4 <> *blank
     c                   eval      w_kabc      = 'CX'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3cxf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3cyf4 <> *blank
     c                   eval      w_kabc      = 'CY'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3cyf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c                   if        c3czf4 <> *blank
     c                   eval      w_kabc      = 'CZ'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   eval      c3czf4 = *blank
     c                   goto      c3tag0
     c                   endif
      *
     c     end_c3bld     tag
      *
     c                   eval      *in30  = *off
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for behandling av slette-bildet (D1WIN)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xd1win        begsr
      *
     c                   eval      mabclr_vsor = d1vsor
     c                   eval      mabclr_ogrp = d1ogrp
     c                   eval      mabclr_hgrp = d1hgrp
     c                   eval      mabclr_ugrp = d1ugrp
     c                   eval      mabclr_lagk = d1lagk
     c     mabclr_key    chain     mabclr
      *
     c                   exfmt     d1win
      *
     c                   if        *inkc or *inkl
     c                   leavesr
     c                   endif
      *
     c                   eval      b_forn = *on
      *
      * Sletter rad
      *
     c                   eval      mabclu_vsor = d1vsor
     c                   eval      mabclu_ogrp = d1ogrp
     c                   eval      mabclu_hgrp = d1hgrp
     c                   eval      mabclu_ugrp = d1ugrp
     c                   eval      mabclu_lagk = d1lagk
     c     mabclu_key    chain     mabclur
      *
     c                   delete    mabclur
      *
      * sletter detaljer
      *
     c                   eval      mabdlu_lagk = d1lagk
     c                   eval      mabdlu_vsor = d1vsor
     c                   eval      mabdlu_ogrp = d1ogrp
     c                   eval      mabdlu_hgrp = d1hgrp
     c                   eval      mabdlu_ugrp = d1ugrp
readec     mabdlu_key    setll     mabdlu
5.60 c     mabdlu_key    reade     mabdlu
5.60 c                   dow       not %eof(mabdlu)
     c                   delete    mabdlur
5.60 c     mabdlu_key    reade     mabdlu
readec                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å kjøre analyse (D1WIN)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xe1win        begsr
      *
     c                   eval      e1vtyp = 'L'
      *
     c                   eval      mabclr_vsor = e1vsor
     c                   eval      mabclr_ogrp = e1ogrp
     c                   eval      mabclr_hgrp = e1hgrp
     c                   eval      mabclr_ugrp = e1ugrp
     c                   eval      mabclr_lagk = e1lagk
     c     mabclr_key    chain     mabclr
     c                   eval      w_vsor = e1vsor
     c                   eval      w_ogrp = e1ogrp
     c                   eval      w_hgrp = e1hgrp
     c                   eval      w_ugrp = e1ugrp
     c                   exsr      hent_txt
     c                   eval      e1vsna = w_vsna
     c                   eval      e1ogna = w_ogna
     c                   eval      e1hgna = w_hgna
     c                   eval      e1ugna = w_ugna
     c                   move      mafaar        e1fper
     c                   move      mataar        e1tper
     c                   movel     mafmnd        e1fper
     c                   movel     matmnd        e1tper
     c                   move      malagr        d_lagr
     c                   eval      a_lage(1) = d_la01
     c                   eval      a_lage(2) = d_la02
     c                   eval      a_lage(3) = d_la03
     c                   eval      a_lage(4) = d_la04
     c                   eval      a_lage(5) = d_la05
     c                   eval      a_lage(6) = d_la06
     c                   eval      a_lage(7) = d_la07
     c                   eval      a_lage(8) = d_la08
     c                   eval      a_lage(9) = d_la09
     c                   eval      a_lage(10) = d_la10
     c                   eval      e1lagr = %editw(a_lage(1):' 0') + ' ' +
     c                                      %editw(a_lage(2):' 0') + ' ' +
     c                                      %editw(a_lage(3):' 0') + ' ' +
     c                                      %editw(a_lage(4):' 0') + ' ' +
     c                                      %editw(a_lage(5):' 0') + ' ' +
     c                                      %editw(a_lage(6):' 0') + ' ' +
     c                                      %editw(a_lage(7):' 0') + ' ' +
     c                                      %editw(a_lage(8):' 0') + ' ' +
     c                                      %editw(a_lage(9):' 0') + ' ' +
     c                                      %editw(a_lage(10):' 0') + ' '
     c                   move      maltyp        d_ltyp
     c                   eval      a_ltyp(1) = d_lty1
     c                   eval      a_ltyp(2) = d_lty2
     c                   eval      a_ltyp(3) = d_lty3
     c                   eval      a_ltyp(4) = d_lty4
     c                   eval      a_ltyp(5) = d_lty5
     c                   eval      a_ltyp(6) = d_lty6
     c                   eval      a_ltyp(7) = d_lty7
     c                   eval      a_ltyp(8) = d_lty8
     c                   eval      a_ltyp(9) = d_lty9
     c                   eval      a_ltyp(10) = d_lty0
     c                   eval      e1ltyp = %editw(a_ltyp(1):' ') + ' ' +
     c                                      %editw(a_ltyp(2):'0') + ' ' +
     c                                      %editw(a_ltyp(3):'0') + ' ' +
     c                                      %editw(a_ltyp(4):'0') + ' ' +
     c                                      %editw(a_ltyp(5):'0') + ' ' +
     c                                      %editw(a_ltyp(6):'0') + ' ' +
     c                                      %editw(a_ltyp(7):'0') + ' ' +
     c                                      %editw(a_ltyp(8):'0') + ' ' +
     c                                      %editw(a_ltyp(9):'0') + ' ' +
     c                                      %editw(a_ltyp(10):'0') + ' '
      *
     c     e1taga        tag
     c                   exfmt     e1win
      *
     c                   if        *inkc or *inkl
     c                   leavesr
     c                   endif
     c                   if        *inkd
     c                   exsr      spØrring
     c                   goto      e1taga
     c                   endif
      * periode
     c                   if        e1fper = 0
     c                   eval      *in31 = *on
     c                   goto      e1taga
     c                   endif
      *
     c                   move      e1fper        d_fpar
     c                   movel     e1fper        d_fpmd
     c                   move      e1tper        d_tpar
     c                   movel     e1tper        d_tpmd
      *
     c                   if        d_fpmd < 1 or
     c                             d_fpmd > 13
     c                   eval      *in32 = *on
     c                   goto      e1taga
     c                   endif
      *
     c                   if        d_tpmd < 1 or
     c                             d_tpmd > 13
     c                   eval      *in33 = *on
     c                   goto      e1taga
     c                   endif
      *
     c                   if        e1tper <> 0 and
     c                             d_tpar < d_fpar
     c                   eval      *in31 = *on
     c                   goto      e1taga
     c                   endif
      *
     c                   if        e1vtyp <> *blank and
     c                             e1vtyp <> 'L'    and
     c                             e1vtyp <> 'S'
     c                   eval      *in34 = *on
     c                   goto      e1taga
     c                   endif
      *
     c                   if        e1tper = 0
     c                   eval      e1tper = e1fper
     c                   endif
      *
     c                   eval      b_forn = *on
      *
      * sletter tidligere analyse  - detaljer
      *
     c                   eval      mabdlu_lagk = e1lagk
     c                   eval      mabdlu_vsor = e1vsor
     c                   eval      mabdlu_ogrp = e1ogrp
     c                   eval      mabdlu_hgrp = e1hgrp
     c                   eval      mabdlu_ugrp = e1ugrp
readec     mabdlu_key    setll     mabdlu
5.60 c     mabdlu_key    reade     mabdlu
5.60 c                   dow       not %eof(mabdlu)
     c                   delete    mabdlur
5.60 c     mabdlu_key    reade     mabdlu
readec                   enddo
      *
      *
      * Kjører analyse
      *
     c                   if        e1lagr = *blank
     c                   eval      d_flag = 0
     c                   eval      d_tlag = 99
     c                   eval      d_lager = 0
     c                   else
     c                   eval      d_flag = 0
     c                   eval      d_tlag = 0
     c                   eval      d_lager = malagr
     c                   endif
     c                   eval      d_fvso = e1vsor
     c                   eval      d_fogr = e1ogrp
     c                   eval      d_fhgr = e1hgrp
     c                   eval      d_fugr = e1ugrp
     c                   eval      d_lagk = e1lagk
     c                   eval      d_dumm = '9'
     c                   eval      d_levn = 0
     c                   eval      d_selg = 0
     c                   eval      d_faar = d_fpar
     c                   eval      d_fmnd = d_fpmd
     c                   eval      d_taar = d_tpar
     c                   eval      d_tmnd = d_tpmd
     c                   eval      d_aint = b1abap
     c                   eval      d_bint = b1abbp
     c                   eval      d_cint = b1abcp
     c                   eval      d_xint = b1xyxp
     c                   eval      d_yint = b1xyyp
     c                   eval      d_zint = b1xyzp
     c                   eval      d_sorb = 0
     c                   eval      d_sorn = 0
     c                   eval      d_sora = 0
     c                   eval      d_oppd = 0
     c                   eval      d_lt01 = a_ltyp(1)
     c                   eval      d_lt02 = a_ltyp(2)
     c                   eval      d_lt03 = a_ltyp(3)
     c                   eval      d_lt04 = a_ltyp(4)
     c                   eval      d_lt05 = a_ltyp(5)
     c                   eval      d_lt06 = a_ltyp(6)
     c                   eval      d_lt07 = a_ltyp(7)
     c                   eval      d_lt08 = a_ltyp(8)
     c                   eval      d_lt09 = a_ltyp(9)
     c                   eval      d_lt10 = a_ltyp(10)
     c                   eval      d_vtyp = e1vtyp
      *
     c                   call      'MB700C'
     c                   parm                    d_list
      *
     c                   eval      w_lagk = e1lagk
     c                   eval      w_vsor = e1vsor
     c                   eval      w_ogrp = e1ogrp
     c                   eval      w_hgrp = e1hgrp
     c                   eval      w_ugrp = e1ugrp
     c                   exsr      upd_sum
      *
     c                   eval      mabclu_vsor = e1vsor
     c                   eval      mabclu_ogrp = e1ogrp
     c                   eval      mabclu_hgrp = e1hgrp
     c                   eval      mabclu_ugrp = e1ugrp
     c                   eval      mabclu_lagk = e1lagk
     c     mabclu_key    chain     mabclu
     c                   if        %found(mabclu)
date c                   move      *date         makdat
     c                   move      e1fper        mafaar
     c                   move      e1tper        mataar
     c                   movel     e1fper        mafmnd
     c                   movel     e1tper        matmnd
6.10 c                   time                    maedat
6.10 c                   time                    maetim
6.10 c                   eval      maeusr = l_user
     c                   update    mabclur
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å oppdatere varer med abc-koden
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xf1win        begsr
      *
     c                   eval      mabclr_vsor = f1vsor
     c                   eval      mabclr_ogrp = f1ogrp
     c                   eval      mabclr_hgrp = f1hgrp
     c                   eval      mabclr_ugrp = f1ugrp
     c                   eval      mabclr_lagk = f1lagk
     c     mabclr_key    chain     mabclr
      *
     c*                  eval      f1lage = malagr
     c                   eval      w_vsor = f1vsor
     c                   eval      w_ogrp = f1ogrp
     c                   eval      w_hgrp = f1hgrp
     c                   eval      w_ugrp = f1ugrp
     c                   exsr      hent_txt
     c                   eval      f1vsna = w_vsna
     c                   eval      f1ogna = w_ogna
     c                   eval      f1hgna = w_hgna
     c                   eval      f1ugna = w_ugna
     c                   eval      f1lagk = malagk
5.61 c*                  if        f1lagk <> *blank
5.61 c*                  eval      *in51 = *on
5.61 c*                  else
5.61 c*                  eval      *in51 = *off
5.61 c*                  endif
     c
     c     f1taga        tag
     c                   exfmt     f1win
      *
     c                   if        *inkc or *inkl
     c                   leavesr
     c                   endif
5.64  *
5.64  * kaller ryddeprogam
5.64  *
5.64 c                   eval      w_list = *blank
5.64 c                   eval      d_vsor = f1vsor
5.64 c                   eval      d_ogrp = f1ogrp
5.64 c                   eval      d_hgrp = f1hgrp
5.64 c                   eval      d_ugrp = f1ugrp
5.64 c                   eval      d_lage = f1lagk
6.23 c                   eval      d_pabc = *blanks
5.64 c                   eval      d_dum1 = '*'
5.64 c                   eval      w_list = d_lis401
5.64 c                   call      'MB401R'
5.64 c                   parm                    w_list
      *
     c                   eval      b_forn = *on
      *
      * Oppdater vare
      *
     c                   eval      mabdl2_lagk = f1lagk
     c                   eval      mabdl2_vsor = f1vsor
     c                   eval      mabdl2_ogrp = f1ogrp
     c                   eval      mabdl2_hgrp = f1hgrp
     c                   eval      mabdl2_ugrp = f1ugrp
readec     mabdl2_key    setll     mabdl2
readec     mabdl2_key    reade     mabdl2
5.60 c                   dow       not %eof(mabdl2)
      *
     c                   eval      vvarlu_vare = mbvare
     c     vvarlu_key    chain     vvarlu
     c                   if        %found(vvarlu) and
     c                             vvlabc = 0
     c                   eval      vvkabc = mbkabc
6.10 c                   time                    vvedat
6.10 c                   time                    vvetim
6.10 c                   eval      vveusr = l_user
     c                   update    vvarlur
     c                   endif
5.60 c     mabdl2_key    reade     mabdl2
readec                   enddo
      *
     c                   eval      mabclu_vsor = f1vsor
     c                   eval      mabclu_ogrp = f1ogrp
     c                   eval      mabclu_hgrp = f1hgrp
     c                   eval      mabclu_ugrp = f1ugrp
     c                   eval      mabclu_lagk = f1lagk
     c     mabclu_key    chain     mabclu
     c                   if        %found(mabclu)
date c                   move      *date         mavdat
6.10 c                   time                    maedat
6.10 c                   time                    maetim
6.10 c                   eval      maeusr = l_user
     c                   update    mabclur
     c                   endif
      *
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.51  * Subrutine for å oppdatere lager med abc-koden
 .    * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xg1win        begsr
      *
     c                   eval      mabclr_vsor = g1vsor
     c                   eval      mabclr_ogrp = g1ogrp
     c                   eval      mabclr_hgrp = g1hgrp
     c                   eval      mabclr_ugrp = g1ugrp
     c                   eval      mabclr_lagk = g1lagk
     c     mabclr_key    chain     mabclr
      *
     c                   eval      w_vsor = g1vsor
     c                   eval      w_ogrp = g1ogrp
     c                   eval      w_hgrp = g1hgrp
     c                   eval      w_ugrp = g1ugrp
     c                   exsr      hent_txt
     c                   eval      g1vsna = w_vsna
     c                   eval      g1ogna = w_ogna
     c                   eval      g1hgna = w_hgna
     c                   eval      g1ugna = w_ugna
     c                   eval      g1lagk = malagk
5.61 c                   if        g1lagk <> *blank
5.61 c                   eval      *in51 = *on
5.61 c                   else
5.61 c                   eval      *in51 = *off
5.61 c                   endif
     c
     c     g1taga        tag
     c                   exfmt     g1win
      *
     c                   if        *inkc or *inkl
     c                   leavesr
     c                   endif
      *
      * Sjekk om gyldig valg
      *
     c                   if        g1opko <> 'P' and
     c                             g1opko <> 'S'
     c                   eval      *in31 = *on
     c                   goto      g1taga
     c                   endif
5.64  *
5.64  * kaller ryddeprogam
5.64 c                   eval      w_list = *blank
5.64 c                   eval      d_vsor = g1vsor
5.64 c                   eval      d_ogrp = g1ogrp
5.64 c                   eval      d_hgrp = g1hgrp
5.64 c                   eval      d_ugrp = g1ugrp
5.64 c                   eval      d_lage = g1lagk
6.23 c                   eval      d_pabc = g1opko
5.64 c                   eval      d_dum1 = '*'
5.64 c                   eval      w_list = d_lis401
5.64 c                   call      'MB401R'
5.64 c                   parm                    w_list
      *
     c                   eval      b_forn = *on
      *
      * Oppdater lager
      *
     c                   eval      mabdl2_lagk = g1lagk
     c                   eval      mabdl2_vsor = g1vsor
     c                   eval      mabdl2_ogrp = g1ogrp
     c                   eval      mabdl2_hgrp = g1hgrp
     c                   eval      mabdl2_ugrp = g1ugrp
readec     mabdl2_key    setll     mabdl2
5.60 c     mabdl2_key    reade     mabdl2
5.60 c                   dow       not %eof(mabdl2)
      *
     c                   eval      vlaglu_vare = mbvare
5.51  * + key lager - gjør numerisk lager
5.51 c                   eval      vlag_lagc = g1lagk
5.51 c                   eval      vlaglu_lage = vlag_lagn
     c     vlaglu_key    chain     vlaglu
5.62 c                   if        %found(vlaglu) and
5.62 c                             vllabc = 0
6.11 c                   if        g1opko =  'P'
     c                   eval      vlkabc = mbkabc
6.10 c                   else
6.10 c                   eval      vltabc = mbkabc
6.10 c                   endif
6.10 c                   time                    vledat
6.10 c                   time                    vletim
6.10 c                   eval      vleusr = l_user
     c                   update    vlaglur
5.63 c                   exsr      upd_prog_abc
     c                   endif
5.60 c     mabdl2_key    reade     mabdl2
readec                   enddo
      *
     c                   eval      mabclu_vsor = g1vsor
     c                   eval      mabclu_ogrp = g1ogrp
     c                   eval      mabclu_hgrp = g1hgrp
     c                   eval      mabclu_ugrp = g1ugrp
     c                   eval      mabclu_lagk = g1lagk
     c     mabclu_key    chain     mabclu
     c                   if        %found(mabclu)
date c                   move      *date         mavdat
6.10 c                   time                    maedat
6.10 c                   time                    maetim
6.10 c                   eval      maeusr = l_user
     c                   update    mabclur
     c                   endif
 .    *
5.51 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å utskrift av abc.analyse
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xp1win        begsr
      *
     c                   eval      w_vsor = p1vsor
     c                   eval      w_ogrp = p1ogrp
     c                   eval      w_hgrp = p1hgrp
     c                   eval      w_ugrp = p1ugrp
     c                   exsr      hent_txt
     c                   eval      p1vsna = w_vsna
     c                   eval      p1ogna = w_ogna
     c                   eval      p1hgna = w_hgna
     c                   eval      p1ugna = w_ugna
      *
     c                   exfmt     p1win
      *
     c                   if        *inkc or *inkl
     c                   leavesr
     c                   endif
      *
     c                   eval      b_forn = *on
      *
      * Utskrift
      *
     c                   eval      p_fabc = 'AX'
     c                   eval      p_tabc = 'CZ'
     c                   eval      p_vsor = p1vsor
     c                   eval      p_fogr = p1ogrp
     c                   eval      p_fhgr = p1hgrp
     c                   eval      p_fugr = p1ugrp
     c                   eval      p_togr = p1ogrp
     c                   eval      p_thgr = p1hgrp
     c                   eval      p_tugr = p1ugrp
     c                   eval      p_lagk = p1lagk
     c                   eval      p_levn = 0
     c                   eval      p_mbeh = 0
     c                   eval      p_tell = 0
      *
     c                   call      'MB601C'
     c                   parm                    p_prec
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å behandle kopierings-bildet (K1WIN)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     xk1win        begsr
      *
      * Tar vare på nøkkel til rad det skal kopieres fra
      *
     c                   eval      s_vsor = k1vsor
     c                   eval      s_ogrp = k1ogrp
     c                   eval      s_hgrp = k1hgrp
     c                   eval      s_ugrp = k1ugrp
     c                   eval      s_lagk = k1lagk
      *
      * Fyller kopierings-bildet
      *
     c                   eval      mabclr_vsor = k1vsor
     c                   eval      mabclr_ogrp = k1ogrp
     c                   eval      mabclr_hgrp = k1hgrp
     c                   eval      mabclr_ugrp = k1ugrp
     c                   eval      mabclr_lagk = k1lagk
     c     mabclr_key    chain     mabclr
      *
     c     k1taga        tag
      *
     c                   exfmt     k1win
      *
     c                   if        *inkc or *inkl
     c                   leavesr
     c                   endif
     c                   if        *inkd
     c                   exsr      spØrring
     c                   goto      k1taga
     c                   endif
      *
      * Sjekker om rad finnes fra før
      *
     c                   eval      mabclr_vsor = k1vsor
     c                   eval      mabclr_ogrp = k1ogrp
     c                   eval      mabclr_hgrp = k1hgrp
     c                   eval      mabclr_ugrp = k1ugrp
     c                   eval      mabclr_lagk = k1lagk
     c     mabclr_key    chain     mabclr
     c                   if        %found
     c                   eval      *in32 = *on
     c                   goto      k1taga
     c                   endif
      *
      * Kaller vedlikeholdsprogram
      *
     c                   eval      c1vsor = s_vsor
     c                   eval      c1ogrp = s_ogrp
     c                   eval      c1hgrp = s_hgrp
     c                   eval      c1ugrp = s_ugrp
     c                   eval      c1lagk = s_lagk
     c                   exsr      xc2bld
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for tømming av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     clr_subfile   begsr
      *
     c                   eval      *in14 = *on
     c                   write     b2ctl
     c                   eval      *in14 = *off
      *
     c                   eval      *in15 = *off
     c                   eval      w_srrn = 0
     c                   eval      w_sfrn = 0
     c                   eval      w_ssrn = 0
     c                   eval      w_spge = 0
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å fylle opp subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     crt_subfile   begsr
      *
     c                   eval      w_spge = w_spge + c_sfil
     c                   eval      w_srrn = w_ssrn
      *
     c                   dou       w_srrn = w_spge
      *
     c                   select
     c                   when      w_seqe = 'B'
     c                   read      mabcl2
     c                   other
     c                   read      mabcl1
     c                   endsl
      *
     c                   if        %eof or
     c                             mafirm <> w_firm
     c                   eval      *in15 = *on
     c                   leave
     c                   endif
      *
     c                   eval      w_srrn = w_srrn + 1
      *
     c                   select
     c                   when      w_seqe = 'B'
     c                   eval      mabcl2_vsor = mavsor
     c                   other
     c                   eval      mabcl1_ogrp = maogrp
     c                   endsl
      *
     c                   eval      b1valg = 0
     c                   movel     matext        b1text
      *
     c                   if        mavdat <> *loval
     c     *dmy          move      mavdat        b1vdat
     c                   else
     c                   eval      b1vdat = 0
     c                   endif
     c                   eval      b1vsor = mavsor
     c                   eval      b1ogrp = maogrp
     c                   eval      b1hgrp = mahgrp
     c                   eval      b1ugrp = maugrp
     c                   eval      b1abap = maabap
     c                   eval      b1abbp = maabbp
     c                   eval      b1abcp = maabcp
     c                   eval      b1xyxp = maxyxp
     c                   eval      b1xyyp = maxyyp
     c                   eval      b1xyzp = maxyzp
     c                   eval      b1lagk = malagk
      *
     c                   write     b1sfl
      *
     c                   enddo
      *
     c                   if        w_srrn > w_ssrn
     c                   eval      w_sfrn = w_ssrn + 1
     c                   endif
      *
     c                   eval      w_ssrn = w_srrn
     c                   eval      w_virn = w_sfrn
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å bla tilbake en side i subfilen
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     bck_subfile   begsr
      *
     c                   if        *in15
     c                   select
     c                   when      w_seqe = 'B'
     c     mabcl2_key    setgt     mabcl2
     c                   readp     mabcl2
     c                   other
     c     mabcl1_key    setgt     mabcl1
     c                   readp     mabcl1
     c                   endsl
     c                   endif
      *
      * Leser tilbake en side
      *
     c                   eval      w_stel = 0
      *
     c                   dou       w_stel = w_ssrn + c_sfil
      *
     c                   select
     c                   when      w_seqe = 'B'
     c                   readp     mabcl2
     c                   other
     c                   readp     mabcl1
     c                   endsl
      *
     c                   if        %eof or
     c                             mafirm <> w_firm
     c                   leave
     c                   endif
      *
     c                   eval      w_stel = w_stel + 1
      *
     c                   select
     c                   when      w_seqe = 'B'
     c                   eval      mabcl2_vsor = mavsor
     c                   other
     c                   eval      mabcl1_ogrp = maogrp
     c                   endsl
      *
     c                   enddo
      *
     c                   if        %eof
     c                   select
     c                   when      w_seqe = 'B'
     c     mabcl2_key    setll     mabcl2
     c                   other
     c     mabcl1_key    setll     mabcl1
     c                   endsl
     c                   endif
      *
      * Blanker og fyller opp subfile
      *
     c                   exsr      clr_subfile
     c                   exsr      crt_subfile
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for display av subfile
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     dsp_subfile   begsr
      *
     c                   if        w_srrn <> 0
     c                   eval      *in12 = *on
     c                   else
     c                   write     b2cmd
     c                   endif
      *
     c                   eval      *in13 = *on
     c                   exfmt     b2ctl
      *
     c                   eval      *in12 = *off
     c                   eval      *in13 = *off
      *
     c                   eval      w_fcrn = d_fcrn
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Oppdaterer antall abc / xyz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     upd_sum       begsr
      *
     c                   eval      w_totax  =  0
     c                   eval      w_totay  =  0
     c                   eval      w_totaz  =  0
     c                   eval      w_totbx  =  0
     c                   eval      w_totby  =  0
     c                   eval      w_totbz  =  0
     c                   eval      w_totcx  =  0
     c                   eval      w_totcy  =  0
     c                   eval      w_totcz  =  0
     *
     c                   eval      mabdl2_lagk = w_lagk
     c                   eval      mabdl2_vsor = w_vsor
     c                   eval      mabdl2_ogrp = w_ogrp
     c                   eval      mabdl2_hgrp = w_hgrp
     c                   eval      mabdl2_ugrp = w_ugrp
readec     mabdl2_key    setll     mabdl2
5.60 c     mabdl2_key    reade     mabdl2
5.60 c                   dow       not %eof(mabdl2)
     c                   if        mbkabc = 'AX'
     c                   eval      w_totax = w_totax + 1
     c                   endif
     c                   if        mbkabc = 'AY'
     c                   eval      w_totay = w_totay + 1
     c                   endif
     c                   if        mbkabc = 'AZ'
     c                   eval      w_totaz = w_totaz + 1
     c                   endif
     c                   if        mbkabc = 'BX'
     c                   eval      w_totbx = w_totbx + 1
     c                   endif
     c                   if        mbkabc = 'BY'
     c                   eval      w_totby = w_totby + 1
     c                   endif
     c                   if        mbkabc = 'BZ'
     c                   eval      w_totbz = w_totbz + 1
     c                   endif
     c                   if        mbkabc = 'CX'
     c                   eval      w_totcx = w_totcx + 1
     c                   endif
     c                   if        mbkabc = 'CY'
     c                   eval      w_totcy = w_totcy + 1
     c                   endif
     c                   if        mbkabc = 'CZ'
     c                   eval      w_totcz = w_totcz + 1
     c                   endif
5.60 c     mabdl2_key    reade     mabdl2
readec                   enddo
      *
     c                   eval      mabclu_lagk = w_lagk
     c                   eval      mabclu_vsor = w_vsor
     c                   eval      mabclu_ogrp = w_ogrp
     c                   eval      mabclu_hgrp = w_hgrp
     c                   eval      mabclu_ugrp = w_ugrp
     c     mabclu_key    chain     mabclu
     c                   if        %found(mabclu)
     c                   eval      maanax = w_totax
     c                   eval      maanay = w_totay
     c                   eval      maanaz = w_totaz
     c                   eval      maanbx = w_totbx
     c                   eval      maanby = w_totby
     c                   eval      maanbz = w_totbz
     c                   eval      maancx = w_totcx
     c                   eval      maancy = w_totcy
     c                   eval      maancz = w_totcz
6.10 c                   time                    maedat
6.10 c                   time                    maetim
6.10 c                   eval      maeusr = l_user
     c                   update    mabclur
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Spørring
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     spØrring      begsr
      *
      * spørring på detaljer
     c                   if        w_afld = 'C3AXF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'AX'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3AYF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'AY'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3AZF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'AZ'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3BXF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'BX'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3BYF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'BY'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3BZF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'BZ'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3CXF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'CX'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3CYF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'CY'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      * spørring på detaljer
     c                   if        w_afld = 'C3CZF4'
     c                   eval      w_lagk      = c1lagk
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_kabc      = 'CZ'
4.86 c                   CALL      'MB101R  '
     c                   PARM                    w_lagk
     c                   PARM                    w_vsor
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_kabc
     c                   exsr      upd_sum
     c                   goto      end_spØrr
     c                   endif
      *
      * varesortiment
     c                   if        w_afld = 'C1VSOR'
     c                   eval      w_firm      = l_firm
     c                   eval      w_vsor      = c1vsor
     c                   eval      w_navn      = *blank
6.21 c                   eval      w_lage      = 0
4.86 c                   CALL      'VC500R  '
     c                   PARM                    w_firm
     c                   PARM                    w_vsor
6.21 c                   PARM                    w_lage
     c                   PARM                    w_navn
     c                   eval      c1vsor      = w_vsor
     c                   goto      end_spØrr
     c                   endif
      *
      * varesortiment
     c                   if        w_afld = 'K1VSOR'
     c                   eval      w_firm      = l_firm
     c                   eval      w_vsor      = k1vsor
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VC500R  '
     c                   PARM                    w_firm
     c                   PARM                    w_vsor
     c                   PARM                    w_navn
     c                   eval      k1vsor      = w_vsor
     c                   goto      end_spØrr
     c                   endif
      *
      * varesortiment
     c                   if        w_afld = 'B2VSOR'
     c                   eval      w_firm      = l_firm
     c                   eval      w_vsor      = b2vsor
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VC500R  '
     c                   PARM                    w_firm
     c                   PARM                    w_vsor
     c                   PARM                    w_navn
     c                   eval      b2vsor      = w_vsor
     c                   goto      end_spØrr
     c                   endif
      *
      * overgruppe
     c                   if        w_afld = 'C1OGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG510R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_navn
     c                   eval      c1ogrp      = w_ogrp
     c                   goto      end_spØrr
     c                   endif
     c                   if        w_afld = 'K1OGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = k1ogrp
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG510R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_navn
     c                   eval      k1ogrp      = w_ogrp
     c                   goto      end_spØrr
     c                   endif
     c                   if        w_afld = 'B2OGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = b2ogrp
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG510R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_navn
     c                   eval      b2ogrp      = w_ogrp
     c                   goto      end_spØrr
     c                   endif
      *
      * hovedgruppe
     c                   if        w_afld = 'C1HGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG511R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_navn
     c                   eval      c1ogrp      = w_ogrp
     c                   eval      c1hgrP      = w_hgrp
     c                   goto      end_spØrr
     c                   endif
     c                   if        w_afld = 'K1HGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = k1ogrp
     c                   eval      w_hgrp      = k1hgrP
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG511R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_navn
     c                   eval      k1ogrp      = w_ogrp
     c                   eval      k1hgrP      = w_hgrp
     c                   goto      end_spØrr
     c                   endif
      *
      * undergruppe
     c                   if        w_afld = 'C1UGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = c1ogrp
     c                   eval      w_hgrp      = c1hgrp
     c                   eval      w_ugrp      = c1ugrp
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG512R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_navn
     c                   eval      c1ogrp      = w_ogrp
     c                   eval      c1hgrp      = w_hgrp
     c                   eval      c1ugrp      = w_ugrp
     c                   goto      end_spØrr
     c                   endif
     c                   if        w_afld = 'K1UGRP'
     c                   eval      w_firm      = l_firm
     c                   eval      w_ogrp      = k1ogrp
     c                   eval      w_hgrp      = k1ogrp
     c                   eval      w_ugrp      = k1ugrp
     c                   eval      w_navn      = *blank
4.86 c                   CALL      'VG512R  '
     c                   PARM                    w_firm
     c                   PARM                    w_ogrp
     c                   PARM                    w_hgrp
     c                   PARM                    w_ugrp
     c                   PARM                    w_navn
     c                   eval      k1ogrp      = w_ogrp
     c                   eval      k1hgrp      = w_hgrp
     c                   eval      k1ugrp      = w_ugrp
     c                   goto      end_spØrr
     c                   endif
      *
      * Fra lager
     c                   if        w_afld = 'C2LAGE'
     c                   call      'MM801R  '
     c                   parm                    w_firm
     c                   parm                    a_lage
     c*                  movea     ww_lagr       a_lage
     c                   eval      c2lagr = %editw(a_lage(1):' 0') + ' ' +
     c                                      %editw(a_lage(2):' 0') + ' ' +
     c                                      %editw(a_lage(3):' 0') + ' ' +
     c                                      %editw(a_lage(4):' 0') + ' ' +
     c                                      %editw(a_lage(5):' 0') + ' ' +
     c                                      %editw(a_lage(6):' 0') + ' ' +
     c                                      %editw(a_lage(7):' 0') + ' ' +
     c                                      %editw(a_lage(8):' 0') + ' ' +
     c                                      %editw(a_lage(9):' 0') + ' ' +
     c                                      %editw(a_lage(10):' 0') + ' '
     c                   goto      end_spØrr
     c                   endif
      *
      * Leveringstype
     c                   if        w_afld = 'C2LETY'
     c                   call      'MM802R  '
     c                   parm                    w_firm
     c                   parm                    a_ltyp
     c                   eval      c2ltyp = %editw(a_ltyp(1):'0') + ' ' +
     c                                      %editw(a_ltyp(2):'0') + ' ' +
     c                                      %editw(a_ltyp(3):'0') + ' ' +
     c                                      %editw(a_ltyp(4):'0') + ' ' +
     c                                      %editw(a_ltyp(5):'0') + ' ' +
     c                                      %editw(a_ltyp(6):'0') + ' ' +
     c                                      %editw(a_ltyp(7):'0') + ' ' +
     c                                      %editw(a_ltyp(8):'0') + ' ' +
     c                                      %editw(a_ltyp(9):'0') + ' ' +
     c                                      %editw(a_ltyp(10):'0') + ' '
     c                   goto      end_spØrr
     c                   endif
      * Lager i key
     c                   if        w_afld = 'C1LAGK'
     c                   move      c1lagk        w_jkod
     c                   call      'RA510R  '
     c                   parm                    w_firm
     c                   parm                    w_jkod
     c                   parm                    w_jtxt
     c                   if        w_jkod = 0
     c                   move      *blank        c1lagk
     c                   else
     c                   move      w_jkod        c1lagk
     c                   endif
     c                   goto      end_spØrr
     c                   endif
      *
5.61 c                   if        w_afld = 'K1LAGK'
5.61 c                   move      k1lagk        w_jkod
5.61 c                   call      'RA510R  '
5.61 c                   parm                    w_firm
5.61 c                   parm                    w_jkod
5.61 c                   parm                    w_jtxt
5.61 c                   if        w_jkod = 0
5.61 c                   move      *blank        k1lagk
5.61 c                   else
5.61 c                   move      w_jkod        k1lagk
5.61 c                   endif
5.61 c                   goto      end_spØrr
5.61 c                   endif
      *
     c     end_spØrr     endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     velg_pgm      begsr
      *
     c                   eval      w_lagk = c1lagk
     c                   eval      w_vsor = c1vsor
     c                   eval      w_ogrp = c1ogrp
     c                   eval      w_hgrp = c1hgrp
     c                   eval      w_ugrp = c1ugrp
     c                   select
     c                   when      *inkg
     c                   eval      w_valg = 'F7'
     c                   when      *inkh
     c                   eval      w_valg = 'F8'
     c                   when      *inki
     c                   eval      w_valg = 'F9'
     c                   other
     c                   eval      w_valg = 'F3'
     c                   endsl
      *
     c     vlg_tag       tag
     c                   select
     c                   when      w_valg = 'F7'
     c                   call      'MB104R  '
     c                   parm                    w_lagk
     c                   parm                    w_vsor
     c                   parm                    w_ogrp
     c                   parm                    w_hgrp
     c                   parm                    w_ugrp
     c                   parm                    w_valg
     c                   when      w_valg = 'F8'
     c                   call      'MB105R  '
     c                   parm                    w_lagk
     c                   parm                    w_vsor
     c                   parm                    w_ogrp
     c                   parm                    w_hgrp
     c                   parm                    w_ugrp
     c                   parm                    w_valg
     c                   when      w_valg = 'F9'
     c                   call      'MB106R  '
     c                   parm                    w_lagk
     c                   parm                    w_vsor
     c                   parm                    w_ogrp
     c                   parm                    w_hgrp
     c                   parm                    w_ugrp
     c                   parm                    w_valg
     c                   endsl
      *
     c                   if        w_valg <> 'F3'
     c                   goto      vlg_tag
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente tekster til diverse felter
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_txt      begsr
      *
     c                   eval      w_vsna = *blank
     c                   eval      w_ogna = *blank
     c                   eval      w_hgna = *blank
     c                   eval      w_ugna = *blank
      *
     c                   eval      vshel1_vsor = w_vsor
6.20 c                   eval      vshel1_lage = 0
     c     vshel1_key    chain     vshel1
     c                   if        %found(vshel1)
     c                   movel     vcbesk        w_vsna
     c                   endif
     c                   eval      vogrl1_oogr = w_ogrp
     c                   eval      vhgrl1_hhgr = w_hgrp
     c                   eval      vugrl1_uugr = w_ugrp
     c     vogrl1_key    chain     vogrl1
     c                   if        %found(vogrl1)
     c                   movel     vgotxt        w_ogna
     c                   else
     c                   eval      w_ogna = *blank
     c                   endif
     c     vhgrl1_key    chain     vhgrl1
     c                   if        %found(vhgrl1)
     c                   movel     vghtxt        w_hgna
     c                   else
     c                   eval      w_hgna = *blank
     c                   endif
     c     vugrl1_key    chain     vugrl1
     c                   if        %found(vugrl1)
     c                   movel     vgutxt        w_ugna
     c                   else
     c                   eval      w_ugna = *blank
     c                   endif
      *
     c                   endsr
      *
5.63  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.63  * Subrutine for å oppatere abc-kode på prognose
5.63  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
5.63  *
5.63 c     upd_prog_abc  begsr
5.63  *
5.63 c                   call      'MM747R    '
5.63 c                   parm                    vlfirm
5.63 c                   parm                    vlvare
5.63 c                   parm                    vllage
5.63 c                   parm                    vlkabc
5.63  *
5.63 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parametre
      *
      * Key for posisjonering på abc parameter
      *
     c     mabcl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mabcl1_ogrp
     c                   kfld                    mabcl1_hgrp
     c                   kfld                    mabcl1_ugrp
      *
      * Key for posisjonering på varesortiment
      *
     c     mabcl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mabcl2_vsor
      *
      * Key for les på abc parameter
      *
     c     mabclr_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mabclr_vsor
     c                   kfld                    mabclr_ogrp
     c                   kfld                    mabclr_hgrp
     c                   kfld                    mabclr_ugrp
     c                   kfld                    mabclr_lagk
      *
      * Key for oppdatering av abc parameter
      *
     c     mabclu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mabclu_vsor
     c                   kfld                    mabclu_ogrp
     c                   kfld                    mabclu_hgrp
     c                   kfld                    mabclu_ugrp
     c                   kfld                    mabclu_lagk
      *
      * Key for les på av abc detaljer i abc-kode rekkefølge
      *
     c     mabdl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mabdl2_lagk
     c                   kfld                    mabdl2_vsor
     c                   kfld                    mabdl2_ogrp
     c                   kfld                    mabdl2_hgrp
     c                   kfld                    mabdl2_ugrp
      *
      * Key for å slette detaljer
      *
     c     mabdlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    mabdlu_lagk
     c                   kfld                    mabdlu_vsor
     c                   kfld                    mabdlu_ogrp
     c                   kfld                    mabdlu_hgrp
     c                   kfld                    mabdlu_ugrp
      *
      * Key for les på av abc detaljer i abc-kode rekkefølge
      *
     c     vvarlu_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarlu_vare
      *
5.51  * Key for oppdatering av abc-kode på lager
 .    *
 .   c     vlaglu_key    klist
 .   c                   kfld                    w_firm
 .   c                   kfld                    vlaglu_vare
5.51 c                   kfld                    vlaglu_lage
      *
      * Key for les av vare
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for les av varesortiment
      *
     c     vshel1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vshel1_vsor
6.20 c                   kfld                    vshel1_lage
      *
      * Key for les av overgruppe
      *
     c     vogrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vogrl1_oogr
      *
      * Key for les av hovedgruppe
      *
     c     vhgrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vogrl1_oogr
     c                   kfld                    vhgrl1_hhgr
      *
      * Key for les av undergruppe
      *
     c     vugrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vogrl1_oogr
     c                   kfld                    vhgrl1_hhgr
     c                   kfld                    vugrl1_uugr
      *
      *
      *
      * Henter verdier fra LDA, og initierer skjermbildet
      *
     c                   eval      w_firm = l_firm
      *
     c                   eval      *in22 = *on
      *
      * Posisjonerer databasen, og fyller opp subfile
      *
     c                   eval      mabcl1_ogrp = 0
     c                   eval      mabcl1_hgrp = 0
     c                   eval      mabcl1_ugrp = 0
     c     mabcl1_key    setll     mabcl1
      *
     c                   exsr      crt_subfile
      *
     c                   endsr
