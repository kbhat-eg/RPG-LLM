     /TITLE       Utskrift av etiketter fra lagertelling
     H DATEDIT(*DMY) OPTION(*NODEBUGIO)
     * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
     *                                                                       *
     * System. . . . . : ASLAGR                                              *
     * Program . . . . : LV610R                                              *
     * Beskrivelse . . : Utskrift av etiketter, parameter                    *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                       *
     * Spesialversjon. :                                                     *
     * Tilpasset for . :                                                     *
     *                                                                       *
     * Ref.   Dato  Sign Endringsbeskrivelse                               n *
     * ----- ------ ---- ------------------------------------------------- --*
     *                                                                       *
     *                                                                       *
     *                                                                       *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * *
     *
     Flv610d    cf   e             workstn
     Fvfaspf    if   e           k disk
     Fparam     o  a f  128        disk
     *
     *
     D mld             s             70    dim(11) ctdata perrcd(1)
     *
     /EJECT
     *
     *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *               :  LOCAL DATA AREA                                 +
     *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     *
     D                uds
     D lcetyp                111    111  0
     D lcetpr                112    112  0
     D lcken1                113    113  0
     D lcken2                114    114  0
     D lcdato                115    120  0
     D lcsort                121    121  0
     *
     D lcruti                800    809
     D lcuser                911    920
     D lcfirm                944    946  0
     D lcnavn                951    980
      *
      * Definering av variable
      *
     D wpin03          s              1  0
     D w_firm          s              3  0
     d w_dato          s               d   datfmt(*iso)
     D w_anta          s              1  0 inz(1)
     D p_batc          s             10
     D p_numm          s              6  0
     *
     /EJECT
     *+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *          C   A   L   C   U   L   A   T   I   O   N               +
     *
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *  A1BLD, Rutinen behandler utvalggstype                          +
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     C     a1tag         tag
     *
     C                   except    add001
     *
     C     c1tag         tag
     *
     *  Blanker felt som benyttes
     *
     C                   eval      c1etyp = vnetyp
     C                   eval      c1etpr = *zero
     c                   eval      c1dato = 0
     C     *dmy          move      w_dato        c1dato
     C                   eval      c1sort = vnsort
     C                   eval      c1enh1 = 1
     C                   eval      c1enh2 = 2
     *
     C                   eval      *in20 = *off
     C                   eval      *in21 = *off
     C                   eval      *in22 = *off
     C                   eval      *in23 = *off
     C                   eval      *in24 = *off
     C                   eval      *in25 = *off
     C                   eval      *in26 = *off
     C                   eval      *in96 = *off
     C                   eval      *in98 = *off
     *
     C                   eval      meld = *blank
     *
     C     c1taga        tag
     *
     C                   exfmt     c1bld
     *
B001 C                   if        *inkc = *on
 001 C                   move      1             wpin03
 001 C                   goto      slutt
E001 C                   endif
     *
     * Sjekk om riktig etikett-type
     *
B001 C                   if        c1etyp <> 0 and
 001 C                             c1etyp <> 1 and
 001 C                             c1etyp <> 2 and
 001 C                             c1etyp <> 3 and
 001 C                             c1etyp <> 4 and
 001 C                             c1etyp <> 5 and
 001 C                             c1etyp <> 6 and
 001 C                             c1etyp <> 7 and
 001 C                             c1etyp <> 8
 001 C                   eval      *in20 = *on
 001 C                   eval      *in96 = *on
 001 C                   eval      *in98 = *on
 001 C                   move      mld(06)       meld
 001 C                   goto      c1taga
E001 C                   endif
     *
     * Sjekk om riktig pris-type
     *
B001 C                   if        c1etpr <> 1 and
 001 C                             c1etpr <> 2 and
 001 C                             c1etpr <> 3
 001 C                   eval      *in21 = *on
 001 C                   eval      *in96 = *on
 001 C                   eval      *in98 = *on
 001 C                   move      mld(07)       meld
 001 C                   goto      c1taga
E001 C                   endif
     *
     * Sjekk om riktig utfylt dato
     *
B001 C                   if        c1etpr = 3
     c     *dmy          test(d)                 c1dato                 25
B001 C                   if        *in25 = *on
 002 C                   eval      *in96 = *on
 002 C                   eval      *in98 = *on
 002 C                   move      mld(10)       meld
 002 C                   goto      c1taga
E001 C                   endif
E001 C                   endif
     *
     * Sjekk om riktig sorterings-type
     *
B001 C                   if        c1sort <> 0 and
 001 C                             c1sort <> 1
 001 C                   eval      *in22 = *on
 001 C                   eval      *in96 = *on
 001 C                   eval      *in98 = *on
 001 C                   move      mld(01)       meld
 001 C                   goto      c1taga
E001 C                   endif
     *
     * Sjekk om riktig enhets-type
     *
B001 C                   if        c1enh1 <> 0 and
B001 C                             c1enh1 <> 1 and
 001 C                             c1enh1 <> 2 and
 001 C                             c1enh1 <> 3
 001 C                   eval      *in23 = *on
 001 C                   eval      *in96 = *on
 001 C                   eval      *in98 = *on
 001 C                   move      mld(08)       meld
 001 C                   goto      c1taga
E001 C                   endif
     *
B001 C                   if        c1enh2 <> 0 and
B001 C                             c1enh2 <> 1 and
 001 C                             c1enh2 <> 2 and
 001 C                             c1enh2 <> 3
 001 C                   eval      *in26 = *on
 001 C                   eval      *in96 = *on
 001 C                   eval      *in98 = *on
 001 C                   move      mld(08)       meld
 001 C                   goto      c1taga
E001 C                   endif
     *
     * Oppdater local
     *
     C                   eval      lcetyp = c1etyp
     C                   eval      lcetpr = c1etpr
     C                   eval      lcsort = c1sort
     C                   eval      lcken1 = c1enh1
     C                   eval      lcken2 = c1enh2
     c                   eval      lcdato = c1dato
     *
     * Sjekker hvilket utskriftsprogram som skal benyttes
     *
 001 C                   move      *blanks       lcruti
     *
B001 C                   if        lcetyp = 1
 001 C                   movel     'FP213 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 2
 001 C                   movel     'FP214 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 3
 001 C                   movel     'FP215 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 4
 001 C                   movel     'FP216 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 5
 001 C                   movel     'FP217 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 6
 001 C                   movel     'FP218 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 7
 001 C                   movel     'FP219 '      lcruti
E001 C                   endif
     *
B001 C                   if        lcetyp = 8
 001 C                   movel     'FP220 '      lcruti
E001 C                   endif
     *
B001 C                   if        *inkd = *on
 001 C                   eval      *inu2 = *on
E001 C                   endif
     *
     /EJECT
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *  END OF JOB                                                     +
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     C     slutt         tag
     *
     C                   eval      *inlr = *on
     *
     /EJECT
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for initiering av program                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     *inzsr        begsr
     *
     C                   time                    w_dato
     *
     C                   move      lcfirm        w_firm
     *
     * Parameterliste
     *
     C     *entry        plist
     C                   parm                    wpin03
     C                   parm                    p_batc
     C                   parm                    p_numm
     *
     C                   move      0             wpin03
     *
     * Hent etikettinformasjon
     *
     C     vfaspf_key    chain     vfaspf                             60
B001 C                   if        *in60 = *on
 001 C                   move      1             c1etyp
X001 C                   else
 001 C                   move      vnetyp        c1etyp
E001 C                   endif
     *
     * Key for faste data etiketter
     *
     C     vfaspf_key    klist
     C                   kfld                    w_firm
     *
     C                   endsr
     *
     Oparam     eadd         add001
     O                                            1 'A'
     O                       w_firm               4
     O                       p_batc              14
     O                       p_numm              20
     O                       w_anta              24
     *
     *                                                                   T104KR
     /EJECT
     *++++++++++++++++++++++  T A B E L L E R  +++++++++++++++++++++++++
**     M E L D I N G E R :
    Valgt kode er ugyldig, velg enten 0 eller 1
    Fra er større enn til
    Varenummer finnes ikke i vare-register
    Ean-kode finnes ikke i vare-register
    Antall er ikke utfylt
    Valgt kode er ikke i bruk, velg tall fra 1 - 8
    Valgt kode er ugyldig, velg enten 0, 1 eller 2
    Valgt kode er ugyldig, velg enten 0, 1, 2 eller 3
    Spørring ikke tilgjenglig på dette felt
    Dato ikke riktig utfylt
    LEDIG
