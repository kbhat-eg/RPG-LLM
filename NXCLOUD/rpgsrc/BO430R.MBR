     H/TITLE  ASSHOP Vedlikehold av butikk skjerm-kasse-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSHOP
      * Program . . . . : BO430R
      * Beskrivelse . . : ASSHOP Vedlikehold av skjerm-kasse-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * R3.10 221299 AMD  Lagt inn kontroll på gyldig avdeling
3.31  * R3.31 160301 AMD  Lagt på timestamp ved opprettelse av poster
      * 6.10  110909 BSA  Oppdatert med sporingsinformasjon
7.xx  * 7.00  260516 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
      *
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *  BRUK AV INDIKATORER
      *
      *       KC = F3  = Exit
      *       KE = F5  = Forny
      *       KL = F12 = Annuller
      *
      *       LR = Avslutt program
      *       10 = Roll
      *       12 = Sfldsp
      *       13 = Sfldspctl
      *       14 = Sflclr
      *       15 = Sflend
      *       16 = Readc 16 on, no more records
      *       30 = Protect av felter ved vise
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer
      *    60-69 = Fileindikatorer chain etc.
      *    70-79 = Arbeidsindikatorer i sub-rutiner
      *    80-89 = Arbeidsindikatorer ordinære
      *    90-99 = Benyttes ved std. sub-rutiner
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     FVOTYL1    IF   E           K DISK    RENAME(VOTYPFR:VOTYL1R)
     FBWSDL1    IF   E           K DISK    RENAME(BWSDPFR:BWSDL1R)
     FBSTSL1    IF   E           K DISK    RENAME(BSTSPFR:BSTSL1R)
     FANUML1    IF   E           K DISK    RENAME(ANUMPFR:ANUML1R)
     FAWSDL1    IF   E           K DISK    RENAME(AWSDPFR:AWSDL1R)
     FAWSDLU    UF A E           K DISK    RENAME(AWSDPFR:AWSDLUR)
     FBWSDLU    UF A E           K DISK    RENAME(BWSDPFR:BWSDLUR)
     FBO430D    CF   E             WORKSTN
     F                                     SFILE(B1SFL:SRRN01)
      *
     D MLD             S             11    DIM(4) CTDATA PERRCD(1)               MELDINGER
3.10  *
3.10  * Definering av variable
3.10  *
3.10 d w_jtxt          s             20
3.10 d w_jadr          s             30
3.10 d w_jpnr          s              4  0
3.10 d w_jste          s             30
3.10 d w_javd          s              4  0
3.31 d w_udat          s               d   datfmt(*iso)
3.31 d w_utim          s               t   timfmt(*iso)
      *
      *
      * Hente inn firma fra local
      *
      *
     D                UDS
3.31 D  l_user               911    920
     D  DSFIRM               944    946  0
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Forklaring på spesielle felter
      * som benyttes ved sub-files.
      * - - - - - - - - - - - - - - - - -
      *     nn - er 01 for subfile 01,
      *             02 for subfile 02,
      *             03 for subfile 03, o.s.v.
      * SRRNnn - Relativt recordnummer i subfile
      * SPGEnn - Sidestørrelse i subfile (page)
      * SFRNnn - Første recordnummer på siden
      * SSRNnn - Siste  recordnummer på siden
      * SVRNnn - Vis den side som inneholder denne record.
      *
      * Forklaring på spesielle felter
      * som benyttes ved windows.
      * - - - - - - - - - - - - - - - - -
      *
      * WACTLI - Actual line, angir startlinje for vindu.
      * WACTPO - Actual posision, angir startposisjon for vindu.
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * B1SFL  - B1 Subfile - record
      * B2CTL  - B2 Subfile - control record
      * B2CMD  - B2 Eget skjermbilde for CMD-taster
      * C1BLD  - C1 Skjermbilde for Kontonummer
      * C2BLD  - C2 Skjermbilde for opprette/ endre/vise
      * D1WIN  - D1 Vindu for slette (Delete)
      * K1WIN  - K1 Vindu for kopiere
      * S1WIN  - S1 Standardvindu som inneholder definisjon av
      *             størrelse og utseende.  Bildene D1WIN og K1WIN
      *             er referert til dette.
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Forklaring til logikken i programmet :                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Programmet inneholder en litt spesiell logikk for å håndtere
      * vedlikehold av opplysninger for hvilke utkøer/printere som
      * skal benyttes.  I skjermbildet ligger det 5 felter hvor du kan
      * registrere printer.  Dette blir ikke oppdatert i denne filen,
      * men ajourfører standardfilen for Skjerm/rutine som finnes i
      * ASPGPL.  På ordretypen ligger det et rutinenavn, og dette
      * benyttes sammen med skjermid. som key.  For lettere å huske
      * hva som er gjort her, kan etterfølgende beskrivelse benyttes:
      *
      * Initieringsrutine:
      * ------------------
      * - Henter inn Butikk-statusregister
      *   --------------------------------
      *          Key : Firma
      *                           Får : BAAOKD    BAAOKK
      *                                 BAAOCD    BAAOCK
      *                                 BAAOFD    BAAOFK
      *                                 BAAOBD    BAAOBK
      *                                 BAAOLD
      *
      *   I og med at denne record chaines kun i initieringsrutinen,
      *   vil disse felter ligge tilgjengelig og urørt så lenge
      *   programmet er aktivt.
      *
      * - Henter inn Register for ordretype
      *   ---------------------------------
      *          Key : Firma
      *                Ordretype
      *
      *          Dersom ordretype er oppgitt i statusregister,
      *          Dersom ordretype finnes i ordretyperegister,
      *
      *                           Får : WRUOKD    WRUOKK
      *                                 WRUOCD    WRUOCK
      *                                 WRUOFD    WRUOFK
      *                                 WRUOBD    WRUOBK
      *                                 WRUOPD
      *
      *   Dette er felter som inneholder rutinenavn.
      *   Disse felter vil også ligge tilgjengelig og urørt så lenge
      *   programmet er aktivt.
      *
      *
      * - Subrutine XHENTE, henter data fra AWSDPF-registeret i ADBxxx
      *   ------------------------------------------------------------
      *          Key : Skjerm-id
      *                Rutine-navn
      *
      *          Dersom rutinenavn ikke er blankt,
      *          Dersom post finnes i AWSDPF-registeret,
      *
      *                           Får : WSKONQ
      *                                 WSKRNQ
      *                                 WSFANQ
      *                                 WSIUTQ
      *                                 WSPLUQ
      *
      *          Dette er de felter som skal sendes tilbake til skjerm-
      *          bildet.
      *
      *
      * - Subrutine XUPDAT, oppdaterer AWSDPF-registeret i ADBxxx
      *   ------------------------------------------------------------
      *          Denne rutine foretar oppdatering av AWSDPF-registeret
      *          både ved oppretting endring og kopiering.
      *
      *   NB !   Det ligger en begrensning i programmet.  Dersom det
      *          i skjermbildet blir slettet en printer, vil ikke
      *          denne bli slettet i AWSDPF-registeret.  Dersom hele
      *          posten slettes, vil imidlertid postene i AWSDPF-
      *          registeret også bli borte.
      *
      *
      * - Subrutine XSLETT, sletter poster i AWSDPF-registeret i ADBxxx
      *   -------------------------------------------------------------
      *          Denne rutine sletter poster i AWSDPF-registeret.
      *
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2CTL Behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Send Alt
      *
     C     B2TAGA        TAG
     C                   WRITE     B2CMD
      *
      * Bare data
      *
     C     B2TAGB        TAG
     C                   EXSR      XDSP01                                       DSP SFL
      *
      * Avslutt program
      *
     C     *INKC         CABEQ     *ON           XSLUTT
      *
      * Forny
      *
     C     *INKE         IFEQ      *ON                                                   .....
     C     SFRN01        IFNE      *ZERO                                                     .
     C     SFRN01        CHAIN     B1SFL                              60                     .
     C                   END                                                                 .
     C                   MOVE      B1WSID        WWWSID                                      .
     C     KEY01         SETLL     BWSDL1                                                    .
     C                   EXSR      XCLR01                                       TØM SFL      .
     C                   EXSR      XCRT01                                       CRT SFL      .
     C                   GOTO      B2TAGB                                                    .
     C                   ENDIF                                                           .....
      *
      * Roll
      *
     C     *IN10         IFEQ      *ON                                                   .....
     C                   EXSR      XCRT01                                       CRT SFL      .
     C                   GOTO      B2TAGB                                                    .
     C                   ENDIF                                                           .....
      *
      * Posisjoner
      * startverdi
      *
     C     B2VALG        IFEQ      *BLANK                                                .....
     C     B2WSID        IFNE      *BLANK                                                    .
     C                   MOVE      B2WSID        WWWSID                                      .
     C     KEY01         SETLL     BWSDL1                                                    .
     C                   EXSR      XCLR01                                       TØM SFL      .
     C                   EXSR      XCRT01                                       CRT SFL      .
     C                   MOVE      *BLANK        B2WSID                                      .
     C                   GOTO      B2TAGB                                                    .
     C                   END                                                                 .
     C                   ENDIF                                                           .....
      *
      * Varsle om
      * gyldig konto
      *
     C     B2VALG        IFNE      ' '                                                   .....
     C     B2WSID        IFEQ      *BLANK                                                    .
     C                   MOVE      *ON           *IN31                                       .
     C                   GOTO      B2TAGB                                                    .
     C                   END                                                                 .
     C                   ENDIF                                                           .....
      *
      * Slå opp
      * i filen
      *
     C                   MOVE      B2WSID        WWWSID
     C     KEY01         CHAIN     BWSDL1                             60
      *
      * Post finnes
      * ikke
      *
     C     *IN60         IFEQ      *ON                                                   .....
     C     B2VALG        IFEQ      '2'                                                       .
     C     B2VALG        OREQ      '3'                                                       .
     C     B2VALG        OREQ      '4'                                                       .
     C     B2VALG        OREQ      '5'                                                       .
     C                   MOVE      *ON           *IN32                                       .
     C                   GOTO      B2TAGB                                                    .
     C                   END                                                                 .
     C                   ENDIF                                                           .....
      *
      * Post finnes
      * fra før
      *
     C     *IN60         IFEQ      *OFF                                                  .....
     C     B2VALG        IFEQ      '1'                                                       .
     C                   MOVE      *ON           *IN33                                       .
     C                   GOTO      B2TAGB                                                    .
     C                   END                                                                 .
     C                   ENDIF                                                           .....
      *
      * Opprette
      *
     C     B2VALG        IFEQ      '1'                                                   .....
     C                   MOVE      B2WSID        C1WSID                                      .
     C                   GOTO      C1TAGA                                                    .
     C                   ENDIF                                                           .....
      *
      * Endre
      *
     C     B2VALG        IFEQ      '2'                                                   .....
     C                   MOVE      B2WSID        C1WSID                                      .
     C                   MOVE      B2WSID        WSWSID                                      .
     C                   EXSR      XC2BLD                                                    .
     C                   GOTO      B2TAGA                                                    .
     C                   ENDIF                                                           .....
      *
      * Kopiere
      *
     C     B2VALG        IFEQ      '3'                                                   .....
     C                   MOVE      B2WSID        K1WSID                                      .
     C                   MOVE      B2WSID        WSWSID                                      .
     C                   EXSR      XK1WIN                                                    .
     C                   GOTO      B2TAGB                                                    .
     C                   ENDIF                                                           .....
      *
      * Slette
      *
     C     B2VALG        IFEQ      '4'                                                   .....
     C                   EXSR      XD1WIN                                                    .
      *                    GOTO B2TAGB                                  .
     C                   ENDIF                                                           .....
      *
      * Vise
      *
     C     B2VALG        IFEQ      '5'                                                   .....
     C                   MOVE      *ON           *IN30                                       .
     C                   MOVE      B2WSID        C1WSID                                      .
     C                   MOVE      B2WSID        WSWSID                                      .
     C                   EXSR      XC2BLD                                                    .
     C                   GOTO      B2TAGA                                                    .
     C                   ENDIF                                                           .....
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Behandling av subfile                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Sjekk om valg
      * er foretatt i
      * subfile
      *
     C                   DO        SSRN01                                                .....
     C                   READC     B1SFL                                  16                 .
     C     *IN16         IFEQ      *ON                                                       .
     C                   LEAVE                                                               .
     C                   ENDIF                                                               .
      *                                                                 .
      * Endre post                                                      .
      *                                                                 .
     C     B1VALG        IFEQ      '2'                                                       .
     C                   MOVE      B1WSID        C1WSID                                      .
     C                   MOVE      B1WSID        WWWSID                                      .
     C                   MOVE      B1WSID        WSWSID                                      .
     C                   EXSR      XC2BLD                                                    .
     C                   ITER                                                                .
     C                   ENDIF                                                               .
      *                                                                 .
      * Kopiere post                                                    .
      *                                                                 .
     C     B1VALG        IFEQ      '3'                                                       .
     C                   MOVE      B1WSID        K1WSID                                      .
     C                   MOVE      B1WSID        WWWSID                                      .
     C                   MOVE      B1WSID        WSWSID                                      .
     C                   EXSR      XK1WIN                                                    .
     C                   ITER                                                                .
     C                   ENDIF                                                               .
      *                                                                 .
      * Slette post                                                     .
      *                                                                 .
     C     B1VALG        IFEQ      '4'                                                       .
     C                   MOVE      B1WSID        WWWSID                                      .
     C                   MOVE      B1WSID        WSWSID                                      .
     C                   EXSR      XD1WIN                                                    .
     C                   ITER                                                                .
     C                   ENDIF                                                               .
      *                                                                 .
      * Vise post                                                       .
      *                                                                 .
     C     B1VALG        IFEQ      '5'                                                       .
     C                   MOVE      *ON           *IN30                                       .
     C                   MOVE      B1WSID        C1WSID                                      .
     C                   MOVE      B1WSID        WWWSID                                      .
     C                   MOVE      B1WSID        WSWSID                                      .
     C                   EXSR      XC2BLD                                                    .
     C                   ITER                                                                .
     C                   ENDIF                                                               .
      *                                                                 .
     C                   ENDDO                                                           .....
      *
     C                   GOTO      B2TAGA
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C1BLD Behandle åpningsbildet for ny post                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     C1TAGA        TAG
     C                   EXFMT     C1BLD
      *
     C     *INKC         CABEQ     *ON           B2TAGA
     C     *INKL         CABEQ     *ON           B2TAGA
      *
     C                   MOVE      C1WSID        WWWSID
     C                   MOVE      C1WSID        WSWSID
      *
     C                   EXSR      XC2BLD
     C                   GOTO      C1TAGA
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XSLUTT        TAG
     C                   SETON                                        LR
     C                   RETURN
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C2BLD Behandle bilde for ny - endring - vise                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XC2BLD        BEGSR
     C     KEY01         CHAIN     BWSDL1                             60
      *
     C     *IN60         IFEQ      *OFF                                                  .....
     C                   MOVEL     MLD(2)        C2NYEN                                      .
     C                   MOVE      BWWSGR        C2WSGR                                      .
     C                   MOVE      BWTXT1        C2TXT1                                      .
     C                   MOVE      BWTXT2        C2TXT2                                      .
     C                   MOVE      BWBONG        C2BONG                                      .
     C                   MOVE      BWAVDE        C2AVDE                                      .
     C                   MOVE      BWSPES        C2SPES                                      .
     C                   MOVE      BWLAGE        C2LAGE                                      .
     C                   MOVE      BWKTYP        C2KTYP                                      .
     C                   MOVE      BWKVAR        C2KVAR                                      .
     C                   MOVE      BWKANT        C2KANT                                      .
     C                   MOVE      BWKBON        C2KBON                                      .
     C                   MOVE      BWKSEL        C2KSEL                                      .
     C                   MOVE      BWAKTI        C2AKTI                                      .
     C                   EXSR      XHENTE                                                    .
     C                   MOVE      WSKONQ        C2KONQ                                      .
     C                   MOVE      WSKRNQ        C2KRNQ                                      .
     C                   MOVE      WSFANQ        C2FANQ                                      .
     C                   MOVE      WSIUTQ        C2IUTQ                                      .
     C                   MOVE      WSPLUQ        C2PLUQ                                      .
     C                   ELSE                                                                .
     C                   MOVEL     MLD(1)        C2NYEN                                      .
     C                   MOVE      *BLANK        C2WSGR                                      .
     C                   MOVE      *BLANK        C2TXT1                                      .
     C                   MOVE      *BLANK        C2TXT2                                      .
     C                   MOVE      *BLANK        C2BONG                                      .
     C                   MOVE      *ZERO         C2AVDE                                      .
     C                   MOVE      *ZERO         C2SPES                                      .
     C                   MOVE      *ZERO         C2LAGE                                      .
     C                   MOVE      *ZERO         C2KTYP                                      .
     C                   MOVE      *ZERO         C2KVAR                                      .
     C                   MOVE      *ZERO         C2KANT                                      .
     C                   MOVE      *ZERO         C2KBON                                      .
     C                   MOVE      *ZERO         C2KSEL                                      .
     C                   MOVE      *ZERO         C2AKTI                                      .
     C                   MOVE      *BLANK        C2KONQ                                      .
     C                   MOVE      *BLANK        C2KRNQ                                      .
     C                   MOVE      *BLANK        C2FANQ                                      .
     C                   MOVE      *BLANK        C2IUTQ                                      .
     C                   MOVE      *BLANK        C2PLUQ                                      .
     C                   ENDIF                                                           .....
      *
     C     *IN30         IFEQ      *ON                                                   .....
     C                   MOVEL     MLD(3)        C2NYEN                                      .
     C                   ENDIF                                                           .....
      *                                                                 .
      *  Hent,   Tekst for lager                                        .
      *                                                                 .
     C                   EXSR      SBLAGR                                                    .
      *                                                                 .
      *
     C     C2TAGB        TAG
     C                   EXFMT     C2BLD
      *
     C     *INKC         CABEQ     *ON           C2TAG1
     C     *INKL         CABEQ     *ON           C2TAG1
     C     *IN30         CABEQ     *ON           C2TAG1
      *
      * Felt for identifikasjon av bongnummer
      * kan ikke være blankt
      *
     C     C2BONG        IFEQ      *BLANK                                                .....
     C                   MOVE      *ON           *IN31                                       .
     C                   GOTO      C2TAGB                                                    .
     C                   ENDIF                                                           .....
      *
      * Felt for identifikasjon av bongnummer
      * må finnes i register
      * for nummerserier.
      *
     C                   MOVE      WWFIRM        WAFIRM
     C                   MOVE      C2BONG        WWFELL
     C                   MOVE      *BLANK        WWTYPE
     C                   MOVE      *BLANK        WWFAST
      *
     C     KEY05         SETLL     ANUML1
     C                   READ      ANUML1                                 65
      *
     C     ANFELL        IFNE      C2BONG                                                .....
     C                   MOVE      *ON           *IN32                                       .
     C                   GOTO      C2TAGB                                                    .
     C                   ENDIF                                                           .....
3.10  *
3.10  *  Sjekk,  Finnes lager i KODE-REGISTER
3.10  *
3.10 C                   eval      c2latx = *blank
3.10 C                   exsr      sblagr
3.10 C                   if        w_feil = '1'
3.10 C                   eval      *in34  = *on
3.10 C                   goto      c2tagb
3.10 C                   endif
      *
     C     KEY01         CHAIN     BWSDLUR                            60
      *
     C                   MOVE      C2WSGR        BWWSGR
     C                   MOVE      C2TXT1        BWTXT1
     C                   MOVE      C2TXT2        BWTXT2
     C                   MOVE      C2BONG        BWBONG
     C                   MOVE      C2AVDE        BWAVDE
     C                   MOVE      C2SPES        BWSPES
     C                   MOVE      C2LAGE        BWLAGE
     C                   MOVE      C2KTYP        BWKTYP
     C                   MOVE      C2KVAR        BWKVAR
     C                   MOVE      C2KANT        BWKANT
     C                   MOVE      C2KBON        BWKBON
     C                   MOVE      C2KSEL        BWKSEL
     C                   MOVE      C2AKTI        BWAKTI
      *
6.10 c                   time                    bwedat
6.10 c                   time                    bwetim
6.10 c                   eval      bweusr = l_user
     C     *IN60         IFEQ      *OFF                                                  .....
     C                   UPDATE    BWSDLUR                                                   .
     C                   ELSE                                                                .
     C                   MOVE      WWFIRM        BWFIRM                                      .
     C                   MOVE      C1WSID        BWWSID                                      .
6.10 c                   time                    bwodat
6.10 c                   time                    bwotim
6.10 c                   eval      bwousr = l_user
     C                   WRITE     BWSDLUR                                                   .
     C                   ENDIF                                                           .....
      *
      * Oppdater standard register
      * for printerstyring AWSDLU
      *
     C                   MOVE      C2KONQ        WWKONQ
     C                   MOVE      C2KRNQ        WWKRNQ
     C                   MOVE      C2FANQ        WWFANQ
     C                   MOVE      C2IUTQ        WWIUTQ
     C                   MOVE      C2PLUQ        WWPLUQ
     C                   EXSR      XUPDAT
      *
      * Oppdater subfile
      *
     C     B1VALG        IFEQ      '2'                                                   .....
     C                   MOVE      C1WSID        B1WSID                                      .
     C                   MOVE      C2TXT1        B1TXT1                                      .
     C                   MOVE      C2TXT2        B1TXT2                                      .
     C                   MOVE      C2WSGR        B1WSGR                                      .
     C                   MOVE      C2KTYP        B1KTYP                                      .
     C                   ENDIF                                                           .....
      *
     C     C2TAG1        TAG
      *
     C     B1VALG        IFEQ      '2'                                                   .....
     C     B1VALG        OREQ      '5'                                                       .
     C                   MOVE      SRRN01        SVRN01                                      .
     C                   MOVE      *BLANK        B1VALG                                      .
     C                   UPDATE    B1SFL                                                     .
     C                   ENDIF                                                           .....
      *
     C                   MOVE      *BLANK        B2VALG
     C                   MOVE      *BLANK        B2WSID
     C                   MOVE      *OFF          *IN30
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * D1WIN Behandle bilde for slette                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XD1WIN        BEGSR
     C     KEY01         CHAIN     BWSDL1                             60
      *
     C                   Z-ADD     4             WACTLI
     C                   Z-ADD     26            WACTPO
     C                   WRITE     S1WIN
      *
     C                   EXFMT     D1WIN
      *
     C     *INKC         CABEQ     *ON           D1TAG1
     C     *INKL         CABEQ     *ON           D1TAG1
      *
     C     KEY01         CHAIN     BWSDLUR                            60
      *
     C     *IN60         IFEQ      *OFF                                                  .....
     C                   DELETE    BWSDLUR                                                   .
     C                   ENDIF                                                           .....
      *
      * Slette printerstyring
      * fra standardregister
      *
     C     *IN60         IFEQ      *OFF                                                  .....
     C                   EXSR      XHENTE                                                    .
     C                   MOVE      WSKONQ        WWKONQ                                      .
     C                   MOVE      WSKRNQ        WWKRNQ                                      .
     C                   MOVE      WSFANQ        WWFANQ                                      .
     C                   MOVE      WSIUTQ        WWIUTQ                                      .
     C                   MOVE      WSPLUQ        WWPLUQ                                      .
     C                   EXSR      XSLETT                                                    .
     C                   ENDIF                                                           .....
      *
      * Oppdater subfile
      *
     C     B1VALG        IFEQ      '4'                                                   .....
     C                   MOVE      *BLANK        B1TXT1                                      .
     C                   MOVEL     MLD(4)        B1TXT1                                      .
     C                   ENDIF                                                           .....
      *
     C     D1TAG1        TAG
      *
     C     B1VALG        IFEQ      '4'                                                   .....
     C                   MOVE      *BLANK        B1VALG                                      .
     C                   UPDATE    B1SFL                                                     .
     C                   ENDIF                                                           .....
      *
     C                   MOVE      *BLANK        B2VALG
     C                   MOVE      *BLANK        B2WSID
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * K1WIN Behandle bilde for kopiere                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XK1WIN        BEGSR
     C     KEY01         CHAIN     BWSDL1                             60
      *
     C                   MOVE      BWWSGR        K1WSGR
     C                   MOVE      BWTXT1        K1TXT1
     C                   MOVE      BWTXT2        K1TXT2
     C                   MOVE      BWBONG        K1BONG
     C                   Z-ADD     4             WACTLI
     C                   Z-ADD     26            WACTPO
     C                   WRITE     S1WIN
      *
      * Henter inn poster fra
      * standard register for
      * printer-styring
      *
     C                   EXSR      XHENTE
      *
     C     K1TAGB        TAG
      *
     C                   EXFMT     K1WIN
      *
     C     *INKC         CABEQ     *ON           K1TAG1
     C     *INKL         CABEQ     *ON           K1TAG1
      *
      * Slå opp
      * i filen
      *
     C                   MOVE      K1WSID        WWWSID
     C                   MOVE      K1WSID        WSWSID
     C     KEY01         CHAIN     BWSDL1                             60
      *
      * Post finnes
      * fra før
      *
     C     *IN60         IFEQ      *OFF                                                  .....
     C                   MOVE      *ON           *IN31                                       .
     C                   GOTO      K1TAGB                                                    .
     C                   ENDIF                                                           .....
      *
      * Oppdater file
      *
     C     KEY01         CHAIN     BWSDLUR                            60
     C                   MOVE      K1WSID        BWWSID
     C                   MOVE      K1TXT1        BWTXT1
     C                   MOVE      K1TXT2        BWTXT2
     C                   MOVE      K1BONG        BWBONG
     C                   MOVE      *ZERO         BWAKTI
6.10 c                   time                    bwodat
6.10 c                   time                    bwotim
6.10 c                   eval      bwousr = l_user
6.10 c                   time                    bwedat
6.10 c                   time                    bwetim
6.10 c                   eval      bweusr = l_user
     C                   WRITE     BWSDLUR
      *
      * Oppdater standard register
      * for printerstyring AWSDLU
      *
     C                   MOVE      WSKONQ        WWKONQ
     C                   MOVE      WSKRNQ        WWKRNQ
     C                   MOVE      WSFANQ        WWFANQ
     C                   MOVE      WSIUTQ        WWIUTQ
     C                   MOVE      WSPLUQ        WWPLUQ
     C                   EXSR      XUPDAT
      *
     C     K1TAG1        TAG
      *
      * Oppdater subfile
      *
     C     B1VALG        IFEQ      '3'                                                   .....
     C                   MOVE      *BLANK        B1VALG                                      .
     C                   UPDATE    B1SFL                                                     .
     C                   ENDIF                                                           .....
      *
     C                   MOVE      *BLANK        B2VALG
     C                   MOVE      *BLANK        B2WSID
     C                   MOVE      *BLANK        K1WSID
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Sjekk/Hent tekst for lager                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     C     sblagr        begsr
      *
3.10 C                   eval      c2latx = *blank
3.10  *
3.10 C                   call      'FÅ720R'
3.10 C                   parm                    wpfirm
3.10 C                   parm                    c2lage
3.10 C                   parm                    w_jtxt
3.10 C                   parm                    w_jadr
3.10 C                   parm                    w_jpnr
3.10 C                   parm                    w_jste
3.10 C                   parm                    w_javd
3.10 C                   parm                    w_feil
      *
3.10 C                   if        w_feil = '0'
3.10 C                   eval      c2latx = w_jtxt
3.10 C                   endif
      *
     C                   endsr
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Tøm subfile                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XCLR01        BEGSR
     C                   MOVE      *ON           *IN14
     C                   WRITE     B2CTL
     C                   MOVE      *OFF          *IN14
      *
     C                   MOVE      *OFF          *IN15
     C                   Z-ADD     0             SRRN01
     C                   Z-ADD     0             SFRN01
     C                   Z-ADD     0             SSRN01
     C                   Z-ADD     0             SPGE01
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Fyll opp subfile                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XCRT01        BEGSR
     C                   ADD       10            SPGE01                         SFL END
     C                   Z-ADD     SSRN01        SRRN01
      *
     C     SRRN01        DOUEQ     SPGE01                                                .....
     C                   READ      BWSDL1                                 15                 .
     C     *IN15         CABEQ     '1'           XEND01                         EOF          .
     C                   ADD       1             SRRN01                                      .
     C                   MOVE      BWWSID        B1WSID                                      .
     C                   MOVE      BWTXT1        B1TXT1                                      .
     C                   MOVE      BWTXT2        B1TXT2                                      .
     C                   MOVE      BWWSGR        B1WSGR                                      .
     C                   MOVE      BWKTYP        B1KTYP                                      .
     C                   WRITE     B1SFL                                                     .
     C                   ENDDO                                                           .....
      *
     C     XEND01        TAG
      *
     C     SRRN01        IFGT      SSRN01                                                .....
     C     SSRN01        ADD       1             SFRN01                                      .
     C                   ENDIF                                                           .....
      *
     C                   Z-ADD     SRRN01        SSRN01
     C                   Z-ADD     SFRN01        SVRN01
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Display subfile                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XDSP01        BEGSR
      *
     C     SRRN01        IFNE      0                                                     .....
     C                   MOVE      *ON           *IN12                                       .
     C                   ENDIF                                                           .....
      *
     C                   MOVE      *ON           *IN13
     C                   EXFMT     B2CTL
     C                   MOVE      *OFF          *IN12
     C                   MOVE      *OFF          *IN13
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Hente inn data for utkø/printer                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XHENTE        BEGSR
      *
      * Hente inn skjerm / rutine register
      *
     C                   MOVE      *BLANK        WSKONQ
     C                   MOVE      *BLANK        WSKRNQ
     C                   MOVE      *BLANK        WSFANQ
     C                   MOVE      *BLANK        WSIUTQ
     C                   MOVE      *BLANK        WSPLUQ
      *
     C     WRUOKD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOKD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSKONQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOCD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOCD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSKRNQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOFD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOFD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSFANQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOBD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOBD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSIUTQ                                      .
     C                   ENDIF                                                           .....
      *
     C     WRUOPD        IFNE      *BLANK                                                .....
     C                   MOVE      WRUOPD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDL1R                            64                     .
     C  N64              MOVE      AWOUTQ        WSPLUQ                                      .
     C                   ENDIF                                                           .....
      *
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Oppdatere standard register for styring av printer              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XUPDAT        BEGSR
3.31  *
3.31  * Henter dagens dato og klokkeslett
3.31  *
3.31 c                   time                    w_udat
3.31 c                   time                    w_utim
      *
      * Oppdaterer skjerm / rutine register Kontant-Debet
      *
     C     WWKONQ        IFNE      *BLANK                                                .....
     C     WRUOKD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOKD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWKONQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOKD        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Kontant-Kredit
      *
     C     WWKONQ        IFNE      *BLANK                                                .....
     C     WRUOKK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOKK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWKONQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOKK        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Pakkseddel-debet
      *
     C     WWKRNQ        IFNE      *BLANK                                                .....
     C     WRUOCD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOCD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWKRNQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOCD        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Pakkseddel-Kredit
      *
     C     WWKRNQ        IFNE      *BLANK                                                .....
     C     WRUOCK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOCK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWKRNQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOCK        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Faktura
      *
     C     WWFANQ        IFNE      *BLANK                                                .....
     C     WRUOFD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOFD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWFANQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOFD        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Kreditnota
      *
     C     WWFANQ        IFNE      *BLANK                                                .....
     C     WRUOFK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOFK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWFANQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOFK        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Innbetaling
      *
     C     WWIUTQ        IFNE      *BLANK                                                .....
     C     WRUOBD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOBD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWIUTQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOBD        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Utbetaling
      *
     C     WWIUTQ        IFNE      *BLANK                                                .....
     C     WRUOBK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOBK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWIUTQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOBK        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Oppdaterer skjerm / rutine register Plukkliste
      *
     C     WWPLUQ        IFNE      *BLANK                                                .....
     C     WRUOPD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOPD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C                   MOVE      WWPLUQ        AWOUTQ                                      .
3.31 C                   move      w_udat        awedat                                      .
3.31 C                   move      w_utim        awetim                                      .
3.31 C                   move      l_user        aweusr                                      .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   UPDATE    AWSDLUR                                                 . .
     C                   ELSE                                                              . .
3.31 C                   move      0             awakop                                      .
     C                   MOVE      WSWSID        AWWSID                                    . .
     C                   MOVE      WRUOPD        AWRUTI                                    . .
     C                   WRITE     AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
     C                   ENDSR
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Sletting av poster for styring av printer                       *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     XSLETT        BEGSR
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWKONQ        IFNE      *BLANK                                                .....
     C     WRUOKD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOKD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWKONQ        IFNE      *BLANK                                                .....
     C     WRUOKK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOKK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWKRNQ        IFNE      *BLANK                                                .....
     C     WRUOCD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOCD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWKRNQ        IFNE      *BLANK                                                .....
     C     WRUOCK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOCK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWFANQ        IFNE      *BLANK                                                .....
     C     WRUOFD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOFD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWFANQ        IFNE      *BLANK                                                .....
     C     WRUOFK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOFK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i inn skjerm / rutine register
      *
     C     WWIUTQ        IFNE      *BLANK                                                .....
     C     WRUOBD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOBD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWIUTQ        IFNE      *BLANK                                                .....
     C     WRUOBK        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOBK        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
      * Sletter post i skjerm / rutine register
      *
     C     WWPLUQ        IFNE      *BLANK                                                .....
     C     WRUOPD        IFNE      *BLANK                                                    .
     C                   MOVE      WRUOPD        WWRUTI                                      .
     C     KEY04         CHAIN     AWSDLUR                            64                     .
     C     *IN64         IFEQ      *OFF                                                  ... .
     C                   DELETE    AWSDLUR                                                 . .
     C                   END                                                             ... .
     C                   ENDIF                                                               .
     C                   ENDIF                                                           .....
      *
     C                   ENDSR
      *
     C/EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     C     *INZSR        BEGSR
      *
     C                   Z-ADD     0             SPGE01            3 0
     C                   Z-ADD     0             SRRN01            4 0
     C                   Z-ADD     0             WACTLI            2 0
     C                   Z-ADD     0             WACTPO            3 0
     C                   MOVE      *ZERO         WAFIRM            3 0
3.10 C                   MOVE      *BLANK        w_feil            1
      *
     C     *LIKE         DEFINE    SRRN01        SFRN01
     C     *LIKE         DEFINE    SRRN01        SSRN01
     C     *LIKE         DEFINE    BWFIRM        WWFIRM
     C     *LIKE         DEFINE    BWWSID        WWWSID
     C     *LIKE         DEFINE    VAOTYP        WWOTYP
     C     *LIKE         DEFINE    AWRUTI        WWRUTI
     C     *LIKE         DEFINE    AWRUTI        WRUOKD
     C     *LIKE         DEFINE    AWRUTI        WRUOKK
     C     *LIKE         DEFINE    AWRUTI        WRUOCD
     C     *LIKE         DEFINE    AWRUTI        WRUOCK
     C     *LIKE         DEFINE    AWRUTI        WRUOFD
     C     *LIKE         DEFINE    AWRUTI        WRUOFK
     C     *LIKE         DEFINE    AWRUTI        WRUOBD
     C     *LIKE         DEFINE    AWRUTI        WRUOBK
     C     *LIKE         DEFINE    AWRUTI        WRUOPD
     C     *LIKE         DEFINE    AWOUTQ        WWKONQ
     C     *LIKE         DEFINE    AWOUTQ        WWKRNQ
     C     *LIKE         DEFINE    AWOUTQ        WWFANQ
     C     *LIKE         DEFINE    AWOUTQ        WWIUTQ
     C     *LIKE         DEFINE    AWOUTQ        WWPLUQ
     C     *LIKE         DEFINE    AWOUTQ        WSKONQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSKRNQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSFANQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSIUTQ                         Save-felter
     C     *LIKE         DEFINE    AWOUTQ        WSPLUQ                         Save-felter
     C     *LIKE         DEFINE    AWWSID        WSWSID                         Save-felter
     C     *LIKE         DEFINE    ANFELL        WWFELL
     C     *LIKE         DEFINE    ANTYPE        WWTYPE
     C     *LIKE         DEFINE    ANFAST        WWFAST
      *
     C     *LIKE         DEFINE    BWFIRM        WPFIRM
      *
      * Legge inn key
      *
     C                   MOVE      DSFIRM        WWFIRM
     C                   MOVE      DSFIRM        WPFIRM
      *
      * Key for file kasse/skjermregister
      *
     C     KEY01         KLIST
     C                   KFLD                    WWFIRM
     C                   KFLD                    WWWSID
      *
      * Key for statusregister
      *
     C     KEY02         KLIST
     C                   KFLD                    WWFIRM
      *
      * Key for ordretyperegister
      *
     C     KEY03         KLIST
     C                   KFLD                    WWFIRM
     C                   KFLD                    WWOTYP
      *
      * Key for skjerm/rutine-register
      *
     C     KEY04         KLIST
     C                   KFLD                    WWWSID
     C                   KFLD                    WWRUTI
      *
      * Key for nummer-serie-register
      *
     C     KEY05         KLIST
     C                   KFLD                    WAFIRM
     C                   KFLD                    WWFELL
     C                   KFLD                    WWTYPE
     C                   KFLD                    WWFAST
      *
     C     KEY01         SETLL     BWSDL1
     C                   EXSR      XCRT01
      *
      * Hente inn butikk-status-record
      *
     C     KEY02         CHAIN     BSTSL1                             62
      *
      * Hente inn ordre-type-register
      *
     C     BAAOKD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOKD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOKD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOKK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOKK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOKK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOCD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOCD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOCD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOCK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOCK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOCK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOFD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOFD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOFD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOFK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOFK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOFK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOBD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOBD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOBD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOBK        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOBK        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOBK                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C     BAAOLD        IFNE      *BLANK                                                .....
     C                   MOVE      BAAOLD        WWOTYP                                      .
     C     KEY03         CHAIN     VOTYL1                             63                     .
     C  N63              MOVE      VAORUB        WRUOPD                         Rutine       .
     C                   ENDIF                                                           .....
      *
     C                   ENDSR
      *
**
  Ny post                  001
  Endring                  002
  Vise                     003
* Slettet *                004
