      /TITLE  ASSTAT Vedlikehold av parameterfil, innkjøp
     h datedit(*dmy.) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SR100R
      * Beskrivelse . . : Vedlikehold av parameterfil, innkjøp
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
5.41  * R5.41 170206 AMD  Tok ikke hensyn til firma i subfilen
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     fsr100d    cf   e             workstn sfile(b1sfl:srrn01)
      *
     fausrl1    if   e           k disk    rename(ausrpfr:ausrl1r)
      *
     fslpml1    if   e           k disk    rename(slpmpfr:slpml1r)
     fslpmlu    uf a e           k disk    rename(slpmpfr:slpmlur)
      *
     d mld             s             11    dim(4) ctdata perrcd(1)
     d rpt             s             15    dim(60) ctdata perrcd(1)
     d ref             s              2  0 dim(60)
     d rap             s              1  0 dim(60)
      *
     d                uds
     d dsuser                911    920
     d dsfirm                944    946  0
     d l_fnav                951    980
      *
     d wwrest_00       ds           330
     d wwtext_00                     30
     d wwsrt1_00                      2  0
     d wwsrt2_00                      2  0
     d wwsrt3_00                      2  0
     d wwsps1_00                      1a
     d wwsps2_00                      1a
     d wwsps3_00                      1a
     d wwsps4_00                      1a
     d wwsps5_00                      1a
     d wwsps6_00                      1a
     d wwpmnd_00                      2  0
     d wwpaar_00                      4  0
     d wwsmli_00                      1a
     d wwsps7_00                      1a
     d wwsss1_00                      1a
     d wwsss2_00                      1a
     d wwsss3_00                      1a
     d wwslet_00                      1a
     d wwendr_00                      1a
      *
     d wwrest_41       ds           330
     d wwtext_41                     30
     d wwfaar_41                      4  0
     d wwfmnd_41                      2  0
     d wwtaar_41                      4  0
     d wwtmnd_41                      2  0
      *
     d spge01          s              3  0
     d srrn01          s              4  0
     d sfrn01          s                   like(srrn01)
     d ssrn01          s                   like(srrn01)
      *
     d ausrl1_user     s                   like(abuser)
     d wwnavn          s                   like(abnavn)
      *
     d wwfirm          s                   like(srfirm)
     d wwtype          s                   like(srtype)
     d wptype          s                   like(srtype)
     d wwkode          s                   like(srkode)
     d wwvalg          s                   like(srvalg)
     d wptext          s                   like(wwtext_00)
      *
     d n               s              2  0
     d n1              s              1
     d n2              s                   like(n1)
     d n3              s                   like(n1)
     d r1              s              2  0
     d r2              s                   like(r1)
     d r3              s                   like(r1)
      *
     d ww_detaljer     s              1
     d wwover          s              1a
     d wwslet          s              1a
      *
     d w_time          s             12  0
      *
     ic3bld
     i              c3sr11                      rap(11)
     i              c3sr31                      rap(31)
     i              c3sr12                      rap(12)
     i              c3sr32                      rap(32)
     i              c3sr13                      rap(13)
     i***           c3sr33                      rap(33)
     i              c3sr14                      rap(14)
     i              c3sr15                      rap(15)
     i              c3sr41                      rap(41)
     i              c3sr16                      rap(16)
     i              c3sr42                      rap(42)
     i              c3sr43                      rap(43)
     i              c3sr21                      rap(21)
     i              c3sr22                      rap(22)
     i              c3sr23                      rap(23)
     i              c3sr51                      rap(51)
     i              c3sr24                      rap(24)
     i              c3sr52                      rap(52)
     i              c3sr25                      rap(25)
     i              c3sr53                      rap(53)
     i              c3sr26                      rap(26)
     i              c3sr54                      rap(54)
     i**>           c3sr55                      rap(55)
     i**>           c3sr56                      rap(56)
     i**>           c3sr57                      rap(57)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Send Alt
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * Bare data
      *
     c     b2tagb        tag
     c                   move      *blank        wwover
      *
     c                   exsr      xdsp01
      *
      * Avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
      *
      * Vis detlaljer
      *
     c                   if        *inkj = *on
     c                   if        ww_detaljer = '1'
     c                   eval      ww_detaljer = '0'
     c                   else
     c                   eval      ww_detaljer = '1'
     c                   endif
      *
     c                   eval      b1valg = *blank
     c                   eval      b1endr = *blank
      *
     c     key01         setll     slpml1
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
      * Forny
      *
     c                   if        *inke = *on
     c                   if        sfrn01 <> *zero
     c     sfrn01        chain     b1sfl                              60
     c                   endif
      *
     c                   move      b1type        wwtype
     c                   move      *zeros        wwkode
     c                   move      *blank        wwvalg
      *
     c     key01         setll     slpml1
      *
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
     c                   if        *inkf = *on
     c                   goto      c1taga
     c                   endif
      *
      * Roll
      *
     c                   if        *in10 = *on
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
      * Home
      *
     c                   if        *in21
     c                   eval      *in22 = *on
     c                   goto      b2taga
     c                   endif
      *
      * Posisjoner
      * startverdi
      *
     c                   if        b2valg = *blank and
     c                             b2type <> *blank
     c                   move      b2type        wwtype
     c     key01         setll     slpml1
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   eval      b2type = *blank
     c                   goto      b2tagb
     c                   endif
      *
      * Sjekk om felt
      * er utfylt
      *
     c                   if        b2valg <> *blank and
     c                             b2type = *blank
     c                   move      *on           *in31
     c                   goto      b2tagb
     c                   endif
      *
      * Slå opp
      * i filen
      *
     c                   move      *blank        wwnavn
     c                   move      *blank        wwslet
      *
      * Bruker-statistikk skal kjøres, hent opplysninger
      *
     c                   if        b2type = '*USER'
     c                   eval      wwslet = 'N'
      *
     c                   eval      b2type = dsuser
     c                   eval      ausrl1_user = b2type
     c     ausrl1_key    chain     ausrl1                             96
     c  n96              move      abnavn        wwnavn
     c                   endif
      *
      * Time-statistikk skal kjøres, hent opplysninger
      *
     c                   if        b2type = '*TIME'
     c                   eval      wwslet = 'N'
      *
      *  Legger inn dagens dato/tid  (hhmmssddmm)
      *
     c                   time                    w_time
     c                   move      *blank        b2type
     c                   movel     w_time        b2type
      *
     c                   eval      ausrl1_user = dsuser
     c     ausrl1_key    chain     ausrl1                             96
     c  n96              move      abnavn        wwnavn
     c                   endif
      *
     c                   move      b2type        wwtype
     c                   move      *zeros        wwkode
     c                   move      *blank        wwvalg
     c     key01         chain     slpml1                             60
      *
      * Post finnes
      * ikke
      *
     c                   if        *in60 = *on
     c                   if        b2valg = '2' or
     c                             b2valg = '3' or
     c                             b2valg = '4' or
     c                             b2valg = '5' or
     c                             b2valg = '6' or
     c                             b2valg = '7' or
     c                             b2valg = '8' or
     c                             b2valg = '9'
     c                   move      *on           *in32
     c                   goto      b2tagb
     c                   endif
     c                   endif
      *
      * Post finnes
      * fra før
      *
     c                   if        *in60 = *off and
     c                             b2valg = '1'
     c                   move      *on           *in33
     c                   goto      b2tagb
     c                   endif
      *
      * Post finnes fra før
      * Bildet viser detaljer
      * Kun sletting tillatt
      *
     c                   if        *in60 = *off and
     c                             ww_detaljer = '1' and
     c                             b2valg <> '4'
     c                   move      *on           *in31
     c                   goto      b2tagb
     c                   endif
      *
      * Opprette
      *
     c                   if        b2valg = '1'
     c                   move      b2type        c1type
     c                   goto      c1taga
     c                   endif
      *
      * Endre
      *
     c                   if        b2valg = '2'
     c                   move      b2type        c1type
     c                   exsr      xc2bld
     c                   goto      b2taga
     c                   endif
      *
      * Kopiere
      *
     c                   if        b2valg = '3'
     c                   move      b2type        k1type
     c                   exsr      xk1win
     c                   goto      b2tagb
     c                   endif
      *
      * Slette
      *
     c                   if        b2valg = '4'
     c                   exsr      xd1win
     c                   goto      b2tagb
     c                   endif
      *
      * Vise
      *
     c                   if        b2valg = '5'
     c                   move      *on           *in30
     c                   move      b2type        c1type
     c                   exsr      xc2bld
     c                   goto      b2taga
     c                   endif
      *
      * Utskrift
      *
     c                   if        b2valg = '6'
     c                   move      *on           *in30
     c                   move      b2type        p0type
     c                   exsr      xp0win
     c                   goto      b2taga
     c                   endif
      *
      * Utvalg
      *
     c                   if        b2valg = '7'
     c                   move      *on           *in30
     c                   move      b2type        c1type
     c                   exsr      xc5bld
     c                   goto      b2tagb
     c                   endif
      *
      * Sorteringsrekkefølge
      *
     c                   if        b2valg = '8'
     c                   move      *on           *in30
     c                   move      b2type        c1type
     c                   exsr      xc3bld
     c                   goto      b2tagb
     c                   endif
      *
      * Summering
      *
     c                   if        b2valg = '9'
     c                   move      *on           *in30
     c                   move      b2type        c1type
     c                   exsr      xc4bld
     c                   goto      b2tagb
     c                   endif
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Behandling av subfile                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Sjekk om valg er foretatt i subfile
      *
     c                   do        ssrn01
     c                   readc     b1sfl                                  16
     c                   if        *in16 = *on
     c                   leave
     c                   endif
      *
      * Bildet viser detaljer
      * Kun sletting tillatt
      *
     c                   if        ww_detaljer = '1' and
     c                             b1valg <> '4'
     c                   move      *on           *in31
     c                   goto      b2tagb
     c                   endif
      *
      * Endre post
      *
     c                   if        b1valg = ' 2' or
     c                             b1valg = '2 '
     c                   move      b1type        c1type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xc2bld
     c                   iter
     c                   endif
      *
      * Kopiere post
      *
     c                   if        b1valg = ' 3' or
     c                             b1valg = '3 '
     c                   move      b1type        k1type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xk1win
     c                   iter
     c                   endif
      *
      * Slette post
      *
     c                   if        b1valg = ' 4' or
     c                             b1valg = '4 '
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xd1win
     c                   iter
     c                   endif
      *
      * Vise post
      *
     c                   if        b1valg = ' 5' or
     c                             b1valg = '5 '
     c                   move      *on           *in30
     c                   move      b1type        c1type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xc2bld
     c                   iter
     c                   endif
      *
      * Utskrift
      *
     c                   if        b1valg = ' 6' or
     c                             b1valg = '6 '
     c                   move      *on           *in30
     c                   move      b1type        p0type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xp0win
     c                   iter
     c                   endif
      *
      * Utvalg
      *
     c                   if        b1valg = ' 7' or
     c                             b1valg = '7 '
     c                   if        b1endr <> 'N'
     c                   move      b1type        c1type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xc5bld
     c                   iter
     c                   endif
     c                   endif
      *
      * Sorteringsrekkefølge
      *
     c                   if        b1valg = ' 8' or
     c                             b1valg = '8 '
     c                   if        b1endr <> 'N'
     c                   move      b1type        c1type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xc3bld
     c                   iter
     c                   endif
     c                   endif
      *
      * Summering
      *
     c                   if        b1valg = ' 9' or
     c                             b1valg = '9 '
     c                   if        b1endr <> 'N'
     c                   move      b1type        c1type
     c                   move      b1type        wwtype
     c                   move      b1kode        wwkode
     c                   move      b1val1        wwvalg
     c                   exsr      xc2bld
     c                   endif
     c                   endif
      *
     c                   enddo
      *
     c                   goto      b2taga
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C1BLD Behandle åpningsbildet for ny post                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     c1taga        tag
      *
     c                   move      *blank        wwover
      *
      * Vis skjermbilde
      *
     c                   exfmt     c1bld
      *
     c     *inkc         cabeq     *on           b2taga
     c     *inkl         cabeq     *on           b2taga
      *
     c                   move      c1type        wwtype

     c                   exsr      xc2bld
      *
      * Utskrift/Utvalg er gjort hopp til hovedbilde
      *
     c                   if        wwover <> *blank
     c                   goto      b2taga
     c                   endif
      *
     c                   goto      c1taga
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C2BLD Behandle bilde for ny - endring - vise                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xc2bld        begsr
      *
      * Legger inn informasjon, pga *USER
      *
     c                   eval      c2text = wwnavn
     c                   eval      c2slet = wwslet
      *
      * Nullstiller felter som benyttes i bilde
      *
     c                   eval      c2srt1 = *zeros
     c                   eval      c2srt2 = *zeros
     c                   eval      c2srt3 = *zeros
     c                   eval      c2stx1 = *blank
     c                   eval      c2stx2 = *blank
     c                   eval      c2stx3 = *blank
     c                   eval      c2endr = *blank
      *
     c                   eval      c4sum1 = *blank
     c                   eval      c4sum2 = *blank
     c                   eval      c4sum3 = *blank
      *
      * Nullstill valg
      *
     c                   eval      n = 1
     c                   dou       n > 60
     c                   eval      rap(n) = *zeros
     c                   eval      n = n + 1
     c                   enddo
      *
      * Hent informasjon fra PARAMETER-REGISTER
      *
     c     key01         chain     slpml1                             60
      *
     c                   if        *in60 = *off
     c                   movel     mld(2)        c2nyen
     c                   movel     srrest        wwrest_00
     c                   move      wwtext_00     c2text
     c                   move      wwslet_00     c2slet
     c                   move      wwendr_00     c2endr
     c                   move      wwsrt1_00     c2srt1
     c                   move      wwsrt2_00     c2srt2
     c                   move      wwsrt3_00     c2srt3
      *
     c                   move      wwsps1_00     c4sps1
     c                   move      wwsps2_00     c4sps2
     c                   move      wwsps3_00     c4sps3
     c                   move      wwsps4_00     c4sps4
     c                   move      wwsps7_00     c4sps7
     c                   move      wwsss1_00     c4sss1
     c                   move      wwsss2_00     c4sss2
     c                   move      wwsss3_00     c4sss3
      *
      * Hent tekster fra tabell
      *
     c                   if        wwsrt1_00 > *zeros
     c                   move      wwsrt1_00     r1
     c                   move      1             rap(r1)
     c                   movel     rpt(r1)       c2stx1
     c                   movel     rpt(r1)       c4sum1
     c                   endif
      *
     c                   if        wwsrt2_00 > *zeros
     c                   move      wwsrt2_00     r2
     c                   move      2             rap(r2)
     c                   movel     rpt(r2)       c2stx2
     c                   movel     rpt(r2)       c4sum2
     c                   endif
      *
     c                   if        wwsrt3_00 > *zeros
     c                   move      wwsrt3_00     r3
     c                   move      3             rap(r3)
     c                   movel     rpt(r3)       c2stx3
     c                   movel     rpt(r3)       c4sum3
     c                   endif
      *
     c                   else
      *
     c                   movel     mld(1)        c2nyen
     c                   endif
      *
     c                   if        *in30 = *on
     c                   movel     mld(3)        c2nyen
     c                   endif
      *
     c     c2tagb        tag
      *
     c                   if        b1valg = ' 9' or
     c                             b1valg = '9 '
     c                   exsr      xc4bld
     c                   else
     c                   exfmt     c2bld
     c                   endif
      *
     c     *inkc         cabeq     *on           c2tag1
     c     *inkl         cabeq     *on           c2tag1
     c     *in30         cabeq     *on           c2tag1
      *
     c     key01         chain     slpmlur                            60
      *
     c                   move      c2text        wwtext_00
     c                   move      c2slet        wwslet_00
     c                   move      c2endr        wwendr_00
     c                   move      c2srt1        wwsrt1_00
     c                   move      c2srt2        wwsrt2_00
     c                   move      c2srt3        wwsrt3_00
      *
     c                   move      c4sps1        wwsps1_00
     c                   move      c4sps2        wwsps2_00
     c                   move      c4sps3        wwsps3_00
     c                   move      c4sps4        wwsps4_00
     c                   move      *blank        wwsps5_00
     c                   move      c4sps7        wwsps7_00
     c                   move      c4sss1        wwsss1_00
     c                   move      c4sss2        wwsss2_00
     c                   move      c4sss3        wwsss3_00
      *
     c                   if        *in60 = *off
     c                   move      'L'           srsyst
     c                   movel     wwrest_00     srrest
     c                   update    slpmlur
      *
     c                   else
      *
     c                   move      *zeros        wwpmnd_00
     c                   move      *zeros        wwpaar_00
     c                   move      *blank        wwsmli_00
     c                   movel     wwrest_00     srrest
     c                   move      wwfirm        srfirm
     c                   move      'L'           srsyst
     c                   move      c1type        srtype
     c                   eval      srvalg = *blanks
     c                   eval      srkode = *zeros
     c                   write     slpmlur
      *
     c                   endif
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 2' or
     c                             b1valg = '2 '
     c                   move      c1type        b1type
     c                   move      c2text        b1text
     c                   endif
      *
     c     c2tag1        tag
      *
     c                   if        b1valg = ' 2' or
     c                             b1valg = '2 ' or
     c                             b1valg = ' 5' or
     c                             b1valg = '5 '
     c                   move      srrn01        svrn01
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
     c                   move      *off          *in30
      *
      * Gå til Utvalg
      *
     c                   if        *inkc <> *on
     c                   if        c2endr <> 'N'
     c                   move      'X'           wwover
     c                   move      c1type        b1type
     c                   move      c2text        b1text
     c                   exsr      xc5bld
     c                   endif
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C3BLB Behandle bilde for sorteringsrekkefølge                   *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xc3bld        begsr
      *
     c     c3taga        tag
      *
      * Nullstiller hele array for vising av sorteringsvalg
      *
     c                   move      *zero         rap
      *
      * Flytt valg til skjermbilde
      *
     c                   move      b1type        c3type
     c                   move      b1text        c3text
     c     key01         chain     slpml1                             60
     c                   movel     srrest        wwrest_00
     c                   if        wwsrt1_00 <> 0
     c                   move      1             rap(wwsrt1_00)
     c                   endif
     c                   if        wwsrt2_00 <> 0
     c                   move      2             rap(wwsrt2_00)
     c                   endif
     c                   if        wwsrt3_00 <> 0
     c                   move      3             rap(wwsrt3_00)
     c                   endif
      *
     c     c3tagb        tag
     c                   exfmt     c3bld
      *
     c     *inkc         cabeq     *on           c3end1
     c     *inkl         cabeq     *on           c3end1
      *
     c                   eval      n = 1
      *
     c                   eval      r1 = 0
     c                   eval      r2 = 0
     c                   eval      r3 = 0
      *
     c                   eval      n1 = *blank
     c                   eval      n2 = *blank
     c                   eval      n3 = *blank
      *
     c                   eval      c2srt1 = *zeros
     c                   eval      c2srt2 = *zeros
     c                   eval      c2srt3 = *zeros
     c                   eval      c2stx1 = *blank
     c                   eval      c2stx2 = *blank
     c                   eval      c2stx3 = *blank
      *
      * Kontroller valg, 1, 2, 3
      *
     c                   dou       n > 60
      *
     c                   if        rap(n) = 1
     c                   eval      r1 = ref(n)
     c                   move      'J'           n1
     c                   endif
      *
     c                   if        rap(n) = 2
     c                   eval      r2 = ref(n)
     c                   move      'J'           n2
     c                   endif
      *
     c                   if        rap(n) = 3
     c                   eval      r3 = ref(n)
     c                   move      'J'           n3
     c                   endif
      *
     c                   eval      n = n + 1
      *
     c                   enddo
      *
      * Minst ett valg
      *
     c                   if        n1 = *blank
     c                   move      *on           *in31
     c                   goto      c3tagb
     c                   endif
      *
      * Hent tekster fra tabell
      *
     c                   if        n1 <> *blank
     c                   move      r1            c2srt1
     c                   movel     rpt(r1)       c2stx1
     c                   endif
      *
     c                   if        n2 <> *blank
     c                   move      r2            c2srt2
     c                   movel     rpt(r2)       c2stx2
     c                   endif
      *
     c                   if        n3 <> *blank
     c                   move      r3            c2srt3
     c                   movel     rpt(r3)       c2stx3
     c                   endif
      *
     c     c3tag1        tag
      *
     c     key01         chain     slpmlur                            60
     c                   move      c2srt1        wwsrt1_00
     c                   move      c2srt2        wwsrt2_00
     c                   move      c2srt3        wwsrt3_00
     c                   movel     wwrest_00     srrest
      *
     c                   if        *in60 = *off
     c                   update    slpmlur
     c                   endif
      *
      * Gå til Summeringsbilde
      *
     c                   if        *inke <> *on
     c                   exsr      xc4bld
     c                   endif
      *
     c     c3end1        tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 8' or
     c                             b1valg = '8 '
     c                   move      srrn01        svrn01
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
     c                   move      *off          *in30
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C4BLD Behandle bilde for spesifikasjonsgrad                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xc4bld        begsr
      *
      * Flytt valg til skjermbilde
      *
     c     c4tagb        tag
      *
     c                   move      b1type        c4type
     c                   move      b1text        c4text
      *
     c                   exfmt     c4bld
      *
     c     *inkc         cabeq     *on           c4tag1
     c     *inkl         cabeq     *on           c4tag1
      *
      * Hent tekster fra tabell
      *
     c                   if        n1 <> *blank
     c                   movel     rpt(r1)       c4sum1
     c                   endif
      *
     c                   if        n2 <> *blank
     c                   movel     rpt(r2)       c4sum2
     c                   endif
      *
     c                   if        n3 <> *blank
     c                   movel     rpt(r3)       c4sum3
     c                   endif
      *
     c     c4tag1        tag
      *
      * Gå til Utskrift
      *
     c                   if        *inke <> *on
     c                   move      c4type        p0type
     c                   move      c4type        b1type
     c                   move      c4text        b1text
     c                   exsr      xp0win
     c                   endif
      *
     c     c4end1        tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 9' or
     c                             b1valg = '9 '
     c                   move      srrn01        svrn01
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
     c                   move      *off          *in30
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C5BLB Behandle bilde for utvalg                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xc5bld        begsr
      *
      * Flytt valg til skjermbilde
      *
     c     c5tagb        tag
      *
     c                   move      b1type        c5type
     c                   move      b1type        wptype
     c                   move      b1text        c5text
     c                   move      b1text        wptext
     c                   eval      c5valg = 0
      *
     c                   exfmt     c5bld
      *
     c     *inkc         cabeq     *on           c5end1
     c     *inkl         cabeq     *on           c5end1
      *
      * Call subprogram avhengig av valg
      *
      * Hovedgruppe
      *
     c                   eval      srvalg = *blanks
     c                   if        c5valg = 11
     c                   call      'SR111R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Undergruppe
      *
     c                   if        c5valg = 12
     c                   call      'SR112R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Rabattgruppe
      *
     c                   if        c5valg = 13
     c                   call      'SR113R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Overgruppe  (Nobb)
      *
     c                   eval      srvalg = *blanks
     c                   if        c5valg = 14
     c                   call      'SR114R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Hovedgruppe (Nobb)
      *
     c                   eval      srvalg = *blanks
     c                   if        c5valg = 15
     c                   call      'SR115R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Undergruppe (Nobb)
      *
     c                   if        c5valg = 16
     c                   call      'SR116R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Leverandørkategori
      *
     c                   if        c5valg = 21
     c                   call      'SR121R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Rabattkategori
      *
     c                   if        c5valg = 22
     c                   call      'SR122R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Distrikt
      *
     c                   if        c5valg = 23
     c                   call      'SR123R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Selger
      *
     c                   if        c5valg = 24
     c                   call      'SR124R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Land
      *
     c                   if        c5valg = 25
     c                   call      'SR125R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Fra/Til varenummer
      *
     c                   if        c5valg = 31
     c                   call      'SR131R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Fra/Til leverandørnummer
      *
     c                   if        c5valg = 32
     c                   call      'SR132R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Fra/Til periode
      *
     c                   if        c5valg = 41
     c                   call      'SR141R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Fra/Til faktura/kreditnotanr.
      *
     c                   if        c5valg = 42
     c                   call      'SR142R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Fra/Til fakturadato
      *
     c                   if        c5valg = 43
     c                   call      'SR143R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Kampanje
      *
     c                   if        c5valg = 44
     c                   call      'SR144R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Ordretype
      *
     c                   if        c5valg = 51
     c                   call      'SR151R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Avdeling
      *
     c                   if        c5valg = 52
     c                   call      'SR152R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Lager
      *
     c                   if        c5valg = 53
     c                   call      'SR153R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
      * Produktansvarlig
      *
     c                   if        c5valg = 54
     c                   call      'SR154R'
     c                   parm                    wptype
     c                   parm                    wptext
     c                   goto      c5tagb
     c                   endif
      *
     c     c5tag1        tag
      *
      * Gå til Sortering
      *
     c                   if        *inke <> *on
     c                   move      wptype        b1type
     c                   move      wptext        b1text
     c                   exsr      xc3bld
     c                   endif
      *
      * Gå til hovedbilde
      *
     c     c5end1        tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 7' or
     c                             b1valg = '7 '
     c                   move      srrn01        svrn01
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
     c                   eval      c5valg = *zero
     c                   move      *off          *in30
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * D1WIN Behandle bilde for slette                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xd1win        begsr
      *
     c     key01         chain     slpml1                             60
      *
     C                   write     s1win
      *
     c                   movel     srrest        wwrest_00
     c                   move      wwtext_00     d1text
      *
     c                   exfmt     d1win
      *
     c     *inkc         cabeq     *on           d1end1
     c     *inkl         cabeq     *on           d1end1
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 4' or
     c                             b1valg = '4 '
     c                   eval      b1text = *blank
     c                   movel     mld(4)        b1text
     c                   endif
      *
     c     d1tag1        tag
      *
     c                   if        b1valg = ' 4' or
     c                             b1valg = '4 '
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
      *
      * Slett parametre
      *
     c                   if        ww_detaljer = '1'
      *
     c     key01         chain     slpmlur                            61
     c                   delete    slpmlur
      *
     c                   else
      *
     c     key02         reade     slpmlur                                61
     c     key02         setll     slpmlur
     c     key02         reade     slpmlur                                61
     c                   dow       *in61 = *off
     c                   delete    slpmlur
     c     key02         reade     slpmlur                                61
     c                   enddo
      *
     c                   endif
      *
     c     d1end1        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * K1WIN Behandle bilde for kopiere                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xk1win        begsr
      *
     c     key01         chain     slpml1                             60
      *
     c                   movel     srrest        wwrest_00
     c                   move      wwtext_00     k1text
      *
     c                   write     s1win
      *
     c     k1tagb        tag
      *
     c                   exfmt     k1win
      *
     c     *inkc         cabeq     *on           k1end1
     c     *inkl         cabeq     *on           k1end1
      *
      * Post er ikke utfyllt
      *
      * Slå opp i filen
      *
     c                   move      k1type        wwtype
     c     key01         chain     slpml1                             60
      *
      * Post finnes fra før
      *
     c                   if        *in60 = *off
     c                   move      *on           *in33
     c                   goto      k1tagb
     c                   endif
      *
      * Oppdater file
      *
     c     key01         chain     slpmlur                            60
     c                   move      k1type        srtype
     c                   movel     wwrest_00     srrest
     c                   write     slpmlur
      *
     c     k1tag1        tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 3' or
     c                             b1valg = '3 '
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
     c                   eval      k1type = *blank
      *
     c     k1end1        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * P0WIN Behandle bilde for utskrift                               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xp0win        begsr
      *
     c                   eval      wwkode = *zeros
     c                   eval      wwvalg = *blank
      *
     c                   write     s1win
      *
     c                   exfmt     p0win
      *
     c     *inkc         cabeq     *on           p0tag1
     c     *inkl         cabeq     *on           p0tag1
      *
      * Velg hvilken utskrift som skal benyttes
      *
      *
      * Utskrift av innkjøps-statistikk
      *
     c                   if        p0valg = '10'
     c                   eval      dstype = p0type
     c                   eval      wwtype = p0type
     c                   exsr      xp1win
      *
     c     *inkc         cabeq     *on           p0tag1
     c     *inkl         cabeq     *on           p0tag1
      *
     c                   call      'SI610C'
     c                   parm                    dstype
      *
     c                   endif
      *
      * Utskrift av mengdestatistikk - m3
      *
     c                   if        p0valg = '11'
     c                   eval      dstype = p0type
     c                   eval      wwtype = p0type
     c                   exsr      xp3win
      *
     c     *inkc         cabeq     *on           p0tag1
     c     *inkl         cabeq     *on           p0tag1
      *
     c                   call      'SI620C'
     c                   parm                    dstype
      *
     c                   endif
      *
     c     p0tag1        tag
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
     c                   eval      b1valg = *blank
      *
     c                   if        wwover = *blank
     c                   move      srrn01        svrn01
     c                   update    b1sfl
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * P1WIN Behandle bilde for parameter                              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xp1win        begsr
      *
     c                   eval      wwtype = dstype
     c                   eval      wwkode = 41
     c                   eval      wwvalg = *blank
     c     key01         chain     slpml1                             60
      *
     c                   write     s1win
      *
     c                   if        *in60 = *off
     c                   movel     srrest        wwrest_41
     c                   eval      p1fmnd = 01
     c                   eval      p1faar = wwtaar_41
     c                   eval      p1tmnd = wwtmnd_41
     c                   eval      p1taar = wwtaar_41
     c                   else
     c                   eval      p1fmnd = 01
     c                   eval      p1faar = *year
     c                   eval      p1tmnd = *month
     c                   eval      p1taar = *year
     c                   endif
      *
     c                   exfmt     p1win
      *
     c     *inkc         cabeq     *on           p1tag1
     c     *inkl         cabeq     *on           p1tag1
      *
     c     key01         chain     slpmlur                            60
      *
     c                   eval      wwfmnd_41 = p1fmnd
     c                   eval      wwfaar_41 = p1faar
     c                   eval      wwtmnd_41 = p1tmnd
     c                   eval      wwtaar_41 = p1taar
     c                   movel     wwrest_41     srrest
      *
     c                   if        *in60 = *off
     c                   update    slpmlur
     c                   else
     c                   eval      srtype = dstype
     c                   eval      srkode = 41
     c                   eval      srvalg = *blank
     c                   write     slpmlur
     c                   endif
      *
     c     p1tag1        tag
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * P2WIN Behandle bilde for parameter                              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xp2win        begsr
      *
     c                   eval      wwkode = *zeros
     c                   eval      wwvalg = *blank
     c     key01         chain     slpml1                             60
      *
     c                   write     s1win
      *
     c                   if        *in60 = *off
     c                   movel     srrest        wwrest_00
     c                   eval      p2pmnd = *month
     c                   eval      p2paar = *year
     c                   eval      p2smli = wwsmli_00
     c                   endif
      *
     c                   exfmt     p2win
      *
     c     *inkc         cabeq     *on           p2tag1
     c     *inkl         cabeq     *on           p2tag1
      *
     c     key01         chain     slpmlur                            60
      *
     c                   if        *in60 = *off
     c                   eval      wwpmnd_00 = p2pmnd
     c                   eval      wwpaar_00 = p2paar
     c                   eval      wwsmli_00 = p2smli
     c                   movel     wwrest_00     srrest
     c                   update    slpmlur
     c                   endif
      *
      * Oppdater kode 41 for utplukk
      *
     c                   eval      wwtmnd_41 = p2pmnd
     c                   eval      wwtaar_41 = p2paar
      *
     c                   if        p2smli = 'F'
     c                   eval      wwfmnd_41 = 01
     c                   eval      wwfaar_41 = p2paar - 1
     c                   else
     c                   eval      wwfmnd_41 = 01
     c                   eval      wwfaar_41 = p2paar
     c                   endif
      *
     c                   eval      wwkode = 41
     c     key01         chain     slpmlur                            60
      *
     c                   movel     wwrest_41     srrest
      *
     c                   if        *in60 = *off
     c                   update    slpmlur
     c                   else
     c                   eval      srtype = dstype
     c                   eval      srkode = 41
     c                   eval      srvalg = *blank
     c                   write     slpmlur
     c                   endif
      *
     c     p2tag1        tag
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * P3WIN Behandle bilde for parameter                              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xp3win        begsr
      *
     c                   eval      wwkode = *zeros
     c                   eval      wwvalg = *blank
     c     key01         chain     slpml1                             60
      *
     c                   write     s1win
      *
     c                   if        *in60 = *off
     c                   movel     srrest        wwrest_00
     c                   eval      p3pmnd = *month
     c                   eval      p3paar = *year
     c                   endif
      *
     c                   exfmt     p3win
      *
     c     *inkc         cabeq     *on           p3tag1
     c     *inkl         cabeq     *on           p3tag1
      *
     c     key01         chain     slpmlur                            60
      *
     c                   if        *in60 = *off
     c                   eval      wwpmnd_00 = p3pmnd
     c                   eval      wwpaar_00 = p3paar
     c                   movel     wwrest_00     srrest
     c                   update    slpmlur
     c                   endif
      *
      * Oppdater kode 41 for utplukk
      *
     c                   eval      wwtmnd_41 = p3pmnd
     c                   eval      wwtaar_41 = p3paar
      *
     c                   eval      wwfmnd_41 = 01
     c                   eval      wwfaar_41 = p3paar - 1
      *
     c                   eval      wwkode = 41
     c     key01         chain     slpmlur                            60
      *
     c                   movel     wwrest_41     srrest
      *
     c                   if        *in60 = *off
     c                   update    slpmlur
     c                   else
     c                   eval      srtype = dstype
     c                   eval      srkode = 41
     c                   eval      srvalg = *blank
     c                   write     slpmlur
     c                   endif
      *
     c     p3tag1        tag
      *
     c                   eval      b2valg = *blank
     c                   eval      b2type = *blank
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Tøm subfile                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xclr01        begsr
      *
     c                   move      *on           *in14
     c                   write     b2ctl
     c                   move      *off          *in14
      *
     c                   move      *off          *in15
     c                   eval      srrn01 = 0
     c                   eval      sfrn01 = 0
     c                   eval      ssrn01 = 0
     c                   eval      spge01 = 0
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Fyll opp subfile                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xcrt01        begsr
      *
     c                   eval      spge01 = spge01 + 13
     c                   eval      srrn01 = ssrn01
      *
     c                   dou       srrn01 = spge01
      *
     c     les01         tag
      *
     c                   read      slpml1                                 15
      *
     c     *in15         cabeq     *on           xend01
      *
     c                   if        srsyst = 'K'
     c                   goto      les01
     c                   endif
      *
     c                   if        srkode <> 00
     c                             and ww_detaljer = '0'
     c                   goto      les01
     c                   endif
5.41  *
5.41  * Sjekker om aktuelt firma
5.41  *
5.41 c                   if        srfirm <> wwfirm
5.41 c                   goto      les01
5.41 c                   endif
      *
     c                   eval      srrn01 = srrn01 + 1
     c                   move      srtype        b1type
     c                   move      srkode        b1kode
     c                   move      srvalg        b1val1
     c                   movel     srrest        wwrest_00
     c                   move      wwtext_00     b1text
     c                   move      wwendr_00     b1endr
     c                   write     b1sfl
     c                   enddo
      *
     c     xend01        tag
      *
     c                   if        srrn01 > ssrn01
     c                   eval      sfrn01 = ssrn01 + 1
     c                   endif
      *
     c                   eval      ssrn01 = srrn01
     c                   eval      svrn01 = sfrn01
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Display subfile                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xdsp01        begsr
      *
     c                   if        srrn01 <> 0
     c                   move      *on           *in12
     c                   endif
      *
     c                   move      *on           *in13
     c                   exfmt     b2ctl
     c                   move      *off          *in12
     c                   move      *off          *in13
     c                   move      *off          *in22
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
     c     *like         define    srtype        dstype
      *
      * Key for posisjonering på bruker
      *
     c     ausrl1_key    klist
     c                   kfld                    ausrl1_user
      *
      * Key for file nummerisk
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwtype
     c                   kfld                    wwkode
     c                   kfld                    wwvalg
      *
      * Key for sleting
      *
     c     key02         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwtype
      *
     c                   move      dsfirm        wwfirm
     c                   eval      srfirm =  wwfirm
     c                   eval      wwtype = *blank
     c                   eval      wwkode = *zeros
     c                   eval      wwvalg = *blank
     c                   eval      ww_detaljer = '0'
      *
      * Bygg opp referansetabell
      *
     c                   eval      n = 1
      *
     c                   dou       n > 60
     c                   eval      ref(n) = n
     c                   eval      n = n + 1
     c                   enddo
      *
     c                   eval      *in21 = *on
     c                   eval      *in22 = *on
      *
     c     key01         setll     slpml1
      *
     c                   exsr      xcrt01
      *
     c                   endsr
      *
      **********************  T A B E L L E R  ***************************
**
  Ny post                  001
  Endring                  002
  Vise                     003
* Slettet *                004
**  SORTERINGSREKKEFØLGE
Ledig 01                   01
Ledig 02                   02
Ledig 03                   03
Ledig                      04
Ledig                      05
Ledig                      06
Ledig                      07
Ledig                      08
Ledig                      09
Ledig                      10
Hovedgruppe                11
Undergruppe                12
Rabattgrp.                 13
Overgruppe  (Nobb)         14
Hovedgruppe (Nobb)         15
Undergruppe (Nobb)         16
Ledig                      17
Ledig                      18
Ledig                      19
Ledig                      20
Leverandørkategori         21
Rabattkateg.               22
Distrikt                   23
Selger                     24
Land                       25
Hgr.-leverandørkategori    26
Ledig                      27
Ledig                      28
Ledig                      29
Ledig                      30
Varenummer                 31
Leverandør                 32
Ledig                      33
Ledig                      34
Ledig                      35
Ledig                      36
Ledig                      37
Ledig                      38
Ledig                      39
Ledig                      40
Periode                    41
Faktnr/Krednr              42
Fakturadato                43
Kapmanje                   44
Ledig                      45
Ledig                      46
Ledig                      47
Ledig                      48
Ledig                      49
Ledig                      50
Ordretype                  51
Avdeling                   52
Lager                      53
Produktansvarlig           54
Ledig                      55
Ledig                      56
Ledig                      57
Ledig                      58
Ledig                      59
Ledig                      60
