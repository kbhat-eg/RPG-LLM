Program Header  
- H-Specification:  
  • option(*NODEBUGIO) – disable debug I/O  
  • datedit(*DMY)     – date format DD-MM-YYYY  

File Declarations (F-Specs)  
- FRLEVL1, FVOGRL1, FVHGRL1, FVUGRL1 – physical files, externally described, keyed, disk files, renamed for local use (e.g. RLEVL1R)  
- FJO100D – display file (workstation) for screen I/O  

Data Definitions (D-Specs)  
1. UDS (Local Data Area)  
   • l_FIRM (positions 944–946 in LDA) – company number  
2. Local Variables  
   • b_FEIL        – error indicator (1 byte, default *OFF)  
   • w_POSI        – numeric position from CHECK  
   • w_VA1F, w_VA1T – 15-char start/end item numbers  
   • w_FIRM, w_LDOR, w_LNAV, w_UTXT – work fields mirroring record layouts  
3. Key-List Variables for File Lookups  
   • rlevl1_levr  – supplier number key for RLEVL1  
   • vogrl1_oogr  – over-group key for VOGRL1  
   • vhgrl1_hogr, vhgrl1_hhgr – main-group keys for VHGRL1  
   • vugrl1_uogr, vugrl1_uhgr, vugrl1_uugr – sub-group keys for VUGRL1  
4. Constants  
   • DIGITS = '0123456789' – used to test numeric input  

Main Processing Loop  
1. Label B1TAG – entry point for screen cycle  
2. EXFMT B1BLD – display the screen (B1BLD), wait for user action  
3. Function-Key Handling (SELECT/WHEN)  
   • *INKC or *INKL (e.g. PF3/4) → GOTO AVSLUTT (exit)  
   • *INKD (e.g. PF12) → EXSR SPØRRING (lookup) then return to B1TAG  
4. Input Validation  
   • EXSR SJEKK_INPUT – run validation subroutine  
   • If b_FEIL = *ON → redisplay screen (goto B1TAG)  
5. Prepare Range Fields  
   • Convert numeric b1VA1F/T to character w_VA1F/T or blank if zero  
6. Call Matching Program JO101R  
   • Pass parameters: w_FIRM, b1LDOR, b1OGRP, b1HGRP, b1UGRP, w_VA1F, w_VA1T, b1KODE  
7. Loop back to B1TAG  

Exit (AVSLUTT)  
- Set *INLR = *ON and RETURN  

Subroutine SPØRRING (Lookup Inquiries)  
- Triggered by *INKD on screen  
- w_AFLD tells which field the user is in (e.g. 'B1LDOR', 'B1OGRP', 'B1HGRP', 'B1UGRP')  
1. Supplier (B1LDOR)  
   • Move b1LDOR→w_LDOR, CALL RL500R (supplier lookup), return value in w_LNAV, move w_LDOR→b1LDOR  
2. Over-Group (B1OGRP)  
   • Reset b1HGRP, b1UGRP, CALL VG510R, get description w_UTXT  
3. Main-Group (B1HGRP)  
   • Reset b1UGRP, CALL VG511R, get w_UTXT  
4. Sub-Group (B1UGRP)  
   • CALL VG512R, get w_UTXT  

Subroutine SJEKK_INPUT (Validate Input Fields)  
- Initialize b_FEIL = *OFF  
1. Supplier Field (b1LDOR)  
   • If not '*BL' and not blank → CHECK b1LDOR against DIGITS to ensure numeric  
   • CHAIN on RLEVL1R (company + supplier)  
     – If not found (*IN91) → set *IN31, b_FEIL = *ON  
2. Over-Group (b1OGRP > 0)  
   • CHAIN on VOGRL1R (company + over-group)  
     – If not found (*IN32) → b_FEIL = *ON  
3. Main-Group (b1HGRP > 0)  
   • Set vhgrl1_hogr = b1OGRP, vhgrl1_hhgr = b1HGRP  
   • CHAIN on VHGRL1R → error if *IN33  
4. Sub-Group (b1UGRP > 0)  
   • Set vugrl1_uogr/uhgr/uugr = b1OGRP/b1HGRP/b1UGRP  
   • CHAIN on VUGRL1R → error if *IN34  
5. Item Number Range (b1VA1F/T)  
   • If end = 0 → move start to end  
   • If start > end → set *IN35, b_FEIL = *ON  

Initialization (*INZSR – commented out)  
- Defines key lists for file access (RLEVL1_KEY, VOGRL1_KEY, VHGRL1_KEY, VUGRL1_KEY)  
- Loads company number from LDA into w_FIRM