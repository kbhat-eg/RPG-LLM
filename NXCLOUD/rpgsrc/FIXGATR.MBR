      /TITLE  Gjør om gammel kid til ny kid    (LANG)
     h dftname(nh120r) datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * System. . . . . : ASOKON                                        *     *
      * Program . . . . : NH120R                                        *
      * Beskrivelse . . : Konvertering
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
6.31  * 220316 nho  Feil med nøkkel (ikke firma 0)
6.32  *K00 300620 bof  Feil med nøkkel (ikke firma 0)  II
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     fgatrpf    uf   e           k disk
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
      *
     d                uds
     d l_wsid                901    910
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
      *
     d w_reco          s                   like(gbreco)
      *
     d rkunl1_kund     s                   like(rkkund)
     d rkunl1_firm     s                   like(rkfirm)
     d w_firm          s                   like(rkfirm)
      *
      *
      *
T5.00d w_kid1          ds            80
T5.00d  x_felt1               54     59  0
     d  x_felt2               60     65  0
     d  x_felt3               66     67  0
     d  x_felt4               68     74  0
6.nu d  x_felt5               75     80  0
      *
      *
      *
T5.00d datas           ds            80
     d  bny                    1      2
     d  btjty                  3      4  0
     d  btrty                  5      6  0
T5.00d  w_felt3                1      6  0
     d  brety                  7      8  0
6.30 d  btest                 50     65
6.32 d  btest2                50     56
     d  bkid                  50     74  0
     d  w_felt1               54     59  0
     d  bnfir                 54     56  0
     d  bkund                 62     67  0
6.nu d  w_felt2               68     74  0
      *
     c     dummy         tag
     c                   read      gatrpfr                                60                   60
     c                   if        *in60 = '1'
     c                   eval      *inlr = '1'
     c                   goto      slutt
     c                   endif
      *
     c                   eval      datas = gbreco
     c                   eval      w_kid1 = gbreco
      *
     c                   if        bny = 'NY' and
     c                             btjty = 09 and
     c*                            btrty = 10 and
     c                             brety = 30
      *
6.32 c                   if        btest = *blank  or
6.32 c                             btest2 = *blank
     c                   goto      dummy
     c                   endif
      *
     c                   eval      rkunl1_firm = l_firm
     c                   eval      rkunl1_kund = bkund
     c     rkunl1_key    chain     rkunl1r
      *
     c                   if        not%found
     c                   if        l_firm <> bnfir
     c                   goto      dummy
     c                   endif
     c                   endif
     c                   endif
      *                                                                 .
6.31 c                   if        btest = *blank
6.31 c                   goto      dummy
6.31 c                   endif
      *
     c                   if        %found
     c                   if        l_firm = bnfir
      * Er dette en kunde så gjør om til ny kid
     c                   eval      x_felt1 = w_felt1
     c                   eval      x_felt2 = bkund
     c                   eval      x_felt3 = 00
     c                   z-add     w_felt2       x_felt4
     c                   move      w_kid1        gbreco
     c                   update    gatrpfr
     c                   goto      dummy
     c                   endif
     c                   endif
      *
     c     slutt         tag
      *
      *
     c     rkunl1_key    klist
6.31 c*                  kfld                    w_firm
     c                   kfld                    rkunl1_firm
     c                   kfld                    rkunl1_kund
      *
