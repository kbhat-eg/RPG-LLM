     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RH981R                                              *
      * Beskrivelse . . : Utplukk av hovedboksposter                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frhtrpf    ip   e           k disk
     fre0ipf    o    e           k disk
      *
      * Hovedboksposter
      *
     d                 ds
     d wpcin1                       256
     d  tjxkto                        6  0 overlay(wpcin1)                      Konto
     d  tjxavd                        5  0 overlay(wpcin1:7)                    Avdeling
     d  tjxgrp                        4  0 overlay(wpcin1:12)                   Varegruppe
6.NU d  tjxbil                        8  0 overlay(wpcin1:16)                   Bilags-nr.
6.NU d  tjxdat                        6  0 overlay(wpcin1:25)                   Bilags-dato
6.NU d  tjxtko                        2  0 overlay(wpcin1:31)                   Bilags-kode
6.NU d  tjxtxt                       20    overlay(wpcin1:33)                   Bilags-tekst
6.NU d  tjxupr                       13    overlay(wpcin1:53)                   Utspris
6.NU d  tjxftg                        1    overlay(wpcin1:66)                   Beløp
6.NU d  tjxbel                       12    overlay(wpcin1:67)                   Beløp
     d   tjxØre                       2    overlay(tjxbel:11)                   ØRE
6.NU d  tjxfor                        6  0 overlay(wpcin1:79)                   Forfall
6.NU d  tjxref                        6  0 overlay(wpcin1:85)                   Referanse-nr.
6.NU d  tjxavg                        2  0 overlay(wpcin1:91)                   Avgiftskode
6.NU d  tjxrko                        2  0 overlay(wpcin1:93)                   Status
6.NU d  tjxrab                       10  0 overlay(wpcin1:95)                   Rabatt
6.NU d  tjxkid                       26  0 overlay(wpcin1:105)                  Kunde-ident
6.NU d  tjxtyp                        1    overlay(wpcin1:131)                  Kontotype
      *
     d                 ds
     d wbbida                         8  0
     d  rbbilÅ                        4  0 overlay(wbbida)
     d   wbbilÅ                       2  0 overlay(rbbilÅ:3)
     d  rbbilm                        2  0 overlay(wbbida:5)
     d  rbbild                        2  0 overlay(wbbida:7)
      *
      * Datastruktur for kid-feltet
     d                 ds
     d dskkid                        21
     d  dskkus                       20    overlay(dskkid)
     d  dskmod                        1  0 overlay(dskkid:21)
      *
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * LOCAL DATA
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      *
      *  Parameter i LDA
     d                uds
     d rhpkda                300    305  0
     d rhprÅr                         4  0
     d rhpper                         2  0
     d rhppef                         2  0
     d rhppet                         2  0
     d rhpavf                         4  0
     d rhpavt                         4  0
     d rhpktf                         5  0
     d rhpktt                         5  0
     d rhpsrt                         1
     d rhpsml                         1
     d rhpavv                         1
     d rhpkgs                         1
     d rhpkks                         1
     d rhpsps                         1
     d rhpktu                         1
     d rhpk01                         5  0
     d rhpk02                         5  0
     d rhpk03                         5  0
     d rhpk04                         5  0
     d rhpk05                         5  0
     d rhpk06                         5  0
     d rhpk07                         5  0
     d rhpk08                         5  0
     d rhpk09                         5  0
     d rhpk10                         5  0
     d rhpk11                         5  0
     d rhpk12                         5  0
     d rhpk13                         5  0
     d rhpk14                         5  0
     d rhpk15                         5  0
     d rhpk16                         5  0
     d rhpk17                         5  0
     d rhpk18                         5  0
     d rhpk19                         5  0
     d rhpk20                         5  0
     d rhpk21                         5  0
     d rhpk22                         5  0
     d rhpk23                         5  0
     d rhpk24                         5  0
     d rhpk25                         5  0
     d rhpk26                         5  0
     d rhpk27                         5  0
     d rhpk28                         5  0
     d rhpk29                         5  0
     d rhpk30                         5  0
     d rhpk31                         5  0
     d rhpk32                         5  0
     d rhpk33                         5  0
     d rhpk34                         5  0
     d rhpk35                         5  0
     d rhpk36                         5  0
     d rhpk37                         5  0
     d rhpk38                         5  0
     d rhpk39                         5  0
     d rhpk40                         5  0
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d Ører            s              2  0
     d ftegn           s              1
     d gavde           s                   like(rbavde)
     d gbilÅ           s                   like(rbbilÅ)
     d gbild           s                   like(rbbild)
     d gbilk           s                   like(rbbilk)
     d gbilm           s                   like(rbbilm)
     d gbiln           s                   like(rbbiln)
     d gfirm           s                   like(rbfirm)
     d gjour           s                   like(rbjour)
     d gkont           s                   like(rbkont)
     d gmvak           s                   like(rbmvak)
     d gmvao           s                   like(rbmvao)
     d gneto           s                   like(rbneto)
     d graar           s                   like(rbraar)
     d grper           s                   like(rbrper)
     d gspes           s                   like(rbspes)
     d gtist           s                   like(rbtist)
     d gtext           s                   like(rbtext)
     d kroner          s              9  0
     d wbbelØ          s                   like(rbneto)
     d wbmvak          s              2  0
     d wpkid           s             25
      *
      * Les hovedboks-transaksjoner
      *
     c     les           tag
      *
     c                   if        rbfirm <> l_firm                                      .....
     c                   if        rbfirm > l_firm                                           .
     c                   eval      *inlr = *on                                               .
     c                   endif                                                               .
     c                   goto      slutt                                                     .
     c                   endif                                                           .....
      *
      * Sjekk om transaksjonen skal behandles
      *
      * Sjekk riktig år
      *
     c                   if        rbraar <> rhprÅr                                      .....
     c                   goto      slutt                                                     .
     c                   endif                                                           .....
      *
      * Sjekk periode er <> periode
      *
     c                   if        rbrper <> rhppef                                      .....
     c                   goto      slutt                                                     .
     c                   endif                                                           .....
      *
      * Behandling av utvalgte poster
      *
     c                   eval      dskkid = *blank
     c                   move      rbkont        dskkus
     c                   move      dskkid        wpkid
     c                   call      'ASMX10'
     c                   parm                    wpkid
     c                   move      wpkid         tjxkto
     c                   move      rbavde        tjxavd
     c                   eval      tjxgrp = *zeros
     c                   move      rbbiln        tjxbil
     c                   move      wbbida        tjxdat
     c                   move      wbbilÅ        tjxdat
     c                   movel     rbbild        tjxdat
     c                   move      rbbilk        tjxtko
     c                   move      rbtext        tjxtxt
     c                   eval      tjxupr = *zeros
     c                   move      '.00'         tjxupr
     c                   eval      wbbelØ = rbneto + rbmvab
     c                   eval      wbbelØ = wbbelØ + rbinvb
     c                   eval      ftegn = *zeros
      *
     c                   if        wbbelØ < *zeros
     c                   eval      wbbelØ = 0 - wbbelØ
     c                   move      '-'           ftegn
     c                   endif
      *
     c                   movel     wbbelØ        kroner
     c                   move      wbbelØ        Ører
     c                   eval      tjxbel = *zeros
     c                   move      '.00'         tjxbel
     c                   movel     kroner        tjxbel
     c                   move      Ører          tjxØre
     c                   movel     ftegn         tjxftg
     c                   eval      tjxfor = *zeros
     c                   eval      tjxref = *zeros
     c                   eval      wbmvak = *zeros
     c                   move      rbmvak        wbmvak
      *
     c                   if        rbmvak = '1'
     c                   move      2             wbmvak
     c                   endif
      *
     c                   if        rbmvak = '2'
     c                   move      3             wbmvak
     c                   endif
      *
     c                   if        rbmvak = '3'
     c                   move      5             wbmvak
     c                   endif
      *
     c                   if        rbmvak = '4'
     c                   move      6             wbmvak
     c                   endif
      *
     c                   if        rbmvak = '6'
     c                   move      7             wbmvak
     c                   endif
      *
     c                   move      wbmvak        tjxavg
     c                   move      '4'           tjxtyp
     c                   move      wpcin1        rpcin1
      *
     c                   write     re0ipfr
      *
     c     slutt         tag
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      *  Definisjon av arbeidsfelt
      *
      *
     c                   eval      tjxkto = *zeros
     c                   eval      tjxavd = *zeros
     c                   eval      tjxgrp = *zeros
     c                   eval      tjxbil = *zeros
     c                   eval      tjxdat = *zeros
     c                   eval      tjxtko = *zeros
     c                   eval      tjxfor = *zeros
     c                   eval      tjxbil = *zeros
     c                   eval      tjxref = *zeros
     c                   eval      tjxavg = *zeros
     c                   eval      tjxrko = *zeros
     c                   eval      tjxrab = *zeros
     c                   eval      tjxkid = *zeros
      *
     c                   endsr
