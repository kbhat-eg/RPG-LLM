     h/title  Vedlikehold kunderegister - autogiro
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK818R                                              *
      * Beskrivelse . . : Vedlikehold kundeposteringer - autogiro             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
6.10  * R6.10     070510  Ensdret sporingsfunksjonalitet                 BSA  *
6.30  * R6.30     290216  Justert i skjermbildet pga jacada              BSA  *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                 *
      *  Bruk av indikatorer                                            *
      *                                                                 *
      *       kc = f3  = exit                                           *
      *       ke = f5  = forny                                          *
      *       kl = f12 = annuller                                       *
      *                                                                 *
      *       lr = avslutt program                                      *
      *       10 = roll                                                 *
      *       12 = sfldsp                                               *
      *       13 = sfldspctl                                            *
      *       14 = sflclr                                               *
      *       15 = sflend                                               *
      *       16 = readc 16 on, no more records                         *
      *       30 = protect av felter ved vise                           *
      *    31-59 = varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = fileindikatorer chain etc.                           *
      *    70-79 = arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = arbeidsindikatorer ordinære                          *
      *    90-99 = benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frkunpf    if   e           k disk
     frkunl2    if   e           k disk    rename(rkunpfr:rkunl2r)
     frkunl3    if   e           k disk    rename(rkunpfr:rkunl3r)
     frkunlu    uf   e           k disk    rename(rkunpfr:rkunlur)
     frkwcpf    if   e           k disk    rename(rktrpfr:rkwcpfr)
     fraa1pf    if   e           k disk
     frk818d    cf   e             workstn
     f                                     sfile(b1wsf1:srrn01)
     f                                     sfile(b1wsf2:srrn01)
      *
     d mld             s             11    dim(4) ctdata perrcd(1)               meldinger
     d wpf             s              1    dim(30)                               alfa-konv
      *
     d                 ds
     d rablda                       128                                         hele utvekslingsfelt
     d  rabsta                        1    overlay(rablda)                      u:  utgått
     d  rabfir                        3  0 overlay(rablda:2)                    firma
     d  rabf01                        5  0 overlay(rablda:5)                    fri/ledig 001
     d  rabkod                        1  0 overlay(rablda:10)                   kode
     d  rabtxt                       20    overlay(rablda:11)                   beskrivende tekst
     d  rabf02                       98    overlay(rablda:31)                   fri/ledig 002
     d                 ds
     d raclda                       128                                         hele utvekslingsfelt
     d  racsta                        1    overlay(raclda)                      u:  utgått
     d  racfir                        3  0 overlay(raclda:2)                    firma
     d  racf01                        4  0 overlay(raclda:5)                    fri/ledig 001
     d  rackod                        2  0 overlay(raclda:9)                    betalingsbetingelse
     d  ractxt                       20    overlay(raclda:11)                   tekstfelt
     d  racdag                        3  0 overlay(raclda:31)                   dager
     d  racrab                        4  2 overlay(raclda:34)                   rabatt
     d  racjan                        3    overlay(raclda:38)                   ja/nei (fri levm)
     d  ractx2                       20    overlay(raclda:41)                   utfyllende tekst
     d  racda1                        3  0 overlay(raclda:61)                   dager kredit1
     d  racda2                        3  0 overlay(raclda:64)                   dager kredit2
     d  racra2                        4  2 overlay(raclda:67)                   rabatt kredit2
     d  racda3                        3  0 overlay(raclda:71)                   dager kredit3
     d  racra3                        4  2 overlay(raclda:74)                   rabatt kredit3
     d  racf02                       27    overlay(raclda:78)                   fri/ledig 002
     d  raceda                        8  0 overlay(raclda:105)                  endringsdato (ÅÅÅÅmm
     d  raceti                        6  0 overlay(raclda:113)                  endringstid  (tt:mm:
     d  racesi                       10    overlay(raclda:119)                  endret av    (user-i
     d                 ds
     d raglda                       159                                         hele utvekslingsfelt
     d  ragsta                        1    overlay(raglda)                      u:  utgått
     d  ragfir                        3  0 overlay(raglda:2)                    firma
     d  ragf01                        2  0 overlay(raglda:5)                    fri/ledig 001
     d  ragkod                        4  0 overlay(raglda:7)                    avdeling
     d  ragtxt                       20    overlay(raglda:11)                   beskrivende tekst
     d  ragpÅt                        1    overlay(raglda:31)                   type sats
     d  ragsat                        7  2 overlay(raglda:32)                   sats (p/%)
     d  ragf02                        2    overlay(raglda:39)                   fri/ledig 002
     d  ragmef                        3  0 overlay(raglda:41)                   med-post firma
     d  ragmek                        5  0 overlay(raglda:44)                   med-post konto
     d  ragmes                        2  0 overlay(raglda:49)                   med-post spes
     d  ragmea                        4  0 overlay(raglda:51)                   med-post avd.
     d  ragf03                       11    overlay(raglda:55)                   fri/ledig 003
     d  ragmof                        3  0 overlay(raglda:66)                   mot-post firma
     d  ragmok                        5  0 overlay(raglda:69)                   mot-post konto
     d  ragmos                        2  0 overlay(raglda:74)                   mot-post spes.
     d  ragmoa                        4  0 overlay(raglda:76)                   mot-post avd.
     d  ragf04                       11    overlay(raglda:80)                   fri/ledig 004
     d  ragkta                        1    overlay(raglda:91)                   kontroll avd.
     d  ragprf                        4    overlay(raglda:92)                   profitsenter
     d  ragadr                       30    overlay(raglda:96)                   postadresse
     d  ragpnr                        4  0 overlay(raglda:126)                  postnummer
     d  ragste                       30    overlay(raglda:130)                  poststed
     d                 ds
     d railda                       128                                         hele utvekslingsfelt
     d  raista                        1    overlay(railda)                      u:  utgått
     d  raifir                        3  0 overlay(railda:2)                    firma
     d  raif01                        2  0 overlay(railda:5)                    fri/ledig 001
     d  raikod                        4  0 overlay(railda:7)                    selger
     d  raitxt                       20    overlay(railda:11)                   beskrivende tekst
     d  raikto                        6  0 overlay(railda:31)                   konto
     d  rairsk                        6  0 overlay(railda:37)                   reskontro
     d  raimva                        1  0 overlay(railda:43)                   mva-kode
     d  raiprk                        1  0 overlay(railda:44)                   provisjonskode
     d  raiblk                        2  0 overlay(railda:45)                   bilagskode
     d  raisa2                        2  0 overlay(railda:47)                   sats 2
     d  raisa3                        2  0 overlay(railda:49)                   sats 3
     d  raisa4                        2  0 overlay(railda:51)                   sats 4
     d  raisa5                        2  0 overlay(railda:53)                   sats 5
     d  raif03                       46    overlay(railda:55)                   fri/ledig 003
     d  raiusr                       10    overlay(railda:119)                  bruker-id
     d                 ds
     d raklda                       128                                         hele utvekslingsfelt
     d  raksta                        1    overlay(raklda)                      u:  utgått
     d  rakfir                        3  0 overlay(raklda:2)                    firma
     d  rakf01                        4  0 overlay(raklda:5)                    fri/ledig 001
     d  rakkod                        2  0 overlay(raklda:9)                    kundekategori
     d  raktxt                       20    overlay(raklda:11)                   beskrivende tekst
     d  rakf02                        2  0 overlay(raklda:31)                   ledig
     d  rakkto                        5  0 overlay(raklda:33)                   konto
     d  raksps                        2  0 overlay(raklda:38)                   spesifikasjon
     d  rakavd                        4  0 overlay(raklda:40)                   avdeling
     d  rakf03                        9  0 overlay(raklda:44)                   =000000001
     d  rakkat                        1    overlay(raklda:53)                   spes. kat.(j/n)
     d  rakavp                        4  2 overlay(raklda:54)                   avvikende rente
     d  rakprg                        1    overlay(raklda:58)                   prisgruppe
     d  rakf04                       70    overlay(raklda:59)                   fri/ledig 004
     d                 ds
     d rallda                       128                                         hele utvekslingsfelt
     d  ralsta                        1    overlay(rallda)                      u:  utgått
     d  ralfir                        3  0 overlay(rallda:2)                    firma
     d  ralf01                        4  0 overlay(rallda:5)                    fri/ledig 001
     d  ralkod                        2    overlay(rallda:9)                    land
     d  raltxt                       20    overlay(rallda:11)                   beskrivende tekst
     d  ralspr                        1  0 overlay(rallda:31)                   språkkode
     d  ralf02                       97    overlay(rallda:32)                   fri/ledig 002
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * data struktur
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d                 ds
     d umtid                         12  0
     d  umtime                        6  0 overlay(umtid)
     d  umdato                        6  0 overlay(umtid:7)
     d   umdag                        2  0 overlay(umdato)
     d   ummnd                        2  0 overlay(umdato:3)
     d   umaar                        2  0 overlay(umdato:5)
     d umxxx                          2  0
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      * local data
      *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_navn                951    980
     d*
     d rablst          s                   like(rablda)
     d raclst          s                   like(raclda)
     d raglst          s                   like(raglda)
     d railst          s                   like(railda)
     d raklst          s                   like(raklda)
     d rallst          s                   like(rallda)
     d saponr          s                   like(rkponr)
     d sfrn01          s                   like(srrn01)
     d spge01          s              3  0
     d srrn01          s              4  0
     d ssrn01          s                   like(srrn01)
     d wactli          s              2  0
     d wactpo          s              3  0
     d werror          s              1  0
     d whalfa          s                   like(rkalfa)
     d wpantp          s              2  0
     d wpbkod          s                   like(rabkod)
     d wpbtxt          s                   like(rabtxt)
     d wpckod          s                   like(rackod)
     d wpctx2          s                   like(ractx2)
     d wpctxt          s                   like(ractxt)
     d wpfirm          s                   like(rkfirm)
     d wpfunk          s              1  0
     d wpgkod          s                   like(ragkod)
     d wpgtxt          s                   like(ragtxt)
     d wpikod          s                   like(raikod)
     d wpitxt          s                   like(raitxt)
     d wpkkod          s                   like(rakkod)
     d wpktxt          s                   like(raktxt)
     d wpkund          s                   like(rkkund)
     d wplkod          s                   like(ralkod)
     d wpltxt          s                   like(raltxt)
     d wpnavn          s                   like(rknavn)
     d wpponr          s                   like(rkponr)
     d wpvalg          s              1
     d wseqen          s              1
     d ww1bek          s                   like(ra1bek)
     d ww1bkk          s                   like(ra1bkk)
     d wwalfa          s                   like(rkalfa)
     d wwbiln          s                   like(rnbiln)
     d wwedat          s                   like(rkedat)
     d wwfirm          s                   like(rkfirm)
     d wwkund          s                   like(rkkund)
     d wwponr          s                   like(rkponr)
     d wwrest          s                   like(rnrest)
     d wwbdat          s                   like(rnbdat)
     d wwtist          s                   like(rntist)
      *
      * Parametre
      *
     d p_valg          s              1
     d p_refk          s              6  0
6.NU d p_biln          s              8  0
     d p_rest          s             11  2
     d p_valn          s              1  0
     d p_kund          s              6  0
     d p_stat          s              1
     d p_avde          s              4  0
     d p_tx20          s             20
     d p_lkod          s              2
     d p_ltxt          s             20
     d p_kkod          s              4  0
     d p_ktxt          s             20
     d p_ikod          s              4  0
     d p_itxt          s             20
     d p_ckod          s              2  0
     d p_ctxt          s             20
     d p_bkod          s              1  0
     d p_btxt          s             20
      *
      *
     c/eject
     c     dummy         tag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * forklaring på spesielle felter
      * som benyttes ved sub-files.
      * - - - - - - - - - - - - - - - - -
      *     nn - er 01 for subfile 01,
      *             02 for subfile 02,
      *             03 for subfile 03, o.s.v.
      * srrnnn - relativt recordnummer i subfile
      * spgenn - sidestørrelse i subfile (page)
      * sfrnnn - første recordnummer på siden
      * ssrnnn - siste  recordnummer på siden
      * svrnnn - vis den side som inneholder denne record.
      *
      * forklaring på spesielle felter
      * som benyttes ved windows.
      * - - - - - - - - - - - - - - - - -
      *
      * wactli - actual line, angir startlinje for vindu.
      * wactpo - actual posision, angir startposisjon for vindu.
      *
      * benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * b1wfl1 - b1 subfile 1 - vindu for valg av post
      * b2wct1 - b2 subfile 1 - vindu control record
      * b1wfl2 - b1 subfile 2 - vindu for valg av post
      * b2wct2 - b2 subfile 2 - vindu control record
      * b2cmd  - b2 vindu for cmd-taster
      * d1win  - d1 vindu for slette
      * k1win  - k1 vindu for kopiering
      * asume  -    record for å styre at vindu legges over
      *             eksisterende data.
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * b2wct behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * send alt
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * bare data
      *
     c     b2tagb        tag
     c                   exsr      xdsp01                                       dsp sfl
     c                   exsr      xnulle
      *
      * avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
     c     *inkl         cabeq     *on           xslutt
      *
      * alternere mellom subfiler
      *
     c                   if        *inkk = *on                                           .....
     c                   if        *in91 = *on                                               .
     c                   move      *on           *in92                                       .
     c                   move      *off          *in91                                       .
     c                   goto      b2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
     c                   if        *inkk = *on                                           .....
     c                   if        *in92 = *on                                               .
     c                   move      *on           *in91                                       .
     c                   move      *off          *in92                                       .
     c                   goto      b2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * forny
      *
     c                   if        *inke = *on                                           .....
     c                   if        sfrn01 <> *zero                                           .
     c     sfrn01        chain     b1wsf1                                                    .
     c                   eval      *in60 = not%found                                         .
     c     sfrn01        chain     b1wsf2                                                    .
     c                   eval      *in60 = not%found                                         .
     c                   endif                                                               .
     c                   eval      wwkund = b1kund                                           .
     c                   move      b1alfa        wwalfa                                      .
     c                   eval      wwponr = b1ponr                                           .
      *                                                                 .
     c                   if        wseqen = 'P'                                              .
     c     key03         setll     rkunl3                                                    .
     c                   else                                                                .
     c                   if        wseqen = 'A'                                              .
     c     key02         setll     rkunl2                                                    .
     c                   else                                                                .
     c     key01         setll     rkunpf                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
      *                                                                 .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * sørring på poster
      *
     c                   if        *inkh = *on                                           .....
     c                   eval      wpvalg = b1valg                                           .
     c                   eval      p_valg = b1valg                                           .
     c                   call      'RK512R'                                                  .
     c                   parm                    p_valg                                      .
     c                   parm                    p_refk
     c                   parm                    p_biln
     c                   parm                    p_rest
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * roll
      *
     c                   if        *in10 = *on                                           .....
     c                   exsr      xcrt01                                       crt sfl      .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * posisjoner startverdi på konto
      *
     c                   if        b2kund <> *zero                                       .....
     c                   eval      wseqen = ' '                                              .
     c                   eval      wwkund = b2kund                                           .
     c     key01         setll     rkunpf                                                    .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   eval      b2kund = *zero                                            .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * posisjoner startverdi på alfafelt
      *
     c                   if        b2alfa <> *blank                                      .....
     c                   eval      wseqen = 'A'                                              .
     c                   eval      wwkund = *zero                                            .
     c                   move      b2alfa        wwalfa                                      .
     c     key02         setll     rkunl2                                                    .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   eval      b2kund = *zero                                            .
     c                   eval      b2alfa = *blank                                           .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
      * posisjoner startverdi på postnummer
      *
     c                   if        b2ponr <> *zero                                       .....
     c                   eval      wseqen = 'P'                                              .
     c                   eval      wwponr = b2ponr                                           .
     c                   eval      wwalfa = *blank                                           .
     c     key03         setll     rkunl3                                                    .
     c                   exsr      xclr01                                       tØm sfl      .
     c                   exsr      xcrt01                                       crt sfl      .
     c                   eval      b2ponr = *zero                                            .
     c                   eval      b2alfa = *blank                                           .
     c                   goto      b2tagb                                                    .
     c                   endif                                                           .....
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * behandling av subfile                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * sjekk om valg er foretatt i subfile
      *
     c                   do        ssrn01                                                .....
     c                   if        *in91 = *on
     c                   readc     b1wsf1                                                    .
     c                   eval      *in16 = %eof                                              .
     c                   endif
     c                   if        *in92 = *on
     c                   readc     b1wsf2                                                    .
     c                   eval      *in16 = %eof                                              .
     c                   endif
     c                   if        *in16 = *on                                               .
     c                   leave                                                               .
     c                   endif                                                               .
      *                                                                 .
      * endre post                                                      .
      *                                                                 .
     c                   if        b1valg = '2'                                              .
     c                   eval      wwkund = b1kund                                           .
     c                   exsr      xc2win                                                    .
     c                   iter                                                                .
     c                   endif                                                               .
      *                                                                 .
      * vise post                                                       .
      *                                                                 .
     c                   if        b1valg = '5'                                              .
     c                   move      *on           *in30                                       .
     c                   eval      wwkund = b1kund                                           .
     c                   exsr      xc2win                                                    .
     c                   iter                                                                .
     c                   endif                                                               .
      *                                                                 .
      * vise posteringer                                                .
      *                                                                 .
     c                   if        b1valg = '8'                                              .
     c                   move      *on           *in30                                       .
     c                   eval      wwkund = b1kund                                           .
     c                   exsr      xt2bld                                                    .
     c                   iter                                                                .
     c                   endif                                                               .
      *                                                                 .
     c                   enddo                                                           .....
      *
     c                   goto      b2taga
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * c2win behandle bilde for ny - endring - vise                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xc2win        begsr
      *
     c     key01         chain     rkunpf
     c                   eval      *in60 = not%found
      *
     c                   if        *in60 = *off                                          .....
     c                   movel     mld(2)        c2nyen                                      .
     c                   eval      c2kund = rkkund                                           .
     c                   eval      c2navn = rknavn                                           .
     c                   eval      c2land = rkland                                           .
     c                   eval      c2bgir = rkbgir                                           .
     c                   eval      c2avde = rkavde                                           .
     c                   move      rkkatg        c2katg                                      .
     c                   eval      c2slgr = rkslgr                                           .
     c                   eval      c2betb = rkbetb
     c                   eval      c2betm = rkbetm                                           .
     c                   eval      c2renk = rkrenk                                           .
     c                   eval      c2purr = rkpurr                                           .
     c                   endif                                                           .....
      *
     c                   if        *in30 = *on                                           .....
     c                   movel     mld(3)        c2nyen                                      .
     c                   endif                                                           .....
      *
     c     c2tagb        tag
      *
      * posisjonere cursor
      *
     c                   if        *in32 = *off
     c                   if        *in33 = *off
     c                   if        *in34 = *off
     c                   if        *in35 = *off
     c                   if        *in36 = *off
     c                   move      *on           *in31
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   eval      wactli = 7
     c                   eval      wactpo = 24
     c                   exfmt     c2win
     c                   exsr      xnulle
      *
     c     *inkc         cabeq     *on           c2tag1
     c     *inkl         cabeq     *on           c2tag1
     c     *in30         cabeq     *on           c2tag1
      *
      * call program for full registrering
      *
     c                   if        *inke = *on                                           .....
     c                   eval      b1valg = '2'                                              .
     c                   move      b1valg        p_valn
     c                   move      rkkund        p_kund
     c                   call      'RK101R'
     c                   parm                    p_kund
     c                   parm                    p_valn                                      .
      *                                                                 .
     c                   goto      c2tag1                                                    .
     c                   endif                                                           .....
      *
      * call program for land
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2LAND'                                         .
     c                   call      'RA112R'                                                  .
     c                   parm                    wwfirm                                      .
     c                   parm                    wplkod                                      .
     c                   parm                    wpltxt                                      .
      *                                                                 .
     c                   if        wplkod <> *blank                                          .
     c                   eval      c2land = wplkod                                           .
     c                   eval      c2ltxt = wpltxt                                           .
     c                   endif                                                               .
      *                                                                 .
     c                   move      *on           *in31                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for avdeling
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2AVDE'                                         .
     c                   call      'RA107R'                                                  .
     c                   parm                    wwfirm                                      .
     c                   parm                    wpgkod                                      .
     c                   parm                    wpgtxt                                      .
      *                                                                 .
     c                   if        wpgkod <> *zero                                           .
     c                   eval      c2avde = wpgkod                                           .
     c                   endif                                                               .
      *                                                                 .
     c                   move      *on           *in32                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for kundekategori
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2KATG'                                         .
     c                   call      'RA111R'                                                  .
     c                   parm                    wpfirm                                      .
     c                   parm                    wpkkod                                      .
     c                   parm                    wpktxt                                      .
      *                                                                 .
     c                   eval      c2katg = wpkkod                                           .
     c                   move      *on           *in33                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for selger
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2SLGR'                                         .
     c                   call      'RA509R'                                                  .
     c                   parm                    wpfirm                                      .
     c                   parm                    wpikod                                      .
     c                   parm                    wpitxt                                      .
      *                                                                 .
     c                   eval      c2slgr = wpikod                                           .
     c                   move      *on           *in34                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for betalingsbetingelse
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2BETB'                                         .
     c                   call      'RA103R'                                                  .
     c                   parm                    wpfirm                                      .
     c                   parm                    wpckod                                      .
     c                   parm                    wpctxt                                      .
     c                   parm                    wpctx2                                      .
      *                                                                 .
     c                   eval      c2betb = wpckod                                           .
     c                   move      *on           *in35                                       .
                                                                                             .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * call program for betalingsmåte
      *
     c                   if        *inkd = *on                                           .....
     c                   if        wactre = 'C2WIN'                                          .
     c                   if        wactfe = 'C2BETM'                                         .
     c                   call      'RA102R'                                                  .
     c                   parm                    wpfirm                                      .
     c                   parm                    wpbkod                                      .
     c                   parm                    wpbtxt                                      .
      *                                                                 .
     c                   eval      c2betm = wpbkod                                           .
     c                   move      *on           *in36                                       .
     c                   goto      c2tagb                                                    .
     c                   endif                                                               .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * kontroll av skjermbildet
      *
     c                   exsr      xsr020
      *
     c                   if        werror <> 0
     c                   goto      c2tagb
     c                   endif
      *
     c     key01         chain     rkunlur
     c                   eval      *in60 = not%found
      *
     c                   eval      rkland = c2land                                           .
     c                   eval      rkbgir = c2bgir                                           .
     c                   eval      rkavde = c2avde                                           .
     c                   eval      rkkatg = c2katg                                           .
     c                   eval      rkslgr = c2slgr                                           .
      *
     c                   if        c2betb = *zero
     c                   eval      rkbetb = ww1bek
     c                   else
     c                   eval      rkbetb = c2betb
     c                   endif
      *
     c                   eval      rkbetm = c2betm                                           .
     c                   eval      rkrenk = c2renk                                           .
     c                   eval      rkpurr = c2purr                                           .
      *
     c                   if        *in60 = *off                                          .....
     c                   eval      rkedat = wwedat
     c                   move      umtime        rketim
     c                   eval      rkesig = l_user
6.10 c                   time                    rk2dpt
6.10 c                   eval      rkepgm = 'RK818R    '
     c                   update    rkunlur                                                   .
     c                   endif                                                           .....
      *
     c     c2tag1        tag
      *
     c                   if        b1valg = '2'                                          .....
     c                             or b1valg = '5'                                           .
     c                   eval      svrn01 = srrn01                                           .
     c                   eval      b1valg = *blank                                           .
     c                   if        *in91 = *on
     c                   update    b1wsf1                                                    .
     c                   endif
     c                   if        *in92 = *on
     c                   update    b1wsf2                                                    .
     c                   endif
     c                   endif                                                           .....
      *
     c                   eval      b2kund = *zero
     c                   eval      b2alfa = *blank
     c                   move      *off          *in30
     c                   move      *on           *in31
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * kontroll  c2 bilde (endringer)                                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xsr020        begsr
      *
      * sjekke om land er gyldig
      *
     c                   if        c2land <> *blank                                      .....
     c                   eval      p_lkod = c2land                                           .
     c                   call      'RS712R'                                      land-
     c                   parm                    p_stat
     c                   parm                    p_lkod
     c                   parm                    p_ltxt
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in31                          pos.cur,     .
     c                   move      *on           *in81                          error        .
     c                   eval      werror = 1                                                .
     c                   goto      xa2010                                                    .
     c                   else                                                                .
     c                   eval      c2ltxt = raltxt                                           .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * sjekke om avdeling er gyldig
      *
     c                   if        c2avde <> *zero                                       .....
     c                   eval      p_avde = c2avde                                           .
     c                   call      'RS707R'                                      avdelings-
     c                   parm                    p_stat
     c                   parm                    p_avde
     c                   parm                    p_tx20
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in32                          pos.cur,     .
     c                   move      *on           *in81                          error        .
     c                   eval      werror = 1                                                .
     c                   goto      xa2010                                                    .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
      * sjekke om kundekategori er gyldig
      *
     c                   if        c2katg <> *zero                                       .....
     c                   eval      p_kkod = c2katg                                           .
     c                   call      'RS711R'                                      kundekategori-
     c                   parm                    p_stat
     c                   parm                    p_kkod
     c                   parm                    p_ktxt
     c                   parm                    raklst                           kode
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in33                          pos.cur,   . .
     c                   move      *on           *in81                          error      . .
     c                   eval      werror = 1                                              . .
     c                   goto      xa2010                                                  . .
     c                   endif                                                           ... .
     c                   endif                                                           .....
      *
      * sjekke om selger er gyldig
      *
     c                   if        c2slgr <> *zero                                       .....
     c                   eval      p_ikod = c2slgr                                           .
     c                   call      'RS709R'                                      selger-
     c                   parm                    p_stat
     c                   parm                    p_ikod
     c                   parm                    p_itxt
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in34                          pos.cur.   . .
     c                   move      *on           *in81                          error      . .
     c                   eval      werror = 1                                              . .
     c                   goto      xa2010                                                  . .
     c                   endif                                                           ... .
     c                   endif                                                           .....
      *
      * sjekke om betalingsbetingelse er gyldig
      *
     c                   eval      p_ckod = c2betb
     c                   call      'RS703R'                                      betalingsbetingelse
     c                   parm                    p_stat
     c                   parm                    p_ckod
     c                   parm                    p_ctxt
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in35                          pos.cur.     .
     c                   move      *on           *in81                          error        .
     c                   eval      werror = 1                                                .
     c                   goto      xa2010                                                    .
     c                   endif                                                           .....
      *
      * sjekke om betalingsmåte er gyldig
      *
     c                   if        c2betm <> *zero                                       .....
     c                   eval      p_bkod = c2betm                                           .
     c                   call      'RS702R'                                      betalingsmåte-
     c                   parm                    p_stat
     c                   parm                    p_bkod
     c                   parm                    p_btxt
     c                   if        p_stat = 'N'                                 kode
     c                   move      *on           *in36                          pos.cur.   . .
     c                   move      *on           *in81                          error      . .
     c                   eval      werror = 1                                              . .
     c                   goto      xa2010                                                  . .
     c                   endif                                                           ... .
     c                   endif                                                           .....
      *
     c     xa2010        tag
      *
     c                   endsr
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * t2bld vise posteringer                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xt2bld        begsr
      *
     c                   eval      wpvalg = '2'
     c                   eval      wwkund = b1kund
     c                   move      *zeros        wwbiln
     c                   move      b1kund        wwrest
      *
     c                   call      'RK819R'                                     rk308r
     c                   parm                    wpvalg
     c                   parm                    wwkund
     c                   parm                    wwbiln
     c                   parm                    wwrest
      *
     c     ct2ag1        tag
      *
     c                   if        b1valg = '8'                                          .....
     c                   eval      svrn01 = srrn01                                           .
     c                   eval      b1valg = *blank                                           .
     c                   if        *in91 = *on
     c                   update    b1wsf1                                                    .
     c                   endif
     c                   if        *in92 = *on
     c                   update    b1wsf2                                                    .
     c                   endif
     c                   endif                                                           .....
      *
     c                   eval      b2kund = *zero
     c                   eval      b2alfa = *blank
     c                   move      *off          *in30
     c                   move      *on           *in31
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * tøm subfile                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xclr01        begsr
      *
     c                   move      *on           *in14
     c                   write     b2wct1
     c                   write     b2wct2
     c                   move      *off          *in14
      *
     c                   move      *off          *in15
     c                   eval      srrn01 = 0
     c                   eval      sfrn01 = 0
     c                   eval      ssrn01 = 0
     c                   eval      spge01 = 0
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * fyll opp subfile                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xcrt01        begsr
      *
     c                   eval      spge01 = spge01 + 13                         sfl end
     c                   eval      srrn01 = ssrn01
      *
     c                   dou       srrn01 = spge01                                       .....
      *                                                                 .
     c     xles01        tag
      *                                                                 .
     c                   if        wseqen = 'A'                                              .
     c                   read      rkunl2                                                    .
     c                   eval      *in15 = %eof                                              .
     c                   else                                                                .
     c                   if        wseqen = 'P'                                              .
     c                   read      rkunl3                                                    .
     c                   eval      *in15 = %eof                                              .
     c                   else                                                                .
     c                   read      rkunpf                                                    .
     c                   eval      *in15 = %eof                                              .
     c                   endif                                                               .
     c                   endif                                                               .
      *                                                                 .
     c     *in15         cabeq     *on           xend01                         eof          .
      *                                                                 .
     c                   if        rkfirm <> wwfirm                                          .
     c                   move      *on           *in15                                       .
     c                   endif                                                               .
      *                                                                 .
     c     *in15         cabeq     *on           xend01                         nytt firma   .
      *                                                                 .
      * sjekk om det finnes poster                                      .
      *                                                                 .
     c                   eval      wwkund = rkkund                                           .
     c     keyktr        setll     rkwcpf                                                    .
     c                   eval      *in15 = %equal                                            .
      *                                                                 .
     c                   read      rkwcpf                                                    .
     c                   eval      *in15 = %eof                                              .
      *                                                                 .
     c     *in15         cabeq     *on           xles01                         eof          .
      *                                                                 .
     c                   if        rnfirm <> wwfirm                                          .
     c                   move      *on           *in15                                       .
     c                   endif                                                               .
      *                                                                 .
     c                   if        rnkund <> rkkund                                          .
     c                   move      *on           *in15                                       .
     c                   endif                                                               .
      *                                                                 .
     c     *in15         cabeq     *on           xles01                         ingen poster .
      *                                                                 .
     c                   eval      srrn01 = srrn01 + 1                                       .
     c                   eval      b1kund = rkkund                                           .
     c                   move      rkalfa        b1alfa                                      .
     c                   eval      b1navn = rknavn                                           .
     c                   movel     rksted        b1sted                                      .
     c                   eval      b1ponr = rkponr                                           .
     c                   movel     rkgate        b1gate                                      .
     c                   eval      b1tlfn = rktlfn                                           .
     c                   eval      b1tlfx = rktlfx                                           .
      *
     c                   write     b1wsf1                                                    .
     c                   write     b1wsf2                                                    .
     c                   enddo                                                           .....
      *
     c     xend01        tag
      *
     c                   if        srrn01 > ssrn01                                       .....
     c                   eval      sfrn01 = ssrn01 + 1                                       .
     c                   endif                                                           .....
      *
     c                   eval      ssrn01 = srrn01
     c                   eval      svrn01 = sfrn01
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * display subfile                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xdsp01        begsr
      *
     c                   if        srrn01 <> 0                                           .....
     c                   move      *on           *in12                                       .
     c                   endif                                                           .....
      *
     c                   move      *on           *in13
     c                   if        *in91 = *on
     c                   exfmt     b2wct1
     c                   endif
     c                   if        *in92 = *on
     c                   exfmt     b2wct2
     c                   endif
     c                   move      *off          *in12
     c                   move      *off          *in13
      *
     c                   endsr
      *
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * 0-stilling av arbeidsindikatorer og arbeidsfelt                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xnulle        begsr
      *
     c                   eval      *in31 = *off
     c                   eval      *in32 = *off
     c                   eval      *in33 = *off
     c                   eval      *in34 = *off
     c                   eval      *in35 = *off
     c                   eval      *in36 = *off
     c                   eval      *in37 = *off
     c                   eval      werror = *zero
      *
     c                   endsr
     c/eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      spge01 = 0
     c                   eval      srrn01 = 0
     c                   eval      wactli = 0
     c                   eval      wactpo = 0
     c                   eval      werror = *zero
     c                   eval      wpfunk = *zero
     c                   eval      wpantp = *zero
     c                   eval      wseqen = *blank
     c                   move      *on           *in91
     c                   eval      wseqen = *blank
      *
     c**+        *like     defn rkedat    wwedat
      *
      *
      * legge inn firmanummer
      *
     c                   eval      wwfirm = l_firm
     c                   eval      rabfir = l_firm
     c                   eval      racfir = l_firm
     c                   eval      ragfir = l_firm
     c                   eval      raifir = l_firm
     c                   eval      rakfir = l_firm
     c                   eval      ralfir = l_firm
      *
     c                   move      *loval        wwbdat
     c                   move      *loval        wwtist
      *
     c                   eval      wpvalg = *blank
      *
      * hent statuskode 1
      *
     c     keya1         chain     raa1pf
     c                   eval      *in61 = not%found
      *
     c                   if        *in61 = *off                                          .....
     c                   eval      ww1bek = ra1bek                                           .
     c                   eval      ww1bkk = ra1bkk                                           .
     c                   else                                                                .
     c                   eval      ww1bek = 15                                               .
     c                   eval      ww1bkk = 0                                                .
     c                   endif                                                           .....
      *
      **   dato + klokkeslett
      *
     c                   time                    umtid
     c                   eval      umxxx = umaar                                snu dato
     c                   eval      umaar = umdag                                 ddmmÅÅ ==>
     c                   eval      umdag = umxxx                                  ÅÅmmdd
     c**+        umxxx     iflt 83
     c**+                  move 20000000  wwedat
     c**+                  else
     c**+                  move 19000000  wwedat
     c**+                  endif
     c**+                  move umdato    wwedat
     c**+                  move umtime    rketim
     c**+                  move l_user    rkesig
      *
      * key for kunderegister via kundenummer
      *
     c     key01         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwkund
      *
      * key for kunderegister via alfafelt
      *
     c     key02         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwalfa
     c                   kfld                    wwkund
      *
      * key for kunderegister via postnr./alfa
      *
     c     key03         klist
     c                   kfld                    wwfirm
     c                   kfld                    wwponr
     c                   kfld                    wwalfa
      *
      * key for kundeposter via kundenummer
      *
     c     keyktr        klist
     c                   kfld                    wwfirm
     c                   kfld                    wwkund
     c                   kfld                    wwbdat
     c                   kfld                    wwtist
      *
      * key for statuskode 1
      *
     c     keya1         klist
     c                   kfld                    wwfirm
      *
      * key for statuskode 4
      *
     c     keya4         klist
     c                   kfld                    wwfirm
      *
      * key for postnummer-register
      *
     c     key06         klist
     c                   kfld                    wwponr
      *
     c                   if        wseqen = 'P'                                          .....
     c     key03         setll     rkunl3                                                    .
     c                   else                                                                .
     c                   if        wseqen = 'A'                                              .
     c     key02         setll     rkunl2                                                    .
     c                   else                                                                .
     c     key01         setll     rkunpf                                                    .
     c                   endif                                                               .
     c                   endif                                                           .....
      *
     c                   exsr      xcrt01
      *
     c                   endsr
**
  Ny post                  001
  Endring                  002
  Vise                     003
* Slettet *                004
