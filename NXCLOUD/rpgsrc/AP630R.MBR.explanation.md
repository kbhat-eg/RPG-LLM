# RPG Source Code Explanation

This RPG program is designed for maintaining and manipulating printer records and their associated subfiles, with a focus on user interaction through screens and subfile handling. It uses a structured approach with subroutines for modularity and clarity.

## Program Header & Metadata
- **H options**: `*nodebugio` disables debug I/O, `datedit(*dmy)` sets date format.
- **Comments**: Provide system info, program description, version history, and special instructions.

## Indicators
- **Indicators (LR, 10-99)**: Used for control flow, screen actions, and subfile management:
  - `LR`: Program end
  - `10-15`: Rollup, Rolldown, Subfile position, control, clear, end
  - `21-22`: Home key, Cursor positioning
  - `30-79`: Error/warning messages
  - `80-99`: Work indicators

## File Definitions
- **fafprlr / fafprlu**: Files renamed from `afprpfr` to `afprlrr` and `afprlur` respectively, for record processing.
- **fap630d**: Main display file, linked to `workstn` device, with display info in `dspfbk`.

## Data Structures & Variables
- **Local Data Area (`d uds`)**: Contains user info (`l_user`), filename (`l_sfil`), record info (`l_sbib`), firm code (`l_firm`), filename string (`l_fnav`).
- **Display Feedback (`d dspfbk`)**: Contains a 378-byte structure with a field `d_fcrn` for record number.
- **Like-structures**: For screen controls (`afsprt`, `afsfil`, etc.).
- **Variables**: Record identifiers (`w_fcrn`, `w_stel`, etc.), control flags (`b_oppr`, `b_forn`, etc.), subfile position markers (`w_srrn`, `w_ssrn`, etc.), and constants (`c_sfil`).

## Comments on Special Fields
- **Subfile control fields**:
  - `w_fcrn`: First record number on the page
  - `w_stel`: Subfile line counter
  - `w_spge`: Page size
  - `w_srrn`, `w_sfrn`, `w_ssrn`: Record position markers
  - `w_curn`: Current record number
  - `w_virn`: Virtual record number for display
  - `w_afld`: Active field name
  - `w_arow`, `w_acol`: Cursor position

## Screen & Subfile Management
- **Screens**:
  - `B1SFL`: Subfile record display
  - `B2CTL`: Subfile control record
  - `B2CMD`: Command keys