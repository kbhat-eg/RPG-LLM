```markdown
# RPG Program FX795R — Explanation

## Overview

This RPG source code implements a program named `FX795R`, which manages control, updating, and inquiry to a log file (as described in the comments). The code mainly interacts with a workstation display file (`FX795D`) and communicates with two external programs (`FU900R` for updating and `FU500R` for inquiry). The comments and variable names are partially in Norwegian.

Key functions performed:
- Input and display of order numbers through a display screen
- Updating a log file with order and user info
- Inquiry into log file entries
- Simple menu-driven loop until the user exits

---

## Header/Control Specification

```rpg
h option(*nodebugio) datedit(*dmy)
```
- `option(*nodebugio)`: Disables RPG's debug I/O.
- `datedit(*dmy)`: Specifies default date editing to Day-Month-Year.

---

## Data Descriptions and Structures

### File Definition

```rpg
ffx795d    cf   e             workstn
```
Defines a display file named `FX795D` for workstation use (`WORKSTN`).

---

### Local Data Area (LDA)

```rpg
d                uds
d l_wsid                901    910
d l_user                911    920
d l_firm                944    946  0
```

- Declares access to the LDA (Local Data Area).
- `l_wsid`: Workstation ID at bytes 901–910.
- `l_user`: User ID at bytes 911–920.
- `l_firm`: Firm number at bytes 944–946.

---

### Data Structure Overlay

```rpg
d                 ds
d d_urec                        80
d  d_firm                        3  0 overlay(d_urec)
d  d_aarr                        4  0 overlay(d_urec:4)
d  d_numm                        6  0 overlay(d_urec:8)
d  d_suff                        2  0 overlay(d_urec:14)
d  d_kode                        1    overlay(d_urec:16)
d  d_date                         d   overlay(d_urec:17) datfmt(*iso)
d  d_time                         t   overlay(d_urec:27) timfmt(*iso)
d  d_user                       10    overlay(d_urec:35)
d  d_wsid                       10    overlay(d_urec:45)
```

- Declares an 80-byte structure (`d_urec`) and overlays various fields on it for structured access.
    - `d_firm`: Firm number, 3 digits, starts at byte 1 of `d_urec`.
    - `d_aarr`: Year(?), 4 digits, starts at byte 4.
    - `d_numm`: Number, 6 digits, starts at byte 8.
    - `d_suff`: Suffix, 2 digits, starts at byte 14.
    - `d_kode`: Code, 1 character, at byte 16.
    - `d_date`: Date, ISO format, at byte 17.
    - `d_time`: Time, ISO format, at byte 27.
    - `d_user`: User ID, 10 chars, at byte 35.
    - `d_wsid`: Workstation ID, 10 chars, at byte 45.

---

### Standalone Variables

```rpg
d w_stat          s              1
d w_firm          s              3  0
```
- `w_stat`: Status flag, 1 char.
- `w_firm`: Firm number, 3 digits.

---

## Main Logic

### Initial Tags and Input

```rpg
c                   z-add     10            w_acli
c                   z-add     12            w_acpo

c     a1tag1        tag
c                   exfmt     a1win
```
- `w_acli`, `w_acpo`: Possibly counters or flags, initialized to 10 and 12.
- `a1tag1`: Label/tag at the top of the main loop.
- `exfmt a1win`: Displays/input screen format for order number entry.

---

### Exit Check

```rpg
c                   if        *inkc = *on
c                   goto      avslutt
c                   endif
```
- Checks if exit key (usually F3, mapped to `*INKC`) is pressed; if so, goto label `avslutt` (exit).

---

### Log Update Section

```rpg
c                   if        a1spop = 'O'
c                   eval      d_firm = l_firm
c                   eval      d_user = l_user
c                   eval      d_wsid = l_wsid
c                   eval      d_aarr = a1aarr
c                   eval      d_numm = a1numm
c                   eval      d_suff = a1suff
c                   eval      d_kode = a1kode
c                   time                    d_date
c                   time                    d_time
c                   call      'FU900R'
c                   parm                    w_stat
c                   parm                    d_urec
c                   endif
```
- If the operation code (`a1spop`) is `O` (update), fills `d_urec` with firm/user/info and current date/time.
- Calls program `FU900R`, passing:
    - `w_stat`: Status flag (output parameter)
    - `d_urec`: The log record to update

---

### Inquiry Section

```rpg
c                   if        a1spop = ' '
c                   call      'FU500R'
c                   parm                    w_firm
c                   parm                    a1numm
c                   parm                    a1suff
c                   endif
```
- If operation is blank (`' '`), calls program `FU500R` to inquire about log data, passing firm, number, and suffix.

---

### Reset and Loop

```rpg
c                   eval      a1numm = 0
c                   eval      a1suff = 0
c                   eval      a1kode = ' '
c                   eval      a1spop = ' '
c                   goto      a1tag1
```
- Resets screen variables and jumps back to the top of the screen-logic loop (`a1tag1`).

---

## Program Exit

```rpg
c     avslutt       tag
c                   eval      *inlr = *on
c                   return
```
- Label for program exit.
- Sets last record indicator (`*INLR`) to `*ON` to close files and end the program.
- Returns control to caller.

---

## Initialization Subroutine

```rpg
c     *inzsr        begsr
c                   eval      w_acli = 0
c                   eval      w_acpo = 0
c                   eval      w_firm = l_firm
c                   endsr
```
- Subroutine executed at program initialization.
- Initializes counters/flags (`w_acli`, `w_acpo`) to 0.
- Sets the work variable `w_firm` from the LDA value.

---

## Indicators

Documented usage:
- `LR`: End program
- `30`: Field protection on view
- `31-59`: Error/screen indicators
- `60-69`: File indicators (chain, etc.)
- `70-79`: Work indicators for subroutines
- `80-89`: Work indicators, general
- `90-99`: For std. subroutines

---

## Summary

**FX795R** is a classic ILE RPG program for order log management where:
- It presents a screen for entering order info.
- According to the operation selected, updates the log file or performs an inquiry by calling other programs.
- Uses overlay data structures to pack/unpack log records.
- Loops for new input until the user exits.

**Common Modifications**:
- Adding new fields to `d_urec` for more logging detail.
- Changing the external programs called for different behaviors.
```
