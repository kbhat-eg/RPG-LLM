      /TITLE  Utskrift av kontoutdrag kunder - parameter
     h datedit(*dmy) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RK643R                                              *
      * Beskrivelse . . : Utskrift av kundeinfor. kunder - parameter          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
      * V5.30     030904  Nytt program                                   KOB  *
5.41  * V5.41     200605  Lagt inn mulighet for å sende utskrift på mail AMD  *
5.41  * V5.50     081105  Lagt inn mulighet for utskrift av åpne poster  KOB  *
5.41  * V5.50     081105  Lagt inn mulighet for utskrift av kundeinfo    KOB  *
      *                                                                       *
6.20  * R6.20     080911  Rekompilert pga endring i RPARRKDS             NHO  *
      *                                                                       *
8.01  *K00000     040425  Fjernet valg for mail. Omskrevet til PROA      bsa  *
      *                                                                       *
      *                                                                       *
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *                                                                 *
      *  BRUK AV INDIKATORER                                            *
      *                                                                 *
      *       KA = F1  = Valg av firma                                  *
      *       KC = F3  = Exit                                           *
      *                                                                 *
      *       LR = Avslutt program                                      *
      *       30 = Protect av felter ved vise                           *
      *    31-59 = Varsle m/feilmeldinger/skjermindikatorer             *
      *    60-69 = Fileindikatorer chain etc.                           *
      *    70-79 = Arbeidsindikatorer i sub-rutiner                     *
      *    80-89 = Arbeidsindikatorer ordinære                          *
      *    90-99 = Benyttes ved std. sub-rutiner                        *
      *                                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     frk643d    cf   e             workstn
      *
     d n               s              2  0
     d s               s              1  0
     d waar            s              4  0
     d wmnd            s              2  0
     d wpakod          s              2  0
     d wpdat1          s              6  0
      *
     d p_in03          s              1
     d p_kund          s              6  0
5.41 d p_valg          s              1
5.41 d p_mail          s              1
      *
     d w_aar           s              2  0
     d w_firm          s              3  0
     d w_user          s                   like(l_user)
      *
      *  Parameter
     d/COPY QCPYLESRC,RPARRKDS
      *
      /eject
     c     dummy         tag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Definering av felter                                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      * Benyttede skjermbilder.
      * - - - - - - - - - - - - - - - - -
      *
      * A2BLD  - A2 Bilde for valg av parametre
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * A2BLD Behandle bilde for valg av utskriftskriteria              *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     a2taga        tag
      *
      * Send skjermbilde
      *
     c                   exfmt     a2bld
      *
     c                   eval      *in31 = *off
     c                   eval      *in32 = *off
      *
      * Gå ut
      *
     c                   if        *inkc = *on                                  .....
     c                   move      '1'           p_in03                             .
     c                   goto      xslutt                                           .
     c                   endif                                                  .....
      *
      * Endre periode fra dersom åpne poster
      *
     c                   if        a2valg = '2'                                          .....
     c                   eval      a2pÅrf = 2000                                Pos.cur.     .
     c                   eval      a2ppef = 1                                   Pos.cur.     .
     c                   endif                                                  .....
      *
      * Kontroll av regnskapsår
      *
     c                   if        a2pÅrt > *year                                        .....
     c                   move      *on           *in32                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2pÅrf <= *zero                                       .....
     c                   move      *on           *in37                          Melding      .
     c                   move      *on           *in45                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2pÅrt <= *zero                                       .....
     c                   move      *on           *in38                          Melding      .
     c                   move      *on           *in45                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2pÅrf > a2pÅrt                                       .....
     c                   move      *on           *in39                          Melding      .
     c                   move      *on           *in45                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
      *  Kontroll av regnskapsperiode
      *
     c                   if        a2ppef <= *zero                                       .....
     c                   move      *on           *in37                          Melding      .
     c                   move      *on           *in45                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2ppet <= *zero                                       .....
     c                   move      *on           *in38                          Melding      .
     c                   move      *on           *in45                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
     c                   if        a2pÅrf = a2pÅrt and                                   .....
     c                             a2ppef > a2ppet                                       .....
     c                   move      *on           *in39                          Melding      .
     c                   move      *on           *in45                          Pos.cur.     .
     c                   goto      a2taga                                                    .
     c                   endif                                                           .....
      *
      * Skriv parameter
      *
     c                   move      udate         pdato
     c                   move      a2pÅrf        paarf
     c                   move      a2pÅrt        paart
     c                   move      a2ppef        pperf
     c                   move      a2ppet        ppert
     c                   move      p_kund        pknrf
     c                   move      p_kund        pknrt
      *
     c                   eval      pavdf = 0
     c                   eval      pavdt = 9999
     c                   eval      pkatf = 0
     c                   eval      pkatt = 9999
     c                   eval      pself = 0
     c                   eval      pselt = 9999
     c                   eval      kun   = 0
     c                   eval      pvalu = ' '
     c                   eval      pkats = ' '
     c                   eval      pavds = ' '
     c                   eval      psels = ' '
     c                   eval      psort = ' '
5.41  *
5.41 c                   eval      p_valg = a2valg
5.41  *
5.41  * Er det valgt e-mail ?
5.41  *
5.41 c                   if        a2mail = '1'                                          .....
5.41 c                   eval      p_mail = a2mail
5.41 c                   endif                                                           .....
5.41  *
      *
      /space 3
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     xslutt        tag
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_in03
     c                   parm                    p_kund
5.41 c                   parm                    p_valg
5.41 c                   parm                    p_mail
      *
     c                   eval      wpakod = *zero
     c                   eval      wpdat1 = 0
      *
      * Legge inn firmanummer og navn fra parameter
      *
     c                   move      l_user        w_user
     c                   move      l_firm        w_firm
      *
      * Beregner periode
      *
     c                   move      *year         waar
      *
     c                   eval      wmnd = umonth - 1
     c                   if        wmnd = *zero                                          .....
     c                   movel     12            wmnd                                        .
     c                   eval      waar = waar - 1                                           .
     c                   move      waar          a2pÅrf                                      .
     c                   move      waar          a2pÅrt                                      .
     c                   else                                                                .
     c                   move      waar          a2pÅrf                                      .
     c                   move      waar          a2pÅrt                                      .
     c                   endif                                                           .....
      *
     c                   move      01            a2ppef
     c                   move      wmnd          a2ppet
      *
     c                   eval      p_in03 = *zero
      *
     c                   endsr
