```markdown
# RPG Program VA551R: Order Type Inquiry - Accumulator Type 2

This ILE RPG program (VA551R) is designed to handle inquiries about "ordretyper" (order types), specifically showing those with accumulator type 2. It uses subfiles to display and select order types, supporting paging, filtering, and positioning logic.

## 1. Program-Level Declarations

- **`h option(*nodebugio) datedit(*dmy)`**  
  Specifies options for the program: no debug input/output, and date edit as day-month-year.

## 2. Files

- **Physical Files (`F-Specs`):**
  - **`votyl1` / `votyl2`**: Database files read with keys (`k disk`). Used for order type lookup, renamed for record formats.
- **Workstation File (`f-spec`):**
  - **`va551d`**: Workstation device with subfile (`B1SFL`) and control/display records; uses `dspfbk` for display feedback.

## 3. Data Definitions

### Parameters (from caller):
- **`p_firm`**: Company/firm (from parameter, like `vaofir`)
- **`p_otyp`**: Order type for positioning/filtering

### Information Data Structure:
- **`dspfbk`**: Display file feedback DS, includes field `d_fcrn` for the first record number on the screen.

### Key Variables:
- **`votyl1_otyp`, `votyl2_otxt`**: Used to position/look up by order type or description.

### Subfile & Control Variables:
- **`w_fcrn`**: First record number on current subfile page
- **`w_stel`**: Subfile counter
- **`w_spge`**: Subfile page size
- **`w_srrn`, `w_sfrn`, `w_ssrn`**: Current, first, last record numbers in subfile
- **`w_seqe`**: Search mode indicator ('B' for description search)
- **`b_valg_ok`**: Selection flag indicating a choice was made
- **`w_firm`**: Working copy of firm/company

### Constants:
- **`c_sfil`**: Subfile page size (initialized as 8)

## 4. Subfile Usage and Screen Logic

### Main Display/Screen Areas:
- **`B1SFL`**: The main subfile record (list of order types)
- **`B2CTL`**: Subfile control record (for actions, paging)
- **`B2CMD`**: Command keys screen

### Subfile Variables (as per comments):
Variables like `w_fcrn`, `w_srrn`, etc., are used to track the position, size, and paging of the subfile (screen list of order types).

## 5. Program Logic Flow

### Entry and Initialization

1. **`*inzsr` Subroutine:**  
   - Called at program start.
   - Receives input parameters for firm and order type.
   - Builds keys for positioning by order type (`votyl1_key`) and description (`votyl2_key`).
   - Loads initial subfile contents.

### Main Processing Loop

- **Program starts at `b2taga` label:**  
  - Writes `B2CMD` record (command keys).
  - Jumps to `b2tagb`: which displays the subfile, then processes keys.

#### Handling Function Keys (ROLL/ROLLEDOWN, HOME, etc.)

- **ROLL/ROLLEDOWN:** Calls `crt_subfile` to get next page.
- **ROLLEDOWN:** Calls `bck_subfile` to go back a page.
- **HOME:** Positions cursor back to the top.
- **Exit (keyed by *INkc or *INkl):** Calls `avslutt` to end program.

### Subfile Positioning

- User can filter/order the list by order type or description.
  - If order type (`b2otyp`) is entered, sets appropriate key, positions with `setll` and then creates the subfile from there.
  - If description (`b2otxt`) is entered, similar positioning using alternate key.

### Subfile Operations (Subroutines)

#### `forny`: Refresh subfile based on current position.

#### `posisjoner`: Positions to a specific order type or description, then refreshes the subfile.

#### `subfile`: Reads the subfile, processes user's selection (e.g., if user marks an order type as selected).

#### `clr_subfile`: Clears out the subfile records and resets relevant counters.

#### `crt_subfile`: Fills the subfile with the next page of data from the database, up to the page size. Only includes order types with `vaoakk = 2` (accumulator type 2).

#### `bck_subfile`: Fills the subfile with the previous page of data.

#### `dsp_subfile`: Displays the subfile screen, processing necessary indicators and setting cursor locations.

## 6. Indicators

- **LR**: End of program
- **10**: Roll/Next page
- **11**: Rolldown/Previous page
- **12-15 etc.**: Subfile handling (clear, end, display, etc.)
- **22**: For cursor positioning
- **80-99**: Work indicators

## 7. Miscellaneous

- Only order types that can be picked for invoicing (`vaoakk = 2`) are shown.
- The program supports filtering, positioning and paginating through potentially large lists of order types.

## 8. Summary

This program is a classic subfile-based inquiry for filterable order type lists, letting users:
- Scroll (page) back/forth,
- Filter by code or description,
- Position the list via search,
- Select a line (order type) and pass it back as an output parameter.

It leverages IBM i's traditional subfile model, with clear variable naming and routine structure for paging, filtering, and user selection operations.
```