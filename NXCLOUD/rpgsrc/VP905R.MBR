     h option(*nodebugio) datedit(*dmy)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : VP905R  (tatt utg.punkt i VP900R)
      * Beskrivelse . . : Henter og beregner priser og rabatter for vare
      *                   Utvidet med info til statistikk
      *
      *
      * Kjøper kreves alltid for laveste pris på vare.
      * Salgsprisen som returneres er salgsprisen som er grunnlaget for
      * rabatten, d.v.s. pris før rabatt.
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       081014 bof  Nytt program
      *                   Kopiert VP900R 08.10.14
6.30  *       081014 bof  Utvidet med innkjøpspris + returkode mm.
6.31  *       090615 bof  Sikre at utregnig ikke sprekker
6.32  * 6.30  221015 BOF  Justert vp900r parm, pga. nummer.utv.
6.32a *       170815 bof  bruke hiinlr fra noen steder,pga. ressursprobl.
6.nu  *       180218 bsa  Endret ihht. nummerutvidelse
6.33  * 6.30  170918 bkv  Utvidet med trelast sortiment
7.01  *K00  070620 BOF NXS-4138  Kunne kombinere rabattkat.og kundekat.i rab.matr.
8.03  *PRG2   080622 bof  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     frmknl2    if   e           k disk    rename(rmknpfr:rmknl2r)
     ffkprl1    if   e           k disk    rename(fkprpfr:fkprl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fvvprl1    if   e           k disk    rename(vvprpfr:vvprl1r)
     fvtill1    if   e           k disk    rename(vtilpfr:vtill1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     ffohel1    if   e           k disk    rename(fohepfr:fohel1r)
     ffodtlv    if   e           k disk    rename(fodtpfr:fodtlvr)
     ffpril1    if   e           k disk    rename(fpripfr:fpril1r)
     ffrabl1    if   e           k disk    rename(frabpfr:frabl1r)
     fvbrkl1    if   e           k disk    rename(vbrkpfr:vbrkl1r)
     fvbrkl5    if   e           k disk    rename(vbrkpfr:vbrkl5r)
     frmbtl1    if   e           k disk    rename(rmbtpfr:rmbtl1r)
     fjvarl1    if   e           k disk    rename(jvarpfr:jvarl1r)
     f                                     prefix(vv:2)
     fjvdtl1    if   e           k disk    rename(jvdtpfr:jvdtl1r)
6.10 fvmval1    if   e           k disk    rename(vmvapfr:vmval1r)
6.33 fvvlel1    if   e           k disk    rename(vvlepfr:vvlel1r)
      *
      * Definering parametre
      *
     d p_irec          s            120
     d p_orec          s            100
      *
      * Datastruktur parameterliste -inn
      *
     d                 ds
     d hirec                        120
     d  hifirm                        3  0 overlay(hirec)
     d  hirkat                        3  0 overlay(hirec:4)
     d  hikund                        6  0 overlay(hirec:7)
     d  hikpro                        6  0 overlay(hirec:13)
     d  hivare                       15    overlay(hirec:19)
     d  hilety                        1  0 overlay(hirec:34)
     d  hienhe                        3    overlay(hirec:35)
     d  hidato                         d   overlay(hirec:38) datfmt(*iso)
     d  hitime                         t   overlay(hirec:48) timfmt(*iso)
6.nu d  hinumm                        8  0 overlay(hirec:56)
6.nu d  hikode                        1    overlay(hirec:64)
6.nu d  hidekn                        5  2 overlay(hirec:65)
6.nu d  hiavgf                        1  0 overlay(hirec:70)
6.nu d  hipriv                        1  0 overlay(hirec:71)
6.nu d  hitilb                        1    overlay(hirec:72)
6.nu d  hiskaf                        1    overlay(hirec:73)
6.nu d  hildor                        6  0 overlay(hirec:74)
6.32 d  hisapr                        9  2 overlay(hirec:80)
6.32 d  hikopr                        9  2 overlay(hirec:89)
8.03 d  hiprgr                        2    overlay(hirec:98)
8.03 d  hiinpr                        9  2 overlay(hirec:100)
     d  hiinlr                        1    overlay(hirec:120)
      *
      * Datastruktur parameterliste -ut
      *
     d                 ds
6.30 d horec                        100
     d  holety                        1  0 overlay(horec)
     d  hokpri                        1    overlay(horec:2)
     d  hooppr                        9  2 overlay(horec:3)
     d  hosapr                        9  2 overlay(horec:12)
     d  hokopr                        9  2 overlay(horec:21)
     d  horab1                        5  2 overlay(horec:30)
     d  horab2                        5  2 overlay(horec:35)
     d  hodekn                        5  2 overlay(horec:40)
     d  hopros                        5  2 overlay(horec:45)
     d  hokamp                        5    overlay(horec:50)
     d  hoalme                        4  0 overlay(horec:55)
     d  hobrty                        1  0 overlay(horec:59)
     d  hobrr1                        5  2 overlay(horec:60)
     d  hobrr2                        5  2 overlay(horec:65)
     d  hoomva                        1    overlay(horec:70)
8.03 d  hoprgr                        2    overlay(horec:71)
8.03 d  hoinpr                        9  2 overlay(horec:73)
8.03 d  hopkon                        3    overlay(horec:82)
8.03 d  hopkns                        3    overlay(horec:85)
8.03 d  hopkko                        3    overlay(horec:88)
8.03 d  hopkok                        3    overlay(horec:91)
8.03 d  hopkoi                        3    overlay(horec:94)
      *
      * Definering av variabler i nøkler
      *
     d rkunl1_kund     s                   like(rkkund)
     d rmknl2_xknr     s                   like(rmxknr)
     d fkprl1_kund     s                   like(flkund)
     d fkprl1_kpro     s                   like(flkpro)
     d vvarl1_vare     s                   like(vvvare)
     d vvprl1_vare     s                   like(vpvare)
6.20 d vvprl1_ldor     s                   like(vpldor)
5.70 d vvprl1_prgr     s                   like(vpprgr)
     d vvprl1_enhe     s                   like(vpenhe)
     d vvprl1_lety     s                   like(vplety)
6.21 d vtill1_ogrp     s                   like(vtogrp)
6.21 d vtill1_hgrp     s                   like(vthgrp)
6.21 d vtill1_ugrp     s                   like(vtugrp)
6.21 d vtill1_ldor     s                   like(vtldor)
     d vtill1_vare     s                   like(vtvare)
5.70 d vtill1_prgr     s                   like(vtprgr)
     d vtill1_lety     s                   like(vtlety)
     d vugrl1_uogr     s                   like(vguogr)
     d vugrl1_uhgr     s                   like(vguhgr)
     d vugrl1_uugr     s                   like(vguugr)
     d fohel1_numm     s                   like(fonumm)
     d fohel1_suff     s                   like(fosuff)
     d fodtlv_vare     s                   like(fdvare)
     d fodtlv_numm     s                   like(fdnumm)
     d fodtlv_suff     s                   like(fdsuff)
     d fodtlv_enh1     s                   like(fdenh1)
5.70 d fpril1_prgr     s                   like(fpprgr)
     d fpril1_rkat     s                   like(fprkat)
     d fpril1_kkat     s                   like(fpkkat)
     d fpril1_kund     s                   like(fpkund)
     d fpril1_kpro     s                   like(fpkpro)
     d fpril1_vare     s                   like(fpvare)
     d fpril1_enhe     s                   like(fpenhe)
     d fpril1_lety     s                   like(fplety)
5.70 d frabl1_prgr     s                   like(frprgr)
     d frabl1_rkat     s                   like(frrkat)
     d frabl1_kkat     s                   like(frkkat)
     d frabl1_kund     s                   like(frkund)
     d frabl1_kpro     s                   like(frkpro)
     d frabl1_ogrp     s                   like(frogrp)
     d frabl1_hgrp     s                   like(frhgrp)
     d frabl1_ugrp     s                   like(frugrp)
     d frabl1_ldor     s                   like(frldor)
     d frabl1_modn     s                   like(frmodn)
     d frabl1_vare     s                   like(frvare)
     d frabl1_enhe     s                   like(frenhe)
     d frabl1_lety     s                   like(frlety)
     d vbrkl1_alme     s                   like(vbalme)
     d vbrkl1_ogrp     s                   like(vbogrp)
     d vbrkl1_hgrp     s                   like(vbhgrp)
     d vbrkl1_ugrp     s                   like(vbugrp)
     d vbrkl1_modn     s                   like(vbmodn)
     d vbrkl1_vare     s                   like(vbvare)
     d vbrkl5_alme     s                   like(vbalme)
     d vbrkl5_vare     s                   like(vbvare)
     d rmbtl1_talm     s                   like(rmtalm)
     d rmbtl1_tbrt     s                   like(rmtbrt)
     d jvarl1_vare     s                   like(vvvare)
     d jvdtl1_dvar     s                   like(jvdvar)
6.10 d vmval1_mkod     s                   like(vamkod)
      *
      * Definering av variable
      *
     d b_pris          s              1    inz(*off)
     d b_ordr          s              1    inz(*off)
     d b_spes          s              1    inz(*off)
     d b_raba          s              1    inz(*off)
5.70 d b_prgr          s              1    inz(*off)
6.20 d b_inlr          s              1    inz(*off)
      *
     d w_rabd          s              5  2
     d w_raba          s              9  2
     d w_pasl          s              5  2
      *
     d w_firm          s                   like(vvfirm)
5.70 d w_prgr          s                   like(frprgr)
     d w_rkat          s                   like(rkrabk)
     d w_kkat          s                   like(rkkatg)
     d w_kund          s                   like(rkkund)
     d w_kpro          s                   like(flkpro)
     d w_avgf          s                   like(rkmkod)
     d w_spfa          s                   like(rkspfa)
     d w_priv          s                   like(flpriv)
     d w_alme          s                   like(rmxalm)
     d w_bupr          s                   like(vpbupr)
     d w_tipr          s                   like(vttip1)
     d w_lety          s                   like(vtlety)
     d w_sapr          s                   like(fpsapr)
     d w_kopr          s                   like(fpkopr)
     d w_ldor          s                   like(frldor)
6.28 d w_rab1          s                   like(fprab1)
6.28 d w_rab2          s                   like(fprab2)
     d w_rabn          s                   like(frrabn)
     d w_rabb          s                   like(frrabb)
     d w_rabt          s                   like(frrabt)
     d w_dekn          s                   like(frdekn)
     d w_dgpr          s                   like(vpsapr)
     d w_ntpr          s                   like(vpsapr)
     d w_tipr_w        s                   like(vttip1)
     d w_sapr_w        s                   like(vpsapr)
5.70 d w_lage          s              2  0
5.70 d p_vtyp          s                   like(vvvtyp)
6.20 d w_lldo          s                   like(vvldor)
6.33 d w_lv_nobb       s                   like(vvlnob)
6.33 d w_lv_modn       s                   like(vvlmod)
6.33 d w_lv_lldo       s                   like(vvlnle)
6.33 d w_lv_llva       s                   like(vvllva)
6.33 d w_modn          s                   like(vvlmod)
6.21 d w_pldo          s                   like(vpldor)
6.22 d w_udat          s                   like(vvudat)
      *
5.70 d                uds
5.70 d l_lage               1001   1002  0
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Hovedprogram
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Kaller intitierings-rutine
      *
     c                   exsr      init
      *
      * Hent opplysninger fra vare. Dersom vare ikke finnes avbrytes
      * programmet. Dersom VA-vare avbrytes også programmet dersom
      * salgspris ikke er oppgitt eller dersom kostpris ikke er oppgitt
      * når dekningsgrad er oppgitt.
      *
     c                   if        hiskaf = *off
     c                   eval      vvarl1_vare = hivare
     c     vvarl1_key    chain     vvarl1
     c                   if        not %found
     c                   goto      avslutt
     c                   endif
     c                   endif
      *
5.70 c                   call      'VL710R'
5.70 c                   parm                    w_firm
5.70 c                   parm                    vvvare
5.70 c                   parm                    w_lage
5.70 c                   parm                    p_vtyp
6.22 c                   parm                    w_udat
6.22 c                   parm                    w_lldo
6.22 c                   parm                    b_inlr
6.33 c                   parm                    w_lv_nobb
6.33 c                   parm                    w_lv_modn
6.33 c                   parm                    w_lv_lldo
6.33 c                   parm                    w_lv_llva
      *
6 24  * hvis lagervare : hvis leverandør på lager og denne er
6.24  * overstyrt fra kallende program, så brukes denne
6.24 c                   if        hiskaf = *off and
6.24 c                             hildor <> 0
6.24 c                   eval      w_lldo = hildor
6.24 c                   endif
      *
     c                   if        hiskaf = *on
      *
     c                   eval      jvarl1_vare = hivare
     c     jvarl1_key    chain     jvarl1
     c                   if        not %found
     c                   goto      avslutt
     c                   endif
      *
     c                   if        hisapr = 0 or
     c                             hikopr = 0 and
     c                             hidekn <> 0
     c                   goto      avslutt
     c                   endif
      *
     c                   eval      vvnmod = vvmodn
     c                   eval      vvkmva = 0
      *
     c                   eval      jvdtl1_dvar = hivare
     c     jvdtl1_key    chain     jvdtl1
     c                   if        %found
     c                   eval      vvkpri = jvdpko
     c                   if        jvdsko = 1
     c                   eval      p_vtyp = 'S'
     c                   endif
     c                   endif
      *
     c                   else
6.33 c                   if        w_lv_nobb > 0
6.33 c                   eval      vvnmod = w_lv_modn
6.33 c                   endif
     c                   endif
      *
      * Finner MVA-kode
      *
     c                   exsr      mva_kode
      *
      * Finner leverandør
      *
     c                   if        hiskaf = *off
6.23 c                   eval      w_ldor = w_lldo
     c                   else
     c                   eval      w_ldor = hildor
     c                   endif
      *
      * Henter standardpriser
      *
     c                   exsr      hent_standard
      *
      *
      * Henter pris fra ordre/tilbud
      *
     c                   if        hinumm <> 0
     c                   exsr      ordre
     c                   if        b_ordr = *on
     c                   goto      retur
     c                   endif
     c                   endif
      *
      * Beregner pris dersom dekning er utfylt
      *
     c                   if        hidekn <> 0
     c                   exsr      dekning
     c                   goto      retur
     c                   endif
5.70  *
5.70  * Hvis prisguppe, så prøver finner man spes.pris rabatt som gjelder for denne
5.70  * prisgruppen.
5.70  *
5.70 c                   if        b_prgr = *on
5.70 c                   eval      hoprgr = hiprgr
5.70 c                   eval      fpril1_prgr = hiprgr
5.70 c                   eval      frabl1_prgr = hiprgr
5.70 c                   exsr      hent_matrise
5.70 c                   goto      beregn
5.70 c                   endif
      *
      * Hent spesialpris, rabatt eller DG fra spesialpris-matrise og
      * rabattmatrise
      *
5.70 c                   eval      fpril1_prgr = *blank
5.70 c                   eval      frabl1_prgr = *blank
     c                   exsr      hent_matrise
      *
      * Hent brurksrett-rabatt
      *
     c                   exsr      hent_bruksrett
      *
      * Beregner priser og rabatter
      *
5.70 c     beregn        tag
     c                   exsr      beregn_pris
      *
      * Finner priskode, og legger denne i output-felt. Dersom varen er på
      * tilbud, og det er denne prisen som er benyttet, settes priskode
      * til 'T'.
      *
     c                   if        hokpri = *blank
     c                   if        w_tipr <> 0 and
     c                             w_tipr = hosapr
     c                   eval      hokpri = 'T'
6.30 c                   eval      hopkon = 'KAM'
6.30 c                   eval      hopkns = 'KAM'
6.27 c**                 eval      hoprgr = hiprgr
     c                   else
     c                   eval      hokpri = vvkpri
     c                   endif
     c                   endif
      *
      * Returnerer verdier til kallende program
      *
     c     retur         tag
      *
      * Danner DG-faktor utfra DG på vare eller undergruppe, eller utfra
      * input DG dersom denne er oppgitt
      *
     c                   eval(h)   hopros = (100 - vvdekn) / 100
      *
     c                   if        hidekn <> 0
     c                   eval(h)   hopros = (100 - hidekn) / 100
     c                   endif
      *
     c                   if        hopros = 1
     c                   eval      hopros = 0
     c                   endif
      *
      * Nullstiller kostpris dersom salgspris er null
      *
     c                   if        hosapr = 0
     c                   eval      hokopr = 0
6.30 c                   eval      hoinpr = 0
     c                   endif
      *
      * Kopierer output-datastruktur til output-parameter
      *
     c                   eval      p_orec = horec
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     avslutt       tag
      *
6.32 c*                  if        hiinlr <> *on
6.32 c                   if        hiinlr = *off
6.32  * lukker vl710r
6.32 c                   exsr      lukk_vl710
6.32  *
     c                   eval      *inlr = *on
     c                   endif
      *
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Finner MVA-kode
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     mva_kode      begsr
      *
      * Default mva-kode
      *
     c                   eval      hoomva = '3'
      *
      * Avgiftsfritt salg fir mva-kode '4'
      * Dersom kunde også skal ha spesialfaktura settes mva-kode til '0'
      *
     c                   if        w_avgf = 1
     c                   eval      hoomva = '4'
     c                   if        w_spfa = 1
     c                   eval      hoomva = '0'
     c                   endif
     c                   leavesr
     c                   endif
      *
      * Finner mva-kode på bakgrunn av momskode på varen
      * Sjekker om momskoder er lagt opp, bruker ellers gammel logikk
      *
     c                   eval      vmval1_mkod = vvkmva
     c     vmval1_key    chain     vmval1
     c                   if        %found
     c                   eval      hoomva = vamkof
     c                   else
     c                   select
     c                   when      vvkmva = 1
     c                   eval      hoomva = '4'
     c                   when      vvkmva = 2
     c                   eval      hoomva = 'H'
     c                   endsl
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å finne standardpriser fra vare-pris-register og
      * tilbudspris fra tilbuds-pris-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_standard begsr
      *
     c                   eval      b_pris = *off
5.70 c                   eval      b_prgr = *off
      *
      * Dersom VA-vare benyttes mottatte priser og leveringstype
      *
     c                   if        hiskaf = *on
     c                   eval      b_pris = *on
     c                   eval      holety = hilety
     c                   eval      hooppr = hisapr
     c                   eval      hosapr = hisapr
     c                   eval      hokopr = hikopr
6.30 c                   eval      hoinpr = hiinpr
     c                   leavesr
     c                   endif
      *
      * Finner salgspris og kostpris avhengig av dato og leveringstype
      * Dersom pris ikke ble funnet, og leveringstype er forskjellig
      * fra 0, hentes pris fra leveringstype 0
      *
6.20  * 1. leverandør for lageret
6.20 c                   eval      vvprl1_ldor = w_lldo
6.20 c                   exsr      hent_pris
6.20 c                   if        b_pris = *off  and
6.20 c                             w_lldo <> vvldor
6.20  * 2. hovedleverandør
6.20 c                   eval      vvprl1_ldor = vvldor
6.20 c                   exsr      hent_pris
6.20 c                   if        b_pris = *off
6.20  * siste mulighet...
6.20 c                   eval      vvprl1_ldor = 0
6.20 c                   exsr      hent_pris
6.20 c                   endif
6.20 c                   endif
      *
      * Behandling avhengig av om tilbud er valgt tatt med
      * Finner eventuell tilbudspris avhengig av tidspunkt og leveringstype
      * Dersom tilbud ikke ble funnet, og leveringstype er forskjellig
      * fra 0, hentes tilbud fra leveringstype 0
      *
     c                   if        hitilb <> *on
      *
6.21 c                   eval      vtill1_ogrp = 0
6.21 c                   eval      vtill1_hgrp = 0
6.21 c                   eval      vtill1_ugrp = 0
6.21 c                   eval      vtill1_ldor = 0
     c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = hiprgr
     c                   eval      vtill1_lety = hilety
     c     vtill1_key    setll     vtill1
     c     vtill1_key    reade     vtill1
     c                   dow       not %eof
     c                   if        hidato >= vtfdat and
     c                             hidato <= vttdat
     c                   if        hidato <> vtfdat or
     c                             hidato = vtfdat and
     c                             hitime >= vtftim
     c                   if        hidato <> vttdat or
     c                             hidato = vttdat and
     c                             hitime <= vtttim
      *
     c                   eval      hokamp = vtkamp
      *
     c                   select
     c                   when      hienhe = vtenh1
     c                   eval      w_lety = vtlety
     c                   eval      w_tipr = vttip1
     c                   if        vtkop1 <> 0
     c                   eval      hokopr = vtkop1
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
     c                   endif
6.30 c                   if        vtinp1 <> 0
6.30 c                   eval      hoinpr = vtinp1
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
     c                   when      hienhe = vtenh2
     c                   eval      w_lety = vtlety
     c                   eval      w_tipr = vttip2
     c                   if        vtkop2 <> 0
     c                   eval      hokopr = vtkop2
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
     c                   endif
6.30 c                   if        vtinp2 <> 0
6.30 c                   eval      hoinpr = vtinp2
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
     c                   when      hienhe = vtenh3
     c                   eval      w_lety = vtlety
     c                   eval      w_tipr = vttip3
     c                   if        vtkop3 <> 0
     c                   eval      hokopr = vtkop3
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
     c                   endif
6.30 c                   if        vtinp3 <> 0
6.30 c                   eval      hoinpr = vtinp3
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
     c                   endsl
      *
     c                   leave
      *
     c                   endif
     c                   endif
     c                   endif
     c     vtill1_key    reade     vtill1
     c                   enddo
      *
     c                   if        w_tipr = 0 and
     c                             hilety <> 0
     c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = hiprgr
     c                   eval      vtill1_lety = 0
     c     vtill1_key    setll     vtill1
     c     vtill1_key    reade     vtill1
     c                   dow       not %eof
     c                   if        hidato >= vtfdat and
     c                             hidato <= vttdat
     c                   if        hidato <> vtfdat or
     c                             hidato = vtfdat and
     c                             hitime >= vtftim
     c                   if        hidato <> vttdat or
     c                             hidato = vttdat and
     c                             hitime <= vtttim
      *
     c                   eval      hokamp = vtkamp
      *
     c                   select
     c                   when      hienhe = vtenh1
     c                   eval      w_lety = vtlety
     c                   eval      w_tipr = vttip1
     c                   if        vtkop1 <> 0
     c                   eval      hokopr = vtkop1
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
     c                   endif
6.30 c                   if        vtinp1 <> 0
6.30 c                   eval      hoinpr = vtinp1
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
     c                   when      hienhe = vtenh2
     c                   eval      w_lety = vtlety
     c                   eval      w_tipr = vttip2
     c                   if        vtkop2 <> 0
     c                   eval      hokopr = vtkop2
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
     c                   endif
6.30 c                   if        vtinp2 <> 0
6.30 c                   eval      hoinpr = vtinp2
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
     c                   when      hienhe = vtenh3
     c                   eval      w_lety = vtlety
     c                   eval      w_tipr = vttip3
     c                   if        vtkop3 <> 0
     c                   eval      hokopr = vtkop3
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
     c                   endif
6.30 c                   if        vtinp3 <> 0
6.30 c                   eval      hoinpr = vtinp3
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
     c                   endsl
      *
     c                   leave
      *
     c                   endif
     c                   endif
     c                   endif
     c     vtill1_key    reade     vtill1
     c                   enddo
     c                   endif
5.70  *
5.70  * Dersom pris ikke finnes for oppgitt prisgruppe, hentes pris fra
5.70  * prisgruppe blank
5.70  *
5.70 c                   if        w_tipr = 0 and
5.70 c                             hiprgr <> *blank
5.70 c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = *blank
5.70 c                   eval      vtill1_lety = hilety
5.70 c     vtill1_key    setll     vtill1
5.70 c     vtill1_key    reade     vtill1
5.70 c                   dow       not %eof
5.70 c                   if        hidato >= vtfdat and
5.70 c                             hidato <= vttdat
5.70 c                   if        hidato <> vtfdat or
5.70 c                             hidato = vtfdat and
5.70 c                             hitime >= vtftim
5.70 c                   if        hidato <> vttdat or
5.70 c                             hidato = vttdat and
5.70 c                             hitime <= vtttim
5.70  *
5.70 c                   eval      hokamp = vtkamp
6.27 c                   eval      hoprgr = vtprgr
5.70  *
5.70 c                   select
5.70 c                   when      hienhe = vtenh1
5.70 c                   eval      w_lety = vtlety
5.70 c                   eval      w_tipr = vttip1
5.70 c                   if        vtkop1 <> 0
5.70 c                   eval      hokopr = vtkop1
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
5.70 c                   endif
6.30 c                   if        vtinp1 <> 0
6.30 c                   eval      hoinpr = vtinp1
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
5.70 c                   when      hienhe = vtenh2
5.70 c                   eval      w_lety = vtlety
5.70 c                   eval      w_tipr = vttip2
5.70 c                   if        vtkop2 <> 0
5.70 c                   eval      hokopr = vtkop2
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
5.70 c                   endif
6.30 c                   if        vtinp2 <> 0
6.30 c                   eval      hoinpr = vtinp2
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
5.70 c                   when      hienhe = vtenh3
5.70 c                   eval      w_lety = vtlety
5.70 c                   eval      w_tipr = vttip3
5.70 c                   if        vtkop3 <> 0
5.70 c                   eval      hokopr = vtkop3
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
5.70 c                   endif
6.30 c                   if        vtinp3 <> 0
6.30 c                   eval      hoinpr = vtinp3
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
5.70 c                   endsl
5.70  *
5.70 c                   leave
5.70  *
5.70 c                   endif
5.70 c                   endif
5.70 c                   endif
5.70 c     vtill1_key    reade     vtill1
5.70 c                   enddo
5.70  *
5.70 c                   if        w_tipr = 0 and
5.70 c                             hilety <> 0
5.70 c                   eval      vtill1_vare = hivare
5.70 c                   eval      vtill1_prgr = *blank
5.70 c                   eval      vtill1_lety = 0
5.70 c     vtill1_key    setll     vtill1
5.70 c     vtill1_key    reade     vtill1
5.70 c                   dow       not %eof
5.70 c                   if        hidato >= vtfdat and
5.70 c                             hidato <= vttdat
5.70 c                   if        hidato <> vtfdat or
5.70 c                             hidato = vtfdat and
5.70 c                             hitime >= vtftim
5.70 c                   if        hidato <> vttdat or
5.70 c                             hidato = vttdat and
5.70 c                             hitime <= vtttim
5.70  *
5.70 c                   eval      hokamp = vtkamp
6.27 c                   eval      hoprgr = vtprgr
5.70  *
5.70 c                   select
5.70 c                   when      hienhe = vtenh1
5.70 c                   eval      w_lety = vtlety
5.70 c                   eval      w_tipr = vttip1
5.70 c                   if        vtkop1 <> 0
5.70 c                   eval      hokopr = vtkop1
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
5.70 c                   endif
6.30 c                   if        vtinp1 <> 0
6.30 c                   eval      hoinpr = vtinp1
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
5.70 c                   when      hienhe = vtenh2
5.70 c                   eval      w_lety = vtlety
5.70 c                   eval      w_tipr = vttip2
5.70 c                   if        vtkop2 <> 0
5.70 c                   eval      hokopr = vtkop2
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
5.70 c                   endif
6.30 c                   if        vtinp2 <> 0
6.30 c                   eval      hoinpr = vtinp2
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
5.70 c                   when      hienhe = vtenh3
5.70 c                   eval      w_lety = vtlety
5.70 c                   eval      w_tipr = vttip3
5.70 c                   if        vtkop3 <> 0
5.70 c                   eval      hokopr = vtkop3
6.30 c                   eval      hopkko = 'KAM'
6.30 c                   eval      hopkok = 'KAM'
5.70 c                   endif
6.30 c                   if        vtinp3 <> 0
6.30 c                   eval      hoinpr = vtinp3
6.30 c                   eval      hopkoi = 'KAM'
6.30 c                   endif
5.70 c                   endsl
5.70  *
5.70 c                   leave
5.70  *
5.70 c                   endif
5.70 c                   endif
5.70 c                   endif
5.70 c     vtill1_key    reade     vtill1
5.70 c                   enddo
5.70 c                   endif
5.70  *
5.70 c                   endif
      *
     c                   endif
6.21  *
6.21  * Dersom tilbud ikke ble funnet på oppgitt vare/prisgruppe/leveringstupe
6.21  * sjekkes varegruppe / leverandør
6.21  *
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_prgr = hiprgr
6.26 c                   eval      w_prgr      = hiprgr
6.25 c                   exsr      tilb_sjekk
6.25 c                   if        w_tipr = 0 and
6.25 c                             hiprgr <> *blank
6.25 c                   eval      vtill1_prgr = *blank
6.26 c                   eval      w_prgr      = *Blank
6.25 c                   exsr      tilb_sjekk
6.25 c                   endif
6.25 c                   endif
      *
      * Dersom kostpris 0, beregnes kostpris ut fra deknigsgrad på vare
      * eller undergruppe.
      *
     c                   if        hokopr = 0
      *
     c                   if        vvdekn = 0
     c                   eval      vugrl1_uogr = vvogrp
     c                   eval      vugrl1_uhgr = vvhgrp
     c                   eval      vugrl1_uugr = vvugrp
     c     vugrl1_key    chain     vugrl1r
     c                   if        %found
     c                   eval      vvdekn = vgudek
     c                   endif
     c                   endif
      *
     c                   eval(h)   hokopr = hosapr * vvdekn / 100
     c                   if        hokopr <> 0
     c                   eval      hokopr = hosapr - hokopr
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      *
6.20  *-------------------------------------------------------------------------
6.20  * Henter fra vare-pris, først med evt. utfylt prisgruppe, så prisgr. blank
6.20  *** Koden er flyttet i egen subr. for å gjøre det mer fleksibelt ***
6.20  *-------------------------------------------------------------------------
6.20  *
6.20 c     hent_pris     begsr
6.20  *
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = hiprgr
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = hilety
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   if        hiprgr <> *blank
6.20 c                   eval      b_prgr = *on
6.20 c                   endif
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.30 c                   eval      hoinpr = vpinpr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.30 c                   eval      hopkon = 'VEI'
6.30 c                   eval      hopkns = 'VEI'
6.30 c                   eval      hopkko = 'VEI'
6.30 c                   eval      hopkok = 'VEI'
6.30 c                   eval      hopkoi = 'VEI'
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20  *
6.20 c                   if        b_pris = *off and
6.20 c                             hilety <> 0
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = hiprgr
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = 0
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   if        hiprgr <> *blank
6.20 c                   eval      b_prgr = *on
6.20 c                   endif
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.30 c                   eval      hoinpr = vpinpr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.30 c                   eval      hopkon = 'VEI'
6.30 c                   eval      hopkns = 'VEI'
6.30 c                   eval      hopkko = 'VEI'
6.30 c                   eval      hopkok = 'VEI'
6.30 c                   eval      hopkoi = 'VEI'
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20 c                   endif
6.20  *
6.20  * Dersom pris ikke finnes for oppgitt prisgruppe, hentes pris fra
6.20  * prisgruppe blank
6.20  *
6.20 c                   if        b_pris = *off and
6.20 c                             hiprgr <> *blank
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = *blank
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = hilety
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.30 c                   eval      hoinpr = vpinpr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.30 c                   eval      hopkon = 'VEI'
6.30 c                   eval      hopkns = 'VEI'
6.30 c                   eval      hopkko = 'VEI'
6.30 c                   eval      hopkok = 'VEI'
6.30 c                   eval      hopkoi = 'VEI'
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20  *
6.20 c                   if        b_pris = *off and
6.20 c                             hilety <> 0
6.20 c                   eval      vvprl1_vare = hivare
6.20 c                   eval      vvprl1_prgr = *blank
6.20 c                   eval      vvprl1_enhe = hienhe
6.20 c                   eval      vvprl1_lety = 0
6.20 c     vvprl1_key    setll     vvprl1
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   dow       not %eof
6.20 c                   eval      b_pris = *on
6.20 c                   eval      holety = vplety
6.20 c                   eval      hooppr = vpsapr
6.20 c                   eval      hosapr = vpsapr
6.20 c                   eval      hokopr = vpkopr
6.30 c                   eval      hoinpr = vpinpr
6.20 c                   eval      w_bupr = vpbupr
6.21 c                   eval      w_pldo = vpldor
6.30 c                   eval      hopkon = 'VEI'
6.30 c                   eval      hopkns = 'VEI'
6.30 c                   eval      hopkko = 'VEI'
6.30 c                   eval      hopkok = 'VEI'
6.30 c                   eval      hopkoi = 'VEI'
6.20 c                   if        hidato >= vppdat
6.20 c                   leave
6.20 c                   endif
6.20 c     vvprl1_key    reade     vvprl1
6.20 c                   enddo
6.20 c                   endif
6.20  *
6.20 c                   endif
6.20  *
6.20 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente pris fra ordre/tilbud
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     ordre         begsr
      *
     c                   eval      b_ordr = *off
      *
     c                   eval      fohel1_numm = hinumm
     c                   eval      fohel1_suff = 0
     c     fohel1_key    chain     fohel1r
     c                   if        %found
      *
     c                   eval      fodtlv_vare = hivare
     c                   eval      fodtlv_numm = hinumm
     c                   eval      fodtlv_suff = 0
     c                   eval      fodtlv_enh1 = hienhe
     c     fodtlv_key    chain     fodtlvr
     c                   if        %found
     c                   eval      b_ordr = *on
     c                   eval      hokopr = fdkopr
6.30 c                   eval      hoinpr = fdinpr
     c                   eval      hosapr = fdsapr
     c                   eval      horab1 = fdrab1
     c                   eval      horab2 = fdrab2
     c                   eval      hokpri = fdkpri
6.30 c                   eval      hopkon = 'ORD'
6.30 c                   eval      hopkns = 'ORD'
6.30 c                   eval      hopkko = 'ORD'
6.30 c                   eval      hopkok = 'ORD'
6.30 c                   eval      hopkoi = 'ORD'
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Beregner salgspris utfra påslag
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     dekning       begsr
      *
     c                   eval      hokpri = *blank
     c                   eval      hodekn = hidekn
      *
      * Ønsket dekningsgrad vises som ordinær pris - rabatt
      *
     c                   if        hikode = *blank
      *
     c                   eval      w_sapr_w = hosapr
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
6.31 c                   if        (hokopr * 100) < 9999999,99
     c                   eval      hosapr = hokopr * 100
6.31 c                   else
6.31 c                   eval      hosapr = 9999999,99
6.31 c                   endif
     c                   eval      w_pasl = 100 - hidekn
     c                   if        w_pasl <> 0
     c                   eval(h)   hosapr = hosapr / w_pasl
     c                   endif
      *
     c                   if        hosapr > w_sapr_w
     c                   eval      hosapr = w_sapr_w
     c                   endif
      *
     c                   eval      w_raba = w_sapr_w - hosapr
     c                   eval      hosapr = w_sapr_w
6.31 c                   if        (w_raba * 100) < 9999999,99
     c                   eval      w_raba = w_raba * 100
6.31 c                   else
6.31 c                   eval      w_raba = 9999999,99
6.31 c                   endif
      *
     c                   if        hosapr <> 0
     c                   eval(h)   horab1 = w_raba / hosapr
     c                   eval      horab2 = 0
     c                   endif
      *
     c                   endif
      *
      * Ønsket dekningsgrad vises kun som pris
      *
     c                   if        hikode = 'P'
     c                   if        hokopr <> 0
     c                   eval      hokpri = *blank
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
6.31 c                   if        (hokopr * 100) < 9999999,99
     c                   eval      hosapr = hokopr * 100
6.31 c                   else
6.31 c                   eval      hosapr = 9999999,99
6.31 c                   endif
     c                   eval      w_pasl = 100 - hidekn
     c                   eval(h)   hosapr = hosapr / w_pasl
     c                   endif
     c                   endif
      *
      * Ønsket dekningsgrad er ikke dekningsgrad, men en fast rabatt
      *
     c                   if        hikode = 'R'
     c                   eval      horab1 = hidekn
     c                   eval      horab2 = 0
     c                   eval      hodekn = 0
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente rabatter/DG fra rabattmatrise
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_matrise  begsr
      *
      * Avbryter dersom hverken rabattkategori eller kunde er oppgitt
      *
     c***                if        w_rkat = 0 and
     c***                          w_kund = 0
     c***                leavesr
     c***                endif
      *
      * Finner spesialpris eller rabatt/DG
      * Leter først etter spesialpris innenfor et nivå, og så på rabatt/DG
      * innenfor nivået dersom spesialpris ikke ble funnet.
      * Dersom nivå ikke finnes, eller dersom rabatt/DG innenfor nivået
      * ikke er aktivt, fortsettes det nedover i nivåene.
      *
      * Dersom leveringstype er forskjellig fra 0 og spesialpris ikke ble
      * funnet, letes det etter spesialpris på leveringstype 0.
      *
      * Det letes kun etter rabatter på den leveringstypen prisen er
      * hentet fra.
      *
      * Nivårekkefølge:
      *
      *  Rabattkategori
      *    Kundekategori
      *      Kunde
      *        Kundeprosjekt
      *          Overgruppe
      *            Hovedgruppe
      *              Undergruppe
      *                Leverandør
      *                  Modul
      *                    Vare
      *                      Enhet
      *                        Leveringstype
      *  _____________________
      *  - - x x - - - - - x x x    1. Kunde,prosj,vare,enh,lt
      *  - - x x - - - - - x - x    2. Kunde,prosj,vare,lt
      *  - - x x - - - - - x x 0    3. Kunde,prosj,vare,enh,lt=0
      *  - - x x - - - - - x - 0    4. Kunde,prosj,vare,lt=0
      *  - - x x - - - - x - x x    5. Kunde,prosj,modul,enh,lt
      *  - - x x - - - - x - - x    6. Kunde,prosj,modul,lt
      *  - - x x - - - - x - x 0    7. Kunde,prosj,modul,enh,lt=0
      *  - - x x - - - - x - - 0    8. Kunde,prosj,modul,lt=0
      *  - - x x x x x x - - x x    9. Kunde,prosj,ogr,hgr,ugr,lev,enh,lt
      *  - - x x x x x x - - - x   10. Kunde,prosj,ogr,hgr,ugr,lev,lt
      *  - - x x x x x x - - x 0   11. Kunde,prosj,ogr,hgr,ugr,lev,enh,lt=0
      *  - - x x x x x x - - - 0   12. Kunde,prosj,ogr,hgr,ugr,lev,lt=0
      *  - - x x x x - x - - x x   13. Kunde,prosj,ogr,hgr,lev,enh,lt
      *  - - x x x x - x - - - x   14. Kunde,prosj,ogr,hgr,lev,lt
      *  - - x x x x - x - - x 0   15. Kunde,prosj,ogr,hgr,lev,enh,lt=0
      *  - - x x x x - x - - - 0   16. Kunde,prosj,ogr,hgr,lev,lt=0
      *  - - x x x - - x - - x x   17. Kunde,prosj,ogr,lev,enh,lt
      *  - - x x x - - x - - - x   18. Kunde,prosj,ogr,lev,lt
      *  - - x x x - - x - - x 0   19. Kunde,prosj,ogr,lev,enh,lt=0
      *  - - x x x - - x - - - 0   20. Kunde,prosj,ogr,lev,lt=0
      *  - - x x - - - x - - x x   21. Kunde,prosj,lev,enh,lt
      *  - - x x - - - x - - - x   22. Kunde,prosj,lev,lt
      *  - - x x - - - x - - x 0   23. Kunde,prosj,lev,enh,lt=0
      *  - - x x - - - x - - - 0   24. Kunde,prosj,lev,lt=0
      *  - - x x x x x - - - x x   25. Kunde,prosj,ogr,hgr,ugr,enh,lt
      *  - - x x x x x - - - - x   26. Kunde,prosj,ogr,hgr,ugr,lt
      *  - - x x x x x - - - x 0   27. Kunde,prosj,ogr,hgr,ugr,enh,lt=0
      *  - - x x x x x - - - - 0   28. Kunde,prosj,ogr,hgr,ugr,lt=0
      *  - - x x x x - - - - x x   29. Kunde,prosj,ogr,hgr,enh,lt
      *  - - x x x x - - - - - x   30. Kunde,prosj,ogr,hgr,lt
      *  - - x x x x - - - - x 0   31. Kunde,prosj,ogr,hgr,enh,lt=0
      *  - - x x x x - - - - - 0   32. Kunde,prosj,ogr,hgr,lt=0
      *  - - x x x - - - - - x x   33. Kunde,prosj,ogr,enh,lt
      *  - - x x x - - - - - - x   34. Kunde,prosj,ogr,lt
      *  - - x x x - - - - - x 0   35. Kunde,prosj,ogr,enh,lt=0
      *  - - x x x - - - - - - 0   36. Kunde,prosj,ogr,lt=0
      *  - - x x - - - - - - x x   37. Kunde,prosj,enh,lt
      *  - - x x - - - - - - - x   38. Kunde,prosj,lt
      *  - - x x - - - - - - x 0   39. Kunde,prosj,enh,lt=0
      *  - - x x - - - - - - - 0   40. Kunde,prosj,lt=0

      *  - - x - - - - - - x x x   41. Kunde,vare,enh,lt
      *  - - x - - - - - - x - x   42. Kunde,vare,lt
      *  - - x - - - - - - x x 0   43. Kunde,vare,enh,lt=0
      *  - - x - - - - - - x - 0   44. Kunde,vare,lt=0
      *  - - x - - - - - x - x x   45. Kunde,modul,enh,lt
      *  - - x - - - - - x - - x   46. Kunde,modul,lt
      *  - - x - - - - - x - x 0   47. Kunde,modul,enh,lt=0
      *  - - x - - - - - x - - 0   48. Kunde,modul,lt=0
      *  - - x - x x x x - - x x   49. Kunde,ogr,hgr,ugr,lev,enh,lt
      *  - - x - x x x x - - - x   50. Kunde,ogr,hgr,ugr,lev,lt
      *  - - x - x x x x - - x 0   51. Kunde,ogr,hgr,ugr,lev,enh,lt=0
      *  - - x - x x x x - - - 0   52. Kunde,ogr,hgr,ugr,lev,lt=0
      *  - - x - x x - x - - x x   53. Kunde,ogr,hgr,lev,enh,lt
      *  - - x - x x - x - - - x   54. Kunde,ogr,hgr,lev,lt
      *  - - x - x x - x - - x 0   55. Kunde,ogr,hgr,lev,enh,lt=0
      *  - - x - x x - x - - - 0   56. Kunde,ogr,hgr,lev,lt=0
      *  - - x - x - - x - - x x   57. Kunde,ogr,lev,enh,lt
      *  - - x - x - - x - - - x   58. Kunde,ogr,lev,lt
      *  - - x - x - - x - - x 0   59. Kunde,ogr,lev,enh,lt=0
      *  - - x - x - - x - - - 0   60. Kunde,ogr,lev,lt=0
      *  - - x - - - - x - - x x   61. Kunde,lev,enh,lt
      *  - - x - - - - x - - - x   62. Kunde,lev,lt
      *  - - x - - - - x - - x 0   63. Kunde,lev,enh,lt=0
      *  - - x - - - - x - - - 0   64. Kunde,lev,lt=0
      *  - - x - x x x - - - x x   65. Kunde,ogr,hgr,ugr,enh,lt
      *  - - x - x x x - - - - x   66. Kunde,ogr,hgr,ugr,lt
      *  - - x - x x x - - - x 0   67. Kunde,ogr,hgr,ugr,enh,lt=0
      *  - - x - x x x - - - - 0   68. Kunde,ogr,hgr,ugr,lt=0
      *  - - x - x x - - - - x x   69. Kunde,ogr,hgr,enh,lt
      *  - - x - x x - - - - - x   70. Kunde,ogr,hgr,lt
      *  - - x - x x - - - - x 0   71. Kunde,ogr,hgr,enh,lt=0
      *  - - x - x x - - - - - 0   72. Kunde,ogr,hgr,lt=0
      *  - - x - x - - - - - x x   73. Kunde,ogr,enh,lt
      *  - - x - x - - - - - - x   74. Kunde,ogr,lt
      *  - - x - x - - - - - x 0   75. Kunde,ogr,enh,lt=0
      *  - - x - x - - - - - - 0   76. Kunde,ogr,lt=0
      *  - - x - - - - - - - x x   77. Kunde,enh,lt
      *  - - x - - - - - - - - x   78. Kunde,lt
      *  - - x - - - - - - - x 0   79. Kunde,enh,lt=0
      *  - - x - - - - - - - - 0   80. Kunde,lt=0

7.01  *  x x - - - - - - - x x x   81. Rab.kat,Kundekat,vare,enh,lt
7.01  *  x x - - - - - - - x - x   82. Rab.kat,Kundekat,vare,lt
7.01  *  x x - - - - - - - x x 0   83. Rab.kat,Kundekat,vare,enh,lt=0
7.01  *  x x - - - - - - - x - 0   84. Rab.kat,Kundekat,vare,lt=0
7.01  *  x x - - - - - - x - x x   85. Rab.kat,Kundekat,modul,enh,lt
7.01  *  x x - - - - - - x - - x   86. Rab.kat,Kundekat,modul,lt
7.01  *  x x - - - - - - x - x 0   87. Rab.kat,Kundekat,modul,enh,lt=0
7.01  *  x x - - - - - - x - - 0   88. Rab.kat,Kundekat,modul,lt=0
7.01  *  x x - - x x x x - - x x   89. Rab.kat,Kundekat,ogr,hgr,ugr,lev,enh,lt
7.01  *  x x - - x x x x - - - x   90. Rab.kat,Kundekat,ogr,hgr,ugr,lev,lt
7.01  *  x x - - x x x x - - x 0   91. Rab.kat,Kundekat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  x x - - x x x x - - - 0   92. Rab.kat,Kundekat,ogr,hgr,ugr,lev,lt=0
7.01  *  x x - - x x - x - - x x   93. Rab.kat,Kundekat,ogr,hgr,lev,enh,lt
7.01  *  x x - - x x - x - - - x   94. Rab.kat,Kundekat,ogr,hgr,lev,lt
7.01  *  x x - - x x - x - - x 0   95. Rab.kat,Kundekat,ogr,hgr,lev,enh,lt=0
7.01  *  x x - - x x - x - - - 0   96. Rab.kat,Kundekat,ogr,hgr,lev,lt=0
7.01  *  x x - - x - - x - - x x   97. Rab.kat,Kundekat,ogr,lev,enh,lt
7.01  *  x x - - x - - x - - - x   98. Rab.kat,Kundekat,ogr,lev,lt
7.01  *  x x - - x - - x - - x 0   99. Rab.kat,Kundekat,ogr,lev,enh,lt=0
7.01  *  x x - - x - - x - - - 0  100. Rab.kat,Kundekat,ogr,lev,lt=0
7.01  *  x x - - - - - x - - x x  101. Rab.kat,Kundekat,lev,enh,lt
7.01  *  x x - - - - - x - - - x  102. Rab.kat,Kundekat,lev,lt
7.01  *  x x - - - - - x - - x 0  103. Rab.kat,Kundekat,lev,enh,lt=0
7.01  *  x x - - - - - x - - - 0  104. Rab.kat,Kundekat,lev,lt=0
7.01  *  x x - - x x x - - - x x  105. Rab.kat,Kundekat,ogr,hgr,ugr,enh,lt
7.01  *  x x - - x x x - - - - x  106. Rab.kat,Kundekat,ogr,hgr,ugr,lt
7.01  *  x x - - x x x - - - x 0  107. Rab.kat,Kundekat,ogr,hgr,ugr,enh,lt=0
7.01  *  x x - - x x x - - - - 0  108. Rab.kat,Kundekat,ogr,hgr,ugr,lt=0
7.01  *  x x - - x x - - - - x x  109. Rab.kat,Kundekat,ogr,hgr,enh,lt
7.01  *  x x - - x x - - - - - x  110. Rab.kat,Kundekat,ogr,hgr,lt
7.01  *  x x - - x x - - - - x 0  111. Rab.kat,Kundekat,ogr,hgr,enh,lt=0
7.01  *  x x - - x x - - - - - 0  112. Rab.kat,Kundekat,ogr,hgr,lt=0
7.01  *  x x - - x - - - - - x x  113. Rab.kat,Kundekat,ogr,enh,lt
7.01  *  x x - - x - - - - - - x  114. Rab.kat,Kundekat,ogr,lt
7.01  *  x x - - x - - - - - x 0  115. Rab.kat,Kundekat,ogr,enh,lt=0
7.01  *  x x - - x - - - - - - 0  116. Rab.kat,Kundekat,ogr,lt=0
7.01  *  x x - - - - - - - - x x  117. Rab.kat,Kundekat,enh,lt
7.01  *  x x - - - - - - - - - x  118. Rab.kat,Kundekat,lt
7.01  *  x x - - - - - - - - x 0  119. Rab.kat,Kundekat,enh,lt=0
7.01  *  x x - - - - - - - - - 0  120. Rab.kat,Kundekat,lt=0
7.01  *
7.01  *  - x - - - - - - - x x x  121. Kundekat,vare,enh,lt
7.01  *  - x - - - - - - - x - x  122. Kundekat,vare,lt
7.01  *  - x - - - - - - - x x 0  123. Kundekat,vare,enh,lt=0
7.01  *  - x - - - - - - - x - 0  124. Kundekat,vare,lt=0
7.01  *  - x - - - - - - x - x x  125. Kundekat,modul,enh,lt
7.01  *  - x - - - - - - x - - x  126. Kundekat,modul,lt
7.01  *  - x - - - - - - x - x 0  127. Kundekat,modul,enh,lt=0
7.01  *  - x - - - - - - x - - 0  128. Kundekat,modul,lt=0
7.01  *  - x - - x x x x - - x x  129. Kundekat,ogr,hgr,ugr,lev,enh,lt
7.01  *  - x - - x x x x - - - x  130. Kundekat,ogr,hgr,ugr,lev,lt
7.01  *  - x - - x x x x - - x 0  131. Kundekat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  - x - - x x x x - - - 0  132. Kundekat,ogr,hgr,ugr,lev,lt=0
7.01  *  - x - - x x - x - - x x  133. Kundekat,ogr,hgr,lev,enh,lt
7.01  *  - x - - x x - x - - - x  134. Kundekat,ogr,hgr,lev,lt
7.01  *  - x - - x x - x - - x 0  135. Kundekat,ogr,hgr,lev,enh,lt=0
7.01  *  - x - - x x - x - - - 0  136. Kundekat,ogr,hgr,lev,lt=0
7.01  *  - x - - x - - x - - x x  137. Kundekat,ogr,lev,enh,lt
7.01  *  - x - - x - - x - - - x  138. Kundekat,ogr,lev,lt
7.01  *  - x - - x - - x - - x 0  139. Kundekat,ogr,lev,enh,lt=0
7.01  *  - x - - x - - x - - - 0  140. Kundekat,ogr,lev,lt=0
7.01  *  - x - - - - - x - - x x  141. Kundekat,lev,enh,lt
7.01  *  - x - - - - - x - - - x  142. Kundekat,lev,lt
7.01  *  - x - - - - - x - - x 0  143. Kundekat,lev,enh,lt=0
7.01  *  - x - - - - - x - - - 0  144. Kundekat,lev,lt=0
7.01  *  - x - - x x x - - - x x  145. Kundekat,ogr,hgr,ugr,enh,lt
7.01  *  - x - - x x x - - - - x  146. Kundekat,ogr,hgr,ugr,lt
7.01  *  - x - - x x x - - - x 0  147. Kundekat,ogr,hgr,ugr,enh,lt=0
7.01  *  - x - - x x x - - - - 0  148. Kundekat,ogr,hgr,ugr,lt=0
7.01  *  - x - - x x - - - - x x  149. Kundekat,ogr,hgr,enh,lt
7.01  *  - x - - x x - - - - - x  150. Kundekat,ogr,hgr,lt
7.01  *  - x - - x x - - - - x 0  151. Kundekat,ogr,hgr,enh,lt=0
7.01  *  - x - - x x - - - - - 0  152. Kundekat,ogr,hgr,lt=0
7.01  *  - x - - x - - - - - x x  153. Kundekat,ogr,enh,lt
7.01  *  - x - - x - - - - - - x  154. Kundekat,ogr,lt
7.01  *  - x - - x - - - - - x 0  155. Kundekat,ogr,enh,lt=0
7.01  *  - x - - x - - - - - - 0  156. Kundekat,ogr,lt=0
7.01  *  - x - - - - - - - - x x  157. Kundekat,enh,lt
7.01  *  - x - - - - - - - - - x  158. Kundekat,lt
7.01  *  - x - - - - - - - - x 0  159. Kundekat,enh,lt=0
7.01  *  - x - - - - - - - - - 0  160. Kundekat,lt=0
      *
7.01  *  x - - - - - - - - x x x  161. Rab.kat,vare,enh,lt
7.01  *  x - - - - - - - - x - x  162. Rab.kat,vare,lt
7.01  *  x - - - - - - - - x x 0  163. Rab.kat,vare,enh,lt=0
7.01  *  x - - - - - - - - x - 0  164. Rab.kat,vare,lt=0
7.01  *  x - - - - - - - x - x x  165. Rab.kat,modul,enh,lt
7.01  *  x - - - - - - - x - - x  166. Rab.kat,modul,lt
7.01  *  x - - - - - - - x - x 0  167. Rab.kat,modul,enh,lt=0
7.01  *  x - - - - - - - x - - 0  168. Rab.kat,modul,lt=0
7.01  *  x - - - x x x x - - x x  169. Rab.kat,ogr,hgr,ugr,lev,enh,lt
7.01  *  x - - - x x x x - - - x  170. Rab.kat,ogr,hgr,ugr,lev,lt
7.01  *  x - - - x x x x - - x 0  171. Rab.kat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  x - - - x x x x - - - 0  172. Rab.kat,ogr,hgr,ugr,lev,lt=0
7.01  *  x - - - x x - x - - x x  173. Rab.kat,ogr,hgr,lev,enh,lt
7.01  *  x - - - x x - x - - - x  174. Rab.kat,ogr,hgr,lev,lt
7.01  *  x - - - x x - x - - x 0  175. Rab.kat,ogr,hgr,lev,enh,lt=0
7.01  *  x - - - x x - x - - - 0  176. Rab.kat,ogr,hgr,lev,lt=0
7.01  *  x - - - x - - x - - x x  177. Rab.kat,ogr,lev,enh,lt
7.01  *  x - - - x - - x - - - x  178. Rab.kat,ogr,lev,lt
7.01  *  x - - - x - - x - - x 0  179. Rab.kat,ogr,lev,enh,lt=0
7.01  *  x - - - x - - x - - - 0  180. Rab.kat,ogr,lev,lt=0
7.01  *  x - - - - - - x - - x x  181. Rab.kat,lev,enh,lt
7.01  *  x - - - - - - x - - - x  182. Rab.kat,lev,lt
7.01  *  x - - - - - - x - - x 0  183. Rab.kat,lev,enh,lt=0
7.01  *  x - - - - - - x - - - 0  184. Rab.kat,lev,lt=0
7.01  *  x - - - x x x - - - x x  185. Rab.kat,ogr,hgr,ugr,enh,lt
7.01  *  x - - - x x x - - - - x  186. Rab.kat,ogr,hgr,ugr,lt
7.01  *  x - - - x x x - - - x 0  187. Rab.kat,ogr,hgr,ugr,enh,lt=0
7.01  *  x - - - x x x - - - - 0  188. Rab.kat,ogr,hgr,ugr,lt=0
7.01  *  x - - - x x - - - - x x  189. Rab.kat,ogr,hgr,enh,lt
7.01  *  x - - - x x - - - - - x  190. Rab.kat,ogr,hgr,lt
7.01  *  x - - - x x - - - - x 0  191. Rab.kat,ogr,hgr,enh,lt=0
7.01  *  x - - - x x - - - - - 0  192. Rab.kat,ogr,hgr,lt=0
7.01  *  x - - - x - - - - - x x  193. Rab.kat,ogr,enh,lt
7.01  *  x - - - x - - - - - - x  194. Rab.kat,ogr,lt
7.01  *  x - - - x - - - - - x 0  195. Rab.kat,ogr,enh,lt=0
7.01  *  x - - - x - - - - - - 0  196. Rab.kat,ogr,lt=0
7.01  *  x - - - - - - - - - x x  197. Rab.kat,enh,lt
7.01  *  x - - - - - - - - - - x  198. Rab.kat,lt
7.01  *  x - - - - - - - - - x 0  199. Rab.kat,enh,lt=0
7.01  *  x - - - - - - - - - - 0  200. Rab.kat,lt=0
      *
7.01  *  - - - - - - - - - x x x  201. Rab.kat,vare,enh,lt
7.01  *  - - - - - - - - - x - x  202. Rab.kat,vare,lt
7.01  *  - - - - - - - - - x x 0  203. Rab.kat,vare,enh,lt=0
7.01  *  - - - - - - - - - x - 0  204. Rab.kat,vare,lt=0
7.01  *  - - - - - - - - x - x x  205. Rab.kat,modul,enh,lt
7.01  *  - - - - - - - - x - - x  206. Rab.kat,modul,lt
7.01  *  - - - - - - - - x - x 0  207. Rab.kat,modul,enh,lt=0
7.01  *  - - - - - - - - x - - 0  208. Rab.kat,modul,lt=0
7.01  *  - - - - x x x x - - x x  209. Rab.kat,ogr,hgr,ugr,lev,enh,lt
7.01  *  - - - - x x x x - - - x  210. Rab.kat,ogr,hgr,ugr,lev,lt
7.01  *  - - - - x x x x - - x 0  211. Rab.kat,ogr,hgr,ugr,lev,enh,lt=0
7.01  *  - - - - x x x x - - - 0  212. Rab.kat,ogr,hgr,ugr,lev,lt=0
7.01  *  - - - - x x - x - - x x  213. Rab.kat,ogr,hgr,lev,enh,lt
7.01  *  - - - - x x - x - - - x  214. Rab.kat,ogr,hgr,lev,lt
7.01  *  - - - - x x - x - - x 0  215. Rab.kat,ogr,hgr,lev,enh,lt=0
7.01  *  - - - - x x - x - - - 0  216. Rab.kat,ogr,hgr,lev,lt=0
7.01  *  - - - - x - - x - - x x  217. Rab.kat,ogr,lev,enh,lt
7.01  *  - - - - x - - x - - - x  218. Rab.kat,ogr,lev,lt
7.01  *  - - - - x - - x - - x 0  219. Rab.kat,ogr,lev,enh,lt=0
7.01  *  - - - - x - - x - - - 0  220. Rab.kat,ogr,lev,lt=0
7.01  *  - - - - - - - x - - x x  221. Rab.kat,lev,enh,lt
7.01  *  - - - - - - - x - - - x  222. Rab.kat,lev,lt
7.01  *  - - - - - - - x - - x 0  223. Rab.kat,lev,enh,lt=0
7.01  *  - - - - - - - x - - - 0  224. Rab.kat,lev,lt=0
7.01  *  - - - - x x x - - - x x  225. Rab.kat,ogr,hgr,ugr,enh,lt
7.01  *  - - - - x x x - - - - x  226. Rab.kat,ogr,hgr,ugr,lt
7.01  *  - - - - x x x - - - x 0  227. Rab.kat,ogr,hgr,ugr,enh,lt=0
7.01  *  - - - - x x x - - - - 0  228. Rab.kat,ogr,hgr,ugr,lt=0
7.01  *  - - - - x x - - - - x x  229. Rab.kat,ogr,hgr,enh,lt
7.01  *  - - - - x x - - - - - x  230. Rab.kat,ogr,hgr,lt
7.01  *  - - - - x x - - - - x 0  231. Rab.kat,ogr,hgr,enh,lt=0
7.01  *  - - - - x x - - - - - 0  232. Rab.kat,ogr,hgr,lt=0
7.01  *  - - - - x - - - - - x x  233. Rab.kat,ogr,enh,lt
7.01  *  - - - - x - - - - - - x  234. Rab.kat,ogr,lt
7.01  *  - - - - x - - - - - x 0  235. Rab.kat,ogr,enh,lt=0
7.01  *  - - - - x - - - - - - 0  236. Rab.kat,ogr,lt=0
7.01  *  - - - - - - - - - - x x  237. Rab.kat,enh,lt
7.01  *  - - - - - - - - - - - x  238. Rab.kat,lt
7.01  *  - - - - - - - - - - x 0  239. Rab.kat,enh,lt=0
7.01  *  - - - - - - - - - - - 0  240. Rab.kat,lt=0
      *
      * Kunde/kundeprosjekt...
      *
     c                   if        w_kund <> 0 and
     c                             w_kpro <> 0
      *
      * 1.-4.
      *
     c                   eval      fpril1_rkat = 0
     c                   eval      fpril1_kkat = 0
     c                   eval      fpril1_kund = w_kund
     c                   eval      fpril1_kpro = w_kpro
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = w_kund
     c                   eval      frabl1_kpro = w_kpro
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 5.-8.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 9.-12.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 13.-16.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 17.-20.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 21.-24.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 25.-28.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 29.-32.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 33.-36.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 37.-40.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * Kunde...
      *
     c                   if        w_kund <> 0
      *
      * 41.-44.
      *
     c                   eval      fpril1_rkat = 0
     c                   eval      fpril1_kkat = 0
     c                   eval      fpril1_kund = w_kund
     c                   eval      fpril1_kpro = 0
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = w_kund
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 45.-48.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 49.-52.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 53.-56.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 57.-60.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 61.-64.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * 65.-68.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 69.-72.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 73.-76.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
      * 77.-80.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  *
7.01  * Kundekategori og rabattkategori
7.01  *
7.01 c                   if        w_kkat <> 0 and
7.01 c                             w_rkat <> 0
7.01  *
7.01  * 81.-84.
7.01  *
7.01 c                   eval      fpril1_rkat = w_rkat
7.01 c                   eval      fpril1_kkat = w_kkat
7.01 c                   eval      fpril1_kund = 0
7.01 c                   eval      fpril1_kpro = 0
7.01 c                   eval      fpril1_vare = hivare
7.01 c                   eval      fpril1_enhe = hienhe
7.01 c                   eval      fpril1_lety = hilety
7.01 c     fpril1_key    chain     fpril1
7.01 c                   if        %found
7.01 c                   exsr      spesialpris
7.01 c                   if        b_spes = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_rkat = w_rkat
7.01 c                   eval      frabl1_kkat = w_kkat
7.01 c                   eval      frabl1_kund = 0
7.01 c                   eval      frabl1_kpro = 0
7.01 c                   eval      frabl1_ogrp = 0
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = hivare
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0
7.01 c                   eval      fpril1_lety = 0
7.01 c     fpril1_key    chain     fpril1
7.01 c                   if        %found
7.01 c                   exsr      spesialpris
7.01 c                   if        b_spes = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 85.-88.
7.01  *
7.01 c                   if        vvnmod <> 0
7.01  *
7.01 c                   eval      frabl1_modn = vvnmod
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 89.-92.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = vvugrp
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 93.-96.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 97.-100.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 101.-104.
7.01  *
7.01 c                   if        w_ldor <> 0
7.01  *
7.01 c                   eval      frabl1_ogrp = 0
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = w_ldor
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 105.-108.
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = vvugrp
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 109.-112.
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = vvhgrp
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 113.-116.
7.01  *
7.01 c                   eval      frabl1_ogrp = vvogrp
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * 117.-120.
7.01  *
7.01 c                   eval      frabl1_ogrp = 0
7.01 c                   eval      frabl1_hgrp = 0
7.01 c                   eval      frabl1_ugrp = 0
7.01 c                   eval      frabl1_ldor = 0
7.01 c                   eval      frabl1_modn = 0
7.01 c                   eval      frabl1_vare = *blank
7.01 c                   eval      frabl1_enhe = hienhe
7.01  *
7.01 c                   if        hilety = holety
7.01  *
7.01 c                   eval      frabl1_lety = hilety
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   if        hilety <> 0 and
7.01 c                             holety = 0
7.01  *
7.01 c                   eval      frabl1_enhe = hienhe
7.01 c                   eval      frabl1_lety = 0
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   eval      frabl1_enhe = *blank
7.01 c     frabl1_key    chain     frabl1
7.01 c                   if        %found
7.01 c                   exsr      rabatt
7.01 c                   if        b_raba = *on
7.01 c                   leavesr
7.01 c                   endif
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01 c                   endif
7.01  *
7.01  * Kundekategori...
      *
     c                   if        w_kkat <> 0
      *
7.01  * 121.-124.
      *
     c                   eval      fpril1_rkat = 0
     c                   eval      fpril1_kkat = w_kkat
     c                   eval      fpril1_kund = 0
     c                   eval      fpril1_kpro = 0
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = w_kkat
     c                   eval      frabl1_kund = 0
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 125.-128.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 129.-132.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 133.-136.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 137.-140.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 141.-144.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 145.-148.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 149.-152.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 153.-156.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 157.-160.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * Rabattkategori...
      *
     c                   if        w_rkat <> 0
      *
7.01  * 161.-164.
      *
     c                   eval      fpril1_rkat = w_rkat
     c                   eval      fpril1_kkat = 0
     c                   eval      fpril1_kund = 0
     c                   eval      fpril1_kpro = 0
     c                   eval      fpril1_vare = hivare
     c                   eval      fpril1_enhe = hienhe
     c                   eval      fpril1_lety = hilety
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_rkat = w_rkat
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = 0
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0
     c                   eval      fpril1_lety = 0
     c     fpril1_key    chain     fpril1
     c                   if        %found
     c                   exsr      spesialpris
     c                   if        b_spes = *on
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 165.-168.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 169.-172.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 173.-176.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 177.-180.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 181.-184.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 185.-188.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 189.-192.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 193.-196.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 197.-200.
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
      * Generell...
      *
7.01  * 201.-204.
      *
     c                   eval      frabl1_rkat = 0
     c                   eval      frabl1_kkat = 0
     c                   eval      frabl1_kund = 0
     c                   eval      frabl1_kpro = 0
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = hivare
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 205.-208.
      *
     c                   if        vvnmod <> 0
      *
     c                   eval      frabl1_modn = vvnmod
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 209.-212.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 213.-216.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 227.-230.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 221.-224.
      *
     c                   if        w_ldor <> 0
      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = w_ldor
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endif
      *
7.01  * 225.-228.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = vvugrp
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 229.-232.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = vvhgrp
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 233.-236.
      *
     c                   eval      frabl1_ogrp = vvogrp
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
7.01  * 237.-240.


      *
     c                   eval      frabl1_ogrp = 0
     c                   eval      frabl1_hgrp = 0
     c                   eval      frabl1_ugrp = 0
     c                   eval      frabl1_ldor = 0
     c                   eval      frabl1_modn = 0
     c                   eval      frabl1_vare = *blank
     c                   eval      frabl1_enhe = hienhe
      *
     c                   if        hilety = holety
      *
     c                   eval      frabl1_lety = hilety
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   if        hilety <> 0 and
     c                             holety = 0
      *
     c                   eval      frabl1_enhe = hienhe
     c                   eval      frabl1_lety = 0
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   eval      frabl1_enhe = *blank
     c     frabl1_key    chain     frabl1
     c                   if        %found
     c                   exsr      rabatt
     c                   if        b_raba = *on
     c                   leavesr
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente bruksrett-rabatt
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     hent_bruksrettbegsr
      *
      * Avbryter dersom kunde ikke er knyttet mot almenning, eller
      * dersom det er valgt å oppheve bruksretten på salget
      *
     c                   if        w_alme = 0 or
     c                             w_priv = 1
     c                   leavesr
     c                   endif
      *
      * Leter først etter bruksrett på varenivå
      *
     c                   eval      vbrkl5_alme = w_alme
     c                   eval      vbrkl5_vare = vvvare
     c     vbrkl5_key    chain     vbrkl5
     c                   if        not %found
      *
      * Leter etter bruksrett på modul og varegruppe-nivå
      *
     c                   eval      vbrkl1_alme = w_alme
     c                   eval      vbrkl1_ogrp = vvogrp
     c                   eval      vbrkl1_hgrp = vvhgrp
     c                   eval      vbrkl1_ugrp = vvugrp
     c                   eval      vbrkl1_modn = vvnmod
     c                   eval      vbrkl1_vare = *blank
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   eval      vbrkl1_modn = 0
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   eval      vbrkl1_ugrp = 0
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   eval      vbrkl1_hgrp = 0
     c     vbrkl1_key    chain     vbrkl1
     c                   if        not %found
     c                   leavesr
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   endif
      *
     c                   eval      hoalme = w_alme
     c                   eval      hobrty = vbbrty
      *
     c                   eval      rmbtl1_talm = w_alme
     c                   eval      rmbtl1_tbrt = vbbrty
     c     rmbtl1_key    chain     rmbtl1
     c                   if        %found
     c                   eval      hobrr1 = rmtra1
     c                   eval      hobrr2 = rmtra2
     c                   if        hoomva <> '4' and
     c                             hoomva <> '0'
     c                   eval      hoomva = rmtmva
     c                   endif
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente spesialprisinformasjon fra spesialpris-
      * matrise
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     spesialpris   begsr
      *
     c                   eval      b_spes = *off
      *
     c                   eval      w_sapr = 0
     c                   eval      w_rab1 = 0
     c                   eval      w_rab2 = 0
     c                   eval      w_kopr = 0
      *
     c                   if        fpfdat = *loval or
     c                             hidato >= fpfdat and
     c                             hidato <= fptdat
      *
     c                   eval      b_spes = *on
      *
     c                   eval      w_sapr = fpsapr
     c                   eval      w_rab1 = fprab1
     c                   eval      w_rab2 = fprab2
     c                   eval      w_kopr = fpkopr
      *
     c                   eval      hopkon = 'SPS'
6.30 c                   eval      hopkns = 'SPS'
     c                   if        fpkopr <> 0
6.30 c                   eval      hopkko = 'SPS'
6.30 c                   eval      hopkok = 'SPS'
     c                   endif
     c                   eval      holety = fplety
      *
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for å hente rabatter eller DG etter treff i rabatt-
      * matrisen
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     rabatt        begsr
      *
     c                   eval      b_raba = *off
      *
     c                   eval      w_rab1 = 0
     c                   eval      w_rab2 = 0
     c                   eval      w_rabn = 0
     c                   eval      w_rabb = 0
     c                   eval      w_rabt = 0
     c                   eval      w_dekn = 0
      *
      * Henter rabatter i.h.t. dato og nivå i rabattmatrisen
      *
      * 0-rabatt
      *
     c                   if        frrab1 = 0 and
     c                             frra1d = 0 and
     c                             frrab2 = 0 and
     c                             frra2d = 0 and
     c                             frrabn = 0 and
     c                             frrand = 0 and
     c                             frrabb = 0 and
     c                             frrabd = 0 and
     c                             frrabt = 0 and
     c                             frratd = 0 and
     c                             frdekn = 0 and
     c                             frdekd = 0
     c                   eval      b_raba = *on
     c                   leavesr
     c                   endif
      *
      * Linjerabatt 1
      *
     c                   if        frrab1 <> 0 or
     c                             frra1d <> 0
      *
     c                   if        frra1d <> 0 and
     c                             hidato >= frra1f and
     c                             hidato <= frra1t
     c                   eval      w_rab1 = frra1d
     c                   else
     c                   eval      w_rab1 = frrab1
     c                   endif
      *
     c                   endif
      *
      * Linjerabatt 2
      *
     c                   if        frrab2 <> 0 or
     c                             frra2d <> 0
      *
     c                   if        frra2d <> 0 and
     c                             hidato >= frra2f and
     c                             hidato <= frra2t
     c                   eval      w_rab2 = frra2d
     c                   else
     c                   eval      w_rab2 = frrab2
     c                   endif
      *
     c                   endif
      *
      * Rabatt på nettopris
      *
     c                   if        frrabn <> 0 or
     c                             frrand <> 0
      *
     c                   if        frrand <> 0 and
     c                             hidato >= frranf and
     c                             hidato <= frrant
     c                   eval      w_rabn = frrand
     c                   else
     c                   eval      w_rabn = frrabn
     c                   endif
      *
     c                   endif
      *
      * Rabatt på bunnpris
      *
     c                   if        frrabb <> 0 or
     c                             frrabd <> 0
      *
     c                   if        frrabd <> 0 and
     c                             hidato >= frrbuf and
     c                             hidato <= frrbut
     c                   eval      w_rabb = frrabd
     c                   else
     c                   eval      w_rabb = frrabb
     c                   endif
      *
     c                   endif
      *
      * Rabatt på tilbudspris
      *
     c                   if        frrabt <> 0 or
     c                             frratd <> 0
      *
     c                   if        frratd <> 0 and
     c                             hidato >= frratf and
     c                             hidato <= frratt
     c                   eval      w_rabt = frratd
     c                   else
     c                   eval      w_rabt = frrabt
     c                   endif
      *
     c                   endif
      *
      * Dekningsgrad (DG). DG hentes kun dersom kostpris er funnet.
      *
     c                   if        hokopr <> 0
     c                   if        frdekn <> 0 or
     c                             frdekd <> 0
      *
     c                   if        frdekd <> 0 and
     c                             hidato >= frdekf and
     c                             hidato <= frdekt
     c                   eval      w_dekn = frdekd
     c                   else
     c                   eval      w_dekn = frdekn
     c                   endif
      *
     c                   endif
     c                   endif
      *
      * Sjekker om verdier er funnet i rabattmatrisen
      *
     c                   if        w_rab1 <> 0 or
     c                             w_rab2 <> 0 or
     c                             w_rabn <> 0 or
     c                             w_rabb <> 0 or
     c                             w_rabt <> 0 or
     c                             w_dekn <> 0
     c                   eval      b_raba = *on
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for beregning av rabatt/pris på vare
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     beregn_pris   begsr
      *
      * Dersom spesialpris er funnet skal denne benyttes
      * Dersom salgspris eller kostpris ikke er oppgitt som spesialpris,
      * benyttes standardverdier. Priskode settes alltid til 'A' (Avtalt)
      *
     c                   if        b_spes = *on
      *
     c                   eval      horab1 = w_rab1
     c                   eval      horab2 = w_rab2
     c                   eval      hokpri = 'A'
6.30 c                   eval      hopkon = 'SPS'
6.30 c                   eval      hopkns = 'SPS'
6.30 c                   eval      hopkko = 'SPS'
6.30 c                   eval      hopkok = 'SPS'
      *
     c                   if        w_sapr <> 0
     c                   eval      hosapr = w_sapr
     c                   endif
      *
     c                   if        w_kopr <> 0
     c                   eval      hokopr = w_kopr
     c                   endif
      *
     c                   leavesr
     c                   endif
      *
      * Dersom varen er diversevare eller tjeneste, eller dersom det ikke
      * ble treff i rabattmatrisen, kreves kjøper for laveste pris av
      * salgspris, butikkpris og tilbudspris
      *
5.70 c                   if        p_vtyp = 'D' or
5.70 c                             p_vtyp = 'T' or
     c                             b_raba = *off
     c                   if        w_bupr <> 0 and
     c                             w_bupr < hosapr
     c                   eval      hosapr = w_bupr
     c                   eval      hopkon = 'BUT'
6.30 c                   eval      hopkns = 'BUT'
     c                   endif
     c                   if        w_tipr <> 0 and
     c                             w_tipr < hosapr
     c                   eval      holety = w_lety
     c                   eval      hosapr = w_tipr
6.30 c                   eval      hopkon = 'KAM'
6.30 c                   eval      hopkns = 'KAM'
6.27 c**                 eval      hoprgr = hiprgr
     c                   endif
     c                   leavesr
     c                   endif
      *
      * hvis tilbudspris høyere enn veiledende
     c                   if        w_tipr <> 0 and
     c                             w_tipr >= hosapr
6.30 c                   eval      hopkon = 'VEI'
     c                   endif
      *
      * Initierer beregnet salgspris
      *
     c                   eval      w_tipr_w = w_tipr
     c                   eval      w_sapr_w = hosapr
      *
      * Beregner tilbudspris fratrukket eventuelle rabatter
      *
     c                   if        w_tipr <> 0 and
     c                             w_rabt <> 0
     c                   eval(h)   w_tipr_w = w_tipr -
     c                                       (w_tipr * w_rabt / 100 )
     c                   endif
      *
      * Beregner salgspris fratrukket eventuelle rabatter
      *
      * Bunnpriset-vare
      *
     c                   if        vvkpri = 'B'
     c                   if        w_rabb <> 0
     c                   eval(h)   w_sapr_w = hosapr -
     c                                        (hosapr * w_rabb / 100)
     c                   eval      hopkon = 'RAB'
6.30 c                   eval      hopkns = 'RAB'
     c                   endif
     c                   eval      horab1 = w_rabb
     c                   eval      horab2 = 0
     c                   endif
      *
      * Nettopriset-vare
      *
     c                   if        vvkpri = 'N'
     c                   if        w_rabn <> 0
     c                   eval(h)   w_sapr_w = hosapr -
     c                                        (hosapr * w_rabn / 100)
     c                   eval      hopkon = 'RAB'
6.30 c                   eval      hopkns = 'RAB'
     c                   endif
     c                   eval      horab1 = w_rabn
     c                   eval      horab2 = 0
     c                   endif
      *
      * Ordinært priset vare
      *
     c                   if        vvkpri = *blank
     c                   if        w_rab1 <> 0
     c                   eval(h)   w_sapr_w = hosapr -
     c                                       (hosapr * w_rab1 / 100)
     c                   eval      hopkon = 'RAB'
6.30 c                   eval      hopkns = 'RAB'
     c                   endif
     c                   if        w_rab2 <> 0
     c                   eval(h)   w_sapr_w = w_sapr_w -
     c                                       (w_sapr_w * w_rab2 / 100)
     c                   eval      hopkon = 'RAB'
6.30 c                   eval      hopkns = 'RAB'
     c                   endif
     c                   eval      horab1 = w_rab1
     c                   eval      horab2 = w_rab2
     c                   endif
      *
      * Beregner salgspris etter dekningsgrad (DG)
      *
     c                   if        w_dekn <> 0 and
     c                             hosapr <> 0
      *
     c                   if        w_dekn = 100
     c                   eval      w_dgpr = hosapr
     c                   eval      w_raba = 0
     c                   else
     c                   eval(h)   w_dgpr = (100 * hokopr) / (100 - w_dekn)
     c                   eval      w_raba = hosapr - w_dgpr
     c* trenger ikke     if        w_raba > 0
6.30 c* denne ?          eval      hopkon = 'RAB'
6.30 c*                  eval      hopkns = 'RAB'
     c*                  endif
     c                   endif
      *
     c                   select
     c                   when      (100 * w_raba / hosapr) < -999,99
     c                   eval      w_rabd = -999,99
     c                   when      (100 * w_raba / hosapr) > 999,99
     c                   eval      w_rabd = 999,99
     c                   other
     c                   eval(h)   w_rabd = 100 * w_raba / hosapr
     c                   endsl
      *
     c                   endif
      *
      * Sammenligner salgspris etter rabatter/DG med tilbudspris etter
      * rabatt og butikkpris. Kjøper kreves for laveste pris.
      *
     c                   eval      w_ntpr = w_sapr_w
      *
     c                   if        w_dgpr <> 0 and
     c                             w_dgpr < w_ntpr
     c                   eval      w_ntpr = w_dgpr
     c                   eval      horab1 = w_rabd
     c                   eval      horab2 = 0
6.30 c                   eval      hopkon = 'RAB'
6.30 c                   eval      hopkns = 'RAB'
     c                   endif
      *
     c                   if        w_tipr <> 0 and
     c                             w_tipr_w < w_ntpr
     c                   eval      w_ntpr = w_tipr_w
     c                   eval      holety = w_lety
     c                   eval      hosapr = w_tipr
     c                   eval      horab1 = w_rabt
     c                   eval      horab2 = 0
6.30 c                   eval      hopkon = 'KAM'
6.30 c                   eval      hopkns = 'KAM'
6.26 c                   eval      hoprgr = hiprgr
     c                   endif
      *
     c                   if        w_bupr <> 0 and
     c                             w_bupr < w_ntpr
     c                   eval      hosapr = w_bupr
6.30 c                   eval      hopkon = 'BUT'
6.30 c                   eval      hopkns = 'BUT'
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
     c                   endif
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering og nullstilling av variable
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     init          begsr
      *
      * Henter verdier fra input-parameter
      *
     c                   eval      hirec = p_irec
      *
     c                   eval      w_firm = hifirm
     c                   eval      w_rkat = hirkat
     c                   eval      w_kkat = 0
     c                   eval      w_kund = hikund
     c                   eval      w_kpro = hikpro
     c                   eval      w_avgf = hiavgf
     c                   eval      w_spfa = 0
     c                   eval      w_priv = hipriv
     c                   eval      w_alme = 0
      *
      * Henter overstyringer fra kunde
      *
     c                   if        w_kund <> 0
     c                   eval      w_rkat = 0
     c                   eval      rkunl1_kund = w_kund
     c     rkunl1_key    chain     rkunl1
     c                   if        %found
     c                   eval      w_rkat = rkrabk
     c                   eval      w_kkat = rkkatg
     c                   eval      w_spfa = rkspfa
     c                   if        rkmkod = 1
     c                   eval      w_avgf = 1
     c                   endif
     c                   endif
     c                   endif
      *
      * Henter overstyringer fra kundeprosjekt
      *
     c                   if        w_kpro <> 0
      *
     c                   eval      fkprl1_kund = w_kund
     c                   eval      fkprl1_kpro = w_kpro
     c     fkprl1_key    chain     fkprl1
     c                   if        %found
      *
     c                   if        florka <> 0
     c                   eval      w_rkat = florka
     c                   endif
      *
     c                   if        flokun <> 0
     c                   eval      w_kund = flokun
     c                   eval      w_kpro = 0
     c                   endif
      *
     c                   if        flokpr <> 0
     c                   eval      w_kpro = flokpr
     c                   endif
      *
     c                   if        flokun <> 0
     c                   eval      rkunl1_kund = flokun
     c     rkunl1_key    chain     rkunl1
     c                   if        %found
     c                   eval      w_rkat = rkrabk
     c                   eval      w_kkat = rkkatg
     c                   endif
     c                   endif
      *
     c                   if        flopda <> *loval
     c                   eval      hidato = flopda
     c                   endif
      *
     c                   if        flpriv = 1
     c                   eval      w_priv = 1
     c                   endif
      *
     c                   endif
     c                   endif
      *
      * Henter almenning
      *
     c                   eval      rmknl2_xknr = w_kund
     c     rmknl2_key    chain     rmknl2
     c                   if        %found
     c                   eval      w_alme = rmxalm
     c                   endif
      *
      * Initierer dato og klokkeslett
      *
     c                   if        hidato = *loval
     c                   time                    hidato
     c                   endif
      *
     c                   if        hitime = *loval
     c                   time                    hitime
     c                   endif
      *
      * Nullstiller output-parametre
      *
     c                   eval      holety = 0
     c                   eval      hokpri = *blank
     c                   eval      hooppr = 0
     c                   eval      hosapr = 0
     c                   eval      hokopr = 0
6.30 c                   eval      hoinpr = 0
     c                   eval      horab1 = 0
     c                   eval      horab2 = 0
     c                   eval      hodekn = 0
     c                   eval      hopros = 0
     c                   eval      hokamp = *blank
     c                   eval      hoalme = 0
     c                   eval      hobrty = 0
     c                   eval      hobrr1 = 0
     c                   eval      hobrr2 = 0
     c                   eval      hoomva = *blank
5.70 c                   eval      hoprgr = *blank
6.32 c                   eval      hoinpr = 0
6.32 c                   eval      hopkon = *blank
6.32 c                   eval      hopkns = *blank
6.32 c                   eval      hopkko = *blank
6.32 c                   eval      hopkok = *blank
6.32 c                   eval      hopkoi = *blank
      *
     c                   eval      p_orec = horec
      *
      * Initiering av variable
      *
     c                   eval      b_pris = *off
     c                   eval      b_spes = *off
     c                   eval      b_raba = *off
      *
     c                   eval      w_bupr = 0
     c                   eval      w_tipr = 0
6.26 c                   eval      w_prgr = *blank
     c                   eval      w_lety = 0
     c                   eval      w_sapr = 0
     c                   eval      w_kopr = 0
     c                   eval      w_rab1 = 0
     c                   eval      w_rab2 = 0
     c                   eval      w_rabn = 0
     c                   eval      w_rabb = 0
     c                   eval      w_rabt = 0
     c                   eval      w_dekn = 0
     c                   eval      w_ntpr = 0
     c                   eval      w_dgpr = 0
     c                   eval      w_rabd = 0
     c                   eval      w_raba = 0
     c                   eval      w_pasl = 0
      *
     c                   eval      w_tipr_w = 0
     c                   eval      w_sapr_w = 0
      *
     c                   endsr
6.20  *
6.25  *
6.25  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.25  * Subrutine for å hente tilbudspris på varegruppe/leverandørnivå
6.25  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.25  *
6.25 c     tilb_sjekk    begsr
6.25  *
6.25  *  overgruppe,hovedgruppe,undergruppe
6.25  *
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ogrp = vvogrp
6.25 c                   eval      vtill1_hgrp = vvhgrp
6.25 c                   eval      vtill1_ugrp = vvugrp
6.25 c                   eval      vtill1_ldor = 0
6.25 c                   eval      vtill1_lety = 0
6.25 c                   eval      vtill1_vare = *blank
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe,hovedgruppe
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ugrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_hgrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe,hovedgruppe,undergruppe, leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ogrp = vvogrp
6.25 c                   eval      vtill1_hgrp = vvhgrp
6.25 c                   eval      vtill1_ugrp = vvugrp
6.25 c                   eval      vtill1_ldor = w_pldo
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe,hovedgruppe              leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ugrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  overgruppe                          leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_hgrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *  leverandør
6.25 c                   if        w_tipr = 0
6.25 c                   eval      vtill1_ogrp = 0
6.25 c                   exsr      hent_tilb
6.25 c                   endif
6.25  *
6.25 c                   endsr
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.21  * Subrutine for å hente tilbudspris på varegruppe/leverandørnivå
6.21  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.20  *
6.20 c     hent_tilb     begsr
6.20  *
6.21 c     vtill1_key    setll     vtill1
6.21 c     vtill1_key    reade     vtill1                                 90
6.21 c                   dow       *in90 = *off
6.21 c                   if        hidato >= vtfdat and
6.21 c                             hidato <= vttdat
6.21 c                   if        hidato <> vtfdat or
6.21 c                             hidato = vtfdat and
6.21 c                             hitime >= vtftim
6.21 c                   if        hidato <> vttdat or
6.21 c                             hidato = vttdat and
6.21 c                             hitime <= vtttim
6.21  *
6.21 c                   eval      hokamp = vtkamp
6.21 c                   eval      w_lety = vtlety
6.21 c                   eval(h)   w_tipr = hosapr -
6.21 c                                      (hosapr * vtpro1)/100
6.21  *
6.21 c                   leave
6.21  *
6.21 c                   endif
6.21 c                   endif
6.21 c                   endif
6.21 c     vtill1_key    reade     vtill1                                 90
6.21 c                   enddo
6.21  *
6.21 c                   endsr
6.32  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.32  * Subrutine for å lukke program når siste gang (setter på LR)
6.32  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.32  *
6.32 c     lukk_vl710    begsr
6.32  *
6.32 c                   eval      b_inlr = *off
5.32 c                   call      'VL710R'
5.32 c                   parm                    w_firm
5.32 c                   parm                    vvvare
5.32 c                   parm                    w_lage
5.32 c                   parm                    p_vtyp
6.32 c                   parm                    w_udat
6.32 c                   parm                    w_lldo
6.32 c                   parm                    b_inlr
6.33 c                   parm                    w_lv_nobb
6.33 c                   parm                    w_lv_modn
6.33 c                   parm                    w_lv_lldo
6.33 c                   parm                    w_lv_llva
6.32  *
6.32 c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Parameterliste
      *
     c     *entry        plist
     c                   parm                    p_irec
     c                   parm                    p_orec
      *
      * Key for oppslag på kunde
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Key for oppslag på almenning, eiendomsknytning
      *
     c     rmknl2_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rmknl2_xknr
      *
      * Key for oppslag på kundeprosjekt
      *
     c     fkprl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fkprl1_kund
     c                   kfld                    fkprl1_kpro
      *
      * Key for oppslag på vare
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for les på vare-pris
      *
     c     vvprl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvprl1_vare
6.20 c                   kfld                    vvprl1_ldor
5.70 c                   kfld                    vvprl1_prgr
     c                   kfld                    vvprl1_enhe
     c                   kfld                    vvprl1_lety
      *
      * Key for les på tilbud
      *
     c     vtill1_key    klist
     c                   kfld                    w_firm
6.21 c                   kfld                    vtill1_ogrp
6.21 c                   kfld                    vtill1_hgrp
6.21 c                   kfld                    vtill1_ugrp
6.21 c                   kfld                    vtill1_ldor
     c                   kfld                    vtill1_vare
5.70 c                   kfld                    vtill1_prgr
     c                   kfld                    vtill1_lety
      *
      * Key for oppslag på undergruppe
      *
     c     vugrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vugrl1_uogr
     c                   kfld                    vugrl1_uhgr
     c                   kfld                    vugrl1_uugr
      *
      * Key for oppslag på ordre-hode
      *
     c     fohel1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fohel1_numm
     c                   kfld                    fohel1_suff
      *
      * Key for oppslag på ordre-linje med varenummer
      *
     c     fodtlv_key    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtlv_vare
     c                   kfld                    fodtlv_numm
     c                   kfld                    fodtlv_suff
     c                   kfld                    fodtlv_enh1
      *
      * Key for oppslag på spesialpris
      *
     c     fpril1_key    klist
     c                   kfld                    w_firm
5.70 c                   kfld                    fpril1_prgr
     c                   kfld                    fpril1_rkat
     c                   kfld                    fpril1_kkat
     c                   kfld                    fpril1_kund
     c                   kfld                    fpril1_kpro
     c                   kfld                    fpril1_vare
     c                   kfld                    fpril1_enhe
     c                   kfld                    fpril1_lety
      *
      * Key for oppslag på rabattmatrise
      *
     c     frabl1_key    klist
     c                   kfld                    w_firm
5.70 c                   kfld                    frabl1_prgr
     c                   kfld                    frabl1_rkat
     c                   kfld                    frabl1_kkat
     c                   kfld                    frabl1_kund
     c                   kfld                    frabl1_kpro
     c                   kfld                    frabl1_ogrp
     c                   kfld                    frabl1_hgrp
     c                   kfld                    frabl1_ugrp
     c                   kfld                    frabl1_ldor
     c                   kfld                    frabl1_modn
     c                   kfld                    frabl1_vare
     c                   kfld                    frabl1_enhe
     c                   kfld                    frabl1_lety
      *
      * Key for oppslag på bruksrett-knytning
      *
     c     vbrkl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vbrkl1_alme
     c                   kfld                    vbrkl1_ogrp
     c                   kfld                    vbrkl1_hgrp
     c                   kfld                    vbrkl1_ugrp
     c                   kfld                    vbrkl1_modn
     c                   kfld                    vbrkl1_vare
      *
     c     vbrkl5_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vbrkl5_alme
     c                   kfld                    vbrkl5_vare
      *
      * Key for oppslag på bruksrett-type
      *
     c     rmbtl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rmbtl1_talm
     c                   kfld                    rmbtl1_tbrt
      *
      * Key for oppslag på vare (VA)
      *
     c     jvarl1_key    klist
     c                   kfld                    jvarl1_vare
      *
      * Key for oppslag på mva.-kode
      *
     c     vmval1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vmval1_mkod
      *
      * Key for oppslag på vare-detalj
      *
     c     jvdtl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    jvdtl1_dvar
5.70  *
5.70 c                   eval      w_lage = l_lage
6.32  *
6.32 c                   eval      b_inlr = hiinlr
      *
     c                   endsr
