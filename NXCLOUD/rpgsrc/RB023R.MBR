     h datedit(*dmy.) option(*nodebugio)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
9.01  * Spesialversjon. : Skal kjøre denne versjonen av summering (6.20
      *
      * System. . . . . : ASOKON                                              *
6.21  * 02102013  nho feil test, må også teste at de 2 første
      *           ikke er 0
6.22  * 09042015  nho dersom kredit/debet konto ikke var salgskonti
      *               men hadde '3' i posisjon 3 ble den behandlet
      *               som en salgskonto
6.23  * 21012015  nho blanker ikke ut hjelpefelt
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     flovil1    if   e           k disk    rename(lovipfr:lovfil1)
     flovupf    o    e             disk    rename(lovupfr:lovul1r)
      *
     d w_mvag          s                   like(lgbelp)
     d w_belØ          s                   like(lgbelp)
     d w_belp          s                   like(lgbelp)
     d w_tell          s              1  0
     d w_fØrs          s              1  0
610  d w_dkto          s                   like(lgdkto)
610  d w_ckto          s                   like(lgckto)
610  d w_tdkoh         s              4  0
610  d w_tckoh         s              4  0
610  d w_tdko          s              1  0
610  d w_tcko          s              1  0
6.21 d w_tdko2         s              2  0
6.21 d w_tcko2         s              2  0
6.22 d x               s              1  0
     d lovfl1_firm     s                   like(lgfirm)
      *
6.11 d                uds
6.11 d l_user                911    920
6.11 d l_firm                944    946  0
      *
      *
      * Key lor posisjonering på bilagskode
      *
      /eject
610  c                   eval      lovfl1_firm = l_firm
      *
610  c     lovfl1_firm   setll     lovil1
610   **********************************************************************
     c     nyles         tag
610   *
610  c                   read      lovil1                                 15
610   *
610   * Eof
610  c                   if        *in15  = '1'
610  c                   move      *on           *inlr
610  c                   goto      ut
610  c                   endif
      *
      * Test på inneværend firma
      *
     c                   if        lgfirm <> l_firm
610  c                   move      *on           *inlr
610  c                   goto      ut
610  c                   endif
      *
6.22 c                   if        x = 1
6.22 c                   eval      x = 0
6.22 c                   z-add     0             w_fØrs
6.22 c                   endif
610   * Flytter konto til hjelpefelt første gang det er salgskonto
     c                   if        w_fØrs = 0
     c                   z-add     lgdkto        w_tdkoh
     c                   z-add     lgckto        w_tckoh
6.21 c                   movel     lgdkto        w_tdko2
6.21 c                   movel     lgckto        w_tcko2
     c                   movel     w_tdkoh       w_tdko
     c                   movel     w_tckoh       w_tcko
6.21 c                   if        w_tdko = 4 and
6.21 c                             w_tdko2 = *zeros
     c                   add       1             w_fØrs
     c                   endif
6.21 c                   if        w_tcko = 4 and
6.21 c                             w_tcko2 = *zeros
     c                   add       1             w_fØrs
     c                   endif
     c                   endif
610   *
      * Tester brudd / debet
6.22 c                   if        lgdkto > 9999 and
6.22 c                             w_tdko = 4
6.22 c***  6.23          eval      w_tdko = 0
6.22 c                   eval      x = 1
6.22 c                   endif
610  c                   if        w_fØrs = 1 and
     c                             w_tdko = 4
     c                   if        lgdkto <> w_tdkoh
610  c                   readp     lovil1                                 15
     c                   eval      lgbelp = w_belp
     c                   eval      lgmvag = w_mvag
     c                   write     lovul1r
     c                   eval      w_belp = 0
610  c                   z-add     0             w_fØrs
     c                   goto      nyles
     c                   else
     c                   add       lgbelp        w_belp
     c                   add       lgmvag        w_mvag
     c                   goto      nyles
610  c                   endif
610  c                   endif
6.10  *
      * Tester brudd / kredit
6.22 c                   if        lgckto > 9999 and
6.22 c                             w_tcko = 4
6.22 c*** 6.23           eval      w_tcko = 0
6.22 c                   eval      x = 1
6.22 c                   endif
610  c                   if        w_fØrs = 1 and
     c                             w_tcko = 4
     c                   if        lgckto <> w_tckoh
610  c                   readp     lovil1                                 15
     c                   eval      lgbelp = w_belp
     c                   eval      lgmvag = w_mvag
     c                   write     lovul1r
     c                   eval      w_belp = 0
610  c                   z-add     0             w_fØrs
     c                   goto      nyles
     c                   else
     c                   add       lgbelp        w_belp
     c                   add       lgmvag        w_mvag
     c                   goto      nyles
610  c                   endif
610  c                   endif
6.10  *
      *
      *
     c                   write     lovul1r
     c                   eval      w_belp = 0
     c                   eval      w_mvag = 0
      *
      ******************************************************
      *  AVSLUTT DENNE TRANS                               *
      ******************************************************
      *
     c     ut            tag
610  c                   if        *inlr = '0'
610  c                   goto      nyles
610  c                   endif
      *
     c                   if        *inlr  =  '1'   and
     c                             w_belp > 0
610  c                   readp     lovil1                                 15
     c                   eval      lgbelp =  w_belp
     c                   eval      lgmvag =  w_mvag
     c                   write     lovul1r
610  c                   endif
      *
     c/eject
      *
