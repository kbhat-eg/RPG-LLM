      /TITLE  ASSTAT Vedlikehold av budsjett-register
     h datedit(*dmy.) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SB110R
      * Beskrivelse . . : Vedlikehold av budsjett-register
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * V5.20 310104 KOB  Lagt inn les av fordelingsnøkkel
      * V5.20 160204 KOB  Lagt inn tekster på alle koder
6.10  * R6.10 231109 BSA  Feil kall til lagerprogram, og lagt inn spørring
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     fsb110d    cf   e             workstn sfile(b1sfl:srrn01)
      *
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
     fvotyl1    if   e           k disk    rename(votypfr:votyl1r)
     fvhgrl1    if   e           k disk    rename(vhgrpfr:vhgrl1r)
     fvogrl1    if   e           k disk    rename(vogrpfr:vogrl1r)
     fvugrl1    if   e           k disk    rename(vugrpfr:vugrl1r)
     fvvarl1    if   e           k disk    rename(vvarpfr:vvarl1r)
     fra13l1    if   e           k disk    rename(ra13pfr:ra13l1r)
6.10 fra10l1    if   e           k disk    rename(ra10pfr:ra10l1r)
      *
     fskakl1    if   e           k disk    rename(skakpfr:skakl1r)
     fskbul1    if   e           k disk    rename(skbupfr:skbul1r)
     fskbulu    uf a e           k disk    rename(skbupfr:skbulur)
      *
     d mld             s             11    dim(4) ctdata perrcd(1)               MELDINGER
     d txt             s             25    dim(8) ctdata perrcd(1)               TEKSTER
     d cmd             S             18    dim(14) ctdata perrcd(1)              cmd-TASTER
     d rpt             s             15    dim(60) ctdata perrcd(1)
      *
     d wpf             s              1    dim(30)                               ALFA-KONV
     d isa             s              9  0 dim(12)                               SALDOMATRISE
     d ssa             s             11  2 dim(12)                               SALDOMATRISE
     d wrk             s             11  0 dim(12)                               ARBEIDSARRAY
     d mfo             s              4  2 dim(12)                               FORDELINGSNØKLER
     d wfo             s              9  6 dim(12)                               FORDELINGSNØKLER
      *
      * Definering av variabler i nøkler
      *
     d votyl1_otyp     s                   like(vaotyp)
     d vogrl1_oogr     s                   like(vgoogr)
     d vhgrl1_hogr     s                   like(vghogr)
     d vhgrl1_hhgr     s                   like(vghhgr)
     d vugrl1_uogr     s                   like(vguogr)
     d vugrl1_uhgr     s                   like(vguhgr)
     d vugrl1_uugr     s                   like(vguugr)
     d rkunl1_kund     s                   like(rkkund)
     d vvarl1_vare     s                   like(vvvare)
     d ra13l1_mkod     s                   like(ramkod)
6.10 d ra10l1_jkod     s                   like(rajkod)
      *
     d                uds
     d l_user                911    920
     d l_firm                944    946  0
     d l_fnav                951    980
      *
     d w_kode_nn       ds            12
     d w_kode_11                      1  0
     d w_kode_12                      1  0
     d w_kode_13                      1  0
     d w_kode_21                      1  0
     d w_kode_22                      1  0
     d w_kode_23                      1  0
     d w_kode_24                      1  0
     d w_kode_25                      1  0
     d w_kode_31                      1  0
     d w_kode_32                      1  0
     d w_kode_33                      1  0
     d w_kode_34                      1  0
      *
     d spge01          s              3  0
     d srrn01          s              4  0
     d sfrn01          s                   like(srrn01)
     d ssrn01          s                   like(srrn01)
      *
     d w_firm          s                   like(sbfirm)
     d w_hhaa          s                   like(sbhhaa)
     d w_vers          s                   like(sbvers)
     d w_kode          s                   like(sbkode)
     d w_aabb          s                   like(sbaabb)
      *
     d w_avde          s                   like(sbavde)
     d w_lage          s                   like(sblage)
     d w_otyp          s                   like(sbotyp)
     d w_land          s                   like(sbland)
     d w_dist          s                   like(sbdist)
     d w_selg          s                   like(sbselg)
     d w_kkat          s                   like(sbkkat)
     d w_kund          s                   like(sbkund)
     d w_ogrp          s                   like(sbogrp)
     d w_hgrp          s                   like(sbhgrp)
     d w_ugrp          s                   like(sbugrp)
     d w_vare          s                   like(sbvare)
6.10 d w_text          s             20
6.10 d p_lage          s                   like(sblage)
      *
      * Definering av variable
      *
     d r1              s              2  0
     d r2              s                   like(r1)
     d r3              s                   like(r1)
      *
     d p_stat          s              1
     d p_gkod          s                   like(saavde)
     d p_hkod          s                   like(sadist)
     d p_ikod          s                   like(saselg)
     d p_jkod          s                   like(salage)
     d p_kkod          s                   like(sakkat)
     d p_lkod          s                   like(saland)
     d p_tx20          s             20
      *
      * definering av variable
      *
     d w_jadr          s             30
     d w_jpnr          s              4  0
     d w_jste          s             30
     d w_javd          s              4  0
     d w_jtxt          s             20
     d w_retk          s              1
     d w_gtxt          s             20
     d w_htxt          s             20
     d w_itxt          s             20
     d w_ktxt          s             20
     d w_ltxt          s             20
     d w_mtxt          s             30
      *
      * Redefinering til fil
      *
     iskbul1r
     i              sbbu01                      isa(1)
     i              sbbu02                      isa(2)
     i              sbbu03                      isa(3)
     i              sbbu04                      isa(4)
     i              sbbu05                      isa(5)
     i              sbbu06                      isa(6)
     i              sbbu07                      isa(7)
     i              sbbu08                      isa(8)
     i              sbbu09                      isa(9)
     i              sbbu10                      isa(10)
     i              sbbu11                      isa(11)
     i              sbbu12                      isa(12)
      *
      *
     iskakl1r
     i              sasa01                      ssa(1)
     i              sasa02                      ssa(2)
     i              sasa03                      ssa(3)
     i              sasa04                      ssa(4)
     i              sasa05                      ssa(5)
     i              sasa06                      ssa(6)
     i              sasa07                      ssa(7)
     i              sasa08                      ssa(8)
     i              sasa09                      ssa(9)
     i              sasa10                      ssa(10)
     i              sasa11                      ssa(11)
     i              sasa12                      ssa(12)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * B2BLD Behandle åpningsbildet med subfile                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Send Alt
      *
     c     b2taga        tag
      *
     c                   write     b2cmd
      *
      * Bare data
      *
     c     b2tagb        tag
      *
     c                   exsr      xdsp01
      *
      * Avslutt program
      *
     c     *inkc         cabeq     *on           xslutt
      *
      * Forny
      *
     c                   if        *inke = *on
     c                   if        sfrn01 <> *zero
     c     sfrn01        chain     b1sfl                              60
     c                   endif
      *
     c     key01         setll     skbul1
      *
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
      * Opprette ny record
      *
     c                   if        *inkf = *on
     c                   goto      c1taga
     c                   endif
      *
      * Roll
      *
     c                   if        *in10 = *on
     c                   exsr      xcrt01
     c                   goto      b2tagb
     c                   endif
      *
      * Home
      *
     c                   if        *in21
     c                   eval      *in22 = *on
     c                   goto      b2taga
     c                   endif
      *
      * Posisjoner
      * startverdi
      *
     c                   if        b2fis1 <> *blank
     c                   move      *zero         w_avde
     c                   move      *zero         w_lage
     c                   move      *blank        w_otyp
     c                   move      *blank        w_land
     c                   move      *zero         w_dist
     c                   move      *zero         w_selg
     c                   move      *zero         w_kkat
     c                   move      *zero         w_kund
     c                   move      *zero         w_ogrp
     c                   move      *zero         w_hgrp
     c                   move      *zero         w_ugrp
     c                   move      *blank        w_vare
      *
     c   41              movel     b2fis1        w_avde
     c   42              movel     b2fis1        w_lage
     c   43              movel     b2fis1        w_otyp
     c   44              movel     b2fis1        w_land
     c   45              movel     b2fis1        w_dist
     c   46              movel     b2fis1        w_selg
     c   47              movel     b2fis1        w_kkat
     c   48              movel     b2fis1        w_kund
     c   49              movel     b2fis1        w_ogrp
     c   50              movel     b2fis1        w_hgrp
     c   51              movel     b2fis1        w_ugrp
     c   52              movel     b2fis1        w_vare
      *
     c     key01         setll     skbul1
     c                   exsr      xclr01
     c                   exsr      xcrt01
     c                   eval      b2fis1 = *blank
     c                   goto      b2tagb
     c                   endif
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Behandling av subfile                                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
      * Sjekk om valg er foretatt i subfile
      *
     c                   do        ssrn01
     c                   readc     b1sfl                                  16
     c                   if        *in16 = *on
     c                   leave
     c                   endif
      *
      * Endre post
      *
     c                   if        b1valg = ' 2' or
     c                             b1valg = '2 '
      *
     c                   movel     b1vis1        c2vis1
     c                   movel     b1vis2        c2vis2
     c                   movel     b1vis3        c2vis3
      *
     c                   move      b1avde        w_avde
     c                   move      b1lage        w_lage
     c                   move      b1otyp        w_otyp
     c                   move      b1land        w_land
     c                   move      b1dist        w_dist
     c                   move      b1selg        w_selg
     c                   move      b1kkat        w_kkat
     c                   move      b1kund        w_kund
     c                   move      b1ogrp        w_ogrp
     c                   move      b1hgrp        w_hgrp
     c                   move      b1ugrp        w_ugrp
     c                   move      b1vare        w_vare
     c                   exsr      xc2bld
     c                   iter
     c                   endif
      *
      * Kopiere post
      *
     c                   if        b1valg = ' 3' or
     c                             b1valg = '3 '
     c                   move      b1avde        w_avde
     c                   move      b1lage        w_lage
     c                   move      b1otyp        w_otyp
     c                   move      b1land        w_land
     c                   move      b1dist        w_dist
     c                   move      b1selg        w_selg
     c                   move      b1kkat        w_kkat
     c                   move      b1kund        w_kund
     c                   move      b1ogrp        w_ogrp
     c                   move      b1hgrp        w_hgrp
     c                   move      b1ugrp        w_ugrp
     c                   move      b1vare        w_vare
     c                   exsr      xk1win
     c                   iter
     c                   endif
      *
      * Slette post
      *
     c                   if        b1valg = ' 4' or
     c                             b1valg = '4 '
     c                   move      b1avde        w_avde
     c                   move      b1lage        w_lage
     c                   move      b1otyp        w_otyp
     c                   move      b1land        w_land
     c                   move      b1dist        w_dist
     c                   move      b1selg        w_selg
     c                   move      b1kkat        w_kkat
     c                   move      b1kund        w_kund
     c                   move      b1ogrp        w_ogrp
     c                   move      b1hgrp        w_hgrp
     c                   move      b1ugrp        w_ugrp
     c                   move      b1vare        w_vare
     c                   exsr      xd1win
     c                   iter
     c                   endif
      *
     c                   enddo
      *
     c                   goto      b2taga
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C1BLD Rutine for valg av vising av hjelpe-bilde                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     c1taga        tag
      *
     c     wikode        ifeq      '000000001230'
     c                   exsr      xm2bld
     c                   goto      c1tagx
     c                   endif
      *
     c                   exsr      xm1bld
      *
     c     c1tagx        tag
      *
     c                   goto      b2taga
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Avslutt program                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * C2BLD Behandle bilde for ny - endring - vise                    *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xc2bld        begsr
      *
      * Nullstilling
      *
     c                   move      *zero         c2fnØk
     c                   move      *zero         c2fmet
     c                   move      *zero         c2rper
     c                   move      *zero         c2tbel
      *
     c     c2tagb        tag
      *
     c                   exsr      xc2les
      *
     c     c2tagc        tag
      *
     c                   exfmt     c2bld
      *
      * call program for budsjett-nøkkler
      *
     c     *inkd         ifeq      *on
     c     wactre        ifeq      'C2BLD'
     c     wactfe        ifeq      'C2FNØK'
     c                   call      'RA513R'
     c                   parm                    w_firm
     c                   parm                    wpmkod
     c                   parm                    wpmtxt
     c                   move      wpmkod        c2fnØk
     c                   goto      c2tagb
     c                   endif
     c                   endif
     c                   endif
      *
      * Endre kolonne
      *
     c     *inki         ifeq      *on
     c                   exsr      xv1win
     c                   goto      c2tagb
     c                   endif
      *
      * Forrige år
      *
     c     *INKE         ifeq      *on
     c                   sub       1             v1aar1
     c                   sub       1             v1aar2
     c                   sub       1             v1aar3
     c                   goto      c2tagb
     c                   endif
      *
      * Neste år
      *
     c     *INKF         ifeq      *on
     c                   add       1             v1aar1
     c                   add       1             v1aar2
     c                   add       1             v1aar3
     c                   goto      c2tagb
     c                   endif
      *
      * Kopiere kolonne 3
      * til     kolonne 4
      *
     c     *INKM         ifeq      *on
     c                   z-add     c2k301        c2k401
     c                   z-add     c2k302        c2k402
     c                   z-add     c2k303        c2k403
     c                   z-add     c2k304        c2k404
     c                   z-add     c2k305        c2k405
     c                   z-add     c2k306        c2k406
     c                   z-add     c2k307        c2k407
     c                   z-add     c2k308        c2k408
     c                   z-add     c2k309        c2k409
     c                   z-add     c2k310        c2k410
     c                   z-add     c2k311        c2k411
     c                   z-add     c2k312        c2k412
     c                   z-add     c2k314        c2k414
     c                   goto      c2tagc
     c                   endif
      *
      * Flere kommandotaster
      *
     c     *inky         ifeq      *on
     c     wc2cmd        ifeq      3
     c                   move      1             wc2cmd
     c                   else
     c                   add       1             wc2cmd
     c                   endif
      *
     c                   move      *blank        c2cmd1
     c                   move      *blank        c2cmd2
     c                   move      *blank        c2cmd3
     c                   move      *blank        c2cmd4
      *
     c     wc2cmd        ifeq      1
     c                   move      cmd(3)        c2cmd1
     c                   move      cmd(4)        c2cmd2
     c                   move      cmd(5)        c2cmd3
     c                   move      cmd(14)       c2cmd4
     c                   else
     c     wc2cmd        ifeq      2
     c                   move      cmd(6)        c2cmd1
     c                   move      cmd(14)       c2cmd4
     c                   else
     c     wc2cmd        ifeq      3
     c                   move      cmd(9)        c2cmd1
     c                   move      cmd(13)       c2cmd3
     c                   move      cmd(14)       c2cmd4
     c                   endif
     c                   endif
     c                   endif
     c                   goto      C2tagc
     c                   endif
      *
     c     *inkc         cabeq     *on           c2tag1
     c     *inkl         cabeq     *on           c2tag1
     c     *in30         cabeq     *on           c2tag1
      *
      * Finnes fordelingsnøkkel i koderegister
      *
     c     c2fnØk        ifne      99
     c     c2fnØk        ifne      *zero
     c                   move      c2fnØk        ra13l1_mkod                     budsjettnøkkel-
     c     ra13l1_key    chain     ra13l1                                         kode
      *                                                                           kode
     c                   if        not%found
     c                   move      *on           *IN31
     c                   goto      c2tagc
     c                   else                                                     kode
     c                   move      ramp01        mfo(01)
     c                   move      ramp02        mfo(02)
     c                   move      ramp03        mfo(03)
     c                   move      ramp04        mfo(04)
     c                   move      ramp05        mfo(05)
     c                   move      ramp06        mfo(06)
     c                   move      ramp07        mfo(07)
     c                   move      ramp08        mfo(08)
     c                   move      ramp09        mfo(09)
     c                   move      ramp10        mfo(10)
     c                   move      ramp11        mfo(11)
     c                   move      ramp12        mfo(12)
     c                   endif
     c                   endif
     c                   endif
      *
      * Kan ikke benytte både fordelings-nøkkel og fordelings-metode
      *
     c     c2fnØk        ifne      *zero
     c     c2fmet        ifne      *zero
     c                   move      *on           *IN32
     c                   goto      c2tagc
     c                   endif
     c                   endif
      *
      * Når fordelings-metode benyttes, må periode registreres
      *
     c     c2fmet        ifne      *zero
     c     c2rper        ifeq      *zero
     c                   move      *on           *in33
     c                   goto      c2tagc
     c                   endif
     c                   endif
      *
      * Når fordelings-nøkkel benyttes, må beløp registreres
      *
     c     c2fnØk        ifne      *zero
     c     c2tbel        ifeq      *zero
     c                   move      *on           *in34
     c                   goto      c2tagc
     c                   endif
     c                   endif
      *
      * Når fordelings-metode benyttes, må beløp registreres
      *
     c     c2fmet        ifne      *zero
     c     c2tbel        ifeq      *zero
     c                   move      *on           *IN35
     c                   goto      c2tagc
     c                   endif
     c                   endif
      *
      * Er budsjettnøkkel endret ?
      *
     c     c2fnØk        ifne      wsfnØk
     c                   goto      c2tagb
     c                   endif
      *
      * Er fordelingsmetode endret ?
      *
     c     c2fmet        ifne      wsfmet
     c                   goto      c2tagb
     c                   endif
      *
      * Er regnskapsperiode endret ?
      *
     c     c2rper        ifne      wsrper
     c                   goto      c2tagb
     c                   endif
      *
      * Er budsjettbeløp endret ?
      *
     c     c2tbel        ifne      wstbel
     c                   goto      c2tagb
     c                   endif
      *
      * Oppdater budsjett-record
      *
     c                   move      v1aar4        w_hhaa
     c     key01         chain     skbulur                            60
     c                   move      c2k401        sbbu01
     c                   move      c2k402        sbbu02
     c                   move      c2k403        sbbu03
     c                   move      c2k404        sbbu04
     c                   move      c2k405        sbbu05
     c                   move      c2k406        sbbu06
     c                   move      c2k407        sbbu07
     c                   move      c2k408        sbbu08
     c                   move      c2k409        sbbu09
     c                   move      c2k410        sbbu10
     c                   move      c2k411        sbbu11
     c                   move      c2k412        sbbu12
      *
     c                   if        *in60 = *off
     c                   update    skbulur
      *
     c                   else
      *
     c                   move      w_firm        sbfirm
     c                   move      w_hhaa        sbhhaa
     c                   move      w_vers        sbvers
     c                   move      w_kode        sbkode
     c                   move      w_aabb        sbaabb
      *
     c                   move      w_avde        sbavde
     c                   move      w_lage        sblage
     c                   move      w_otyp        sbotyp
     c                   move      w_land        sbland
     c                   move      w_dist        sbdist
     c                   move      w_selg        sbselg
     c                   move      w_kkat        sbkkat
     c                   move      w_kund        sbkund
     c                   move      w_ogrp        sbogrp
     c                   move      w_hgrp        sbhgrp
     c                   move      w_ugrp        sbugrp
     c                   move      w_vare        sbvare
      *
     c                   write     skbulur
     c                   endif
      *
     c     c2tag1        tag
      *
     c                   if        b1valg = ' 2' or
     c                             b1valg = '2 '
     c                   move      srrn01        svrn01
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2fis1 = *blank
     c                   move      *off          *in30
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * D1WIN Behandle bilde for slette                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xd1win        begsr
      *
     c     key01         chain     skbul1                             60
      *
     c                   write     s1win
      *
     c*>                 move      snkomm        d1text
      *
     c                   exfmt     d1win
      *
     c     *inkc         cabeq     *on           d1end1
     c     *inkl         cabeq     *on           d1end1
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 4' or
     c                             b1valg = '4 '
     c                   eval      b1vis1 = *blank
     c                   movel     mld(4)        b1vis1
     c                   endif
      *
     c     d1tag1        tag
      *
     c                   if        b1valg = ' 4' or
     c                             b1valg = '4 '
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2fis1 = *blank
      *
      * Slett parametre
      *
     c     key02         reade     skbulur                                61
     c     key02         setll     skbulur
     c     key02         reade     skbulur                                61
     c                   dow       *in61 = *off
     c                   delete    skbulur
     c     key02         reade     skbulur                                61
     c                   enddo
      *
     c     d1end1        endsr
      *
      /EJECT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * K1WIN Behandle bilde for kopiere                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xk1win        begsr
      *
     c     key01         chain     skbul1                             60
      *
     c*>                 move      snkomm        k1text
      *
     c                   write     s1win
      *
     c     k1tagb        tag
      *
     c                   exfmt     k1win
      *
     c     *inkc         cabeq     *on           k1end1
     c     *inkl         cabeq     *on           k1end1
      *
      * Post er ikke utfyllt
      *
      * Slå opp i filen
      *
     c     key01         chain     skbul1                             60
      *
      * Post finnes fra før
      *
     c                   if        *in60 = *off
     c                   move      *on           *in33
     c                   goto      k1tagb
     c                   endif
      *
      * Oppdater file
      *
     c     key01         chain     skbulur                            60
     c                   move      k1kode        sbkode
     c                   write     skbulur
      *
     c     k1tag1        tag
      *
      * Oppdater subfile
      *
     c                   if        b1valg = ' 3' or
     c                             b1valg = '3 '
     c                   eval      b1valg = *blank
     c                   update    b1sfl
     c                   endif
      *
     c                   eval      b2fis1 = *blank
     c                   eval      k1kode = *blank
      *
     c     k1end1        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * M1BLD Behandle åpningsbildet for ny post                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xm1bld        begsr
      *
     c     m1taga        tag
      *
      * Vis skjermbilde
      *
     c                   exfmt     m1bld
      *
     c     *inkc         cabeq     *on           xm1end
     c     *inkl         cabeq     *on           xm1end
6.10  *
6.10  * F4=Spørring
6.10  *
6.10 c                   if        *inkd  = *on
6.10 c                   exsr      spØrring
6.10 c                   goto      m1taga
6.10 c                   endif
      *
      * Sjekk,  Finnes AVDELING i KODE-REGISTER
      *
     c                   if        *in41 = *on
     c                   exsr      subavde
     c                   if        w_retk <> *blank
     c                   eval      *in71  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      * Sjekk,  Finnes LAGER i KODE-REGISTER
      *
     c                   if        *in42 = *on
     c                   exsr      sublage
     c                   if        w_retk = '1'
     c                   eval      *in72  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      *  Sjekk,  Finnes ORDRETYPE i KODE-REGISTER
      *
     c                   if        *in43 = *on
     c                   move      m1otyp        votyl1_otyp
     c     votyl1_key    chain     votyl1r
     c                   if        not%found
     c                   eval      *in73  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      * Sjekke om LAND er gyldig
      *
     c                   if        *in44 = *on
     c                   call      'RS712R'                                      land-
     c                   parm                    w_retk                           kode
     c                   parm                    m1land                           kode
     c                   parm                    w_ltxt                           kode
     c                   if        w_retk = 'N'                                 Kode
     c                   move      *on           *in74                          Error
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      * Sjekke om DISTRIKT er gyldig
      *
     c                   if        *in45 = *on
     c                   call      'RS708R'                                      distrikt-
     c                   parm                    w_retk                           kode
     c                   parm                    m1dist                           kode
     c                   parm                    w_htxt                           kode
      *
     c                   if        w_retk = 'N'                                 Kode
     c                   move      *on           *in75                          Pos.cur,
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      * Sjekk,  Finnes SELGER i KODE-REGISTER
      *
     c                   if        *in46 = *on
     c                   exsr      subselg
     c                   if        w_retk <> *blank
     c                   eval      *in76  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      * Sjekk, Finnes KUNDEKATEGORI i KODE-REGISTER
      *
     c                   if        *in47 = *on
     c                   call      'RS711R'                                      kundekategori-
     c                   parm                    w_retk                           kode
     c                   parm                    m1kkat                           kode
     c                   parm                    w_ktxt                           kode
      *
     c                   if        w_retk = 'N'                                 Kode
     c                   move      *on           *in77                          Pos.cur,
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      *  Sjekk,  Finnes KUNDENUMMER finnes i KUNDE-REGISTER
      *
     c                   if        *in48 = *on
     c                   move      m1kund        rkunl1_kund
     c     rkunl1_key    chain     rkunl1r
     c                   if        not%found
     c                   eval      *in78  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      *  Sjekk,  Finnes OVERGRUPPE i OVER-GRUPPE-REGISTER
      *
     c                   if        *in49 = *on
     c                   move      m1ogrp        vogrl1_oogr
     c     vogrl1_key    chain     vogrl1r
     c                   if        not%found
     c                   eval      *in79  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      *  Sjekk,  Finnes HOVEDGRUPPE i HOVED-GRUPPE-REGISTER
      *
     c                   if        *in50 = *on
     c                   move      m1ogrp        vhgrl1_hogr
     c                   move      m1hgrp        vhgrl1_hhgr
     c     vhgrl1_key    chain     vhgrl1
     c                   if        not%found
     c                   eval      *in80  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      *  Sjekk,  Finnes UNDERGRUPPE i UNDER-GRUPPE-REGISTER
      *
     c                   if        *in51 = *on
     c                   move      m1ogrp        vugrl1_uogr
     c                   move      m1hgrp        vugrl1_uhgr
     c                   move      m1ugrp        vugrl1_uugr
     c     vugrl1_key    chain     vugrl1
     c                   if        not%found
     c                   eval      *in81  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      *  Sjekk,  Finnes VARENUMMER i VARE-REGISTER
      *
     c                   if        *in52 = *on
     c                   move      m1vare        vvarl1_vare
     c     vvarl1_key    chain     vvarl1r
     c                   if        not%found
     c                   eval      *in82  = *on
     c                   goto      m1taga
     c                   endif
     c                   endif
      *
      * Legg inn verdier i nøkkel
      *
     c                   move      m1avde        w_avde
     c                   move      m1lage        w_lage
     c                   move      m1otyp        w_otyp
     c                   move      m1land        w_land
     c                   move      m1dist        w_dist
     c                   move      m1selg        w_selg
     c                   move      m1kkat        w_kkat
     c                   move      m1kund        w_kund
     c                   move      m1ogrp        w_ogrp
     c                   move      m1hgrp        w_hgrp
     c                   move      m1ugrp        w_ugrp
     c                   move      m1vare        w_vare
      *
     c                   exsr      xc2bld
      *
     c                   goto      m1taga
      *
     c     xm1end        endsr
      *
6.10  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.10  * Subrutine for spørring
6.10  * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
6.10  *
6.10 c     spØrring      begsr
6.10  *
6.10  * Spørring på avdeling
6.10  *
6.10 c                   if        w_afld = 'M1AVDE'
6.10 c                   call      'RA507R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1avde
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring på ordretyper
6.10  *
6.10 c                   if        w_afld = 'M1OTYP'
6.10 c                   call      'VA550R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1otyp
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring på lager
6.10  *
6.10 c                   if        w_afld = 'M1LAGE'
6.10 c                   call      'RA510R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    p_lage
6.10 c                   parm                    w_text
6.10 c                   eval      m1lage = p_lage
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring på land
6.10  *
6.10 c                   if        w_afld = 'M1LAND'
6.10 c                   call      'RA512R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1land
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring på Distrikt
6.10  *
6.10 c                   if        w_afld = 'M1DIST'
6.10 c                   call      'RA508R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1dist
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring på Selger
6.10  *
6.10 c                   if        w_afld = 'M1SELG'
6.10 c                   call      'RA509R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1selg
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring i Kundekategori
6.10  *
6.10 c                   if        w_afld = 'M1KKAT'
6.10 c                   call      'RA511R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1kkat
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring i Kunderegister
6.10  *
6.10 c                   if        w_afld = 'M1KUND'
6.10 c                   call      'RK500R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1kund
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring i Overgruppe
6.10  *
6.10 c                   if        w_afld = 'M1OGRP'
6.10 c                   eval      m1hgrp = 0
6.10 c                   eval      m1ugrp = 0
6.10 c                   call      'VG510R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1ogrp
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring i Hovedgruppe
6.10  *
6.10 c                   if        w_afld = 'M1HGRP'
6.10 c                   eval      m1ugrp = 0
6.10 c                   call      'VG511R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1ogrp
6.10 c                   parm                    m1hgrp
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring i Undergruppe
6.10  *
6.10 c                   if        w_afld = 'M1UGRP'
6.10 c                   call      'VG512R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1ogrp
6.10 c                   parm                    m1hgrp
6.10 c                   parm                    m1ugrp
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10  * Spørring i Varenummer
6.10  *
6.10 c                   if        w_afld = 'M1VARE'
6.10 c                   call      'VV500R'
6.10 c                   parm                    w_firm
6.10 c                   parm                    m1vare
6.10 c                   parm                    w_text
6.10 c                   leavesr
6.10 c                   endif
6.10  *
6.10 c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * M2BLD Behandle åpningsbildet for overgruppe/hovedgruppe/undergrp*
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xm2bld        begsr
      *
     c     m2taga        tag
      *
      * Vis skjermbilde
      *
     c                   exfmt     m2bld
      *
     c     *inkc         cabeq     *on           xm2end
     c     *inkl         cabeq     *on           xm2end
      *
      *  Sjekk,  Finnes OVERGRUPPE i OVER-GRUPPE-REGISTER
      *
     c                   move      m2ogrp        vogrl1_oogr
     c     vogrl1_key    chain     vogrl1r
     c                   if        not%found
     c                   eval      *in79  = *on
     c                   goto      m2taga
     c                   endif
      *
      *  Sjekk,  Finnes HOVEDGRUPPE i HOVED-GRUPPE-REGISTER
      *
     c                   move      m2ogrp        vhgrl1_hogr
     c                   move      m2hgrp        vhgrl1_hhgr
     c     vhgrl1_key    chain     vhgrl1
     c                   if        not%found
     c                   eval      *in80  = *on
     c                   goto      m2taga
     c                   endif
      *
      *  Sjekk,  Finnes UNDERGRUPPE i UNDER-GRUPPE-REGISTER
      *
     c                   move      m2ogrp        vugrl1_uogr
     c                   move      m2hgrp        vugrl1_uhgr
     c                   move      m2ugrp        vugrl1_uugr
     c     vugrl1_key    chain     vugrl1
     c                   if        not%found
     c                   eval      *in81  = *on
     c                   goto      m2taga
     c                   endif
      *
      * Hent tekster
      *
     c                   movel     m2ogrp        c2vis1
     c                   movel     m2hgrp        c2vis2
     c                   movel     m2ugrp        c2vis3
      *
      * Legg inn verdier i nøkkel
      *
     c                   move      m2ogrp        w_ogrp
     c                   move      m2hgrp        w_hgrp
     c                   move      m2ugrp        w_ugrp
      *
     c                   exsr      xc2bld
      *
     c                   goto      m2taga
      *
     c     xm2end        endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * V1WIN Behandle bilde for endring av kolonne                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xv1win        begsr
      *
     c                   z-add     9             wactli
     c                   z-add     40            wactpo
     c                   exfmt     v1win
      *
     c                   move      v1aar4        b2HHAA
      *
     c     *inkc         cabeq     *on           v1tag1
     c     *inkl         cabeq     *on           v1tag1
      *
     c     v1tag1        tag
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekk om avdeling finnes                          RS707R
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     subavde       begsr
      *
     c                   call      'RS707R'
     c                   parm                    w_retk
     c                   parm                    m1avde
     c                   parm                    w_gtxt
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekk/Hent tekst for selger                       RS709R
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     subselg       begsr
      *
     c                   call      'RS709R'
     c                   parm                    w_retk
     c                   parm                    m1selg
     c                   parm                    w_itxt
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekk/Hent tekst for lager
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     c     sublage       begsr
      *
6.10 c                   eval      w_retk = *blank
6.10 c                   eval      ra10l1_jkod = m1lage
6.10 c     ra10l1_key    chain     ra10l1r
6.10 c                   if        not %found
6.10 c                   eval      w_retk = '1'
6.10 c                   endif
6.10  *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XC2LES Leser file og flytter felter til C2BLD                   *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     XC2LES        begsr
      *
      * 0-Stiller hele skjermbilde
      *
     c                   move      c2txt1        wstxt1
     c                   move      c2txt2        wstxt2
     c                   move      c2txt3        wstxt3
     c                   move      c2vis1        wsvis1
     c                   move      c2vis2        wsvis2
     c                   move      c2vis3        wsvis3
     c                   move      c2fnØk        wsfnØk
     c                   move      c2fmet        wsfmet
     c                   move      c2rper        wsrper
     c                   move      c2tbel        wstbel
     c                   move      c2cmd1        wscmd1
     c                   move      c2cmd2        wscmd2
     c                   move      c2cmd3        wscmd3
     c                   move      c2cmd4        wscmd4
      *
     c                   clear                   C2BLD
      *
     c                   move      wstxt1        c2txt1
     c                   move      wstxt2        c2txt2
     c                   move      wstxt3        c2txt3
     c                   move      wsvis1        c2vis1
     c                   move      wsvis2        c2vis2
     c                   move      wsvis3        c2vis3
     c                   move      wsfnØk        c2fnØk
     c                   move      wsfmet        c2fmet
     c                   move      wsrper        c2rper
     c                   move      wstbel        c2tbel
     c                   move      wscmd1        c2cmd1
     c                   move      wscmd2        c2cmd2
     c                   move      wscmd3        c2cmd3
     c                   move      wscmd4        c2cmd4
      *
      * Legger inn tekster for Antall/Beløp
      *
     c                   move      'beløp '      c2aabb
      *
     c     wiaabb        ifeq      'A'
     c                   move      'antall'      c2aabb
     c                   endif
      *
      * Finne budsjettpost
      *
     c                   move      v1aar4        w_hhaa
     c     key01         chain     skbul1                             60
      *
     c     *in60         ifeq      *off
     c                   movel     mld(2)        c2nyen
     c                   else
     c                   movel     mld(1)        c2nyen
     c                   endif
      *
     c     *in30         ifeq      *on
     c                   movel     mld(3)        c2nyen
     c                   endif
      *
      * Legger opp heading over fire kolonner
      *
     c     v1inh1        ifeq      'S'
     c                   movel     txt(5)        c2hed1
     c                   move      1             wk1typ
     c                   else
     c     v1inh1        ifeq      'B'
     c                   movel     txt(6)        c2hed1
     c                   move      3             wk1typ
     c                   else
     c     v1inh1        ifeq      'A'
     c                   movel     txt(7)        c2hed1
     c                   move      4             wk1typ
     c                   endif
     c                   endif
     c                   endif
      *
     c     v1inh2        ifeq      'S'
     c                   movel     txt(5)        c2hed2
     c                   move      1             wk2typ
     c                   else
     c     v1inh2        ifeq      'B'
     c                   movel     txt(6)        c2hed2
     c                   move      3             wk2typ
     c                   else
     c     v1inh2        ifeq      'A'
     c                   movel     txt(7)        c2hed2
     c                   move      4             wk2typ
     c                   endif
     c                   endif
     c                   endif
      *
     c     v1inh3        ifeq      'S'
     c                   movel     txt(5)        c2hed3
     c                   move      1             wk3typ
     c                   else
     c     v1inh3        ifeq      'B'
     c                   movel     txt(6)        c2hed3
     c                   move      3             wk3typ
     c                   else
     c     v1inh3        ifeq      'A'
     c                   movel     txt(7)        c2hed3
     c                   move      4             wk3typ
     c                   endif
     c                   endif
     c                   endif
      *
     c     v1inh4        ifeq      'S'
     c                   movel     txt(5)        c2hed4
     c                   move      1             wk4typ
     c                   else
     c     v1inh4        ifeq      'B'
     c                   movel     txt(6)        c2hed4
     c                   move      3             wk4typ
     c                   else
     c     v1inh4        ifeq      'A'
     c                   movel     txt(7)        c2hed4
     c                   move      4             wk4typ
     c                   endif
     c                   endif
     c                   endif
      *
      * Legger opp årstall i de fire kolonner
      *
     c                   movel     v1aar1        wk1hlp
     c                   movel     v1aar2        wk2hlp
     c                   movel     v1aar3        wk3hlp
     c                   movel     v1aar4        wk4hlp
     c                   move      wk1hlp        c2hed1
     c                   move      wk2hlp        c2hed2
     c                   move      wk3hlp        c2hed3
     c                   move      wk4hlp        c2hed4
      *
      * Henter data inn fra saldomatrise og plasserer i skjermbildet
      *
      * Kolonne 1
      *
     c                   move      v1aar1        w_hhaa
     c     key01         chain     skbul1                             60
      *
     c     skakl1_key    chain     skakl1r                            63
      *
     c     v1inh1        ifeq      'B'
     c     w_sabe        ifeq      1
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k101
     c                   z-add     isa(2)        c2k102
     c                   z-add     isa(3)        c2k103
     c                   z-add     isa(4)        c2k104
     c                   z-add     isa(5)        c2k105
     c                   z-add     isa(6)        c2k106
     c                   z-add     isa(7)        c2k107
     c                   z-add     isa(8)        c2k108
     c                   z-add     isa(9)        c2k109
     c                   z-add     isa(10)       c2k110
     c                   z-add     isa(11)       c2k111
     c                   z-add     isa(12)       c2k112
     c                   xfoot     isa           c2k114
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
      *
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k101
     c     c2k101        add       isa(2)        c2k102
     c     c2k102        add       isa(3)        c2k103
     c     c2k103        add       isa(4)        c2k104
     c     c2k104        add       isa(5)        c2k105
     c     c2k105        add       isa(6)        c2k106
     c     c2k106        add       isa(7)        c2k107
     c     c2k107        add       isa(8)        c2k108
     c     c2k108        add       isa(9)        c2k109
     c     c2k109        add       isa(10)       c2k110
     c     c2k110        add       isa(11)       c2k111
     c     c2k111        add       isa(12)       c2k112
     c                   z-add     c2k112        c2k114
     c                   endif
     c                   endif
      *
     c                   else
      *
     c     w_sabe        ifeq      1
     c     *in63         ifeq      *off
     c                   z-add     ssa(1)        c2k101
     c                   z-add     ssa(2)        c2k102
     c                   z-add     ssa(3)        c2k103
     c                   z-add     ssa(4)        c2k104
     c                   z-add     ssa(5)        c2k105
     c                   z-add     ssa(6)        c2k106
     c                   z-add     ssa(7)        c2k107
     c                   z-add     ssa(8)        c2k108
     c                   z-add     ssa(9)        c2k109
     c                   z-add     ssa(10)       c2k110
     c                   z-add     ssa(11)       c2k111
     c                   z-add     ssa(12)       c2k112
     c                   xfoot     ssa           c2k114
     c                   endif
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
      *
     c     *in63         ifeq      *off
     c                   z-add     ssa(1)        c2k101
     c     c2k101        add       ssa(2)        c2k102
     c     c2k102        add       ssa(3)        c2k103
     c     c2k103        add       ssa(4)        c2k104
     c     c2k104        add       ssa(5)        c2k105
     c     c2k105        add       ssa(6)        c2k106
     c     c2k106        add       ssa(7)        c2k107
     c     c2k107        add       ssa(8)        c2k108
     c     c2k108        add       ssa(9)        c2k109
     c     c2k109        add       ssa(10)       c2k110
     c     c2k110        add       ssa(11)       c2k111
     c     c2k111        add       ssa(12)       c2k112
     c                   z-add     c2k112        c2k114
     c                   endif
     c                   endif
      *
      * Kolonne 2
      *
     c                   move      v1aar2        w_hhaa
     c     key01         chain     skbul1                             60
      *
     c     skakl1_key    chain     skakl1r                            63
      *
     c     v1inh2        ifeq      'B'
     c     w_sabe        ifeq      1
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k201
     c                   z-add     isa(2)        c2k202
     c                   z-add     isa(3)        c2k203
     c                   z-add     isa(4)        c2k204
     c                   z-add     isa(5)        c2k205
     c                   z-add     isa(6)        c2k206
     c                   z-add     isa(7)        c2k207
     c                   z-add     isa(8)        c2k208
     c                   z-add     isa(9)        c2k209
     c                   z-add     isa(10)       c2k210
     c                   z-add     isa(11)       c2k211
     c                   z-add     isa(12)       c2k212
     c                   xfoot     isa           c2k214
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k201
     c     c2k201        add       isa(2)        c2k202
     c     c2k202        add       isa(3)        c2k203
     c     c2k203        add       isa(4)        c2k204
     c     c2k204        add       isa(5)        c2k205
     c     c2k205        add       isa(6)        c2k206
     c     c2k206        add       isa(7)        c2k207
     c     c2k207        add       isa(8)        c2k208
     c     c2k208        add       isa(9)        c2k209
     c     c2k209        add       isa(10)       c2k210
     c     c2k210        add       isa(11)       c2k211
     c     c2k211        add       isa(12)       c2k212
     c                   z-add     c2k212        c2k214
     c                   endif
     c                   endif
      *
     c                   else
      *
     c     w_sabe        ifeq      1
     c     *in63         ifeq      *off
     c                   z-add     ssa(1)        c2k201
     c                   z-add     ssa(2)        c2k202
     c                   z-add     ssa(3)        c2k203
     c                   z-add     ssa(4)        c2k204
     c                   z-add     ssa(5)        c2k205
     c                   z-add     ssa(6)        c2k206
     c                   z-add     ssa(7)        c2k207
     c                   z-add     ssa(8)        c2k208
     c                   z-add     ssa(9)        c2k209
     c                   z-add     ssa(10)       c2k210
     c                   z-add     ssa(11)       c2k211
     c                   z-add     ssa(12)       c2k212
     c                   xfoot     ssa           c2k214
     c                   endif
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
      *
     c     *in63         ifeq      *off
     c                   z-add     ssa(1)        c2k201
     c     c2k201        add       ssa(2)        c2k202
     c     c2k202        add       ssa(3)        c2k203
     c     c2k203        add       ssa(4)        c2k204
     c     c2k204        add       ssa(5)        c2k205
     c     c2k205        add       ssa(6)        c2k206
     c     c2k206        add       ssa(7)        c2k207
     c     c2k207        add       ssa(8)        c2k208
     c     c2k208        add       ssa(9)        c2k209
     c     c2k209        add       ssa(10)       c2k210
     c     c2k210        add       ssa(11)       c2k211
     c     c2k211        add       ssa(12)       c2k212
     c                   z-add     c2k212        c2k214
     c                   endif
     c                   endif
      *
      * Kolonne 3
      *
     c                   move      v1aar3        w_hhaa
     c     key01         chain     skbul1                             60
      *
     c     skakl1_key    chain     skakl1r                            63
      *
     c     v1inh3        ifeq      'B'
     c     w_sabe        ifeq      1
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k301
     c                   z-add     isa(2)        c2k302
     c                   z-add     isa(3)        c2k303
     c                   z-add     isa(4)        c2k304
     c                   z-add     isa(5)        c2k305
     c                   z-add     isa(6)        c2k306
     c                   z-add     isa(7)        c2k307
     c                   z-add     isa(8)        c2k308
     c                   z-add     isa(9)        c2k309
     c                   z-add     isa(10)       c2k310
     c                   z-add     isa(11)       c2k311
     c                   z-add     isa(12)       c2k312
     c                   xfoot     isa           c2k314
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k301
     c     c2k301        add       isa(2)        c2k302
     c     c2k302        add       isa(3)        c2k303
     c     c2k303        add       isa(4)        c2k304
     c     c2k304        add       isa(5)        c2k305
     c     c2k305        add       isa(6)        c2k306
     c     c2k306        add       isa(7)        c2k307
     c     c2k307        add       isa(8)        c2k308
     c     c2k308        add       isa(9)        c2k309
     c     c2k309        add       isa(10)       c2k310
     c     c2k310        add       isa(11)       c2k311
     c     c2k311        add       isa(12)       c2k312
     c                   z-add     c2k312        c2k314
     c                   endif
     c                   endif
      *
     c                   else
      *
     c     w_sabe        ifeq      1
     c     *in63         ifeq      *off
     c                   z-add     ssa(1)        c2k301
     c                   z-add     ssa(2)        c2k302
     c                   z-add     ssa(3)        c2k303
     c                   z-add     ssa(4)        c2k304
     c                   z-add     ssa(5)        c2k305
     c                   z-add     ssa(6)        c2k306
     c                   z-add     ssa(7)        c2k307
     c                   z-add     ssa(8)        c2k308
     c                   z-add     ssa(9)        c2k309
     c                   z-add     ssa(10)       c2k310
     c                   z-add     ssa(11)       c2k311
     c                   z-add     ssa(12)       c2k312
     c                   xfoot     ssa           c2k314
     c                   endif
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
      *
     c     *in63         ifeq      *off
     c                   z-add     ssa(1)        c2k301
     c     c2k301        add       ssa(2)        c2k302
     c     c2k302        add       ssa(3)        c2k303
     c     c2k303        add       ssa(4)        c2k304
     c     c2k304        add       ssa(5)        c2k305
     c     c2k305        add       ssa(6)        c2k306
     c     c2k306        add       ssa(7)        c2k307
     c     c2k307        add       ssa(8)        c2k308
     c     c2k308        add       ssa(9)        c2k309
     c     c2k309        add       ssa(10)       c2k310
     c     c2k310        add       ssa(11)       c2k311
     c     c2k311        add       ssa(12)       c2k312
     c                   z-add     c2k312        c2k314
     c                   endif
     c                   endif
      *
      * Kolonne 4
      *
     c                   move      v1aar4        w_hhaa
     c     key01         chain     skbul1                             60
      *
     c     w_sabe        ifeq      1
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k401
     c                   z-add     isa(2)        c2k402
     c                   z-add     isa(3)        c2k403
     c                   z-add     isa(4)        c2k404
     c                   z-add     isa(5)        c2k405
     c                   z-add     isa(6)        c2k406
     c                   z-add     isa(7)        c2k407
     c                   z-add     isa(8)        c2k408
     c                   z-add     isa(9)        c2k409
     c                   z-add     isa(10)       c2k410
     c                   z-add     isa(11)       c2k411
     c                   z-add     isa(12)       c2k412
     c                   xfoot     isa           c2k414
     c                   endif
     c                   endif
      *
     c     w_sabe        ifeq      2
     c     *in60         ifeq      *off
     c                   z-add     isa(1)        c2k401
     c     c2k401        add       isa(2)        c2k402
     c     c2k402        add       isa(3)        c2k403
     c     c2k403        add       isa(4)        c2k404
     c     c2k404        add       isa(5)        c2k405
     c     c2k405        add       isa(6)        c2k406
     c     c2k406        add       isa(7)        c2k407
     c     c2k407        add       isa(8)        c2k408
     c     c2k408        add       isa(9)        c2k409
     c     c2k409        add       isa(10)       c2k410
     c     c2k410        add       isa(11)       c2k411
     c     c2k411        add       isa(12)       c2k412
     c                   z-add     c2k412        c2k414
     c                   endif
     c                   endif
      *
      * Hente inn budsjett-nøkkel og beregn
      *
     c                   move      *zero         mfo
      *
     c     c2fnØk        ifne      99
     c     c2fnØk        ifne      *zero
     c                   move      c2fnØk        ra13l1_mkod
     c     ra13l1_key    chain     ra13l1
      *
     c                   move      ramp01        c2mp01
     c                   move      ramp02        c2mp02
     c                   move      ramp03        c2mp03
     c                   move      ramp04        c2mp04
     c                   move      ramp05        c2mp05
     c                   move      ramp06        c2mp06
     c                   move      ramp07        c2mp07
     c                   move      ramp08        c2mp08
     c                   move      ramp09        c2mp09
     c                   move      ramp10        c2mp10
     c                   move      ramp11        c2mp11
     c                   move      ramp12        c2mp12
     c                   move      ramp01        mfo(01)
     c                   move      ramp02        mfo(02)
     c                   move      ramp03        mfo(03)
     c                   move      ramp04        mfo(04)
     c                   move      ramp05        mfo(05)
     c                   move      ramp06        mfo(06)
     c                   move      ramp07        mfo(07)
     c                   move      ramp08        mfo(08)
     c                   move      ramp09        mfo(09)
     c                   move      ramp10        mfo(10)
     c                   move      ramp11        mfo(11)
     c                   move      ramp12        mfo(12)
     c                   xfoot     mfo           c2mpXF
     c                   endif
     c                   endif
      *
      * Legger inn tall utfra tabell, kode=99=jevn fordeling
      *
     c     c2fnØk        ifne      *zero
     c     1             do        12            n
     c     c2fnØk        ifeq      99
     c                   z-add     8.333333      wfo(n)
     c                   else
     c                   z-add     mfo(n)        wfo(n)
     c                   endif
     c                   enddo
     c                   endif
      *
      * Beregner beløp utfra fordelingsnøkkel
      *
     c     c2fnØk        ifne      *zero
      *
     c                   move      *zero         akkpro
     c                   move      *zero         akkbel
      *
     c     1             do        12            n
     c                   add       wfo(n)        akkpro
     c     akkpro        mult      c2tbel        work0
     c     work0         div(h)    100           work2
     c     work2         sub       akkbel        wrk(N)
     c                   z-add     work2         akkbel
     c                   enddo
      *
      * Legger fordelingsnøkkelbeløp inn i kolonne4-felter
      *
     c                   move      wrk(1)        c2k401
     c                   move      wrk(2)        c2k402
     c                   move      wrk(3)        c2k403
     c                   move      wrk(4)        c2k404
     c                   move      wrk(5)        c2k405
     c                   move      wrk(6)        c2k406
     c                   move      wrk(7)        c2k407
     c                   move      wrk(8)        c2k408
     c                   move      wrk(9)        c2k409
     c                   move      wrk(10)       c2k410
     c                   move      wrk(11)       c2k411
     c                   move      wrk(12)       c2k412
     c                   xfoot     wrk           c2k414
     c                   endif
      *
      * Beregne etter fordelingsmetode
      * 1 - 2 - 3 - 4 - 6 - 9
      *
     c     c2fmet        ifne      *zero
     c                   z-add     0             wfo
     c                   endif
      *
     c     c2fmet        ifeq      1
     c     c2rper        do        12            n
     c                   z-add     1             wfo(n)
     c                   enddo
     c                   endif
      *
     c     c2fmet        ifeq      2
     c     c2rper        do        12            n
     c                   z-add     1             wfo(n)
     c                   enddo     2
     c                   endif
      *
     c     c2fmet        ifeq      3
     c     c2rper        do        12            n
     c                   z-add     1             wfo(n)
     c                   enddo     3
     c                   endif
      *
     c     c2fmet        ifeq      4
     c     c2rper        do        12            n
     c                   z-add     1             wfo(n)
     c                   enddo     4
     c                   endif
      *
     c     c2fmet        ifeq      6
     c     c2rper        do        12            n
     c                   z-add     1             wfo(n)
     c                   enddo     6
     c                   endif
      *
      * Legger inn verdier i kolonne4-felter utfra ford.nøkkel
      *
     c     c2fmet        ifne      *zero
     c     c2fmet        ifne      9
     c     c2tbel        mult      wfo(1)        c2k401
     c     c2tbel        mult      wfo(2)        c2k402
     c     c2tbel        mult      wfo(3)        c2k403
     c     c2tbel        mult      wfo(4)        c2k404
     c     c2tbel        mult      wfo(5)        c2k405
     c     c2tbel        mult      wfo(6)        c2k406
     c     c2tbel        mult      wfo(7)        c2k407
     c     c2tbel        mult      wfo(8)        c2k408
     c     c2tbel        mult      wfo(9)        c2k409
     c     c2tbel        mult      wfo(10)       c2k410
     c     c2tbel        mult      wfo(11)       c2k411
     c     c2tbel        mult      wfo(12)       c2k412
      *
     c                   else
      *
     c     12            sub       c2rper        w2rper
     c     c2rper        do        12            n
     c     100           div(h)    w2rper        wfo(n)
     c                   enddo
      *
     c                   move      *zero         akkpro
     c                   move      *zero         akkbel
     c     1             do        12            n
     c                   add       wfo(N)        akkpro
     c     akkpro        mult      c2tbel        work0
     c     work0         div(h)    100           work2
     c     work2         sub       akkbel        wrk(n)
     c                   z-add     work2         akkbel
     c                   enddo
      *
     c                   move      wrk(1)        c2k401
     c                   move      wrk(2)        c2k402
     c                   move      wrk(3)        c2k403
     c                   move      wrk(4)        c2k404
     c                   move      wrk(5)        c2k405
     c                   move      wrk(6)        c2k406
     c                   move      wrk(7)        c2k407
     c                   move      wrk(8)        c2k408
     c                   move      wrk(9)        c2k409
     c                   move      wrk(10)       c2k410
     c                   move      wrk(11)       c2k411
     c                   move      wrk(12)       c2k412
     c                   xfoot     wrk           c2k414
     c                   endif
      *
     c                   z-add     c2k401        c2k414
     c                   add       c2k402        c2k414
     c                   add       c2k403        c2k414
     c                   add       c2k404        c2k414
     c                   add       c2k405        c2k414
     c                   add       c2k406        c2k414
     c                   add       c2k407        c2k414
     c                   add       c2k408        c2k414
     c                   add       c2k409        c2k414
     c                   add       c2k410        c2k414
     c                   add       c2k411        c2k414
     c                   add       c2k412        c2k414
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Tøm subfile                                                     *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xclr01        begsr
      *
     c                   move      *on           *in14
     c                   write     b2ctl
     c                   move      *off          *in14
      *
     c                   move      *off          *in15
     c                   eval      srrn01 = 0
     c                   eval      sfrn01 = 0
     c                   eval      ssrn01 = 0
     c                   eval      spge01 = 0
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Fyll opp subfile                                                *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xcrt01        begsr
      *
     c                   eval      spge01 = spge01 + 10
     c                   eval      srrn01 = ssrn01
      *
     c                   dou       srrn01 = spge01
      *
     c     les01         tag
      *
     c                   read      skbul1                                 15
      *
     c     *in15         cabeq     *on           xend01
      *
     c                   if        sbfirm <> w_firm
     c                   goto      les01
     c                   endif
      *
     c                   if        sbhhaa <> w_hhaa
     c                   goto      les01
     c                   endif
      *
     c                   if        sbvers <> w_vers
     c                   goto      les01
     c                   endif
      *
     c                   if        sbkode <> w_kode
     c                   goto      les01
     c                   endif
      *
     c                   if        sbaabb <> w_aabb
     c                   goto      les01
     c                   endif
      *
     c                   eval      srrn01 = srrn01 + 1
      *
     c                   move      sbavde        b1avde
     c                   move      sblage        b1lage
     c                   move      sbotyp        b1otyp
     c                   move      sbland        b1land
     c                   move      sbdist        b1dist
     c                   move      sbselg        b1selg
     c                   move      sbkkat        b1kkat
     c                   move      sbkund        b1kund
     c                   move      sbogrp        b1ogrp
     c                   move      sbhgrp        b1hgrp
     c                   move      sbugrp        b1ugrp
     c                   move      sbvare        b1vare
      *
      * Beregner total budsjett
      *
     c                   xfoot     isa           b1sumb
      *
      * Hent tekster fra tabell
      *
     c                   move      *blank        b1vis1
     c                   move      *blank        b1vis2
     c                   move      *blank        b1vis3
      *
     c                   exsr      hnttxt
      *
     c                   write     b1sfl
     c                   enddo
      *
     c     xend01        tag
      *
     c                   if        srrn01 > ssrn01
     c                   eval      sfrn01 = ssrn01 + 1
     c                   endif
      *
     c                   eval      ssrn01 = srrn01
     c                   eval      svrn01 = sfrn01
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Display subfile                                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xdsp01        begsr
      *
     c                   if        srrn01 <> 0
     c                   move      *on           *in12
     c                   endif
      *
     c                   move      *on           *in13
     c                   exfmt     b2ctl
     c                   move      *off          *in12
     c                   move      *off          *in13
     c                   move      *off          *in22
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Hent opplysninger fra register                                  *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     hnttxt        begsr
      *
      * (11) Avdeling
      *
     c     r1            ifeq      11
     c                   movel     sbavde        p_gkod
     c                   call      'RS707R'
     c                   parm                    p_stat
     c                   parm                    p_gkod
     c                   parm                    p_tx20
     c                   eval      b1vis1 = %trim(%editc(sbavde:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r2            ifeq      11
     c                   movel     sbavde        p_gkod
     c                   call      'RS707R'
     c                   parm                    p_stat
     c                   parm                    p_gkod
     c                   parm                    p_tx20
     c                   eval      b1vis2 = %trim(%editc(sbavde:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r3            ifeq      11
     c                   movel     sbavde        p_gkod
     c                   call      'RS707R'
     c                   parm                    p_stat
     c                   parm                    p_gkod
     c                   parm                    p_tx20
     c                   eval      b1vis3 = %trim(%editc(sbavde:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
      *
      * (12) Lager
      *
     c     r1            ifeq      12
     c                   movel     sblage        p_jkod
     c                   call      'RS710R'
     c                   parm                    p_stat
     c                   parm                    p_jkod
     c                   parm                    p_tx20
     c                   eval      b1vis1 = %trim(%editc(sblage:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r2            ifeq      12
     c                   movel     sblage        p_jkod
     c                   call      'RS710R'
     c                   parm                    p_stat
     c                   parm                    p_jkod
     c                   parm                    p_tx20
     c                   eval      b1vis2 = %trim(%editc(sblage:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r3            ifeq      12
     c                   movel     sblage        p_jkod
     c                   call      'RS710R'
     c                   parm                    p_stat
     c                   parm                    p_jkod
     c                   parm                    p_tx20
     c                   eval      b1vis3 = %trim(%editc(sblage:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
      *
      * (13) Ordretype
      *
     c     r1            ifeq      13
     c                   movel     sbotyp        votyl1_otyp
     c     votyl1_key    chain     votyl1
     c                   eval      b1vis1 = %trim(sbotyp) +
     c                                      ' ' + %trim(vaotxt)
     c                   endif
     c     r2            ifeq      13
     c                   movel     sbotyp        votyl1_otyp
     c     votyl1_key    chain     votyl1
     c                   eval      b1vis2 = %trim(sbotyp) +
     c                                      ' ' + %trim(vaotxt)
     c                   endif
     c     r3            ifeq      13
     c                   movel     sbotyp        votyl1_otyp
     c     votyl1_key    chain     votyl1
     c                   eval      b1vis3 = %trim(sbotyp) +
     c                                      ' ' + %trim(vaotxt)
     c                   endif
      *
      * (21) Land
      *
     c     r1            ifeq      21
     c                   movel     sbland        p_lkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_lkod
     c                   parm                    p_tx20
     c                   eval      b1vis1 = %trim(sbland) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r2            ifeq      21
     c                   movel     sbland        p_lkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_lkod
     c                   parm                    p_tx20
     c                   eval      b1vis2 = %trim(sbland) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r3            ifeq      21
     c                   movel     sbland        p_lkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_lkod
     c                   parm                    p_tx20
     c                   eval      b1vis3 = %trim(sbland) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
      *
      * (22) Distrikt
      *
     c     r1            ifeq      22
     c                   movel     sbdist        p_hkod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_hkod
     c                   parm                    p_tx20
     c                   eval      b1vis1 = %trim(%editc(sbdist:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r2            ifeq      22
     c                   movel     sbdist        p_hkod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_hkod
     c                   parm                    p_tx20
     c                   eval      b1vis2 = %trim(%editc(sbdist:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r3            ifeq      22
     c                   movel     sbdist        p_hkod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_hkod
     c                   parm                    p_tx20
     c                   eval      b1vis3 = %trim(%editc(sbdist:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
      *
      * (23) Selger
      *
     c     r1            ifeq      23
     c                   movel     sbselg        p_ikod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_ikod
     c                   parm                    p_tx20
     c                   eval      b1vis1 = %trim(%editc(sbselg:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r2            ifeq      23
     c                   movel     sbselg        p_ikod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_ikod
     c                   parm                    p_tx20
     c                   eval      b1vis2 = %trim(%editc(sbselg:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r3            ifeq      23
     c                   movel     sbselg        p_ikod
     c                   call      'RS708R'
     c                   parm                    p_stat
     c                   parm                    p_ikod
     c                   parm                    p_tx20
     c                   eval      b1vis3 = %trim(%editc(sbselg:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
      *
      * (24) Kundekategori
      *
     c     r1            ifeq      24
     c                   movel     sbkkat        p_kkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_kkod
     c                   parm                    p_tx20
     c                   eval      b1vis1 = %trim(%editc(sbkkat:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r2            ifeq      24
     c                   movel     sbkkat        p_kkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_kkod
     c                   parm                    p_tx20
     c                   eval      b1vis2 = %trim(%editc(sbkkat:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
     c     r3            ifeq      24
     c                   movel     sbkkat        p_kkod
     c                   call      'RS711R'
     c                   parm                    p_stat
     c                   parm                    p_kkod
     c                   parm                    p_tx20
     c                   eval      b1vis3 = %trim(%editc(sbkkat:'Z')) +
     c                                      ' ' + %trim(p_tx20)
     c                   endif
      *
      * (25) Kunde
      *
     c     r1            ifeq      25
     c                   movel     sbkund        rkunl1_kund
     c     rkunl1_key    chain     rkunl1
     c                   eval      b1vis1 = %trim(%editc(sbkund:'Z')) +
     c                                      ' ' + %trim(rknavn)
     c                   endif
     c     r2            ifeq      25
     c                   movel     sbkund        rkunl1_kund
     c     rkunl1_key    chain     rkunl1
     c                   eval      b1vis2 = %trim(%editc(sbkund:'Z')) +
     c                                      ' ' + %trim(rknavn)
     c                   endif
     c     r3            ifeq      25
     c                   movel     sbkund        rkunl1_kund
     c     rkunl1_key    chain     rkunl1
     c                   eval      b1vis3 = %trim(%editc(sbkund:'Z')) +
     c                                      ' ' + %trim(rknavn)
     c                   endif
      *
      * (31) Overgruppe
      *
     c     r1            ifeq      31
     c                   movel     sbogrp        vogrl1_oogr
     c     vogrl1_key    chain     vogrl1
     c                   eval      b1vis1 = %trim(%editc(sbogrp:'Z')) +
     c                                      ' ' + %trim(vgotxt)
     c                   endif
     c     r2            ifeq      31
     c                   movel     sbogrp        vogrl1_oogr
     c     vogrl1_key    chain     vogrl1
     c                   eval      b1vis2 = %trim(%editc(sbogrp:'Z')) +
     c                                      ' ' + %trim(vgotxt)
     c                   endif
     c     r3            ifeq      31
     c                   movel     sbogrp        vogrl1_oogr
     c     vogrl1_key    chain     vogrl1
     c                   eval      b1vis3 = %trim(%editc(sbogrp:'Z')) +
     c                                      ' ' + %trim(vgotxt)
     c                   endif
      *
      * (32) Hovedgruppe
      *
     c     r1            ifeq      32
     c                   movel     sbogrp        vhgrl1_hogr
     c                   movel     sbhgrp        vhgrl1_hhgr
     c     vhgrl1_key    chain     vhgrl1
     c                   eval      b1vis1 = %trim(%editc(sbhgrp:'Z')) +
     c                                      ' ' + %trim(vghtxt)
     c                   endif
     c     r2            ifeq      32
     c                   movel     sbogrp        vhgrl1_hogr
     c                   movel     sbhgrp        vhgrl1_hhgr
     c     vhgrl1_key    chain     vhgrl1
     c                   eval      b1vis2 = %trim(%editc(sbhgrp:'Z')) +
     c                                      ' ' + %trim(vghtxt)
     c                   endif
     c     r3            ifeq      32
     c                   movel     sbogrp        vhgrl1_hogr
     c                   movel     sbhgrp        vhgrl1_hhgr
     c     vhgrl1_key    chain     vhgrl1
     c                   eval      b1vis3 = %trim(%editc(sbhgrp:'Z')) +
     c                                      ' ' + %trim(vghtxt)
     c                   endif
      *
      * (33) Undergruppe
      *
     c     r1            ifeq      33
     c                   movel     sbogrp        vugrl1_uogr
     c                   movel     sbhgrp        vugrl1_uhgr
     c                   movel     sbugrp        vugrl1_uugr
     c     vugrl1_key    chain     vugrl1
     c                   eval      b1vis1 = %trim(%editc(sbugrp:'Z')) +
     c                                      ' ' + %trim(vgutxt)
     c                   endif
     c     r2            ifeq      33
     c                   movel     sbogrp        vugrl1_uogr
     c                   movel     sbhgrp        vugrl1_uhgr
     c                   movel     sbugrp        vugrl1_uugr
     c     vugrl1_key    chain     vugrl1
     c                   eval      b1vis2 = %trim(%editc(sbugrp:'Z')) +
     c                                      ' ' + %trim(vgutxt)
     c                   endif
     c     r3            ifeq      33
     c                   movel     sbogrp        vugrl1_uogr
     c                   movel     sbhgrp        vugrl1_uhgr
     c                   movel     sbugrp        vugrl1_uugr
     c     vugrl1_key    chain     vugrl1
     c                   eval      b1vis3 = %trim(%editc(sbugrp:'Z')) +
     c                                      ' ' + %trim(vgutxt)
     c                   endif
      *
      * (34) Vare
      *
     c     r1            ifeq      34
     c                   movel     sbvare        vvarl1_vare
     c     vvarl1_key    chain     vvarl1
     c                   eval      b1vis1 = %trim(sbvare) +
     c                                      ' ' + %trim(vvtek1)
     c                   endif
     c     r2            ifeq      34
     c                   movel     sbvare        vvarl1_vare
     c     vvarl1_key    chain     vvarl1
     c                   eval      b1vis2 = %trim(sbvare) +
     c                                      ' ' + %trim(vvtek1)
     c                   endif
     c     r3            ifeq      34
     c                   movel     sbvare        vvarl1_vare
     c     vvarl1_key    chain     vvarl1
     c                   eval      b1vis3 = %trim(sbvare) +
     c                                      ' ' + %trim(vvtek1)
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * henter nummer verdier fra array                                 *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     hntarr        begsr
      *
     c                   move      *zero         r1
     c                   move      *zero         r2
     c                   move      *zero         r3
      *
      * (11) Avdeling
      *
     c     w_kode_11     ifeq      1
     c                   move      11            r1
     c                   move      *on           *in41
     c                   endif
     c     w_kode_11     ifeq      2
     c                   move      11            r2
     c                   move      *on           *in41
     c                   endif
     c     w_kode_11     ifeq      3
     c                   move      11            r3
     c                   move      *on           *in41
     c                   endif
      *
      * (12)
      *
     c     w_kode_12     ifeq      1
     c                   move      12            r1
     c                   move      *on           *in42
     c                   endif
     c     w_kode_12     ifeq      2
     c                   move      12            r2
     c                   move      *on           *in42
     c                   endif
     c     w_kode_12     ifeq      3
     c                   move      12            r3
     c                   move      *on           *in42
     c                   endif
      *
      * (13)
      *
     c     w_kode_13     ifeq      1
     c                   move      13            r1
     c                   move      *on           *in43
     c                   endif
     c     w_kode_13     ifeq      2
     c                   move      13            r2
     c                   move      *on           *in43
     c                   endif
     c     w_kode_13     ifeq      3
     c                   move      13            r3
     c                   move      *on           *in43
     c                   endif
      *
      * (21)
      *
     c     w_kode_21     ifeq      1
     c                   move      21            r1
     c                   move      *on           *in44
     c                   endif
     c     w_kode_21     ifeq      2
     c                   move      21            r2
     c                   move      *on           *in44
     c                   endif
     c     w_kode_21     ifeq      3
     c                   move      21            r3
     c                   move      *on           *in44
     c                   endif
      *
      * (22)
      *
     c     w_kode_22     ifeq      1
     c                   move      22            r1
     c                   move      *on           *in45
     c                   endif
     c     w_kode_22     ifeq      2
     c                   move      22            r2
     c                   move      *on           *in45
     c                   endif
     c     w_kode_22     ifeq      3
     c                   move      22            r3
     c                   move      *on           *in45
     c                   endif
      *
      * (23)
      *
     c     w_kode_23     ifeq      1
     c                   move      23            r1
     c                   move      *on           *in46
     c                   endif
     c     w_kode_23     ifeq      2
     c                   move      23            r2
     c                   move      *on           *in46
     c                   endif
     c     w_kode_23     ifeq      3
     c                   move      23            r3
     c                   move      *on           *in46
     c                   endif
      *
      * (24)
      *
     c     w_kode_24     ifeq      1
     c                   move      24            r1
     c                   move      *on           *in47
     c                   endif
     c     w_kode_24     ifeq      2
     c                   move      24            r2
     c                   move      *on           *in47
     c                   endif
     c     w_kode_24     ifeq      3
     c                   move      24            r3
     c                   move      *on           *in47
     c                   endif
      *
      * (25)
      *
     c     w_kode_25     ifeq      1
     c                   move      25            r1
     c                   move      *on           *in48
     c                   endif
     c     w_kode_25     ifeq      2
     c                   move      25            r2
     c                   move      *on           *in48
     c                   endif
     c     w_kode_25     ifeq      3
     c                   move      25            r3
     c                   move      *on           *in48
     c                   endif
      *
      * (31)
      *
     c     w_kode_31     ifeq      1
     c                   move      31            r1
     c                   move      *on           *in49
     c                   endif
     c     w_kode_31     ifeq      2
     c                   move      31            r2
     c                   move      *on           *in49
     c                   endif
     c     w_kode_31     ifeq      3
     c                   move      31            r3
     c                   move      *on           *in49
     c                   endif
      *
      * (32)
      *
     c     w_kode_32     ifeq      1
     c                   move      32            r1
     c                   move      *on           *in50
     c                   endif
     c     w_kode_32     ifeq      2
     c                   move      32            r2
     c                   move      *on           *in50
     c                   endif
     c     w_kode_32     ifeq      3
     c                   move      32            r3
     c                   move      *on           *in50
     c                   endif
      *
      * (33)
      *
     c     w_kode_33     ifeq      1
     c                   move      33            r1
     c                   move      *on           *in51
     c                   endif
     c     w_kode_33     ifeq      2
     c                   move      33            r2
     c                   move      *on           *in51
     c                   endif
     c     w_kode_33     ifeq      3
     c                   move      33            r3
     c                   move      *on           *in51
     c                   endif
      *
      * (34)
      *
     c     w_kode_34     ifeq      1
     c                   move      34            r1
     c                   move      *on           *in52
     c                   endif
     c     w_kode_34     ifeq      2
     c                   move      34            r2
     c                   move      *on           *in52
     c                   endif
     c     w_kode_34     ifeq      3
     c                   move      34            r3
     c                   move      *on           *in52
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *inzsr        begsr
      *
     c                   z-add     0             wactli            2 0
     c                   z-add     0             wactpo            3 0
      *
     c                   move      *zero         wk1typ            1 0
     c                   move      *zero         wk2typ            1 0
     c                   move      *zero         wk3typ            1 0
     c                   move      *zero         wk4typ            1 0
     c                   move      *zero         wpfunk            1 0
     c                   move      *zero         werror            1 0
     c                   move      *zero         wpantp            2 0
     c                   move      *zero         n                 2 0
     c                   move      *zero         wc2cmd            1 0
     c                   move      *zero         w_sabe            1 0
     c                   move      *zero         wpgkod            4 0
     c                   move      *zero         wpmkod            2 0
     c                   move      *blank        wk1hlp            5
     c                   move      *blank        wk2hlp            5
     c                   move      *blank        wk3hlp            5
     c                   move      *blank        wk4hlp            5
     c                   move      *blank        wseqen            1
     c                   move      *blank        wpgtxt           20
     c                   move      *blank        wpmtxt           30
      *
     c                   move      *zero         akkpro            9 6
     c                   move      *zero         akkbel           13 0
     c                   move      *zero         work0            13 0
     c                   move      *zero         work2            11 0
     c                   move      *zero         w2rper            2 0
      *
      * Ta vare på verdier for gjennbruk etter bruk av Clear i bilde C2
      *
     c     *like         define    C2TXT1        wstxt1
     c     *like         define    C2TXT2        wstxt2
     c     *like         define    C2TXT3        wstxt3
     c     *like         define    C2VIS1        wsvis1
     c     *like         define    C2VIS2        wsvis2
     c     *like         define    C2VIS3        wsvis3
      *
     c     *like         define    c2fnØk        wsfnØk
     c     *like         define    c2fmet        wsfmet
     c     *like         define    c2rper        wsrper
     c     *like         define    c2tbel        wstbel
     c     *like         define    c2cmd1        wscmd1
     c     *like         define    c2cmd2        wscmd2
     c     *like         define    c2cmd3        wscmd3
     c     *like         define    c2cmd4        wscmd4
      *
     c     *like         define    sbvers        w_type
      *
      *
      *  Key for file : Fordelingsnøkler
      *
     c     ra13l1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    ra13l1_mkod
6.10  *
6.10  * Key for oppslag mot lager
6.10  *
6.10 c     ra10l1_key    klist
6.10 c                   kfld                    w_firm
6.10 c                   kfld                    ra10l1_jkod
      *
      * Key for posisjonering på ordretype
      *
     c     votyl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    votyl1_otyp
      *
      * Key for posisjonering på overgruppe
      *
     c     vogrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vogrl1_oogr
      *
      * Key for posisjonering på hovedgruppe
      *
     c     vhgrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vhgrl1_hogr
     c                   kfld                    vhgrl1_hhgr
      *
      * Key for posisjonering på undergruppe
      *
     c     vugrl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vugrl1_uogr
     c                   kfld                    vugrl1_uhgr
     c                   kfld                    vugrl1_uugr
      *
      * Key for posisjonering på kunde
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      * Key for posisjonering på vare
      *
     c     vvarl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    vvarl1_vare
      *
      * Key for oppdatering av KUNDE-AKKUMULERINGS-REGISTER
      *
     c     skakl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_hhaa
     c                   kfld                    w_kode
     c                   kfld                    w_avde
     c                   kfld                    w_lage
     c                   kfld                    w_otyp
     c                   kfld                    w_land
     c                   kfld                    w_dist
     c                   kfld                    w_selg
     c                   kfld                    w_kkat
     c                   kfld                    w_kund
     c                   kfld                    w_ogrp
     c                   kfld                    w_hgrp
     c                   kfld                    w_ugrp
     c                   kfld                    w_vare
      *
      * Key for file nummerisk
      *
     c     key01         klist
     c                   kfld                    w_firm
     c                   kfld                    w_hhaa
     c                   kfld                    w_vers
     c                   kfld                    w_kode
     c                   kfld                    w_aabb
     c                   kfld                    w_avde
     c                   kfld                    w_lage
     c                   kfld                    w_otyp
     c                   kfld                    w_land
     c                   kfld                    w_dist
     c                   kfld                    w_selg
     c                   kfld                    w_kkat
     c                   kfld                    w_kund
     c                   kfld                    w_ogrp
     c                   kfld                    w_hgrp
     c                   kfld                    w_ugrp
     c                   kfld                    w_vare
      *
      * Key for sletting
      *
     c     key02         klist
     c                   kfld                    w_firm
     c                   kfld                    w_hhaa
     c                   kfld                    w_vers
     c                   kfld                    w_kode
     c                   kfld                    w_aabb
     c                   kfld                    w_avde
     c                   kfld                    w_lage
     c                   kfld                    w_otyp
     c                   kfld                    w_land
     c                   kfld                    w_dist
     c                   kfld                    w_selg
     c                   kfld                    w_kkat
     c                   kfld                    w_kund
     c                   kfld                    w_ogrp
     c                   kfld                    w_hgrp
     c                   kfld                    w_ugrp
     c                   kfld                    w_vare
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tar inn parameter fra forrige program                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *ENTRY        PLIST
     c                   parm                    wihhaa            4 0
     c                   parm                    wivers            2
     c                   parm                    wikode           12
     c                   parm                    wiaabb            1
      *
     c                   move      l_firm        w_firm
      *
     c                   move      wihhaa        w_hhaa
     c                   move      wivers        w_vers
     c                   move      wikode        w_kode
     c                   move      wiaabb        w_aabb
      *
     c                   move      wikode        w_kode_nn
      *
      * Legger inn faste tekster
      *
     c                   move      wihhaa        b2hhaa
      *
     c                   move      wivers        b2vers
      *
      * Legge inn kode som viser første sett av kommandotaster
      *
     c                   move      1             wc2cmd
     c                   move      cmd(3)        c2cmd1
     c                   move      cmd(5)        c2cmd2
     c                   move      cmd(6)        c2cmd3
     c                   move      cmd(14)       c2cmd4
      *
      * Legger inn tekster for Antall/Beløp
      *
     c                   move      'BELØP '      b2aabb
     c                   move      'beløp '      c2aabb
      *
     c     wiaabb        ifeq      'A'
     c                   move      'ANTALL'      b2aabb
     c                   move      'antall'      c2aabb
     c                   endif
      *
      * Legge inn kode for saldo/bevegelse
      *
     c                   move      1             w_sabe
      *
      * Legge inn standard valg for kolonner
      *
     c                   move      'B'           v1inh1
     c                   move      'B'           v1inh2
     c                   move      'B'           v1inh3
     c                   move      'B'           v1inh4
     c     b2hhaa        sub       3             v1aar1
     c     b2hhaa        sub       2             v1aar2
     c     b2hhaa        sub       1             v1aar3
     c                   move      b2hhaa        v1aar4
      *
      * Hent tekster fra tabell
      *
     c                   move      *blank        b2txt1
     c                   move      *blank        b2txt2
     c                   move      *blank        b2txt3
      *
     c                   exsr      hntarr
      *
     c                   if        r1 > *zeros
     c                   movel     rpt(r1)       b2txt1
     c                   movel     rpt(r1)       c2txt1
     c                   endif
      *
     c                   if        r2 > *zeros
     c                   movel     rpt(r2)       b2txt2
     c                   movel     rpt(r2)       c2txt2
     c                   endif
      *
     c                   if        r3 > *zeros
     c                   movel     rpt(r3)       b2txt3
     c                   movel     rpt(r3)       c2txt3
     c                   endif
      *
     c                   eval      *in21 = *on
     c                   eval      *in22 = *on
      *
     c     key01         setll     skbul1
      *
     c                   exsr      xcrt01
      *
     c                   endsr
      *
      /eject
      **********************  T A B E L L E R  ***************************
**
  Ny post                  001
  Endring                  002
  Vise                     003
* Slettet *                004
**
Vedlikehold av budsjett    001
   Spørring på saldo       002
                 Budsjett  003
                    Saldo  004
 Salg                      005
 Budsjett                  006
 Alt.                      007
Ledig ...                  008
**
Ledig ...                  001
Ledig ...                  002
F3=Gå tilbake              003
F4=Forespørsel             004
F5=Forrige år              005
F6=Neste år                006
Ledig ...                  007
Ledig ...                  008
F9=Endre kolonne           009
Ledig ...                  010
Ledig ...                  011
Ledig ...                  012
F13=Kol.3 > Kol.4          013
F24=Flere taster           014
**  SORTERINGSREKKEFØLGE
Ledig                      01
Ledig                      02
Ledig                      03
Ledig                      04
Ledig                      05
Ledig                      06
Ledig                      07
Ledig                      08
Ledig                      09
Ledig                      10
Avdeling                   11
Lager                      12
Ordre-type                 13
Ledig                      14
Ledig                      15
Ledig                      16
Ledig                      17
Ledig                      18
Ledig                      19
Ledig                      20
Land                       21
Distrikt                   22
Selger                     23
Kundekategori              24
Kundenummer                25
Ledig                      26
Ledig                      27
Ledig                      28
Ledig                      29
Ledig                      30
Overgruppe                 31
Hovedgruppe                32
Undergruppe                33
Varenummer                 34
Ledig                      35
Ledig                      36
Ledig                      37
Ledig                      38
Ledig                      39
Ledig                      40
Ledig                      41
Ledig                      42
Ledig                      43
Ledig                      44
Ledig                      45
Ledig                      46
Ledig                      47
Ledig                      48
Ledig                      49
Ledig                      50
Ledig                      51
Ledig                      52
Ledig                      53
Ledig                      54
Ledig                      55
Ledig                      56
Ledig                      57
Ledig                      58
Ledig                      59
Ledig                      60
