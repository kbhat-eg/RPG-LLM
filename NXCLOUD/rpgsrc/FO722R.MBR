      /TITLE  ASOFAK: Sjekker om ordre er satt i bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FO722R
      * Beskrivelse . . : Sjekker om ordre er satt i bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       180200 AMD  Nytt program
6.NU  * R6.30 260514 bsa  Programmet gjennomgått mtp nummerutvidelser.
8.01  *PRG2   210622 bof  Utvidet prisgruppe fra 1 til 2 posisjoner
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     ffodtl1    if   e           k disk    rename(fodtpfr:fodtl1r)
      *
      * Definering av parametere
      *
     d p_plor          s              1
     d p_firm          s              3  0
     d p_numm          s                   like(fdnumm)
     d p_suff          s                   like(fdsuff)
      *
      * Definering av variabler i nøkler
      *
     d fodtl1_numm     s                   like(fdnumm)
     d fodtl1_suff     s                   like(fdsuff)
     d fodtl1_line     s                   like(fdline)
      *
      * Definering av variable
      *
     d w_firm          s              3  0
     d w_test          s              1  0
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Leser ordrelinjer for å finne om linjer er satt i bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Sjekk om det er linjer som ikke er bestilt
      *
     c                   exsr      sjekk_lin
      *
      * Det er ingen flere linjer som kan bestilles
      *
     c                   if        w_test = 0
     c                   eval      p_plor = '8'
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekker om det er linjer som ikke er satt i bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     sjekk_lin     begsr
      *
      * Leser poster fra Ordre-linje-register
      *
     c                   eval      w_test = *zero
     c     fodtl1_ke2    setll     fodtl1r
     c     fodtl1_ke2    reade     fodtl1r                                90
      *
     c                   dow       *in90 = *off
      *
      * Er linje allerede bestillt ?
      *
     c                   if        fdantb <> 0
     c                   goto      next01_les
     c                   endif
      *
     c                   if        fdanta <> 0
     c                   eval      w_test =1
     c                   endif
      *
      * Les neste post
      *
     c     next01_les    tag
     c     fodtl1_ke2    reade     fodtl1r                                90
     c                   enddo
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Nullstilling av felter som ikke kan redefineres
      *
     c                   eval      p_plor = *blank
      *
      * Key for file : Ordre-linje-register les 2
      *
     c     fodtl1_ke2    klist
     c                   kfld                    w_firm
     c                   kfld                    fodtl1_numm
     c                   kfld                    fodtl1_suff
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_plor
     c                   parm                    p_firm
6.NU c                   parm                    p_numm
     c                   parm                    p_suff
      *
      * Legger inn firmanummer
      *
     c                   eval      w_firm = p_firm
      *
      * Legger inn ordrenummer og suffix i nøkklene
      *
     c                   eval      fodtl1_numm = p_numm
     c                   eval      fodtl1_suff = p_suff
     c                   eval      fodtl1_line = *zero
      *
     c                   endsr
