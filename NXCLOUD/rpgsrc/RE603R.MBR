     h/TITLE  Saldooverføring
     h datedit(*dmy)
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      * System. . . . . : ASOKON                                              *
      * Program . . . . : RE603R                                              *
      * Beskrivelse . . : Saldo/budsjett til Trioplan                         *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Spesialversjon. :                                                     *
      * Tilpasset for . :                                                     *
      *                                                                       *
      * Referanse  Dato   Endringsbeskrivelse                            Sign *
      * --------- ------  ---------------------------------------------- ---- *
T5.00 * R5.00     161003  Tekst ved avd. 0 mangler, skrives ikke.        HFL
      *                                                                       *
      * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
      *
     frhsal1    ipe  e           k disk    rename(rhsapfr:rhsal1r)
     fre01pf    o  a e             disk
      *
     d sal             s             15  2 dim(14)                              Saldo
     d saÅ             s             15  2 dim(14)                              Saldo i år
     d saf             s             15  2 dim(14)                              Saldo i fjor
     d sab             s             15  2 dim(14)                              Saldo budsjett
      *
     d                uds
     d pfirm                 300    302  0                                      Firma
     d pnavn                         30                                         Navn
     d puser                         10                                         BruerI
     d pdato                          6  0                                      Pr. da
     d praar                          4  0                                      Pr. år
     d pperf                          2  0                                      Period
     d ppert                          2  0                                      Period
     d pavdf                          4  0                                      Avd. f
     d pavdt                          4  0                                      Avd. t
     d prapp                          2  0                                      Rappor
     d psumm                          1                                         Avd.su
     d psums                          1                                         Avd.su
      *
     d l_user                911    920
     d l_firm                944    946  0
     d l_navn                951    980
      *
     d p_stat          s              1
     d p_kont          s                   like(rikont)
     d p_spes          s                   like(rispes)
     d p_avde          s                   like(riavde)
     d p_text          s             30
     d p_gkod          s                   like(riavde)
     d p_gtxt          s             20
      *
     d w_raar          s                   like(riraar)
     d w_firm          s                   like(rifirm)
      *
      *  Saldo-register - Kontonr.rekkefølge
      *
     irhsal1r
      *
T5.01i                                          rifirm        l6
     i                                          rikont        l4
     i                                          riavde        l2
      *
     i              risa01                      sal(01)
     i              risa02                      sal(02)
     i              risa03                      sal(03)
     i              risa04                      sal(04)
     i              risa05                      sal(05)
     i              risa06                      sal(06)
     i              risa07                      sal(07)
     i              risa08                      sal(08)
     i              risa09                      sal(09)
     i              risa10                      sal(10)
     i              risa11                      sal(11)
     i              risa12                      sal(12)
     i              risa13                      sal(13)
     i              risa00                      sal(14)
      *
     c/eject
     c     a2tagb        tag
      *
      * Kontroll av firma
      *
     c     les           tag
      *
T501 c                   if        *inl6 = *on
T501 c                   eval      *in50 = *on
B001 c                   if        rifirm <> l_firm
T501 c                   eval      *in50 = *off
E001 c                   endif
T501 c                   endif
T501 c                   if        *in50 = *off
 001 c                   goto      slutt
E001 c                   endif
      *
      * Brudd på konto
      *
B001 c                   if        *inl4 = *on
 001 c                   eval      p_kont = rikont
 001 c                   eval      p_spes = rispes
 001 c                   eval      p_avde = riavde
B001  *
 001 c                   call      'RS740R'                                      kontoplan-
     c                   parm                    p_stat
     c                   parm                    p_kont
     c                   parm                    p_spes
     c                   parm                    p_avde
     c                   parm                    p_text
B001  *
 001 c                   move      p_text        rhtext
E001 c                   endif
      *
      * Brudd på avdeling
      *
B001 c                   if        *inl2 = *on
      *
 001 c                   eval      saÅ = 0
 001 c                   eval      saf = 0
 001 c                   eval      sab = 0
      *
 001 c                   eval      p_gkod  = riavde
E001  *
 001 c                   call      'RS707R'                                      avdelings-
     c                   parm                    p_stat
     c                   parm                    p_gkod
     c                   parm                    p_gtxt
B001  *
T5.00c                   if        p_stat = 'N' and                                      .....
T5.00c                             p_gkod = *zero                                        .....
T5.00c                   eval      ragtxt = *blank                                           .
T5.00c                   else                                                            .....
 001 c                   eval      ragtxt = p_gtxt                               finnes
T5.00c                   endif                                                           .....
E001 c                   endif
      *
      * Kontroll av regnskapsår
      *
B001 c                   if        riraar > praar or
B001 c                             riraar < w_raar
 001 c                   goto      slutt
E001 c                   endif
      *
      * Saldo i år
      *
B001 c                   if        ritype = 1
B002 c                   if        riraar = praar
 002 c                   add       sal           saÅ
E002 c                   endif
E001 c                   endif
      *
      * Saldo i fjor
      *
B001 c                   if        ritype = 1
B002 c                   if        riraar = w_raar
 002 c                   add       sal           saf
E002 c                   endif
E001 c                   endif
      *
      * Budsjett i år
      *
B001 c                   if        ritype = 3
B002 c                   if        riraar = praar
 002 c                   add       sal           sab
E002 c                   endif
E001 c                   endif
      *
     c     slutt         tag
      *
     cl2                 move      saÅ(14)       risa00
     cl2                 move      saÅ(1)        risa01
     cl2                 move      saÅ(2)        risa02
     cl2                 move      saÅ(3)        risa03
     cl2                 move      saÅ(4)        risa04
     cl2                 move      saÅ(5)        risa05
     cl2                 move      saÅ(6)        risa06
     cl2                 move      saÅ(7)        risa07
     cl2                 move      saÅ(8)        risa08
     cl2                 move      saÅ(9)        risa09
     cl2                 move      saÅ(10)       risa10
     cl2                 move      saÅ(11)       risa11
     cl2                 move      saÅ(12)       risa12
     cl2                 add       saÅ(13)       risa12
      *
     cl2                 move      saf(1)        rqsa01
     cl2                 move      saf(2)        rqsa02
     cl2                 move      saf(3)        rqsa03
     cl2                 move      saf(4)        rqsa04
     cl2                 move      saf(5)        rqsa05
     cl2                 move      saf(6)        rqsa06
     cl2                 move      saf(7)        rqsa07
     cl2                 move      saf(8)        rqsa08
     cl2                 move      saf(9)        rqsa09
     cl2                 move      saf(10)       rqsa10
     cl2                 move      saf(11)       rqsa11
     cl2                 move      saf(12)       rqsa12
     cl2                 add       saf(13)       rqsa12
      *
     cl2                 move      sab(1)        rr9s01
     cl2                 move      sab(2)        rr9s02
     cl2                 move      sab(3)        rr9s03
     cl2                 move      sab(4)        rr9s04
     cl2                 move      sab(5)        rr9s05
     cl2                 move      sab(6)        rr9s06
     cl2                 move      sab(7)        rr9s07
     cl2                 move      sab(8)        rr9s08
     cl2                 move      sab(9)        rr9s09
     cl2                 move      sab(10)       rr9s10
     cl2                 move      sab(11)       rr9s11
     cl2                 move      sab(12)       rr9s12
     cl2                 add       sab(13)       rr9s12
      *
E501 cl2 50              write     re01pfr                                       SKRIV POST
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
     c     *inzsr        begsr
      *
     c                   eval      w_raar = praar - 1
      *
     c                   eval      w_firm = l_firm
      *
      *
     c                   endsr
