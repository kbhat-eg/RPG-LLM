      /title  Utskrift fra budsjett-register
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASSTAT
      * Program . . . . : SB611R
      * Beskrivelse . . : Utskrift fra budsjett-register
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fskbul1    if   e           k disk    rename(skbupfr:skbul1r)
     fsb611p    o    e             printer
      *
      *
      * Definering av parameter (inn)
      *
     d                 ds
     d wsparm                        64
     d  wsfirm                        3  0 overlay(wsparm:01)
     d  wshhaa                        4  0 overlay(wsparm:04)
     d  wsvers                        2    overlay(wsparm:08)
     d  wsakod                       12    overlay(wsparm:10)
     d  wsaabb                        1    overlay(wsparm:22)
     d  wskode                       12    overlay(wsparm:23)
      *
      * Redefinering av variable
      *
     d                 ds
     d umtid                         12  0
     d  h1date                        6  0 overlay(umtid:7)
      *
      * Omdefinering av kode
      *
     d wxkode          ds            12
     d wxkode_11                      1  0
     d wxkode_12                      1  0
     d wxkode_13                      1  0
     d wxkode_21                      1  0
     d wxkode_22                      1  0
     d wxkode_23                      1  0
     d wxkode_24                      1  0
     d wxkode_25                      1  0
     d wxkode_31                      1  0
     d wxkode_32                      1  0
     d wxkode_33                      1  0
     d wxkode_34                      1  0
      *
      * Definering av LocalDataArea
      *
     d                uds
     d lcwsid                901    910
     d lcuser                        10
     d lcnavn                951    980
      *
      * Definering av variable i nøkler
      *
     d w_hhaa          s                   like(sbhhaa)
     d w_vers          s                   like(sbvers)
     d w_kode          s                   like(sbkode)
     d w_aabb          s                   like(sbaabb)
      *
     d skbul1_avde     s                   like(sbavde)
     d skbul1_lage     s                   like(sblage)
     d skbul1_otyp     s                   like(sbotyp)
     d skbul1_land     s                   like(sbland)
     d skbul1_dist     s                   like(sbdist)
     d skbul1_selg     s                   like(sbselg)
     d skbul1_kkat     s                   like(sbkkat)
     d skbul1_kund     s                   like(sbkund)
     d skbul1_ogrp     s                   like(sbogrp)
     d skbul1_hgrp     s                   like(sbhgrp)
     d skbul1_ugrp     s                   like(sbugrp)
     d skbul1_vare     s                   like(sbvare)
      *
      * Definering av variable
      *
     d w_firm          s                   like(sbfirm)
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XINIT  Initisiering av utskriften                               *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c                   eval      w_firm      = wsfirm
     c                   eval      w_hhaa      = wshhaa
     c                   eval      w_vers      = wsvers
     c                   eval      w_kode      = wskode
     c                   eval      w_aabb      = wsaabb
     c                   eval      skbul1_avde = *zero
     c                   eval      skbul1_lage = *zero
     c                   eval      skbul1_otyp = *blank
     c                   eval      skbul1_land = *blank
     c                   eval      skbul1_dist = *zero
     c                   eval      skbul1_selg = *zero
     c                   eval      skbul1_kkat = *zero
     c                   eval      skbul1_kund = *zero
     c                   eval      skbul1_ogrp = *zero
     c                   eval      skbul1_hgrp = *zero
     c                   eval      skbul1_ugrp = *zero
     c                   eval      skbul1_vare = *blank
     c     skbul1_key    setll     skbul1
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * XSTART Behandle linjer                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     xstart        tag
     c                   read      skbul1                                 10
     c     *in10         cabeq     *on           xslutt
      *
      * Sjekk, Hopp ut dersom ikke riktig
      *
     c     sbfirm        cabne     w_firm        xslutt
     c     sbhhaa        cabne     w_hhaa        xslutt
     c     sbvers        cabne     w_vers        xslutt
     c     sbkode        cabne     w_kode        xslutt
     c     sbaabb        cabne     w_aabb        xslutt
      *
     c                   exsr      budsjett
      *
     c                   z-add     sbbu01        l1bu01
     c                   z-add     sbbu02        l1bu02
     c                   z-add     sbbu03        l1bu03
     c                   z-add     sbbu04        l1bu04
     c                   z-add     sbbu05        l1bu05
     c                   z-add     sbbu06        l1bu06
     c                   z-add     sbbu07        l1bu07
     c                   z-add     sbbu08        l1bu08
     c                   z-add     sbbu09        l1bu09
     c                   z-add     sbbu10        l1bu10
     c                   z-add     sbbu11        l1bu11
     c                   z-add     sbbu12        l1bu12
      *
     c                   write     l1line                               30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
      * Returner til nytt les
      *
     c                   goto      xstart
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
      *
     c                   return
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for handtering av overflow                            *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     csr   overflow      begsr
      *
      * Skriv heading på
      * kvitteringsliste
      *
     c                   write     H1HODE
      *
     csr                 endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Henter budsjett-begrep                                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     budsjett      begsr
      *
      * (11-52) (Avdeling)
      *
     c   41              move      sbavde        l1beg1
     c   61              move      sbavde        l1beg2
     c   81              move      sbavde        l1beg3
      *
      * (12-53) (Lager)
      *
     c   42              move      sblage        l1beg1
     c   62              move      sblage        l1beg2
     c   82              move      sblage        l1beg3
      *
      * (13-51) (Ordretype)
      *
     c   43              move      sbotyp        l1beg1
     c   63              move      sbotyp        l1beg2
     c   83              move      sbotyp        l1beg3
      *
      * (21-25) (Land)
      *
     c   44              move      sbland        l1beg1
     c   64              move      sbland        l1beg2
     c   84              move      sbland        l1beg3
      *
      * (22-23) (Distrikt)
      *
     c   45              move      sbdist        l1beg1
     c   65              move      sbdist        l1beg2
     c   85              move      sbdist        l1beg3
      *
      * (23-24) (Selger)
      *
     c   46              move      sbselg        l1beg1
     c   66              move      sbselg        l1beg2
     c   86              move      sbselg        l1beg3
      *
      * (24-21) (Kundekategori)
      *
     c   47              move      sbkkat        l1beg1
     c   67              move      sbkkat        l1beg2
     c   87              move      sbkkat        l1beg3
      *
      * (25-32) (Kundenummer)
      *
     c   48              move      sbkund        l1beg1
     c   68              move      sbkund        l1beg2
     c   88              move      sbkund        l1beg3
      *
      * (31-14) (Overgruppe)
      *
     c   49              move      sbogrp        l1beg1
     c   69              move      sbogrp        l1beg2
     c   89              move      sbogrp        l1beg3
      *
      * (32-15) (Hovedgruppe)
      *
     c   50              move      sbhgrp        l1beg1
     c   70              move      sbhgrp        l1beg2
     c   90              move      sbhgrp        l1beg3
      *
      * (33-16) (Undergruppe)
      *
     c   51              move      sbugrp        l1beg1
     c   71              move      sbugrp        l1beg2
     c   91              move      sbugrp        l1beg3
      *
      * (34-31) (Varenummer)
      *
     c   52              move      sbvare        l1beg1
     c   72              move      sbvare        l1beg2
     c   92              move      sbvare        l1beg3
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Beregner indaktor for budsjett-begrep                           *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     binit         begsr
      *
      * (11-52) (Avdeling)
      *
     c     wxkode_11     ifeq      1
     c                   move      *on           *in41
     c                   movel     'Avdeling'    H1beg1
     c                   endif
     c     wxkode_11     ifeq      2
     c                   move      *on           *in61
     c                   movel     'Avdeling'    H1beg2
     c                   endif
     c     wxkode_11     ifeq      3
     c                   move      *on           *in81
     c                   movel     'Avdeling'    H1beg3
     c                   endif
      *
      * (12-53) (Lager)
      *
     c     wxkode_12     ifeq      1
     c                   move      *on           *in42
     c                   movel     'Lager'       H1beg1
     c                   endif
     c     wxkode_12     ifeq      2
     c                   move      *on           *in62
     c                   movel     'Lager'       H1beg2
     c                   endif
     c     wxkode_12     ifeq      3
     c                   move      *on           *in82
     c                   movel     'Lager'       H1beg3
     c                   endif
      *
      * (13-51) (Ordretype)
      *
     c     wxkode_13     ifeq      1
     c                   move      *on           *in43
     c                   movel     'Ordretype'   H1beg1
     c                   endif
     c     wxkode_13     ifeq      2
     c                   move      *on           *in63
     c                   movel     'Ordretype'   H1beg2
     c                   endif
     c     wxkode_13     ifeq      3
     c                   move      *on           *in83
     c                   movel     'Ordretype'   H1beg3
     c                   endif
      *
      * (21-25) (Land)
      *
     c     wxkode_21     ifeq      1
     c                   move      *on           *in44
     c                   movel     'Land'        H1beg1
     c                   endif
     c     wxkode_21     ifeq      2
     c                   move      *on           *in64
     c                   movel     'Land'        H1beg2
     c                   endif
     c     wxkode_21     ifeq      3
     c                   move      *on           *in84
     c                   movel     'Land'        H1beg3
     c                   endif
      *
      * (22-23) (Distrikt)
      *
     c     wxkode_22     ifeq      1
     c                   move      *on           *in45
     c                   movel     'Distrikt'    H1beg1
     c                   endif
     c     wxkode_22     ifeq      2
     c                   move      *on           *in65
     c                   movel     'Distrikt'    H1beg2
     c                   endif
     c     wxkode_22     ifeq      3
     c                   move      *on           *in85
     c                   movel     'Distrikt'    H1beg3
     c                   endif
      *
      * (23-24) (Selger)
      *
     c     wxkode_23     ifeq      1
     c                   move      *on           *in46
     c                   movel     'Selger'      H1beg1
     c                   endif
     c     wxkode_23     ifeq      2
     c                   move      *on           *in66
     c                   movel     'Selger'      H1beg2
     c                   endif
     c     wxkode_23     ifeq      3
     c                   move      *on           *in86
     c                   movel     'Selger'      H1beg3
     c                   endif
      *
      * (24-21) (Kundekategori)
      *
     c     wxkode_24     ifeq      1
     c                   move      *on           *in47
     c                   movel     'Kundekategor'H1beg1
     c                   endif
     c     wxkode_24     ifeq      2
     c                   move      *on           *in67
     c                   movel     'Kundekategor'H1beg2
     c                   endif
     c     wxkode_24     ifeq      3
     c                   move      *on           *in87
     c                   movel     'Kundekategor'H1beg3
     c                   endif
      *
      * (25-32) (Kundenummer)
      *
     c     wxkode_25     ifeq      1
     c                   move      *on           *in48
     c                   movel     'Kundenummer' H1beg1
     c                   endif
     c     wxkode_25     ifeq      2
     c                   move      *on           *in68
     c                   movel     'Kundenummer' H1beg2
     c                   endif
     c     wxkode_25     ifeq      3
     c                   move      *on           *in88
     c                   movel     'Kundenummer' H1beg3
     c                   endif
      *
      * (31-14) (Overgruppe)
      *
     c     wxkode_31     ifeq      1
     c                   move      *on           *in49
     c                   movel     'Overgruppe'  H1beg1
     c                   endif
     c     wxkode_31     ifeq      2
     c                   move      *on           *in69
     c                   movel     'Overgruppe'  H1beg2
     c                   endif
     c     wxkode_31     ifeq      3
     c                   move      *on           *in89
     c                   movel     'Overgruppe'  H1beg3
     c                   endif
      *
      * (32-15) (Hovedgruppe)
      *
     c     wxkode_32     ifeq      1
     c                   move      *on           *in50
     c                   movel     'Hovedgruppe' H1beg1
     c                   endif
     c     wxkode_32     ifeq      2
     c                   move      *on           *in70
     c                   movel     'Hovedgruppe' H1beg2
     c                   endif
     c     wxkode_32     ifeq      3
     c                   move      *on           *in90
     c                   movel     'Hovedgruppe' H1beg3
     c                   endif
      *
      * (33-16) (Undergruppe)
      *
     c     wxkode_33     ifeq      1
     c                   move      *on           *in51
     c                   movel     'Undergruppe' H1beg1
     c                   endif
     c     wxkode_33     ifeq      2
     c                   move      *on           *in71
     c                   movel     'Undergruppe' H1beg2
     c                   endif
     c     wxkode_33     ifeq      3
     c                   move      *on           *in91
     c                   movel     'Undergruppe' H1beg3
     c                   endif
      *
      * (34-31) (Varenummer)
      *
     c     wxkode_34     ifeq      1
     c                   move      *on           *in52
     c                   movel     'Varenummer'  H1beg1
     c                   endif
     c     wxkode_34     ifeq      2
     c                   move      *on           *in72
     c                   movel     'Varenummer'  H1beg2
     c                   endif
     c     wxkode_34     ifeq      3
     c                   move      *on           *in92
     c                   movel     'Varenummer'  H1beg3
     c                   endif
      *
     c                   endsr
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      * Subrutine for initiering av program                             *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     csr   *inzsr        begsr
      *
      * Key for oppdatering av lager-register
      *
     c     skbul1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    w_hhaa
     c                   kfld                    w_vers
     c                   kfld                    w_kode
     c                   kfld                    w_aabb
     c                   kfld                    skbul1_avde
     c                   kfld                    skbul1_lage
     c                   kfld                    skbul1_otyp
     c                   kfld                    skbul1_land
     c                   kfld                    skbul1_dist
     c                   kfld                    skbul1_selg
     c                   kfld                    skbul1_kkat
     c                   kfld                    skbul1_kund
     c                   kfld                    skbul1_ogrp
     c                   kfld                    skbul1_hgrp
     c                   kfld                    skbul1_ugrp
     c                   kfld                    skbul1_vare
      *
      /eject
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *  Tar inn parameter fra forrige program                          *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
      *
      *
     c     *entry        plist
     c                   parm                    dsparm           64
     c                   move      dsparm        wsparm
      *
     c                   time                    umtid
      *
     c                   move      wshhaa        h1hhaa
     c                   move      wskode        h1kode
      *
      *  Hent verdier for begrep + sett på indiaktorer
      *
     c                   move      wskode        wxkode
     c                   exsr      binit
      *
      * Skriv heading på
      * kvitteringsliste
      *
     c                   write     H1HODE                               30
     c                   if        *in30 = *on
     c                   exsr      overflow
     c                   endif
      *
     csr                 endsr
