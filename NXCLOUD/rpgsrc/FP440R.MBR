      /TITLE  ASOFAK Utskrift av etiketter til kunder
     h datedit(*dmy) option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     *                                                                       *
     * System. . . . . : ASOFAK                                              *
     * Program . . . . : FP440R                                              *
     * Beskrivelse . . : Etiketter kunder                                    *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *                                                                       *
     * Spesialversjon. :                                                     *
     * Tilpasset for . :                                                     *
     *                                                                       *
     * Ref.   Dato  Sign Endringsbeskrivelse                               n *
     * ----- ------ ---- ------------------------------------------------- --*
     *                                                                       *
     *                                                                       *
     *                                                                       *
     * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
     *
     Ffp440d    cf   e             workstn
     Fvfaspf    uf a e           k disk
     fetikett   o    f  132        Printer oflind(*inof)
     *
     D                uds
     D lctype                891    891  0
     D lcuser                911    920
     d lcfirm                944    946  0
     d l_fnav                951    980
     *
     d w_firm          s                   like(vnfirm)
     d w_kund          s              6  0
     d w_navn          s             30
     d w_navn_ut       s             20
     *
     d w_retk          s              1
     d w_dumy          s              1
     d w_anta          s              4  0
     d w_dato          s              6  0
     d w_in03          s              1
     d w_in12          s              1
      *
      * Definering av variable
      *
     d w_skty          s                   like(lctype)
      *
     d w_anta_1        s              1  0
     d w_anta_2        s              2  0
     d w_anta_3        s              3  0
     *
     C     a1tag         tag
     *
     * Hent fast tekst
     *
     C     faskey        chain     vfaspf                             60
     *
B001 C                   if        *in60 = *on
 001 C                   eval      a1fas1 = *blank
 001 C                   eval      a1fas2 = *blank
 001 C                   eval      a1fas3 = *blank
 001 C                   eval      a1fas4 = *blank
 001 C                   eval      a1vtxt = *blank
E001 C                   else
 001 C                   move      vnfas1        a1fas1
 001 C                   move      vnfas2        a1fas2
 001 C                   move      vnfas3        a1fas3
 001 C                   move      vnfas4        a1fas4
 001 C                   move      vnvtxt        a1vtxt
E001 C                   endif
     *
 001 C                   eval      w_skty = 4
 001 C                   eval      w_anta = 1
     c                   eval      w_in03 = ' '
     *
     C     a1taga        tag
     *
     C                   exfmt     a1bld
     *
     c                   select
     *
B001 C                   when      *inkc = *on
     c                   eval      w_in03 = '1'
 001 C                   goto      slutt
     *
B001 C                   when      *inkl = *on
     c                   eval      w_in12 = '1'
 001 C                   goto      slutt
     *
B001 C                   when      *inkd = *on
 001 C                   call      'RK500R'
     c                   parm                    w_firm
     c                   parm                    w_kund
     c                   parm                    w_navn
     *
     c                   eval      a1kund = w_kund
     c                   eval      a1navn = w_navn
      *
B001 C                   when      *inke = *on
     c                   movel     w_navn        w_navn_ut
 001 C                   exsr      skriv_etik
     c                   eval      a1kund = *zeros
     c                   eval      a1navn = *blank
     *
B001 C                   other
     *
B001 C                   if        a1kund <> *zeros
     c                   eval      w_kund = a1kund
 001 C                   call      'RS750R'
     c                   parm                    w_retk
     c                   parm                    w_kund
     c                   parm                    w_navn
     *
     c                   eval      a1navn = w_navn
E001 C                   endif
     *
E001 C                   endsl
     *
 001 C                   goto      a1taga
     *
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *  END OF JOB                                                     +
     *++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     *
     *
     C     slutt         tag
      *
      * Skrivertype Meto Bandit
      *
     C     w_skty        ifeq      2
     c                   except    Æend2
     C                   endif
     *
     C                   eval      *inlr = *on
     c                   return
     *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for utskrift av etiketter                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     skriv_etik    begsr
     *
      *
      * Skrivertype Meto 8100 Twinax
      *
     C     w_skty        ifeq      0
     c                   except    Æpgm0
     C                   endif
      *
      * Skrivertype Meto 8100 Standard
      *
     C     w_skty        ifeq      1
     c                   except    Æpgm1
     C                   endif
      *
      * Skrivertype Meto 8100 Twinax
      *
     C     w_skty        ifeq      0
     c                   except    Ædata0
     C                   endif
      *
      * Skrivertype Meto 8100 Standard
      *
     C     w_skty        ifeq      1
     c                   except    Ædata1
     C                   endif
      *
      * Skrivertype Meto Bandit
      *
     C     w_skty        ifeq      2
      *
     c                   eval      *in81 = *off
     c                   eval      *in82 = *off
     c                   eval      *in83 = *off
      *
     c                   select
     c                   when      w_anta <= 9
     c                   eval      w_anta_1 = 1
     c                   eval      *in81 = *on
     c                   endsl
      *
     c                   except    Ædata2
     C                   endif
      *
      * Skrivertype Eltron
      *
     c     w_skty        ifeq      3
     c                   except    Æpgm3
      *
     c                   except    Ædata3
     c                   endif
      *
      * Skrivertype Meto mi-4
      *
     c     w_skty        ifeq      4
     c                   except    Ædata4
     c                   endif
     *
     C                   endsr
      *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     * Subrutine for initiering av program                             *
     * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *
     *
     C     *inzsr        begsr
     *
     c     entry         plist
     c                   parm                    w_in03
     c                   parm                    w_in12
      *
     C                   move      lcfirm        w_firm
     C                   eval      w_kund = *zeros
     C                   move      *date         w_dato
      *
      * Skrivertype Meto Bandit
      *
     C     w_skty        ifeq      2
     c                   except    Æpgm2
     C                   endif
     *
     * Key for faste data etiketter
     *
     C     faskey        klist
     C                   kfld                    w_firm
     *
     C                   endsr
      *
      * Twinax-skriver
      *                                                                ***
     Oetikett   e            Æpgm0
      *                                                                ***
      * Halo printer here am I, are you ready?
     o                                              '&02&20&03'
      *
      * Clear LLU 000005
      *
     O          e            Æpgm0
     o                                              '&02&53000005&03'
      *
      * Clear PGM-buffer 05
      *
     O          e            Æpgm0
     o                                              '&02&5405&03'
      *
      * Write program
      *
     O          e            Æpgm0
     o                                              '&02&4405062'
     o                                              '&04'
      *
      * Fast tekst
      *
     O          e            Æpgm0
     o                                              '&02'
     O                                              '&0D005022015012322'
     o                                              '&04'
      *
      * "Bar-code" (EAN-nr.)
      *
     o          e            Æpgm0
     o                                              '&02'
     o                                              '&0D006013000008021R100'
     o                                              '&04'
      *
      * Eget varenr.
      *
     O          e            Æpgm0
     o                                              '&02'
     O                                              '&0D012011008006122'
     o                                              '&04'
      *
      * Pris1
      *
     O          e            Æpgm0
     o                                              '&02'
     O                                              '&0D008003010018522'
     o                                              '&04'
      *
      * Dato
      *
     O          e            Æpgm0
     o                                              '&02'
     O                                              '&0D002006008006112'
     o                                              '&04'
      *
      * Dummy
      *
     O          e            Æpgm0
     o                                              '&02'
     O                                              '&0D001001001006112'
     o                                              '&04'
      *
      *
      *
     O          e            Æpgm0
     o                                              '&02'
     o                                              '&0D'
     o                                              '&0D'
     o                                              '&0D'
     o                                              '&0D'
     o                                              '&0D'
     o                                              '&0D'
     o                                              '&0D'
     o                                              '&03'
      *
      * Write data to  LLU-000005
      *
     O          e            Ædata0
     o                                              '&02&4300000605&0D'
     o                                              '&04'
      *
      * Fast tekst
      *
     O          e            Ædata0
     o                                              '&02'
     O                       a1vtxt
     o                                              '&0D'
     o                                              '&04'
      *
      * EAN-nr.
      *
     O          e            Ædata0
     o                                              '&02'
     O                       w_kund
     o                                              '&0D'
     o                                              '&04'
      *
      * Eget varenr.
      *
     O          e            Ædata0
     o                                              '&02'
     O                       w_kund
     o                                              '&0D'
     o                                              '&04'
      *
      * Pris
      *
     O          e            Ædata0
     o                                              '&02'
     O                       w_navn
     o                                              '&0D'
     o                                              '&04'
      *
      * Dato
      *
     O          e            Ædata0
     o                                              '&02'
     O                       w_dato
     o                                              '&0D'
     o                                              '&04'
      *
      * Dummy
      *
     O          e            Ædata0
     o                                              '&02'
     O                       w_dumy
     o                                              '&0D'
     o                                              '&04'
      *
     O          e            Ædata0
     o                                              '&02'
     o                                              '&0D'
     o                                              '&03'
      *
      * Write data to label
      *
     O          e            Ædata0
     o                                              '&02&66'
     O                       w_anta
     o                                              '&03'
      *
      * Standard-skriver
      *                                                                ***
     OEtikett   e            Æpgm1
      *                                                                ***
      * Halo printer here am I, are you ready?
     O                                              '{ & } '
      *
      * Clear LLU 000005
      *
     O          e            Æpgm1
     O                                              '{&S000005} '
      *
      * Clear PGM-buffer 05
      *
     O          e            Æpgm1
     O                                              '{&T05} '
      *
      * Write program
      *
     O          e            Æpgm1
     O                                              '{&D05062'
     O                                              '!  '
      *
      * Fast tekst
      *
     O          e            Æpgm1
     O                                              '{'
     O                                              '\005022015012322'
     O                                              '! '
      *
      * "Bar-code" (EAN-nr.)
      *
     o          e            Æpgm1
     O                                              '{'
     O                                              '\006013000008021R100'
     O                                              '! '
      *
      * Eget varenr.
      *
     O          e            Æpgm1
     O                                              '{'
     O                                              '\012011008006122'
     O                                              '! '
      *
      * Pris1
      *
     O          e            Æpgm1
     O                                              '{'
     O                                              '\008003010018522'
     O                                              '! '
      *
      * Dato
      *
     O          e            Æpgm1
     O                                              '{'
     O                                              '\002006008006112'
     O                                              '! '
      *
      * Dummy
      *
     O          e            Æpgm1
     O                                              '{'
     O                                              '\001001001006112'
     O                                              '! '
      *
      * Avslutt
      *
     O          e            Æpgm1
     O                                              '{\\\\\\\}'
      *
      * Write data to  LLU-000005
      *
     O          e            Ædata1
     O                                              '{&C00000605\ '
     O                                              '! '
      *
      * Fast tekst
      *
     O          e            Ædata1
     O                                              '{'
     O                       a1vtxt
     O                                              '\'
     O                                              '!'
      *
      * EAN-nr.
      *
     O          e            Ædata1
     O                                              '{'
     O                       w_kund
     O                                              '\'
     O                                              '!'
      *
      * Eget varenr.
      *
     O          e            Ædata1
     O                                              '{'
     O                       w_kund
     O                                              '\'
     O                                              '!'
      *
      * Pris
      *
     O          e            Ædata1
     O                                              '{'
     O                       w_navn
     O                                              '\'
     O                                              '!'
      *
      * Dato
      *
     O          e            Ædata1
     O                                              '{'
     O                       w_dato
     O                                              '\'
     O                                              '!'
      *
      * Dummy
      *
     O          e            Ædata1
     O                                              '{'
     O                       w_dumy
     O                                              '\'
     O                                              '!'
      *
      * Avslutt
      *
     O          e            Ædata1
     O                                              '{'
     O                                              '\'
     O                                              '}'
      *
      * Write data to label
      *
     O          e            Ædata1
     O                                              '{&f'
     O                       w_anta
     O                                              '}'
      *
      * Bandit-skriver
      *                                                                ***
     oEtikett   e            Æpgm2
     O                                              '{'
      *
     O          e            Æpgm2
     O                                              '[Ct "0"]'
      *
     O          e            Æpgm2
     O                                              '[N m "m"]'
      *
     O          e            Æpgm2
     O                                              '[M n "swpaper"]'
      *
     O          e            Æpgm2
     O                                              '[M w "40.0:0:0:1"]'
     O          e            Æpgm2
     O                                              '[M l "25.0:0:0:1:direct '
     O                                              'table 100"]'
     O          e            Æpgm2
     O                                              '[M c "0"]'
     O          e            Æpgm2
     O                                              '[M m "0:20:1"]'
     O          e            Æpgm2
     O                                              '[M a "swpaper"]'
     O          e            Æpgm2
     O                                              '[D W "1" "5" "3" '
     O                                              '"swpaper" "0,0:0,0" "\N"'
      *
      * Avslutt innhold
      *
     O          e            Æpgm2
     O                                              '"\N"]'
      *
      * Etiketter
      *                                                                ***
     O          e            Ædata2
     O                                              '[D W "1" "5" "3" '
     O                                              '"swpaper" "0,0:0,0" "\N"'
      *
      * Fast tekst
      *
     O          e            Ædata2
     O                                              '"C" "04.0:22.0:1" "00" '
     O                                              '"4000001:3" "15:0" '
     O                                              '"" "" "1:1:2:1:1" "\N"'
      *
      * "Bar-code" (EAN-nr.)
      *
     O          e            Ædata2
     O                                              '"A" "4.0:12.0:1" "00"  '
     O                                              '"00:-:2" "76" "08" '
     O                                              '"\N"'
      *
      * Eget varenr.
      *
     O          e            Ædata2
     O                                              '"C" "09.0:11.0:1" "00" '
     O                                              '"4000001:1" "08:0" '
     O                                              '"" "" "1:1:2:1:1" "\N"'
      *
      * Pris1
      *
     O          e            Ædata2
     O                                              '"C" "08.0:03.0:1" "00" '
     O                                              '"4000001:5" "8:0" '
     O                                              '"" "" "1:1:2:1:1" "\N"'
      *
      * Dato
      *
     O          e            Ædata2
     O                                              '"C" "05.0:6.0:1" "90" '
     O                                              '"4000001:1" "8:0" '
     O                                              '"" "" "1:1:2:1:1" "\N"'
      *
     O          e            Ædata2
     O                                              '"\N"]'
      *
     O          e            Ædata2
     O                                              '[D w "LLU""1""\N"'
      *
      * Fast tekst
      *
     O          e            Ædata2
     O                                              '"'
     O                       a1vtxt
     O                                              '"'
      *
      * "Bar-code" (EAN-nr.)
      *
     O          e            Ædata2
     O                                              '"'
     O                       w_kund
     O                                              '"'
      *
      * Eget varenr.
      *
     O          e            Ædata2
     O                                              '"'
     O                       w_kund
     O                                              '"'
      *
      * Pris1
      *
     O          e            Ædata2
     O                                              '"'
     O                       w_navn
     O                                              '"'
      *
      * Dato
      *
     O          e            Ædata2
     O                                              '"'
     O                       w_dato
     O                                              '"'
      *
      * Avslutt innhold
      *
     O          e            Ædata2
     O                                              '"\N"]'
      *
      * Antall etiketter
      *
     O          e            Ædata2
     O                                            6 '[P b "'
     O               81      w_anta_1             7
     O               82      w_anta_2             8
     O               83      w_anta_3             9
     O               81                          19 ':1:swpaper"]'
     O               82                          20 ':1:swpaper"]'
     O               83                          21 ':1:swpaper"]'
      *
     O          e            Æend2
     O                                              '}'
      *
      * Behandle Eltron-skriver
      *                                                                ***
     oEtikett   e            Æpgm3
     O                                              'OD'
      *
     O          e            Æpgm3
     O                                              'US'
      *
     O          e            Æpgm3
     O                                              'FK"2"'
      *
     O          e            Æpgm3
     O                                              'FS"2"'
      *
     O          e            Æpgm3
     O                                              'V00,35,N,"Fast tekst"'
      *
      *
     O          e            Æpgm3
     O                                              'V01,08,N,"Dato"'
      *
     O          e            Æpgm3
     O                                              'V02,13,N,"EAN-nr."'
      *
     O          e            Æpgm3
     O                                              'V03,08,N,"Eget varenr."'
      *
     O          e            Æpgm3
     O                                              'V04,08,N,"Pris 1"'
      *
      * Speed Select
      *
     O          e            Æpgm3
     O                                              'S2'
      *
      * Density
      *
     O          e            Æpgm3
     O                                              'D10'
      *
      * Set Label Width (Bredde) 38 mm x 8
      *
     O          e            Æpgm3
     O                                              'q308'
      *
      * Set Form Lengt Black Line Sensor (Lengde P1 97 x 8, 3 x 8)
      *
     O          e            Æpgm3
     O                                              'Q800,B16+10'
      *
      * Print Direction
      *
     O          e            Æpgm3
     O                                              'ZB'
      *
      * Fast tekst
      *
     O          e            Æpgm3
     O                                              'A020,740,3,4,2,1,N,V00'
      *
      * Dato
      *
     O          e            Æpgm3
     O                                              'A090,050,0,4,1,1,N,V01'
      *
      * "Bar-code" (EAN-nr.)
      *
     O          e            Æpgm3
     O                                              'B160,730,3,E30,3,9,80,B,'
     O                                              'V02'
      *
      * Eget varenr.
      *
     O          e            Æpgm3
     O                                              'B160,730,3,2,4,9,80,B,V03'
      *
      * Pris1
      *
     O          e            Æpgm3
     O                                              'A210,250,3,4,3,1,N,V04'
      *
      * Store End
      *
     O          e            Æpgm3
     O                                              'FE'
      *
      * Behandle Eltron-skriver
      *                                                                ***
     oEtikett   e            Ædata3
     O                                              'N'
      *
      * Start data
      *
     O          e            Ædata3
     O                                              'FR"2"'
      *
      * Start innhold
      *
     O          e            Ædata3
     O                                              '?'
      *
      * Fast tekst
      *
     O          e            Ædata3
     O                       a1vtxt
     O                                           50 'X'
      *
      * Dato
      *
     O          e            Ædata3
     O                       w_dato
     O                                           50 'X'
      *
      * "Bar-code" (EAN-nr.)
      *
     O          e            Ædata3
     O                       w_kund
     O                                           50 'X'
      *
      * Eget varenr.
      *
     O          e            Ædata3
     O                       w_kund
     O                                           50 'X'
      *
      * Pris1
      *
     O          e            Ædata3
     O                       w_navn
     O                                           50 'X'
      *
      * Antall etiketter
      *
     O          e            Ædata3
     O                                              'P'
     O                       w_anta
      *
      * Behandle Meto mi-4
      *                                                                ***
     oEtikett   e            Ædata4
     O                                              '~n'
      *
     o          e            Ædata4
     O                                              '~c0000'
      *
     O          e            Ædata4
     O                                              '~e'
      *
     O          e            Ædata4
     O                                              '~M0500'
      *
     O          e            Ædata4
     O                                              '~ySPM'
      *
     O          e            Ædata4
     O                                              '~Kf0040'
      *
     O          e            Ædata4
     O                                              '~L'
      *
     O          e            Ædata4
     O                                              'z'
      *
     O          e            Ædata4
     O                                              'D11'
      *
     O          e            Ædata4
     O                                              'H20'
      *
     O          e            Ædata4
     O                                              'PK'
      *
      * Antall etiketter
      *
     O          e            Ædata4
     O                                              'Q'
     O                       w_anta
      *
      * Fast tekst
      *
     O          e            Ædata4
     O                                           15 '4311A1000750030'
     O                       a1vtxt
      *
      * Dato
      *
     O**        e            Ædata4
     O**                                         15 '4211A1000150025'
     O**                     w_dato
      *
      * "Bar-code" (Kundenr)
      *
     O          e            Ædata4
     O                                           15 '4d6203500350090'
     O                       w_kund
      *
      * Kundenummer.
      *
     O          e            Ædata4
     O                                           15 '4211A1000450105'
     O                       w_kund
      *
      * Navn
      *
     O          e            Ædata4
     O                                           15 '4411A1800010140'
     O                       w_navn_ut
      *
     O          e            Ædata4
     O                                              'E'
      *
