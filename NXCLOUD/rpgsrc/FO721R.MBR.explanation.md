```markdown
# FO721R – Change Order Header Info Type

## 1. Program Purpose
- **System:** ASOFAK  
- **Program:** FO721R  
- **Description:**  
  - Change the info‐type (`foityp`) on an order header if the requested type exists in the lookup file.  
  - Inputs supplied via parameters: order number, suffix, and desired info‐type.

## 2. File Declarations
```rpg
ffohelu  uf   e  k  disk  rename(fohepfr:fohelur)  // Order‐header register
fvinfl1  if   e  k  disk  rename(vinfpfr:vinfl1r)  // Valid info‐types
```
- **`fohelur`**  
  - Update file for order‐header (keyed on firm + order# + suffix).  
- **`vinfl1r`**  
  - Inquiry file of valid info‐types (keyed on firm + info‐type).

## 3. Parameter Definitions
```rpg
d p_numm        s  like(fonumm)  // Order number
d p_suff        s  like(fosuff)  // Suffix
d p_ityp        s  like(foityp)  // New info‐type
```

## 4. Local Data Area & Variables
```rpg
// User and firm from DTAARA:
d l_user                   10
d l_firm       944  946    0

// Key fields for lookups:
d w_firm        s  like(fofirm)
d fohelu_numm   s  like(fonumm)
d fohelu_suff   s  like(fosuff)
d vinfl1_ityp   s  like(vaityp)

// Timestamp holders:
d w_koda        s  like(fokoda)  // current hhmmss
d w_koti        s  like(fokoti)  // current time (low precision)
```

## 5. Main Logic Flow
1. **Get Current Time**  
   ```rpg
   time   w_koda
   time   w_koti
   ```
2. **Check If Info‐Type Exists**  
   - Load `p_ityp` into key field `vinfl1_ityp`  
   - Perform `CHAIN` on `vinfl1_key` (file `vinfl1r`)  
   - If `%FOUND(vinfl1)`, proceed
3. **Update Order Header**  
   - Perform `CHAIN` on `fohelu_key` (file `fohelur`)  
   - If `%FOUND(fohelu)`, then  
     - Set `foityp = p_ityp`  
     - Set update timestamps:  
       ```rpg
       time foedat    // date field in header
       time foetim    // time field in header
       ```
     - Record user: `foeusr = l_user`  
     - `UPDATE fohelur` to commit changes

4. **Exit**  
   ```rpg
   eval *inlr = *on
   return
   ```

## 6. Initialization Subroutine (`*INZSR`)
- **Purpose:**  
  - Read incoming parameters  
  - Build key lists for subsequent `CHAIN` operations
- **Key Lists Defined:**
  ```rpg
  fohelu_key  klist  kfld(w_firm) kfld(fohelu_numm) kfld(fohelu_suff)
  vinfl1_key  klist  kfld(w_firm) kfld(vinfl1_ityp)
  ```
- **Populate Key Fields:**
  ```rpg
  eval w_firm         = l_firm
  eval fohelu_numm    = p_numm
  eval fohelu_suff    = p_suff
  eval vinfl1_ityp    = p_ityp
  ```

---

### Execution Summary
1. **Init:** Load DTAARA values (`l_user`, `l_firm`), parameters, and build file keys.  
2. **Lookup Info‐Type:** Verify it exists in `vinfl1r`.  
3. **Lookup Order Header:** If found, update its info‐type, timestamp, and user, then write back.  
4. **Cleanup:** Set last record indicator (`*INLR = *ON`) and return.  
```