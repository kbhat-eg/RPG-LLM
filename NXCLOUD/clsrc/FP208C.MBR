             PGM       (&LAGR &ALLE)

/* Initiering av parametere                                          */

             DCL        VAR(&LAGR)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&ALLE)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN03)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&PROG)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&MEMBX)    TYPE(*CHAR) LEN(5)
             DCL        VAR(&MEMB)     TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&WMM1)     TYPE(*CHAR) LEN(10) VALUE('VET      ')
             DCL        VAR(&WSID)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&OUTQ)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLDQ)     TYPE(*CHAR) LEN(4)
             DCL        VAR(&AKOPX)    TYPE(*CHAR) LEN(6)
             DCL        VAR(&AKOP)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&TYPEX)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&TYPE)     TYPE(*DEC) LEN(1 0)

             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (901 10)) RTNVAR(&WSID)

             RTVDTAARA  DTAARA(*LDA (864 5))  RTNVAR(&MEMBX)
             CHGVAR     VAR(&MEMB) VALUE(&MEMBX)
             CHGVAR     VAR(%SST(&WMM1 4 5)) VALUE(&MEMB)


/*           Sjekk arbeidsregister                                   */

             CHKOBJ     OBJ(VAW1PF) OBJTYPE(*FILE) MBR(&WMM1)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(VAW1PF) MBR(&WMM1) TEXT('Varer til +
                          etikettutskrift')
             ENDDO

/* Call av utplukksprogram                                           */

             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             CALL       PGM(FP208R) PARM(&LAGR &ALLE)


/* Skriv hylleetiketter    75x28 mm                                  */

             CALL       PGM(AP600R) PARM(FP214 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO

/* Skriv hylleetiketter   100x28 mm                                 */

             CALL       PGM(AP600R) PARM(FP215 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO

/* Skriv reoletiketter    202x60                                     */

             CALL       PGM(AP600R) PARM(FP216 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO

/* Skriv hylleetiketter    76x39 mm                                 */

             CALL       PGM(AP600R) PARM(FP217 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO

/* Skriv hylleetiketter    48x38 mm                                  */

             CALL       PGM(AP600R) PARM(FP218 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO


/* Skriv hylleetiketter   100x38 mm                                  */

             CALL       PGM(AP600R) PARM(FP219 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO

/* Skriv reoletiketter    210x60                                     */

             CALL       PGM(AP600R) PARM(FP220 '0' '0' &IN03 &BTCH)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (891 1)) RTNVAR(&TYPEX)
             CHGVAR     VAR(&TYPE) VALUE(&TYPEX)

             IF         COND(&PROG *NE '          ') THEN(DO)
             OVRDBF     FILE(VAW1PF) TOFILE(VAW1PF) MBR(&WMM1)
             OVRPRTF    FILE(ETIKETT) TOFILE(QSYSPRT) DEV(&OUTQ) +
                          OUTQ(&OUTQ) FORMTYPE(&FORM) COPIES(&AKOP) +
                          HOLD(&HLDQ) MAXRCDS(*NOMAX)
             CALL       PGM(&PROG)
             ENDDO

             RMVM       FILE(*LIBL/VAW1PF) MBR(&WMM1)

/* Melding dersom bakgrunnsjobb                                      */

             IF         COND(&BTCH *EQ '1') THEN(DO)
             SNDBRKMSG  MSG('Utskrift av automatiske etiketter er +
                          ferdig') TOMSGQ(&WSID)
             ENDDO

 END:        ENDPGM
