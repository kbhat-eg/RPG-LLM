             PGM

             dclf       file(egd15pd)

             chgvar     var(&w_acli)   value(06)
             chgvar     var(&w_acpo)   value(05)
start:
             sndrcvf    rcdfmt(M1WIN)
             chgvar     var(&in31)    value('0')
             chgvar     var(&in32)    value('0')
/*                                                                   */
/*  Tester p} funksjonstaster                                        */
/*                                                                   */
/*  F3                                                               */
             if         cond(&In03) then(do)
               goto     cmdlbl(endpgm)
             enddo

/*   Fra filgruppe                                                  */
             if         cond(&fra *eq '   ') then(do)
               chgvar     var(&m1mld2) value('Fra filgruppe må oppgis')
               chgvar     var(&in31)    value('1')
               goto       cmdlbl(start)
             enddo

             chkobj     obj(&fra) objtype(*LIB)
             monmsg     msgid(cpf9801) exec(do)
/*  fra bibliotek finnes ikke     */
               chgvar     var(&m1mld2) value('Biblioteket ' *cat &fra +
                          *cat ' finnes ikke.  Reg. nytt bibl.')
               chgvar     var(&in31)    value('1')
             goto       cmdlbl(start)

             enddo

/*   Til bibliotek                                                  */
             if         cond(&til *eq '   ') then(do)
               chgvar     var(&m1mld2) value('Til bibliotek må oppgis')
               chgvar     var(&in32)    value('1')
               goto       cmdlbl(start)
             enddo

             chkobj     obj(&til) objtype(*LIB)
             monmsg     msgid(cpf9801) exec(do)
/*  til filgruppe finnes ikke     */
               chgvar     var(&m1mld2) value('Biblioteket ' *cat &til +
                          *cat ' finnes ikke.  Reg. til bibl.')
               chgvar     var(&in32)    value('1')
               goto       cmdlbl(start)
             enddo

             call       pgm(egd15c)  parm(&fra &til)

/* ______________________________________________________________________*/
/*                                                                   */
/* Slutt                                                             */
 ENDPGM:     ENDPGM
