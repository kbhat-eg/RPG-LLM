             PGM        PARM(&FIRM &LAGE &KJOR &LDAT &EXCL &MAPP +
                             &XLNA &FEIL)
/* Initiering av parametere                                          */

             DCL        VAR(&FIRM)     TYPE(*DEC) LEN(3 0)
             DCL        VAR(&LAGE)     TYPE(*DEC) LEN(2 0)
             DCL        VAR(&KJOR)     TYPE(*DEC) LEN(2 0)
             DCL        VAR(&LDAT)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN03)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&EXCL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&MAPP)     TYPE(*CHAR) LEN(20)
             DCL        VAR(&XLNA)     TYPE(*CHAR) LEN(12)
             DCL        VAR(&FEIL)     TYPE(*CHAR) LEN(1)
/*                         VALUE(' ')                                         */
             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(50) +
                          VALUE('Excel ikke dannet, feil ved +
                            kopiering')
             DCL        VAR(&tild)  TYPE(*CHAR) LEN(25)
             DCL        VAR(&tilm)  TYPE(*CHAR) LEN(20)

/*  t√∏mmer evt. excel fil                                            */
             IF         COND(&EXCL *EQ 1) THEN(DO)
             CLRPFM     FILE(LWEXPF)
             ENDDO
/* Program for printerstyring                                        */

             CALL       PGM(AP600R) PARM('FO656' '1' '0' &IN03 &BTCH)

             IF         COND(&IN03 *EQ '1') THEN(GOTO CMDLBL(END))

/* Overstyring av printerfile                                        */

             CALL       PGM(AP601C)    PARM('FO656P' &BTCH)

/* Kaller opp program for kontrolliste                               */

             CALL       PGM(FO656R)    PARM(&FIRM &LAGE &KJOR &LDAT &EXCL)

             CALL       PGM(AP606C)    PARM('FO656P')

             IF         COND(&EXCL *EQ 1) THEN(DO)
/*              CPYTOPCD   FROMFILE(LWEXPF) TOFLR(&MAPP) TODOC(&XLNA) +       */
/*                           REPLACE(*YES)                                    */
             chgvar     var(&tild) value(&XLNA)
             chgvar     var(&tilm) value(&MAPP)
             call       pgm(asptostmf) parm('LWEXPF    ' 'LWEXPF    ' +
                          &tilm &tild '   ')
             MONMSG     MSGID(IWS1603)
             MONMSG     MSGID(CPF8A00) EXEC(GOTO CMDLBL(FEIL))
             MONMSG     MSGID(IWS1611) EXEC(GOTO CMDLBL(FEIL))
             MONMSG     MSGID(IWS1612) EXEC(GOTO CMDLBL(FEIL))
             ENDDO
             GOTO       CMDLBL(END)

 FEIL:       CHGVAR     VAR(&FEIL) VALUE('1')
             CALL       PGM(AA005R)    PARM(&MLD1)

END:         ENDPGM
