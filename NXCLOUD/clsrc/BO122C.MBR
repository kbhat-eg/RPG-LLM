             PGM        PARM(&MEMB &PARM)
/*                                                                   */
             DCL        VAR(&KODE)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&ONOF)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&TYPE)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&ALT1)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&ALT2)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&ALT3)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&ALT4)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&MEMB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&PARM)     TYPE(*CHAR) LEN(256)
             DCL        VAR(&AVST)     TYPE(*CHAR) LEN(1)
/*                                                                   */
/* Dersom BATCH må registre overrides på nytt                        */
/*                                                                   */
             RTVJOBA    TYPE(&TYPE)
             IF         COND(&TYPE *EQ '0') THEN(DO)
             ENDDO

/* Henter inn kode som styrer kontroll/avstemmingsliste              */

             CHGVAR     VAR(&AVST)     VALUE(%SST(&PARM 142 1))
/*                                                                   */
/* Danner members for parameterfilene                                */
/*                                                                   */
             ADDPFM     FILE(BPSOPF)   MBR(&MEMB)
/*                                                                   */
             ADDLFM     FILE(BPSOLU)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/BPSOPF (&MEMB)))
             ADDLFM     FILE(BPSOL1)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/BPSOPF (&MEMB)))
             ADDLFM     FILE(BPSOLA)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/BPSOPF (&MEMB)))
             ADDLFM     FILE(BPSOLB)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/BPSOPF (&MEMB)))
             ADDLFM     FILE(BPSOLC)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/BPSOPF (&MEMB)))
/*                                                                   */
/* Override parameterfilene/membrene                                 */
/*                                                                   */
             OVRDBF     FILE(BPSOLU)   TOFILE(*FILE) MBR(&MEMB)
             OVRDBF     FILE(BPSOL1)   TOFILE(*FILE) MBR(&MEMB)
             OVRDBF     FILE(BPSOLA)   TOFILE(*FILE) MBR(&MEMB)
             OVRDBF     FILE(BPSOLB)   TOFILE(*FILE) MBR(&MEMB)
             OVRDBF     FILE(BPSOLC)   TOFILE(*FILE) MBR(&MEMB)
/*                                                                   */
/* Call til program for utskrift                                     */
/* av kontroll/avstemmingsliste                                      */
/*                                                                   */
             CALL       PGM(BO122R)    PARM(&PARM)
/*                                                                   */
/* Hente inn fra LDA                                                 */
/*                                                                   */
             RTVDTAARA  DTAARA(*LDA (101 1)) RTNVAR(&ALT1)
             RTVDTAARA  DTAARA(*LDA (102 1)) RTNVAR(&ALT2)
             RTVDTAARA  DTAARA(*LDA (103 1)) RTNVAR(&ALT3)
             RTVDTAARA  DTAARA(*LDA (104 1)) RTNVAR(&ALT4)
/*                                                                   */
             IF         COND(&ALT1 *EQ '1') THEN(CALL PGM(BO124C) +
                          PARM(&MEMB &PARM))
/*                                                                   */
             IF         COND(&ALT2 *EQ '1') THEN(CALL PGM(BO125C) +
                          PARM(&MEMB &PARM))
/*                                                                   */
             IF         COND(&ALT3 *EQ '1') THEN(CALL PGM(BO126C) +
                          PARM(&MEMB &PARM))
/*                                                                   */
             IF         COND(&ALT4 *EQ '1') THEN(CALL PGM(BO128C) +
                          PARM(&MEMB &PARM))
/*                                                                   */
/* Override av parametermembrene oppheves                            */
/*                                                                   */
             DLTOVR     FILE(BPSOLU BPSOL1 BPSOLA BPSOLB BPSOLC)
/*                                                                   */
/* Parametermebrene slettes                                          */
/*                                                                   */
             RMVM       FILE(BPSOL1)   MBR(&MEMB)
             RMVM       FILE(BPSOLU)   MBR(&MEMB)
             RMVM       FILE(BPSOLA)   MBR(&MEMB)
             RMVM       FILE(BPSOLB)   MBR(&MEMB)
             RMVM       FILE(BPSOLC)   MBR(&MEMB)
             RMVM       FILE(BPSOPF)   MBR(&MEMB)

/* Oppdater jobb-register med jobb-ferdig-flagg                      */
/* dersom dette var avstemmingsliste                                 */

             IF         COND(&AVST *EQ '1') THEN(DO)
             CHGVAR     VAR(&KODE)     VALUE(03)
             CHGVAR     VAR(&ONOF)     VALUE(0)
             CALL       PGM(FA720R)    PARM(&KODE &ONOF)
             ENDDO

             ENDPGM
