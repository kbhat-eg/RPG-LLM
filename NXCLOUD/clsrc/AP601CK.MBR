
             PGM        PARM(&PRTF &BTCH)

/* Definering av variable                                            */

             DCL        VAR(&DEVT)     TYPE(*CHAR) LEN(10)

             DCL        VAR(&RUTI)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&OUTQ)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLDQ)     TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE)     TYPE(*CHAR) LEN(4)
             DCL        VAR(&OVRK)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&PRTF)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRTY)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&PROG)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&BGIR)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&KIDK)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&OCRK)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&TVBT)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&NROT)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&PAGR)     TYPE(*CHAR) LEN(5)
             DCL        VAR(&DPLX)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&PKVA)     TYPE(*CHAR) LEN(10)

             DCL        VAR(&ACPI)     TYPE(*DEC)  LEN(4 0)
             DCL        VAR(&AKOP)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&ALIN)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&OFLW)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&APOS)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&IPDS)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&SKIN)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&SKUT)     TYPE(*DEC)  LEN(2 0)

             DCL        VAR(&ACPIX)    TYPE(*CHAR) LEN(4)
             DCL        VAR(&AKOPX)    TYPE(*CHAR) LEN(6)
             DCL        VAR(&ALINX)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&OFLWX)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&APOSX)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&IPDSX)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&SKINX)    TYPE(*CHAR) LEN(2)
             DCL        VAR(&SKUTX)    TYPE(*CHAR) LEN(2)
             DCL        VAR(&SKUTY)    TYPE(*CHAR) LEN(10)

             DCL        VAR(&SKJE)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&MUTQ)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&LUTQ)     TYPE(*CHAR) LEN(10)

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (585 10))  RTNVAR(&MUTQ)
             RTVDTAARA  DTAARA(*LDA (745 4))  RTNVAR(&SAVE)
             RTVDTAARA  DTAARA(*LDA (800 10)) RTNVAR(&RUTI)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (845 1))  RTNVAR(&OVRK)
             RTVDTAARA  DTAARA(*LDA (859 1))  RTNVAR(&PRTY)
             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (881 1))  RTNVAR(&BGIR)
             RTVDTAARA  DTAARA(*LDA (883 1))  RTNVAR(&KIDK)
             RTVDTAARA  DTAARA(*LDA (885 1))  RTNVAR(&OCRK)
             RTVDTAARA  DTAARA(*LDA (886 1))  RTNVAR(&TVBT)
             RTVDTAARA  DTAARA(*LDA (892 1))  RTNVAR(&NROT)
             RTVDTAARA  DTAARA(*LDA (830 4))  RTNVAR(&ACPIX)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (856 3))  RTNVAR(&ALINX)
             RTVDTAARA  DTAARA(*LDA (860 3))  RTNVAR(&OFLWX)
             RTVDTAARA  DTAARA(*LDA (887 3))  RTNVAR(&APOSX)
             RTVDTAARA  DTAARA(*LDA (890 1))  RTNVAR(&IPDSX)
             RTVDTAARA  DTAARA(*LDA (670 2))  RTNVAR(&SKINX)
             RTVDTAARA  DTAARA(*LDA (672 2))  RTNVAR(&SKUTX)
             RTVDTAARA  DTAARA(*LDA (674 7))  RTNVAR(&DPLX)
             RTVDTAARA  DTAARA(*LDA (681 10)) RTNVAR(&PKVA)

/* Overføring til nummeriske felt                                    */

             CHGVAR     VAR(&ACPI)     VALUE(&ACPIX)
             CHGVAR     VAR(&AKOP)     VALUE(&AKOPX)
             CHGVAR     VAR(&ALIN)     VALUE(&ALINX)
             CHGVAR     VAR(&OFLW)     VALUE(&OFLWX)
             CHGVAR     VAR(&APOS)     VALUE(&APOSX)
             CHGVAR     VAR(&IPDS)     VALUE(&IPDSX)
             CHGVAR     VAR(&SKIN)     VALUE(&SKINX)
             CHGVAR     VAR(&SKUT)     VALUE(&SKUTX)

/* Legg inn riktig devtype                                           */

             CHGVAR     VAR(&DEVT)     VALUE('*SCS')
             IF         COND(&IPDS *EQ 1) THEN(DO)
             CHGVAR     VAR(&DEVT)     VALUE('*IPDS')
             ENDDO

/* Legg inn riktig vridningsgrad                                     */

             CHGVAR     VAR(&PAGR)     VALUE('*AUTO')
             IF         COND(&NROT *EQ '1') THEN(DO)
             CHGVAR     VAR(&PAGR)     VALUE('0    ')
             ENDDO

/* Legg inn riktig utskuff                                           */

             CHGVAR     VAR(&SKUTY)    VALUE('*DEVD')
             IF         COND(&SKUT *NE 0 ) THEN(DO)
             CHGVAR     VAR(&SKUTY)    VALUE(&SKUTX)
             ENDDO

/* Legg inn skriver fra jobbatr hvis den fortsatt er *JOB             */

             IF         COND(&MUTQ *EQ '*JOB') THEN(DO)
             RTVJOBA    PRTDEV(&LUTQ)
             CHGDTAARA  DTAARA(*LDA (585 10)) VALUE(&LUTQ)
             ENDDO

/* Spesialhåndtering av utskrifter fra klienten                     */

             CHGVAR     VAR(&OUTQ)     VALUE('PDFPRINT')
             CHGVAR     VAR(&HLDQ)     VALUE('*YES')

/* Overstyring av printerfil                                         */

             IF         COND(&OVRK *EQ '1') THEN(DO)
             OVRPRTF    FILE(&PRTF)         TOFILE(*FILE) +
                          DEV(&OUTQ)        OUTQ(&OUTQ) +
                          FORMTYPE(&FORM)   PAGESIZE(&ALIN &APOS) +
                          OVRFLW(&OFLW)     CPI(&ACPI) +
                          COPIES(&AKOP)     HOLD(&HLDQ) +
                          SAVE(&SAVE) +
                          PAGRTT(&PAGR)     PRTQLTY(&PKVA) +
                          OUTPTY(&PRTY)     DUPLEX(&DPLX)  +
                          DRAWER(&SKIN)     OUTBIN(&SKUTY) +
                          OVRSCOPE(*JOB)    DEVTYPE(&DEVT)


             ENDDO

/* Henter verdier i fra LDA. Kreves hvis skjermvisning er valgt      */

             IF         COND(&BTCH *EQ '1') THEN(DO)
                        CHGDTAARA  DTAARA(*LDA (637 1)) VALUE('0')
                        GOTO CMDLBL(ENDPGM)
             ENDDO

 ENDPGM:     ENDPGM
