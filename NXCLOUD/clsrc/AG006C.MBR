             PGM
             DCLF       FILE(AG006D)

             DCL        VAR(&VFGK) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VKPR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VKRA) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VKRE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VPER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSRL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSRH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSRI) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSLR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSRM) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSSR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTGR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTKT) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTMD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTRP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTUG) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTUS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VTUV) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VUSS) TYPE(*CHAR) LEN(1)

             DCL        VAR(&NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&MILJ) TYPE(*CHAR) LEN(3)
             DCL        VAR(&LEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK) TYPE(*CHAR) LEN(2)
             DCL        VAR(&MLD1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&MLD2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&SVAR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&ANUL) TYPE(*DEC)  LEN(1 0)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL) VALUE('40')
             CHGVAR     VAR(&OKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/*  Gi angrefrist dersom registere skal nullstilles..                */

             IF         COND(&NULL *EQ 'S') THEN(DO)
             CHGVAR     VAR(&MLD1) VALUE('Obs !  Det er bedt om +
                                     at data i filer skal slettes')
             CHGVAR     VAR(&MLD2) VALUE('Bekreft dersom dette +
                                     skal utf√∏res...')
             CHGVAR     VAR(&SVAR) VALUE('N')
             CALL       PGM(AA007R)  PARM(&MLD1 &MLD2 &SVAR +
                                          &ANUL)
             ENDDO

             IF         COND(&ANUL *EQ 1)   THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&SVAR *EQ 'N') THEN(DO)
             CHGVAR     VAR(&NULL) VALUE(' ')
             ENDDO

/*  Genererer de valgte registere                                    */

             IF         COND(&VFGK *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XFGKST' &MILJ &NULL)
             ENDDO

             IF         COND(&VKPR *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XKPRST' &MILJ &NULL)
             ENDDO

             IF         COND(&VKRA *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XKRAST' &MILJ &NULL)
             ENDDO

             IF         COND(&VKRE *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XKREST' &MILJ &NULL)
             ENDDO

             IF         COND(&VPER *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XPERST' &MILJ &NULL)
             ENDDO

             IF         COND(&VSRL *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XSRLST' &MILJ &NULL)
             ENDDO

             IF         COND(&VSRH *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XSRHST' &MILJ &NULL)
             ENDDO

             IF         COND(&VSRI *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XSRIST' &MILJ &NULL)
             ENDDO

             IF         COND(&VSLR *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XSLRST' &MILJ &NULL)
             ENDDO

             IF         COND(&VSRM *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XSRMST' &MILJ &NULL)
             ENDDO

             IF         COND(&VSSR *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XSSRST' &MILJ &NULL)
             ENDDO

             IF         COND(&VTGR *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XTGRST' &MILJ &NULL)
             ENDDO

             IF         COND(&VTKT *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XTKTST' &MILJ &NULL)
             ENDDO

             IF         COND(&VTMD *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XTMDST' &MILJ &NULL)
             ENDDO

             IF         COND(&VTUG *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XTUGST' &MILJ &NULL)
             ENDDO

             IF         COND(&VTUS *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XTUSST' &MILJ &NULL)
             ENDDO

             IF         COND(&VTUV *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XTUVST' &MILJ &NULL)
             ENDDO

             IF         COND(&VUSS *EQ '1') THEN(DO)
             CALL       PGM(AG909C) PARM('XUSSST' &MILJ &NULL)
             ENDDO

 ENDPGM:     ENDPGM
