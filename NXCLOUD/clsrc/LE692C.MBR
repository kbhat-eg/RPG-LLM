             PGM        PARM(&WHERE &POST_LINK &NUMM)

             DCL        VAR(&FIRMA) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&NUMM) TYPE(*DEC) LEN(8 0)
             DCL        VAR(&WHERE) TYPE(*CHAR) LEN(8000)
             DCL        VAR(&POST_LINK) TYPE(*CHAR) LEN(100)

             DCL        VAR(&SQLSTMT)  TYPE(*CHAR) LEN(10000)
             DCL        VAR(&PREFIX_FIL)    TYPE(*CHAR) LEN(20) +
                          VALUE('LAGERAVVIK')


/*   Bygg SQL                                                                 */
             CHGVAR     VAR(&SQLSTMT) VALUE('SELECT +
                          lx2ogr AS "Overgruppe", +
                          lx2hgr AS "Hovedgruppe", +
                          lx2ugr AS "Undergruppe", +
                          lx2lag AS "Lager", +
                          lx2nob AS "NOBB", +
                          lx2var AS "Varenummer", +
                          lx2tx1 AS "Varetekst 1", +
                          lx2tx2 AS "Varetekst 2", +
                          lx2enh AS "Enhet", +
                          lx2tqt AS "Tellekvantum", +
                          lx2lbe AS "Lagerbeholdning", +
                          lx2dif AS "Telledifferanse", +
                          lx2sap AS "Salgspris", +
                          lx2sve AS "Salgsverdi", +
                          lx2kos AS "Kostpris", +
                          lx2kve AS "Kostverdi", +
                          lx2tve AS "Telletverdi", +
                          lx2lve AS "Lagerverdi", +
                          lx2dve AS "Avviksverdi", +
                          lx2abc AS "Tellekode", +
                          lx2loc AS "Lagerplass", +
                          lx2lo1 AS "Lagerplass1", +
                          lx2lo2 AS "Lagerplass2" FROM lxl2st')

             chgvar var(&sqlstmt) +
                    value(&sqlstmt *BCAT ' WHERE LX2IDE=' +
                    *CAT %char(&numm))

/*           chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'WHERE FOFIRM=' +  */
/*                        *CAT %CHAR(&FIRMA))                                 */
/*           chgvar     var(&sqlstmt) value(&sqlstmt *Bcat &WHERE)            */
/*           chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'ORDER BY +        */
/*                        FODATE DESC, FOTIME DESC, FONUMM, FOSUFF ')         */
/*              chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'LIMIT 1000')   */



             CALL       PGM(XLSXCLODXP) PARM( &SQLSTMT &POST_LINK +
                          &PREFIX_FIL)

 ENDPGM:     ENDPGM
