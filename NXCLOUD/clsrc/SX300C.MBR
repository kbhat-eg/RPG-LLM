             PGM
             DCLF       FILE(SX300D)
/*                                                                   */
             DCL        VAR(&A1VAA1) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA2) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA3) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1FGRP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&APLEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&APOKOK) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WPBIBL) TYPE(*CHAR) LEN(06) VALUE('ADB   ')
/*                                                                   */
/* Kontrollere brukertilgang                                         */
/*                                                                   */
             CHGVAR     VAR(&APLEVL) VALUE('40')
             CHGVAR     VAR(&APOKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&APLEVL &APOKOK)
             IF         COND(&APOKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
/*                                                                   */
/*                                                                   */
             SNDRCVF    RCDFMT(A1BLD)
/*                                                                   */
/* F3 + F12                                                          */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))
/*                                                                   */
/*           Setter bibliotek til current                            */
/*                                                                   */
             CHGVAR     VAR(%SST(&WPBIBL 4 3)) VALUE(&A1FGRP)
             CHGCURLIB  CURLIB(&WPBIBL)
/*                                                                   */
/*  Genererer de valgte registere                                    */
/*                                                                   */
             IF         COND(&A1VAA1 *EQ '1') THEN(DO)
             CALL       PGM(SX330C) PARM(&A1FGRP)
             ENDDO
/*                                                                   */
             IF         COND(&A1VAA2 *EQ '1') THEN(DO)
             CALL       PGM(SX340C) PARM(&A1FGRP)
             ENDDO
/*                                                                   */
             IF         COND(&A1VAA3 *EQ '1') THEN(DO)
             CALL       PGM(SX350C) PARM(&A1FGRP)
             ENDDO
/*                                                                   */
             IF         COND(&A1VAA4 *EQ '1') THEN(DO)
             CALL       PGM(SX430C) PARM(&A1FGRP)
             ENDDO
/*                                                                   */
             IF         COND(&A1VAA5 *EQ '1') THEN(DO)
             CALL       PGM(SX450C) PARM(&A1FGRP)
             ENDDO
/*                                                                   */
 ENDPGM:     ENDPGM
