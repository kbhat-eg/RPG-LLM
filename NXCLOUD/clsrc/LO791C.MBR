             PGM        PARM(&MEMBR &ONUMM &OSUFF &LKNR &FEIL)

/* Initiering av parametre.                                          */

             DCL        VAR(&MEMBR)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&ONUMM)    TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&OSUFF)    TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&OVRF) TYPE(*CHAR) LEN(10) +
                          VALUE('NORGROBEST')
             DCL        VAR(&OVRX) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FILN)  TYPE(*CHAR) LEN(20)
             DCL        VAR(&STAT)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&SMSG)  TYPE(*CHAR) LEN(1) VALUE('1')
             DCL        VAR(&LKNR)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&FEIL) TYPE(*CHAR) LEN(1) VALUE('0')

/* Bygger member og overstyrer                                       */

             CHKOBJ     OBJ(LWNOPF) OBJTYPE(*FILE) MBR(&MEMBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(LWNOPF) MBR(&MEMBR) TEXT('Bestilling +
                          i Norgros-format')
             ENDDO
             OVRDBF     FILE(LWNOPF) TOFILE(LWNOPF) MBR(&MEMBR)

/* Kaller genereringsprogram                                         */

             CALL       PGM(LO790R) PARM(&ONUMM &OSUFF &FILN)
             DLTOVR     FILE(LWNOPF)
             CPYF       FROMFILE(LWNOPF) TOFILE(LWNOPF) +
                          FROMMBR(&MEMBR) TOMBR(LWNOPF) +
                          MBROPT(*REPLACE)

             IF         COND(&LKNR *NE ' ') THEN(DO)
             CHGVAR     VAR(&OVRX) VALUE('NORG' *TCAT &LKNR)
             CHGVAR     VAR(&OVRF) VALUE(&OVRX)
             ENDDO

             CALL       PGM(AF700C) PARM(&OVRF &STAT &FILN &SMSG)

/* Tømmer overføringsfile for poster                                 */

             IF         COND(&STAT *NE ' ') THEN(CHGVAR VAR(&FEIL) +
                          VALUE('1'))
             RMVM       FILE(LWNOPF) MBR(&MEMBR)
             RMVM       FILE(LWNOPF) MBR(LWNOPF)
 END:        ENDPGM
