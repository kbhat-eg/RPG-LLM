             PGM        PARM(&FLDR &FGRP &FEIL)

/* Initiering av parametre.                                          */

             DCL        VAR(&FLDR) TYPE(*CHAR) LEN(20)
             DCL        VAR(&FGRP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FEIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILN) TYPE(*CHAR) LEN(12)
             DCL        VAR(&tild)  TYPE(*CHAR) LEN(25)
             DCL        VAR(&tilm)  TYPE(*CHAR) LEN(20)

             MONMSG     MSGID(CPF8A00) EXEC(GOTO CMDLBL(FEIL))
             MONMSG     MSGID(IWS1611) EXEC(GOTO CMDLBL(FEIL))

/* Initierer feil-flagg                                              */

             CHGVAR     VAR(&FEIL) VALUE('0')

/* Danner filnavn                                                    */
                      CHGVAR     VAR(&FILN) VALUE('ENDR' *CAT &FGRP -
                      *CAT '.XLS')


/* Kopierer innhold fra PC-fil i mappe over til AS/400-filer         */

/*           CPYTOPCD   FROMFILE(JWRKPF) TOFLR(&FLDR) +         */
/*                        TODOC(&FILN) REPLACE(*YES)            */
             chgvar     var(&tild) value(&filn)
             chgvar     var(&tilm) value('/asp/' *tcat &fldr)
             call       pgm(asptostmf) +
                        parm('JWRKPF    ' +
                             'JWRKPF    ' +
                             &tilm +
                             &tild   +
                             '   ')

/* TÃ¸mmer fil for endringslogg                                       */

             CLRPFM     FILE(JWRKPF)

             GOTO       CMDLBL(END)

 FEIL:       CHGVAR     VAR(&FEIL) VALUE('1')

 END:        ENDPGM
