             PGM        PARM(&FIG)

/* Setter parameterverdier: &GRE - sluttidspunkt på dagen (HHMM)   */
/*                          &INT - lesefrekvens på transaksjoner   */

             DCL        VAR(&FIG) TYPE(*CHAR) LEN(3)
             DCL        VAR(&TIM) TYPE(*CHAR) LEN(20)
             DCL        VAR(&GRE) TYPE(*CHAR) LEN(4) VALUE('2300')
             DCL        VAR(&INT) TYPE(*CHAR) LEN(6) VALUE('000010')

/* Setter riktig biblioteksliste og current library                */

             CALL       PGM(ASPINI/AA724C) PARM(&FIG)

/* Sjekker om transakjonsfil finnes - avslutter hvis ikke          */

             CHKOBJ     OBJ(IFNAI1) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9815) EXEC(GOTO CMDLBL(ENDPGM))

/* Leser transaksjonsfil og starter oppdaterings programmer        */

 NYLES:      CALL       PGM(IT100R)

/* Sjekker om programmet skal avsluttes hvis ikke les på nytt      */

             RTVSYSVAL  SYSVAL(QTIME) RTNVAR(&TIM)
             IF         COND(%SUBSTRING(&TIM 1 4) *LT &GRE) THEN(DO)
               DLYJOB     DLY(&INT)
               GOTO       CMDLBL(NYLES)
             ENDDO

 ENDPGM:     ENDPGM
