             PGM

/* Initiering av parametre                                           */

             DCL        VAR(&VALG)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&LGRP)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&LFIR)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&LLAG)   TYPE(*CHAR) LEN(2)
             DCL        VAR(&FFLR)   TYPE(*CHAR) LEN(10)

             dcl        var(&fradoc) type(*char) len(30)
             dcl        var(&framap) type(*char) len(30)
             dcl        var(&tillib) type(*char) len(10)
             dcl        var(&tilfil) type(*char) len(10)
             dcl        var(&tilmbr) type(*char) len(10)
             dcl        var(&fgr)    type(*char) len(3)
             dcl        var(&sts)    type(*char) len(8)

/* Bygger opp mappenavn av filgruppe,firma og lager                  */

             RTVDTAARA  DTAARA(*LDA (931 3))   RTNVAR(&LGRP)
             RTVDTAARA  DTAARA(*LDA (944 3))   RTNVAR(&LFIR)
             RTVDTAARA  DTAARA(*LDA (1001 2))  RTNVAR(&LLAG)
             CHGVAR     VAR(&FFLR) VALUE(&LGRP *CAT &LFIR  +
                            *CAT &LLAG *CAT '.I')

/* Tømmer håndterminalfil                                            */

             CLRPFM     FILE(HBTRPF)

/* Kopierer ekstern fil til håndterminalfil                          */

START:       rtvdtaara  dtaara(*lda (931 03)) rtnvar(&fgr)
             chgvar     var(&framap)  value('/ASP/' *cat +
                                             &fgr   *cat +
                                             '/' *cat &fflr)
             DLTDLO     DLO(ORDRE.COP) FLR(&framap)
             MONMSG     MSGID(CPF8A16)

             RNMDLO     DLO(ORDRE.TXT) NEWDLO(ORDRE.COP) FLR(&framap)
             MONMSG     MSGID(CPF8A00) EXEC(GOTO CMDLBL(END))

/*           CPYFRMPCD  FROMFLR(&FFLR) TOFILE(HBTRPF) +      */
/*                        FROMDOC(ORDRE.COP) MBROPT(*ADD)    */
/*           MONMSG     MSGID(CPF8A00)                       */
/*           MONMSG     MSGID(IWS1611)                       */

/* Starter program avhengig av håndterminal                          */
             chgvar     var(&fradoc)  value('ORDRE.COP')
             chgvar     var(&tillib)  value('*LIBL')
             chgvar     var(&tilfil)  value('HBTRPF')
             chgvar     var(&tilmbr)  value('HBTRPF')
             chgvar     var(&sts)     value(' ')
             call       pgm(aspfrstmf) parm(+
                            &fradoc +
                            &framap +
                            &tillib +
                            &tilfil +
                            &tilmbr +
                            &sts)
/*           if         cond(&sts *ne ' ') then(goto cmdlbl(feil))  */

             CALL       PGM(HO700R) PARM(&VALG)

             IF         COND(&VALG *EQ '1') THEN(CALL  PGM(HO701R))
             IF         COND(&VALG *EQ '2') THEN(CALL  PGM(HO702R))
             IF         COND(&VALG *EQ '3') THEN(CALL  PGM(HO703R))

 END:        ENDPGM
