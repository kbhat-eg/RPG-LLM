             PGM  parm(&stat)

             dcl        var(&stat) type(*char) len(1)

             dcl        var(&bsta) type(*char) len(1) value('0')
             dcl        var(&mld3) type(*char) len(30)
             dcl        var(&mld4) type(*char) len(30)
             dcl        var(&posx) type(*dec) len(2 0) value(5)
             dcl        var(&posy) type(*dec) len(2 0) value(5)

/* Sjekk om innhenting allerede pågår                                */
             chgvar     var(&bsta) value('0')
             call       pgm(xf770c) parm(&bsta)
             if         cond(&bsta *eq '1') then(do)
             chgvar     var(&mld3) value('Overføring pågår allerede')
             chgvar     var(&mld4) value('  Vennligst prøv senere  ')
             call       pgm(aa006c) parm(&posx &posy &mld3 &mld4)
             monmsg     msgid(cpf0000)
/*           dlyjob     dly(5)                                        */
             goto       cmdlbl(slutt)
             enddo

/* Klargjør filer før mottak                                         */

             CLRPFM     FILE(LWERPF)
             CLRPFM     FILE(LWEFPF)
             CLRPFM     FILE(LWEOPF)
             CLRPFM     FILE(LWEPPF)
             CLRPFM     FILE(LWEBPF)

/* Call til program for kommunikasjon  IBM + NBS                     */

             CALL       PGM(LI703C)

/* Call til program for oppdatering                                  */

             CALL       PGM(LI700R)  parm(&stat)

             CLRPFM     FILE(LWEOPF)
             CLRPFM     FILE(LWEFPF)

slutt:       ENDPGM
