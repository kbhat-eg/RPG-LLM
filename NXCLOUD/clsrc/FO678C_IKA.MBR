             PGM        PARM(&PARM)

             DCL        VAR(&IN03)   TYPE(*CHAR) LEN(1)
/*6.nu*/     DCL        VAR(&PARM)   TYPE(*CHAR) LEN(32)
             DCL        VAR(&BTCH)   TYPE(*CHAR) LEN(1)

/* Initiering av parametere for utskrift                             */

             DCL        VAR(&PRTF)   TYPE(*CHAR) LEN(10) +
                                     VALUE('FO678P')
             DCL        VAR(&FFIR)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&WMM1)     TYPE(*CHAR) LEN(10) VALUE('IKAS    ')

/* Oppdaterer LDA med navn p√• prinfile og kode for om formular-      */
/* parametre skal endres.                                            */

             CHGDTAARA  DTAARA(*LDA (846 10)) VALUE(&PRTF)
             RTVDTAARA  DTAARA(*LDA (944 03)) RTNVAR(&FFIR)

/* Call av program for utskriftsparametre.                           */

             CALL       PGM(AP600R)    PARM('FO678' '0' '0' &IN03 &BTCH)

/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
/* Henter verdier i fra LDA.                                         */

             CHGVAR     VAR(%SST(&WMM1 5 3)) VALUE(&FFIR)

/* Bygger membere dersom de ikke finnes                              */

             CHKOBJ     OBJ(RE0IPF) OBJTYPE(*FILE) MBR(&WMM1)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RE0IPF) MBR(&WMM1) TEXT('Poster til +
                          Ikas Kreditsystemer')
             ENDDO
             CLRPFM     FILE(RE0IPF) MBR(&WMM1)


/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */

/* Kaller opp program for Faktura-journal til Ikas Kreditsystemer    */

             OVRDBF     FILE(RE0IPF) MBR(&WMM1)
             CALL       PGM(FO678R) PARM(&PARM)
             DLTOVR     FILE(RE0IPF)

/* Utvekslingsfile legges ut i DIR: PCFILER (I:)                     */

             CPYTOPCD   FROMFILE(*LIBL/RE0IPF) TOFLR(PCFILER) +
                          FROMMBR(&WMM1) TODOC(&WMM1) REPLACE(*YES) +
                          /* Posteringer for periode */
               MONMSG     MSGID(CPF0000)

             ENDPGM
