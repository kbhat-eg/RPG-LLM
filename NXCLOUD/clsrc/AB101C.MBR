/*-------------------------------------------------------------------------*/
/*                                                                         */
/*                                                                         */
/*                                                                         */
/*                                                                         */
/*-------------------------------------------------------------------------*/
             PGM        PARM(&POST_LINK &NUMM)

             DCL        VAR(&POST_LINK) TYPE(*CHAR) LEN(100)
             DCL        VAR(&NUMM) TYPE(*DEC) LEN(8 0)

             DCL        VAR(&WHERE) TYPE(*CHAR) LEN(100)


             DCL        VAR(&SQLSTMT)  TYPE(*CHAR) LEN(10000)
             DCL        VAR(&PREFIX_FIL)    TYPE(*CHAR) LEN(25) +
                          VALUE('brukere_')


/* Bygg fil av alle brukere p√• systemet                                       */
             DSPUSRPRF  USRPRF(*ALL) OUTPUT(*OUTFILE) +
                          OUTFILE(*CURLIB/USRPRF)


/*   Bygg SQL                                                                 */

             CHGVAR     VAR(&SQLSTMT) VALUE('SELECT +
                          lx4usr AS "Bruker", +
                          lx4nam AS "Navn", +
                          lx4pad AS "Sist palogget", +
                          lx4pat AS "Sist palogget", +
                          lx4lag AS "Lager", +
                          lx4avd AS "Avdeling"  FROM lxl4st')

             chgvar var(&sqlstmt) +
                    value(&sqlstmt *BCAT ' WHERE LX4IDE=' +
                    *CAT %char(&numm))


             CALL       PGM(XLSXCLODXP) PARM( &SQLSTMT &POST_LINK +
                          &PREFIX_FIL)

 ENDPGM:     ENDPGM
