             PGM        PARM(&SYST)
/*                                                                   */
             DCL        VAR(&SYST)  TYPE(*CHAR) LEN(4)
             DCL        VAR(&FIRM)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&MEMB)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&bryt)  TYPE(*char) LEN(1)


/*   Sjekk om melding om hvilke byrå som kjøres mot skal gis   */
             if         cond(&syst *eq 'INKA') then(do)
               call     pgm(rcinkf_kvi)  parm(&bryt)
               if       cond(&bryt *eq 'J') then(goto cmdlbl(endpgm))
             enddo

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (944 3)) RTNVAR(&FIRM)
             CHGVAR     VAR(%SST(&MEMB 1 4)) VALUE(&SYST)
             CHGVAR     VAR(%SST(&MEMB 5 3)) VALUE(&FIRM)

/* Sjekk om det finnes poster for vedlikehold av forslag             */

             CHKOBJ     OBJ(RKWBPF) OBJTYPE(*FILE) MBR(&MEMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             CHGVAR     VAR(&WALI) VALUE(14)
             CHGVAR     VAR(&WAPO) VALUE(2)
             CHGVAR     VAR(&MLD1) VALUE('Det finnes ikke noe forslag')
             CHGVAR     VAR(&MLD2) VALUE('Rutinen avsluttes          ' )
             CALL       PGM(AA011C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Bygger membere dersom de ikke finnes                              */

             CHKOBJ     OBJ(RKWAPF) OBJTYPE(*FILE) MBR(&MEMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RKWAPF) MBR(&MEMB) TEXT('Parameter for +
                        rutine &SYST)')
             ENDDO

             CHKOBJ     OBJ(RKWBPF) OBJTYPE(*FILE) MBR(&MEMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RKWBPF) MBR(&MEMB) TEXT('Poster fra +
                        rutine &SYST')
             ENDDO

             CHKOBJ     OBJ(RKWBLU) OBJTYPE(*FILE) MBR(&MEMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(RKWBLU) MBR(&MEMB) DTAMBRS((RKWBPF +
                          (&MEMB))) TEXT('Poster fra +
                        rutine &SYST')
             ENDDO

             CHKOBJ     OBJ(RKWBLR) OBJTYPE(*FILE) MBR(&MEMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(RKWBLR) MBR(&MEMB) DTAMBRS((RKWBPF +
                          (&MEMB))) TEXT('Poster fra +
                        rutine &SYST')
             ENDDO

             CHKOBJ     OBJ(RKWBL1) OBJTYPE(*FILE) MBR(&MEMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(RKWBL1) MBR(&MEMB) DTAMBRS((RKWBPF +
                          (&MEMB))) TEXT('Poster fra +
                        rutine &SYST')
             ENDDO

/* Call av kundevedlikehold for forslag                              */

             OVRDBF     FILE(RKWBL1) TOFILE(*LIBL/RKWBL1) MBR(&MEMB)
             OVRDBF     FILE(RKWBLR) TOFILE(*LIBL/RKWBLR) MBR(&MEMB)
             OVRDBF     FILE(RKWBLU) TOFILE(*LIBL/RKWBLU) MBR(&MEMB)
             OVRDBF     FILE(RKWBPF) TOFILE(*LIBL/RKWBPF) MBR(&MEMB)

             CALL       PGM(RK521R) PARM(&SYST)
/*                                                                   */
             DLTOVR     FILE(RKWBLR)
             DLTOVR     FILE(RKWBL1)
             DLTOVR     FILE(RKWBLU)
             DLTOVR     FILE(RKWBPF)

 ENDPGM:     ENDPGM
