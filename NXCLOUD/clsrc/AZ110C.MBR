             PGM        PARM(&LIN)
             DCLF       FILE(AZ110D)
             DCL        VAR(&RES)      TYPE(*CHAR) LEN(10) +
                                       VALUE('          ')
             DCL        VAR(&LIN)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&GLIN)     TYPE(*CHAR) LEN(10) +
                                       VALUE('          ')

/*  Sjekker om ressurs allerede er brukt - bruker samme              */

             CALL       PGM(AZ105C)
             CALL       PGM(AZ106C)    PARM(&GLIN &RES)

/*  Legger ut skjermbilde med valg på linje og resurs                */

             CHGVAR     VAR(&A1LIN)    VALUE(&LIN)
             CHGVAR     VAR(&A1RES)    VALUE(&RES)
 BLD_UT:     SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */

             IF         COND(&IN03)    THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12)    THEN(GOTO CMDLBL(ENDPGM))

             IF         COND(&A1RES *EQ '          ') THEN(GOTO +
                        CMDLBL(BLD_UT))
             CHGVAR     VAR(&RES)      VALUE(&A1RES)

/* F8 = Jobbkø                                                       */

             IF         COND(&IN08)    THEN(DO)
             SBMJOB     CMD(CALL PGM(AZ115C) PARM(&LIN &GLIN &RES))
             ENDPASTHR
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/*  Kjør direkte                                                     */

             CALL       PGM(AZ115C)    PARM(&LIN &GLIN &RES)

 ENDPGM:     ENDPGM
