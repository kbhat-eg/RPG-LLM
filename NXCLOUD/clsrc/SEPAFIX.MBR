             pgm        parm(&fgr)

             dcl        var(&fgr)       type(*char) len(3)
             dcl        var(&dbib) type(*char) len(6) value('ADBxxx')
             dcl        var(&tim)  type(*char) len(20)
             dcl        VAR(&gre)  type(*char) len(4) value('2300')
             dcl        VAR(&int)  type(*char) len(6) value('000060')

             chgvar     var(&fgr) value(%upper(&fgr))

/* Endre i parm til rette filgruppe */
             CALL       PGM(AA724C) PARM(&fgr)

/* Endre her også, AA720C gir ikke alltid riktig filgruppe */

             chgvar     var(%sst(&dbib 4 3)) value(&fgr)
             chgcurlib  curlib(&dbib)

/* Etablerer nødvendige arbeidsfiler                       */

             crtpf      file(&dbib/XSEPAIN) rcdlen(200) size(1000000 20000)
             monmsg     msgid(CPF5813 CPF7302) exec(CLRPFM XSEPAIN)
             crtpf      file(&dbib/WSEPAIN) srcfile(*libl/QDDFSRC) +
                          srcmbr(WSEPAIN) size(1000000 20000)
             monmsg     msgid(CPF5813 CPF7302) exec(CLRPFM WSEPAIN)
             crtpf      file(&dbib/XSEPAUT) rcdlen(200) size(1000000 20000)
             monmsg     msgid(CPF5813 CPF7302) exec(CLRPFM XSEPAUT)
             crtpf      file(&dbib/WSEPAUT) srcfile(*libl/QDDFSRC) +
                          srcmbr(WSEPAUT) size(1000000 20000)
             monmsg     msgid(CPF5813 CPF7302) exec(CLRPFM WSEPAUT)

/* Kjører oppdateringsprogram for valgt filgruppe                   */

 nyles:
             call       pgm(SEPAFILR)

/* Sjekker om programmet skal avsluttes hvis ikke les på nytt      */

 wait:       rtvsysval  sysval(qtime) rtnvar(&tim)
             if         cond(%substring(&tim 1 4) *lt &gre) then(do)
                dlyjob     dly(&int)
                goto       cmdlbl(nyles)
             enddo

 end:        endpgm
