             PGM
/*                                                                   */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
             dcl        var(&m1)     type(*char) len(50)
             dcl        var(&m2)     type(*char) len(50)
             dcl        var(&svar)   type(*char) len(10)
             dcl        var(&a1)     type(*char) len(27)
             dcl        var(&a2)     type(*char) len(27)
             dcl        var(&in12)   type(*char) len(1)
             dcl        var(&dta)    type(*char) len(10)
             dcl        var(&d)      type(*char) len(200)
             dclf       file(sms_vared)
/*                                                                   */
             chgvar     var(&m1) value('Oppsett av melding ved vare+
                                 mottak                 ')
             chgvar     var(&m2) value('Tast inn det lager den skal +
                                 gjelde for            ')
             chgvar     var(&a1) value('Lager tastes med 2 siffer')
             chgvar     var(&a2) value('                         ')
ny:
             call       pgm(aa009R) parm(&m1 &m2 &svar &a1 &a2 &in12)
             if         cond(&in12 *eq '1') then(goto cmdlbl(end))
             if         cond(%sst(&svar 3 8) *ne '  ')  then(do)
                             goto cmdlbl(feil)
             enddo
             if         cond(&svar *lt '01') then(goto cmdlbl(feil))
             if         cond(&svar *gt '99') then(goto cmdlbl(feil))

start:
             chgvar     var(&dta)   value('LO802C_' *cat +
                            %sst(&svar 1 2))
             rtvdtaara  dtaara(&dta) rtnvar(&d)
             monmsg     msgid(cpf1015) exec(do)
               crtdtaara  dtaara(&dta) type(*char) len(200) +
                          value('         ') text('Faste +
                          linjer til sms-meld vedr varemottak')
               goto     cmdlbl(start)
             enddo

             chgvar     var(&l1)  value(%sst(&d   1 35))
             chgvar     var(&l2)  value(%sst(&d  36 35))
             chgvar     var(&l6)  value(%sst(&d  71 35))
             chgvar     var(&l7)  value(%sst(&d 106 35))
             chgvar     var(&avs) value(%sst(&d 141 11))

             sndrcvf    rcdfmt(bilde)

             if         cond(&in03)  then(goto cmdlbl(end))

             chgvar     var(%sst(&d   1 35)) value(&l1)
             chgvar     var(%sst(&d  36 35)) value(&l2)
             chgvar     var(%sst(&d  71 35)) value(&l6)
             chgvar     var(%sst(&d 106 35)) value(&l7)
             chgvar     var(%sst(&d 141 11)) value(&avs)
             chgdtaara  dtaara(&dta (1 200)) value(&d)
             goto       cmdlbl(end)
 FEIL:
             chgvar     var(&m1) value('Lagernummer er feil tastet +
                                               ')
             chgvar     var(&m2) value('Forsøk på nytt            +
                                                             ')
             goto        cmdlbl(ny)

/*                                                                   */
 END:        ENDPGM
