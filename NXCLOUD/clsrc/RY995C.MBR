
/* Behandler tabeller i VA databibliotek for EVR databibliotek       */

             PGM        PARM(&DLIB &ELIB)

             DCL        VAR(&DLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&ELIB) TYPE(*CHAR) LEN(10)

             DCL        VAR(&NULL) TYPE(*CHAR) LEN(1) VALUE(' ')

/* Går direkte til oppdatering av EVR-databibliotek dersom           */
/* VA databibliotek ikke er oppgitt                                  */

             IF         COND(&DLIB *EQ '          ') THEN(GOTO +
                          CMDLBL(EVR))

/* Behandler VA databibliotek                                        */

/* Setter VA databibliotek til current library                       */

             CHGCURLIB  CURLIB(&DLIB)

/* Sletter utgåtte tabeller og I-indekser                            */

             DLTF       FILE(&DLIB/JPRI*)
             MONMSG     MSGID(CPF2125)

             DLTF       FILE(&DLIB/JSOR*)
             MONMSG     MSGID(CPF2125)

             DLTF       FILE(&DLIB/JVGR*)
             MONMSG     MSGID(CPF2125)

             DLTF       FILE(&DLIB/JVARI*)
             MONMSG     MSGID(CPF2125)

             DLTF       FILE(&DLIB/JVPRI*)
             MONMSG     MSGID(CPF2125)

/* Oppdaterer tabeller og indekser                                   */

             CALL       PGM(AG905C) PARM('JVPKPF' &DLIB &NULL)

             CALL       PGM(AG902C) PARM('JVSOST' &DLIB &NULL)

             CALL       PGM(AG905C) PARM('JSTSPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JRAPPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JRFIPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JRVAPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JRVGPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JVRCPF' &DLIB &NULL)

             CALL       PGM(AG905C) PARM('JLEVPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JPROPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JMODPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JMSDPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JMSTPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JMTXPF' &DLIB &NULL)

             CALL       PGM(AG905C) PARM('JVARPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JVDTPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JVPRPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JSOKPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JWPRPF' &DLIB &NULL)

             CALL       PGM(AG905C) PARM('JBETPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JRAEPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JPFAPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JFORPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JKAHPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JKAVPF' &DLIB &NULL)
             CALL       PGM(AG905C) PARM('JMATPF' &DLIB &NULL)

             CALL       PGM(AG907C) PARM('NIDEPF' &DLIB &NULL)
             CALL       PGM(AG907C) PARM('NIMOPF' &DLIB &NULL)
             CALL       PGM(AG907C) PARM('NIPRPF' &DLIB &NULL)
             CALL       PGM(AG907C) PARM('NIVAPF' &DLIB &NULL)
             CALL       PGM(AG907C) PARM('NIVGPF' &DLIB &NULL)
             CALL       PGM(AG907C) PARM('NIVPPF' &DLIB &NULL)

             DLTF       FILE(&DLIB/PCINTPF)
             MONMSG     MSGID(CPF2125)

             CRTPF      FILE(&DLIB/PCINTPF) SRCFILE(QDDFSRC) +
                          SIZE(*NOMAX) REUSEDLT(*NO) +
                          SRTSEQ(*LANGIDUNQ) LANGID(NOR)

/* Kjører oppdateringsprogrammer                                     */

             CALL       PGM(RY994R) /* Oppdaterer leverandør */
             CALL       PGM(RY997R) /* Oppdaterer produsent */
             CALL       PGM(RY998R) /* Oppdaterer statusregister */

             CALL       PGM(RY999R) /* Legger inn nye +
                          recordformat/rapportører */

/* Endrer beskrivelse av VA databibliotek                           */

             CHGLIB     LIB(&DLIB) TEXT('ASP Databibliotek VA     - +
                          V5.40')

/* Behandler EVR databibliotek                                       */

/* Setter EVR databibliotek til current library                      */

             CHGCURLIB  CURLIB(&ELIB)

/* Kaller CL-program for oppdatering av tabeller og indekser         */

 EVR:        CALL       PGM(RY996C) PARM(&ELIB)

/* Oppretter vare-søketekst i VA                                     */

             CALL       PGM(RY995R) /* Oppretter vare-søketekst */

 END:        ENDPGM
