             PGM         PARM(&FILE &ANTA)

/* Definering av parametre.                                          */

             DCL        VAR(&FILE) TYPE(*CHAR) LEN(30)
             DCL        VAR(&FEIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&ANTA) TYPE(*DEC)  LEN(5 0)

/* Definering av variable                                            */

             DCL        VAR(&CLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&IFIL) TYPE(*CHAR) LEN(50) VALUE(' ')
             DCL        VAR(&DFIL) TYPE(*CHAR) LEN(70)

/*           MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))       */

/* Henter current library                                            */

             RTVJOBA    CURLIB(&CLIB)

/* Oppretter temporær fil og kopierer motatt fil inn i denne         */

             DLTF       FILE(EXLTEMP)
             MONMSG     MSGID(CPF2105)
             CRTPF      FILE(EXLTEMP) RCDLEN(256) TEXT('Temporær +
                          fil') SIZE(*NOMAX)
/*           CHGVAR     VAR(&IFIL) VALUE('/home/ADBTLS' *TCAT '/' *TCAT &FILE)  */

             CHGVAR     VAR(&DFIL) VALUE('/qsys.lib/' *TCAT &CLIB +
                          *TCAT '.lib/EXLTEMP.file/EXLTEMP.mbr')
             CPYFRMSTMF FROMSTMF(&FILE) TOMBR(&DFIL) MBROPT(*REPLACE)

/* Behandler mottatt fil                                             */

             CPYF       FROMFILE(EXLTEMP) TOFILE(LWEXPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)

             CALL       PGM(JV163R) PARM(&ANTA)

             GOTO       CMDLBL(END)

 FEIL:       CHGVAR     VAR(&FEIL) VALUE('1')

 END:        ENDPGM
