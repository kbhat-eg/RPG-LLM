             PGM

/* Initiering av parametre.                                          */

             DCL        VAR(&FIRM)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&BTCH)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&MEMBX) TYPE(*CHAR) LEN(5)
             DCL        VAR(&MEMB)  TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&WMM1)  TYPE(*CHAR) LEN(10) VALUE('FACT    ')
             DCL        VAR(&AJOR)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&FORM)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&TYPE)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&MAPI)  TYPE(*CHAR) LEN(25)
             DCL        VAR(&FILN)  TYPE(*CHAR) LEN(25)

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (944 03)) RTNVAR(&FIRM)
             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (864 5))  RTNVAR(&MEMBX)
             RTVDTAARA  DTAARA(*LDA (472 1))  RTNVAR(&AJOR)
             RTVDTAARA  DTAARA(*LDA (473 10))  RTNVAR(&FORM)

/*           CHGVAR     VAR(&MEMB) VALUE(&MEMBX)                     */
             CHGVAR     VAR(%SST(&WMM1 5 3)) VALUE(&FIRM)

/* Varselbilde 2                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Leggger ut regnskapspost.')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Bygger membere dersom de ikke finnes                              */

             IF         COND(&AJOR *EQ 'J') THEN(DO)


/* Tøm filer                                                         */

             CLRPFM     FILE(REFAPF)
             CLRPFM     FILE(REKUPF)
             CLRPFM     FILE(REF2PF)
             CLRPFM     FILE(REK2PF)

/* Overstyring av databasefiler                                      */

             OVRDBF     FILE(RKWBL1) MBR(&WMM1)
             OVRDBF     FILE(RKWBL2) MBR(&WMM1)

/* Legg ut regnskapsposter                                           */

             CALL       PGM(RK684R) PARM(&WMM1)


             ENDDO

/* Legg ut poster til Factoringselkapet                              */

             CALL       PGM(RK685R)

             DLTOVR     FILE(RKWBL1)
             DLTOVR     FILE(RKWBL2)

/* Overfør til Elcon                                                 */

             IF         COND(&FORM *EQ 'ELCON     ') THEN(DO)
             CALL       PGM(RK711R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Elcon')
             CHGVAR     VAR(&FILN)     VALUE('EFTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Elcon')
             CHGVAR     VAR(&FILN)     VALUE('EFKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til Entra                                                 */

             IF         COND(&FORM *EQ 'ENTRA     ') THEN(DO)
             CALL       PGM(RK712R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Entra')
             CHGVAR     VAR(&FILN)     VALUE('ENTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Entra')
             CHGVAR     VAR(&FILN)     VALUE('ENKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til Nordea                                                */

             IF         COND(&FORM *EQ 'NORDEA    ') THEN(DO)
             CALL       PGM(RK713R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Nordea')
             CHGVAR     VAR(&FILN)     VALUE('NOTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Nordea')
             CHGVAR     VAR(&FILN)     VALUE('NOKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til FactoNor                                              */

             IF         COND(&FORM *EQ 'FACTONOR  ') THEN(DO)
             CALL       PGM(RK715R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Fonor ')
             CHGVAR     VAR(&FILN)     VALUE('FNTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Fonor ')
             CHGVAR     VAR(&FILN)     VALUE('FNKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til SG Factoring                                          */

             IF         COND(&FORM *EQ 'SGFACT    ') THEN(DO)
             CALL       PGM(RK716R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_SGFact')
             CHGVAR     VAR(&FILN)     VALUE('SGTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_SGFact')
             CHGVAR     VAR(&FILN)     VALUE('SGKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til SpareBank1 Finans                                     */

             IF         COND(&FORM *EQ 'SPB1FIN   ') THEN(DO)
             CALL       PGM(RK717R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_SPB1Fin')
             CHGVAR     VAR(&FILN)     VALUE('SBTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_SPB1Fin')
             CHGVAR     VAR(&FILN)     VALUE('SBKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til SkanKred                                              */

             IF         COND(&FORM *EQ 'SKANKRED  ') THEN(DO)
             CALL       PGM(RK718R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_SkanKred')
             CHGVAR     VAR(&FILN)     VALUE('SKTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_SkanKred')
             CHGVAR     VAR(&FILN)     VALUE('SKKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO

/* Overfør til Intrum Justitia                                       */

             IF         COND(&FORM *EQ 'INTRUM    ') THEN(DO)
             CALL       PGM(RK719R)

             CHGVAR     VAR(&TYPE)     VALUE('T')          /* Trans  */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Intrum'  )
             CHGVAR     VAR(&FILN)     VALUE('IJTRANS.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)

             CHGVAR     VAR(&TYPE)     VALUE('K')          /* Kunder */
             CHGVAR     VAR(&MAPI)     VALUE('Fact_Intrum  ')
             CHGVAR     VAR(&FILN)     VALUE('IJKUNDE.DAT')
             CALL       PGM(RK720C)    PARM(&TYPE &MAPI &FILN)
             ENDDO


 END:        ENDPGM
