             PGM        PARM(&WPPARM)
             DCL        VAR(&WPPARM) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILGRP) TYPE(*CHAR) LEN(3) VALUE('   ')
             DCL        VAR(&WPLIBL) TYPE(*CHAR) LEN(575)
/*                                                                   */
             DCL        VAR(&WPTELL) TYPE(*DEC) LEN(3 0) VALUE(1)
             DCL        VAR(&WPBIBL) TYPE(*CHAR) LEN(10) VALUE('          ')
/*                                                                   */
             DCL        VAR(&WPMELD) TYPE(*CHAR) LEN(50)
/*                                                                   */
/* Hente inn fra LDA                                                 */
/*                                                                   */
             RTVDTAARA  DTAARA(*LDA (931 3)) RTNVAR(&FILGRP)
/*                                                                   */
/* Sjekk om filegruppe er fylt ut                                    */
/*                                                                   */
             IF         COND(&FILGRP *EQ '   ') THEN(DO)
             CHGVAR     VAR(&WPPARM) VALUE('9')
             CHGVAR     VAR(&WPMELD) VALUE('Filegruppe finnes ikke +
                          lagt opp for denne bruker')
             CALL       PGM(AA005R) PARM(&WPMELD)
             GOTO       CMDLBL(END)
             ENDDO
/*                                                                   */
/* Henter inn brukerdelen av bibliotekslisten                        */
/*                                                                   */
             RTVJOBA    USRLIBL(&WPLIBL)
/*                                                                   */
 SCAN:       CHGVAR     VAR(&WPBIBL) VALUE(%SST(&WPLIBL &WPTELL 10))
/*                                                                   */
             IF         COND(&WPBIBL *EQ 'ASOFAK630') THEN(GOTO +
                          CMDLBL(END))
/*                                                                   */
             IF         COND(&WPTELL *GE 260) THEN(DO)
             CHGVAR     VAR(&WPPARM) VALUE('9')
             CHGVAR     VAR(&WPMELD) VALUE('Bibliotek ASOFAK620 er +
                                            ikke i bibliotekslisten')
             CALL       PGM(AA005R) PARM(&WPMELD)
             GOTO       CMDLBL(END)
             ENDDO
/*                                                                   */
             CHGVAR     VAR(&WPTELL) VALUE(&WPTELL + 11)
             GOTO       CMDLBL(SCAN)
/*                                                                   */
 END:        ENDPGM
