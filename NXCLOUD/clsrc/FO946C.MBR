             PGM        PARM(&PARM)

/* Definering av parametere og variable                              */

/*6.nu*/     DCL        VAR(&PARM)     TYPE(*CHAR) LEN(34)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&BGIR)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&KOPI)     TYPE(*CHAR) LEN(1)

/* Hente inn fra LDA                                                 */

             RTVDTAARA  DTAARA(*LDA (881 1))  RTNVAR(&BGIR)

/* Overstyring av printerfile                                        */

             CALL       PGM(AP601C)    PARM('FO946P' &BTCH)

/* Kaller opp program for faktura                                    */

             CALL       PGM(FO946R)    PARM(&PARM)

/* Hvis det kjøres PROA u/arkiv må vi håndtere ekstra papirkopier    */
/* forskjellig fra interform.                                        */

/* Hente inn fra LDA                                                 */
             RTVDTAARA  DTAARA(*LDA (641 1))  RTNVAR(&KOPI)
             IF         COND(&KOPI *EQ '1') THEN(DO)
             CALL       PGM(FO946R)    PARM(&PARM)
             ENDDO

             CALL       PGM(AP606C)    PARM('FO946P')

             ENDPGM
