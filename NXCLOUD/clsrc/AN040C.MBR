 START:      PGM
             DCL        VAR(&VALG)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&MLD2)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&SVAR)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN12)     TYPE(*DEC)  LEN(1 0)

/* Varsle om at QSTRUP-programmet vil bli ajourført                  */

             CHGVAR     VAR(&MLD1)     VALUE('Obs!  QSTRUP-programmet +
                                       vil bli oppdatert ...')
             CHGVAR     VAR(&MLD2)     VALUE('Bekreft dersom dette +
                                       skal utføres...')
             CHGVAR     VAR(&SVAR)     VALUE('N')
             CALL       PGM(AA007R)    PARM(&MLD1 &MLD2 &SVAR &IN12)

             IF         COND(&IN12 *EQ 1)   THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&SVAR *EQ 'N') THEN(GOTO CMDLBL(ENDPGM))

             RTVCLSRC   PGM(QSYS/QSTRUP) SRCFILE(ASPGPLK/QCLLESRC)
             OVRDBF     FILE(QCLLESRC) TOFILE(ASPGPLK/QCLLESRC) +
                          MBR(QSTRUP)

/* Call til RPG-program                                              */

             CALL       PGM(AN040R) PARM(&VALG)

             IF         COND(&VALG *EQ '1') THEN(DO)
             GOTO       CMDLBL(SLUTT)
             ENDDO

             RMVM       FILE(ASPGPLK/QCLLESRC) MBR(QSTRUPGM)
             MONMSG     MSGID(CPF7310)
             RNMM       FILE(ASPGPLK/QCLLESRC) MBR(QSTRUP) +
                          NEWMBR(QSTRUPGM)
             ADDPFM     FILE(ASPGPLK/QCLLESRC) MBR(QSTRUP) TEXT('Asp +
                          kundetilpasset QSTRUP') SRCTYPE(CLLE)
             OVRDBF     FILE(QCLASP) TOFILE(ASPGPLK/QCLLESRC) +
                          MBR(QSTRUPGM)

             CALL       PGM(AN042R)

/* Create program                                                    */

             DLTOVR     FILE(QCLLESRC QCLASP)

 SLUTT:      CRTBNDCL   PGM(QSYS/QSTRUP) SRCFILE(ASPGPLK/QCLLESRC) +
                          TEXT('ASP Kundetilpasset QSTRUP') +
                          OPTION(*NOXREF *NOSECLVL)

 ENDPGM:     ENDPGM
