/* Endret 18.09.02/HFL: Program KNVKNRC døpt om til IO792C          */

/* Programmet benytte for å finne riktig program for bytting         */
/* av kundenr i registre i ASOFAK, ASSHOP, ASSTAT og ASSERV          */

 STRPGM:     PGM        PARM(&FIRM &GKUN &KUND)

             DCL        VAR(&FIRM) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&GKUN) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&KUND) TYPE(*DEC) LEN(6 0)

             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)

/*           Sjekk om program for ASOFAK finnes                      */

             CHKOBJ     OBJ(*LIBL/FO790R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASSHOP)

             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASOFAK ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(FO790R)    PARM(&FIRM &GKUN &KUND)

 ASSHOP:

/*           Sjekk om program for ASSHOP finnes                      */

             CHKOBJ     OBJ(*LIBL/BO790R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASSTAT)

             CHGVAR     VAR(&WALI) VALUE(6)
             CHGVAR     VAR(&WAPO) VALUE(40)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASSHOP ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(BO790R)    PARM(&FIRM &GKUN &KUND)

 ASSTAT:

/*           Sjekk om program for ASSTAT finnes                      */

             CHKOBJ     OBJ(*LIBL/SF790R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASSERV)

             CHGVAR     VAR(&WALI) VALUE(8)
             CHGVAR     VAR(&WAPO) VALUE(36)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASSTAT ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(SF790R)    PARM(&FIRM &GKUN &KUND)

 ASSERV:

/*           Sjekk om program for ASSERV finnes                      */

             CHKOBJ     OBJ(*LIBL/IO792C) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ENDPGM)

             CHGVAR     VAR(&WALI) VALUE(8)
             CHGVAR     VAR(&WAPO) VALUE(36)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASSERV ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(IO792C) PARM(&FIRM &GKUN &KUND)

 ENDPGM:     ENDPGM
