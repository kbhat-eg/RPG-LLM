             PGM
/*                                                                   */
             DCL        VAR(&FFIR)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&WMMA)  TYPE(*CHAR) LEN(10) VALUE('AUTOG   ')
             DCL        VAR(&WMMB)  TYPE(*CHAR) LEN(10) VALUE('AUTOG   ')
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
/*                                                                   */
/* Henter verdier i fra LDA.                                         */
/*                                                                   */
             RTVDTAARA  DTAARA(*LDA (944 3)) RTNVAR(&FFIR)
             CHGVAR     VAR(%SST(&WMMA 6 3)) VALUE(&FFIR)
             CHGVAR     VAR(%SST(&WMMB 5 3)) VALUE(&FFIR)
/* Sjekk om det finnes poster for vedlikehold av kontroll-varsel     */
             CHKOBJ     OBJ(RKWCPF) OBJTYPE(*FILE) MBR(&WMMA)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             CHGVAR     VAR(&WALI) VALUE(14)
             CHGVAR     VAR(&WAPO) VALUE(2)
             CHGVAR     VAR(&MLD1) VALUE('Kontroll-varsel finnes ikke')
             CHGVAR     VAR(&MLD2) VALUE('Rutinen avsluttes!!    ****')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             DLYJOB     DLY(5)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
/*                                                                   */
/* Bygger membere dersom de ikke finnes                              */
/*                                                                   */
             CHKOBJ     OBJ(RKWAPF) OBJTYPE(*FILE) MBR(&WMMB)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RKWAPF) MBR(&WMMB) TEXT('Parameter for +
                          autogiro (RK811R)')
             ENDDO
/*                                                                   */
             CHKOBJ     OBJ(RKWCPF) OBJTYPE(*FILE) MBR(&WMMA)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RKWCPF) MBR(&WMMA) TEXT('Poster fra +
                          autogiro-kontroll')
             ENDDO
             CHKOBJ     OBJ(RKWCLU) OBJTYPE(*FILE) MBR(&WMMA)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(RKWCLU) MBR(&WMMA) DTAMBRS((RKWCPF +
                          (&WMMA))) TEXT('Poster fra +
                          autogiro-kontroll')
             ENDDO
             CHKOBJ     OBJ(RKWCL2) OBJTYPE(*FILE) MBR(&WMMA)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(RKWCL2) MBR(&WMMA) DTAMBRS((RKWCPF +
                          (&WMMA))) TEXT('Poster fra +
                          autogiro-kontroll')
             ENDDO
/*                                                                   */
/* Call av kundevedlikehold for inkassovarsel                        */
/*                                                                   */
             OVRDBF     FILE(RKWCLU) TOFILE(*LIBL/RKWCLU) MBR(&WMMA)
             OVRDBF     FILE(RKWCPF) TOFILE(*LIBL/RKWCPF) MBR(&WMMA)
             CALL       PGM(RK818R)
             DLTOVR     FILE(RKWCPF)
/*                                                                   */
 ENDPGM:     ENDPGM
