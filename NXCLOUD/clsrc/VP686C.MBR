             PGM        PARM(&FIRM &KUNR &KPRO)
/*------------------------------------------------------------------------*/
/* 8.01 210222 bsa Innfører switch om det skal være med tilbudspriser     */
/* 8.02 210222 bsa Innfører switch om det skal være med skaffevarer       */
/*                                                                        */
/*                                                                        */
/*                                                                        */
/*------------------------------------------------------------------------*/

/* Definering av parametre                                           */

             DCL        VAR(&FIRM) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&KUNR) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&KPRO) TYPE(*DEC) LEN(6 0)

/* Definering av variable                                            */

             DCL        VAR(&TMST) TYPE(*CHAR) LEN(20)

             DCL        VAR(&RKAT) TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&RFM1) TYPE(*CHAR) LEN(10)
             DCL        VAR(&VSOR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OGRP) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&HGRP) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&UGRP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&LDOR) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&RFM2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SKAF) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&TILB) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&UTXT) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&UBPR) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&LTYP) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&PDAT) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LAGE) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&FNAV) TYPE(*CHAR) LEN(10)

/*8.01*/     dcl        var(&fgr)       type(*char) len(3)
/*8.01*/     dcl        var(&fix)       type(*char) len(3)
/*8.01*/     dcl        var(&fir)       type(*dec)  len(3 0) value(0)
/*8.01*/     dcl        var(&lag)       type(*dec)  len(3 0) value(0)

/*8.01*/     DCL        VAR(&CO402_KEY) TYPE(*CHAR) LEN(50)
/*8.01*/     DCL        VAR(&CO402_V1)  TYPE(*CHAR) LEN(1)
/*8.01*/     DCL        VAR(&CO402_V2)  TYPE(*CHAR) LEN(2048)

/*8.01*/     rtvdtaara  dtaara(*lda (931 3)) rtnvar(&fgr)
/*8.01*/     rtvdtaara  dtaara(*lda (944 3)) rtnvar(&fix)
/*8.01*/     chgvar     var(&fir)   value(&fix)

/* Setter inn faste verdier                                          */

             CHGVAR     VAR(&RKAT) VALUE(000)
             CHGVAR     VAR(&RFM1) VALUE('          ')
             CHGVAR     VAR(&VSOR) VALUE('TOTAL     ')
             CHGVAR     VAR(&OGRP) VALUE(00)
             CHGVAR     VAR(&HGRP) VALUE(00)
             CHGVAR     VAR(&UGRP) VALUE(000)
             CHGVAR     VAR(&LDOR) VALUE(0)
             CHGVAR     VAR(&RFM2) VALUE('BYGGDATA  ')
             CHGVAR     VAR(&SKAF) VALUE(0)
             CHGVAR     VAR(&TILB) VALUE(0)
             CHGVAR     VAR(&UTXT) VALUE(0)
             CHGVAR     VAR(&UBPR) VALUE(0)
             CHGVAR     VAR(&LTYP) VALUE(0)
             CHGVAR     VAR(&PDAT) VALUE('nnnn-nn-nn')
             CHGVAR     VAR(&LAGE) VALUE(00)

/*8.01 Sjekk om det skal med tilbudspris                             */

/*8.01*/     CHGVAR     VAR(&CO402_KEY) VALUE('SMARTKALK_TILBUDSPRIS')
/*8.01*/     CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
/*8.01*/                  &CO402_V1 &CO402_V2)

/*8.01*/     IF         COND(&CO402_V1 *EQ '1') THEN(do)
/*8.01*/     chgvar     var(&tilb)  value(1)
/*8.01*/     enddo

/*8.02 Sjekk om det skal med skaffevarer                             */

/*8.02*/     CHGVAR     VAR(&CO402_KEY) VALUE('SMARTKALK_SKAFFEVARER')
/*8.02*/     CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
/*8.02*/                  &CO402_V1 &CO402_V2)

/*8.02*/     IF         COND(&CO402_V1 *EQ '1') THEN(do)
/*8.02*/     chgvar     var(&skaf)  value(1)
/*8.02*/     enddo

/* Henter dagens dato                                                */

             RTVSYSVAL  SYSVAL(QDATETIME) RTNVAR(&TMST)
             CHGVAR     VAR(%SST(&PDAT 1 4)) VALUE(%SST(&TMST 1 4))
             CHGVAR     VAR(%SST(&PDAT 6 2)) VALUE(%SST(&TMST 5 2))
             CHGVAR     VAR(%SST(&PDAT 9 2)) VALUE(%SST(&TMST 7 2))

/* Kall til styreprogram                                             */

             CALL       PGM(VP686R) PARM(&FIRM &RKAT &KUNR &KPRO +
                          &RFM1 &VSOR &OGRP &HGRP &UGRP &LDOR &RFM2 +
                          &SKAF &TILB &UTXT &UBPR &LTYP &PDAT &LAGE)

 END:        ENDPGM
