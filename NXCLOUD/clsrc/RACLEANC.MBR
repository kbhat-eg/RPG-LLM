/*                                                                   */
/*-------------------------------------------------------------------*/
/* Program for å rydde i RA tabeller                                 */
/*                                                                   */
/* CALL RACLEANC PARM('630')                                      */
/*                                                                   */

             PGM        parm(&FGRP_P)

 /* Parametre                                                         */
             DCL        VAR(&FGRP)      TYPE(*CHAR) LEN(3)
             DCL        VAR(&FGRP_P)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&DBIB)      TYPE(*CHAR) LEN(6) VALUE('ADB400')


 /* Sjekk Parametre                                                    */
             IF         COND(%ADDRESS(&FGRP_P) = *NULL) THEN(DO)
                SNDPGMMSG  MSG('Angi filgruppe.')
                GOTO       END
             ENDDO
             ELSE       (CHGVAR VAR(&FGRP) VALUE(&FGRP_P) )

             IF         COND(&FGRP *EQ ' ') THEN(DO)
                SNDPGMMSG  MSG('Angi filgruppe.')
                GOTO       END
             ENDDO

 /* FGR  */
             CHGVAR     VAR(%SST(&DBIB 4 3)) VALUE(&FGRP)
             CHGCURLIB  CURLIB(&DBIB)

             SNDPGMMSG  MSG('Rydder i ' *CAT &DBIB *CAT '. CURLIB er nå ' +
                          *CAT &DBIB)

                /* SLETTER KOLONNER FRA ÅPEN SPØRRING KUNDER: */
                /*    RKKJAL RKMEMS                           */
             RUNSQL     SQL('DELETE FROM XSQCST WHERE UID IN (SELECT UID +
                          FROM XSQCST WHERE FELT_ID IN (SELECT UID FROM +
                          XSCLST  WHERE NAVN IN ( ''RKKJAL'' , ''RKMEMS'' +
                          )))	') COMMIT(*NONE)

                /* SLETTER KOLONNER FRA ÅPEN SPØRRING KUNDER: */
                /*    RKKJAL RKMEMS                           */
             RUNSQL     SQL('DELETE FROM XSCLST WHERE UID IN (SELECT UID +
                          FROM XSCLST  WHERE NAVN IN ( ''RKKJAL'' , +
                          ''RKMEMS'' ))') COMMIT(*NONE)

 END:        ENDPGM

