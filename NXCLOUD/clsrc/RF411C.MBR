             PGM        PARM(&FGRP &FIRM)
/*                                                                   */
             DCL        VAR(&VALG) TYPE(*CHAR) LEN(1) VALUE(' ')
             DCL        VAR(&BTCH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI) TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO) TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&JOBB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FGRP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FIRM) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FBIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TFIR) TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&TBIB) TYPE(*CHAR) LEN(06) VALUE('ADB   '  )
             DCL        VAR(&SW12) TYPE(*CHAR) LEN(1)
             DCL        VAR(&LEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK) TYPE(*CHAR) LEN(2)
             DCL        VAR(&WIN03) TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&WIN12) TYPE(*DEC)  LEN(1 0)

             CHGVAR     VAR(%SST(&TBIB 4 3)) VALUE(&FGRP)
             CHGVAR     VAR(&TFIR) VALUE(&FIRM)

/* Oppdaterer LDA med programnavn og kode for om formularparametre   */
/* skal endres.                                                      */

             CHGDTAARA  DTAARA(*LDA (844 1))  VALUE(&VALG)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL) VALUE('40')
             CHGVAR     VAR(&OKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Hente inn fra LDA                                                 */

             RTVDTAARA  DTAARA(*LDA (934 10)) RTNVAR(&FBIB)
             RTVDTAARA  DTAARA(*LDA (984 1))  RTNVAR(&SW12)

/*  Vedlikekold m/kopiering av koder                                 */

             OVRDBF     FILE(AFIRL1) TOFILE(&TBIB/AFIRL1)
             OVRDBF     FILE(RAA1LU) TOFILE(&TBIB/RAA1LU)
             OVRDBF     FILE(RAA2LU) TOFILE(&TBIB/RAA2LU)
             OVRDBF     FILE(RAA3LU) TOFILE(&TBIB/RAA3LU)
             OVRDBF     FILE(RAA4LU) TOFILE(&TBIB/RAA4LU)
             OVRDBF     FILE(RAA5LU) TOFILE(&TBIB/RAA5LU)
             OVRDBF     FILE(RAA6LU) TOFILE(&TBIB/RAA6LU)
             OVRDBF     FILE(RAA7LU) TOFILE(&TBIB/RAA7LU)
             CALL       PGM(RF411R) PARM(&SW12 &TFIR)

 ENDPGM:     ENDPGM
