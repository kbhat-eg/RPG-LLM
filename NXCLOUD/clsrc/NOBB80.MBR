             PGM

/*    OBS filnavn er case sensitive                                           */
/*    bruk lower case på **xml** extension                                    */
/*    Vareeksport_1-40029-26042019-093001704.xml   (ikke XML)                 */

/*   Legg xml fil(er) i mappen /home/asp/xml/til_alle_80/                     */
/*    kjør      CALL       PGM(NOBB80)                                        */
/*   xml filer blir kopiert til alle 8.0 mapper                               */

             DCL        VAR(&NOBB80)  TYPE(*DEC) LEN(1 0) VALUE(2)
             DCL        VAR(&COMMAND) TYPE(*CHAR) LEN(100)

             DCLF       file(axmlpf)

             CHGCURDIR  dir('/home/asp/xml/til_alle_80/')

 NYFILG:     rcvf
             monmsg     msgid(CPF0864) exec(do)
                goto       cmdlbl(ferdig)
             enddo

             if         cond(&AXMVER *NE &NOBB80) then(goto cmdlbl(NYFILG))

/*              kommandoen er case sensitiver *.xml                          */
             CHGVAR     VAR(&COMMAND) VALUE('cp +
                          /home/asp/xml/til_alle_80/*.xml ' *CAT +
                          %trim(&AXMXFL))

             QSH        CMD(&COMMAND)

             goto       cmdlbl(NYFILG)

 ferdig:     CHGVAR     VAR(&COMMAND) VALUE('for file in *.xml; do mv +
                          "$file" "$(basename $file)ferdig"; done')
             QSH        CMD(&COMMAND)

 end:        ENDPGM
