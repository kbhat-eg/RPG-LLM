             PGM        PARM(&LIST &MEMB)

/* Definering av parametre og variable                               */

             DCL        VAR(&LIST)     TYPE(*CHAR) LEN(128)
             DCL        VAR(&MEMB)     TYPE(*CHAR) LEN(9)

             DCL        VAR(&WSID)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRTF)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (846 10)) RTNVAR(&PRTF)
             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)

/* Overstyring av printerfile                                        */

             CALL       PGM(AP601C)    PARM(&PRTF &BTCH)

/* Oppretter member i arbeidsfil                                     */

             ADDPFM     FILE(WOHEPF)   MBR(&MEMB)
             ADDLFM     FILE(WOHEL9)   MBR(&MEMB) DTAMBRS((WOHEPF +
                          (&MEMB)))
             ADDLFM     FILE(WOHEL8)   MBR(&MEMB) DTAMBRS((WOHEPF +
                          (&MEMB)))

/* Overstyrer database                                               */
             OVRDBF     FILE(WOHEPF)   MBR(&MEMB)
             OVRDBF     FILE(WOHEL9)   MBR(&MEMB)
             OVRDBF     FILE(WOHEL8)   MBR(&MEMB)

/* Utskrift                                                          */
             CALL       PGM(FP802R)    PARM(&LIST)
             CALL       PGM(FP811R)    PARM(&LIST)

/* Sender melding dersom bakgrunnsjobb                               */

             IF         COND(&BTCH *EQ '1') THEN(DO)
             RTVDTAARA  DTAARA(*LDA (901 10)) RTNVAR(&WSID)
             SNDBRKMSG  MSG('ASOFAK: Utskrift av tilbudsstatistikk +
                           er ferdig') TOMSGQ(&WSID)
             ENDDO
/* Fjerner member                                                    */

             RMVM       FILE(WOHEL9)   MBR(&MEMB)
             RMVM       FILE(WOHEL8)   MBR(&MEMB)
             RMVM       FILE(WOHEPF)   MBR(&MEMB)

             CALL       PGM(AP606C)    PARM(&PRTF)
 END:        ENDPGM
