
             PGM        PARM(&WWAKTI)

             DCL        VAR(&LINJ) TYPE(*DEC) LEN(2 0) VALUE(2)
             DCL        VAR(&POSI) TYPE(*DEC) LEN(3 0) VALUE(43)
             DCL        VAR(&IN03) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&VALG) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KODE) TYPE(*DEC) LEN(1 0) VALUE(0)

             DCL        VAR(&PGM) TYPE(*CHAR) LEN(10) +
                          VALUE('BANK      ')
             DCL        VAR(&TYPE) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&WWAKTI) TYPE(*CHAR) LEN(1) VALUE(' ')
             DCL        VAR(&AKTI) TYPE(*DEC) LEN(1 0)

             CHGVAR     VAR(&TYPE) VALUE('1')
             CHGVAR     VAR(&AKTI) VALUE('0')

          CALL       PGM(GLCHKPGM) PARM(&PGM &TYPE &AKTI)

/*        Programmet er aktivt!                                      */

          IF   COND(&AKTI *EQ 1) THEN(DO)

             CHGVAR     VAR(&WWAKTI) VALUE('1')

/* Sender opp informasjonsbilde om at program allerede er aktivt:    */

             CHGVAR     VAR(&VALG) VALUE('4')
             CALL       PGM(GL124R) PARM(&IN03 &VALG &LINJ +
                          &POSI &KODE)
          ENDDO

/*        Programmet er IKKE aktivt, og settes AKTIVT!               */

          IF   COND(&AKTI *EQ 0) THEN(DO)

             CHGVAR     VAR(&TYPE) VALUE('0')
             CHGVAR     VAR(&WWAKTI) VALUE(' ')
             CALL       PGM(GLCHKPGM) PARM(&PGM &TYPE &AKTI)

          ENDDO

             ENDPGM
