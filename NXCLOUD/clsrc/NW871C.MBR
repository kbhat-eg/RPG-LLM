             PGM        PARM(&FEIL &MEMB)

/* Initiering av parametre.                                          */

             DCL        VAR(&FEIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&MEMB) TYPE(*CHAR) LEN(10)

             DCL        VAR(&MEMB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVRF) TYPE(*CHAR) LEN(10) VALUE('NBSWAP')
             DCL        VAR(&STAT) TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILN) TYPE(*CHAR) LEN(20)
             DCL        VAR(&SMSG) TYPE(*CHAR) LEN(1)  VALUE('0')

             DLTOVR     FILE(NETWAP) LVL(*JOB)

/* Avbryter dersom feil i innlesingen fra WAP                        */

             IF         COND(&FEIL = '1') THEN(GOTO CMDLBL(END))

/* Kopierer til member for sending med activ-sjekk                   */

             CPYF       FROMFILE(NETWAP) TOFILE(NETWAP) +
                          FROMMBR(&MEMB) TOMBR(NETWAP) MBROPT(*ADD)

/* Sender til nettbutikk via FTP                                     */

             CHGVAR     VAR(&FILN) VALUE(&MEMB)

             CALL       PGM(AF700C) PARM(&OVRF &STAT &FILN &SMSG)

             IF         COND(&STAT *EQ ' ') THEN(CHGVAR VAR(&STAT) +
                          VALUE('0'))

/* Dersom overføringen er OK, tømmes overføringsfil                  */

             IF         COND(&STAT *EQ '0') THEN(DO)
             CLRPFM     FILE(NETWAP) MBR(NETWAP)
             ENDDO

/* Fjerner arbeidsmember                                             */

 END:        RMVM       FILE(NETWAP) MBR(&MEMB)

             ENDPGM
