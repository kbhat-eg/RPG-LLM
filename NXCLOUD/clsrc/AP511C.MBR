             PGM        PARM(&key &sjek &stat)

             DCL        VAR(&DTAQ) TYPE(*CHAR) LEN(10) VALUE(GEMCREQ)
             DCL        VAR(&DTAQLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FLDLEN) TYPE(*DEC) LEN(4 0) VALUE(1000)
             DCL        VAR(&FIELD) TYPE(*CHAR) LEN(1000)
             DCL        VAR(&WTIM)  TYPE(*DEC) LEN(5 0) value(60)
             DCL        VAR(&KLEN)  TYPE(*DEC) LEN(3 0) value(10)
             DCL        VAR(&SLEN)  TYPE(*DEC) LEN(3 0) value(0)
             DCL        VAR(&KEY) TYPE(*CHAR) LEN(10)
             DCL        VAR(&sjek) TYPE(*CHAR) LEN(64)
             DCL        VAR(&stat) TYPE(*CHAR) LEN(1)

             RTVJOBA    CURLIB(&DTAQLIB)

             CHGVAR     VAR(&FIELD) VALUE(&KEY *CAT &sjek)

             CALL       PGM(QSNDDTAQ) PARM(&DTAQ &DTAQLIB &FLDLEN +
                          &FIELD)

/* Vente p√• svar                                                     */

             CHGVAR     VAR(&FIELD) VALUE(' ')
             CHGVAR     VAR(&DTAQ) VALUE('GEMCRES')
             CALL       PGM(QRCVDTAQ) PARM(&DTAQ &DTAQLIB &FLDLEN +
                          &FIELD &WTIM 'EQ' &KLEN &KEY +
                          &SLEN '')

             if         cond(&field *EQ 'true') then(do)
             chgvar     var(&stat) value('1')
             goto       cmdlbl(endpgm)
             enddo

             if         cond(&field *EQ 'false') then(do)
             chgvar     var(&stat) value('2')
             goto       cmdlbl(endpgm)
             enddo

             if         cond(&fldlen *EQ 0) then(do)
             chgvar     var(&stat) value('E')
             goto       cmdlbl(endpgm)
                          /* 'Ikke noe svar innen timeout. Anta +
                          feil.' */
             enddo

/*           SNDPGMMSG  MSG(&FIELD)        */

 ENDPGM:     ENDPGM
