             PGM        PARM(&MEMB)

/* Definering av parametere og variable                              */

             DCL        VAR(&MEMB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&MAIL)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&KULE)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&KUND)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&KPRO)     TYPE(*DEC)  LEN(6 0)
/*6.nu*/     DCL        VAR(&NUMM)     TYPE(*DEC)  LEN(8 0)
             DCL        VAR(&SELG)     TYPE(*DEC)  LEN(4 0)

/* Overstyring av fil                                                */

             OVRDBF     FILE(FPSOL1)   TOFILE(*FILE) MBR(&MEMB)

/* Overstyring av printerfile                                        */

             CALL       PGM(AP601C)    PARM('FO912P' &BTCH)

/* Kaller opp program                                                */

             CALL       PGM(FO912R)    PARM(&MAIL &KUND &KPRO +
                                            &NUMM &SELG)

             DLTOVR     FILE(FPSOL1)

             CALL       PGM(AP606C)    PARM('FO912P')

/* Skal dette sendes som e-mail ?                                    */

             IF         COND(&MAIL *EQ 'J') THEN(DO)
             CHGVAR     VAR(&KULE)     VALUE('K')
             CALL       PGM(FO798C)    PARM(&KULE &KUND &KPRO +
                                         'FO912P' &NUMM &SELG)
             ENDDO

             ENDPGM
