             PGM

/* Initiering av parametre.                                          */

             DCL        VAR(&BTCH)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&PSKR)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&MEMBX) TYPE(*CHAR) LEN(5)
             DCL        VAR(&MEMB)  TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&WMM1)  TYPE(*CHAR) LEN(10) VALUE('RKA      ')
             DCL        VAR(&WMM2)  TYPE(*CHAR) LEN(10) VALUE('RKB      ')

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (864 5))  RTNVAR(&MEMBX)
             CHGVAR     VAR(&MEMB) VALUE(&MEMBX)
             CHGVAR     VAR(%SST(&WMM1 4 5)) VALUE(&MEMB)
             CHGVAR     VAR(%SST(&WMM2 4 5)) VALUE(&MEMB)

/* Varselbilde 2                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Utplukk pågår ...........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Bygger membere dersom de ikke finnes                              */

             CHKOBJ     OBJ(RHWAPF) OBJTYPE(*FILE) MBR(&WMM1)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RHWAPF) MBR(&WMM1) TEXT('Poster til +
                          utskrift pr. journal-nr.')
             ENDDO

             CLRPFM     FILE(RHWAPF) MBR(&WMM1)

/* Utplukking av poster                                              */

             OVRDBF     FILE(RHWAPF) MBR(&WMM1)
             CALL       PGM(RH968R)

/* Utskrift av journalliste                                          */

             CALL       PGM(RH969C)

             DLTOVR     FILE(RHWAPF)
             MONMSG     MSGID(CPF3200)
 END:        ENDPGM
