             PGM        PARM(&MBER &JOKO)

             DCL        VAR(&IN03) TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN12) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BTCH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI) TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO) TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1) TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2) TYPE(*CHAR) LEN(40)

             DCL        VAR(&BTCH)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&MEMBX)  TYPE(*CHAR) LEN(5)
             DCL        VAR(&MEMB)   TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&WMM1)  TYPE(*CHAR) LEN(10) VALUE('RFA      ')
             DCL        VAR(&JOKO) TYPE(*CHAR) LEN(1)

             DCL        VAR(&FIRM)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&MBER)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&INFO)  TYPE(*CHAR) LEN(1)

/* Program for printerstyring                                        */

             CALL       PGM(AP600R) PARM('RF122 ' '1' '0' &IN03 &BTCH)

/* Avslutt dersom F3   *** Fjernet - fungerer ikke riktig           */

       /*    IF         COND(&IN03 *EQ '1') THEN(DO)    */
       /*    GOTO       CMDLBL(ENDPGM)                  */
       /*    ENDDO                                      */

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (864 5))  RTNVAR(&MEMBX)

             CHGVAR     VAR(&MEMB) VALUE(&MEMBX)
             CHGVAR     VAR(%SST(&WMM1 4 5)) VALUE(&MEMB)
/*                                                                   */
/* Varselbilde 1                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(2)
             CHGVAR     VAR(&MLD1) VALUE('OCR Innbetaling..... ... ')
             CHGVAR     VAR(&MLD2) VALUE('**** KUNDERESKONTRO **** ')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Varselbilde 2                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt......')
             CHGVAR     VAR(&MLD2) VALUE('Utplukk pågår ...........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Bygger membere dersom de ikke finnes                              */

/* Innlesing av poster                                               */

/* SST */    CPYF       FROMFILE(GORTPF) TOFILE(*CURLIB/GORTPF_B) +
/* SST */                 MBROPT(*REPLACE) CRTFILE(*Yes)
             monmsg     msgid(cpf0000)
             OVRDBF     FILE(OCRIN) TOFILE(*LIBL/GORTPF)
             CALL       PGM(RF120R) PARM(&WMM1)

/* Tildeler periode                                                  */

             CALL       PGM(RF121R) PARM(&WMM1)

/* Legg ut regnskapsposteringer                                      */

/* Varselbilde 3                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(6)
             CHGVAR     VAR(&WAPO) VALUE(40)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt......')
             CHGVAR     VAR(&MLD2) VALUE('Legger ut posteringer....')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* BYGGER UNIKT MEMBERNØKKEL -> "TELExxx":                         */

/* Hvor xxx = Firmanummer                                            */

             RTVDTAARA  DTAARA(*LDA (944 3)) RTNVAR(&FIRM)
             IF         COND(&MBER *EQ ' ') THEN(DO)
             CHGVAR     VAR(%SST(&MBER 1 4)) VALUE('TELE')
             CHGVAR     VAR(%SST(&MBER 5 3)) VALUE(&FIRM)
             ENDDO

/* Bygger membere dersom de ikke finnes                              */


/* Overide databasefile til aktuelt member                           */


/* Overstyring av printerfile                                        */

             CALL       PGM(AP601C)    PARM('RF122P' &BTCH)

             CALL       PGM(RF122R) PARM(&WMM1 &MBER &JOKO)

             CALL       PGM(AP606C)    PARM('RF122P')

             CALL       PGM(RF702R) PARM(&WMM1)  /* RJOULU */

 ENDPGM:     ENDPGM
