             PGM        parm(&fra &til &v &akt &f1 &f2 &f3 &f4 &f5 &f6 &f7 &f8 &f9 &f10)

             dclf       file(ag936d)

             dcl        var(&fra)    type(*char) len(3)
             dcl        var(&til)    type(*char) len(3)
             dcl        var(&akt)    type(*char) len(1)
             dcl        var(&v)      type(*char) len(3)
             dcl        var(&f1)     type(*char) len(6)
             dcl        var(&f2)     type(*char) len(6)
             dcl        var(&f3)     type(*char) len(6)
             dcl        var(&f4)     type(*char) len(6)
             dcl        var(&f5)     type(*char) len(6)
             dcl        var(&f6)     type(*char) len(6)
             dcl        var(&f7)     type(*char) len(6)
             dcl        var(&f8)     type(*char) len(6)
             dcl        var(&f9)     type(*char) len(6)
             dcl        var(&f10)    type(*char) len(6)
             dcl        var(&f)      type(*char) len(6)
             dcl        var(&lib)    type(*char) len(10)
             dcl        var(&stat)   type(*char) len(10)

             chgvar     var(&w_acli)   value(06)
             chgvar     var(&w_acpo)   value(05)
start:
             sndrcvf    rcdfmt(M1WIN)
             chgvar     var(&in31)    value('0')
             chgvar     var(&in32)    value('0')
             chgvar     var(&in33)    value('0')
             chgvar     var(&in34)    value('0')
             chgvar     var(&in35)    value('0')
             chgvar     var(&in36)    value('0')
             chgvar     var(&in37)    value('0')
             chgvar     var(&in38)    value('0')
             chgvar     var(&in39)    value('0')
             chgvar     var(&in40)    value('0')
             chgvar     var(&in41)    value('0')
             chgvar     var(&in42)    value('0')
             chgvar     var(&in43)    value('0')
             chgvar     var(&in44)    value('0')
/*                                                                   */
/*  Tester p} funksjonstaster                                        */
/*                                                                   */
/*  F3                                                               */
             if         cond(&In03) then(do)
               chgvar   var(&stat)  value('Avslutt')
               goto     cmdlbl(endpgm)
             enddo

/*   Til filgruppe                                                  */
             if         cond(&fra *eq '   ') then(do)
               chgvar     var(&m1mld2) value('Fra filgruppe må oppgis')
               chgvar     var(&in31)    value('1')
               goto       cmdlbl(start)
             enddo
             chgvar     var(&lib) value('ADB' *tcat &fra)

             chkobj     obj(&lib) objtype(*LIB)
             monmsg     msgid(cpf9801) exec(do)
/*  fra filgruppe finnes ikke     */
               chgvar     var(&m1mld2) value('Biblioteket ' *cat &lib +
                          *cat ' finnes ikke.  Reg. fra filgr.')
               chgvar     var(&in31)    value('1')
             goto       cmdlbl(start)

             enddo

/*   Til filgruppe                                                  */
             if         cond(&til *eq '   ') then(do)
               chgvar     var(&m1mld2) value('Til filgruppe må oppgis')
               chgvar     var(&in32)    value('1')
               goto       cmdlbl(start)
             enddo
             chgvar     var(&lib) value('ADB' *tcat &til)

             chkobj     obj(&lib) objtype(*LIB)
             monmsg     msgid(cpf9801) exec(do)
/*  til filgruppe finnes ikke     */
               chgvar     var(&m1mld2) value('Biblioteket ' *cat &lib +
                          *cat ' finnes ikke.  Reg. til filgr.')
               chgvar     var(&in32)    value('1')
               goto       cmdlbl(start)
             enddo

/*   Versjon                                                        */
             if         cond(&v *eq '   ') then(do)
               chgvar     var(&m1mld2) value('Versjon på filen(e) må oppgis')
               chgvar     var(&in43)    value('1')
               goto       cmdlbl(start)
             enddo

/*   Avslutte aktive brukere / jobber                               */
             if         cond(&akt *ne 'J'  *and +
                             &akt *ne 'N') then(do)
               chgvar     var(&m1mld2) value('Avslutte aktive må være J/N')
               chgvar     var(&in44)    value('1')
               goto       cmdlbl(start)
             enddo

/*   Fil1                                                           */
             if         cond(&f1 *eq '   ') then(do)
               chgvar     var(&m1mld2) value('Minst 1 fil må oppgis')
               chgvar     var(&in33)    value('1')
               goto       cmdlbl(start)
             enddo
             chgvar     var(&f)   value(&f1)
             CallSubr   subr(Beh_fil)
             if         cond(&stat *ne '   ') then(do)
               chgvar   var(&in33)      value('1')
               goto     cmdlbl(start)
             enddo
/*   Fil2                                                           */
             if         cond(&f2 *ne '   ') then(do)
               chgvar     var(&f)   value(&f2)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in34)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil3                                                           */
             if         cond(&f3 *ne '   ') then(do)
               chgvar     var(&f)   value(&f3)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in35)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil4                                                           */
             if         cond(&f4 *ne '   ') then(do)
               chgvar     var(&f)   value(&f4)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in36)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil5                                                           */
             if         cond(&f5 *ne '   ') then(do)
               chgvar     var(&f)   value(&f5)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in37)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil6                                                           */
             if         cond(&f6 *ne '   ') then(do)
               chgvar     var(&f)   value(&f6)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in38)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil7                                                           */
             if         cond(&f7 *ne '   ') then(do)
               chgvar     var(&f)   value(&f7)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in39)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil8                                                           */
             if         cond(&f8 *ne '   ') then(do)
               chgvar     var(&f)   value(&f8)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in40)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil9                                                           */
             if         cond(&f9 *ne '   ') then(do)
               chgvar     var(&f)   value(&f9)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in41)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo
/*   Fil10                                                          */
             if         cond(&f10 *ne '   ') then(do)
               chgvar     var(&f)   value(&f10)
               CallSubr   subr(Beh_fil)
               if         cond(&stat *ne '   ') then(do)
                 chgvar   var(&in42)      value('1')
                 goto     cmdlbl(start)
               enddo
             enddo

/* ______________________________________________________________________*/
Subr         Subr(Beh_Fil)
             chgvar     var(&stat)    value('  ')
             if         cond(%sst(&f 5 2) *ne 'ST' *and +
                             %sst(&f 5 2) *ne 'PF') then(do)
               chgvar     var(&m1mld2) value('Filnavn min. 6 +
                                       pos. og slutte på PF eller ST')
               chgvar     var(&stat)    value('Feil1')
               goto       cmdlbl(EndFil)
             enddo

 /*          chkobj     obj(&f) objtype(*file)                            */
 /*          monmsg     msgid(cpf9801) exec(do)                           */
 /*            chgvar     var(&m1mld2) value('File ' *cat &f +            */
 /*                       *tcat ' finnes ikke.  Registrer nytt navn')     */
 /*            chgvar     var(&stat)    value('Feil2')                    */
 /*            goto       cmdlbl(EndFil)                                  */
 /*          enddo                                                        */
EndFil:
EndSubr
/* ______________________________________________________________________*/
/*                                                                   */
/* Slutt                                                             */
 ENDPGM:     ENDPGM
