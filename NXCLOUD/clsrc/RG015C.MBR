             PGM

             DCLF       FILE(RG015D)

             DCL        VAR(&DLIB) TYPE(*CHAR) LEN(6) VALUE('ADBnnn')

             DCL        VAR(&VDOH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VDOL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VDPR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VDRH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VDUT) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VEDD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VEDU) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VREC) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VREF) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VREH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VRER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VRES) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSCL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSCR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSLS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSQC) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSQT) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSQW) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSQY) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSRR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VSIM) TYPE(*CHAR) LEN(1)

             DCL        VAR(&CLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&LEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK) TYPE(*CHAR) LEN(2)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL) VALUE('40')
             CHGVAR     VAR(&OKOK) VALUE('  ')
             CALL       PGM(AA050C) PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Utleder foresl√•tt filgruppe utifra current-library                */

             RTVJOBA    CURLIB(&CLIB)
             CHGVAR     VAR(&FGRP) VALUE(%SUBSTRING(&CLIB 4 3))

/* Viser skjermbilde                                                 */

             SNDRCVF    RCDFMT(A1BLD)

/* F3/F12                                                            */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/* Avbryter dersom filgruppe ikke er valgt                           */

             IF         COND(&FGRP *EQ '   ') THEN(GOTO CMDLBL(ENDPGM))

/* Utleder  databibliotek fra filgruppe                              */

             CHGVAR     VAR(&DLIB) VALUE(%SUBSTRING(&DLIB 1 3) *TCAT +
                          &FGRP)

/* Genererer de valgte tabellene                                     */

             IF         COND(&VDOH *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XDOHST' &DLIB &NULL)
             ENDDO

             IF         COND(&VDOL *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XDOLST' &DLIB &NULL)
             ENDDO

             IF         COND(&VDPR *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XDPRST' &DLIB &NULL)
             ENDDO

             IF         COND(&VDRH *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XDRHST' &DLIB &NULL)
             ENDDO

             IF         COND(&VDUT *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XDUTST' &DLIB &NULL)
             ENDDO

             IF         COND(&VEDD *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XEDDST' &DLIB &NULL)
             ENDDO

             IF         COND(&VEDU *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XEDUST' &DLIB &NULL)
             ENDDO

             IF         COND(&VREC *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XRECST' &DLIB &NULL)
             ENDDO

             IF         COND(&VREF *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XREFST' &DLIB &NULL)
             ENDDO

             IF         COND(&VREH *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XREHST' &DLIB &NULL)
             ENDDO

             IF         COND(&VRER *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XRERST' &DLIB &NULL)
             ENDDO

             IF         COND(&VRES *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XRESST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSCL *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSCLST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSCR *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSCRST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSLS *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSLSST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSQC *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSQCST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSQT *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSQTST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSQW *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSQWST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSQY *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSQYST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSRR *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSRRST' &DLIB &NULL)
             ENDDO

             IF         COND(&VSIM *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XSIMST' &DLIB &NULL)
             ENDDO

 ENDPGM:     ENDPGM
