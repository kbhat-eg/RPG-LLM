
/* Programmet benytte for å finne riktig program                     */
/* for bytting av leverandør i registre i ASOFAK, ASLAGR og ASSTAT   */
/*                                     og ASVADM ASSHOP */

 STRPGM:     PGM        PARM(&FIRM &GLEV &LEVR)

             DCL        VAR(&FIRM) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&GLEV) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&LEVR) TYPE(*DEC) LEN(6 0)

             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)

/*           Sjekk om program for ASOFAK finnes                      */

             CHKOBJ     OBJ(*LIBL/FO791R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASLAGR)

             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASOFAK ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(FO791R)    PARM(&FIRM &GLEV &LEVR)

 ASLAGR:

/*           Sjekk om program for ASLAGR finnes                      */

             CHKOBJ     OBJ(*LIBL/VL791R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASSTAT)

             CHGVAR     VAR(&WALI) VALUE(6)
             CHGVAR     VAR(&WAPO) VALUE(40)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASLAGR ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(VL791R)    PARM(&FIRM &GLEV &LEVR)

 ASSTAT:

/*           Sjekk om program for ASSTAT finnes                      */

             CHKOBJ     OBJ(*LIBL/SI690R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASVADM)

             CHGVAR     VAR(&WALI) VALUE(8)
             CHGVAR     VAR(&WAPO) VALUE(36)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASSTAT ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(SI690R)    PARM(&FIRM &GLEV &LEVR)

 ASVADM:

/*           Sjekk om program for ASVADM finnes                      */

             CHKOBJ     OBJ(*LIBL/JL791R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ENDPGM)

             CHGVAR     VAR(&WALI) VALUE(8)
             CHGVAR     VAR(&WAPO) VALUE(36)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASVADM ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)

             CALL       PGM(JL791R)    PARM(&FIRM &GLEV &LEVR)


 ENDPGM:     ENDPGM
