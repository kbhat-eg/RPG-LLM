             PGM
             DCL        VAR(&JOBB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&USER)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&SBIB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&LEVL)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK)     TYPE(*CHAR) LEN(2)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ERR))
             RTVJOBA    JOB(&JOBB)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL)     VALUE('20')
             CHGVAR     VAR(&OKOK)     VALUE('  ')
             CALL       PGM(AA050C)    PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(END)
             ENDDO

/* Endre biblioteksliste                                             */

             CHGCURLIB  CURLIB(ADB)

/* Call til program                                                  */

             CALL       PGM(AN030R)

/* Hente inn fra LDA                                                 */

             RTVDTAARA  DTAARA(*LDA (911 10)) RTNVAR(&USER)
             RTVDTAARA  DTAARA(*LDA (934 10)) RTNVAR(&SBIB)

/* Endre biblioteksliste                                             */

             IF         COND(&SBIB *NE ' ') THEN(DO)
             CHGCURLIB  CURLIB(&SBIB)
             ENDDO

             GOTO       CMDLBL(END)
 ERR:        SNDPGMMSG  MSG('Det oppstod en feil, se melding +
                          i jobbloggen !!!') TOMSGQ(&JOBB)

 END:        ENDPGM
