/*8.01*/     PGM        PARM(&FIRM &KUNR &KPRO &lgln)
/* ------------------------------------------------------------------*/
/*                                                                   */
/* 8.xx 080422 bsa Ny versjon for uthenting av prisliste - Smartkalk */
/* 8.01 080422 bsa Lagt inn ny parameter for GLN nummer. Brukes for  */
/* 8.01            å identifisere lager.                             */
/* 8.02 210222 bsa Innfører switch om det skal være med tilbudspriser*/
/* 8.03 210222 bsa Innfører switch om det skal være med skaffevarer  */
/* 8.04 210222 bsa Innfører switch om det kun skal være nobbnummer   */
/*                                                                   */
/*                                                                   */
/*                                                                   */
/*                                                                   */
/*-------------------------------------------------------------------*/

/* Definering av parametre                                           */

             DCL        VAR(&FIRM) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&KUNR) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&KPRO) TYPE(*DEC) LEN(6 0)
/*8.01*/     dcl        var(&lgln) type(*dec) len(13 0)

/* Definering av variable                                            */

             DCL        VAR(&TMST) TYPE(*CHAR) LEN(20)

             DCL        VAR(&RKAT) TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&RFM1) TYPE(*CHAR) LEN(10)
             DCL        VAR(&VSOR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OGRP) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&HGRP) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&UGRP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&LDOR) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&RFM2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SKAF) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&TILB) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&UTXT) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&UBPR) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&LTYP) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&PDAT) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LAGE) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&FNAV) TYPE(*CHAR) LEN(10)
/*8.04*/     DCL        VAR(&NVAL) TYPE(*DEC) LEN(1 0)

/*8.02*/     dcl        var(&fgr)       type(*char) len(3)
/*8.02*/     dcl        var(&fix)       type(*char) len(3)
/*8.02*/     dcl        var(&fir)       type(*dec)  len(3 0) value(0)
/*8.02*/     dcl        var(&lag)       type(*dec)  len(3 0) value(0)

/*8.02*/     DCL        VAR(&CO402_KEY) TYPE(*CHAR) LEN(50)
/*8.02*/     DCL        VAR(&CO402_V1)  TYPE(*CHAR) LEN(1)
/*8.02*/     DCL        VAR(&CO402_V2)  TYPE(*CHAR) LEN(2048)

/*8.02*/     rtvdtaara  dtaara(*lda (931 3)) rtnvar(&fgr)
/*8.02*/     rtvdtaara  dtaara(*lda (944 3)) rtnvar(&fix)
/*8.02*/     chgvar     var(&fir)   value(&fix)

/* Setter inn faste verdier                                          */

             CHGVAR     VAR(&RKAT) VALUE(000)
             CHGVAR     VAR(&RFM1) VALUE('          ')
             CHGVAR     VAR(&VSOR) VALUE('TOTALT    ')
             CHGVAR     VAR(&OGRP) VALUE(00)
             CHGVAR     VAR(&HGRP) VALUE(00)
             CHGVAR     VAR(&UGRP) VALUE(000)
             CHGVAR     VAR(&LDOR) VALUE(0)
             CHGVAR     VAR(&RFM2) VALUE('BYGGDATA  ')
             CHGVAR     VAR(&SKAF) VALUE(0)
             CHGVAR     VAR(&TILB) VALUE(0)
             CHGVAR     VAR(&UTXT) VALUE(0)
             CHGVAR     VAR(&UBPR) VALUE(0)
             CHGVAR     VAR(&LTYP) VALUE(0)
             CHGVAR     VAR(&PDAT) VALUE('nnnn-nn-nn')
             CHGVAR     VAR(&LAGE) VALUE(00)

/*8.02 Sjekk om det skal med tilbudspris                             */

/*8.02*/     CHGVAR     VAR(&CO402_KEY) VALUE('SMARTKALK_TILBUDSPRIS')
/*8.02*/     CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
/*8.02*/                  &CO402_V1 &CO402_V2)

/*8.02*/     IF         COND(&CO402_V1 *EQ '1') THEN(do)
/*8.02*/     chgvar     var(&tilb)  value(1)
/*8.02*/     enddo

/*8.03 Sjekk om det skal med skaffevarer                             */

/*8.03*/     CHGVAR     VAR(&CO402_KEY) VALUE('SMARTKALK_SKAFFEVARER')
/*8.03*/     CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
/*8.03*/                  &CO402_V1 &CO402_V2)

/*8.03*/     IF         COND(&CO402_V1 *EQ '1') THEN(do)
/*8.03*/     chgvar     var(&skaf)  value(1)
/*8.03*/     enddo

/*8.04 Sjekk om det kun skal være med nobbnummer                     */

/*8.04*/     CHGVAR     VAR(&CO402_KEY) VALUE('SMARTKALK_NOBBNUMMER')
/*8.04*/     CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
/*8.04*/                  &CO402_V1 &CO402_V2)

/*8.04*/     IF         COND(&CO402_V1 *EQ '1') THEN(do)
/*8.04*/     chgvar     var(&nval)  value(1)
/*8.04*/     enddo

/* Henter dagens dato                                                */

             RTVSYSVAL  SYSVAL(QDATETIME) RTNVAR(&TMST)
             CHGVAR     VAR(%SST(&PDAT 1 4)) VALUE(%SST(&TMST 1 4))
             CHGVAR     VAR(%SST(&PDAT 6 2)) VALUE(%SST(&TMST 5 2))
             CHGVAR     VAR(%SST(&PDAT 9 2)) VALUE(%SST(&TMST 7 2))


/* Kall til styreprogram                                             */

             CALL       PGM(VP670R) PARM(&FIRM &RKAT &KUNR &KPRO +
                          &RFM1 &VSOR &OGRP &HGRP &UGRP &LDOR &RFM2 +
/*8.01*/                  &SKAF &TILB &UTXT &UBPR &LTYP &PDAT &LAGE +
/*8.04*/                  &nval &lgln)

 END:        ENDPGM
