             PGM        PARM(&FIRM &KUND &KPRO &VSOR &OGRP &HGRP +
                          &UGRP &LDOR &RFMT &ENDR &DAT2 &SVAL &TVAL +
                          &XVAL &BVAL &LETY &DATO &LAGE &FTIS &MEMB)

/*                                                              */
/* Dette er en kopi av VP682C uten mappehåndtering og melding   */
/*                                                              */
/* Da det ofte kommer andre formater enn det som takles, avslutter */
/* jeg jobben. bsa 09.12.20                                        */
/*                                                                 */
             DCL        VAR(&FIRM)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&KUND)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&KPRO)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&VSOR)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&OGRP)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&HGRP)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&UGRP)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&LDOR)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&RFMT)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&ENDR)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&DAT2)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&SVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&TVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&XVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&BVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&LETY)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&LAGE)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&DATO)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&FTIS)     TYPE(*CHAR) LEN(26)
             DCL        VAR(&MEMB)     TYPE(*CHAR) LEN(10)

             DCL        VAR(&FILE1)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&KUND_ALF) TYPE(*CHAR) LEN(6)
             DCL        VAR(&KPRO_ALF) TYPE(*CHAR) LEN(6)
             DCL        VAR(&MAPPE)    TYPE(*CHAR) LEN(30)
             DCL        VAR(&FLDX)     TYPE(*CHAR) LEN(16)
             DCL        VAR(&FGRP)     TYPE(*CHAR) LEN(3)

             DCL        VAR(&BIBL)     TYPE(*CHAR) LEN(6)
             DCL        VAR(&FILN)     TYPE(*CHAR) LEN(12)

             DCL        VAR(&CLIB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&MAPX)     TYPE(*CHAR) LEN(30)
             DCL        VAR(&FFIL)     TYPE(*CHAR) LEN(70)
             DCL        VAR(&TFIL)     TYPE(*CHAR) LEN(70)
             DCL        VAR(&FILNF)    TYPE(*CHAR) LEN(25) -
                        value('IBXfil.txt')

/* Finner navn på prisfil i.h.t. recordformat                        */

             IF         COND(&RFMT = 'BA-KALK') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIBSPF')
             ENDDO

             IF         COND(&RFMT = 'BYGGDATA') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIBDPF')
             ENDDO

             IF         COND(&RFMT = 'BYGGDATAWI') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIBDPF')
             ENDDO

             IF         COND(&RFMT = 'BYGGDATAM2') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIBZPF')
             ENDDO

             IF         COND(&RFMT = 'CORRADO') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FINNPF')
             ENDDO

             IF         COND(&RFMT = 'FRIKALK') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIRCPF')
             ENDDO

             IF         COND(&RFMT = 'HOLTE') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIHPPF')
             ENDDO

             IF         COND(&RFMT = 'NOBB') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FINOPF')
             ENDDO

             IF         COND(&RFMT = 'NOBB_INT') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FINIPF')
             ENDDO

             IF         COND(&RFMT = 'REGNEARK') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIRAPF')
             ENDDO

             IF         COND(&RFMT = 'REGNEARKPO') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIRAPF')
             ENDDO

             IF         COND(&RFMT = 'SALGSSUPP') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FISKPF')
             ENDDO

             IF         COND(&RFMT = 'ENTREKA') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIETPF')
             ENDDO

             IF         COND(&RFMT = 'INTFILE') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIPXPF')
             ENDDO

             IF         COND(&RFMT = 'BYGGOFFICE') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIBOPF')
             ENDDO

             IF         COND(&RFMT = 'IBX') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FIBXPF')
             ENDDO

             IF         COND(&RFMT = 'LOGIQ') THEN(DO)
             CHGVAR     VAR(&FILE1) VALUE('FILQPF')
             ENDDO

/*bsa*/      IF         COND(&FILE1 = '         ') THEN(DO)
/*bsa*/     goto       cmdlbl(END)
/*bsa*/     ENDDO


/* Tømmer prisfil                                                    */

             CLRPFM     FILE(&FILE1)

/* Oppretter og overrider member i arbeidsfil                        */

             ADDPFM     FILE(VVAWPF) MBR(&MEMB)
             OVRDBF     FILE(VVAWPF) MBR(&MEMB) OVRSCOPE(*CALLLVL)

/* Kaller program for oppdatering av prisfil til kunde/kundeprosj.   */

             CALL       PGM(VP682R) PARM(&FIRM &KUND &KPRO &VSOR +
                          &OGRP &HGRP &UGRP &LDOR &RFMT &ENDR &DAT2 +
                          &SVAL &TVAL &XVAL &BVAL &LETY &DATO &LAGE &FTIS)

             CPYF       FROMFILE(&FILE1) TOFILE(NETPRIS) +
                          MBROPT(*REPLACE) CRTFILE(*NO) FMTOPT(*NOCHK)

/* Fjerner member i arbeidsfil                                       */

             RMVM       FILE(VVAWPF) MBR(&MEMB)


 END:        ENDPGM
