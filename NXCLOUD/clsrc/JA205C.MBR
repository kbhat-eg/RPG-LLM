/*-------------------------------------------------------------------*/
pgm
/**/
           dcl        var(&p_avrund) type(*char) len(3)
           dclf       file(JA205D)
/**/
rtv:       rtvdtaara dtaara(AVR_REGEL) rtnvar(&p_avrund)
           monmsg    msgid(cpf1015) exec(do)
             crtdtaara  dtaara(AVR_REGEL) type(*char) len(3) +
                        value('STD') TEXT('Avrundingsregel  NB!!  +
                        MÃ… IKKE SLETTES')
             goto cmdlbl(rtv)
           enddo
           if        cond(&p_avrund *eq 'BMP') then(do)
              chgvar var(&std)  value('N')
              chgvar var(&bmp)  value('J')
           enddo
           if        cond(&p_avrund *ne 'BMP') then(do)
              chgvar var(&std)  value('J')
              chgvar var(&bmp)  value('N')
           enddo
/**/
           chgvar     var(&w_acli) value(4)
           chgvar     var(&w_acpo) value(6)
sndrcv:    sndrcvf    rcdfmt(m1win)
/**/
          if          cond(&in12) then(return)
/**/
          if          cond(&std *ne 'J') then(do)
            if        cond(&std *ne 'N') then(do)
              goto      cmdlbl(sndrcv)
            enddo
          enddo
          if          cond(&bmp *ne 'J') then(do)
            if        cond(&bmp *ne 'N') then(do)
              goto      cmdlbl(sndrcv)
            enddo
          enddo

          if         cond(&bmp *eq 'J') then(do)
            chgdtaara  dtaara(AVR_REGEL) value('BMP')
          enddo
          if         cond(&bmp *ne 'J') then(do)
            chgdtaara  dtaara(AVR_REGEL) value('STD')
          enddo
/**/
end:      endpgm

