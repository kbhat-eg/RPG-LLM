             PGM        PARM(&KULE &KUND &KPRO &PRTF &NUMM &SELG)

/* 030614 bof : utvidelse ihht. nummerutvidelse                      */
/*                                                                   */
/* Definering av parametere og variable                              */

             DCL        VAR(&KULE)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&KUND)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&KPRO)     TYPE(*DEC)  LEN(6 0)
/*6.nu*/     DCL        VAR(&NUMM)     TYPE(*DEC)  LEN(8 0)
             DCL        VAR(&SELG)     TYPE(*DEC)  LEN(4 0)
             DCL        VAR(&PRTF)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&NAVN)     TYPE(*CHAR) LEN(30)
             DCL        VAR(&EMAL)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMNE)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMN2)     TYPE(*CHAR) LEN(250)
             DCL        VAR(&PERS)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMA2)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&TXT1)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&TXT2)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&TXT3)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&TXT4)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&IN03)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&SEND)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&STAT)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&SETU)     TYPE(*CHAR) LEN(100)
             DCL        VAR(&FOTN)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&INIF)     TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)     TYPE(*CHAR) LEN(40)
             DCL        VAR(&WALI)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)     TYPE(*DEC)  LEN(2 0)


/* Program for overstyring av e-mail-adresser                        */

             CALL       PGM(FO798R)    PARM(&KULE &KUND &KPRO &NUMM +
                                            &SELG &NAVN &EMAL &EMNE +
                                            &TXT1 &TXT2 &TXT3 &TXT4 +
                                            &PERS &EMA2 &INIF &IN03)

/* Er F03/F12 trykket                                                */

             IF         COND(&IN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Sending av e-mail                                                 */

             CHGVAR     VAR(&WALI)     VALUE(12)
             CHGVAR     VAR(&WAPO)     VALUE(24)
             CHGVAR     VAR(&MLD1)     VALUE('Klargjøring for e-mail pågår, ')
             CHGVAR     VAR(&MLD2)     VALUE('Vennligst vent litt . .       ')
             CALL       PGM(AA006C)    PARM(&WALI &WAPO &MLD1 &MLD2)

/* Bygger opp parametere som mangler                                 */
/* og legger over emne til 250 posisjoner                            */
/* og ...    init-file til 100 posisjoner                            */

             CHGVAR     VAR(&SEND)     VALUE(&PRTF)
             CHGVAR     VAR(&EMN2)     VALUE(&EMNE)
             CHGVAR     VAR(&SETU)     VALUE(&INIF)

             CALL       PGM(AM701C)    PARM(&PRTF &SEND +
                                            &EMAL &EMA2 &EMN2 &STAT +
                                            &TXT1 &TXT2 &TXT3 &TXT4 +
                                            &SETU &FOTN &PERS &KUND +
                                            &NUMM)
ENDPGM:      ENDPGM
