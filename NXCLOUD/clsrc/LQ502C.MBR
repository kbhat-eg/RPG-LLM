             pgm        parm(&vare)

  /* Ny versjon av programmet                             */
  /* Switchstyrt så det kan kjøres uten kundetilpasninger */

             dcl        var(&vare)   type(*char) len(15)
             dcl        var(&tell)   type(*dec) len(2 0)
             dcl        var(&posi)   type(*dec) len(2 0)
             dcl        var(&kfig)   type(*char) len(3)
             dcl        var(&figr)   type(*char) len(6)
             dcl        var(&fig1)   type(*char) len(3)
             dcl        var(&fig2)   type(*char) len(3)
             dcl        var(&fig3)   type(*char) len(3)
             dcl        var(&fig4)   type(*char) len(3)
             dcl        var(&fig5)   type(*char) len(3)
             dcl        var(&fig6)   type(*char) len(3)
             dcl        var(&fig7)   type(*char) len(3)
             dcl        var(&fig8)   type(*char) len(3)
             dcl        var(&fig9)   type(*char) len(3)
             dcl        var(&fig10)  type(*char) len(3)

             dcl        var(&fgr)       type(*char) len(3)
             dcl        var(&fir)       type(*dec)  len(3 0) value(0)
             dcl        var(&fix)       type(*char) len(3)
             dcl        var(&lag)       type(*dec)  len(3 0) value(0)

             dcl        var(&co402_key) type(*char) len(50)
             dcl        var(&co402_v1)  type(*char) len(1)
             dcl        var(&co402_v2)  type(*char) len(2048)

  /* Slå opp på switch og hent informasjon */

             rtvdtaara  dtaara(*lda (931 3)) rtnvar(&fgr)
             rtvdtaara  dtaara(*lda (944 3)) rtnvar(&fix)
             chgvar     var(&fir)   value(&fix)
             chgvar     var(&co402_key) value('LAGER_FILGRUPPER')
             call       pgm(co402r) parm(&fgr &fir &lag &co402_key +
                          &co402_v1 &co402_v2)

             if         cond(&co402_v1 *ne '1') then(do)
                goto       cmdlbl(end)
             enddo

  /* Finner filgrupper fra switch  */

  /*01*/
             chgvar     var(&posi) value(01)
             chgvar     var(&fig1) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig1 *eq '   ') then(do)
                goto       cmdlbl(end)
             enddo
             chgvar     var(&tell) value(01)

  /*02*/
             chgvar     var(&posi) value(05)
             chgvar     var(&fig2) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig2 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(02)

  /*03*/
             chgvar     var(&posi) value(09)
             chgvar     var(&fig3) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig3 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(03)

  /*04*/
             chgvar     var(&posi) value(13)
             chgvar     var(&fig4) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig4 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(04)

  /*05*/
             chgvar     var(&posi) value(17)
             chgvar     var(&fig5) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig5 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(05)

  /*06*/
             chgvar     var(&posi) value(21)
             chgvar     var(&fig6) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig6 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(06)

  /*07*/
             chgvar     var(&posi) value(25)
             chgvar     var(&fig7) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig7 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(07)

  /*08*/
             chgvar     var(&posi) value(29)
             chgvar     var(&fig8) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig8 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(08)

  /*09*/
             chgvar     var(&posi) value(33)
             chgvar     var(&fig9) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig9 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(09)

  /*10*/
             chgvar     var(&posi) value(37)
             chgvar     var(&fig10) value(%sst(&co402_v2 &posi 3))
             if         cond(&fig10 *eq '   ') then(do)
                goto       cmdlbl(pgm)
             enddo
             chgvar     var(&tell) value(10)


 pgm:        call       pgm(LQ502R) parm(&vare &tell &fig1 &fig2 &fig3 +
                          &fig4 &fig5 &fig6 &fig7 &fig8 &fig9 &fig10)

 end:        endpgm
