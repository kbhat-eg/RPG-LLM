             PGM        PARM(&FIRM &KUND &KPRO &VSOR &OGRP &HGRP +
                          &UGRP &LDOR &RFMT &ENDR &DAT2 &SVAL &TVAL +
/*8.01*/                  &XVAL &BVAL &LETY &DATO &LAGE &FTIS &MEMB +
/*8.01*/                  &nval &lgln)
/* ------------------------------------------------------------------*/
/*                                                                   */
/* 8.xx 080422 bsa Ny versjon for uthenting av prisliste - Smartkalk */
/* 8.01 080422 bsa Lagt inn ny parameter for GLN nummer. Brukes for  */
/* 8.01            å identifisere lager.                             */
/* 8.02 080422 bsa Lagt inn ny parameter for nobbnummer              */
/*                                                                   */
/*                                                                   */
/*                                                                   */
/*                                                                   */
/*-------------------------------------------------------------------*/

             DCL        VAR(&FIRM)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&KUND)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&KPRO)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&VSOR)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&OGRP)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&HGRP)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&UGRP)     TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&LDOR)     TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&RFMT)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&ENDR)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&DAT2)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&SVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&TVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&XVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&BVAL)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&LETY)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&LAGE)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&DATO)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&FTIS)     TYPE(*CHAR) LEN(26)
             DCL        VAR(&FILN)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&MEMB)     TYPE(*CHAR) LEN(10)
/*8.02*/     DCL        VAR(&NVAL)     TYPE(*DEC)  LEN(1 0)

             DCL        VAR(&BIBL)     TYPE(*CHAR) LEN(6)
             DCL        VAR(&FGRP)     TYPE(*CHAR) LEN(3)
/*8.01*/     DCL        VAR(&lgln)     TYPE(*dec)  LEN(13 0)

             RTVDTAARA  DTAARA(*LDA (931 03)) RTNVAR(&FGRP)
             CHGVAR     VAR(&BIBL) VALUE('ADB' *TCAT &FGRP)

/* Tømmer målfill før ny kjøring                                     */

             IF         COND(&RFMT = 'HOLTE') THEN(DO)
             CLRPFM     FILE(FIHPPF)
             ENDDO

             IF         COND(&RFMT = 'BYGGDATAWI') THEN(DO)
             CLRPFM     FILE(FIBDPF)
             ENDDO

             IF         COND(&RFMT = 'BYGGDATA  ') THEN(DO)
             CLRPFM     FILE(FIBDPF)
             ENDDO

/* Oppretter og overrider member i arbeidsfil                        */

             ADDPFM     FILE(VVAWPF) MBR(&MEMB)
             OVRDBF     FILE(VVAWPF) MBR(&MEMB) OVRSCOPE(*CALLLVL)

/* Kaller program for oppdatering av prisfil til kunde/kundeprosj.   */

             CALL       PGM(VP671R) PARM(&FIRM &KUND &KPRO &VSOR +
                          &OGRP &HGRP &UGRP &LDOR &RFMT &ENDR &DAT2 +
                          &SVAL &TVAL &XVAL &BVAL &LETY &DATO &LAGE +
/*8.02*/                  &FTIS &nval &lgln)

/* Fjerner member i arbeidsfil                                       */

             RMVM       FILE(VVAWPF) MBR(&MEMB)

 END:        ENDPGM
