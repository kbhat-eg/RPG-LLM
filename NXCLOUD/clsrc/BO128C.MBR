             PGM        PARM(&MEMB &PARM)
/*-------------------------------------------------------------------*/
/* 7.02 261120 ask Lagt inn switch-styrt danning av kostposteringer  */
/*                                                                   */
/*------------------------------------------------------------------ */

/* Initiering av parametere                                          */

             DCL        VAR(&MEMB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PARM) TYPE(*CHAR) LEN(256)

             DCL        VAR(&CO402_KEY) TYPE(*CHAR) LEN(50)
             DCL        VAR(&CO402_V1)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&CO402_V2)  TYPE(*CHAR) LEN(2048)
             dcl        var(&map)       type(*char) len(70)
             dcl        var(&grp)       type(*char) len(10)
             dcl        var(&fgr)       type(*char) len(3)
             dcl        var(&fix)       type(*char) len(3)
             dcl        var(&fir)       type(*dec)  len(3 0) value(0)
             dcl        var(&lag)       type(*dec)  len(3 0) value(0)

/* Override parameterfilene/membrene                                 */

             OVRDBF     FILE(BPSOLA) TOFILE(*FILE) MBR(&MEMB)

/* Call av oppdateringsprogram                                       */

             CALL       PGM(BO128R) PARM(&PARM)

/* Danner kostprisposteringer fra statistikk om switch er satt       */

             CHGVAR     VAR(&CO402_KEY) VALUE('POST_KOST')
             rtvdtaara  dtaara(*lda (931 3)) rtnvar(&fgr)
             rtvdtaara  dtaara(*lda (944 3)) rtnvar(&fix)
             chgvar     var(&fir)   value(&fix)
             CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
                          &CO402_V1 &CO402_V2)

             IF         COND(&CO402_V1 *EQ '1') THEN(do)
                CALL       PGM(BO129R)
             enddo

/* Override av parametermembrene oppheves                            */

             DLTOVR     FILE(BPSOLA)

             ENDPGM
