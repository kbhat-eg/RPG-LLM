             PGM        PARM(&LIST &LIST2 &MEMB &NATT)

/* Initiering av parametre.                                          */
/* 231118 bof : utvidet med vvlepf                                   */
/* 291019 bof : endret til firmastyring på filk. av varegrupper      */

             DCL        VAR(&LIST)  TYPE(*CHAR) LEN(260)
             DCL        VAR(&LIST2) TYPE(*CHAR) LEN(40)
             DCL        VAR(&MEMB)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&NATT)  TYPE(*CHAR) LEN(1)

             DCL        VAR(&FIRM) TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&FGRF) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FGRT) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FIRT) TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&VSOR) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVSO) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KLEV) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KRSP) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KVGR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KVSO) TYPE(*CHAR) LEN(1)
             DCL        VAR(&LDOR) TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&OPPR) TYPE(*CHAR) LEN(1)  VALUE('1')
             DCL        VAR(&DLIB) TYPE(*CHAR) LEN(10) VALUE('ADBxxx')
             DCL        VAR(&PFGR) TYPE(*CHAR) LEN(3)  VALUE('  ')
             DCL        VAR(&PLIB) TYPE(*CHAR) LEN(10) VALUE('ADBxxx')

             MONMSG     MSGID(CPF2981) EXEC(GOTO CMDLBL(END))

/* Henter variable fra parameterliste                                */

             CHGVAR     VAR(&FIRM) VALUE(%SST(&LIST  4 3))
             CHGVAR     VAR(&FGRF) VALUE(%SST(&LIST  1 3))

             CHGVAR     VAR(&FGRT) VALUE(%SST(&LIST2 1 3))
             CHGVAR     VAR(&FIRT) VALUE(%SST(&LIST2 4 3))
             CHGVAR     VAR(&VSOR) VALUE(%SST(&LIST2 7 10))
             CHGVAR     VAR(&OVSO) VALUE(%SST(&LIST2 29 1))
             CHGVAR     VAR(&KLEV) VALUE(%SST(&LIST2 30 1))
             CHGVAR     VAR(&KRSP) VALUE(%SST(&LIST2 31 1))
             CHGVAR     VAR(&KVGR) VALUE(%SST(&LIST2 32 1))
             CHGVAR     VAR(&KVSO) VALUE(%SST(&LIST2 35 1))
             CHGVAR     VAR(&PFGR) VALUE(%SST(&LIST2 36 3))

/* Automatisk oppretting av sortiment                                */

             IF         COND(&NATT *EQ '1') THEN(DO)
             IF         COND((&OVSO *EQ '1') *AND (&VSOR *NE +
                          '          ')) THEN(DO)
             CALL       PGM(VD755R) PARM(&FIRM &FGRT &VSOR)
             CALL       PGM(VD756C) PARM(&FIRM &FGRT &VSOR)
             ENDDO
             ENDDO

/* Kopiering av leverandør                                           */

             IF         COND(&NATT *EQ '1') THEN(DO)
             IF         COND(&KLEV *EQ '1') THEN(CALL PGM(RL191C) +
                          PARM(&FIRM &FGRT &FIRT &LDOR &OPPR))
             ENDDO

/* Overrider oppdateringsindekser mot filgruppe det skal             */
/* kopieres til                                                      */

             CHGVAR     VAR(%SST(&DLIB 4 3)) VALUE(&FGRT)

             OVRDBF     FILE(VVARLU) TOFILE(&DLIB/VVARLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VVENLU) TOFILE(&DLIB/VVENLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VVEPLU) TOFILE(&DLIB/VVEPLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VVPRLU) TOFILE(&DLIB/VVPRLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VTILLU) TOFILE(&DLIB/VTILLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VTILLR) TOFILE(&DLIB/VTILLR) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VVSOLU) TOFILE(&DLIB/VVSOLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VVLELU) TOFILE(&DLIB/VVLELU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VSOKLU) TOFILE(&DLIB/VSOKLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VEANLU) TOFILE(&DLIB/VEANLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(FSTSL1) TOFILE(&DLIB/FSTSL1) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VLAGL1) TOFILE(&DLIB/VLAGL1) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VLAGLU) TOFILE(&DLIB/VLAGLU) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
            OVRDBF     FILE(RA10L1) TOFILE(&DLIB/RA10L1) +
                         MBR(*FIRST) OVRSCOPE(*JOB)
             IF         COND(&PFGR *NE '   ') THEN(DO)
             CHGVAR     VAR(%SST(&PLIB 4 3)) VALUE(&PFGR)
             OVRDBF     FILE(VPDTL1) TOFILE(&DLIB/VPDTL1) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VPDTL8) TOFILE(&DLIB/VPDTL8) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             OVRDBF     FILE(VPDTL9) TOFILE(&DLIB/VPDTL9) +
                          MBR(*FIRST) OVRSCOPE(*JOB)
             ENDDO

/* Kaller oppdateringsprogram                                        */

             ADDPFM     FILE(VVAWPF) MBR(&MEMB)
             OVRDBF     FILE(VVAWPF) MBR(&MEMB) OVRSCOPE(*CALLLVL)

             CALL       PGM(VV782R) PARM(&LIST &LIST2)

             RMVM       FILE(VVAWPF) MBR(&MEMB)

/* Kopierer valgte registre - dersom nattjobb                        */

             IF         COND(&NATT *EQ '1') THEN(DO)

             IF         COND(&KVGR = '1') THEN(DO)
/*              CPYF       FROMFILE(VOGRPF) TOFILE(&DLIB/VOGRPF) +            */
/*                           MBROPT(*REPLACE)                                 */
/*              MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))              */
/*              CPYF       FROMFILE(VHGRPF) TOFILE(&DLIB/VHGRPF) +            */
/*                           MBROPT(*REPLACE)                                 */
/*              MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))              */
/*              CPYF       FROMFILE(VUGRPF) TOFILE(&DLIB/VUGRPF) +            */
/*                           MBROPT(*REPLACE)                                 */
/*              MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))              */
                call       vg782c parm(&fgrf &fgrt &firt)

             CPYF       FROMFILE(VAHGPF) TOFILE(&DLIB/VAHGPF) +
                          MBROPT(*REPLACE)
             MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))
             MONMSG     MSGID(CPF2817)
             CPYF       FROMFILE(VAUGPF) TOFILE(&DLIB/VAUGPF) +
                          MBROPT(*REPLACE)
             MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))
             MONMSG     MSGID(CPF2817)
             ENDDO

             IF         COND(&KVSO = '1') THEN(DO)
             CPYF       FROMFILE(VSHEPF) TOFILE(&DLIB/VSHEPF) +
                          MBROPT(*REPLACE)
             MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))
             CPYF       FROMFILE(VSDTPF) TOFILE(&DLIB/VSDTPF) +
                          MBROPT(*REPLACE)
             MONMSG     MSGID(CPF2909) EXEC(GOTO CMDLBL(END))
             ENDDO

             ENDDO

/* Reorganiserer filer - dersom nattjobb                             */

             IF         COND(&NATT *EQ '1') THEN(DO)

             RGZPFM     FILE(VSDTPF) KEYFILE(VSDTL1 VSDTL1)

             RGZPFM     FILE(&DLIB/VVENPF) KEYFILE(&DLIB/VVENL1 +
                          VVENL1)
             RGZPFM     FILE(&DLIB/VVPRPF) KEYFILE(&DLIB/VVPRL1 +
                          VVPRL1)
             RGZPFM     FILE(&DLIB/VVSOPF) KEYFILE(&DLIB/VVSOL5 +
                          VVSOL5)
             RGZPFM     FILE(&DLIB/VTILPF) KEYFILE(&DLIB/VTILL1 +
                          VTILL1)
             RGZPFM     FILE(&DLIB/VSOKPF) KEYFILE(&DLIB/VSOKL1 +
                          VSOKL1)

             ENDDO

 END:        ENDPGM
