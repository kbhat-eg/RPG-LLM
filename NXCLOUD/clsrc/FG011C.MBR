             PGM

             DCLF       FILE(FG011D)

             DCL        VAR(&DLIB) TYPE(*CHAR) LEN(6) VALUE('ADBnnn')

             DCL        VAR(&VA01) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA02) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA03) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA04) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA05) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA06) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA07) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA08) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA09) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA10) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA11) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA12) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA13) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA14) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA15) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA16) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA17) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA18) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA19) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA20) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA21) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA22) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA23) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA24) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA25) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA26) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA27) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA28) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA29) TYPE(*CHAR) LEN(1)

             DCL        VAR(&CLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&LEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK) TYPE(*CHAR) LEN(2)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL) VALUE('40')
             CHGVAR     VAR(&OKOK) VALUE('  ')
             CALL       PGM(AA050C) PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Utleder foresl√•tt filgruppe utifra current-library                */

             RTVJOBA    CURLIB(&CLIB)
             CHGVAR     VAR(&FGRP) VALUE(%SUBSTRING(&CLIB 4 3))

/* Viser skjermbilde                                                 */

             SNDRCVF    RCDFMT(A1BLD)

/* F3/F12                                                            */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/* Avbryter dersom filgruppe ikke er valgt                           */

             IF         COND(&FGRP *EQ '   ') THEN(GOTO CMDLBL(ENDPGM))

/* Utlderer databibliotek fra filgruppe                              */

             CHGVAR     VAR(&DLIB) VALUE(%SUBSTRING(&DLIB 1 3) *TCAT +
                          &FGRP)

/* Genererer de valgte tabellene                                     */

             IF         COND(&VA01 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EKBOST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA02 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EKBEST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA03 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EKBSST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA04 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EKBTST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA05 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EMBDST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA06 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EMBEST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA07 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EMBHST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA08 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('EMBKST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA09 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA10 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA11 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA12 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA13 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA14 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA15 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA16 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('ELBOST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA17 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('ELBEST' &DLIB &NULL)
             ENDDO

             IF         COND(&VA18 *EQ '1') THEN(DO)
                CALL       PGM(FGXL1C) PARM(&FGRP &NULL)
             ENDDO

             IF         COND(&VA19 *EQ '1') THEN(DO)
                CALL       PGM(FGXL2C) PARM(&FGRP &NULL)
             ENDDO

             IF         COND(&VA20 *EQ '1') THEN(DO)
                CALL       PGM(FGXL3C) PARM(&FGRP &NULL)
             ENDDO

             IF         COND(&VA21 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA22 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA23 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA24 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA25 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA26 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA27 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA28 *EQ '1') THEN(DO)
             ENDDO

             IF         COND(&VA29 *EQ '1') THEN(DO)
             ENDDO

 ENDPGM:     ENDPGM
