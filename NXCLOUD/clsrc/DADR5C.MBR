             PGM        PARM(&MIL &FPER &TPER &YEAR)

/* Initiering av parametre.                                          */

             DCL        VAR(&MIL) TYPE(*CHAR) LEN(3)
             DCL        VAR(&FPER) TYPE(*CHAR) LEN(2)
             DCL        VAR(&TPER) TYPE(*CHAR) LEN(2)
             DCL        VAR(&YEAR) TYPE(*CHAR) LEN(4)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)

             DCL        VAR(&JAVA) TYPE(*CHAR) LEN(1000)

             DCL        VAR(&MODU)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&DISP)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&STAT)     TYPE(*CHAR) LEN(1)

             CHGVAR     VAR(&MODU)     VALUE(ADRA)
             CHGVAR     VAR(&DISP)     VALUE(1)
             CHGVAR     VAR(&STAT)     VALUE(0)
             CALL       PGM(AX700R) PARM(&MODU &DISP &STAT)

             IF         COND(&STAT *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             RTVDTAARA  DTAARA(*LDA (911 10)) RTNVAR(&USER)

/*           RTVJOBA    JOB(&JOBN)          */

/* Setter sammen Java kommandoen                                           */

             CHGVAR     VAR(&JAVA) VALUE('java -jar +
                          adra-integrasjon.jar -miljø=' *TCAT &MIL +
                          *BCAT '-år=' *TCAT &YEAR *BCAT +
                          '-fraPeriode=' *TCAT &FPER *BCAT +
                          '-tilPeriode=' *TCAT &TPER *BCAT +
                          '-logging=true')


/* Kjører Java kall for utrekk til Adra Match                              */
             CD         DIR('/java/asp/adra')
/*           JAVA       CLASS('adra-integrasjon.jar') PARM(&JAVA)          */
             QSH        CMD(&JAVA)
/*           SBMJOB     CMD(QSH CMD(&JAVA)) JOB(ADRAEXP) JOBPTY(7) +*/
/*                        OUTPTY(7)                                        */
/*           DLTOVR     FILE(STDOUT)                                       */

/* Sjekker om Java gikk bra. Sender også standard melding hvis ikke        */

/*           RMVM       FILE(ADB/ALOGPF) MBR(&JOBN)                        */
/*           MONMSG     MSGID(CPF0000) EXEC(DO)                            */
/*           GOTO       CMDLBL(GENERROR)                                   */
/*           ENDDO                                                         */

/* Sletter java loggfilen hvis alt gikk bra                                */

/*           RMVM       FILE(ADB/ALOGPF) MBR(&LOGN)                        */

 END:        RETURN

 GENERROR:
             SNDMSG     MSG('Uttrekk til Adra Match gikk bra') +
                          TOUSR(&USER)
             MONMSG     MSGID(CPF0000)

 ENDPGM:     ENDPGM
