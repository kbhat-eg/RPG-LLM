             PGM        PARM(&FIRMA &WHERE &POST_LINK)

             DCL        VAR(&FIRMA) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&WHERE) TYPE(*CHAR) LEN(8000)
             DCL        VAR(&POST_LINK) TYPE(*CHAR) LEN(100)

             DCL        VAR(&SQLSTMT)  TYPE(*CHAR) LEN(10000)
             DCL        VAR(&PREFIX_FIL)    TYPE(*CHAR) LEN(20) +
                          VALUE('ORDRER')


/*   Bygg SQL                                                                 */
             CHGVAR     VAR(&SQLSTMT) VALUE('SELECT fonumm AS +
                          "Ordrenummer",fosuff AS "Suffix",footyp AS +
                          "Ordretype",vaotxt AS "Beskrivelse",fobdat AS +
                          "Ordredato",foldat AS "Leveringsdato", folety +
                          concat '' - '' concat vybesk AS "Leveringstype", +
                          folmat CONCAT '' - '' CONCAT raqtxt AS +
                          "Leveringsm√•te",folage concat ''  - '' concat  +
                          rajtxt AS "Lager",fokund AS "Kundenummer",fokuna +
                          AS "Kunde",fokpro AS "Kundeprosjekt",fonavn AS +
                          "Prosjekt/Merk",foadr1 AS "Adresse",fosted AS +
                          "Poststed",fotots AS "Totalsum eks. mva",foselg +
                          AS "Selgernummer",raitxt AS "Selger"FROM fohepf +
                          LEFT OUTER JOIN vltppf ON vyfirm = fofirm AND +
                          vylety = folety LEFT OUTER JOIN ra10pf ON rajfir +
                          = fofirm AND rajkod = folage LEFT OUTER JOIN +
                          ra09pf ON raifir = fofirm AND raikod = foselg +
                          LEFT OUTER JOIN votypf ON vaofir = fofirm AND +
                          vaotyp = footyp LEFT OUTER JOIN ra17pf ON raqfir +
                          = fofirm AND raqkod = folmat LEFT OUTER JOIN +
                          RKUNPF ON RKFIRM = FOFIRM AND RKKUND = FOKUND  ')

             chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'WHERE FOFIRM=' +
                          *CAT %CHAR(&FIRMA))
             chgvar     var(&sqlstmt) value(&sqlstmt *Bcat &WHERE)
             chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'ORDER BY +
                          FODATE DESC, FOTIME DESC, FONUMM, FOSUFF ')
/*              chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'LIMIT 1000')   */



             CALL       PGM(XLSXCLODXP) PARM( &SQLSTMT &POST_LINK +
                          &PREFIX_FIL)

 ENDPGM:     ENDPGM
