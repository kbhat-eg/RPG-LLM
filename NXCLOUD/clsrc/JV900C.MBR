             PGM        PARM(&DATO &SETUPF &STATUS)

/* Sist kjørt dato. Sist gang denne CL ble kjørt uten feil! */
/* Dato skal ha formen yyyy.MM.dd (2010.12.01)              */
             DCL        VAR(&DATO) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SETUPF) TYPE(*CHAR) LEN(100)

/* Status settes til 0 ved OK. Settes til 1 ved feil.       */
             DCL        VAR(&STATUS) TYPE(*DEC) LEN(1 0)

             DCL        VAR(&SFILE) TYPE(*CHAR) LEN(150) +
                          VALUE('no.asp.as.setupFile=')

             CHGVAR     VAR(&SFILE) VALUE(&SFILE *TCAT &SETUPF)

             JAVA       +
                          CLASS('/java/asp/nobbexportcli/appstarter.j+
                          ar') PARM('produsenter' &DATO &SFILE) +
                          CHKPATH(*SECURE) OPTIMIZE(30) OUTPUT(* +
                          *CONTINUE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))
             JAVA       +
                          CLASS('/java/asp/nobbexportcli/appstarter.j+
                          ar') PARM('deltakere' &DATO &SFILE) +
                          OPTIMIZE(30) OUTPUT(* +
                          *CONTINUE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))
             JAVA       +
                          CLASS('/java/asp/nobbexportcli/appstarter.j+
                          ar') PARM('varegruppestruktur' &DATO +
                          &SFILE) OPTIMIZE(30) +
                          OUTPUT(* *CONTINUE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))
             DLYJOB     DLY(500)
             JAVA       +
                          CLASS('/java/asp/nobbexportcli/appstarter.j+
                          ar') PARM('moduler' &DATO &SFILE) +
                          OPTIMIZE(30) OUTPUT(* +
                          *CONTINUE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))
             DLYJOB     DLY(500)
             JAVA       +
                          CLASS('/java/asp/nobbexportcli/appstarter.j+
                          ar') PARM('varer' &DATO &SFILE) +
                          OPTIMIZE(30) OUTPUT(* +
                          *CONTINUE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))
             DLYJOB     DLY(1000)
             JAVA       +
                          CLASS('/java/asp/nobbexportcli/appstarter.j+
                          ar') PARM('priser' &DATO &SFILE) +
                          OPTIMIZE(30) OUTPUT(* +
                          *CONTINUE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(FEIL))

             CHGVAR     VAR(&STATUS) VALUE(0)
             GOTO       CMDLBL(END)

FEIL:
             CHGVAR     VAR(&STATUS) VALUE(1)
END:
             ENDPGM
