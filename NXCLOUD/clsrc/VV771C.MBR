             pgm        parm(&firm &batc &numm &lage &oppd &antl)

             dcl        var(&dswsid)   type(*char) len(10)
             dcl        var(&fgrp) type(*char) len(3)
             dcl        var(&firm) type(*dec)  len(3 0)
             dcl        var(&batc) type(*char) len(10)
             dcl        var(&numm) type(*dec)  len(6 0)
             dcl        var(&lage) type(*dec)  len(2 0)
             dcl        var(&antl) type(*dec)  len(2 0)
             dcl        var(&oppd) type(*char) len(1)
             dcl        var(&list) type(*char) len(1)
             dcl        var(&frafil)    type(*char) len(100) value(*blank)
             dcl        var(&tilfil)    type(*char) len(100) value(*blank)

             rtvdtaara  dtaara(*lda (931 03)) rtnvar(&fgrp)
             clrpfm     file(lwexpf)

/* Kaller varetype rette program                                     */

             call       pgm(VV771R) parm(&firm &batc &numm &lage &oppd +
                          &antl &list)
             IF         COND(&LIST *NE 'L') THEN(GOTO END)

/* Kopierer kvitteringsliste til IFS                                 */

             dltf       file(lwexkvpf)
             monmsg     msgid(cpf2105)

             crtpf      file(lwexkvpf) rcdlen(512) text('tempor√¶r +
                          kvitteringsfil') size(100000 10000)
             cpyf       fromfile(lwexpf) tofile(lwexkvpf) mbropt(*replace) +
                          fmtopt(*nochk)

             chgvar     var(&frafil) value('/qsys.lib/adb' *tcat &fgrp +
                          *tcat '.lib/lwexkvpf.file/lwexkvpf.mbr')
             chgvar     var(&tilfil) value('/asp/' *cat &fgrp *cat +
                          '/excel/varetype.xls')

             cpytostmf  frommbr(&frafil) tostmf(&tilfil) stmfopt(*replace) +
                          stmfcodpag(*pcascii)

 end:        endpgm
