             PGM

             DCL        VAR(&MIL) TYPE(*CHAR) LEN(3)

             DCL        VAR(&MODU)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&DISP)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&STAT)     TYPE(*CHAR) LEN(1)

             CHGVAR     VAR(&MODU)     VALUE(ADRA)
             CHGVAR     VAR(&DISP)     VALUE(1)
             CHGVAR     VAR(&STAT)     VALUE(0)
             CALL       PGM(AX700R) PARM(&MODU &DISP &STAT)

             IF         COND(&STAT *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             RTVDTAARA  DTAARA(*LDA (1003 3)) RTNVAR(&MIL)

/* Bygger filer dersom de ikke finnes:                               */

             CHKOBJ     OBJ(DADRPF) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
 DADRPF:     CRTPF      FILE(&MIL/DADRPF) SRCFILE(*LIBL/QDDFSRC) +
                          TEXT('Parameterfiler ADRA / ASP') +
                          MAXMBRS(*NOMAX) SIZE(*NOMAX)
             ENDDO

             CHKOBJ     OBJ(DADRL1) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
 DADRL1:     CRTLF      FILE(&MIL/DADRL1) SRCFILE(*LIBL/QDDFSRC) +
                          TEXT('Parameterfiler ADRA / ASP')
             ENDDO

             CHKOBJ     OBJ(DADTPF) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
 DADTPF:     CRTPF      FILE(&MIL/DADTPF) SRCFILE(*LIBL/QDDFSRC) +
                          TEXT('Koblingsfile ADRA / ASP') +
                          MAXMBRS(*NOMAX) SIZE(*NOMAX)
             ENDDO

             CHKOBJ     OBJ(DADTL1) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
 DADTL1:     CRTLF      FILE(&MIL/DADTL1) SRCFILE(*LIBL/QDDFSRC) +
                          TEXT('Koblingsfile ADRA / ASP')
             ENDDO
 ENDPGM:     ENDPGM
