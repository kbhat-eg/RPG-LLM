             PGM
/*                                                                   */
/*********************************************************************/
/* Initiering av parametre.                                          */
/*  &DSPROG = Programnavnet som brukes i formularfile.               */
/*  &DSRAPP = Navnet p√• rapporten i utskriftsprogram.                */
/*  &DSVALG = Verdi "1" - verdier kan vedlikeholdes                  */
/*                  "0" - verdier hentes fra formular/std            */
/*                                                                   */
/*  R6.10 Bruker ikke lenger AP100. Erstattet av AP600R              */
/*                                                                   */
/*                                                                   */
             DCL        VAR(&DSPROG) TYPE(*CHAR) LEN(10) +
                          VALUE('SF440C')
             DCL        VAR(&DSRAPP) TYPE(*CHAR) LEN(10) VALUE('LISTE')
             DCL        VAR(&DSVALG) TYPE(*CHAR) LEN(1) VALUE('1')
             DCL        VAR(&WPIN03) TYPE(*CHAR)  LEN(1)
             DCL        VAR(&DSBTCH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WPIN12) TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&WALI)   TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)   TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)   TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)   TYPE(*CHAR) LEN(40)
/*                                                                   */
/* Oppdaterer LDA med programnavn og kode for om formularparametre   */
/* skal endres.                                                      */
/*                                                                   */
             CHGDTAARA  DTAARA(*LDA (800 10)) VALUE(&DSPROG)
             CHGDTAARA  DTAARA(*LDA (844 1)) VALUE(&DSVALG)
             CHGDTAARA  DTAARA(*LDA (846 10)) VALUE(&DSRAPP)
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/* Call av parameterprogram, utskrift av mangler/matcher             */
/*                                                                   */
             CALL       PGM(SF440R) PARM(&WPIN03)
/*                                                                   */
             IF         COND(&WPIN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
/*                                                                   */
/* Call av program for formularparametre.                            */
/*                                                                   */
/*           CALL       PGM(AP100R) PARM(&WPIN03 &WPIN12)            */
             CALL       PGM(AP600R) PARM(&DSPROG '1' '0' &WPIN03 &DSBTCH)
/*                                                                   */
/* Avslutt dersom F3/F12                                             */
/*                                                                   */
             IF         COND(&WPIN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
             IF         COND(&WPIN12 *EQ 1) THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
             RTVDTAARA  DTAARA(*LDA (863 1)) RTNVAR(&DSBTCH)
/* Varselbilde 1                                                     */
             IF         COND(&DSBTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(34)
             CHGVAR     VAR(&MLD1) VALUE('Mangler/Matcher ........ ')
             CHGVAR     VAR(&MLD2) VALUE('**** AS STATISTIKK  **** ')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO
/*                                                                   */
/* Call av utskriftsprogram til batch/demand                         */
/*                                                                   */
             IF         COND(&DSBTCH *EQ '1') THEN(DO)
             SBMJOB     CMD(CALL PGM(SF444C)) JOB(&DSPROG)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
             CALL       PGM(SF444C)
/*                                                                   */
 ENDPGM:     ENDPGM
