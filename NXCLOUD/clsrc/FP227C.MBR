             PGM

             DCL        VAR(&PROG)   TYPE(*CHAR) LEN(10) +
                                     VALUE('FP228R    ')
             DCL        VAR(&RAPP)   TYPE(*CHAR) LEN(10) VALUE('PRINTER ')
             DCL        VAR(&USER)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&IN03)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&BTCH)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI)   TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)   TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)   TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)   TYPE(*CHAR) LEN(40)

             RTVDTAARA  DTAARA(*LDA (911 10)) RTNVAR(&USER)

/* Oppdaterer LDA med programnavn                                    */

             CHGDTAARA  DTAARA(*LDA (846 10)) VALUE(&RAPP)
             CHGDTAARA  DTAARA(*LDA (871 10)) VALUE(&PROG)

/*           Sjekk parameterregister                                 */

             CHKOBJ     OBJ(VPARPF) OBJTYPE(*FILE) MBR(&USER)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(VPARPF) MBR(&USER) TEXT('Parameter til +
                          FP228R')
             ENDDO

             CLRPFM     FILE(VPARPF) MBR(&USER)

/* Call av parameterprogram                                          */

             OVRDBF     FILE(PARAM) TOFILE(VPARPF) MBR(&USER)
             CALL       PGM(FP227R) PARM(&IN03)

             IF         COND(&IN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Call av program for formularparametre.                            */

             CALL       PGM(AP600R)    PARM('FP228' '1' '0' &IN03 &BTCH)

/* Avslutt dersom F3/F12                                             */

             IF         COND(&IN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             RTVDTAARA  DTAARA(*LDA (863 1)) RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)

/* Varselbilde 1                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(40)
             CHGVAR     VAR(&MLD1) VALUE('Utskrift av etiketter     ')
             CHGVAR     VAR(&MLD2) VALUE('***      ASOFAK       *** ')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Call av utskriftsprogram til batch/demand                         */

             IF         COND(&BTCH *EQ '1') THEN(DO)
             SBMJOB     CMD(CALL PGM(FP228C)) JOB(&PROG)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             CHGDTAARA  DTAARA(*LDA (871 10)) VALUE(&PROG)

             CALL       PGM(FP228C)

 ENDPGM:     ENDPGM
