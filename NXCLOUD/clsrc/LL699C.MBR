             PGM        PARM(&WHERE &POST_LINK &NUMM)

             DCL        VAR(&FIRMA) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&NUMM) TYPE(*DEC) LEN(8 0)
             DCL        VAR(&WHERE) TYPE(*CHAR) LEN(8000)
             DCL        VAR(&POST_LINK) TYPE(*CHAR) LEN(100)

             DCL        VAR(&SQLSTMT)  TYPE(*CHAR) LEN(10000)
             DCL        VAR(&PREFIX_FIL)    TYPE(*CHAR) LEN(20) +
                          VALUE('LAGERVERDI')


/*   Bygg SQL                                                                 */
             CHGVAR     VAR(&SQLSTMT) VALUE('SELECT +
                          lxlogr AS "Overgruppe", +
                          lxlhgr AS "Hovedgruppe", +
                          lxlugr AS "Undergruppe", +
                          lxllag AS "Lager", +
                          lxlnob AS "NOBB", +
                          lxlvar AS "Varenummer", +
                          lxltx1 AS "Varetekst 1", +
                          lxltx2 AS "Varetekst 2", +
                          lxlenh AS "Enhet", +
                          lxlsap AS "Salgspris", +
                          lxlkos AS "Kostpris", +
                          lxlgkp AS "Gjen.kostpris", +
                          lxlqty AS "Antall", +
                          lxlver AS "Verdi", +
                          lxlkve AS "Kostverdi", +
                          lxlgkv AS "Gjen.kostverdi", +
                          lxltda AS "Transdato" FROM lxl1st')

             chgvar var(&sqlstmt) +
                    value(&sqlstmt *BCAT ' WHERE LXLIDE=' +
                    *CAT %char(&numm))

/*           chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'WHERE FOFIRM=' +  */
/*                        *CAT %CHAR(&FIRMA))                                 */
/*           chgvar     var(&sqlstmt) value(&sqlstmt *Bcat &WHERE)            */
/*           chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'ORDER BY +        */
/*                        FODATE DESC, FOTIME DESC, FONUMM, FOSUFF ')         */
/*              chgvar     var(&sqlstmt) value(&sqlstmt *Bcat 'LIMIT 1000')   */



             CALL       PGM(XLSXCLODXP) PARM( &SQLSTMT &POST_LINK +
                          &PREFIX_FIL)

 ENDPGM:     ENDPGM
