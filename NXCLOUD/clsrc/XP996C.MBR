/*                                                                  */
             PGM        PARM(&FILG)

             DCL        VAR(&FILG) TYPE(*CHAR) LEN(10)

             DCLF       FILE(XPIPST)

/* Leser fra database fil. Finner hvilken IP og port 2DPOINT serveren */
/* lytter på for den bestemte filgruppen.                             */

LESFIL:      RCVF
             MONMSG     MSGID(CPF0864) EXEC(GOTO CMDLBL(NOTRIGG)) /* +
                          Hvis ingen adresse er definert for +
                          filgruppen så hopper vi ut uten å lage +
                          oppstyr. Andre feil bør logges! */

             IF         COND(&XIFILG *EQ &FILG) THEN(DO)
/* Skal være med, sørger for at triggere er registrert                */

/* Legge til trigger for eksport på ordre ved endring                */

             ADDPFTRG   FILE(&FILG/FOHEPF) TRGTIME(*AFTER) +
                          TRGEVENT(*UPDATE) PGM(XP993R) +
                          TRG(CHANGEORDRE) TRGUPDCND(*CHANGE)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP993R kunne ikke legges til fil FOHEPF'))

/* Legge til trigger for eksport på bestilling ved endring           */

             ADDPFTRG   FILE(&FILG/LOHEPF) TRGTIME(*AFTER) +
                          TRGEVENT(*UPDATE) PGM(XP901R) +
                          TRG(CHANGEBEST) TRGUPDCND(*CHANGE)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP901R kunne ikke legges til fil LOHEPF'))

/* Legge til triggere på Ordre                                       */

             ADDPFTRG   FILE(&FILG/FOHEPF) TRGTIME(*AFTER) +
                          TRGEVENT(*UPDATE) PGM(XP998R) +
                          TRG(CHANGEORDRE2)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil FOHEPF'))

/* Legge til triggere på enhet                                       */

             ADDPFTRG   FILE(&FILG/VVENPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETEENHET)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil VVENPF'))

/* Legge til triggere på Kontaktperson                               */

             ADDPFTRG   FILE(&FILG/RUKPPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETEKONTAKTPERSON)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil RUKPPF'))

/* Legge til triggere på Kunde                                       */

             ADDPFTRG   FILE(&FILG/RKUNPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETEKUNDE)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil RKUNPF'))

/* Legge til triggere på Kundeprosjekt                               */

             ADDPFTRG   FILE(&FILG/FKPRPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETEKUNDEPROSJEKT)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil FKPRPF'))

/* Legge til triggere på Leverandør                                  */

             ADDPFTRG   FILE(&FILG/RLEVPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETELEVERANDOR)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil RLEVPF'))

/* Legge til triggere på Pris                                        */

             ADDPFTRG   FILE(&FILG/VVPRPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETEPRIS)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil VVPRPF'))

/* Legge til triggere på Strekkode                                   */

             ADDPFTRG   FILE(&FILG/VEANPF) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(XP998R) +
                          TRG(DELETESTREKKODE)
             MONMSG     MSGID(CPF32C6) EXEC(SNDPGMMSG MSG('Trigger +
                          XP998R kunne ikke legges til fil VEANPF'))

/* Ferdig, gå til avslutt                                             */
             GOTO       CMDLBL(END)
             ENDDO

             GOTO       CMDLBL(LESFIL)
NOTRIGG:
             RMVPFTRG   FILE(&FILG/FOHEPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/VVENPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/RUKPPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/RKUNPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/FKPRPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/RLEVPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/VVPRPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
             RMVPFTRG   FILE(&FILG/VEANPF) TRGTIME(*ALL) TRG(*ALL) +
                          /* Hvis filgruppen ikke finnes i XPIPST +
                          så skal trigger evt. SLÅS AV. */
             MONMSG     MSGID(CPF0000)
END:
             ENDPGM
