             PGM
             DCLF       FILE(AG001D)

             DCL        VAR(&A1VSYS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VVER) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VMIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VPOS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VHST) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VCPH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VCPL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VNBH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VNBL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VXML) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1FGRP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&APLEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&APOKOK) TYPE(*CHAR) LEN(2)
             DCL        VAR(&M1MLD1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&M1MLD2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&M1SVAR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WPIN12) TYPE(*DEC)  LEN(1 0)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&APLEVL) VALUE('40')
             CHGVAR     VAR(&APOKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&APLEVL &APOKOK)
             IF         COND(&APOKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/*  Gi angrefrist dersom registere skal nullstilles..                */

             IF         COND(&A1NULL *EQ 'S') THEN(DO)
             CHGVAR     VAR(&M1MLD1) VALUE('Obs !  Det er bedt om +
                                     at data i filer skal slettes')
             CHGVAR     VAR(&M1MLD2) VALUE('Bekreft dersom dette +
                                     skal utf√∏res...')
             CHGVAR     VAR(&M1SVAR) VALUE('N')
             CALL       PGM(AA007R)  PARM(&M1MLD1 &M1MLD2 &M1SVAR +
                                          &WPIN12)
             ENDDO

             IF         COND(&WPIN12 *EQ 1)   THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&M1SVAR *EQ 'N') THEN(DO)
             CHGVAR     VAR(&A1NULL) VALUE(' ')
             ENDDO

/*  Genererer de valgte registere                                    */

             IF         COND(&A1VSYS *EQ '1') THEN(DO)
             CALL       PGM(AG020C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VVER *EQ '1') THEN(DO)
             CALL       PGM(AG026C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VPOS *EQ '1') THEN(DO)
             CALL       PGM(AG040C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VHST *EQ '1') THEN(DO)
             CALL       PGM(AG050C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VMIL *EQ '1') THEN(DO)
             CALL       PGM(AG028C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VCPH *EQ '1') THEN(DO)
             CALL       PGM(AG052C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VCPL *EQ '1') THEN(DO)
             CALL       PGM(AG054C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VNBH *EQ '1') THEN(DO)
             CALL       PGM(AG070C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VNBL *EQ '1') THEN(DO)
             CALL       PGM(AG074C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VXML *EQ '1') THEN(DO)
             CALL       PGM(AG091C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VKTI *EQ '1') THEN(DO)
                CALL       PGM(AG908C) PARM('AKTIST' &A1FGRP '*NONE' +
                             &A1NULL)
                CALL       PGM(AG908C) PARM('AHKTST' &A1FGRP '*NONE' +
                             &A1NULL)
             ENDDO

             IF         COND(&A1VLXM *EQ '1') THEN(DO)
                CALL       PGM(AG908C) PARM('ALXMST' &A1FGRP '*NONE' +
                             &A1NULL)
             ENDDO

             IF         COND(&A1VLGN *EQ '1') THEN(DO)
                CALL       PGM(AG908C) PARM('SLGNST' &A1FGRP '*NONE' +
                             &A1NULL)
             ENDDO

 ENDPGM:     ENDPGM
