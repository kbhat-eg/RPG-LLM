
/*-------------------------------------------------------------------*/
/* 261101 MHA:                                                       */

             PGM       PARM(&SERV &TIL &FRA &FIL +
                         &TYPE &RENAME &SUBJ &TEXT &BTEXT &CONV +
                         &SNDNAM)

             DCL       VAR(&SERV)      TYPE(*CHAR) LEN(35)
             DCL       VAR(&TIL)       TYPE(*CHAR) LEN(45)
             DCL       VAR(&FRA)       TYPE(*CHAR) LEN(45)
             DCL       VAR(&FIL)       TYPE(*CHAR) LEN(100)
             DCL       VAR(&TYPE)      TYPE(*CHAR) LEN(10)
             DCL       VAR(&RENAME)    TYPE(*CHAR) LEN(10)
             DCL       VAR(&SUBJ)      TYPE(*CHAR) LEN(250)
             DCL       VAR(&TEXT)      TYPE(*CHAR) LEN(250)
             DCL       VAR(&BTEXT)     TYPE(*CHAR) LEN(250)
             DCL       VAR(&CONV)      TYPE(*CHAR) LEN(10)
             DCL       VAR(&SNDNAM)    TYPE(*CHAR) LEN(20)

             DCL       VAR(&SERV2)     TYPE(*CHAR) LEN(40)
             DCL       VAR(&TIL2)      TYPE(*CHAR) LEN(50)
             DCL       VAR(&FRA2)      TYPE(*CHAR) LEN(50)
             DCL       VAR(&FIL2)      TYPE(*CHAR) LEN(105)
             DCL       VAR(&TYPE2)     TYPE(*CHAR) LEN(15)
             DCL       VAR(&RENAME2)   TYPE(*CHAR) LEN(15)
             DCL       VAR(&SUBJ2)     TYPE(*CHAR) LEN(256)
             DCL       VAR(&TEXT2)     TYPE(*CHAR) LEN(256)
             DCL       VAR(&BTEXT2)    TYPE(*CHAR) LEN(256)
             DCL       VAR(&CONV2)     TYPE(*CHAR) LEN(15)
             DCL       VAR(&WRKSTA2)   TYPE(*CHAR) LEN(14)
             DCL       VAR(&SNDNAM2)   TYPE(*CHAR) LEN(25)

             DCL        VAR(&WRKSTA)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&WRKTYP)   TYPE(*CHAR) LEN(1) VALUE('0')

             CHGVAR     VAR(&SERV2)    VALUE('-SVR' *CAT &SERV)
             CHGVAR     VAR(&TIL2)     VALUE('-TO' *CAT &TIL)
             CHGVAR     VAR(&FRA2)     VALUE('-FROM' *CAT &FRA)
             CHGVAR     VAR(&FIL2)     VALUE('-FILE' *CAT &FIL)
             CHGVAR     VAR(&TYPE2)    VALUE('-ATT' *CAT &TYPE)
             CHGVAR     VAR(&RENAME2)  VALUE('-REN' *CAT &RENAME)
             CHGVAR     VAR(&SUBJ2)    VALUE('-SUB' *CAT &SUBJ)
             CHGVAR     VAR(&TEXT2)    VALUE('-TXT' *CAT &TEXT)
             CHGVAR     VAR(&BTEXT2)   VALUE('-BTXT' *CAT &BTEXT)
             CHGVAR     VAR(&CONV2)    VALUE('-CON' *CAT &CONV)
             CHGVAR     VAR(&SNDNAM2)  VALUE('-SNDN' *CAT &SNDNAM)

             RTVJOBA    JOB(&WRKSTA)   TYPE(&WRKTYP)
             MONMSG     MSGID(CPF0000)
             IF         COND(&WRKTYP *EQ '0') THEN(DO)
             SBMJOB     CMD(JAVA CLASS(aspmail.MailSender) +
                          PARM(&SERV2 &TIL2 &FRA2 &FIL2 &TYPE2 +
                          &RENAME2 &SUBJ2 &TEXT2 &BTEXT2 &CONV2 +
                          &SNDNAM2) +
                          CLASSPATH('/java:/QIBM/ProdData/HTTP/Public+
                          /jt400/lib/jt400.jar')) JOB(EMAIL) +
                          LOGCLPGM(*NO) MSGQ(*NONE)
             ENDDO
             ELSE       CMD(DO)
             CHGVAR     VAR(&WRKSTA2)  VALUE('-WRK' *CAT &WRKSTA)
             SBMJOB     CMD(JAVA CLASS(aspmail.MailSender) +
                          PARM(&SERV2 &TIL2 &FRA2 &FIL2 &TYPE2 +
                          &RENAME2 &SUBJ2 &TEXT2 &BTEXT2 &CONV2 +
                          &WRKSTA2 &SNDNAM2) +
                          CLASSPATH('/java:/QIBM/ProdData/HTTP/Public+
                          /jt400/lib/jt400.jar')) JOB(EMAIL) +
                          LOGCLPGM(*NO) MSGQ(*NONE)
             ENDDO
 ENDPGM:     ENDPGM
