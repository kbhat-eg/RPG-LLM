
/* Programmet benytte for å finne riktig program                     */
/* for å kontrollere om det finnes registrerte bestillinger på       */
/* leverandører i ASLAGR, ASSERV                                     */

 STRPGM:     PGM        PARM(&FIRM &LEVR &STAT)

             DCL        VAR(&FIRM) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&LEVR) TYPE(*DEC) LEN(6 0)
             DCL        VAR(&STAT) TYPE(*CHAR) LEN(1)

             DCL        VAR(&BTCH)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)

/*           Sjekk om program for ASLAGR finnes                      */

             CHKOBJ     OBJ(*LIBL/LO792R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ASSERV)

             RTVDTAARA  DTAARA(*LDA (863 1)) RTNVAR(&BTCH)

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASLAGR ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             CHGDTAARA  DTAARA(*LDA (863 1)) VALUE('1')
             ENDDO

             CALL       PGM(LO792R)    PARM(&FIRM &LEVR &STAT)

 ASSERV:

/*           Sjekk om program for ASSERV finnes                      */

             CHKOBJ     OBJ(*LIBL/IB792R) OBJTYPE(*PGM)
             MONMSG     MSGID(CPF9801) EXEC(GOTO ENDPGM)

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(8)
             CHGVAR     VAR(&WAPO) VALUE(36)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Sjekker ASSERV ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             CHGDTAARA  DTAARA(*LDA (863 1)) VALUE('1')
             ENDDO

             CALL       PGM(IB792R)    PARM(&FIRM &LEVR &STAT)

 ENDPGM:     ENDPGM
