             PGM

/* Initiering av parametre.                                          */

             DCL        VAR(&FIRM)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&BTCH)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&WMM1)  TYPE(*CHAR) LEN(10) VALUE('INKA    ')
             DCL        VAR(&PSKR)  TYPE(*CHAR) LEN(1)

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (944 3)) RTNVAR(&FIRM)
             CHGVAR     VAR(%SST(&WMM1 5 3)) VALUE(&FIRM)

/* Utplukking av poster                                              */

             CLRPFM     FILE(RKWBPF) MBR(&WMM1)
             MONMSG     MSGID(CPF3100)

/* Bygger membere dersom de ikke finnes                              */

chkrkwa:     CHKOBJ     OBJ(RKWAPF) OBJTYPE(*FILE) MBR(&WMM1)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RKWAPF) MBR(&WMM1) TEXT('Parameter for +
                          Inkasso - forslag)')
               monmsg   msgid(cpf7306) exec(do)
               chgpf    file(RKWAPF) maxmbrs(*nomax)
               goto     chkrkwa
               enddo
             ENDDO

chkrkwb:     CHKOBJ     OBJ(RKWBPF) OBJTYPE(*FILE) MBR(&WMM1)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(RKWBPF) MBR(&WMM1) TEXT('Poster fra +
                          Inkasso - forslag')
               monmsg   msgid(cpf7306) exec(do)
               chgpf    file(RKWBPF) maxmbrs(*nomax)
               goto     chkrkwb
               enddo
             ENDDO

chkrkwblu:   CHKOBJ     OBJ(RKWBLU) OBJTYPE(*FILE) MBR(&WMM1)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(RKWBLU) MBR(&WMM1) DTAMBRS((RKWBPF +
                          (&WMM1))) TEXT('Poster fra +
                          Inkasso - forslag')
               monmsg   msgid(cpf7306) exec(do)
               chglf    file(RKWBlu) maxmbrs(*nomax)
               goto     chkrkwblu
               enddo
             ENDDO

             CLRPFM     FILE(RKWBPF) MBR(&WMM1)

/* Utplukking av poster                                              */

             OVRDBF     FILE(RKWBPF) MBR(&WMM1)
             CALL       PGM(RC651R)

             RTVDTAARA  DTAARA(*LDA (469 1))  RTNVAR(&PSKR)

/* Utskrift av kontrolliste - nye saker                              */

             if         cond(&pskr *eq 'J') then(do)
               call     pgm(RC652C)
             enddo

             DLTOVR     FILE(RKWBPF)
             MONMSG     MSGID(CPF3200)

 END:        ENDPGM
