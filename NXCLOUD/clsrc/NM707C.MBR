             PGM

/* Initiering av parametre.                                          */

             DCL        VAR(&FTPNAV) TYPE(*CHAR) LEN(10) +
                          VALUE('LOGVARLAG')
             DCL        VAR(&STATUS) TYPE(*CHAR) LEN(1)  VALUE(' ')
             DCL        VAR(&TILNAV) TYPE(*CHAR) LEN(20) VALUE(' ')
             DCL        VAR(&VISMLD) TYPE(*CHAR) LEN(1)  VALUE('1')
             DCL        VAR(&JOBTYP) TYPE(*CHAR) LEN(1)

/* Henter jobbtype                                                   */

             RTVJOBA    TYPE(&JOBTYP)

/* Setter biblioteksliste og current library dersom batch-jobb       */

/*           IF         COND(&JOBTYP *EQ '0') THEN(DO)               */
/*           CALL       PGM(AA700R) PARM('ASP_fgr   ')               */
/*           ENDDO                                                   */

/* Blanker ut gammel lagerfil                                        */

             CLRPFM     FILE(NETVARLAG) MBR(NETVARLAG)
             MONMSG     MSGID(CPF3141) EXEC(ADDPFM +
                          FILE(*CURLIB/NETVARLAG) MBR(NETVARLAG))

/* Kjører generering av ny lagerfil                                  */

             CALL       PGM(NM707R) PARM(&STATUS)
             IF         COND(&STATUS *NE ' ') THEN(DO)
             SNDPGMMSG  MSG('Nettbutikk finnes ikke for dette firma')
             GOTO       CMDLBL(END)
             ENDDO

             CHGVAR     VAR(&STATUS) VALUE(' ')

/* Overfører malfil til Logiq via FTP                                   */

             CALL       PGM(AF700C) PARM(&FTPNAV &STATUS &TILNAV +
                          &VISMLD)

/* Gir beskjed ved feil                                                 */

             IF         COND(&STATUS *NE ' ') THEN(SNDPGMMSG +
                          MSG('Feil ved sending av kundefil'))

 END:        ENDPGM
