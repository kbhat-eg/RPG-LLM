             PGM

/* Definere parametere og variabler                                  */

             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&TYPE)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&WSID)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&WALI)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)     TYPE(*CHAR) LEN(40)

             DCL        VAR(&FIRM) TYPE(*CHAR) LEN(3)
             DCL        VAR(&PAAR) TYPE(*CHAR) LEN(4)
             DCL        VAR(&BOTY) TYPE(*CHAR) LEN(2)
             DCL        VAR(&KFRA) TYPE(*CHAR) LEN(4)
             DCL        VAR(&KTIL) TYPE(*CHAR) LEN(4)
             DCL        VAR(&KNRF) TYPE(*CHAR) LEN(6)
             DCL        VAR(&KNRT) TYPE(*CHAR) LEN(6)

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)
             RTVDTAARA  DTAARA(*LDA (300 4))  RTNVAR(&PAAR)
             RTVDTAARA  DTAARA(*LDA (308 4))  RTNVAR(&KFRA)
             RTVDTAARA  DTAARA(*LDA (312 4))  RTNVAR(&KTIL)
             RTVDTAARA  DTAARA(*LDA (316 6))  RTNVAR(&KNRF)
             RTVDTAARA  DTAARA(*LDA (322 6))  RTNVAR(&KNRT)
             RTVDTAARA  DTAARA(*LDA (328 2))  RTNVAR(&BOTY)

/* Varselbilde 2                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(6)
             CHGVAR     VAR(&WAPO) VALUE(40)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Utskrift pågår ..........')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Call av program, utskrift av bonusgrunnlag - kunder               */

/* Overstyring av printerfile                                        */

             CALL       PGM(AP601C)    PARM('EK602P' &BTCH)

             CALL       PGM(EK602R) PARM(&FIRM &PAAR &BOTY &KFRA &KTIL +
                        &KNRF &KNRT)

             CALL       PGM(AP606C)    PARM('EK602P')

/* Melding dersom bakgrunnsjobb                                      */

             IF         COND(&BTCH *EQ '1') THEN(DO)
             RTVDTAARA  DTAARA(*LDA (901 10)) RTNVAR(&WSID)
             SNDBRKMSG  MSG('ASOFAK: Rutinen for utskrift av kunde+
                        brev er ferdig') TOMSGQ(&WSID)
             ENDDO
 END:        ENDPGM
