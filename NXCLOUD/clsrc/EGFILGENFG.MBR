             PGM        parm(&fgr)

/*                                                                   */

             DCL        VAR(&IN12)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD3)  TYPE(*CHAR) LEN(50)
             DCL        VAR(&MLD4)  TYPE(*CHAR) LEN(50)
             DCL        VAR(&SVAR)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&fgr)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&grp)   TYPE(*CHAR) LEN(10)  value('GRP_   ')
             DCL        VAR(&fil)   TYPE(*char) LEN(10)
             DCL        VAR(&wfil)  TYPE(*char) LEN(10)

             dclf       file(*libl/genfst)

             call       pgm(aa724c) parm(&fgr)

 /* Sletter tabeller som skal bygges på nytt */

             dltf       file(RCNRPF)
             monmsg     msgid(CPF2105)
             dltf       file(RCNSPF)
             monmsg     msgid(CPF2105)
             dltf       file(RCNTPF)
             monmsg     msgid(CPF2105)
             dltf       file(RAUTPF)
             monmsg     msgid(CPF2105)

 /* Leser parrameter fil og behandler aktuelle tabeller  */

             chgvar     var(%sst(&grp 5 03))   value(&fgr)

rcv:         rcvf
             monmsg     msgid(cpf0864) exec(goto endpgm)
             chgvar     var(&fil)   value(%sst(&table 1 6))

 /* Avvikshåndtering for noen tabeller */

             if         cond(&fil = 'GENFST') then(do)
                goto       cmdlbl(rcv)
             enddo
             if         cond(&fil = 'XRFIST') then(do)
                goto       cmdlbl(rcv)
             enddo
             if         cond(&fil = 'XRHEST') then(do)
                goto       cmdlbl(rcv)
             enddo
             if         cond(&fil = 'XRMDST') then(do)
                goto       cmdlbl(rcv)
             enddo
             if         cond(&fil = 'SYSCST') then(do)
                goto       cmdlbl(rcv)
             enddo
             if         cond(&fil = &wfil) then(do)
                goto       cmdlbl(rcv)
             enddo
             chgvar     var(&wfil)   value(&fil)

 /* Behandling av aktuelle tabeller */

             chgvar     var(&mld1) value('Generering av  ' *cat &fil)
             chgvar     var(&mld2) value('                           ')
             call       PGM(ss006C)  PARM(5 10 &MLD1 &MLD2)
             if         cond(%sst(&fil 5 2) = 'ST') then(do)
                 call   pgm(ag908c) parm(&fil &fgr &grp ' ')
                 goto     cmdlbl(rcv)
             enddo
             if         cond(%sst(&fil 5 2) = 'PF') then(do)
                 call   pgm(ag906c) parm(&fil &fgr &grp ' ')
                 goto     cmdlbl(rcv)
             enddo
             chgvar     var(&mld3) value('File ' *cat &fil *cat ' ble ikke +
                                          generert')
             chgvar     var(&mld4) value('   Vennligst bekreft.     ')
             call       pgm(AA007R)  parm(&mld3 &mld4 &svar &in12)
             goto   cmdlbl(rcv)


 endpgm:     endpgm
