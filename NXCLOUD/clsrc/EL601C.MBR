/*------------------------------------------------------------------------*/
/*                                                                        */
/*                                                                        */
/*                                                                        */
/*                                                                        */
/*------------------------------------------------------------------------*/
             PGM        PARM(&POST_LINK &NUMM)

             DCL        VAR(&POST_LINK) TYPE(*CHAR) LEN(100)
             DCL        VAR(&NUMM) TYPE(*DEC) LEN(8 0)

             DCL        VAR(&WHERE) TYPE(*CHAR) LEN(100)


             DCL        VAR(&SQLSTMT)  TYPE(*CHAR) LEN(10000)
             DCL        VAR(&PREFIX_FIL)    TYPE(*CHAR) LEN(50) +
                          VALUE('leverandorbonus_')


/* Bygg fil av alle brukere p√• systemet                                       */
             DSPUSRPRF  USRPRF(*ALL) OUTPUT(*OUTFILE) +
                          OUTFILE(*CURLIB/USRPRF)


/*   Bygg SQL                                                                 */

             CHGVAR     VAR(&SQLSTMT) VALUE('SELECT +
                          lx5ble AS "Bonusleverandor", +
                          lx5bln AS "Navn", +
                          lx5lev AS "Leverandor", +
                          lx5ogr AS "Overgruppe", +
                          lx5hgr AS "Hovedgruppe", +
                          lx5ugr AS "undergruppe", +
                          lx5ogr AS "Overgruppe", +
                          lx5mod AS "Modul", +
                          lx5var AS "Varenummer", +
                          lx5enh AS "Enhet", +
                          lx5lty AS "Leveringstype", +
                          lx5bty AS "Bonustype", +
                          lx5bna AS "Tekst", +
                          lx5fda AS "Fra dato", +
                          lx5tda AS "Til dato", +
                          lx5mrk AS "Merknad", +
                          lx5bgr AS "Bonusgrunnlag", +
                          lx5bon AS "Bonus", +
                          lx5bda AS "Beregnet dato"  FROM lxl5st')

             chgvar var(&sqlstmt) +
                    value(&sqlstmt *BCAT ' WHERE LX5IDE=' +
                    *CAT %char(&numm))


             CALL       PGM(XLSXCLODXP) PARM( &SQLSTMT &POST_LINK +
                          &PREFIX_FIL)

 ENDPGM:     ENDPGM
