             PGM
             DCLF       FILE(AG003D)

             DCL        VAR(&A1VUSR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VLIB) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VFIL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VENH) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VMOD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1MILJ) TYPE(*CHAR) LEN(3)
             DCL        VAR(&APLEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&APOKOK) TYPE(*CHAR) LEN(2)
             DCL        VAR(&M1MLD1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&M1MLD2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&M1SVAR) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WPIN12) TYPE(*DEC)  LEN(1 0)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&APLEVL) VALUE('40')
             CHGVAR     VAR(&APOKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&APLEVL &APOKOK)
             IF         COND(&APOKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/*  Gi angrefrist dersom registere skal nullstilles..                */

             IF         COND(&A1NULL *EQ 'S') THEN(DO)
             CHGVAR     VAR(&M1MLD1) VALUE('Obs !  Det er bedt om +
                                     at data i filer skal slettes')
             CHGVAR     VAR(&M1MLD2) VALUE('Bekreft dersom dette +
                                     skal utf√∏res...')
             CHGVAR     VAR(&M1SVAR) VALUE('N')
             CALL       PGM(AA007R)  PARM(&M1MLD1 &M1MLD2 &M1SVAR +
                                          &WPIN12)
             ENDDO

             IF         COND(&WPIN12 *EQ 1)   THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&M1SVAR *EQ 'N') THEN(DO)
             CHGVAR     VAR(&A1NULL) VALUE(' ')
             ENDDO

/*  Genererer de valgte registere                                    */

             IF         COND(&A1VUSR *EQ '1') THEN(DO)
             CALL       PGM(AG022C) PARM(&A1MILJ &A1NULL)
             ENDDO

             IF         COND(&A1VLIB *EQ '1') THEN(DO)
             CALL       PGM(AG018C) PARM(&A1MILJ &A1NULL)
             ENDDO

             IF         COND(&A1VFIL *EQ '1') THEN(DO)
             CALL       PGM(AG012C) PARM(&A1MILJ &A1NULL)
             ENDDO

             IF         COND(&A1VENH *EQ '1') THEN(DO)
             CALL       PGM(AG010C) PARM(&A1MILJ &A1NULL)
             ENDDO

             IF         COND(&A1VMOD *EQ '1') THEN(DO)
             CALL       PGM(AG030C) PARM(&A1MILJ &A1NULL)
             ENDDO

 ENDPGM:     ENDPGM
