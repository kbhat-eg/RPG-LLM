             PGM        parm(&mappf &filt &fils &feil)

/* 021214 bof : Endret testen for å takle både shop/ordre på en test */
/*              Denne skal ikke ligge i askund_xxx (fra 6.20)        */

             /*                                              */
             /*                                  */
             DCL        VAR(&feil)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&mappf) TYPE(*CHAR) LEN(25)
             DCL        VAR(&tst)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&tstf)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&fil)   TYPE(*CHAR) LEN(20)
             DCL        VAR(&filt)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&fils)  TYPE(*CHAR) LEN(1)
             DCLf       file(Iwbrk)
/*                                                                   */
/* Les alle forekomster og kjør jobb som behandler filen             */
/*                                                                   */

nyrcv:       rcvf
             monmsg   msgid(CPF0864) exec(do)
                      goto cmdlbl(endpgm)
               enddo
/*                                                                */
             chgvar   var(&tst)  value(%substring(&iwbrk 30 10))
             chgvar   var(&tstf) value(%substring(&iwbrk 2 1))
             chgvar   var(&fil)  value(%substring(&iwbrk 2 20))
/* fjerner denne testen pga. den vil variere om det er ordre eller shop */
/*           if         cond(&tst *ne &filt) then(do)                   */
/*             goto   cmdlbl(nyrcv)                                     */
/*           enddo                                                      */
/*----------------------------------------------------------------------*/
             if         cond(&tstf *ne &fils) then(do)
                goto       cmdlbl(nyrcv)
             enddo
/*                                                                */
             CHGVAR     VAR(&FEIL) VALUE('0')
/** 1.  Endre til riktig kundebibl.                               */
             CALL       PGM(*LIBL/FO787C) PARM(&MAPPF)
/* hvis feilstatus på - gå ut av rutinen */

             IF         COND(&FEIL *EQ '1') THEN(GOTO CMDLBL(ENDPGM))

             goto       cmdlbl(nyrcv)

/*                                                                   */
 ENDPGM:     ENDPGM
