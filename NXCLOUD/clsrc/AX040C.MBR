             PGM

/* Denne filen må bygges før programmet compileres                   */
/*           CRTPF      FILE(ASPGPLK/WDLDSC) RCDLEN(132)             */

             DCLF       FILE(ASPGPLK/WDLDSC) ALWNULL(*YES)

             DCL        VAR(&JOBX)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBU)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBN)     TYPE(*CHAR) LEN(6)
             DCL        VAR(&JOBS)     TYPE(*CHAR) LEN(4)

             MONMSG     MSGID(CPF0000)

             CRTPF      FILE(ASPGPLK/WDLDSC) RCDLEN(132)

             WRKUSRJOB  USER(*ALL)     STATUS(*ALL) OUTPUT(*PRINT) +
                                       JOBTYPE(*INTERACT)
             CPYSPLF    FILE(QPDSPSBJ) TOFILE(ASPGPLK/WDLDSC) +
                                       SPLNBR(*LAST)
             DLTSPLF    FILE(QPDSPSBJ) SPLNBR(*LAST)

RCV:         RCVF
             MONMSG     MSGID(CPF0864) EXEC(GOTO ENDPGM)
             CHGVAR     VAR(&JOBS)     VALUE(%SUBSTRING(&WDLDSC 49 4))

             IF         COND(&JOBS *NE 'DSC ') THEN(GOTO CMDLBL(RCV))
             CHGVAR     VAR(&JOBX)     VALUE(%SUBSTRING(&WDLDSC 4 10))
             CHGVAR     VAR(&JOBU)     VALUE(%SUBSTRING(&WDLDSC 17 10))
             CHGVAR     VAR(&JOBN)     VALUE(%SUBSTRING(&WDLDSC 30 6))

             ENDJOB     JOB(&JOBN/&JOBU/&JOBX) OPTION(*IMMED)

             GOTO       CMDLBL(RCV)

 ENDPGM:     ENDPGM
