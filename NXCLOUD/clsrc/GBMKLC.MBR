
/*           Generere BM Kundeklubb                                  */

 STRPGM:     PGM        parm(&DBIB &grpf)

             DCL        VAR(&DBIB) TYPE(*CHAR) LEN(6)
             DCL        VAR(&grpf) TYPE(*CHAR) LEN(7)

             DCL        VAR(&SFI1) TYPE(*CHAR) LEN(6) VALUE('BBBESQ')
             DCL        VAR(&SFI2) TYPE(*CHAR) LEN(6) VALUE('BCKUSQ')


/*           Setter bibliotek til current                            */

             CHGCURLIB  CURLIB(&DBIB)

/*           Starter å opprette filer                                */

/* Kjører SQL-statements for oppretting av tabell og indekser        */

             RUNSQLSTM  SRCFILE(*libl/QSQLSRC) SRCMBR(&SFI1) +
                          NAMING(*SYS) DECMPT(*COMMA) +
                          SRTSEQ(*LANGIDUNQ) LANGID(NOR)
 /* Sette rettigheter                                                   */
             CHGOBJOWN  OBJ(&dbib/bbbest) OBJTYPE(*FILE) NEWOWN(ASP)
             CHGOBJOWN  OBJ(&dbib/bbbeiu) OBJTYPE(*FILE) NEWOWN(ASP)
             GRTOBJAUT  OBJ(&dbib/BBBEST) OBJTYPE(*ALL) USER(&grpf) +
                          AUT(*ALL)  REPLACE(*YES)
             GRTOBJAUT  OBJ(&dbib/bbbeiu) OBJTYPE(*ALL) USER(&grpf) +
                          AUT(*ALL)  REPLACE(*YES)
             GRTOBJAUT  OBJ(&dbib/bbbest) OBJTYPE(*ALL) USER(*PUBLIC) +
                          AUT(*EXCLUDE) REPLACE(*YES)
             GRTOBJAUT  OBJ(&dbib/bbbeiu) OBJTYPE(*ALL) USER(*PUBLIC) +
                          AUT(*EXCLUDE) REPLACE(*YES)


             RUNSQLSTM  SRCFILE(*libl/QSQLSRC) SRCMBR(&SFI2) +
                          NAMING(*SYS) DECMPT(*COMMA) +
                          SRTSEQ(*LANGIDUNQ) LANGID(NOR)
 /* Sette rettigheter                                                   */
             CHGOBJOWN  OBJ(&dbib/bckust) OBJTYPE(*FILE) NEWOWN(ASP)
             CHGOBJOWN  OBJ(&dbib/bckuiu) OBJTYPE(*FILE) NEWOWN(ASP)
             GRTOBJAUT  OBJ(&dbib/bckust) OBJTYPE(*ALL) USER(&grpf) +
                          AUT(*ALL)  REPLACE(*YES)
             GRTOBJAUT  OBJ(&dbib/bckuiu) OBJTYPE(*ALL) USER(&grpf) +
                          AUT(*ALL)  REPLACE(*YES)
             GRTOBJAUT  OBJ(&dbib/bckust) OBJTYPE(*ALL) USER(*PUBLIC) +
                          AUT(*EXCLUDE) REPLACE(*YES)
             GRTOBJAUT  OBJ(&dbib/bckuiu) OBJTYPE(*ALL) USER(*PUBLIC) +
                          AUT(*EXCLUDE) REPLACE(*YES)


/* Starter journalføring av de filene som trengs                     */

             STRJRNPF FILE(&DBIB/BBBEST) JRN(&DBIB/BUTIJRN)    +
                          OMTJRNE(*OPNCLO)
             MONMSG   MSGID(CPF7030)

             STRJRNPF   FILE(&DBIB/BCKUST) JRN(&DBIB/BUTIJRN) OMTJRNE(*OPNCLO)
             MONMSG   MSGID(CPF7030)

 ENDPGM:     ENDPGM
