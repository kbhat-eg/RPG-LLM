             PGM        PARM(&MEMBR &ONUMM &OSUFF)

/* Initiering av parametre.                                          */

             DCL        VAR(&MEMBR)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&ONUMM)    TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&OSUFF)    TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&OVRF) TYPE(*CHAR) LEN(10) +
                          VALUE('HEIDENBEST')
             DCL        VAR(&FILN)  TYPE(*CHAR) LEN(20)
             DCL        VAR(&STAT)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&SMSG)  TYPE(*CHAR) LEN(1) VALUE('1')

/* Bygger member og overstyrer                                       */

             CHKOBJ     OBJ(LWNEPF) OBJTYPE(*FILE) MBR(&MEMBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(LWNEPF) MBR(&MEMBR) TEXT('Bestilling +
                          i EFO/NELFO-format')
             ENDDO
             OVRDBF     FILE(LWNEPF) TOFILE(LWNEPF) MBR(&MEMBR)

/* Kaller genereringsprogram                                         */

             CALL       PGM(LO775R) PARM(&ONUMM &OSUFF &FILN)
             DLTOVR     FILE(LWNEPF)
             CPYF       FROMFILE(LWNEPF) TOFILE(LWNEPF) +
                          FROMMBR(&MEMBR) TOMBR(LWNEPF) +
                          MBROPT(*REPLACE)

             CALL       PGM(AF700C) PARM(&OVRF &STAT &FILN &SMSG)

/* Tømmer overføringsfile for poster                                 */

             IF         COND(&STAT *EQ ' ') THEN(CHGVAR VAR(&STAT) +
                          VALUE('0'))
             RMVM       FILE(LWNEPF) MBR(&MEMBR)
             RMVM       FILE(LWNEPF) MBR(LWNEPF)
 END:        ENDPGM
