/*                                                                   */
/*-------------------------------------------------------------------*/
/* Program for Ã¥ opprette views                                      */
/*                                                                   */
/* angi filgrupppe og *ALL eller tabellnavn                          */
/*                                                                   */
/* eks: CALL VIEWCRT PARM('630' 'ADBLVR630' 'A40' 'VVARPF' '630')    */
/* eks: CALL VIEWCRT PARM('630' 'ADBLVR630' 'A40' '*ALL' '630')      */
/*                                                                   */

             PGM        parm(&FGRP_P &LVRB_P &ENVB_P &TBLE_P &VER_P)

 /* Parametre                                                         */
             DCL        VAR(&FGRP_P)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&LVRB_P)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&ENVB_P)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&TBLE_P)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&VER_P)     TYPE(*CHAR) LEN(3)

             DCL        VAR(&VER)       TYPE(*DEC) LEN(3 0)
             DCL        VAR(&DBIB)      TYPE(*CHAR) LEN(6) VALUE('ADB400')

 /* Sjekk Parametre                                                    */
             IF         COND(&TBLE_P *EQ ' ') THEN(DO)
                CHGVAR     VAR(&TBLE_P) VALUE('*ALL')
             ENDDO

             IF         COND(&LVRB_P *EQ ' ') THEN(DO)
                RTVOBJD    OBJ(JVARPF) OBJTYPE(*FILE) RTNLIB(&LVRB_P)
             ENDDO

             IF         COND(&ENVB_P *EQ ' ') THEN(DO)
                RTVDTAARA  DTAARA(*LDA (1003 3)) RTNVAR(&ENVB_P)
             ENDDO

             IF         COND(&VER_P *EQ ' ') THEN(DO)
                call       pgm(AR700R) parm(&ENVB_P &VER)
                CHGVAR     VAR(&VER_P) VALUE(%CHAR(&VER))
             ENDDO

             CHGVAR     VAR(%SST(&DBIB 4 3)) VALUE(&FGRP_P)
             CHGCURLIB  CURLIB(&DBIB)

             ADDLIBLE   &LVRB_P
             MONMSG     MSGID(CPF2103)

             ADDLIBLE   &ENVB_P
             MONMSG     MSGID(CPF2103)

             RUNSQL     SQL('CALL ADB.SP_NEXSTEP_CREATE_VIEW_' *CAT &VER_P +
                          *CAT '(''' *cat &DBIB *bcat ''',''' *cat &TBLE_P +
                          *bcat ''')') COMMIT(*NONE) NAMING(*SYS) +
                          DECMPT(*COMMA) SRTSEQ(*LANGIDUNQ) LANGID(NOR)

 END:        ENDPGM

