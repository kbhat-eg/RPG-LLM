             PGM        PARM(&PFILE &PFLDR &PLAGR &PFEIL)
/* 120219 nho Nytt program                                           */
/* Initiering av parametre.                                          */

             DCL        VAR(&PFILE)    TYPE(*CHAR) LEN(12)
             DCL        VAR(&PFLDR)    TYPE(*CHAR) LEN(20)
             DCL        VAR(&PLAGR)    TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&PFEIL)    TYPE(*CHAR) LEN(1)

             dcl        var(&frmfile)  type(*char) len(50)
             dcl        var(&tofile)   type(*char) len(50)
             dcl        var(&fgr)      type(*char) len(3)

/* Initierer feil-flagg                                              */

             CHGVAR     VAR(&PFEIL)    VALUE('0')

/* Tømmer arbeidsfil og lager temporær fil                           */

             CLRPFM     FILE(GJKIPF)
             DLTF       FILE(FAKTMP)
             MONMSG     MSGID(CPF2105)
             CRTPF      FILE(FAKTMP) RCDLEN(500)

/* Redigerer filstier og kopierer regneark-fil til innlesningsfil    */

             RTVDTAARA  DTAARA(*LDA (931 03)) RTNVAR(&FGR)

             CHGVAR     VAR(&FRMFILE) VALUE('/home/adb' *cat &fgr *cat '/' +
                          *tcat &PFLDR *tcat '/' *tcat &PFILE)

             CHGVAR     VAR(&TOFILE) VALUE('/qsys.lib/adb' *cat &fgr *cat +
                          '.lib/faktmp.file/faktmp.mbr')

             CPYFRMSTMF FROMSTMF(&FRMFILE) TOMBR(&TOFILE) MBROPT(*REPLACE)

             CPYF       FROMFILE(FAKTMP) TOFILE(GJKIPF) MBROPT(*REPLACE) +
                          FMTOPT(*NOCHK)

/* Oppdatering av kostprisfaktorer                                   */

             CALL       PGM(VG811R) PARM(&PLAGR)
             GOTO       CMDLBL(END)

 FEIL:       CHGVAR     VAR(&PFEIL) VALUE('1')

 END:        ENDPGM
