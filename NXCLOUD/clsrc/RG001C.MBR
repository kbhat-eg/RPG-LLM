             PGM

             DCLF       FILE(RG001D)

             DCL        VAR(&A1VAA1) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA2) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA3) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA4) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA5) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA6) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA7) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA8) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VAA9) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VA70) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1FGRP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&APLEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&APOKOK) TYPE(*CHAR) LEN(2)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&APLEVL) VALUE('40')
             CHGVAR     VAR(&APOKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&APLEVL &APOKOK)
             IF         COND(&APOKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */

             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/*  Genererer de valgte registere                                    */

             IF         COND(&A1VAA1 *EQ '1') THEN(DO)
             CALL       PGM(RGAA1C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA2 *EQ '1') THEN(DO)
             CALL       PGM(RGAA2C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA3 *EQ '1') THEN(DO)
             CALL       PGM(RGAA3C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA4 *EQ '1') THEN(DO)
             CALL       PGM(RGAA4C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA5 *EQ '1') THEN(DO)
             CALL       PGM(RGAA5C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA6 *EQ '1') THEN(DO)
             CALL       PGM(RGAA6C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA7 *EQ '1') THEN(DO)
             CALL       PGM(RGAA7C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA8 *EQ '1') THEN(DO)
             CALL       PGM(RGAA8C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAA9 *EQ '1') THEN(DO)
             CALL       PGM(RGAA9C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VA70 *EQ '1') THEN(DO)
             CALL       PGM(RGA70C) PARM(&A1FGRP &A1NULL)
             ENDDO

 ENDPGM:     ENDPGM
