/* 010715  nho  Fjernet call til RP510R                             */
             PGM
             DCLF       FILE(RM10)
             DCL        VAR(&FNAV)     TYPE(*CHAR) LEN(30)
             DCL        VAR(&skan)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&fgr)      TYPE(*CHAR) LEN(3)
             DCL        VAR(&fir)      TYPE(*CHAR) LEN(3)
             DCL        VAR(&sp)       TYPE(*char) LEN(1)
             DCL        VAR(&rut)      TYPE(*char) LEN(50)

             MONMSG     MSGID(CPF0001) EXEC(GOTO MELDE)
             MONMSG     MSGID(CPA0701) EXEC(GOTO START)
             MONMSG     MSGID(CPF0000) EXEC(GOTO START)
             MONMSG     MSGID(CPF9999) EXEC(GOTO START)

 START:      RTVDTAARA  DTAARA(*LDA (951 30)) RTNVAR(&FNAV)
             rtvdtaara  dtaara(*lda (931 3))  rtnvar(&fgr)
             rtvdtaara  dtaara(*lda (944 3))  rtnvar(&fir)
             CHGVAR     VAR(&VALG)     VALUE(0)
             CHGVAR     VAR(&L_FNAV)   VALUE(&FNAV)
             SNDRCVF    RCDFMT(A1MNU)

/* Tester på funksjonstaster                                         */

/* F1                                                                */
             IF         COND(&IN01) THEN(DO)
             CALL       PGM(AA001C)
             GOTO       CMDLBL(START)
             ENDDO

/* F3                                                                */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))

/* F5                                                                */
             IF         COND(&IN05) THEN(DO)
             CALL       PGM(AM80)
             GOTO       CMDLBL(START)
             ENDDO

/* F6                                                                */
             IF         COND(&IN06) THEN(DSPMSG)

/* F10                                                               */
             IF         COND(&IN10) THEN(CALL QCMD)

/* F12                                                               */
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/* Valg 1,2 og 3 kan sperres fra NX                                  */
             if         cond(&valg *eq 1 *or +
                             &valg *eq 2 *or +
                             &valg *eq 3) then(do)
               chgvar    var(&rut)  value('SPERRE_REG/OPPDAT_ØKBILAG')
               call      pgm(TestSperre)  parm(&sp &rut)
               if        cond(&sp *eq '1') then(do)
                 call    pgm(aa011c)  parm(5  10 +
                                 'Du kan ikke kjøre denne rutina' +
                                 'Trykk Enter/Ok Jobben avbrytes')
                 goto    start
               enddo
             enddo

/* Valg 1 - Registrering av posteringer                              */

             IF         COND(&VALG *EQ 1) THEN(DO)
             CALL       PGM(RF010C) PARM(BRUK)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 2 - Kontrolliste                                             */

             IF         COND(&VALG *EQ 2) THEN(DO)
             CALL       PGM(RF1KONTR) PARM(BRUK)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 3  - Journalliste                                            */

             IF         COND(&VALG *EQ 3) THEN(DO)
             CALL       PGM(RF1JOURN) PARM(BRUK)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 4 - Diverse hjelperutiner                                    */

             IF         COND(&VALG *EQ 4) THEN(DO)
             CALL       PGM(RM11)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 5 - Enkeltavkryssing                                         */

             IF         COND(&VALG *EQ 5) THEN(DO)
             CALL       PGM(RF107C)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 6 - Avkryssing alle kunder                                   */

             IF         COND(&VALG *EQ 6) THEN(DO)
             CALL       PGM(RK910R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 7 - Avkryssing alle leverandører                             */

             IF         COND(&VALG *EQ 7) THEN(DO)
             CALL       PGM(RL910R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 8 - Bankrutiner                                              */

             IF         COND(&VALG *EQ 8) THEN(DO)
             CALL       PGM(RM30)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 9 - Vedlikehold kunder                                       */

             IF         COND(&VALG *EQ 9) THEN(DO)
             CALL       PGM(RK100R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 10 - Vedlikehold leverandører                                */

             IF         COND(&VALG *EQ 10) THEN(DO)
             CALL       PGM(RL100R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 11 - Vedlikehold kontoplan                                   */

             IF         COND(&VALG *EQ 11) THEN(DO)
             CALL       PGM(RH100R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 12 - Vedlikehold koder                                       */

             IF         COND(&VALG *EQ 12) THEN(DO)
             CALL       PGM(RA100R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 13 - Vedlikehold attestasjonskoder leverandørreskontro       */

             IF         COND(&VALG *EQ 13) THEN(DO)
             CALL       PGM(RL113R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 14 - Spørring kunder                                         */

             IF         COND(&VALG *EQ 14) THEN(DO)
             CALL       PGM(RK501R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 15 - Spørring leverandører                                   */

             IF         COND(&VALG *EQ 15) THEN(DO)
             CALL       PGM(RL501R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 16 - Spørring hovedbokssaldi                                 */

             IF         COND(&VALG *EQ 16) THEN(DO)
             CALL       PGM(RH520R)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 17 - Spørring prosjektsaldo                                  */

             IF         COND(&VALG *EQ 17) THEN(DO)
/*           CALL       PGM(RP510R)                                  */
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 18 - Overføringsrutiner                                      */

             IF         COND(&VALG *EQ 18) THEN(DO)
             CALL       PGM(RM12)
             GOTO       CMDLBL(START)
             ENDDO

/* Valg 19 - Behandle scannede bilag                                 */

             IF         COND(&VALG *EQ 19) THEN(DO)
              chgvar     var(&skan) value('COMPR' *cat &fir)
              chkobj     obj(*libl/&skan) objtype(*dtaara)
              monmsg     msgid(cpf9801) exec(do)
                call       pgm(rm16)
                goto       cmdlbl(start)
              enddo
              call       pgm(rm17)
              goto       cmdlbl(start)
             enddo

/* Valg 90                                                           */

             IF         COND(&VALG *EQ 90) THEN(DO)
             SIGNOFF
             ENDDO

/* Gå til start                                                      */

             GOTO       CMDLBL(START)

 MELDE:      CALL       PGM(AA004C)
             GOTO       CMDLBL(START)

/* Slutt                                                             */
 ENDPGM:     ENDPGM
