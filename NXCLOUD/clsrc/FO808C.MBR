             PGM        PARM(&MEMB)

/*----------------------------------------------------------------------------*/
/*8.xx* 020522 bsa Nytt program basert på FO610C.                             */
/*                                                                            */
/*----------------------------------------------------------------------------*/


             DCL        VAR(&KODE)     TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&ONOF)     TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&MEMB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&PROG)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&VLG1)     TYPE(*CHAR) LEN(01)
             DCL        VAR(&VLG2)     TYPE(*CHAR) LEN(01)

             CHGDTAARA  DTAARA(*LDA (540 20)) +
                          VALUE('                    ')

             ADDPFM     FILE(FPSOPF)   MBR(&MEMB)
             ADDLFM     FILE(FPSOLU)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/FPSOPF (&MEMB)))
             ADDLFM     FILE(FPSOL1)   MBR(&MEMB) +
                          DTAMBRS((*CURRENT/FPSOPF (&MEMB)))

             OVRDBF     FILE(FPM2LU)   TOFILE(*FILE) MBR(&MEMB)
             OVRDBF     FILE(FPSOLU)   TOFILE(*FILE) MBR(&MEMB)
             OVRDBF     FILE(FPSOL1)   TOFILE(*FILE) MBR(&MEMB)

             CHGJOB     LOG(0 20)  +
                          /*7.01*/

/* Kaller opp program                                                */

             CALL       PGM(FO808R)

             RTVDTAARA  DTAARA(*LDA (540 01)) RTNVAR(&VLG1)
             RTVDTAARA  DTAARA(*LDA (541 01)) RTNVAR(&VLG2)
             RTVDTAARA  DTAARA(*LDA (871 10)) RTNVAR(&PROG)

/* Kaller opp program for utskrift   (Ikke Fakt/Kred)                */

             IF         COND(&VLG1 *EQ '1') THEN(DO)
             CALL       PGM(&PROG)     PARM(&MEMB)
             ENDDO

/* Kaller opp program for oppdatering/utskrift  (Fakt/Kred)          */

             IF         COND(&VLG1 *EQ '2') THEN(DO)
             CALL       PGM(FO616C)    PARM(&MEMB)
             ENDDO

/* Kaller opp program for utskrift   (Resting)                       */

             IF         COND(&VLG2 *EQ '1') THEN(DO)
             CALL       PGM(FORESC)    PARM(&MEMB)
             ENDDO

/* Kaller opp program for evt. overføring av ByggDok                 */
/* 7.00      CALL       PGM(FO788R)                                  */

/* Kaller opp program for sletting av ordre etter utplukk/utskrift   */

             CALL       PGM(FO618R)

             DLTOVR     FILE(FPM2LU FPSOLU FPSOL1)

             RMVM       FILE(FPM2LU)   MBR(&MEMB)
             RMVM       FILE(FPM2PF)   MBR(&MEMB)
             RMVM       FILE(FPSOL1)   MBR(&MEMB)
             RMVM       FILE(FPSOLU)   MBR(&MEMB)
             RMVM       FILE(FPSOPF)   MBR(&MEMB)

/* Oppdater jobb-register med jobb-ferdig-flagg                      */

             CHGVAR     VAR(&KODE)     VALUE(01)
             CHGVAR     VAR(&ONOF)     VALUE(0)
             CALL       PGM(FA720R)    PARM(&KODE &ONOF)

             CHGJOB     LOG(4 00) /*7.01*/

             ENDPGM
