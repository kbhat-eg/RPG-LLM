             PGM

/*----------------------------------------------------------------------------*/
/* 8.01 031022  bsa Laget ny versjon for Ã¥ skrive til coolspool eller vanlig. */
/* 8.01             av switch.                                                */
/* 8.02 301024  ask Lagt inn direktetilgang fra lagertelling batch            */
/*                                                                            */
/*                                                                            */
/*----------------------------------------------------------------------------*/

             DCL        VAR(&PARM) TYPE(*CHAR) LEN(128)

/*8.01*/     DCL        VAR(&CO402_KEY) TYPE(*CHAR) LEN(50)
/*8.01*/     DCL        VAR(&CO402_V1)  TYPE(*CHAR) LEN(1)
/*8.01*/     DCL        VAR(&CO402_V2)  TYPE(*CHAR) LEN(2048)
/*8.01*/     dcl        var(&fgr)       type(*char) len(3)
/*8.01*/     dcl        var(&fix)       type(*char) len(3)
/*8.01*/     dcl        var(&fir)       type(*dec)  len(3 0) value(0)
/*8.01*/     dcl        var(&lag)       type(*dec)  len(3 0) value(0)

/*8.02*/     DCL        VAR(&TYPE)      TYPE(*CHAR) LEN(1)
             DCL        VAR(&batc)      TYPE(*CHAR) LEN(10)

             DCL        VAR(&IN03) TYPE(*CHAR) LEN(1)
             DCL        VAR(&BTCH) TYPE(*CHAR) LEN(1)

             RTVDTAARA  DTAARA(*LDA (1016 1)) RTNVAR(&TYPE)
/*8.02*/     IF         COND(&TYPE *EQ '2') THEN(GOTO CMDLBL(FORBI))
             CALL       PGM(LL605R) PARM(&IN03 &PARM)

             IF         COND(&IN03 *EQ '1') THEN(GOTO CMDLBL(END))

 FORBI:      STRPCO     PCTA(*NO)
/*6.30*/     MONMSG     MSGID(IWS4010)

/*8.01*/     chgvar     var(&CO402_KEY) value('PROA_VERSJON_LAGERVERDI')
/*8.01*/     rtvdtaara  dtaara(*lda (931 3)) rtnvar(&fgr)
/*8.01*/     rtvdtaara  dtaara(*lda (944 3)) rtnvar(&fix)
/*8.01*/     chgvar     var(&fir)   value(&fix)
/*8.01*/     CALL       PGM(CO402R) PARM(&FGR &FIR &LAG &CO402_KEY +
/*8.01*/                  &CO402_V1 &CO402_V2)

/* Program for printerstyring                                        */
/*8.01*/     IF         COND(&CO402_V1 *EQ '1') THEN(do)
             CALL       PGM(AP600R) PARM('LL605' '1' '0' &IN03 &BTCH)

             IF         COND(&IN03 *EQ '1') THEN(GOTO CMDLBL(END))
/*8.01*/     enddo
/*8.01*/     else    do
/*8.01*/     CALL       PGM(AP605R) PARM('LL605' '1' '0' &IN03 &BTCH)
/*8.01*/     IF         COND(&IN03 *EQ '1') THEN(GOTO CMDLBL(END))
/*8.01*/     enddo

/* Utskrift                                                          */

             IF         COND(&BTCH *EQ '1') THEN(SBMJOB CMD(CALL +
                          PGM(LL606C) PARM(&PARM)) JOB(UTSKR_LAGV) +
                          MSGQ(*NONE))
             ELSE       CMD(CALL PGM(*LIBL/LL606C) PARM(&PARM))

 END:        ENDPGM
