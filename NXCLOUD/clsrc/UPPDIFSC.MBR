      PGM        parm(&dir &valg &in03 &fil &lib &mbr &utf)
      DCL        VAR(&dir)  TYPE(*CHAR) LEN(60)
      DCL        VAR(&udir) TYPE(*CHAR) LEN(60)
      DCL        VAR(&valg) TYPE(*char) LEN(1)
      DCL        VAR(&in03) TYPE(*char) LEN(1)
      DCL        VAR(&fil)  TYPE(*char) LEN(10)
      DCL        VAR(&lib)  TYPE(*char) LEN(10)
      DCL        VAR(&mbr)  TYPE(*char) LEN(10)
      DCL        VAR(&utf)  TYPE(*CHAR) LEN(60)
      DCL        VAR(&MLD1) TYPE(*CHAR) LEN(30)
      DCL        VAR(&MLD2) TYPE(*CHAR) LEN(30)
      DCL        VAR(&POSX) TYPE(*DEC) LEN(2 0) VALUE(5)
      DCL        VAR(&POSY) TYPE(*DEC) LEN(2 0) VALUE(5)
/*                                                                   */
dsp:  DSPLNK     OBJ(&dir) OUTPUT(*PRINT)
      monmsg     msgid(CPFA0A9) exec(do)
         crtdir  dir('\asp') dtaaut(*RWX) objaut(*none)
         monmsg  msgid(cpf0000)
         chgvar  var(&udir)  value(%sst(&dir 1 8))
         crtdir  dir(&udir) dtaaut(*RWX) objaut(*none)
         monmsg  msgid(cpf0000)
         goto    cmdlbl(dsp)
      enddo
logok:
      cpysplf    file(qsysprt) tofile(*curlib/HentIfsW) +
                   splnbr(*last) jobsysname(*only)
      monmsg     msgid(cpf9812) exec(do)
        crtpf    file(*curlib/HentIfsw) rcdlen(132)
        goto     cmdlbl(logok)
      enddo

      dltsplf    file(qsysprt) splnbr(*last)

      call       pgm(hentifsr) parm(&dir &valg &in03 &fil &lib)

      if         cond(&in03 *eq '1') then(do)
        goto     cmdlbl(end)
      enddo
      if         cond(&valg *eq '1') then(do)

        chgvar     var(&utf) value('/qsys.lib/' *tcat +
                   &lib    *tcat '.lib/' +
                   *tcat 'w_fil' *tcat '.file/' +
                   *tcat 'w_fil' *tcat '.mbr')
        dltf       file(adb/w_fil)
        monmsg     msgid(cpf0000)
        clrpfm     file(w_fil)
        monmsg     msgid(cpf3142) exec(do)
          crtpf    file(&lib/w_fil) rcdlen(512) size(*nomax) +
                     text('Mellom fil for koiering til IFS')
        enddo
        cpyf       fromfile(&fil) tofile(w_fil) +
                     mbropt(*add) fmtopt(*nochk)

        cpytostmf  frommbr(&utf) tostmf(&dir) stmfopt(*replace) +
                   stmfcodpag(*PCASCII)
        monmsg     msgid(cpfa097) exec(do)
          cpytostmf frommbr(&utf) tostmf(&dir) stmfopt(*replace) +
                     stmfcodpag(*stmf)
        enddo
      enddo
end:  ENDPGM
