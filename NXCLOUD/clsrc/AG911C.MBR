/*                                                                   */
/*-------------------------------------------------------------------*/
/* 170215 BKV: xPath for NOBB 80                                     */
/*             for Deltaker, Prodsent, Grupper er det forskjell      */
/*             i xPath direkte fra NOBB og NIB                       */
/*                                                                   */
/*             For Byggmaskinen må MASK være BYGGMAKK                */
/*             &MASK *EQ 'BYGGMAKK'                                  */
/*                                                                   */
             PGM        parm(&FILG &MASK)

 /* Parametre                                                         */
             DCL        var(&FILG)      type(*char) len(3)

             DCL        VAR(&DBIB) TYPE(*CHAR) LEN(6) VALUE('ADB400')
             DCL        VAR(&MASK) TYPE(*CHAR) LEN(10)

             CHGVAR     VAR(%SST(&DBIB 4 3)) VALUE(&FILG)
             CHGCURLIB  CURLIB(&DBIB)


             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80VAR'', +
                          ''VareResult/VareListe/Vare'',''ASP'',''ASP'') +
                          ') COMMIT(*NONE)

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80MOD'', +
                          ''ModulResult/ModulListe/Modul'',''ASP'',''ASP'') +
                          ') COMMIT(*NONE)

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80PRI'', +
                          ''PrisResult/PrisListe/Pris'',''ASP'',''ASP'') +
                          ') COMMIT(*NONE)

             IF         COND(&MASK *EQ 'BYGGMAKK') THEN(DO)
                GOTO       CMDLBL(BYGGMAKK )
             ENDDO

    /*  xPath for XML direkte fra NOBB  */

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80DEL'', +
                          ''DeltagerResult/DeltagerListe/Deltager'',''ASP'',+
                          ''ASP'') ') COMMIT(*NONE)

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80PRO'', +
                          ''ProdusentRegisterResult/ProdusentListe/Produsent+
                          '',''ASP'',''ASP'') ') COMMIT(*NONE)

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80GRU'', +
                          ''VaregruppestrukturResult/VaregruppestrukturListe+
                          /Overgruppe'',''ASP'',''ASP'') ') COMMIT(*NONE)

 BYGGMAKK:   IF         COND(&MASK *NE 'BYGGMAKK') THEN(DO)
                GOTO       CMDLBL(END)
             ENDDO

    /*  xPath for XML direkte fra NIB  */

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80DEL'', +
                          ''PartnerDeltagerResult/DeltagerListe/Deltager'','+
                          'ASP'',''ASP'') ') COMMIT(*NONE)

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80PRO'', +
                          ''PartnerProdusentRegisterResult/ProdusentListe/Pr+
                          odusent'',''ASP'',''ASP'') ') COMMIT(*NONE)

             RUNSQL     SQL('INSERT INTO AFPSPF +
                          (AFUFIL,AFUIDE,AFUDSS,AFUOUS,AFUEUS) VALUES (''' +
                          *cat &FILG *bcat ''',''NOBB80GRU'', +
                          ''PartnerVaregruppestrukturResult/Varegruppestrukt+
                          urListe/Overgruppe'',''ASP'',''ASP'') ') +
                          COMMIT(*NONE)

 END:        ENDPGM

