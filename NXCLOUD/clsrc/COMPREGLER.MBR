             PGM
             DCLF       FILE(COMPREGLER)
             DCL        VAR(&cmp)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&par)    TYPE(*CHAR) LEN(200)
             DCL        VAR(&fir)    TYPE(*CHAR) LEN(3)
/*                                                                   */
/*    Hent data-area fra *curlib                                     */
/*                                                                   */
             rtvdtaara  dtaara(*lda (944 3)) rtnvar(&fir)
             chgvar     var(&cmp) value('COMPR' *cat &fir)
             chgvar     var(&par) value('          ')

 START:      RTVDTAARA  DTAARA(&CMP) RTNVAR(&PAR)
             monmsg     msgid(cpf1015) exec(do)
               crtdtaara  dtaara(&cmp) type(*char) len(200) +
                          value('         ') text('Styrer +
                          integrasjon med Compello')
                goto    cmdlbl(start)
             enddo
             CHGVAR     VAR(&p1)       VALUE(%SUBSTRING(&PAR 1 1))
             chgvar     var(&p1)       value('J')
             CHGVAR     VAR(&p2)       VALUE(%SUBSTRING(&PAR 2 1))
             CHGVAR     VAR(&p3)       VALUE(%SUBSTRING(&PAR 3 1))
             CHGVAR     VAR(&p4)       VALUE(%SUBSTRING(&PAR 4 1))
             CHGVAR     VAR(&p5)       VALUE(%SUBSTRING(&PAR 5 1))
             CHGVAR     VAR(&p6)       VALUE(%SUBSTRING(&PAR 6 1))
             CHGVAR     VAR(&p7)       VALUE(%SUBSTRING(&PAR 7 1))
             CHGVAR     VAR(&p8)       VALUE(%SUBSTRING(&PAR 8 1))
             CHGVAR     VAR(&ip)       VALUE(%SUBSTRING(&PAR 9 15))
             CHGVAR     VAR(&port)     VALUE(%SUBSTRING(&PAR 24 4))
             CHGVAR     VAR(&bilkod)   VALUE(%SUBSTRING(&PAR 28 16))
             CHGVAR     VAR(&T1)       VALUE('Periode fra bilagsdato   ')
             CHGVAR     VAR(&T2)       VALUE('Per. etter sperret Per.  ')
             CHGVAR     VAR(&T3)       VALUE('                         ')
             CHGVAR     VAR(&T4)       VALUE('                         ')
             CHGVAR     VAR(&T5)       VALUE('                         ')
             CHGVAR     VAR(&T6)       VALUE('                         ')
             CHGVAR     VAR(&T7)       VALUE('                         ')
             CHGVAR     VAR(&T8)       VALUE('                         ')

             SNDRCVF    RCDFMT(K1WIN)
/*                                                                   */
/*                                                                   */
/*  Tester p} funksjonstaster                                        */
/*                                                                   */
/*  F3                                                               */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
/*                                                                   */
/*                                                                   */
             chgvar     var(&p1)                   value('J')
             chgvar     var(%substring(&par 1 1))  value(&p1)
             chgvar     var(%substring(&par 2 1))  value(&p2)
             chgvar     var(%substring(&par 3 1))  value(&p3)
             chgvar     var(%substring(&par 4 1))  value(&p4)
             chgvar     var(%substring(&par 5 1))  value(&p5)
             chgvar     var(%substring(&par 6 1))  value(&p6)
             chgvar     var(%substring(&par 7 1))  value(&p7)
             chgvar     var(%substring(&par 8 1))  value(&p8)
             chgvar     var(%substring(&par 9 15)) value(&ip)
             chgvar     var(%substring(&par 24 4))  value(&port)
             chgvar     var(%substring(&par 28 16)) value(&bilkod)
/*                                                                   */
             CHGDTAARA  DTAARA(*CURLIB/&CMP (1 200)) VALUE(&PAR)
/*                                                                   */
/* Slutt                                                             */
 ENDPGM:     ENDPGM
