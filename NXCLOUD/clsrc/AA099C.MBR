             PGM        parm(&usr &pok)
             DCL        VAR(&JOB)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&usr)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&nbr)      TYPE(*CHAR) LEN(6)
             DCL        VAR(&pok)      TYPE(*char) LEN(1)
             DCL        VAR(&M1)       TYPE(*CHAR) LEN(16)
             DCL        VAR(&M2)       TYPE(*CHAR) LEN(16)
             DCL        VAR(&M3)       TYPE(*CHAR) LEN(16)
             DCL        VAR(&M4)       TYPE(*CHAR) LEN(16)
             DCL        VAR(&M5)       TYPE(*CHAR) LEN(16)
             DCLF       FILE(ADB/AA009F)

/*           MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ERR))   */

             chgvar     var(&pok)  value('0')
             RTVJOBA    JOB(&JOB) NBR(&NBR)
/*                                                                   */
             WRKACTJOB  OUTPUT(*PRINT) SBS(QINTER)
             CPYSPLF    FILE(QPDSPAJB) TOFILE(ADB/AA009F) +
                          JOB(&nbr/&usr/&job) SPLNBR(*LAST)
             DLTSPLF    FILE(QPDSPAJB) JOB(&NBR/&USR/&JOB) +
                          SPLNBR(*LAST)
loop:        rcvf
             monmsg     msgid(cpf0864) exec(goto cmdlbl(end))
             if         cond(%sst(&aa009f 17 10) *eq &usr) then(do)
              if        cond(%sst(&aa009f 29  6) *ne &nbr) then(do)
               chgvar     var(&m1)     value('Denne bruker er')
               chgvar     var(&m2)     value('pålogget fra før')
               chgvar     var(&m3)     value('Samme bruker kan')
               chgvar     var(&m4)     value('ikke logge på   ')
               chgvar     var(&m5)     value('flere ganger.   ')
               CALL       PGM(AA096C)  parm(&m1 &m2 &m3 &m4 &m5)
               DLYJOB     DLY(3)
               signoff
              enddo
             enddo
             goto       cmdlbl(loop)
/*                                                                   */

 END:        ENDPGM
