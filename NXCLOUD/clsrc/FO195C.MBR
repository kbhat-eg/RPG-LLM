             PGM        PARM(&AARR &FATY &FNUM &TNUM +
                             &OMKJ &RAPP &ANTA &FEIL)

/* Initiering av parametre.                                          */

             DCL        VAR(&AARR)   TYPE(*DEC)  LEN(4)
             DCL        VAR(&FATY)   TYPE(*DEC)  LEN(2)
             DCL        VAR(&FNUM)   TYPE(*DEC)  LEN(6)
             DCL        VAR(&TNUM)   TYPE(*DEC)  LEN(6)
             DCL        VAR(&OMKJ)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&RAPP)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&ANTA)   TYPE(*DEC)  LEN(4)
             DCL        VAR(&FEIL)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&FILN)   TYPE(*CHAR) LEN(20)
             DCL        VAR(&SMSG)   TYPE(*CHAR) LEN(1) VALUE('1')
             DCL        VAR(&STAT)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&OVRF)   TYPE(*CHAR) LEN(10) +
                                     VALUE('XMLTRANS')
             DCL        VAR(&IN03)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&BTCH)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&QCMD)     TYPE(*CHAR) LEN(128)

             CHGVAR     VAR(&FEIL) VALUE('0')

/* Program for utskriftsparametre.                                   */

             CALL       PGM(AP600R) PARM('FO195' '0' '0' &IN03 &BTCH)

             IF         COND(&IN03 *EQ '1') THEN(GOTO CMDLBL(END))

/* Program for overstyring av printerfile                            */

             CALL       PGM(AP601C)    PARM('FO195P' &BTCH)

/* Kaller prog. for gen. av eFaktura                                 */

             CALL       PGM(FO195R) PARM(&AARR &FATY &FNUM &TNUM +
                          &OMKJ &RAPP &ANTA &FEIL)

/* Hvis feilkode fra prog. eller ingen fakturaer; avslutt            */

             IF         COND(&FEIL *EQ '1') THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&ANTA *EQ 0) THEN(GOTO CMDLBL(ENDPGM))

/* Tømmer overføringsfil og kopierer inn oppdat. fakturaer           */


/* Henter filnavn og sender fil                                      */

             CALL       PGM(LO762R) PARM(&FILN)

             CALL       PGM(AF700C) PARM(&OVRF &STAT &FILN &SMSG)

             IF         COND(&STAT *NE ' ') THEN(CHGVAR VAR(&FEIL) +
                          VALUE('1'))

             IF         COND(&FEIL *EQ '1') THEN(GOTO CMDLBL(ENDPGM))

/* Flytter filene etter overføring og kopierer de til egen mappe    */

             call       pgm(fo196r) parm(&qcmd)
             qsh        cmd(&qcmd)

 ENDPGM:
             CALL       PGM(AP606C)    PARM('FO195P')

 END:        ENDPGM
