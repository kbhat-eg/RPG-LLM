             PGM

             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&MLD2)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&SVAR)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN12)     TYPE(*DEC)  LEN(1 0)

/* Varselbilde med bekreftelse p√• om jobb skal settes i gang         */

             CHGVAR     VAR(&MLD1) +
                        VALUE('Starter subsystem for synkronisering ')
             CHGVAR     VAR(&MLD2) +
                        VALUE('Bekreft at dette startes! ')
             CALL       PGM(AA007R)    PARM(&MLD1 &MLD2 &SVAR &IN12)

             IF         COND(&IN12 *EQ 1 ) +
                          THEN(GOTO CMDLBL(ENDPGM))

             IF         COND(&SVAR *EQ 'J') +
                          THEN(GOTO CMDLBL(SJEKKSUB))
             ELSE       CMD(GOTO CMDLBL(ENDPGM))

/* Sjekker om subsystem allerede er i gang og varsler                 */

 SJEKKSUB:   CLRJOBQ    JOBQ(NAVSYNC)
             STRSBS     SBSD(*LIBL/NAVSYNC)
             MONMSG     MSGID(CPF1010) EXEC(DO)
             CHGVAR     VAR(&SVAR) VALUE(' ')
             CHGVAR     VAR(&MLD1) +
                        VALUE('Subsystem allerede i gang, vil bli   ')
             CHGVAR     VAR(&MLD2) +
                        VALUE('avsluttet og restartet. Er dette ok?')
             CALL       PGM(AA007R)    PARM(&MLD1 &MLD2 &SVAR &IN12)

             IF         COND(&IN12 *EQ 1 ) +
                          THEN(GOTO CMDLBL(ENDPGM))

             IF         COND(&SVAR *EQ 'J') +
                          THEN(GOTO CMDLBL(VIDERE))
             ELSE       CMD(GOTO CMDLBL(ENDPGM))
             ENDDO
             GOTO CMDLBL(ENDPGM)

 VIDERE:     ENDSBS     SBS(NAVSYNC) OPTION(*IMMED)
             MONMSG     MSGID(CPF0000)
             STRSBS     SBSD(*LIBL/NAVSYNC)
             MONMSG     MSGID(CPF1010)

 ENDPGM:     ENDPGM
