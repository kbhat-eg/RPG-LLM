             PGM        PARM(&file &stat)

/* Definering av parametre.                                          */
             DCL        VAR(&file) TYPE(*CHAR) LEN(100)
             DCL        VAR(&stat) TYPE(*CHAR) LEN(1)

/* Definering av variable                                            */
             DCL        VAR(&filg) TYPE(*CHAR) LEN(3)
             DCL        VAR(&clib) TYPE(*CHAR) LEN(10)
             DCL        VAR(&dfil) TYPE(*CHAR) LEN(70)

/* Nullstiller status                                                */
             CHGVAR     VAR(&stat) VALUE('0')

/* Henter current library                                            */
             RTVJOBA    CURLIB(&clib)

/* Oppretter temporær fil og kopierer mottatt fil inn i denne        */
             DLTF       FILE(FTPNIBX)
             MONMSG     MSGID(CPF2105)

             CRTPF      FILE(FTPNIBX) RCDLEN(2048) TEXT('Temporær +
                          fil') SIZE(*NOMAX)
             CHGVAR     VAR(&dfil) VALUE('/qsys.lib/' *TCAT &clib +
                          *TCAT '.lib/FTPNIBX.file/FTPNIBX.mbr')
             CPYFRMSTMF FROMSTMF(&FILE) TOMBR(&DFIL) +
                          MBROPT(*REPLACE) STMFCODPAG(*PCASCII)

/* Behandler mottatt fil avhengig av filnavn                         */

             CPYF       FROMFILE(FTPNIBX) TOFILE(NLVAPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV820R_XML) PARM(&stat)
/* Sletter ikke innlest file. Ordnes i java                          */
/*           DEL        OBJLNK(&file)                                */
             RGZPFM     FILE(NLVAPF)
             MONMSG     MSGID(CPF2900)

             ENDPGM
