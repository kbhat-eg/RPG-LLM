             PGM        PARM(&MEMBR &ONUMM &OSUFF)

/* Initiering av parametre.                                          */

             DCL        VAR(&MEMBR)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&ONUMM)    TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&OSUFF)    TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&OVRF) TYPE(*CHAR) LEN(10) +
                          VALUE('LOVENSBEST')
             DCL        VAR(&FILN)  TYPE(*CHAR) LEN(20)
             DCL        VAR(&STAT)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&SMSG)  TYPE(*CHAR) LEN(1) VALUE('1')

/* Bygger member og overstyrer                                       */

             CHKOBJ     OBJ(LWLOPF) OBJTYPE(*FILE) MBR(&MEMBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(LWLOPF) MBR(&MEMBR) TEXT('Bestilling +
                          i Løvenskiold-format')
             ENDDO
             OVRDBF     FILE(LWLOPF) TOFILE(LWLOPF) MBR(&MEMBR)

/* Kaller genereringsprogram                                         */

             CALL       PGM(LO780R) PARM(&ONUMM &OSUFF &FILN)
             DLTOVR     FILE(LWLOPF)
             CPYF       FROMFILE(LWLOPF) TOFILE(LWLOPF) +
                          FROMMBR(&MEMBR) TOMBR(LWLOPF) +
                          MBROPT(*REPLACE)

             CALL       PGM(AF700C) PARM(&OVRF &STAT &FILN &SMSG)

/* Tømmer overføringsfile for poster                                 */

             IF         COND(&STAT *EQ ' ') THEN(CHGVAR VAR(&STAT) +
                          VALUE('0'))
             RMVM       FILE(LWLOPF) MBR(&MEMBR)
             RMVM       FILE(LWLOPF) MBR(LWLOPF)
 END:        ENDPGM
