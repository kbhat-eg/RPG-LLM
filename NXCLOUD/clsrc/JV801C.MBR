             PGM        PARM(&DIRE &FILE &FIRM)

/* Definering av parametre.                                          */

             DCL        VAR(&DIRE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&FILE) TYPE(*CHAR) LEN(50)
             DCL        VAR(&FIRM) TYPE(*CHAR) LEN(3)

/* Definering av variable                                            */

             DCL        VAR(&CLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&IFIL) TYPE(*CHAR) LEN(50) VALUE(' ')
             DCL        VAR(&DFIL) TYPE(*CHAR) LEN(70)

/* Fjerner dummy-verdi bakerst i mottatte parametre                  */

             CHGVAR     VAR(&DIRE) VALUE(%SUBSTRING(&DIRE 1 49))
             CHGVAR     VAR(&FILE) VALUE(%SUBSTRING(&FILE 1 49))

/* Henter current library                                            */

             RTVJOBA    CURLIB(&CLIB)

/* Oppretter temporær fil og kopierer motatt fil inn i denne         */

             DLTF       FILE(FTPTEMP)
             MONMSG     MSGID(CPF2105)
             CRTPF      FILE(FTPTEMP) RCDLEN(520) TEXT('Temporær +
                          fil') SIZE(*NOMAX)
             CHGVAR     VAR(&IFIL) VALUE(&DIRE *TCAT '/' *TCAT &FILE)
             CHGVAR     VAR(&DFIL) VALUE('/qsys.lib/' *TCAT &CLIB +
                          *TCAT '.lib/FTPTEMP.file/FTPTEMP.mbr')
             CPYFRMSTMF FROMSTMF(&IFIL) TOMBR(&DFIL) MBROPT(*REPLACE)

/* Behandler mottatt fil avhengig av filnavn                         */

 DELTAKER:   IF         COND(&FILE *EQ DELTAKER.DAT) THEN(DO)
             CPYF       FROMFILE(FTPTEMP) TOFILE(NIDEPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV810R) PARM(&FIRM)
             DEL        OBJLNK(&IFIL)
             RGZPFM     FILE(NIDEPF)
             GOTO       CMDLBL(END)
             ENDDO

 PRODUSENT:  IF         COND(&FILE *EQ PROD.DAT) THEN(DO)
             CPYF       FROMFILE(FTPTEMP) TOFILE(NIPRPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV811R) PARM(&FIRM)
             DEL        OBJLNK(&IFIL)
             RGZPFM     FILE(NIPRPF)
             GOTO       CMDLBL(END)
             ENDDO

 VAREGRP:    IF         COND(&FILE *EQ VAREGRP.DAT) THEN(DO)
             CPYF       FROMFILE(FTPTEMP) TOFILE(NIVGPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV812R) PARM(&FIRM)
             DEL        OBJLNK(&IFIL)
             RGZPFM     FILE(NIVGPF)
             GOTO       CMDLBL(END)
             ENDDO

 MODUL:      IF         COND(&FILE *EQ MODUL.DAT) THEN(DO)
             CPYF       FROMFILE(FTPTEMP) TOFILE(NIMOPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV815R) PARM(&FIRM)
             DEL        OBJLNK(&IFIL)
             RGZPFM     FILE(NIMOPF)
             GOTO       CMDLBL(END)
             ENDDO

 VARE:       IF         COND(&FILE *EQ VARE.DAT) THEN(DO)
             CPYF       FROMFILE(FTPTEMP) TOFILE(NIVAPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV820R) PARM(&FIRM)
             DEL        OBJLNK(&IFIL)
             RGZPFM     FILE(NIVAPF)
             GOTO       CMDLBL(END)
             ENDDO

 PRIS:       IF         COND(&FILE *EQ PRIS.DAT) THEN(DO)
             CPYF       FROMFILE(FTPTEMP) TOFILE(NIVPPF) +
                          MBROPT(*REPLACE) FMTOPT(*NOCHK)
             CALL       PGM(JV821R) PARM(&FIRM)
             DEL        OBJLNK(&IFIL)
             RGZPFM     FILE(NIVPPF)
             GOTO       CMDLBL(END)
             ENDDO

 END:        ENDPGM
