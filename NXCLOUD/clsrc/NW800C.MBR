             PGM        PARM(&DLIB &FIRM &AVDE &RECD &UNIQ &BIBL &DTQI +
                          &DTQO &FEIL)

/* Initiering av parametre.                                          */

             DCL        VAR(&DLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FIRM) TYPE(*CHAR) LEN(3)
             DCL        VAR(&AVDE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&RECD) TYPE(*CHAR) LEN(3)
             DCL        VAR(&UNIQ) TYPE(*CHAR) LEN(15)
             DCL        VAR(&BIBL) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DTQI) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DTQO) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FEIL) TYPE(*CHAR) LEN(1)

             DCL        VAR(&FGRP) TYPE(*CHAR) LEN(3)

             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

/* Utleder filgruppe                                                 */

             CHGVAR     VAR(&FGRP) VALUE(%SUBSTRING(&DLIB 4 3))

/* Setter biblioteksliste                                            */

             CALL       PGM(AA720C) PARM(&FGRP)

/* Setter current library                                            */

             CHGCURLIB  CURLIB(&DLIB)

/* Legger firmanummer i LDA                                          */

             CHGDTAARA DTAARA(*LDA (944 3)) VALUE(&FIRM)

/* Kaller styreprogram/returprogram                                  */

             CALL       PGM(NW800R) PARM(&FGRP &FIRM &AVDE &RECD +
                          &UNIQ &BIBL &DTQI &DTQO &FEIL)

 END:        ENDPGM
