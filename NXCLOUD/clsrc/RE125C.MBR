             PGM

             DCLF       FILE(RE125D) ALWVARLEN(*YES) ALWNULL(*YES)

             DCL        VAR(&FRM)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&MELD)  TYPE(*CHAR) LEN(45)
             DCL        VAR(&MAPPE) TYPE(*CHAR) LEN(10) -
                                                VALUE('PCFILER')
             DCL        VAR(&MEMBER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FIL)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(6) VALUE('Filen')
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(19)

             dcl        var(&fradoc) type(*char) len(30)
             dcl        var(&framap) type(*char) len(30)
             dcl        var(&tillib) type(*char) len(10)
             dcl        var(&tilfil) type(*char) len(10)
             dcl        var(&tilmbr) type(*char) len(10)
             dcl        var(&fgr)    type(*char) len(3)

             CHGVAR     VAR(&FRM) VALUE(000)
             CHGVAR     VAR(&O1FRM) VALUE('000')
             CHGVAR     VAR(&FIL) VALUE('          ')
             CHGDTAARA  DTAARA(*LDA (211 90)) +
VALUE('                                                              +
                                         ')

             SNDRCVF    RCDFMT(O1WIN)

             RTVDTAARA  DTAARA(*LDA (911 10)) RTNVAR(&MEMBER)

             CHGVAR     VAR(&FRM) VALUE(&O1FRM)
             CHGVAR     VAR(&FIL) VALUE(&O1FIL)

             IF         COND(&IN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Test om div. register finnes                                      */

             CHKOBJ     OBJ(*LIBL/RFW1PF) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
             CRTPF      FILE(RFW1PF) RCDLEN(700) +
                          TEXT('Postering                         +
                          -regneark    inn') MAXMBRS(*NOMAX)
             ENDDO

             CHKOBJ     OBJ(*LIBL/RFW2PF) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
             CRTPF      FILE(RFW2PF) RCDLEN(700) +
                          TEXT('Postering                         +
                          -regneark    ut') MAXMBRS(*NOMAX)
             ENDDO

CHKW1P:      CHKOBJ     OBJ(*LIBL/RFW1PF) OBJTYPE(*FILE) MBR(&MEMBER)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(*LIBL/RFW1PF) MBR(&MEMBER) TEXT('Member +
                          pr. bruker')
                        ENDDO

CHKW2P:      CHKOBJ     OBJ(*LIBL/RFW2PF) OBJTYPE(*FILE) MBR(&MEMBER)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(*LIBL/RFW2PF) MBR(&MEMBER) TEXT('Member +
                          pr. bruker')
                        ENDDO

/* Sletter innholdet fra innlesingsfila                              */

             CLRPFM     FILE(RFW1PF) MBR(&MEMBER)
             CLRPFM     FILE(RFW2PF) MBR(&MEMBER)

/*  Lager feilmelding                                                */

             CHGVAR     VAR(&MELD) VALUE(&MLD1 *CAT &FIL *CAT &MLD2-
                        *CAT &MAPPE)
             MONMSG     MSGID(IWS1603 CPA0701)

/*           CPYFRMPCD  FROMFLR(&MAPPE) TOFILE(*LIBL/RFW1PF) +  */
/*                        FROMDOC(&FIL) TOMBR(&MEMBER)          */
             rtvdtaara  dtaara(*lda (931 03)) rtnvar(&fgr)
             chgvar     var(&framap)  value('/ASP/' *cat +
                                             &fgr   *cat +
                                             '/' *cat &mappe)
             chgvar     var(&fradoc)  value(&fil)
             chgvar     var(&tillib)  value('*LIBL')
             chgvar     var(&tilfil)  value('RFW1PF')
             chgvar     var(&tilmbr)  value(&member)
             call       pgm(aspfrstmf) parm(+
                            &fradoc +
                            &framap +
                            &tillib +
                            &tilfil +
                            &tilmbr)
             MONMSG     MSGID(IWS1611) EXEC(DO)
             SNDUSRMSG  MSG(&MELD)
             GOTO       CMDLBL(ENDPGM)
             ENDDO
             MONMSG     MSGID(IWS1603 CPA0701)

/* Danner postering                                                  */

             OVRDBF     FILE(RFW1PF) TOFILE(*LIBL/RFW1PF) MBR(&MEMBER)
             OVRDBF     FILE(RFW2PF) TOFILE(*LIBL/RFW2PF) MBR(&MEMBER)

             CALL       PGM(RE125R) parm(&frm)
             MONMSG     MSGID(CPF0000)


/* Danner postering                                                  */

             CALL       PGM(RE126R) PARM(&FRM &MEMBER)
             MONMSG     MSGID(CPF0000)

             DLTOVR     FILE(*ALL)

 ENDPGM:     ENDPGM
