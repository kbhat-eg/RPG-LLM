             PGM
             DCL        VAR(&JOBB)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&LIB1)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&MILJ)     TYPE(*CHAR) LEN(3)
             DCL        VAR(&LEVL)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(50)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ERR))
             RTVJOBA    JOB(&JOBB)
             RTVOBJD    OBJ(AUSRPF)    OBJTYPE(*FILE) RTNLIB(&LIB1)
             MONMSG     MSGID(CPF9812) EXEC(DO)
             CHGVAR     VAR(&MLD1)     VALUE('AUSRPF ble ikke funnet, +
                                          sjekk biblioteksliste ! ')
             CALL       PGM(AA005R)    PARM(&MLD1)
             GOTO       CMDLBL(FEILDB)
             ENDDO
             CHGVAR     VAR(&MILJ)     VALUE(%SST(&LIB1 1 3))

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL)     VALUE('40')
             CHGVAR     VAR(&OKOK)     VALUE('  ')
             CALL       PGM(AA050C)    PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(END)
             ENDDO

/* Sjekker om Miljø er blankt                                        */

             IF         COND(&MILJ *EQ '   ') THEN(DO)
             GOTO       CMDLBL(FEILDB)
             ENDDO

/* Sjekker om Miljø finnes lagt opp                                  */

             CHKOBJ     OBJ(&MILJ)     OBJTYPE(*LIB)
             MONMSG     MSGID(CPF9801) EXEC(DO)
             CHGVAR     VAR(&MLD1) VALUE('Ingen database ble funnet +
                                          for valgt miljø')
             CALL       PGM(AA005R) PARM(&MLD1)
             GOTO       CMDLBL(FEILDB)
             ENDDO

/* Call til program for vedlikehold                                  */
/* av Bruker-register i det miljø som er valgt                       */

             CALL       PGM(AA022R)    PARM(&MILJ)

 FEILDB:

             GOTO       CMDLBL(END)
 ERR:        SNDPGMMSG  MSG('Det oppstod en feil, se melding +
                          i jobbloggen !!!') TOMSGQ(&JOBB)

 END:        ENDPGM
