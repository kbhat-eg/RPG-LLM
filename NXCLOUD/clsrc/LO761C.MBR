             PGM        Parm(&MEMBR &FEIL)

/* Initiering av parametre.                                          */

             DCL        VAR(&MEMBR)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&FEIL)   TYPE(*CHAR) LEN(1) VALUE('0')
             DCL        VAR(&BNKK)   TYPE(*CHAR) LEN(2) VALUE('ED')
             DCL        VAR(&WPPRGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&WPTYPE) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&WPAKTI) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&WPIN03) TYPE(*DEC) LEN(1 0)
             DCL        VAR(&WPLINJ) TYPE(*DEC) LEN(2 0) VALUE(2)
             DCL        VAR(&WPPOSI) TYPE(*DEC) LEN(3 0) VALUE(43)
             DCL        VAR(&WPKODE) TYPE(*DEC) LEN(1 0) VALUE(0)
             DCL        VAR(&WPVALG) TYPE(*CHAR) LEN(1)
/*                                                                   */
/*                                                                   */
             CHGVAR     VAR(&WPPRGM) VALUE('BANK      ')
             CHGVAR     VAR(&WPTYPE) VALUE('1')
             CHGVAR     VAR(&WPAKTI) VALUE('0')

/* Legg til ASTELE i bibliotekslisten hvis det mangler               */
/*                                                                   */
/*           ADDLIBLE   LIB(ASTELE) POSITION(*LAST)                  */
/*           MONMSG     MSGID(CPF2103)                               */

/* Sjekk om andre overfører                                          */

          CALL       PGM(GLCHKPGM) PARM(&WPPRGM &WPTYPE &WPAKTI)

/* Program er aktivt!:                                               */

          IF   COND(&WPAKTI *EQ 1) THEN(DO)
               CHGVAR     VAR(&WPVALG) VALUE('4')
               CALL       PGM(GL124R) PARM(&WPIN03 &WPVALG +
                                           &WPLINJ &WPPOSI &WPKODE)
             CHGVAR     VAR(&FEIL) VALUE('1')
               GOTO       CMDLBL(END)
          ENDDO

/* Program er ikke aktivt.  Det settes nå AKTIVT!                    */

             IF   COND(&WPAKTI *EQ 0) THEN(DO)
                 CHGVAR     VAR(&WPTYPE) VALUE('0')
                 CALL       PGM(GLCHKPGM) PARM(&WPPRGM &WPTYPE &WPAKTI)
             ENDDO

/* Overføring av poster                                              */

             CLRPFM     FILE(DIRUIE)
             CPYF       FROMFILE(*LIBL/LWEDPF) TOFILE(DIRIIE) +
                          FROMMBR(&MEMBR) MBROPT(*REPLACE) +
                          FMTOPT(*NOCHK)
             CALL       PGM(BF200R) PARM(&BNKK)
             RCLRSC

             IF   COND(&BNKK *EQ 'F3') THEN(DO)
                 CHGVAR     VAR(&FEIL) VALUE('1')
             ENDDO

/* Tømmer overføringsfile for poster                                 */


/* Sletter Kontrollmember:                                           */

             CHGVAR     VAR(&WPTYPE) VALUE('2')
             CHGVAR     VAR(&WPPRGM) VALUE('BANK      ')
             CALL       PGM(GLCHKPGM) PARM(&WPPRGM &WPTYPE &WPAKTI)

 END:        ENDPGM
