             PGM
             DCLF       FILE(AG002D)

             DCL        VAR(&LEVL)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&MLD1)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&MLD2)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&SVAR)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&STOP)     TYPE(*DEC)  LEN(1 0)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL)     VALUE('40')
             CHGVAR     VAR(&OKOK)     VALUE('  ')
             CALL       PGM(AA050C)    PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/*  Gi angrefrist dersom registere skal nullstilles..                */

             IF         COND(&A1NULL *EQ 'S') THEN(DO)
             CHGVAR     VAR(&MLD1) VALUE('Obs !  Det er bedt om +
                                     at data i filer skal slettes')
             CHGVAR     VAR(&MLD2) VALUE('Bekreft dersom dette +
                                     skal utf√∏res...')
             CHGVAR     VAR(&SVAR) VALUE('N')
             CALL       PGM(AA007R)  PARM(&MLD1 &MLD2 &SVAR +
                                          &STOP)
             ENDDO

             IF         COND(&STOP *EQ 1)   THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&SVAR *EQ 'N') THEN(DO)
             CHGVAR     VAR(&A1NULL) VALUE(' ')
             ENDDO

/*  Genererer de valgte registere                                    */

             IF         COND(&A1VFIR *EQ '1') THEN(DO)
             CALL       PGM(AG008C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFOR *EQ '1') THEN(DO)
             CALL       PGM(AG014C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VWSD *EQ '1') THEN(DO)
             CALL       PGM(AG016C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VNUM *EQ '1') THEN(DO)
             CALL       PGM(AG017C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VNOT *EQ '1') THEN(DO)
             CALL       PGM(AG056C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFTP *EQ '1') THEN(DO)
             CALL       PGM(AG058C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VMSR *EQ '1') THEN(DO)
             CALL       PGM(AG062C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VKID *EQ '1') THEN(DO)
             CALL       PGM(AG066C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFTH *EQ '1') THEN(DO)
             CALL       PGM(AG078C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFTL *EQ '1') THEN(DO)
             CALL       PGM(AG082C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VAVT *EQ '1') THEN(DO)
             CALL       PGM(AG086C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VSGR *EQ '1') THEN(DO)
             CALL       PGM(AG088C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VJLS *EQ '1') THEN(DO)
             CALL       PGM(AG204C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VJLT *EQ '1') THEN(DO)
             CALL       PGM(AG208C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VJTR *EQ '1') THEN(DO)
             CALL       PGM(AG212C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFOP *EQ '1') THEN(DO)
             CALL       PGM(AG216C) PARM(&A1FGRP &A1NULL)
             ENDDO

/*6.30*/     IF         COND(&A1VFEM *EQ '1') THEN(DO)
/*6.30*/     CALL       PGM(AG221C) PARM(&A1FGRP &A1NULL)
/*6.30*/     ENDDO

             IF         COND(&A1VFOT *EQ '1') THEN(DO)
             CALL       PGM(AG220C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFPR *EQ '1') THEN(DO)
             CALL       PGM(AG224C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFPS *EQ '1') THEN(DO)
             CALL       PGM(AG228C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFAP *EQ '1') THEN(DO)
             CALL       PGM(AG232C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VFPP *EQ '1') THEN(DO)
             CALL       PGM(AG236C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VKOB *EQ '1') THEN(DO)
             CALL       PGM(AG240C) PARM(&A1FGRP &A1NULL)
             ENDDO

             IF         COND(&A1VVAL *EQ '1') THEN(DO)
             CALL       PGM(AG092C) PARM(&A1FGRP &A1NULL)
             ENDDO

 ENDPGM:     ENDPGM
