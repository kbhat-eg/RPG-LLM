/*                                                                   */
/*           Abc-analyse og de 100 mest/minst solgte                 */
/*                                                                   */
 STRPGM:     PGM        PARM(&dlist &dat)
/*                                                                   */
             DCL        VAR(&MBR)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&DAT)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&dlist)  TYPE(*CHAR) LEN(128)
/*                                                                   */
             RTVDTAARA  DTAARA(*LDA (911 10))  RTNVAR(&MBR)

CHKAPF:      CHKOBJ     OBJ(*LIBL/MABCPF) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(*LIBL/MABCPF) MBR(&MBR) TEXT('Member for +
                          overvåking')
                          ENDDO

CHKALU:      CHKOBJ     OBJ(*LIBL/MABCLU) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABCLU) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABCPF (&MBR)))
                          ENDDO

CHKALR:      CHKOBJ     OBJ(*LIBL/MABCLR) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABCLR) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABCPF (&MBR)))
                          ENDDO

CHKAL1:      CHKOBJ     OBJ(*LIBL/MABCL1) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABCL1) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABCPF (&MBR)))
                          ENDDO

CHKAL2:      CHKOBJ     OBJ(*LIBL/MABCL2) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABCL2) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABCPF (&MBR)))
                          ENDDO

CHKBPF:      CHKOBJ     OBJ(*LIBL/MABDPF) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(*LIBL/MABDPF) MBR(&MBR) TEXT('Member for +
                          overvåking')
                          ENDDO

CHKBLU:      CHKOBJ     OBJ(*LIBL/MABDLU) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDLU) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO

CHKBLR:      CHKOBJ     OBJ(*LIBL/MABDLR) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDLR) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO

CHKBL1:      CHKOBJ     OBJ(*LIBL/MABDL1) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL1) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL2:      CHKOBJ     OBJ(*LIBL/MABDL2) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL2) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL3:      CHKOBJ     OBJ(*LIBL/MABDL3) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL3) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL4:      CHKOBJ     OBJ(*LIBL/MABDL4) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL4) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL5:      CHKOBJ     OBJ(*LIBL/MABDL5) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL5) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL6:      CHKOBJ     OBJ(*LIBL/MABDL6) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL6) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL7:      CHKOBJ     OBJ(*LIBL/MABDL7) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL7) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
CHKBL8:      CHKOBJ     OBJ(*LIBL/MABDL8) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/MABDL8) MBR(&MBR) +
                          DTAMBRS((*CURRENT/MABDPF (&MBR)))
                          ENDDO
/*                                                                   */
             CHKOBJ     OBJ(*LIBL/LWB1PF) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)
 MSG:        SNDUSRMSG  MSG('Arbeidsfile for ABC-analyse +
                             finnes ikke. Kontakt systemansvarlig.+
                                ')
             GOTO       CMDLBL(ENDPGM)
             ENDDO
/*                                                                   */
/* Sjekker om member for ASLOGI ligger på fila                       */
/*                                                                   */
             CHKOBJ     OBJ(*LIBL/LWB1PF) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDPFM     FILE(*LIBL/LWB1PF) MBR(&MBR) TEXT('Member for +
                          ASLOGI')
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1LU) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1LU) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1L1) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1L1) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1L2) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1L2) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1L3) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1L3) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1L4) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1L4) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1L5) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1L5) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
             CHKOBJ     OBJ(*LIBL/LWB1L6) OBJTYPE(*FILE) MBR(&MBR)
             MONMSG     MSGID(CPF9815) EXEC(DO)
             ADDLFM     FILE(*LIBL/LWB1L6) MBR(&MBR) +
                          DTAMBRS((*CURRENT/LWB1PF (&MBR)))
                        ENDDO
/* Clear av arbeidsfil                                               */
             CLRPFM     FILE(*LIBL/LWB1PF) MBR(&MBR)
/*                                                                   */
/*    Overrider før man kaller programmet som danner abc-analyse     */
/*                                                                   */
             OVRDBF     FILE(MABCLU) TOFILE(*LIBL/MABCLU) MBR(&MBR)
             OVRDBF     FILE(MABDLU) TOFILE(*LIBL/MABDLU) MBR(&MBR)
             OVRDBF     FILE(MABDL1) TOFILE(*LIBL/MABDL1) MBR(&MBR)
             OVRDBF     FILE(MABDL2) TOFILE(*LIBL/MABDL2) MBR(&MBR)
             OVRDBF     FILE(MABDL7) TOFILE(*LIBL/MABDL7) MBR(&MBR)

             OVRDBF     FILE(LWB1LU) TOFILE(*LIBL/LWB1LU) MBR(&MBR)
             OVRDBF     FILE(LWB1L3) TOFILE(*LIBL/LWB1L3) MBR(&MBR)
             OVRDBF     FILE(LWB1L4) TOFILE(*LIBL/LWB1L4) MBR(&MBR)
             OVRDBF     FILE(LWB1L5) TOFILE(*LIBL/LWB1L5) MBR(&MBR)
             OVRDBF     FILE(LWB1L6) TOFILE(*LIBL/LWB1L6) MBR(&MBR)
/*                                                                   */
/*    Program med parametere som danner abc-analyse                  */
/*                                                                   */
             DLYJOB     DLY(15)
             CALL       PGM(MB701R) PARM(&dlist)
             DLYJOB     DLY(16)
/*                                                                   */
/*    Program som finner de 100 mest og minst solgte                 */
/*                                                                   */
             DLYJOB     DLY(17)
             CALL       PGM(MO706R) PARM(&DAT)
             DLYJOB     DLY(18)
/*                                                                   */
             DLTOVR     FILE(MABCLU)
             DLTOVR     FILE(MABDLU)
             DLTOVR     FILE(MABDL1)
             DLTOVR     FILE(MABDL2)
             DLTOVR     FILE(MABDL7)

             DLTOVR     FILE(LWB1LU)
             DLTOVR     FILE(LWB1L3)
             DLTOVR     FILE(LWB1L4)
             DLTOVR     FILE(LWB1L5)
             DLTOVR     FILE(LWB1L6)
/*                                                                   */
 ENDPGM:     ENDPGM
