/* 6.30 R6.30 080814 bsa  Nytt program                               */
/* 6.31  6.30 120116 bsa  Nye filer                                  */
/* 7.01  7.00 200819 nho  Nye filer                                  */
/*                                                                   */
/*                                                                   */
/**/
             PGM

             DCLF       FILE(RG007D)

             DCL        VAR(&A1VRKS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1VKSJ) TYPE(*CHAR) LEN(1)

             DCL        VAR(&A1NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&A1FGRP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&APLEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&APOKOK) TYPE(*CHAR) LEN(2)
             DCL        VAR(&GRPPRF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&GRP)    TYPE(*CHAR) LEN(7)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&APLEVL) VALUE('40')
             CHGVAR     VAR(&APOKOK) VALUE('  ')
             CALL       PGM(AA050C)  PARM(&APLEVL &APOKOK)
             IF         COND(&APOKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

             SNDRCVF    RCDFMT(A1BLD)

/* F3 + F12                                                          */

             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/* Bruker sin gruppeprofil                                           */
             RTVUSRPRF  GRPPRF(&GRPPRF)
             CHGVAR     VAR(&GRP) VALUE(%SST(&GRPPRF 1 6))

/* Kortregister status/master                                        */

             IF         COND(&A1VRKS *EQ '1') THEN(DO)
             CALL       PGM(RGUKSC) PARM(&A1FGRP &A1NULL)
             ENDDO

/* Kreditsjekk kort                                                  */

             IF         COND(&A1VKSJ *EQ '1') THEN(DO)
             CALL       PGM(RGKSJC) PARM(&A1FGRP &A1NULL)
             ENDDO

/* Kobling mellom avdeling og kasse id                               */

             IF         COND(&A1VKAV *EQ '1') THEN(DO)
             CALL       PGM(RGKAVC) PARM(&A1FGRP &A1NULL)
             ENDDO

/* 6.31 Prosjektrapport                                              */

             IF         COND(&A1RPRR *EQ '1') THEN(DO)
             CALL       PGM(RGRPRC) PARM(&A1FGRP &A1NULL)
             ENDDO

/* 6.31 Prosjekter                                                   */

             IF         COND(&A1RP1P *EQ '1') THEN(DO)
             CALL       PGM(RGPR1C) PARM(&A1FGRP &A1NULL)
             ENDDO

/* 7.01 Returkoder                                                   */

             IF         COND(&A1RA5P *EQ '1') THEN(DO)
                CALL       PGM(AG906C) PARM('RA50PF' &A1FGRP &GRP &A1NULL)
             ENDDO

/* 6.31 Endringslogg                                                 */

             IF         COND(&A1SLOG *EQ '1') THEN(DO)
             CALL       PGM(RGSLOGC) PARM(&A1FGRP &A1NULL)
             ENDDO


 ENDPGM:     ENDPGM
