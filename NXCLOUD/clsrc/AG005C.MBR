             PGM

             DCLF       FILE(AG005D)

             DCL        VAR(&DLIB) TYPE(*CHAR) LEN(6) VALUE('ADBnnn')

             DCL        VAR(&VA01) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA02) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA03) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA04) TYPE(*CHAR) LEN(1)
             DCL        VAR(&VA05) TYPE(*CHAR) LEN(1)

             DCL        VAR(&CLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NULL) TYPE(*CHAR) LEN(1)
             DCL        VAR(&LEVL) TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK) TYPE(*CHAR) LEN(2)

/* Kontrollere brukertilgang                                         */

             CHGVAR     VAR(&LEVL) VALUE('40')
             CHGVAR     VAR(&OKOK) VALUE('  ')
             CALL       PGM(AA050C) PARM(&LEVL &OKOK)
             IF         COND(&OKOK *NE 'OK') THEN(DO)
             CALL       PGM(AA004C)
             GOTO       CMDLBL(ENDPGM)
             ENDDO

/* Utleder foresl√•tt filgruppe utifra current-library                */

             RTVJOBA    CURLIB(&CLIB)
             CHGVAR     VAR(&FGRP) VALUE(%SUBSTRING(&CLIB 4 3))

/* Viser skjermbilde                                                 */

             SNDRCVF    RCDFMT(A1BLD)

/* F3/F12                                                            */
             IF         COND(&IN03) THEN(GOTO CMDLBL(ENDPGM))
             IF         COND(&IN12) THEN(GOTO CMDLBL(ENDPGM))

/* Avbryter dersom filgruppe ikke er valgt                           */

             IF         COND(&FGRP *EQ '   ') THEN(GOTO CMDLBL(ENDPGM))

/* Utleder databibliotek fra filgruppe                               */

             CHGVAR     VAR(&DLIB) VALUE(%SUBSTRING(&DLIB 1 3) *TCAT +
                          &FGRP)

/* Genererer de valgte tabellene                                     */

             IF         COND(&VA01 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('FSYNST' &DLIB &NULL)
             STRJRNPF   FILE(&DLIB/FSYNST) JRN(&DLIB/BUTIJRN)
             ENDDO

             IF         COND(&VA02 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XPSLST' &DLIB &NULL)
             STRJRNPF   FILE(&DLIB/XPSLST) JRN(&DLIB/BUTIJRN)
             ENDDO

             IF         COND(&VA03 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XPBOST' &DLIB &NULL)
             STRJRNPF   FILE(&DLIB/XPBOST) JRN(&DLIB/BUTIJRN)
             ENDDO

             IF         COND(&VA04 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XPRLST' &DLIB &NULL)
             STRJRNPF   FILE(&DLIB/XPRLST) JRN(&DLIB/BUTIJRN)
             ENDDO

             IF         COND(&VA05 *EQ '1') THEN(DO)
             CALL       PGM(AG901C) PARM('XPRRST' &DLIB &NULL)
             STRJRNPF   FILE(&DLIB/XPRRST) JRN(&DLIB/BUTIJRN)
             ENDDO

 ENDPGM:     ENDPGM
