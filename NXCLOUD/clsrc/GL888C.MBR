             PGM        PARM(&MEM1)

/* Definer variabler                                                 */

             DCL        VAR(&FIRM) TYPE(*CHAR) LEN(3)
             DCL        VAR(&MEM1) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MEM2) TYPE(*CHAR) LEN(7)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TEXT) TYPE(*CHAR) LEN(50)
             DCL        VAR(&FEIL) TYPE(*CHAR) LEN(1)

/* Finn bruker:                                                      */

             RTVDTAARA  DTAARA(*LDA (911 10)) RTNVAR(&USER)

/* Redigerer membernavn TELExxx, hvor xxx er firmanummer:            */

             RTVDTAARA  DTAARA(*LDA (944 3)) RTNVAR(&FIRM)
             CHGVAR     VAR(%SST(&MEM2 1 4)) VALUE('TELE')
             CHGVAR     VAR(%SST(&MEM2 5 3)) VALUE(&FIRM)


/* Redigerer beskrivelse:                                          */

             CHGVAR     VAR(%SST(&TEXT 1 4)) VALUE('TELE')
             CHGVAR     VAR(%SST(&TEXT 6 6)) VALUE('Firma:')
             CHGVAR     VAR(%SST(&TEXT 13 3)) VALUE(&FIRM)
             CHGVAR     VAR(%SST(&TEXT 17 7)) VALUE('Bruker:')
             CHGVAR     VAR(%SST(&TEXT 25 10)) VALUE(&USER)

/* Endrer membernavn fra GLxxxxx til TELEyyy (hvor "xxxxx" er en     */
/* unik teller og "yyy" er firmanummer) dersom kjøring ER, eller     */
/* har "gått over til" KONTROLLISTE.  Denne endringen betinger       */
/* imidlerid at member IKKE finnes fra før:                          */

/* &MEM1=member som er brukt i oppdateringen.                      */
/* &MEM2=member TELExxx, hvr xxx er firmanummer.                   */


/* Tester på om MEM1 fortsatt finnes.  I såfall er kjøring ikke    */
/* vellykket, d.v.s. blitt omdannet til kontrollliste.               */


/* FEIL er "0", d.v.s. member finnes ikke, som igjen betyr at      */
/* journalkjøringen er OK.                                           */


/* RENAMER member MEM1 til MEM2 dersom MEM2 ikke finnes fra    */
/* før:                                                              */





 TAGUT:

 ENDPGM:     ENDPGM
