/* *************************************************************** */
/* *                                                             * */
/* *  KVITTERING AV MOTTATT RETURER                              * */
/* *                                                             * */
/* *************************************************************** */

             PGM

/* Initiering av parametre.                                          */

             DCL        VAR(&PROG)   TYPE(*CHAR) LEN(10) +
                          VALUE('GL151R')

             DCL        VAR(&RAPP) TYPE(*CHAR) LEN(10) VALUE('GL151P')
             DCL        VAR(&VALG) TYPE(*CHAR) LEN(1) VALUE('0')
             DCL        VAR(&IN03) TYPE(*CHAR) LEN(1)
             DCL        VAR(&IN12) TYPE(*DEC)  LEN(1 0)
             DCL        VAR(&OUTQ)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&FORM)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&ACPIX)  TYPE(*CHAR) LEN(4)
             DCL        VAR(&ACPI)   TYPE(*DEC)  LEN(4 0)
             DCL        VAR(&HLDQ)   TYPE(*CHAR) LEN(4)
             DCL        VAR(&AKOPX)  TYPE(*CHAR) LEN(6)
             DCL        VAR(&AKOP)   TYPE(*DEC)  LEN(6 0)
             DCL        VAR(&OVRS)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&RAPP)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&ALINX)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&ALIN)   TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&PRTY)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&OFLW)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&BTCH)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&MEMBX)  TYPE(*CHAR) LEN(5)
             DCL        VAR(&MEMB)   TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&WMM1)  TYPE(*CHAR) LEN(10) VALUE('RKA      ')

/* Oppdaterer LDA med programnavn og kode for om formularparametre   */
/* skal endres.                                                      */

             CHGDTAARA  DTAARA(*LDA (800 10)) VALUE(&PROG)
             CHGDTAARA  DTAARA(*LDA (844 1)) VALUE(&VALG)
             CHGDTAARA  DTAARA(*LDA (846 10)) VALUE(&RAPP)

/* Call av program for formularparametre.                            */

/*           CALL       PGM(AP100R) PARM(&IN03 &IN12) */

             CALL       PGM(AP600R) PARM('GL151' '1' '0' &IN03 &BTCH)

/* Avslutt dersom F3/F12                                             */

             IF         COND(&IN03 *EQ '1') THEN(DO)
             GOTO       CMDLBL(END)
             ENDDO
             IF         COND(&IN12 *EQ 1) THEN(DO)
             GOTO       CMDLBL(END)
             ENDDO
             RTVDTAARA  DTAARA(*LDA (863 1)) RTNVAR(&BTCH)

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (800 10)) RTNVAR(&PROG)
             RTVDTAARA  DTAARA(*LDA (810 10)) RTNVAR(&OUTQ)
             RTVDTAARA  DTAARA(*LDA (820 10)) RTNVAR(&FORM)
             RTVDTAARA  DTAARA(*LDA (830 4))  RTNVAR(&ACPIX)
             RTVDTAARA  DTAARA(*LDA (834 4))  RTNVAR(&HLDQ)
             RTVDTAARA  DTAARA(*LDA (838 6))  RTNVAR(&AKOPX)
             RTVDTAARA  DTAARA(*LDA (845 1))  RTNVAR(&OVRS)
             RTVDTAARA  DTAARA(*LDA (846 10)) RTNVAR(&RAPP)
             RTVDTAARA  DTAARA(*LDA (856 3))  RTNVAR(&ALINX)
             RTVDTAARA  DTAARA(*LDA (859 1))  RTNVAR(&PRTY)
             RTVDTAARA  DTAARA(*LDA (860 3))  RTNVAR(&OFLW)
             RTVDTAARA  DTAARA(*LDA (864 5))  RTNVAR(&MEMBX)
             CHGVAR     VAR(&AKOP) VALUE(&AKOPX)
             CHGVAR     VAR(&ACPI) VALUE(&ACPIX)
             CHGVAR     VAR(&ALIN) VALUE(&ALINX)
             CHGVAR     VAR(&MEMB) VALUE(&MEMBX)
             CHGVAR     VAR(%SST(&WMM1 4 5)) VALUE(&MEMB)

/* Varselbilde 2                                                     */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt .....')
             CHGVAR     VAR(&MLD2) VALUE('Kvittering mottak pågår .')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

             OVRPRTF    FILE(GL151P) TOFILE(*FILE) DEV(&OUTQ) +
                          PAGESIZE(&ALIN 198) CPI(&ACPI) +
                          OVRFLW(&OFLW) OUTQ(&OUTQ) FORMTYPE(&FORM) +
                          COPIES(&AKOP) HOLD(&HLDQ) OUTPTY(&PRTY)

             CALL       PGM(GL151R)

END:         ENDPGM
