             PGM

             DCL        VAR(&FFIR)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&PROG)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&BTCH)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&WALI)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&WAPO)  TYPE(*DEC)  LEN(2 0)
             DCL        VAR(&MLD1)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MLD2)  TYPE(*CHAR) LEN(40)
             DCL        VAR(&MEMB)  TYPE(*CHAR) LEN(10) VALUE('UBIB   ')

/* Henter verdier i fra LDA.                                         */

             RTVDTAARA  DTAARA(*LDA (944 03)) RTNVAR(&FFIR)
             RTVDTAARA  DTAARA(*LDA (863 1))  RTNVAR(&BTCH)

             CHGVAR     VAR(%SST(&MEMB 5 3)) VALUE(&FFIR)

/* Saldooverføring                                                   */

             IF         COND(&BTCH *NE '1') THEN(DO)
             CHGVAR     VAR(&WALI) VALUE(4)
             CHGVAR     VAR(&WAPO) VALUE(44)
             CHGVAR     VAR(&MLD1) VALUE('Vennligst vent litt......')
             CHGVAR     VAR(&MLD2) VALUE('Saldooverføring pågår....')
             CALL       PGM(AA006C)  PARM(&WALI &WAPO &MLD1 &MLD2)
             ENDDO

/* Bygger membere dersom de ikke finnes                              */



             CALL       PGM(RH691R) PARM(&MEMB)

 ENDPGM:     ENDPGM
