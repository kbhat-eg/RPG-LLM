-- En slags versjon av AFPSPF. NÃ¸dvendig for Santander integrasjon m.m.

CREATE OR REPLACE PROCEDURE SP_INAVST()
LANGUAGE SQL
BEGIN
 DECLARE ERROR_VERDI INT DEFAULT 0;
 DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
  BEGIN
    SET ERROR_VERDI = 1;
  END;

  DROP ALIAS InnstillingerPrAvdeling;

END;

CALL SP_INAVST();

DROP PROCEDURE SP_INAVST();

CREATE OR REPLACE TABLE INAVST(
   firma numeric(3, 0) not null,
   systemnavn varchar(50),
   avdeling numeric(4, 0) not null,
   nokkel varchar(50) not null,
   verdi varchar(256),
   opprettet timestamp default CURRENT_TIMESTAMP,
   endret timestamp default CURRENT_TIMESTAMP,
   endret_av varchar(18) default user)
ON REPLACE PRESERVE ALL ROWS;


CREATE UNIQUE INDEX INAVIU on
       INAVST (firma, avdeling, systemnavn, nokkel);

CREATE ALIAS InnstillingerPrAvdeling FOR INAVST;




