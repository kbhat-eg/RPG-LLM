
CREATE OR REPLACE PROCEDURE SP_LOPEST()
LANGUAGE SQL
BEGIN
 DECLARE ERROR_VERDI INT DEFAULT 0;
 DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
  BEGIN
    SET ERROR_VERDI = 1;
  END;

  DROP ALIAS NBUOPENEDFILEGROUPSCONTACTS;

END;

CALL SP_LOPEST();

DROP PROCEDURE SP_LOPEST();

CREATE OR REPLACE TABLE LOPEST(
  UID              NUMERIC(18, 0) NOT NULL GENERATED ALWAYS AS IDENTITY
                   (START WITH 1 INCREMENT BY 1 CYCLE),
  Firma            FOR COLUMN LOPFIR NUMERIC(3, 0) NOT NULL,
  Kundenummer      FOR COLUMN LOPKNR NUMERIC(6, 0) NOT NULL,
  Kontaktperson    FOR COLUMN LOPKPN DEC(18, 0) NOT NULL,
  Kundeorgnummer   FOR COLUMN LOPFTN NUMERIC(18, 0) NOT NULL,
  OpprettetDato    FOR COLUMN LOPODA DATE NOT NULL DEFAULT CURRENT_DATE,
  OpprettetTid     FOR COLUMN LOPOTI TIME NOT NULL DEFAULT CURRENT_TIME,
  OpprettetAv      FOR COLUMN LOPOUS CHAR(10) NOT NULL DEFAULT ' ',
  EndretDato       FOR COLUMN LOPEDA DATE NOT NULL DEFAULT CURRENT_DATE,
  EndretTid        FOR COLUMN LOPETI TIME NOT NULL DEFAULT CURRENT_TIME,
  EndretAv         FOR COLUMN LOPEUS CHAR(10) NOT NULL DEFAULT ' ')
ON REPLACE PRESERVE ALL ROWS;

CREATE UNIQUE INDEX LOPEIU ON LOPEST(LOPFIR,LOPKNR);

LABEL ON TABLE LOPEST IS 'Keystore file pr kontaktperson';

CREATE ALIAS nbuOpenedFilegroupsContacts FOR LOPEST;
