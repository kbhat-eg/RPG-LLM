-- Purge 2 days before data from log file

CREATE OR REPLACE  TABLE PURDST(
 ClientId           FOR COLUMN PUCLID CHAR(25) NOT NULL DEFAULT ' ',
 DataType           FOR COLUMN PUDTYP CHAR(25) NOT NULL DEFAULT ' ',
 FileGroup          FOR COLUMN PUFLGP CHAR(25) NOT NULL DEFAULT ' ',
 NXSourceFile       FOR COLUMN PUSRCF CHAR(25) NOT NULL DEFAULT ' ',
 KeyRefValue        FOR COLUMN PUKREF CHAR(25) NOT NULL DEFAULT ' ',
 ExtractedData      FOR COLUMN PUEXDT CHAR(5000) NOT NULL DEFAULT ' ',
 ExtractedCount     FOR COLUMN PUEXCN CHAR(15) NOT NULL DEFAULT ' ',
 ExtStartTime       FOR COLUMN PUSTTM TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 ExtEndTime         FOR COLUMN PUEDTM TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 NotEligibletoProc  FOR COLUMN PUNELG CHAR(5000) NOT NULL DEFAULT ' ',
 NotProcdCount      FOR COLUMN PUNPRC CHAR(15) NOT NULL DEFAULT ' ',
 ProcessedData      FOR COLUMN PUPRDT CHAR(5000) NOT NULL DEFAULT ' ',
 ProDataCount       FOR COLUMN PUPRCN CHAR(15) NOT NULL DEFAULT ' ',
 RejectedData       FOR COLUMN PURJDT CHAR(3000) NOT NULL DEFAULT ' ',
 RejDataCount       FOR COLUMN PURJCN CHAR(15) NOT NULL DEFAULT ' ',
 ResendCount        FOR COLUMN PURSND CHAR(15) NOT NULL DEFAULT ' ',
 ProcessStatus      FOR COLUMN PUPSTS CHAR(1) NOT NULL DEFAULT ' ',
 hubKeyValue        FOR COLUMN PUKEYV CHAR(100) NOT NULL DEFAULT ' ',
 Comments           FOR COLUMN PUCMNT CHAR(1000) NOT NULL DEFAULT ' ')
ON REPLACE PRESERVE ALL ROWS;

LABEL ON TABLE PURDST
	IS 'Purgelogfile2days';
