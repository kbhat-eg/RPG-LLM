-- Purge 2 days before data from log file

CREATE OR REPLACE  TABLE PURDST(
 ClientId           FOR COLUMN PUCLID CHAR(100) NOT NULL DEFAULT ' ',
 DataType           FOR COLUMN PUDTYP CHAR(25) NOT NULL DEFAULT ' ',
 FileGroup          FOR COLUMN PUFLGP CHAR(25) NOT NULL DEFAULT ' ',
 NXSourceFile       FOR COLUMN PUSRCF CHAR(25) NOT NULL DEFAULT ' ',
 KeyRefValue        FOR COLUMN PUKREF CHAR(25) NOT NULL DEFAULT ' ',
 ExtractedData      FOR COLUMN PUEXDT CHAR(50) NOT NULL DEFAULT ' ',
 ExtStartTime       FOR COLUMN PUSTTM TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 ExtEndTime         FOR COLUMN PUEDTM TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 ResendCount        FOR COLUMN PURSND CHAR(15) NOT NULL DEFAULT ' ',
 ProcessStatus      FOR COLUMN PUPSTS CHAR(1) NOT NULL DEFAULT ' ',
 hubKeyValue        FOR COLUMN PUKEYV CHAR(100) NOT NULL DEFAULT ' ',
 Comments           FOR COLUMN PUCMNT CHAR(1000) NOT NULL DEFAULT ' ' ,
 Resentuser         FOR COLUMN PURUSR CHAR(10) NOT NULL DEFAULT ' ' ,
 RESENTTIME         FOR COLUMN PURTME CHAR(20) NOT NULL DEFAULT ' ' )
ON REPLACE PRESERVE ALL ROWS;

LABEL ON TABLE PURDST
	IS 'Purgelogfile2days';
