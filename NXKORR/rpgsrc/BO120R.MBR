     h datedit(*dmy)
     h option(*nodebugio)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASSHOP
      * Program . . . . : BO120R
      * Beskrivelse . . : Utskrift av kontroll-liste, parameterprogram
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      * R3.12 230800 AMD  Sjekker om avstemming eller overføring til
      *                   økonomi er igang, varsler i så fall.
      *                   Setter status som sier at avstemming er startet.
      * R3.13 051200 AMD  Kontroll fra jobbregister skal bare gjelde
      *                   for avstemmingsliste (ikke kontrolliste)
      * R5.21 200803 AMD  Lagt om til AP600R i stedet for AP100R
      *                   (Kun fjernet kode + ryddet)
      * V5.30 131004 HFL  Bare comp.
      *       221204 HKO  Tilpasset utseende på skjermbilde
5.41  * R5.41 060606 AMD  Kode for at avstemmingsliste er satt igang
      *                   oppdateres ikke dersom jobb sendes på Evoke
6.nu  * 6.30  170614 bof  Endring ihht. nummerutvidelse
6.30  * 6.30  171114 bsa  Justert pga pop up og jacada
7.xx  * 7.00  150217 bsa  Endringer reltart til ny GUI. NB Kan kun gjelde DDS
7.01  * R7.00 030419 bkv  Sjekker om det er krav til utfylt
7.01  *                   arbeidsstasjonsgruppe via AVALPF.
7.02  * R7.00 290519 nho  Legger ut default verdier 1 på bildet
7.02  *                   AVALPF.
6.nu  * 6.30  171019 bkv  Nummerserie rettelse ldlavs
      *
8.00  *K00 140621 sst NXS-9050 Kjøre dagsoppgjør fra Jobbplan
8.01  *K00 040923 sst NXS-17211 Justert rutine for sperring for kjøring fra andr
8.02  *K00 281123 sst NXS-17211 Styre valg F6 vedr aut. dags.oppgj fra switch
8.03  *K00 100624 bsa     Skille dagsoppgjør og oppdatering til økonomi i egne
8.03  *K00 100624         parametre.
8.04  *K00 110624 bsa     Hente inn informasjon om oppsett.
8.05  *K00 110624 bsa     Kan ikke kjøre oppdatering av økonomi sammen med
8.05  *K00 110624 bsa     dagsoppgjør hvis de har NX økonomi.
8.06  *K00 040925 bsa     Mulighet for å legge inn 2 spm og svar
8.07  *K00 050925 bsa     Fjerner koden for kjøring av dagsoppgjør fra jobbkalen
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     fvotyl1    if   e           k disk    rename(votypfr:votyl1r)
     fbstsl1    if   e           k disk    rename(bstspfr:bstsl1r)
     fbwsdlg    if   e           k disk    rename(bwsdpfr:bwsdlgr)
     fbwsdl1    if   e           k disk    rename(bwsdpfr:bwsdl1r)
7.01 favall1    if   e           k disk    rename(avalpfr:avall1r)
8.00 fbdoplu    uf a e           k disk    rename(bdoppfr:bdoplur)
8.05 fxtill1    if   e           k disk    rename(xtilpfr:xtill1r)
     fbo120d    cf   e             workstn
      *
      * Definering av datastrukturer
      *
     d                 ds
     d ldambr                        10
     d  ldabok                        1    overlay(ldambr)
     d  ldafir                        3  0 overlay(ldambr:2)
     d  ldalst                        6  0 overlay(ldambr:5)
      *
     d                 ds
     d ldprec                       256
     d  ldotal                        4    overlay(ldprec)
     d  ldot01                        2    overlay(ldprec:5)
     d  ldot02                        2    overlay(ldprec:7)
     d  ldot03                        2    overlay(ldprec:9)
     d  ldot04                        2    overlay(ldprec:11)
     d  ldot05                        2    overlay(ldprec:13)
     d  ldot06                        2    overlay(ldprec:15)
     d  ldot07                        2    overlay(ldprec:17)
     d  ldot08                        2    overlay(ldprec:19)
     d  ldot09                        2    overlay(ldprec:21)
     d  ldot10                        2    overlay(ldprec:23)
     d  ldwsgr                        6    overlay(ldprec:25)
     d  ldwsal                       10    overlay(ldprec:31)
     d  ldws01                       10    overlay(ldprec:41)
     d  ldws02                       10    overlay(ldprec:51)
     d  ldws03                       10    overlay(ldprec:61)
     d  ldws04                       10    overlay(ldprec:71)
     d  ldws05                       10    overlay(ldprec:81)
     d  ldws06                       10    overlay(ldprec:91)
     d  ldws07                       10    overlay(ldprec:101)
     d  ldws08                       10    overlay(ldprec:111)
     d  ldws09                       10    overlay(ldprec:121)
     d  ldws10                       10    overlay(ldprec:131)
     d  ldavst                        1  0 overlay(ldprec:142)
     d  lddato                       10d   datfmt(*iso)
     d                                     overlay(ldprec:143)
     d  ldperi                        6  0 overlay(ldprec:153)
     d  lddekn                        1  0 overlay(ldprec:159)
     d  ldvdag                        2  0 overlay(ldprec:160)
     d  lddeta                        1  0 overlay(ldprec:162)
     d  ldtota                        1  0 overlay(ldprec:163)
     d  ldfrad                       10d   datfmt(*iso)
     d                                     overlay(ldprec:164)
     d  ldtild                       10d   datfmt(*iso)
     d                                     overlay(ldprec:174)
     d  ldaarr                        4  0 overlay(ldprec:184)
6.nu d  ldlavs                        8  0 overlay(ldprec:188)
6.nu d  ldldet                        6  0 overlay(ldprec:196)
6.nu d  ldtime                        6  0 overlay(ldprec:202)
6.nu d  ldkred                        1  0 overlay(ldprec:208)
8.00 d  ldjobp                        1    overlay(ldprec:209)
8.03 d  ldokoo                        1    overlay(ldprec:210)
      *
      * Definering av local data area
      *
     d lda            uds
     d l_prtf                800    809
     d l_chgv                844    844
7.02 d l_user                911    920
7.02 d l_filg                931    933
     d l_sfir                944    946  0
     d l_fnav                951    980
      *
      * Definering av variable i nøkler
      *
     d w_firm          s                   like(bwfirm)
     d votyl1_otyp     s                   like(vaotyp)
     d bwsdl1_wsid     s                   like(bwwsid)
     d bwsdlg_wsgr     s                   like(bwwsgr)
7.01 d avall1_apgm     s                   like(avapgm)
7.01 d bdoplu_sgr      s                   like(bopsgr)
8.05 d xtill1_regi     s                      like(xtregi)
8.05 d xtill1_felt     s                      like(xtfelt)
8.05 d xtill1_xkey     s                      like(xtxkey)
      *
      * Definering av variable
      *
     d w_kode          s              2  0
     d w_onof          s              1  0
7.02 d w_avst          s              1
7.02 d w_tota          s              1
7.02 d w_deta          s              1
7.02 d w_dekn          s              1
7.02 d w_pos           s              2s 0
8.00 d w_kon           s              1
8.01 d w_runde1        s              1    inz('J')
8.01 d w_type          s              1
8.01 d w_mld1          s             50
8.01 d w_mld2          s             50
8.01 d w_mld3          s             50
8.06 d w_mld4          s             50
8.01 d w_svar          s              1
8.01 d w_in12          s              1
8.02 d w_prog          s             50
      *
     d grpant          s              1  0
     d wpin03          s              1
     d wsfast          s             10
     d wsfell          s              6
     d wsfirm          s              3  0
     d wskode          s              1
6.nu d wsnumm          s              8  0
     d wstype          s              2
     d wwaar           s              2  0
     d wwamn           s              4  0
     d wwcen           s              4  0
     d wwmnd           s              2  0
     d wwvalg          s              1
      *
6.22  *
6.22  * Firmastyrt validering av felt
6.22  *
6.22 d u_wsgr          s              1    inz(*off)
7.02 d u_702           s              1    inz(*off)
      *
7.02   dcl-s co402_verdi1  char(1);
7.02   dcl-s co402_verdi2  char(2048);
7.02   DCL-PR CO402R EXTPGM('CO402R');
7.02     p_filgrp            char(3)     const;
7.02     p_firm              packed(3:0) const;
7.02     p_lager             packed(2:0) const;
7.02     p_nokkel            char(50)    const;
7.02     p_verdi1            char(1);
7.02     p_verdi2            char(2048);
7.02   END-PR;
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * B1 Behandle åpningsbildet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
8.05  *
8.05  * Tilleggsregister
8.05  *
8.05 c                   eval      xtill1_regi = 'FSTSPF'
8.05 c                   eval      xtill1_felt = 'OKOSYS'
8.05 c                   eval      xtill1_xkey = *blanks
8.05 c     xtill1_key    chain     xtill1
8.05 c                   if        not %found
8.05 c                   eval      xtnumm = 99
8.05 c                   endif
8.01  *  Sjekk om dagsoppgjør er satt opp til å kjøres fra jobbplan
8.01  *
8.01 c                   eval      bdoplu_sgr  = *blank
8.01 c     bdoplu_key    chain     bdoplu
8.01 c                   if        %found(bdoplu)
8.01 c                   eval      ldprec = boprec
8.07 c*                  eval      b1okoo = ldokoo
8.07 c*                  eval      b1jobp = ldjobp
8.01 c                   if        ldjobp = 'J'
8.01  *                            *in53 styrer F1 på bildet.
8.01 c*                  eval      *in53 = *on   Ser ikke ut til å være nødvendi
8.01 c                   call      'AP700C'
8.01 c                   parm                    w_type
8.01 c                   if        w_type = '1'
8.01  *
8.01 c                   eval      w_mld1 = 'Dagsoppgjør er satt opp til å kjør-
8.01 c                             es automatisk'
8.01 c                   eval      w_mld2 = 'Kan kjøres direkte ved å svare >J<-
8.01 c                             '
8.06 c                   eval      w_mld3 = 'Dagsoppgjør blir nå kjørt direkte -
8.06 c                             fra skjerm.  '
8.06 c                   eval      w_mld4 = 'Husk at oppdatering til Økonomi må-
8.06 c                              kjøres også. '
8.06  *
8.06 c                   call      'AA032R'
8.06 c                   parm                    w_mld1
8.06 c                   parm                    w_mld2
8.06 c                   parm                    w_svar
8.06 c                   parm                    w_mld3
8.06 c                   parm                    w_mld4
8.06 c                   parm                    w_in12
8.01  *                                          '
8.06 c*                  call      'AA007R'
8.06 c*                  parm                    w_mld1
8.06 c*                  parm                    w_mld2
8.06 c*                  parm                    w_svar
8.06 c*                  parm                    w_in12
8.01  *
8.01 c                   if        w_svar <> 'J'
8.01 c                   goto      xslutt
8.01 c                   endif
8.01  *
8.06 c*                  eval      w_mld1 = 'Dagsoppgjør blir nå kjørt direkte -
8.06 c*                            fra skjerm.  '
8.06 c*                  eval      w_mld2 = 'Husk at oppdatering til Økonomi må-
8.06 c*                             kjøres også. '
8.06 c*                  call      'AA007R'
8.06 c*                  parm                    w_mld1
8.06 c*                  parm                    w_mld2
8.06 c*                  parm                    w_svar
8.06 c*                  parm                    w_in12
8.01 c                   endif
8.01  *
8.01 c                   endif
8.01 c                   endif
      *
      * Er Avstemming igang fra en annen skjerm ?
      *
8.01 c                   if        w_runde1 = 'J'
8.00 c**                 if        b1jobp <> 'J'
8.01 c**                 if        b1avst = 1
8.01 c                   eval      w_kode = 03
8.01 c                   eval      w_onof = 0
8.01 c                   call      'FA730R'
8.01 c                   parm                    w_kode
8.01 c                   parm                    w_onof
8.01  *
8.01 c                   if        w_onof = 1
8.01 c                   goto      xslutt
8.01 c                   endif
8.01  *
8.01  * Kjøres overføring til regnskap fra en annen skjerm ?
8.01  *
8.01 c                   eval      w_kode = 04
8.01 c                   eval      w_onof = 0
8.01 c                   call      'FA730R'
8.01 c                   parm                    w_kode
8.01 c                   parm                    w_onof
8.01  *
8.01 c                   if        w_onof = 1
8.01 c                   goto      xslutt
8.01 c                   endif
8.01  *
8.01 c                   eval      w_runde1 = *blank
8.01 c                   endif
8.05  *
8.05  * Skal ikke være lov med økonomisk oppdatering, NX økonomi
8.05  * og kjøring på jobbplan.
8.05  *
8.05 c                   if        xtnumm = 0   and
8.07 c*                            b1jobp = 'J' and
8.07 c                             ldjobp = 'J' and
8.07 c*                            b1okoo = 'J'
8.07 c                             ldokoo = 'J'
8.05 c                   eval      w_mld1 = 'NX økonomi og auto dagsopp/ø+
8.05 c                                       ko oppdat er ugyldig'
8.05 c                   call      'AA005R'
8.05 c                   parm                    w_mld1
8.05 c                   endif
      *
     c     b1tag         tag
      *
      *
      * Nullstiller/Legger inn verdier
      *
     c                   move      *loval        ldfrad
     c                   move      *hival        ldtild
     c                   eval      ldaarr = 1995
     c                   eval      ldavst = *zero
     c                   eval      lddekn = *zero
     c                   eval      lddeta = *zero
     c                   eval      ldtota = *zero
     c                   move      *loval        lddato
     c                   eval      ldperi = *zero
     c                   eval      ldvdag = *zero
     c                   eval      ldtime = *zero
      *
     c                   eval      ldlavs = *zero
     c                   eval      ldldet = *zero
      *
     c                   eval      b1dato = udate
     c                   eval      b1time = *zero
     c                   eval      b1otyp = '*ALL'
     c                   movel     '*ALL'        b1wsid
     c                   eval      b1wsgr = *blank
     c                   eval      b1avst = *zero
     c                   eval      b1dekn = *zero
     c                   eval      b1deta = *zero
     c                   eval      b1tota = *zero
     c                   eval      b1kred = baaukr
      *
     c                   move      *on           *in21
      *
      * Behandler bildet
      *
     c     b1taga        tag
7.02  *
7.02  * Sjekk om det skal være default verdi på inntasings bildet
7.02 c                   if        u_702 = *on
7.02 c                   move      w_avst        b1avst
7.02 c                   move      w_tota        b1tota
7.02 c                   move      w_deta        b1deta
7.02 c                   move      w_dekn        b1dekn
7.02 c                   endif
      *
     c                   exfmt     b1bld
     c                   move      *off          *in21
      *
      * F3=Avslutt
      *
8.01 c                   if        *inkc = *on
8.01 c                   eval      w_kode = 03
8.01 c                   eval      w_onof = 0
8.01 c                   call      'FA720R'
8.01 c                   parm                    w_kode
8.01 c                   parm                    w_onof
8.01 c                   goto      xslutt
8.01 c                   endif
      *
      * F12=Annuler
      *
     c     *inkl         cabeq     *on           b1tag
8.03  *
8.03  * F6=Skal ikke være lov hvis ikke daglig kjøring fra jobbplan.
8.03  *
8.07 c*                  if        *inkf = *on and
8.07 c*                            b1jobp <> 'J'
8.07 c*                  eval      w_mld1 = 'F6 er ikke gyldig uten å vel+
8.07 c*                                      ge aut. dagsoppgjør'
8.07 c*                  call      'AA005R'
8.07 c*                  parm                    w_mld1
8.07 c*                  endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Behandlinging av utskriftsvalgh som er tastet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Sjekk   Miste en av totaler, detaljer eller dekn.liste
      * Må være utfylt
      *
     c                   if        b1deta = 0
     c                   if        b1tota = 0
     c                   if        b1dekn = 0
     c                   move      *on           *in38
     c                   goto      b1taga
     c                   endif
     c                   endif
     c                   endif
      *
      * Sjekk   Dersom Avstemmingsliste skal kjøres og dekn.liste
      *         er valgt må også totaler være valgt
      *
     c                   if        b1avst = 1
     c                   if        b1dekn = 1
     c                   if        b1tota = 0
     c                   move      *on           *in39
     c                   goto      b1taga
     c                   endif
     c                   endif
     c                   endif
      *
      * Legger over valgte verdier til LD-Parameter
      *
     c                   eval      ldtime = b1time
     c                   eval      ldavst = b1avst
     c                   eval      lddekn = b1dekn
     c                   eval      lddeta = b1deta
     c                   eval      ldtota = b1tota
     c                   eval      ldkred = b1kred
8.07 c*                  eval      ldjobp = b1jobp
8.07 c*                  eval      ldokoo = b1okoo
      *
      * Legger ut opplysninger til LD-området
      *
     c                   if        b1dato <> 0
     c     *dmy          move      b1dato        lddato
     c     *dmy          move      b1dato        ldfrad
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Behandling av tester i forbindelse med åpningsbildet
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Sjekk   ORDRE-TYPE
      *
      * Sjekk   Skal alle ordretyper skrives ut
      *
     c                   if        b1otyp = '*ALL'
     c                   movel     b1otyp        ldotal
     c                   eval      ldot01 = *blank
     c                   eval      ldot02 = *blank
     c                   eval      ldot03 = *blank
     c                   eval      ldot04 = *blank
     c                   eval      ldot05 = *blank
     c                   eval      ldot06 = *blank
     c                   eval      ldot07 = *blank
     c                   eval      ldot08 = *blank
     c                   eval      ldot09 = *blank
     c                   eval      ldot10 = *blank
     c                   goto      b1sarb
     c                   endif
      *
      * Sjekk   ORDRE-TYPE  (Når kun en type er valgt)
      *
     c                   if        b1otyp <> *blank
      *
     c                   eval      w_firm = l_sfir
     c                   movel     b1otyp        votyl1_otyp
     c     votyl1_key    chain     votyl1r                            90
     c                   if        *in90 = *on
     c                   move      *on           *in31
     c                   goto      b1taga
     c                   endif
      *
     c                   movel     b1otyp        ldotal
     c                   eval      ldot01 = *blank
     c                   eval      ldot02 = *blank
     c                   eval      ldot03 = *blank
     c                   eval      ldot04 = *blank
     c                   eval      ldot05 = *blank
     c                   eval      ldot06 = *blank
     c                   eval      ldot07 = *blank
     c                   eval      ldot08 = *blank
     c                   eval      ldot09 = *blank
     c                   eval      ldot10 = *blank
     c                   endif
      *
      * Sjekk   ARBEIDSSTASJON ELLER GRUPPE ARBEIDSSTASJONER
      *
     c     b1sarb        tag
      *
      * Sjekk   At ikke både arbeidsstasjon og gruppe er utfylt
      *
     c                   if        b1wsgr <> *blank
     c                   if        b1wsid <> *blank
     c                   move      *on           *in34
     c                   goto      b1taga
     c                   endif
     c                   endif
7.01  *
7.01  * Sjekk   At ikke arbeidsstasjongruppe er blank
7.01  *
7.01 c                   if        u_wsgr =  *on
7.01 c                   if        b1wsgr =  *blank
7.01 c                   move      *on           *in52
7.01 c                   goto      b1taga
7.01 c                   endif
7.01 c                   endif
      *
      * Dersom gruppe arbeidsstasjoner er valgt hopp til rett rutine
      *
     c                   if        b1wsgr <> *blank
     c                   goto      b1grup
     c                   endif
      *
      * SJEKK,  ARBEIDSSTASJONER
      *
     c                   if        b1wsid = '*ALL'
     c                   eval      w_firm = l_sfir
     c                   eval      bwsdl1_wsid = *blank
     c     bwsdl1_key    setll     bwsdl1r
     c     b1lop1        tag
     c                   eval      *in90 = *off
     c                   read      bwsdl1r                                90
     c                   if        *in90 = *on
     c                   goto      b1lop2
     c                   endif
     c                   if        bwakti <> *zero
     c                   eval      *in36 = *on
     c                   goto      b1taga
     c                   endif
     c                   goto      b1lop1
      *
     c     b1lop2        tag
     c                   movel     b1wsid        ldwsal
     c                   eval      ldws01 = *blank
     c                   eval      ldws02 = *blank
     c                   eval      ldws03 = *blank
     c                   eval      ldws04 = *blank
     c                   eval      ldws05 = *blank
     c                   eval      ldws06 = *blank
     c                   eval      ldws07 = *blank
     c                   eval      ldws08 = *blank
     c                   eval      ldws09 = *blank
     c                   eval      ldws10 = *blank
     c                   eval      ldwsgr = *blank
     c                   goto      b1kode
     c                   endif
      *
     c                   if        b1wsid <> *blank
     c                   eval      w_firm = l_sfir
     c                   eval      bwsdl1_wsid = b1wsid
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in32 = *on
     c                   goto      b1taga
     c                   enddo
      *
     c                   if        bwakti <> *zero
     c                   eval      *in36 = *on
     c                   goto      b1taga
     c                   endif
      *
     c                   movel     b1wsid        ldwsal
     c                   eval      ldws01 = *blank
     c                   eval      ldws02 = *blank
     c                   eval      ldws03 = *blank
     c                   eval      ldws04 = *blank
     c                   eval      ldws05 = *blank
     c                   eval      ldws06 = *blank
     c                   eval      ldws07 = *blank
     c                   eval      ldws08 = *blank
     c                   eval      ldws09 = *blank
     c                   eval      ldws10 = *blank
     c                   eval      ldwsgr = *blank
     c                   goto      b1kode
     c                   endif
      *
      * SJEKK,  ARBEIDSSTASJONSGRUPPE
      *
     c     b1grup        tag
      *
     c                   eval      ldwsal = *blank
     c                   eval      ldws01 = *blank
     c                   eval      ldws02 = *blank
     c                   eval      ldws03 = *blank
     c                   eval      ldws04 = *blank
     c                   eval      ldws05 = *blank
     c                   eval      ldws06 = *blank
     c                   eval      ldws07 = *blank
     c                   eval      ldws08 = *blank
     c                   eval      ldws09 = *blank
     c                   eval      ldws10 = *blank
     c                   eval      ldwsgr = *blank
      *
     c                   eval      w_firm = l_sfir
     c                   eval      bwsdlg_wsgr = b1wsgr
     c                   eval      grpant = *zero
     c     bwsdlg_key    setll     bwsdlgr
     c     b1lop3        tag
     c                   eval      *in90 = *off
     c                   read      bwsdlgr                                90
     c   90              do
     c                   goto      b1lop4
     c                   enddo
     c                   if        bwfirm <> l_sfir
     c                   goto      b1lop4
     c                   endif
     c                   if        bwwsgr <> b1wsgr
     c                   goto      b1lop4
     c                   endif
     c                   z-add     1             grpant
     c                   if        bwakti <> *zero
     c                   eval      *in35 = *on
     c                   goto      b1taga
     c                   endif
     c                   goto      b1lop3
      *
     c     b1lop4        tag
     c                   if        grpant = 0
     c                   eval      *in33 = *on
     c                   goto      b1taga
     c                   endif
      *
     c                   movel     b1wsgr        ldwsgr
     c                   goto      b1kode
      *
     c     b1kode        tag
      *
8.00 c                   if            *inka = *off
8.00 c                             and *inkd = *off
8.07 c*                            and *inkf = *off
8.00 c                             and w_kon <> 'J'
8.00  *
     c                   if        b1otyp = *blank
     c                   exsr      b5tag
     c                   if        *inkc = *on
     c                   goto      b1taga
     c                   endif
     c                   endif
      *
     c                   if        b1wsid = *blank
     c                   if        b1wsgr = *blank
     c                   exsr      b4tag
     c                   if        *inkc = *on
     c                   goto      b1taga
     c                   endif
     c                   endif
     c                   endif
      *
      * Kaller opp subrutine for periode og virkedager
      *
     c                   if        b1avst = 1
     c                   if        b1tota = 1
     c                   exsr      b2tag
     c                   if        *inkc = *on
     c                   goto      b1taga
     c                   endif
     c                   endif
     c                   endif
      *
      * Kaller opp subrutine for virkedager
      *
     c                   if        b1avst = 0
     c                   if        b1dekn = 1
     c                   exsr      b3tag
     c                   if        *inkc = *on
     c                   goto      b1taga
     c                   endif
     c                   endif
     c                   endif
8.00  *
8.00 c                   eval      w_kon = 'J'
8.00 c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Inntasting er avsluttet, Klargjør verdier
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
8.01  * Sjekk om kjøreing fra annen skjerm er flyttet herfra og opp.
      *
      * Oppdater jobb-register med aktiv-flagg
      *
8.01 c                   if        b1time = 0
     c                   eval      w_kode = 03
     c                   eval      w_onof = 1
     c                   call      'FA720R'
     c                   parm                    w_kode
     c                   parm                    w_onof
8.01 c                   endif
      *
      *
      * Hent nummer for liste
      *
     c                   eval      wsfell = baalst
     c                   exsr      hntnum
     c                   eval      ldalst = wsnumm
      *
      * Hent nummer for avstemmingsliste
      *
     c                   if        b1avst = 1
     c                   eval      wsfell = baaavs
     c                   exsr      hntnum
     c                   eval      ldlavs = wsnumm
     c                   endif
      *
      * Hent nummer for detalj-liste
      *
     c                   if        b1avst = 1
     c                   if        b1deta = 1
     c                   eval      wsfell = baadet
     c                   exsr      hntnum
     c                   eval      ldldet = wsnumm
     c                   endif
     c                   endif
8.01  *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Kaller opp 'CL-program' før utskriften
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
8.00 c                   eval      wwvalg = *blank
      *
      * F4=Legge jobb på jobbkø
      *
     c                   if        *inkd = *on
8.07 c*                            and b1jobp <> 'J'
8.07 c                             and ldjobp <> 'J'
     c                   eval      wwvalg = '1'
     c                   endif
8.00  *
8.00  * F6=Legge jobb på jobbplan for kjøring daglig
8.00  *
8.07 c*                  if        *inkf = *on
8.02  *  Har firmaet tilgang til denne løsningen?
8.07 c*                  if        *in55 = *off
8.02  *
8.02  *  Sjekk om firma har spesialiteter på noen av de berørte programmer
8.02  *
8.07 c*                  Call      'BO129C'
8.07 c*                  parm                    w_prog
8.07 c*                  if        w_prog <> *blank
8.07 c*                  eval      w_mld1 = 'Derre har spesialversjoner +
8.07 c*                                    på følgende programmer:'
8.07 c*                  eval      w_mld2 = w_prog
8.07 c*                  eval      w_mld3 = 'Disse må tilpasses før +
8.07 c*                                      denne løsningen startes'
8.07 c*                  call      'AA031R'
8.07 c*                  parm                    w_mld1
8.07 c*                  parm                    w_mld2
8.07 c*                  parm                    w_mld3
8.02  *
8.07 c*                  eval      w_mld1 = 'Dersom nevnte programmer +
8.07 c*                                      allerede er tilpasset'
8.07 c*                  eval      w_mld2 = 'svar >J< og løsningen +
8.07 c*                                      settes i drift'
8.07 c*                  call      'AA007R'
8.07 c*                  parm                    w_mld1
8.07 c*                  parm                    w_mld2
8.07 c*                  parm                    w_svar
8.07 c*                  parm                    w_in12
8.07 c*                  if        w_svar <> 'J'
8.07 c*                  goto      b1taga
8.07 c*                  endif
8.07 c*                  endif
8.02  *
8.07 c*                  eval      bdoplu_sgr  = *blank
8.07 c*    bdoplu_key    chain     bdoplu
8.07 c*                  eval      boprec = ldprec
8.07 c*                  time                    bopeda
8.07 c*                  time                    bopeti
8.07 c*                  eval      bopeus = l_user
8.07 c*                  if        %found(bdoplu)
8.07 c*                  update    bdoplur
8.07 c*                  else
8.07 c*                  eval      bopfir = l_sfir
8.07 c*                  eval      bopsgr = *blank
8.07 c*                  time                    bopoda
8.07 c*                  time                    bopoti
8.07 c*                  eval      bopous = l_user
8.07 c*                  write     bdoplur
8.07 c*                  endif
8.07 c*                  eval      wwvalg = '3'
8.02  *
8.07 c*                  else
8.07 c*                  eval      w_mld1 = 'Dette firma har ikke tilgang til +
8.07 c*                                      denne funksjonen'
8.07 c*                  eval      w_mld2 = 'Kontakt EG for avtale'
8.07 c*                  call      'AA007R'
8.07 c*                  parm                    w_mld1
8.07 c*                  parm                    w_mld2
8.07 c*                  parm                    w_svar
8.07 c*                  parm                    w_in12
8.07 c*                  goto      xslutt
8.07 c*                  endif
8.02  *
8.07 c*                  endif
      *
      * Dersom start på bestemt klokkeslett, gjør rett valg
      *
     c                   if        ldtime <> *zero
8.00 c                             and ldjobp <> 'J'
     c                   eval      wwvalg = '2'
     c                   endif
      *
8.00 c                   if        wwvalg <> *blank
8.00 c                             or (*inka = *on
8.00 c                              and ldjobp <> 'J')
8.00 c                             or (wwvalg = *blank
8.00 c                              and w_kon = 'J')
     c                   eval      ldabok = 'K'
     c                   eval      ldafir = l_sfir
8.01 c                   if        wwvalg = *blank
8.01 c                   eval      wwvalg = '0'
8.01 c                   endif
      *
     c                   call      'BO121C'
     c                   parm                    ldambr
     c                   parm                    ldprec
     c                   parm                    wwvalg
8.00 c                   else
8.00 c                   goto      b1taga
8.00 c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     xslutt        tag
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Sjekk av fakturadato og periode
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     b2tag         begsr
      *
     c                   move      udate         wwaar
     c                   move      udate         wwamn
     c                   movel     wwamn         wwmnd
     c                   movel     wwmnd         b2peri
     c                   move      wwaar         b2peri
     c                   movel     b1dato        b2vdag
      *
     c     b2taga        tag
     c                   z-add     08            wactli
     c                   z-add     22            wactpo
     c                   if        b1wsid = *blank
     c                   if        b1wsgr = *blank
     c                   goto      b2tagb
     c                   endif
     c                   endif
     c                   sub       02            wactli
     c                   add       16            wactpo
     c     b2tagb        tag
     c                   if        b1otyp <> *blank
     c                   sub       02            wactli
     c                   add       15            wactpo
     c                   endif
      *
     c                   exfmt     b2bld
      *
      *
     c                   if        *inkc = *on
     c                   goto      b2end
     c                   endif
      *
      * SJEKKER OM PERIODE ER RIKTIG UTFYLT
      *
     c                   movel     b2peri        wwmnd
     c                   move      b2peri        wwaar
      *
     c                   if        wwmnd < 01
     c                   eval      *in31 = *on
     c                   goto      b2taga
     c                   endif
      *
     c                   if        wwmnd > 12
     c                   eval      *in31 = *on
     c                   goto      b2taga
     c                   endif
      *
      * UTLEGG AV PERIODE
      *
     c                   move      b2peri        wwaar
     c                   movel     b2peri        wwmnd
     c                   if        wwaar < 80
     c                   movel     20            wwcen
     c                   move      wwaar         wwcen
     c                   else
     c                   movel     19            wwcen
     c                   move      wwaar         wwcen
     c                   endif
     c                   movel     wwcen         ldperi
     c                   move      wwmnd         ldperi
      *
      * LEGGER UT VIRKSOMHETSDAG
      *
     c                   eval      ldvdag = b2vdag
      *
     c     b2end         endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SJEKK VIRKSOMHETSDAG
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     b3tag         begsr
      *
     c                   movel     b1dato        b3vdag
      *
     c     b3taga        tag
6.30 c**                 z-add     08            wactli
6.30 c                   z-add     10            wactli
6.30 c**                 z-add     15            wactpo
6.30 c                   z-add     12            wactpo
     c                   if        b1avst <> 1
     c                   sub       02            wactli
     c                   add       09            wactpo
     c                   endif
     c                   if        b1wsid = *blank
     c                   if        b1wsgr = *blank
     c                   goto      b3tagb
     c                   endif
     c                   endif
     c                   sub       02            wactli
     c                   add       16            wactpo
     c     b3tagb        tag
     c                   if        b1otyp <> *blank
     c                   sub       02            wactli
     c                   add       15            wactpo
     c                   endif
     c                   exfmt     b3bld
      *
      *
     c                   if        *inkc = *on
     c                   goto      b3end
     c                   endif
      *
      * SJEKK VIRKSOMHETSKODE
      *
     c                   if        b3vdag < 01
     c                   eval      *in31 = *on
     c                   goto      b3taga
     c                   endif
      *
     c                   if        b3vdag > 31
     c                   eval      *in31 = *on
     c                   goto      b3taga
     c                   endif
      *
      * LEGGER UT VIRKSOMHETSDAG
      *
     c                   eval      ldvdag = b3vdag
      *
     c     b3end         endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SJEKK ENKELT ARBEIDSSTASJONER
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     b4tag         begsr
      *
     c                   eval      b4ws01 = *blank
     c                   eval      b4ws02 = *blank
     c                   eval      b4ws03 = *blank
     c                   eval      b4ws04 = *blank
     c                   eval      b4ws05 = *blank
     c                   eval      b4ws06 = *blank
     c                   eval      b4ws07 = *blank
     c                   eval      b4ws08 = *blank
     c                   eval      b4ws09 = *blank
     c                   eval      b4ws10 = *blank
      *
     c                   eval      ldwsal = *blank
     c                   eval      ldws01 = *blank
     c                   eval      ldws02 = *blank
     c                   eval      ldws03 = *blank
     c                   eval      ldws04 = *blank
     c                   eval      ldws05 = *blank
     c                   eval      ldws06 = *blank
     c                   eval      ldws07 = *blank
     c                   eval      ldws08 = *blank
     c                   eval      ldws09 = *blank
     c                   eval      ldws10 = *blank
     c                   eval      ldwsgr = *blank
      *
     c     b4taga        tag
     c                   z-add     04            wactli
     c                   z-add     40            wactpo
     c                   if        b1otyp <> *blank
     c                   sub       02            wactli
     c                   add       15            wactpo
     c                   endif
     c                   exfmt     b4bld
      *
      *
     c                   if        *inkc = *on
     c                   goto      b4end
     c                   endif
      *
     c                   eval      w_firm = l_sfir
      *
     c                   if        b4ws01 = *blank
     c                   if        b4ws02 = *blank
     c                   if        b4ws03 = *blank
     c                   if        b4ws04 = *blank
     c                   if        b4ws05 = *blank
     c                   if        b4ws06 = *blank
     c                   if        b4ws07 = *blank
     c                   if        b4ws08 = *blank
     c                   if        b4ws09 = *blank
     c                   if        b4ws10 = *blank
     c                   eval      *in51 = *on
     c                   goto      b4taga
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        b4ws01 <> *blank
     c                   eval      bwsdl1_wsid = b4ws01
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in31 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in41 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws01        ldws01
     c                   endif
      *
     c                   if        b4ws02 <> *blank
     c                   eval      bwsdl1_wsid = b4ws02
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in32 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in42 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws02        ldws02
     c                   endif
      *
     c                   if        b4ws03 <> *blank
     c                   eval      bwsdl1_wsid = b4ws03
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in33 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in43 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws03        ldws03
     c                   endif
      *
     c                   if        b4ws04 <> *blank
     c                   eval      bwsdl1_wsid = b4ws04
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in34 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in44 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws04        ldws04
     c                   endif
      *
     c                   if        b4ws05 <> *blank
     c                   eval      bwsdl1_wsid = b4ws05
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in35 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in45 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws05        ldws05
     c                   endif
      *
     c                   if        b4ws06 <> *blank
     c                   eval      bwsdl1_wsid = b4ws06
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in36 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in46 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws06        ldws06
     c                   endif
      *
     c                   if        b4ws07 <> *blank
     c                   eval      bwsdl1_wsid = b4ws07
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in37 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in47 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws07        ldws07
     c                   endif
      *
     c                   if        b4ws08 <> *blank
     c                   eval      bwsdl1_wsid = b4ws08
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in38 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in48 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws08        ldws08
     c                   endif
      *
     c                   if        b4ws09 <> *blank
     c                   eval      bwsdl1_wsid = b4ws09
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in39 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in49 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws09        ldws09
     c                   endif
      *
     c                   if        b4ws10 <> *blank
     c                   eval      bwsdl1_wsid = b4ws10
     c     bwsdl1_key    chain     bwsdl1r                            90
     c   90              do
     c                   eval      *in40 = *on
     c                   goto      b4taga
     c                   enddo
     c                   if        bwakti <> *zero
     c                   eval      *in50 = *on
     c                   goto      b4taga
     c                   endif
      *
     c                   movel     b4ws10        ldws10
     c                   endif
      *
     c     b4end         endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * SJEKK ENKELT ORDRETYPER
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     b5tag         begsr
      *
     c                   eval      b5ot01 = *blank
     c                   eval      b5ot02 = *blank
     c                   eval      b5ot03 = *blank
     c                   eval      b5ot04 = *blank
     c                   eval      b5ot05 = *blank
     c                   eval      b5ot06 = *blank
     c                   eval      b5ot07 = *blank
     c                   eval      b5ot08 = *blank
     c                   eval      b5ot09 = *blank
     c                   eval      b5ot10 = *blank
      *
     c                   eval      ldotal = *blank
     c                   eval      ldot01 = *blank
     c                   eval      ldot02 = *blank
     c                   eval      ldot03 = *blank
     c                   eval      ldot04 = *blank
     c                   eval      ldot05 = *blank
     c                   eval      ldot06 = *blank
     c                   eval      ldot07 = *blank
     c                   eval      ldot08 = *blank
     c                   eval      ldot09 = *blank
     c                   eval      ldot10 = *blank
      *
     c     b5taga        tag
     c                   z-add     02            wactli
     c                   z-add     55            wactpo
     c                   exfmt     b5bld
      *
     c                   if        *inkc = *on
     c                   goto      b5end
     c                   endif
      *
     c                   eval      w_firm = l_sfir
      *
     c                   if        b5ot01 = *blank
     c                   if        b5ot02 = *blank
     c                   if        b5ot03 = *blank
     c                   if        b5ot04 = *blank
     c                   if        b5ot05 = *blank
     c                   if        b5ot06 = *blank
     c                   if        b5ot07 = *blank
     c                   if        b5ot08 = *blank
     c                   if        b5ot09 = *blank
     c                   if        b5ot10 = *blank
     c                   eval      *in51 = *on
     c                   goto      b5taga
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
     c                   endif
      *
     c                   if        b5ot01 <> *blank
     c                   eval      votyl1_otyp = b5ot01
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in31 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot01        ldot01
     c                   endif
      *
     c                   if        b5ot02 <> *blank
     c                   eval      votyl1_otyp = b5ot02
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in32 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot02        ldot02
     c                   endif
      *
     c                   if        b5ot03 <> *blank
     c                   eval      votyl1_otyp = b5ot03
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in33 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot03        ldot03
     c                   endif
      *
     c                   if        b5ot04 <> *blank
     c                   eval      votyl1_otyp = b5ot04
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in34 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot04        ldot04
     c                   endif
      *
     c                   if        b5ot05 <> *blank
     c                   eval      votyl1_otyp = b5ot05
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in35 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot05        ldot05
     c                   endif
      *
     c                   if        b5ot06 <> *blank
     c                   eval      votyl1_otyp = b5ot06
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in36 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot06        ldot06
     c                   endif
      *
     c                   if        b5ot07 <> *blank
     c                   eval      votyl1_otyp = b5ot07
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in37 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot07        ldot07
     c                   endif
      *
     c                   if        b5ot08 <> *blank
     c                   eval      votyl1_otyp = b5ot08
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in38 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot08        ldot08
     c                   endif
      *
     c                   if        b5ot09 <> *blank
     c                   eval      votyl1_otyp = b5ot09
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in39 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot09        ldot09
     c                   endif
      *
     c                   if        b5ot10 <> *blank
     c                   eval      votyl1_otyp = b5ot10
     c     votyl1_key    chain     votyl1r                            90
     c   90              do
     c                   eval      *in40 = *on
     c                   goto      b5taga
     c                   enddo
      *
     c                   movel     b5ot10        ldot10
     c                   endif
      *
     c     b5end         endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Henter/Oppdatering av NUMMER-REGISTER
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
     c     hntnum        begsr
      *
     c                   eval      wskode = '0'
     c                   eval      wsfirm = l_sfir
     c                   eval      wstype = *blank
     c                   eval      wsfast = *blank
      *
      * Kaller opp subprogram for henting av nummer fra NUMMER-REGISTER
      *
     c                   call      'AS100R'
     c                   parm                    wskode
     c                   parm                    wsfirm
     c                   parm                    wsfell
     c                   parm                    wstype
     c                   parm                    wsfast
     c                   parm                    wsnumm
      *
     c                   endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * Definisjon av local data area for output
      *
     c     *dtaara       define    *lda          lda
      *
     c                   eval      wpin03 = *blank
      *
      * Nullstilling av felter som ikke kan redefineres
      *
     c                   move      *zero         wwvalg
     c                   eval      grpant = *zero
     c                   eval      wwmnd = *zero
     c                   eval      wwaar = *zero
     c                   eval      wwamn = *zero
     c                   eval      wwcen = *zero
      *
     c                   eval      wskode = *blank
     c                   eval      wsfirm = *zero
     c                   eval      wsfell = *blank
     c                   eval      wstype = *blank
     c                   eval      wsfast = *blank
     c                   eval      wsnumm = *zero
      *
      * Key for file : BUTIKK-STATUSKODE-REGISTER
      *
     c     bstsl1_key    klist
     c                   kfld                    w_firm
      *
      * Key for file : SKJERM/KASSE-REGISTER
      *
     c     bwsdl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bwsdl1_wsid
      *
      * Key for file : ARBEIDSSKJERMGRUPPE-REGISTER
      *
     c     bwsdlg_key    klist
     c                   kfld                    w_firm
     c                   kfld                    bwsdlg_wsgr
      *
      * Key for file : ORDRE-TYPE-REGISTER
      *
     c     votyl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    votyl1_otyp
7.01  *
7.01  * Key for file : Firmastyrt validering
7.01  *
7.01 c     avall1_key    klist
7.01 c                   kfld                    w_firm
7.01 c                   kfld                    avall1_apgm
7.01  *
7.01  * Key for file : Dagsoppgjør paramter
7.01  *
7.01 c     bdoplu_key    klist
7.01 c                   kfld                    w_firm
7.01 c                   kfld                    bdoplu_sgr
8.05  *
8.05 c     xtill1_key    klist
8.05 c                   kfld                    w_firm
8.05 c                   kfld                    xtill1_regi
8.05 c                   kfld                    xtill1_felt
8.05 c                   kfld                    xtill1_xkey
      *
      * Hent idenifikasjon fra BUTIKK-STATUS-REGISTER
      *
     c                   eval      w_firm = l_sfir
     c     bstsl1_key    chain     bstsl1r                            60
      *
     c                   if        *in60 = *on
     c                   eval      baaavs = *blank
     c                   eval      baadet = *blank
     c                   eval      baalst = *blank
     c                   endif
      *
7.02  *
7.02  * Endring 7.02p
7.02  *
7.02   CallP CO402R(l_filg:w_firm:0:'BO120R_702':
7.02                    co402_verdi1:co402_verdi2);
7.02   if co402_verdi1 = '1';
7.02     w_pos = %scan(';' : co402_verdi2);
7.02     if (w_pos > 0);
7.02       w_avst = %subst(co402_verdi2 : 1 : w_pos - 0);
7.02       w_tota = %subst(co402_verdi2 : w_pos + 1 : 1);
7.02       w_deta = %subst(co402_verdi2 : w_pos + 3 : 1);
7.02       w_dekn = %subst(co402_verdi2 : w_pos + 5 : 1);
7.02       if (w_avst <> *blank or w_tota <> *blank or
7.02           w_deta <> *blank or w_dekn <> *blank);
7.02         u_702 = *on;
7.02       endif;
7.02     endif;
7.02   endif;
      *
8.02  *
8.02  * Endring 8.02Styre kjøreing fra Jobbplan fra switch
8.02  *
8.02   CallP CO402R(l_filg:w_firm:0:'D_Oppgj_Batch':
8.02                    co402_verdi1:co402_verdi2);
8.02         *in55 = *on;
8.02   if co402_verdi1 = '1';
8.02         *in55 = *off;
8.02   endif;
7.01  *
7.01  * Sjekk om det er lagt opp krav til arbeidsstasjonsgruppe
7.01  *
7.01  *
7.01 c                   eval      avall1_apgm = 'BO120R'
7.01 c     avall1_key    setll     avall1
7.01 c     avall1_key    reade     avall1
7.01 c                   dow       not %eof(avall1)
7.01 c                   if        avaflt = 'B1WSGR'  and
7.01 c                             avaval = 1
7.01 c                   eval      u_wsgr = *on
7.01 c                   endif
7.01 c     avall1_key    reade     avall1
7.01 c                   enddo
      *
     c                   endsr
      *
