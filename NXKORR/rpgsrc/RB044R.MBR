     h option(*nodebugio) datedit(*dmy)
     h decedit('0.')
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System  . . . . : ASOFAK
      * Program . . . . : RB044R
      * Beskrivelse . . : Leser linjer fra bovf til kommaseparert til
      *                   (Uni Micro kundeinfo)
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * ----- ------ ---- -------------------------------------------------
      *       091120 sst  Nytt program Uni Micro
7.03  *K00    061023 mst  Fjerne ',' fra RKNVN hvis det finnes
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
     fbovfl1    if   e           k disk
     frkunl1    if   e           k disk    rename(rkunpfr:rkunl1r)
      *
      *
     frv02pf    o    e           k disk
      *
      * Definering av Local data area
      *
     d                uds
     d l_firm                944    946  0
      *
     d w_kund          s                   like(rkkund)
     d w_biln          s                   like(bfbiln)
     d w_firm          s                   like(bffirm)
     d rkunl1_kund     s                   like(rkkund)
     d tell            s              1  0
      *
6.20 c                   eval      w_firm = l_firm
      * Key for oppslag på kunde
      *
     c     rkunl1_key    klist
     c                   kfld                    w_firm
     c                   kfld                    rkunl1_kund
      *
      *
      * Leser post
     c     nyles         tag
      *
     c                   read      bovfl1                                 60
      *
     c                   if        *in60 = '1'
     c                   goto      slutt
     c                   endif
      *
      *
     c                   if        l_firm <> bffirm
     c                   goto      nyles
     c                   endif
      *
     c                   eval      rvdata = *blank
      *
      * Ta vare på første bilagsnr
     c                   eval      w_biln = bfbiln
      *
     c                   exsr      finnadr
     c                   goto      nyles
      *
      *
     c     slutt         tag
      *
     c                   eval      *inlr = *on
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Finner navn, adresse osv. / skriv post
      *
     c     finnadr       begsr
      *
     c                   select
     c                   when      bfkund  > 9999
     c                   eval      w_kund = bfkund
     c*                  when      bfdkto  > 9999
     c*                  eval      w_kund = bfdkto
     c                   other
     c                   goto      endkund
     c                   endsl
      *
     c                   if        w_kund > 9999
     c                   eval      rkunl1_kund = w_kund
     c     rkunl1_key    chain     rkunl1
      *
     c                   if        %found(rkunl1)
7.03  *
7.03 c                   eval      rknavn  = %ScanRpl(',' : ' ' : rknavn)
7.03  *
     c                   eval      rvdata = *blank
      * Rectype
     c                   eval      rvdata = '30'             + ',' +
      * Kundenr
     c                                     %char(w_kund)     + ',' +
      * Navn
     c                                     %trim(rknavn)     + ',' +
      * Adresse 1
     c                                     %trim(rkgate)     + ',' +
      * Adresse 2
     c                                     %trim(rkadr2)     + ',' +
      * Postnummer
     c                                     %char(rkponr)     + ',' +
      * Poststed
     c                                     %trim(rksted)     + ',' +
      * Saldo i fjor
     c                                     %char(rksaif)     + ',' +
      * Bankgironr
     c                                     %char(rkbgir)     + ',' +
      * Ant dager kreidtt
     c                                     '0'               + ',' +
      * Kjede nr
     c                                     ''                + ',' +
      * Kategori
     c                                     %char(rkkatg)     + ',' +
      * Øk Kategori
     c                                     ''                + ',' +
      * Telefon
     c                                     %trim(rkmobn)     + ',' +
      * Fax
     c                                     %trim(rktlfx)     + ',' +
      * Blank
     c                                     ''                + ',' +
      * Omsetning i år
     c                                     %char(rkkjØp)     + ',' +
      * Rabatt
     c                                     ''                + ',' +
      * Telefax
     c                                     ''                + ','
      *
     c                   write     rv02pfr
     c                   endif
     c                   endif
      *
     c     endkund       endsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
