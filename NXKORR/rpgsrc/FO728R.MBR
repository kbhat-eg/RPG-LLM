      /TITLE  ASOFAK: Sjekker om ordre er satt i bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * System. . . . . : ASOFAK
      * Program . . . . : FO728R
      * Beskrivelse . . : Sjekker om SO ordre kan plukkes
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Spesialversjon. :
      * Tilpasset for . :
      *
      * Ref.   Dato  Sign Endringsbeskrivelse
      * ----- ------ ---- -------------------------------------------------
      *       271025 bsa  Nytt program
      *
      *
      *
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      *
      * Definering av Local Data Arae (LDA)
      *
     d                uds
     d l_user                911    920
     d l_filg                931    933
     d l_firm                944    946  0
      *
      * Definering av parametere
      *
     d p_otyp          s              2
     d p_stat          s              1
      *
      * Definering av array's
      *
     d oty             s              2    dim(99)
      *
      * Definering av variable
      *
     d w_firm          s              3  0
     d w_ant           s              3  0
     d w_pos           s              4  0
      *
      * Definering av eksterne prg
      *
       dcl-s co402_verdi1  char(1);
       dcl-s co402_verdi2  char(2048);
       DCL-PR CO402R EXTPGM('CO402R');
         p_filgrp            char(3)     const;
         p_firm              packed(3:0) const;
         p_lager             packed(2:0) const;
         p_nokkel            char(50)    const;
         p_verdi1            char(1);
         p_verdi2            char(2048);
       END-PR;
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Leser ordrelinjer for Ã¥ finne om linjer er satt i bestilling
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
      * Sjekk om ordretype kan plukkes til bestilling
      *
     c                   if        %lookup(p_otyp:oty) > 0
     c                   eval      p_stat = '1'
     c                   endif
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Avslutt program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c                   eval      *inlr = *on
     c                   return
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Subrutine for initiering av program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *inzsr        begsr
      *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      * Tar inn parameter fra forrige program
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      *
     c     *entry        plist
     c                   parm                    p_otyp
     c                   parm                    p_stat
      *
      * Legger inn firmanummer
      *
     c                   eval      w_firm = l_firm
      *
      * Nullstilling av felter som ikke kan redefineres
      *
     c                   eval      p_stat = '0'
      *
      * Hent inn hvilke rutiner som er gyldige for behandling
      *
     c                   eval      w_ant = 1
      *
       CallP CO402R(l_filg:w_firm:0:'SO_SPERRET_PLUKKING':
                       co402_verdi1:co402_verdi2);

       if co402_verdi1 = '1';
      * Ordretyper
           w_pos = 1;
           dow (w_pos > 0);
           w_pos = %scan(';' : co402_verdi2);
             if w_pos > 0;
             oty(w_ant) = %subst(co402_verdi2 : 1 : w_pos - 1);
             co402_verdi2 =  %subst(co402_verdi2:w_pos+1:2048-w_pos);
             w_ant = w_ant + 1;
             endif;
           enddo;
       endif;
      *
     c                   endsr
