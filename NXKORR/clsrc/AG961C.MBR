/*-------------------------------------------------------------------*/
/*                                                                   */
/* Dette programmet kalles fra AG960C                                */
/*                                                                   */
/*  Programmet får inn komplett filgruppe og setter opp              */
/*  biblioteksliste                                                  */
/*                                                                   */
/*  Programmet gjør endringer i trigger/views/sqlinder               */
/*  ut fra hva valg parameter innholder                              */
/*                                                                   */
/*-------------------------------------------------------------------*/

 STRPGM:     PGM        PARM(&MILJO &FGRP &LVR &TABELL &VALG &VERSJON)

             DCL        VAR(&MILJO)    TYPE(*CHAR) LEN(3)
             DCL        VAR(&FGRP)     TYPE(*CHAR) LEN(3)
             DCL        VAR(&LVR)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&TABELL)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&VALG)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&VERSJON)  TYPE(*CHAR) LEN(3)

             DCL        VAR(&LIB)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&PUSR)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&FIRM)     TYPE(*DEC)  LEN(3 0) VALUE(0)

             DCL        VAR(&SQL_DLTID)   TYPE(*DEC)   LEN(1 0) VALUE(0)
             DCL        VAR(&SQL_DLTVI)   TYPE(*DEC)   LEN(1 0) VALUE(0)
             DCL        VAR(&SQL_DLTTR)   TYPE(*DEC)   LEN(1 0) VALUE(0)
             DCL        VAR(&SQL_CRTID)   TYPE(*DEC)   LEN(1 0) VALUE(0)
             DCL        VAR(&SQL_CRTVI)   TYPE(*DEC)   LEN(1 0) VALUE(0)
             DCL        VAR(&SQL_CRTTR)   TYPE(*DEC)   LEN(1 0) VALUE(0)

             MONMSG     MSGID(CPF2110) /*    Bibl ble ikke funnet    */
             MONMSG     MSGID(CPF2104) /*    Bibl not removed        */

             CHGVAR     VAR(&LIB)            VALUE('ADB')
             RMVLIBLE   LIB(&LIB)

             CHGVAR     VAR(&LIB)            VALUE('EG1')
             RMVLIBLE   LIB(&LIB)

             CHGVAR     VAR(&PUSR)            VALUE('ASP_xxx')
             CHGVAR     VAR(%SST(&PUSR  5 3)) VALUE(&FGRP)

             IF         COND(&VALG *EQ 'S1') THEN(DO)
                CHGVAR     VAR(&SQL_CRTVI)  VALUE(1)
             ENDDO
             IF         COND(&VALG *EQ 'S2') THEN(DO)
                CHGVAR     VAR(&SQL_DLTVI)  VALUE(1)
                CHGVAR     VAR(&SQL_CRTVI)  VALUE(1)
             ENDDO
             IF         COND(&VALG *EQ 'S3') THEN(DO)
                CHGVAR     VAR(&SQL_CRTID)  VALUE(1)
             ENDDO
             IF         COND(&VALG *EQ 'S4') THEN(DO)
                CHGVAR     VAR(&SQL_DLTID)  VALUE(1)
                CHGVAR     VAR(&SQL_CRTID)  VALUE(1)
             ENDDO
             IF         COND(&VALG *EQ 'S7') THEN(DO)
                CHGVAR     VAR(&SQL_DLTTR)  VALUE(1)
             ENDDO
             IF         COND(&VALG *EQ 'S8') THEN(DO)
                CHGVAR     VAR(&SQL_CRTTR)  VALUE(1)
             ENDDO
             IF         COND(&VALG *EQ 'S9') THEN(DO)
                CHGVAR     VAR(&SQL_DLTTR)  VALUE(1)
                CHGVAR     VAR(&SQL_CRTTR)  VALUE(1)
             ENDDO

             CALL       PGM(AA728C) PARM(&FGRP &PUSR &FIRM)

             CALL       PGM(AV121C) PARM(&SQL_DLTID &SQL_DLTVI &SQL_DLTTR +
                          &SQL_CRTID &SQL_CRTVI &SQL_CRTTR &FGRP &LVR +
                          &MILJO &TABELL &VERSJON)

 ENDPGM:     ENDPGM
