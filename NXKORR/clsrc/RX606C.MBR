/*------------------------------------------------------------------------*/
/*  Dato   Sign  Beskrivelse                                              */
/* 230925  bsa   Eksport av kunderprosjekt til excel regneark             */
/*                                                                        */
/*                                                                        */
/*------------------------------------------------------------------------*/
             PGM        PARM(&POST_LINK &NUMM)

             DCL        VAR(&POST_LINK) TYPE(*CHAR) LEN(100)
             DCL        VAR(&NUMM) TYPE(*DEC) LEN(8 0)
             DCL        VAR(&SQLSTMT)  TYPE(*CHAR) LEN(10000)
             DCL        VAR(&PREFIX_FIL)    TYPE(*CHAR) LEN(50) +
                          VALUE('Kundeprosjekt_eks')

/*   Bygg SQL                                                                 */

             CHGVAR     VAR(&SQLSTMT) VALUE('SELECT +
                          r02fir AS "Firma", +
                          r02kun AS "Kundenummer", +
                          r02nxp AS "NX_Prosjektnr", +
                          r02slg AS "Selger", +
                          r02fda AS "Fra_dato", +
                          r02tda AS "Til_dato", +
                          r02nav AS "Navn", +
                          r02ad1 AS "Adresse1", +
                          r02ad2 AS "Adresse2", +
                          r02pnr AS "Postnr", +
                          r02kpr AS "Kontaktperson", +
                          r02tla AS "Telefon_arb", +
                          r02tlp AS "Telefon_priv", +
                          r02tlm AS "Mobile", +
                          r02ema AS "eMail", +
                          r02epr AS "Ekst_prosjnbr", +
                          r02fty AS "Fakturatype", +
                          r02kjo AS "Kjorerute", +
                          r02kjn AS "Rekkefolge", +
                          r02obu AS "Bonuskunde", +
                          r02ork AS "Overst_rab", +
                          r02okn AS "Overst_kunde", +
                          r02opr AS "Overst_prosj", +
                          r02opa AS "Over_pris_dato", +
                          r02pri AS "Privat", +
                          r02pro AS "Prosjektnummer", +
                          r02bdo AS "Byggdok", +
                          r02cbo AS "Cobuilder", +
                          r02mko AS "MVA_Beregning", +
                          r02bet AS "Bet_betingelse", +
                          r02ppa AS "Pris_pakks", +
                          r02net AS "Pris_faktura", +
                          r02ekg AS "Ekspedisj_gebyr", +
                          r02sek AS "Fakturasekvens", +
                          r02sam AS "Samlefaktura", +
                          r02fag AS "Fakturagebyr", +
                          r02fku AS "Overtyrt_kunde"   FROM rx02st')

             chgvar var(&sqlstmt) +
                    value(&sqlstmt *BCAT ' WHERE R02IDE=' +
                    *CAT %char(&numm))


             CALL       PGM(XLSXCLODXP) PARM( &SQLSTMT &POST_LINK +
                          &PREFIX_FIL)

 ENDPGM:     ENDPGM
