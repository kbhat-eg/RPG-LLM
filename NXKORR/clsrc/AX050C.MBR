
/* Cl-program som kontrollerer bruker-tilgang                        */

             PGM        PARM(&LEVL &OKOK)
             DCL        VAR(&LEVL)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&OKOK)     TYPE(*CHAR) LEN(2)
             DCL        VAR(&USRCLS)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&USR)      TYPE(*CHAR) LEN(10)
             DCL        VAR(&stat)     TYPE(*CHAR) LEN(1) value('0')
             MONMSG     MSGID(CPF0000)

/* Hente inn brukerprofil                                            */

             RTVJOBA    USER(&USR)
             RTVUSRPRF  USRCLS(&USRCLS)

/* Level = 99                                                        */

             IF         COND(&LEVL *EQ '99')      THEN(DO)
             call pgm(AX020R) parm(&usr &stat)
             IF         COND(&stat *EQ '1') THEN(DO)
             CHGVAR     VAR(&OKOK) VALUE(OK)
             GOTO       CMDLBL(END)
             ENDDO
             ENDDO

/* Level = 50                                                        */

             IF         COND(&LEVL *EQ '50')      THEN(DO)
             IF         COND(&USRCLS *EQ '*SECOFR') THEN(DO)
             CHGVAR     VAR(&OKOK) VALUE(OK)
             GOTO       CMDLBL(END)
             ENDDO
             ENDDO

/* Level = 40                                                        */

             IF         COND(&LEVL *EQ '40')      THEN(DO)
             IF         COND(&USRCLS *EQ '*SECOFR'  *OR +
                             &USRCLS *EQ '*SECADM') THEN(DO)
             CHGVAR     VAR(&OKOK) VALUE(OK)
             GOTO       CMDLBL(END)
             ENDDO
             ENDDO

/* Level = 30                                                        */

             IF         COND(&LEVL *EQ '30')      THEN(DO)
             IF         COND(&USRCLS *EQ '*SECOFR'  *OR +
                             &USRCLS *EQ '*SECADM'  *OR +
                             &USRCLS *EQ '*PGMR')   THEN(DO)
             CHGVAR     VAR(&OKOK) VALUE(OK)
             GOTO       CMDLBL(END)
             ENDDO
             ENDDO

/* Level = 20                                                        */

             IF         COND(&LEVL *EQ '20')      THEN(DO)
             IF         COND(&USRCLS *EQ '*SECOFR'  *OR +
                             &USRCLS *EQ '*SECADM'  *OR +
                             &USRCLS *EQ '*PGMR'    *OR +
                             &USRCLS *EQ '*SYSOPR') THEN(DO)
             CHGVAR     VAR(&OKOK) VALUE(OK)
             GOTO       CMDLBL(END)
             ENDDO
             ENDDO

/* Level = 10                                                        */

             IF         COND(&LEVL *EQ '10')      THEN(DO)
             CHGVAR     VAR(&OKOK) VALUE(OK)
             GOTO       CMDLBL(END)
             ENDDO

/* Avslutt                                                           */

 END:        ENDPGM
