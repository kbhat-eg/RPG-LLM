name: ðŸ¤– AI Jira Auto-Update                                           
                                                                           on:                                                                    
    pull_request:                                                        
      types: [closed]          # Fires when PR is closed/merged
      branches:                                                                  - develop              # Only when merging INTO develop                                                                                     jobs:                                                                      update-jira:                                                         
      # Only run if PR was actually MERGED (not just closed)
      if: github.event.pull_request.merged == true

      runs-on: ubuntu-latest

      permissions:
        contents: read
        pull-requests: read

      steps:

        # â”€â”€ Step 1: Checkout code so Claude can read the diff
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        - name: ðŸ“¥ Checkout Code
          uses: actions/checkout@v4
          with:
            fetch-depth: 0

        # â”€â”€ Step 2: Capture the PR diff into a file
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        - name: ðŸ“¦ Get PR Diff
          id: diff
          run: |
            git diff ${{ github.event.pull_request.base.sha }} \
                     ${{ github.event.pull_request.merge_commit_sha }} \ 
                     --unified=5 > pr_diff.txt
            echo "Diff captured successfully"

        # â”€â”€ Step 3: Claude AI reads diff and updates Jira
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        - name: ðŸ¤– Claude AI â€” Analyze & Update Jira
          uses: anthropics/claude-code-action@beta
          with:
            anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
            direct_prompt: |
              You are a technical writer. Analyze the git diff and update
   the Jira ticket automatically.

              PR Title    : ${{ github.event.pull_request.title }}       
              PR Body     : ${{ github.event.pull_request.body }}        
              PR Number   : ${{ github.event.pull_request.number }}      
              Merged By   : ${{ github.event.pull_request.merged_by.login
   }}
              Repository  : ${{ github.repository }}

              STEP 1 â€” Extract the Jira ticket ID from PR title using    
  pattern [A-Z]+-\d+
              ...
              STEP 7 â€” Print a summary of everything that was done.  
